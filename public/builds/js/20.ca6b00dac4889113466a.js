webpackJsonp([20],{

/***/ 154:
/***/ (function(module, exports, __webpack_require__) {

var Component = __webpack_require__(2)(
  /* script */
  __webpack_require__(600),
  /* template */
  __webpack_require__(714),
  /* scopeId */
  null,
  /* cssModules */
  null
)
Component.options.__file = "/home/kimnh/Codes/WebShop/admin-template/laravel-vue-admin/resources/builds/js/views/tables/Handsontable.vue"
if (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== "default" && key !== "__esModule"})) {console.error("named exports are not supported in *.vue files.")}
if (Component.options.functional) {console.error("[vue-loader] Handsontable.vue: functional components are not supported with templates, they should use render functions.")}

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-0f701bf5", Component.options)
  } else {
    hotAPI.reload("data-v-0f701bf5", Component.options)
  }
})()}

module.exports = Component.exports


/***/ }),

/***/ 571:
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _handsontableFull = __webpack_require__(672);

var _handsontableFull2 = _interopRequireDefault(_handsontableFull);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = {

  props: {
    data: {
      type: Array,
      required: true,
      default: function _default() {
        return [];
      }
    },
    settings: {
      type: Object,
      default: function _default() {
        return {};
      }
    }
  },

  mounted: function mounted() {
    this.settings.data = this.data;
    this.table = new _handsontableFull2.default(this.$el, this.settings);
  },
  beforeDestroy: function beforeDestroy() {
    this.table.destroy();
  }
}; //
//
//
//

/***/ }),

/***/ 600:
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _vueHandsontable = __webpack_require__(703);

var _vueHandsontable2 = _interopRequireDefault(_vueHandsontable);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = {
  components: {
    Handsontable: _vueHandsontable2.default
  },

  data: function data() {
    return {
      rawData: [['', 'Kia', 'Nissan', 'Toyota', 'Honda'], ['2008', 10, 11, 12, 13], ['2009', 20, 11, 14, 13], ['2010', 30, 15, 12, 13]]
    };
  }
}; //
//
//
//
//
//
//
//
//
//
//
//
//

/***/ }),

/***/ 655:
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__(1)();
// imports


// module
exports.push([module.i, "/*!\n(The MIT License)\n\nCopyright (c) 2012-2014 Marcin Warpechowski\nCopyright (c) 2015 Handsoncode sp. z o.o. <hello@handsoncode.net>\n\nPermission is hereby granted, free of charge, to any person obtaining\na copy of this software and associated documentation files (the\n'Software'), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\nIN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\nCLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\nTORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\nSOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n*/\n.handsontable {\n  position: relative;\n}\n\n.handsontable .hide{\n  display: none;\n}\n.handsontable .relative {\n  position: relative;\n}\n\n.handsontable.htAutoSize {\n  visibility: hidden;\n  left: -99000px;\n  position: absolute;\n  top: -99000px;\n}\n\n.handsontable .wtHider {\n  width: 0;\n}\n\n.handsontable .wtSpreader {\n  position: relative;\n  width: 0; /*must be 0, otherwise blank space appears in scroll demo after scrolling max to the right */\n  height: auto;\n}\n\n.handsontable table,\n.handsontable tbody,\n.handsontable thead,\n.handsontable td,\n.handsontable th,\n.handsontable input,\n.handsontable textarea,\n.handsontable div {\n  box-sizing: content-box;\n  -webkit-box-sizing: content-box;\n  -moz-box-sizing: content-box;\n}\n\n.handsontable input,\n.handsontable textarea {\n  min-height: initial;\n}\n\n.handsontable table.htCore {\n  border-collapse: separate;\n  /*it must be separate, otherwise there are offset miscalculations in WebKit: http://stackoverflow.com/questions/2655987/border-collapse-differences-in-ff-and-webkit*/\n  /*this actually only changes appearance of user selection - does not make text unselectable\n  -webkit-user-select: none;\n  -khtml-user-select: none;\n  -moz-user-select: none;\n  -o-user-select: none;\n  -ms-user-select: none;\n  /*user-select: none; /*no browser supports unprefixed version*/\n  border-spacing: 0;\n  margin: 0;\n  border-width: 0;\n  table-layout: fixed;\n  width: 0;\n  outline-width: 0;\n  /* reset bootstrap table style. for more info see: https://github.com/handsontable/handsontable/issues/224 */\n  max-width: none;\n  max-height: none;\n}\n\n.handsontable col {\n  width: 50px;\n}\n\n.handsontable col.rowHeader {\n  width: 50px;\n}\n\n.handsontable th,\n.handsontable td {\n  border-top-width: 0;\n  border-left-width: 0;\n  border-right: 1px solid #CCC;\n  border-bottom: 1px solid #CCC;\n  height: 22px;\n  empty-cells: show;\n  line-height: 21px;\n  padding: 0 4px 0 4px;\n  /* top, bottom padding different than 0 is handled poorly by FF with HTML5 doctype */\n  background-color: #FFF;\n  vertical-align: top;\n  overflow: hidden;\n  outline-width: 0;\n  white-space: pre-line;\n  /* preserve new line character in cell */\n  background-clip: padding-box;\n}\n\n.handsontable td.htInvalid {\n  background-color: #ff4c42 !important; /*gives priority over td.area selection background*/\n}\n\n.handsontable td.htNoWrap {\n  white-space: nowrap;\n}\n\n.handsontable th:last-child {\n  /*Foundation framework fix*/\n  border-right: 1px solid #CCC;\n  border-bottom: 1px solid #CCC;\n}\n\n.handsontable tr:first-child th.htNoFrame,\n.handsontable th:first-child.htNoFrame,\n.handsontable th.htNoFrame {\n  border-left-width: 0;\n  background-color: white;\n  border-color: #FFF;\n}\n\n.handsontable th:first-child,\n.handsontable th:nth-child(2),\n.handsontable td:first-of-type,\n.handsontable .htNoFrame + th,\n.handsontable .htNoFrame + td {\n  border-left: 1px solid #CCC;\n}\n\n.handsontable.htRowHeaders thead tr th:nth-child(2) {\n  border-left: 1px solid #CCC;\n}\n\n.handsontable tr:first-child th,\n.handsontable tr:first-child td {\n  border-top: 1px solid #CCC;\n}\n\n.ht_master:not(.innerBorderLeft):not(.emptyColumns) ~ .handsontable tbody tr th,\n.ht_master:not(.innerBorderLeft):not(.emptyColumns) ~ .handsontable:not(.ht_clone_top) thead tr th:first-child {\n  border-right-width: 0;\n}\n\n.ht_master:not(.innerBorderTop) thead tr:last-child th,\n.ht_master:not(.innerBorderTop) ~ .handsontable thead tr:last-child th,\n.ht_master:not(.innerBorderTop) thead tr.lastChild th,\n.ht_master:not(.innerBorderTop) ~ .handsontable thead tr.lastChild th {\n  border-bottom-width: 0;\n}\n\n.handsontable th {\n  background-color: #f3f3f3;\n  color: #222;\n  text-align: center;\n  font-weight: normal;\n  white-space: nowrap;\n}\n\n.handsontable thead th {\n  padding: 0;\n}\n\n.handsontable th.active {\n  background-color: #CCC;\n}\n.handsontable thead th .relative {\n  padding: 2px 4px;\n}\n\n/* selection */\n.handsontable tbody th.ht__highlight,\n.handsontable thead th.ht__highlight {\n  background-color: #dcdcdc;\n}\n.handsontable.ht__selection--columns thead th.ht__highlight,\n.handsontable.ht__selection--rows tbody th.ht__highlight {\n  background-color: #8eb0e7;\n  color: #000;\n}\n\n/* plugins */\n\n/* row + column resizer*/\n.handsontable .manualColumnResizer {\n  position: fixed;\n  top: 0;\n  cursor: col-resize;\n  z-index: 110;\n  width: 5px;\n  height: 25px;\n}\n\n.handsontable .manualRowResizer {\n  position: fixed;\n  left: 0;\n  cursor: row-resize;\n  z-index: 110;\n  height: 5px;\n  width: 50px;\n}\n\n.handsontable .manualColumnResizer:hover,\n.handsontable .manualColumnResizer.active,\n.handsontable .manualRowResizer:hover,\n.handsontable .manualRowResizer.active {\n  background-color: #AAB;\n}\n\n.handsontable .manualColumnResizerGuide {\n  position: fixed;\n  right: 0;\n  top: 0;\n  background-color: #AAB;\n  display: none;\n  width: 0;\n  border-right: 1px dashed #777;\n  margin-left: 5px;\n}\n\n.handsontable .manualRowResizerGuide {\n  position: fixed;\n  left: 0;\n  bottom: 0;\n  background-color: #AAB;\n  display: none;\n  height: 0;\n  border-bottom: 1px dashed #777;\n  margin-top: 5px;\n}\n\n.handsontable .manualColumnResizerGuide.active,\n.handsontable .manualRowResizerGuide.active {\n  display: block;\n  z-index: 199;\n}\n\n.handsontable .columnSorting {\n  position: relative;\n}\n\n.handsontable .columnSorting:hover {\n  text-decoration: underline;\n  cursor: pointer;\n}\n\n.handsontable .columnSorting.ascending::after {\n  content: '\\25B2';\n  color: #5f5f5f;\n  position: absolute;\n  right: -15px;\n}\n\n.handsontable .columnSorting.descending::after {\n  content: '\\25BC';\n  color: #5f5f5f;\n  position: absolute;\n  right: -15px;\n}\n\n/* border line */\n\n.handsontable .wtBorder {\n  position: absolute;\n  font-size: 0;\n}\n.handsontable .wtBorder.hidden{\n  display:none !important;\n}\n\n.handsontable td.area {\n  background: -moz-linear-gradient(top,  rgba(181,209,255,0.34) 0%, rgba(181,209,255,0.34) 100%); /* FF3.6+ */\n  background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(181,209,255,0.34)), color-stop(100%,rgba(181,209,255,0.34))); /* Chrome,Safari4+ */\n  background: -webkit-linear-gradient(top,  rgba(181,209,255,0.34) 0%,rgba(181,209,255,0.34) 100%); /* Chrome10+,Safari5.1+ */\n  background: -o-linear-gradient(top,  rgba(181,209,255,0.34) 0%,rgba(181,209,255,0.34) 100%); /* Opera 11.10+ */\n  background: -ms-linear-gradient(top,  rgba(181,209,255,0.34) 0%,rgba(181,209,255,0.34) 100%); /* IE10+ */\n  background: linear-gradient(to bottom,  rgba(181,209,255,0.34) 0%,rgba(181,209,255,0.34) 100%); /* W3C */\n  filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#57b5d1ff', endColorstr='#57b5d1ff',GradientType=0 ); /* IE6-9 */\n  background-color: #fff;\n}\n\n/* fill handle */\n\n.handsontable .wtBorder.corner {\n  font-size: 0;\n  cursor: crosshair;\n}\n\n.handsontable .htBorder.htFillBorder {\n  background: red;\n  width: 1px;\n  height: 1px;\n}\n\n.handsontableInput {\n  border:none;\n  outline-width: 0;\n  margin: 0 ;\n  padding: 1px 5px 0 5px;\n  font-family: inherit;\n  line-height: 21px;\n  font-size: inherit;\n  box-shadow: 0 0 0 2px #5292F7 inset;\n  resize: none;\n  /*below are needed to overwrite stuff added by jQuery UI Bootstrap theme*/\n  display: inline-block;\n  color: #000;\n  border-radius: 0;\n  background-color: #FFF;\n  /*overwrite styles potentionally made by a framework*/\n}\n\n.handsontableInputHolder {\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 100;\n}\n\n.htSelectEditor {\n  -webkit-appearance: menulist-button !important;\n  position: absolute;\n  width: auto;\n}\n\n/*\nTextRenderer readOnly cell\n*/\n\n.handsontable .htDimmed {\n  color: #777;\n}\n\n.handsontable .htSubmenu {\n  position: relative;\n}\n\n.handsontable .htSubmenu :after{\n  content: '\\25B6';\n  color: #777;\n  position: absolute;\n  right: 5px;\n}\n\n\n/*\nTextRenderer horizontal alignment\n*/\n.handsontable .htLeft{\n  text-align: left;\n}\n.handsontable .htCenter{\n  text-align: center;\n}\n.handsontable .htRight{\n  text-align: right;\n}\n.handsontable .htJustify{\n  text-align: justify;\n}\n/*\nTextRenderer vertical alignment\n*/\n.handsontable .htTop{\n  vertical-align: top;\n}\n.handsontable .htMiddle{\n  vertical-align: middle;\n}\n.handsontable .htBottom{\n  vertical-align: bottom;\n}\n\n/*\nTextRenderer placeholder value\n*/\n\n.handsontable .htPlaceholder {\n  color: #999;\n}\n\n/*\nAutocompleteRenderer down arrow\n*/\n\n.handsontable .htAutocompleteArrow {\n  float: right;\n  font-size: 10px;\n  color: #EEE;\n  cursor: default;\n  width: 16px;\n  text-align: center;\n}\n\n.handsontable td .htAutocompleteArrow:hover {\n  color: #777;\n}\n\n.handsontable td.area .htAutocompleteArrow {\n  color: #d3d3d3;\n}\n\n/*\nCheckboxRenderer\n*/\n.handsontable .htCheckboxRendererInput {\n  display: inline-block;\n  vertical-align: middle;\n}\n.handsontable .htCheckboxRendererInput.noValue {\n  opacity: 0.5;\n}\n.handsontable .htCheckboxRendererLabel {\n  cursor: pointer;\n  display: inline-block;\n  width: 100%;\n}\n\n@-webkit-keyframes opacity-hide {\n  from {\n    opacity: 1;\n  }\n  to {\n    opacity: 0;\n    /*display: none;*/\n  }\n}\n@keyframes opacity-hide {\n  from {\n    /*display: block;*/\n    opacity: 1;\n  }\n  to {\n    opacity: 0;\n    /*display: none;*/\n  }\n}\n\n@-webkit-keyframes opacity-show {\n  from {\n    opacity: 0;\n    /*display: none;*/\n  }\n  to {\n    opacity: 1;\n    /*display: block;*/\n  }\n}\n@keyframes opacity-show {\n  from {\n    opacity: 0;\n    /*display: none;*/\n  }\n  to {\n    opacity: 1;\n    /*display: block;*/\n  }\n}\n\n/**\n * Handsontable in Handsontable\n */\n\n.handsontable .handsontable.ht_clone_top .wtHider {\n  padding: 0 0 5px 0;\n}\n\n/**\n* Autocomplete Editor\n*/\n.handsontable .autocompleteEditor.handsontable {\n  padding-right: 17px;\n}\n.handsontable .autocompleteEditor.handsontable.htMacScroll {\n  padding-right: 15px;\n}\n\n\n/**\n * Handsontable listbox theme\n */\n\n.handsontable.listbox {\n  margin: 0;\n}\n\n.handsontable.listbox .ht_master table {\n  border: 1px solid #ccc;\n  border-collapse: separate;\n  background: white;\n}\n\n.handsontable.listbox th,\n.handsontable.listbox tr:first-child th,\n.handsontable.listbox tr:last-child th,\n.handsontable.listbox tr:first-child td,\n.handsontable.listbox td {\n  border-color: transparent;\n}\n\n.handsontable.listbox th,\n.handsontable.listbox td {\n  white-space: nowrap;\n  text-overflow: ellipsis;\n}\n\n.handsontable.listbox td.htDimmed {\n  cursor: default;\n  color: inherit;\n  font-style: inherit;\n}\n\n.handsontable.listbox .wtBorder {\n  visibility: hidden;\n}\n\n.handsontable.listbox tr td.current,\n.handsontable.listbox tr:hover td {\n  background: #eee;\n}\n\n.ht_clone_top {\n  z-index: 101;\n}\n\n.ht_clone_left {\n  z-index: 102;\n}\n\n.ht_clone_top_left_corner,\n.ht_clone_bottom_left_corner {\n  z-index: 103;\n}\n\n.ht_clone_debug {\n  z-index: 103;\n}\n\n.handsontable td.htSearchResult {\n  background: #fcedd9;\n  color: #583707;\n}\n\n/*\nCell borders\n*/\n.htBordered{\n  /*box-sizing: border-box !important;*/\n  border-width: 1px;\n}\n.htBordered.htTopBorderSolid {\n  border-top-style: solid;\n  border-top-color: #000;\n}\n.htBordered.htRightBorderSolid {\n  border-right-style: solid;\n  border-right-color: #000;\n}\n.htBordered.htBottomBorderSolid {\n  border-bottom-style: solid;\n  border-bottom-color: #000;\n}\n.htBordered.htLeftBorderSolid {\n  border-left-style: solid;\n  border-left-color: #000;\n}\n\n.handsontable tbody tr th:nth-last-child(2) {\n  border-right: 1px solid #CCC;\n}\n\n.handsontable thead tr:nth-last-child(2) th.htGroupIndicatorContainer {\n  border-bottom: 1px solid #CCC;\n  padding-bottom: 5px;\n}\n\n\n.ht_clone_top_left_corner thead tr th:nth-last-child(2) {\n  border-right: 1px solid #CCC;\n}\n\n.htCollapseButton {\n  width: 10px;\n  height: 10px;\n  line-height: 10px;\n  text-align: center;\n  border-radius: 5px;\n  border: 1px solid #f3f3f3;\n  -webkit-box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.4);\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.4);\n  cursor: pointer;\n  margin-bottom: 3px;\n  position: relative;\n}\n\n.htCollapseButton:after {\n  content: \"\";\n  height: 300%;\n  width: 1px;\n  display: block;\n  background: #ccc;\n  margin-left: 4px;\n  position: absolute;\n  /*top: -300%;*/\n  bottom: 10px;\n}\n\n\nthead .htCollapseButton {\n  right: 5px;\n  position: absolute;\n  top: 5px;\n  background: #fff;\n}\n\nthead .htCollapseButton:after {\n  height: 1px;\n  width: 700%;\n  right: 10px;\n  top: 4px;\n}\n\n.handsontable tr th .htExpandButton {\n  position: absolute;\n  width: 10px;\n  height: 10px;\n  line-height: 10px;\n  text-align: center;\n  border-radius: 5px;\n  border: 1px solid #f3f3f3;\n  -webkit-box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.4);\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.4);\n  cursor: pointer;\n  top: 0;\n  display: none;\n}\n\n.handsontable thead tr th .htExpandButton {\n  /*left: 5px;*/\n  top: 5px;\n}\n\n.handsontable tr th .htExpandButton.clickable {\n  display: block;\n}\n\n.collapsibleIndicator {\n  position: absolute;\n  top: 50%;\n  transform: translate(0% ,-50%);\n  right: 5px;\n  border: 1px solid #A6A6A6;\n  line-height: 10px;\n  color: #222;\n  border-radius: 10px;\n  font-size: 10px;\n  width: 10px;\n  height: 10px;\n  cursor: pointer;\n  -webkit-box-shadow: 0 0 0 6px rgba(238,238,238,1);\n  -moz-box-shadow: 0 0 0 6px rgba(238,238,238,1);\n  box-shadow: 0 0 0 6px rgba(238,238,238,1);\n  background: #eee;\n}\n\n.handsontable col.hidden {\n  width: 0 !important;\n}\n\n.handsontable table tr th.lightRightBorder {\n  border-right: 1px solid #E6E6E6;\n}\n\n.handsontable tr.hidden,\n.handsontable tr.hidden td,\n.handsontable tr.hidden th {\n  display: none;\n}\n\n.ht_master,\n.ht_clone_left,\n.ht_clone_top,\n.ht_clone_bottom {\n  overflow: hidden;\n}\n\n.ht_master .wtHolder {\n  overflow: auto;\n}\n\n.ht_clone_left .wtHolder {\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n\n.ht_clone_top .wtHolder,\n.ht_clone_bottom .wtHolder {\n  overflow-x: auto;\n  overflow-y: hidden;\n}\n\n\n/*WalkontableDebugOverlay*/\n\n.wtDebugHidden {\n  display: none;\n}\n\n.wtDebugVisible {\n  display: block;\n  -webkit-animation-duration: 0.5s;\n  -webkit-animation-name: wtFadeInFromNone;\n  animation-duration: 0.5s;\n  animation-name: wtFadeInFromNone;\n}\n\n@keyframes wtFadeInFromNone {\n  0% {\n    display: none;\n    opacity: 0;\n  }\n\n  1% {\n    display: block;\n    opacity: 0;\n  }\n\n  100% {\n    display: block;\n    opacity: 1;\n  }\n}\n\n@-webkit-keyframes wtFadeInFromNone {\n  0% {\n    display: none;\n    opacity: 0;\n  }\n\n  1% {\n    display: block;\n    opacity: 0;\n  }\n\n  100% {\n    display: block;\n    opacity: 1;\n  }\n}\n/*\n\n Handsontable Mobile Text Editor stylesheet\n\n */\n\n.handsontable.mobile,\n.handsontable.mobile .wtHolder {\n  -webkit-touch-callout:none;\n  -webkit-user-select:none;\n  -khtml-user-select:none;\n  -moz-user-select:none;\n  -ms-user-select:none;\n  user-select:none;\n  -webkit-tap-highlight-color:rgba(0,0,0,0);\n  -webkit-overflow-scrolling: touch;\n}\n\n.htMobileEditorContainer {\n  display: none;\n  position: absolute;\n  top: 0;\n  width: 70%;\n  height: 54pt;\n  background: #f8f8f8;\n  border-radius: 20px;\n  border: 1px solid #ebebeb;\n  z-index: 999;\n  box-sizing: border-box;\n  -webkit-box-sizing: border-box;\n  -webkit-text-size-adjust: none;\n}\n\n.topLeftSelectionHandle:not(.ht_master .topLeftSelectionHandle),\n.topLeftSelectionHandle-HitArea:not(.ht_master .topLeftSelectionHandle-HitArea) {\n  z-index: 9999;\n}\n\n/* Initial left/top coordinates - overwritten when actual position is set */\n.topLeftSelectionHandle,\n.topLeftSelectionHandle-HitArea,\n.bottomRightSelectionHandle,\n.bottomRightSelectionHandle-HitArea {\n  left: -10000px;\n  top: -10000px;\n}\n\n.htMobileEditorContainer.active {\n  display: block;\n}\n\n.htMobileEditorContainer .inputs {\n  position: absolute;\n  right: 210pt;\n  bottom: 10pt;\n  top: 10pt;\n  left: 14px;\n  height: 34pt;\n}\n\n.htMobileEditorContainer .inputs textarea {\n  font-size: 13pt;\n  border: 1px solid #a1a1a1;\n  -webkit-appearance: none;\n  -webkit-box-shadow: none;\n  -moz-box-shadow: none;\n  box-shadow: none;\n  position: absolute;\n  left: 14px;\n  right: 14px;\n  top: 0;\n  bottom: 0;\n  padding: 7pt;\n}\n\n.htMobileEditorContainer .cellPointer {\n  position: absolute;\n  top: -13pt;\n  height: 0;\n  width: 0;\n  left: 30px;\n\n  border-left: 13pt solid transparent;\n  border-right: 13pt solid transparent;\n  border-bottom: 13pt solid #ebebeb;\n}\n\n.htMobileEditorContainer .cellPointer.hidden {\n  display: none;\n}\n\n.htMobileEditorContainer .cellPointer:before {\n  content: '';\n  display: block;\n  position: absolute;\n  top: 2px;\n  height: 0;\n  width: 0;\n  left: -13pt;\n\n  border-left: 13pt solid transparent;\n  border-right: 13pt solid transparent;\n  border-bottom: 13pt solid #f8f8f8;\n}\n\n.htMobileEditorContainer .moveHandle {\n  position: absolute;\n  top: 10pt;\n  left: 5px;\n  width: 30px;\n  bottom: 0px;\n  cursor: move;\n  z-index: 9999;\n}\n\n.htMobileEditorContainer .moveHandle:after {\n  content: \"..\\A..\\A..\\A..\";\n  white-space: pre;\n  line-height: 10px;\n  font-size: 20pt;\n  display: inline-block;\n  margin-top: -8px;\n  color: #ebebeb;\n}\n\n.htMobileEditorContainer .positionControls {\n  width: 205pt;\n  position: absolute;\n  right: 5pt;\n  top: 0;\n  bottom: 0;\n}\n\n.htMobileEditorContainer .positionControls > div {\n  width: 50pt;\n  height: 100%;\n  float: left;\n}\n\n.htMobileEditorContainer .positionControls > div:after {\n  content: \" \";\n  display: block;\n  width: 15pt;\n  height: 15pt;\n  text-align: center;\n  line-height: 50pt;\n}\n\n.htMobileEditorContainer .leftButton:after,\n.htMobileEditorContainer .rightButton:after,\n.htMobileEditorContainer .upButton:after,\n.htMobileEditorContainer .downButton:after {\n  transform-origin: 5pt 5pt;\n  -webkit-transform-origin: 5pt 5pt;\n  margin: 21pt 0 0 21pt;\n}\n\n.htMobileEditorContainer .leftButton:after {\n  border-top: 2px solid #288ffe;\n  border-left: 2px solid #288ffe;\n  -webkit-transform: rotate(-45deg);\n  /*margin-top: 17pt;*/\n  /*margin-left: 20pt;*/\n}\n.htMobileEditorContainer .leftButton:active:after {\n  border-color: #cfcfcf;\n}\n\n.htMobileEditorContainer .rightButton:after {\n  border-top: 2px solid #288ffe;\n  border-left: 2px solid #288ffe;\n  -webkit-transform: rotate(135deg);\n  /*margin-top: 17pt;*/\n  /*margin-left: 10pt;*/\n}\n.htMobileEditorContainer .rightButton:active:after {\n  border-color: #cfcfcf;\n}\n\n.htMobileEditorContainer .upButton:after {\n  /*border-top: 2px solid #cfcfcf;*/\n  border-top: 2px solid #288ffe;\n  border-left: 2px solid #288ffe;\n  -webkit-transform: rotate(45deg);\n  /*margin-top: 22pt;*/\n  /*margin-left: 15pt;*/\n}\n.htMobileEditorContainer .upButton:active:after {\n  border-color: #cfcfcf;\n}\n\n.htMobileEditorContainer .downButton:after {\n  border-top: 2px solid #288ffe;\n  border-left: 2px solid #288ffe;\n  -webkit-transform: rotate(225deg);\n  /*margin-top: 15pt;*/\n  /*margin-left: 15pt;*/\n}\n.htMobileEditorContainer .downButton:active:after {\n  border-color: #cfcfcf;\n}\n\n.handsontable.hide-tween {\n  -webkit-animation: opacity-hide 0.3s;\n  animation: opacity-hide 0.3s;\n  animation-fill-mode: forwards;\n  -webkit-animation-fill-mode: forwards;\n}\n\n.handsontable.show-tween {\n  -webkit-animation: opacity-show 0.3s;\n  animation: opacity-show 0.3s;\n  animation-fill-mode: forwards;\n  -webkit-animation-fill-mode: forwards;\n}\n.htCommentCell {\n    position: relative;\n}\n\n.htCommentCell:after {\n    content: '';\n    position: absolute;\n    top: 0;\n    right: 0;\n    border-left: 6px solid transparent;\n    border-top: 6px solid black;\n}\n\n.htComments {\n    display: none;\n    z-index: 1059;\n    position: absolute;\n}\n\n.htCommentTextArea {\n    box-shadow: rgba(0, 0, 0, 0.117647) 0 1px 3px, rgba(0, 0, 0, 0.239216) 0 1px 2px;\n    -webkit-box-sizing: border-box;\n    -moz-box-sizing: border-box;\n    box-sizing: border-box;\n    border: none;\n    border-left: 3px solid #ccc;\n    background-color: #fff;\n    width: 215px;\n    height: 90px;\n    font-size: 12px;\n    padding: 5px;\n    outline: 0px !important;\n    -webkit-appearance: none;\n}\n\n.htCommentTextArea:focus {\n    box-shadow: rgba(0, 0, 0, 0.117647) 0 1px 3px, rgba(0, 0, 0, 0.239216) 0 1px 2px, inset 0 0 0 1px #5292f7;\n    border-left: 3px solid #5292f7;\n}\n/*!\n * Handsontable ContextMenu\n */\n\n.htContextMenu {\n  display: none;\n  position: absolute;\n  z-index: 1060; /* needs to be higher than 1050 - z-index for Twitter Bootstrap modal (#1569) */\n}\n\n.htContextMenu .ht_clone_top,\n.htContextMenu .ht_clone_left,\n.htContextMenu .ht_clone_corner,\n.htContextMenu .ht_clone_debug {\n  display: none;\n}\n\n.htContextMenu table.htCore {\n  border: 1px solid #ccc;\n  border-bottom-width: 2px;\n  border-right-width: 2px;\n}\n\n.htContextMenu .wtBorder {\n  visibility: hidden;\n}\n\n.htContextMenu table tbody tr td {\n  background: white;\n  border-width: 0;\n  padding: 4px 6px 0 6px;\n  cursor: pointer;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n}\n\n.htContextMenu table tbody tr td:first-child {\n  border: 0;\n}\n\n.htContextMenu table tbody tr td.htDimmed {\n  font-style: normal;\n  color: #323232;\n}\n\n.htContextMenu table tbody tr td.current,\n.htContextMenu table tbody tr td.zeroclipboard-is-hover {\n  background: #f3f3f3;\n}\n\n.htContextMenu table tbody tr td.htSeparator {\n  border-top: 1px solid #bbb;\n  height: 0;\n  padding: 0;\n  cursor: default;\n}\n\n.htContextMenu table tbody tr td.htDisabled {\n  color: #999;\n  cursor: default;\n}\n\n.htContextMenu table tbody tr td.htDisabled:hover {\n  background: #fff;\n  color: #999;\n  cursor: default;\n}\n\n.htContextMenu table tbody tr.htHidden {\n  display: none;\n}\n\n.htContextMenu table tbody tr td .htItemWrapper {\n  margin-left: 10px;\n  margin-right: 6px;\n}\n\n.htContextMenu table tbody tr td div span.selected {\n  margin-top: -2px;\n  position: absolute;\n  left: 4px;\n}\n\n.htContextMenu .ht_master .wtHolder {\n  overflow: hidden;\n}\n.htRowHeaders .ht_master.innerBorderLeft ~ .ht_clone_top_left_corner th:nth-child(2),\n.htRowHeaders .ht_master.innerBorderLeft ~ .ht_clone_left td:first-of-type {\n  border-left: 0 none;\n}\n.handsontable .wtHider {\n  position: relative;\n}\n.handsontable.ht__manualColumnMove.after-selection--columns thead th.ht__highlight {\n  cursor: move;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n  cursor: grab;\n}\n.handsontable.ht__manualColumnMove.on-moving--columns,\n.handsontable.ht__manualColumnMove.on-moving--columns thead th.ht__highlight {\n  cursor: move;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n  cursor: grabbing;\n}\n.handsontable.ht__manualColumnMove.on-moving--columns .manualColumnResizer {\n  display: none;\n}\n.handsontable .ht__manualColumnMove--guideline,\n.handsontable .ht__manualColumnMove--backlight {\n  position: absolute;\n  height: 100%;\n  display: none;\n}\n.handsontable .ht__manualColumnMove--guideline {\n  background: #757575;\n  width: 2px;\n  top: 0;\n  margin-left: -1px;\n  z-index: 105;\n}\n.handsontable .ht__manualColumnMove--backlight {\n  background: #343434;\n  background: rgba(52, 52, 52, 0.25);\n  display: none;\n  z-index: 105;\n  pointer-events: none;\n}\n.handsontable.on-moving--columns.show-ui .ht__manualColumnMove--guideline,\n.handsontable.on-moving--columns .ht__manualColumnMove--backlight {\n  display: block;\n}\n.handsontable .wtHider {\n  position: relative;\n}\n.handsontable.ht__manualRowMove.after-selection--rows tbody th.ht__highlight {\n  cursor: move;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n  cursor: grab;\n}\n.handsontable.ht__manualRowMove.on-moving--rows,\n.handsontable.ht__manualRowMove.on-moving--rows tbody th.ht__highlight {\n  cursor: move;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n  cursor: grabbing;\n}\n.handsontable.ht__manualRowMove.on-moving--rows .manualRowResizer {\n  display: none;\n}\n.handsontable .ht__manualRowMove--guideline,\n.handsontable .ht__manualRowMove--backlight {\n  position: absolute;\n  width: 100%;\n  display: none;\n}\n.handsontable .ht__manualRowMove--guideline {\n  background: #757575;\n  height: 2px;\n  left: 0;\n  margin-top: -1px;\n  z-index: 105;\n}\n.handsontable .ht__manualRowMove--backlight {\n  background: #343434;\n  background: rgba(52, 52, 52, 0.25);\n  display: none;\n  z-index: 105;\n  pointer-events: none;\n}\n.handsontable.on-moving--rows.show-ui .ht__manualRowMove--guideline,\n.handsontable.on-moving--rows .ht__manualRowMove--backlight {\n  display: block;\n}\n@charset \"UTF-8\";\n\n/*!\n * Pikaday\n * Copyright Â© 2014 David Bushell | BSD & MIT license | http://dbushell.com/\n */\n\n.pika-single {\n    z-index: 9999;\n    display: block;\n    position: relative;\n    color: #333;\n    background: #fff;\n    border: 1px solid #ccc;\n    border-bottom-color: #bbb;\n    font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif;\n}\n\n/*\nclear child float (pika-lendar), using the famous micro clearfix hack\nhttp://nicolasgallagher.com/micro-clearfix-hack/\n*/\n.pika-single:before,\n.pika-single:after {\n    content: \" \";\n    display: table;\n}\n.pika-single:after { clear: both }\n.pika-single { *zoom: 1 }\n\n.pika-single.is-hidden {\n    display: none;\n}\n\n.pika-single.is-bound {\n    position: absolute;\n    box-shadow: 0 5px 15px -5px rgba(0,0,0,.5);\n}\n\n.pika-lendar {\n    float: left;\n    width: 240px;\n    margin: 8px;\n}\n\n.pika-title {\n    position: relative;\n    text-align: center;\n}\n\n.pika-label {\n    display: inline-block;\n    *display: inline;\n    position: relative;\n    z-index: 9999;\n    overflow: hidden;\n    margin: 0;\n    padding: 5px 3px;\n    font-size: 14px;\n    line-height: 20px;\n    font-weight: bold;\n    background-color: #fff;\n}\n.pika-title select {\n    cursor: pointer;\n    position: absolute;\n    z-index: 9998;\n    margin: 0;\n    left: 0;\n    top: 5px;\n    filter: alpha(opacity=0);\n    opacity: 0;\n}\n\n.pika-prev,\n.pika-next {\n    display: block;\n    cursor: pointer;\n    position: relative;\n    outline: none;\n    border: 0;\n    padding: 0;\n    width: 20px;\n    height: 30px;\n    /* hide text using text-indent trick, using width value (it's enough) */\n    text-indent: 20px;\n    white-space: nowrap;\n    overflow: hidden;\n    background-color: transparent;\n    background-position: center center;\n    background-repeat: no-repeat;\n    background-size: 75% 75%;\n    opacity: .5;\n    *position: absolute;\n    *top: 0;\n}\n\n.pika-prev:hover,\n.pika-next:hover {\n    opacity: 1;\n}\n\n.pika-prev,\n.is-rtl .pika-next {\n    float: left;\n    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAUklEQVR42u3VMQoAIBADQf8Pgj+OD9hG2CtONJB2ymQkKe0HbwAP0xucDiQWARITIDEBEnMgMQ8S8+AqBIl6kKgHiXqQqAeJepBo/z38J/U0uAHlaBkBl9I4GwAAAABJRU5ErkJggg==');\n    *left: 0;\n}\n\n.pika-next,\n.is-rtl .pika-prev {\n    float: right;\n    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAU0lEQVR42u3VOwoAMAgE0dwfAnNjU26bYkBCFGwfiL9VVWoO+BJ4Gf3gtsEKKoFBNTCoCAYVwaAiGNQGMUHMkjGbgjk2mIONuXo0nC8XnCf1JXgArVIZAQh5TKYAAAAASUVORK5CYII=');\n    *right: 0;\n}\n\n.pika-prev.is-disabled,\n.pika-next.is-disabled {\n    cursor: default;\n    opacity: .2;\n}\n\n.pika-select {\n    display: inline-block;\n    *display: inline;\n}\n\n.pika-table {\n    width: 100%;\n    border-collapse: collapse;\n    border-spacing: 0;\n    border: 0;\n}\n\n.pika-table th,\n.pika-table td {\n    width: 14.285714285714286%;\n    padding: 0;\n}\n\n.pika-table th {\n    color: #999;\n    font-size: 12px;\n    line-height: 25px;\n    font-weight: bold;\n    text-align: center;\n}\n\n.pika-button {\n    cursor: pointer;\n    display: block;\n    box-sizing: border-box;\n    -moz-box-sizing: border-box;\n    outline: none;\n    border: 0;\n    margin: 0;\n    width: 100%;\n    padding: 5px;\n    color: #666;\n    font-size: 12px;\n    line-height: 15px;\n    text-align: right;\n    background: #f5f5f5;\n}\n\n.pika-week {\n    font-size: 11px;\n    color: #999;\n}\n\n.is-today .pika-button {\n    color: #33aaff;\n    font-weight: bold;\n}\n\n.is-selected .pika-button {\n    color: #fff;\n    font-weight: bold;\n    background: #33aaff;\n    box-shadow: inset 0 1px 3px #178fe5;\n    border-radius: 3px;\n}\n\n.is-inrange .pika-button {\n    background: #D5E9F7;\n}\n\n.is-startrange .pika-button {\n    color: #fff;\n    background: #6CB31D;\n    box-shadow: none;\n    border-radius: 3px;\n}\n\n.is-endrange .pika-button {\n    color: #fff;\n    background: #33aaff;\n    box-shadow: none;\n    border-radius: 3px;\n}\n\n.is-disabled .pika-button,\n.is-outside-current-month .pika-button {\n    pointer-events: none;\n    cursor: default;\n    color: #999;\n    opacity: .3;\n}\n\n.pika-button:hover {\n    color: #fff;\n    background: #ff8000;\n    box-shadow: none;\n    border-radius: 3px;\n}\n\n/* styling for abbr */\n.pika-table abbr {\n    border-bottom: none;\n    cursor: help;\n}\n\n", "", {"version":3,"sources":["/home/kimnh/Codes/WebShop/admin-template/laravel-vue-admin/node_modules/handsontable/dist/handsontable.full.css"],"names":[],"mappings":"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AAsD;CACvD;;AAED;EACE,mBAAmB;EACnB,OAAO;EACP,QAAQ;EACR,aAAa;CACd;;AAED;EACE,+CAA+C;EAC/C,mBAAmB;EACnB,YAAY;CACb;;AAED;;EAEE;;AAEF;EACE,YAAY;CACb;;AAED;EACE,mBAAmB;CACpB;;AAED;EACE,iBAAa;EACb,YAAY;EACZ,mBAAmB;EACnB,WAAW;CACZ;;;AAGD;;EAEE;AACF;EACE,iBAAiB;CAClB;AACD;EACE,mBAAmB;CACpB;AACD;EACE,kBAAkB;CACnB;AACD;EACE,oBAAoB;CACrB;AACD;;EAEE;AACF;EACE,oBAAoB;CACrB;AACD;EACE,uBAAuB;CACxB;AACD;EACE,uBAAuB;CACxB;;AAED;;EAEE;;AAEF;EACE,YAAY;CACb;;AAED;;EAEE;;AAEF;EACE,aAAa;EACb,gBAAgB;EAChB,YAAY;EACZ,gBAAgB;EAChB,YAAY;EACZ,mBAAmB;CACpB;;AAED;EACE,YAAY;CACb;;AAED;EACE,eAAe;CAChB;;AAED;;EAEE;AACF;EACE,sBAAsB;EACtB,uBAAuB;CACxB;AACD;EACE,aAAa;CACd;AACD;EACE,gBAAgB;EAChB,sBAAsB;EACtB,YAAY;CACb;;AAED;EACE;IACE,WAAW;GACZ;EACD;IACE,WAAW;IACX,kBAAkB;GACnB;CACF;AACD;EACE;IACE,mBAAmB;IACnB,WAAW;GACZ;EACD;IACE,WAAW;IACX,kBAAkB;GACnB;CACF;;AAED;EACE;IACE,WAAW;IACX,kBAAkB;GACnB;EACD;IACE,WAAW;IACX,mBAAmB;GACpB;CACF;AACD;EACE;IACE,WAAW;IACX,kBAAkB;GACnB;EACD;IACE,WAAW;IACX,mBAAmB;GACpB;CACF;;AAED;;GAEG;;AAEH;EACE,mBAAmB;CACpB;;AAED;;EAEE;AACF;EACE,oBAAoB;CACrB;AACD;EACE,oBAAoB;CACrB;;;AAGD;;GAEG;;AAEH;EACE,UAAU;CACX;;AAED;EACE,uBAAuB;EACvB,0BAA0B;EAC1B,kBAAkB;CACnB;;AAED;;;;;EAKE,0BAA0B;CAC3B;;AAED;;EAE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CAAsC;CACvC;AACD;IACI,mBAAmB;CACtB;;AAED;IACI,YAAY;IACZ,mBAAmB;IACnB,OAAO;IACP,SAAS;IACT,mCAAmC;IACnC,4BAA4B;CAC/B;;AAED;IACI,cAAc;IACd,cAAc;IACd,mBAAmB;CACtB;;AAED;IACI,iFAAiF;IACjF,+BAA+B;IAC/B,4BAA4B;IAC5B,uBAAuB;IACvB,aAAa;IACb,4BAA4B;IAC5B,uBAAuB;IACvB,aAAa;IACb,aAAa;IACb,gBAAgB;IAChB,aAAa;IACb,wBAAwB;IACxB,yBAAyB;CAC5B;;AAED;IACI,0GAA0G;IAC1G,+BAA+B;CAClC;AACD;;GAEG;;AAEH;EACE,cAAc;EACd,mBAAmB;EACnB,cAAc,CAAC,gFAAgF;CAChG;;AAED;;;;EAIE,cAAc;CACf;;AAED;EACE,uBAAuB;EACvB,yBAAyB;EACzB,wBAAwB;CACzB;;AAED;EACE,mBAAmB;CACpB;;AAED;EACE,kBAAkB;EAClB,gBAAgB;EAChB,uBAAuB;EACvB,gBAAgB;EAChB,iBAAiB;EACjB,oBAAoB;EACpB,wBAAwB;CACzB;;AAED;EACE,UAAU;CACX;;AAED;EACE,mBAAmB;EACnB,eAAe;CAChB;;AAED;;EAEE,oBAAoB;CACrB;;AAED;EACE,2BAA2B;EAC3B,UAAU;EACV,WAAW;EACX,gBAAgB;CACjB;;AAED;EACE,YAAY;EACZ,gBAAgB;CACjB;;AAED;EACE,iBAAiB;EACjB,YAAY;EACZ,gBAAgB;CACjB;;AAED;EACE,cAAc;CACf;;AAED;EACE,kBAAkB;EAClB,kBAAkB;CACnB;;AAED;EACE,iBAAiB;EACjB,mBAAmB;EACnB,UAAU;CACX;;AAED;EACE,iBAAiB;CAClB;AACD;;EAEE,oBAAoB;CACrB;AACD;EACE,mBAAmB;CACpB;AACD;EACE,aAAa;EACb,kBAAkB;EAClB,qBAAqB;EACrB,aAAa;CACd;AACD;;EAEE,aAAa;EACb,sBAAsB;EACtB,yBAAyB;EACzB,iBAAiB;CAClB;AACD;EACE,cAAc;CACf;AACD;;EAEE,mBAAmB;EACnB,aAAa;EACb,cAA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","file":"handsontable.full.css","sourcesContent":["/*!\n(The MIT License)\n\nCopyright (c) 2012-2014 Marcin Warpechowski\nCopyright (c) 2015 Handsoncode sp. z o.o. <hello@handsoncode.net>\n\nPermission is hereby granted, free of charge, to any person obtaining\na copy of this software and associated documentation files (the\n'Software'), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\nIN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\nCLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\nTORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\nSOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n*/\n.handsontable {\n  position: relative;\n}\n\n.handsontable .hide{\n  display: none;\n}\n.handsontable .relative {\n  position: relative;\n}\n\n.handsontable.htAutoSize {\n  visibility: hidden;\n  left: -99000px;\n  position: absolute;\n  top: -99000px;\n}\n\n.handsontable .wtHider {\n  width: 0;\n}\n\n.handsontable .wtSpreader {\n  position: relative;\n  width: 0; /*must be 0, otherwise blank space appears in scroll demo after scrolling max to the right */\n  height: auto;\n}\n\n.handsontable table,\n.handsontable tbody,\n.handsontable thead,\n.handsontable td,\n.handsontable th,\n.handsontable input,\n.handsontable textarea,\n.handsontable div {\n  box-sizing: content-box;\n  -webkit-box-sizing: content-box;\n  -moz-box-sizing: content-box;\n}\n\n.handsontable input,\n.handsontable textarea {\n  min-height: initial;\n}\n\n.handsontable table.htCore {\n  border-collapse: separate;\n  /*it must be separate, otherwise there are offset miscalculations in WebKit: http://stackoverflow.com/questions/2655987/border-collapse-differences-in-ff-and-webkit*/\n  /*this actually only changes appearance of user selection - does not make text unselectable\n  -webkit-user-select: none;\n  -khtml-user-select: none;\n  -moz-user-select: none;\n  -o-user-select: none;\n  -ms-user-select: none;\n  /*user-select: none; /*no browser supports unprefixed version*/\n  border-spacing: 0;\n  margin: 0;\n  border-width: 0;\n  table-layout: fixed;\n  width: 0;\n  outline-width: 0;\n  /* reset bootstrap table style. for more info see: https://github.com/handsontable/handsontable/issues/224 */\n  max-width: none;\n  max-height: none;\n}\n\n.handsontable col {\n  width: 50px;\n}\n\n.handsontable col.rowHeader {\n  width: 50px;\n}\n\n.handsontable th,\n.handsontable td {\n  border-top-width: 0;\n  border-left-width: 0;\n  border-right: 1px solid #CCC;\n  border-bottom: 1px solid #CCC;\n  height: 22px;\n  empty-cells: show;\n  line-height: 21px;\n  padding: 0 4px 0 4px;\n  /* top, bottom padding different than 0 is handled poorly by FF with HTML5 doctype */\n  background-color: #FFF;\n  vertical-align: top;\n  overflow: hidden;\n  outline-width: 0;\n  white-space: pre-line;\n  /* preserve new line character in cell */\n  background-clip: padding-box;\n}\n\n.handsontable td.htInvalid {\n  background-color: #ff4c42 !important; /*gives priority over td.area selection background*/\n}\n\n.handsontable td.htNoWrap {\n  white-space: nowrap;\n}\n\n.handsontable th:last-child {\n  /*Foundation framework fix*/\n  border-right: 1px solid #CCC;\n  border-bottom: 1px solid #CCC;\n}\n\n.handsontable tr:first-child th.htNoFrame,\n.handsontable th:first-child.htNoFrame,\n.handsontable th.htNoFrame {\n  border-left-width: 0;\n  background-color: white;\n  border-color: #FFF;\n}\n\n.handsontable th:first-child,\n.handsontable th:nth-child(2),\n.handsontable td:first-of-type,\n.handsontable .htNoFrame + th,\n.handsontable .htNoFrame + td {\n  border-left: 1px solid #CCC;\n}\n\n.handsontable.htRowHeaders thead tr th:nth-child(2) {\n  border-left: 1px solid #CCC;\n}\n\n.handsontable tr:first-child th,\n.handsontable tr:first-child td {\n  border-top: 1px solid #CCC;\n}\n\n.ht_master:not(.innerBorderLeft):not(.emptyColumns) ~ .handsontable tbody tr th,\n.ht_master:not(.innerBorderLeft):not(.emptyColumns) ~ .handsontable:not(.ht_clone_top) thead tr th:first-child {\n  border-right-width: 0;\n}\n\n.ht_master:not(.innerBorderTop) thead tr:last-child th,\n.ht_master:not(.innerBorderTop) ~ .handsontable thead tr:last-child th,\n.ht_master:not(.innerBorderTop) thead tr.lastChild th,\n.ht_master:not(.innerBorderTop) ~ .handsontable thead tr.lastChild th {\n  border-bottom-width: 0;\n}\n\n.handsontable th {\n  background-color: #f3f3f3;\n  color: #222;\n  text-align: center;\n  font-weight: normal;\n  white-space: nowrap;\n}\n\n.handsontable thead th {\n  padding: 0;\n}\n\n.handsontable th.active {\n  background-color: #CCC;\n}\n.handsontable thead th .relative {\n  padding: 2px 4px;\n}\n\n/* selection */\n.handsontable tbody th.ht__highlight,\n.handsontable thead th.ht__highlight {\n  background-color: #dcdcdc;\n}\n.handsontable.ht__selection--columns thead th.ht__highlight,\n.handsontable.ht__selection--rows tbody th.ht__highlight {\n  background-color: #8eb0e7;\n  color: #000;\n}\n\n/* plugins */\n\n/* row + column resizer*/\n.handsontable .manualColumnResizer {\n  position: fixed;\n  top: 0;\n  cursor: col-resize;\n  z-index: 110;\n  width: 5px;\n  height: 25px;\n}\n\n.handsontable .manualRowResizer {\n  position: fixed;\n  left: 0;\n  cursor: row-resize;\n  z-index: 110;\n  height: 5px;\n  width: 50px;\n}\n\n.handsontable .manualColumnResizer:hover,\n.handsontable .manualColumnResizer.active,\n.handsontable .manualRowResizer:hover,\n.handsontable .manualRowResizer.active {\n  background-color: #AAB;\n}\n\n.handsontable .manualColumnResizerGuide {\n  position: fixed;\n  right: 0;\n  top: 0;\n  background-color: #AAB;\n  display: none;\n  width: 0;\n  border-right: 1px dashed #777;\n  margin-left: 5px;\n}\n\n.handsontable .manualRowResizerGuide {\n  position: fixed;\n  left: 0;\n  bottom: 0;\n  background-color: #AAB;\n  display: none;\n  height: 0;\n  border-bottom: 1px dashed #777;\n  margin-top: 5px;\n}\n\n.handsontable .manualColumnResizerGuide.active,\n.handsontable .manualRowResizerGuide.active {\n  display: block;\n  z-index: 199;\n}\n\n.handsontable .columnSorting {\n  position: relative;\n}\n\n.handsontable .columnSorting:hover {\n  text-decoration: underline;\n  cursor: pointer;\n}\n\n.handsontable .columnSorting.ascending::after {\n  content: '\\25B2';\n  color: #5f5f5f;\n  position: absolute;\n  right: -15px;\n}\n\n.handsontable .columnSorting.descending::after {\n  content: '\\25BC';\n  color: #5f5f5f;\n  position: absolute;\n  right: -15px;\n}\n\n/* border line */\n\n.handsontable .wtBorder {\n  position: absolute;\n  font-size: 0;\n}\n.handsontable .wtBorder.hidden{\n  display:none !important;\n}\n\n.handsontable td.area {\n  background: -moz-linear-gradient(top,  rgba(181,209,255,0.34) 0%, rgba(181,209,255,0.34) 100%); /* FF3.6+ */\n  background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(181,209,255,0.34)), color-stop(100%,rgba(181,209,255,0.34))); /* Chrome,Safari4+ */\n  background: -webkit-linear-gradient(top,  rgba(181,209,255,0.34) 0%,rgba(181,209,255,0.34) 100%); /* Chrome10+,Safari5.1+ */\n  background: -o-linear-gradient(top,  rgba(181,209,255,0.34) 0%,rgba(181,209,255,0.34) 100%); /* Opera 11.10+ */\n  background: -ms-linear-gradient(top,  rgba(181,209,255,0.34) 0%,rgba(181,209,255,0.34) 100%); /* IE10+ */\n  background: linear-gradient(to bottom,  rgba(181,209,255,0.34) 0%,rgba(181,209,255,0.34) 100%); /* W3C */\n  filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#57b5d1ff', endColorstr='#57b5d1ff',GradientType=0 ); /* IE6-9 */\n  background-color: #fff;\n}\n\n/* fill handle */\n\n.handsontable .wtBorder.corner {\n  font-size: 0;\n  cursor: crosshair;\n}\n\n.handsontable .htBorder.htFillBorder {\n  background: red;\n  width: 1px;\n  height: 1px;\n}\n\n.handsontableInput {\n  border:none;\n  outline-width: 0;\n  margin: 0 ;\n  padding: 1px 5px 0 5px;\n  font-family: inherit;\n  line-height: 21px;\n  font-size: inherit;\n  box-shadow: 0 0 0 2px #5292F7 inset;\n  resize: none;\n  /*below are needed to overwrite stuff added by jQuery UI Bootstrap theme*/\n  display: inline-block;\n  color: #000;\n  border-radius: 0;\n  background-color: #FFF;\n  /*overwrite styles potentionally made by a framework*/\n}\n\n.handsontableInputHolder {\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 100;\n}\n\n.htSelectEditor {\n  -webkit-appearance: menulist-button !important;\n  position: absolute;\n  width: auto;\n}\n\n/*\nTextRenderer readOnly cell\n*/\n\n.handsontable .htDimmed {\n  color: #777;\n}\n\n.handsontable .htSubmenu {\n  position: relative;\n}\n\n.handsontable .htSubmenu :after{\n  content: 'â¶';\n  color: #777;\n  position: absolute;\n  right: 5px;\n}\n\n\n/*\nTextRenderer horizontal alignment\n*/\n.handsontable .htLeft{\n  text-align: left;\n}\n.handsontable .htCenter{\n  text-align: center;\n}\n.handsontable .htRight{\n  text-align: right;\n}\n.handsontable .htJustify{\n  text-align: justify;\n}\n/*\nTextRenderer vertical alignment\n*/\n.handsontable .htTop{\n  vertical-align: top;\n}\n.handsontable .htMiddle{\n  vertical-align: middle;\n}\n.handsontable .htBottom{\n  vertical-align: bottom;\n}\n\n/*\nTextRenderer placeholder value\n*/\n\n.handsontable .htPlaceholder {\n  color: #999;\n}\n\n/*\nAutocompleteRenderer down arrow\n*/\n\n.handsontable .htAutocompleteArrow {\n  float: right;\n  font-size: 10px;\n  color: #EEE;\n  cursor: default;\n  width: 16px;\n  text-align: center;\n}\n\n.handsontable td .htAutocompleteArrow:hover {\n  color: #777;\n}\n\n.handsontable td.area .htAutocompleteArrow {\n  color: #d3d3d3;\n}\n\n/*\nCheckboxRenderer\n*/\n.handsontable .htCheckboxRendererInput {\n  display: inline-block;\n  vertical-align: middle;\n}\n.handsontable .htCheckboxRendererInput.noValue {\n  opacity: 0.5;\n}\n.handsontable .htCheckboxRendererLabel {\n  cursor: pointer;\n  display: inline-block;\n  width: 100%;\n}\n\n@-webkit-keyframes opacity-hide {\n  from {\n    opacity: 1;\n  }\n  to {\n    opacity: 0;\n    /*display: none;*/\n  }\n}\n@keyframes opacity-hide {\n  from {\n    /*display: block;*/\n    opacity: 1;\n  }\n  to {\n    opacity: 0;\n    /*display: none;*/\n  }\n}\n\n@-webkit-keyframes opacity-show {\n  from {\n    opacity: 0;\n    /*display: none;*/\n  }\n  to {\n    opacity: 1;\n    /*display: block;*/\n  }\n}\n@keyframes opacity-show {\n  from {\n    opacity: 0;\n    /*display: none;*/\n  }\n  to {\n    opacity: 1;\n    /*display: block;*/\n  }\n}\n\n/**\n * Handsontable in Handsontable\n */\n\n.handsontable .handsontable.ht_clone_top .wtHider {\n  padding: 0 0 5px 0;\n}\n\n/**\n* Autocomplete Editor\n*/\n.handsontable .autocompleteEditor.handsontable {\n  padding-right: 17px;\n}\n.handsontable .autocompleteEditor.handsontable.htMacScroll {\n  padding-right: 15px;\n}\n\n\n/**\n * Handsontable listbox theme\n */\n\n.handsontable.listbox {\n  margin: 0;\n}\n\n.handsontable.listbox .ht_master table {\n  border: 1px solid #ccc;\n  border-collapse: separate;\n  background: white;\n}\n\n.handsontable.listbox th,\n.handsontable.listbox tr:first-child th,\n.handsontable.listbox tr:last-child th,\n.handsontable.listbox tr:first-child td,\n.handsontable.listbox td {\n  border-color: transparent;\n}\n\n.handsontable.listbox th,\n.handsontable.listbox td {\n  white-space: nowrap;\n  text-overflow: ellipsis;\n}\n\n.handsontable.listbox td.htDimmed {\n  cursor: default;\n  color: inherit;\n  font-style: inherit;\n}\n\n.handsontable.listbox .wtBorder {\n  visibility: hidden;\n}\n\n.handsontable.listbox tr td.current,\n.handsontable.listbox tr:hover td {\n  background: #eee;\n}\n\n.ht_clone_top {\n  z-index: 101;\n}\n\n.ht_clone_left {\n  z-index: 102;\n}\n\n.ht_clone_top_left_corner,\n.ht_clone_bottom_left_corner {\n  z-index: 103;\n}\n\n.ht_clone_debug {\n  z-index: 103;\n}\n\n.handsontable td.htSearchResult {\n  background: #fcedd9;\n  color: #583707;\n}\n\n/*\nCell borders\n*/\n.htBordered{\n  /*box-sizing: border-box !important;*/\n  border-width: 1px;\n}\n.htBordered.htTopBorderSolid {\n  border-top-style: solid;\n  border-top-color: #000;\n}\n.htBordered.htRightBorderSolid {\n  border-right-style: solid;\n  border-right-color: #000;\n}\n.htBordered.htBottomBorderSolid {\n  border-bottom-style: solid;\n  border-bottom-color: #000;\n}\n.htBordered.htLeftBorderSolid {\n  border-left-style: solid;\n  border-left-color: #000;\n}\n\n.handsontable tbody tr th:nth-last-child(2) {\n  border-right: 1px solid #CCC;\n}\n\n.handsontable thead tr:nth-last-child(2) th.htGroupIndicatorContainer {\n  border-bottom: 1px solid #CCC;\n  padding-bottom: 5px;\n}\n\n\n.ht_clone_top_left_corner thead tr th:nth-last-child(2) {\n  border-right: 1px solid #CCC;\n}\n\n.htCollapseButton {\n  width: 10px;\n  height: 10px;\n  line-height: 10px;\n  text-align: center;\n  border-radius: 5px;\n  border: 1px solid #f3f3f3;\n  -webkit-box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.4);\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.4);\n  cursor: pointer;\n  margin-bottom: 3px;\n  position: relative;\n}\n\n.htCollapseButton:after {\n  content: \"\";\n  height: 300%;\n  width: 1px;\n  display: block;\n  background: #ccc;\n  margin-left: 4px;\n  position: absolute;\n  /*top: -300%;*/\n  bottom: 10px;\n}\n\n\nthead .htCollapseButton {\n  right: 5px;\n  position: absolute;\n  top: 5px;\n  background: #fff;\n}\n\nthead .htCollapseButton:after {\n  height: 1px;\n  width: 700%;\n  right: 10px;\n  top: 4px;\n}\n\n.handsontable tr th .htExpandButton {\n  position: absolute;\n  width: 10px;\n  height: 10px;\n  line-height: 10px;\n  text-align: center;\n  border-radius: 5px;\n  border: 1px solid #f3f3f3;\n  -webkit-box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.4);\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.4);\n  cursor: pointer;\n  top: 0;\n  display: none;\n}\n\n.handsontable thead tr th .htExpandButton {\n  /*left: 5px;*/\n  top: 5px;\n}\n\n.handsontable tr th .htExpandButton.clickable {\n  display: block;\n}\n\n.collapsibleIndicator {\n  position: absolute;\n  top: 50%;\n  transform: translate(0% ,-50%);\n  right: 5px;\n  border: 1px solid #A6A6A6;\n  line-height: 10px;\n  color: #222;\n  border-radius: 10px;\n  font-size: 10px;\n  width: 10px;\n  height: 10px;\n  cursor: pointer;\n  -webkit-box-shadow: 0 0 0 6px rgba(238,238,238,1);\n  -moz-box-shadow: 0 0 0 6px rgba(238,238,238,1);\n  box-shadow: 0 0 0 6px rgba(238,238,238,1);\n  background: #eee;\n}\n\n.handsontable col.hidden {\n  width: 0 !important;\n}\n\n.handsontable table tr th.lightRightBorder {\n  border-right: 1px solid #E6E6E6;\n}\n\n.handsontable tr.hidden,\n.handsontable tr.hidden td,\n.handsontable tr.hidden th {\n  display: none;\n}\n\n.ht_master,\n.ht_clone_left,\n.ht_clone_top,\n.ht_clone_bottom {\n  overflow: hidden;\n}\n\n.ht_master .wtHolder {\n  overflow: auto;\n}\n\n.ht_clone_left .wtHolder {\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n\n.ht_clone_top .wtHolder,\n.ht_clone_bottom .wtHolder {\n  overflow-x: auto;\n  overflow-y: hidden;\n}\n\n\n/*WalkontableDebugOverlay*/\n\n.wtDebugHidden {\n  display: none;\n}\n\n.wtDebugVisible {\n  display: block;\n  -webkit-animation-duration: 0.5s;\n  -webkit-animation-name: wtFadeInFromNone;\n  animation-duration: 0.5s;\n  animation-name: wtFadeInFromNone;\n}\n\n@keyframes wtFadeInFromNone {\n  0% {\n    display: none;\n    opacity: 0;\n  }\n\n  1% {\n    display: block;\n    opacity: 0;\n  }\n\n  100% {\n    display: block;\n    opacity: 1;\n  }\n}\n\n@-webkit-keyframes wtFadeInFromNone {\n  0% {\n    display: none;\n    opacity: 0;\n  }\n\n  1% {\n    display: block;\n    opacity: 0;\n  }\n\n  100% {\n    display: block;\n    opacity: 1;\n  }\n}\n/*\n\n Handsontable Mobile Text Editor stylesheet\n\n */\n\n.handsontable.mobile,\n.handsontable.mobile .wtHolder {\n  -webkit-touch-callout:none;\n  -webkit-user-select:none;\n  -khtml-user-select:none;\n  -moz-user-select:none;\n  -ms-user-select:none;\n  user-select:none;\n  -webkit-tap-highlight-color:rgba(0,0,0,0);\n  -webkit-overflow-scrolling: touch;\n}\n\n.htMobileEditorContainer {\n  display: none;\n  position: absolute;\n  top: 0;\n  width: 70%;\n  height: 54pt;\n  background: #f8f8f8;\n  border-radius: 20px;\n  border: 1px solid #ebebeb;\n  z-index: 999;\n  box-sizing: border-box;\n  -webkit-box-sizing: border-box;\n  -webkit-text-size-adjust: none;\n}\n\n.topLeftSelectionHandle:not(.ht_master .topLeftSelectionHandle),\n.topLeftSelectionHandle-HitArea:not(.ht_master .topLeftSelectionHandle-HitArea) {\n  z-index: 9999;\n}\n\n/* Initial left/top coordinates - overwritten when actual position is set */\n.topLeftSelectionHandle,\n.topLeftSelectionHandle-HitArea,\n.bottomRightSelectionHandle,\n.bottomRightSelectionHandle-HitArea {\n  left: -10000px;\n  top: -10000px;\n}\n\n.htMobileEditorContainer.active {\n  display: block;\n}\n\n.htMobileEditorContainer .inputs {\n  position: absolute;\n  right: 210pt;\n  bottom: 10pt;\n  top: 10pt;\n  left: 14px;\n  height: 34pt;\n}\n\n.htMobileEditorContainer .inputs textarea {\n  font-size: 13pt;\n  border: 1px solid #a1a1a1;\n  -webkit-appearance: none;\n  -webkit-box-shadow: none;\n  -moz-box-shadow: none;\n  box-shadow: none;\n  position: absolute;\n  left: 14px;\n  right: 14px;\n  top: 0;\n  bottom: 0;\n  padding: 7pt;\n}\n\n.htMobileEditorContainer .cellPointer {\n  position: absolute;\n  top: -13pt;\n  height: 0;\n  width: 0;\n  left: 30px;\n\n  border-left: 13pt solid transparent;\n  border-right: 13pt solid transparent;\n  border-bottom: 13pt solid #ebebeb;\n}\n\n.htMobileEditorContainer .cellPointer.hidden {\n  display: none;\n}\n\n.htMobileEditorContainer .cellPointer:before {\n  content: '';\n  display: block;\n  position: absolute;\n  top: 2px;\n  height: 0;\n  width: 0;\n  left: -13pt;\n\n  border-left: 13pt solid transparent;\n  border-right: 13pt solid transparent;\n  border-bottom: 13pt solid #f8f8f8;\n}\n\n.htMobileEditorContainer .moveHandle {\n  position: absolute;\n  top: 10pt;\n  left: 5px;\n  width: 30px;\n  bottom: 0px;\n  cursor: move;\n  z-index: 9999;\n}\n\n.htMobileEditorContainer .moveHandle:after {\n  content: \"..\\a..\\a..\\a..\";\n  white-space: pre;\n  line-height: 10px;\n  font-size: 20pt;\n  display: inline-block;\n  margin-top: -8px;\n  color: #ebebeb;\n}\n\n.htMobileEditorContainer .positionControls {\n  width: 205pt;\n  position: absolute;\n  right: 5pt;\n  top: 0;\n  bottom: 0;\n}\n\n.htMobileEditorContainer .positionControls > div {\n  width: 50pt;\n  height: 100%;\n  float: left;\n}\n\n.htMobileEditorContainer .positionControls > div:after {\n  content: \" \";\n  display: block;\n  width: 15pt;\n  height: 15pt;\n  text-align: center;\n  line-height: 50pt;\n}\n\n.htMobileEditorContainer .leftButton:after,\n.htMobileEditorContainer .rightButton:after,\n.htMobileEditorContainer .upButton:after,\n.htMobileEditorContainer .downButton:after {\n  transform-origin: 5pt 5pt;\n  -webkit-transform-origin: 5pt 5pt;\n  margin: 21pt 0 0 21pt;\n}\n\n.htMobileEditorContainer .leftButton:after {\n  border-top: 2px solid #288ffe;\n  border-left: 2px solid #288ffe;\n  -webkit-transform: rotate(-45deg);\n  /*margin-top: 17pt;*/\n  /*margin-left: 20pt;*/\n}\n.htMobileEditorContainer .leftButton:active:after {\n  border-color: #cfcfcf;\n}\n\n.htMobileEditorContainer .rightButton:after {\n  border-top: 2px solid #288ffe;\n  border-left: 2px solid #288ffe;\n  -webkit-transform: rotate(135deg);\n  /*margin-top: 17pt;*/\n  /*margin-left: 10pt;*/\n}\n.htMobileEditorContainer .rightButton:active:after {\n  border-color: #cfcfcf;\n}\n\n.htMobileEditorContainer .upButton:after {\n  /*border-top: 2px solid #cfcfcf;*/\n  border-top: 2px solid #288ffe;\n  border-left: 2px solid #288ffe;\n  -webkit-transform: rotate(45deg);\n  /*margin-top: 22pt;*/\n  /*margin-left: 15pt;*/\n}\n.htMobileEditorContainer .upButton:active:after {\n  border-color: #cfcfcf;\n}\n\n.htMobileEditorContainer .downButton:after {\n  border-top: 2px solid #288ffe;\n  border-left: 2px solid #288ffe;\n  -webkit-transform: rotate(225deg);\n  /*margin-top: 15pt;*/\n  /*margin-left: 15pt;*/\n}\n.htMobileEditorContainer .downButton:active:after {\n  border-color: #cfcfcf;\n}\n\n.handsontable.hide-tween {\n  -webkit-animation: opacity-hide 0.3s;\n  animation: opacity-hide 0.3s;\n  animation-fill-mode: forwards;\n  -webkit-animation-fill-mode: forwards;\n}\n\n.handsontable.show-tween {\n  -webkit-animation: opacity-show 0.3s;\n  animation: opacity-show 0.3s;\n  animation-fill-mode: forwards;\n  -webkit-animation-fill-mode: forwards;\n}\n.htCommentCell {\n    position: relative;\n}\n\n.htCommentCell:after {\n    content: '';\n    position: absolute;\n    top: 0;\n    right: 0;\n    border-left: 6px solid transparent;\n    border-top: 6px solid black;\n}\n\n.htComments {\n    display: none;\n    z-index: 1059;\n    position: absolute;\n}\n\n.htCommentTextArea {\n    box-shadow: rgba(0, 0, 0, 0.117647) 0 1px 3px, rgba(0, 0, 0, 0.239216) 0 1px 2px;\n    -webkit-box-sizing: border-box;\n    -moz-box-sizing: border-box;\n    box-sizing: border-box;\n    border: none;\n    border-left: 3px solid #ccc;\n    background-color: #fff;\n    width: 215px;\n    height: 90px;\n    font-size: 12px;\n    padding: 5px;\n    outline: 0px !important;\n    -webkit-appearance: none;\n}\n\n.htCommentTextArea:focus {\n    box-shadow: rgba(0, 0, 0, 0.117647) 0 1px 3px, rgba(0, 0, 0, 0.239216) 0 1px 2px, inset 0 0 0 1px #5292f7;\n    border-left: 3px solid #5292f7;\n}\n/*!\n * Handsontable ContextMenu\n */\n\n.htContextMenu {\n  display: none;\n  position: absolute;\n  z-index: 1060; /* needs to be higher than 1050 - z-index for Twitter Bootstrap modal (#1569) */\n}\n\n.htContextMenu .ht_clone_top,\n.htContextMenu .ht_clone_left,\n.htContextMenu .ht_clone_corner,\n.htContextMenu .ht_clone_debug {\n  display: none;\n}\n\n.htContextMenu table.htCore {\n  border: 1px solid #ccc;\n  border-bottom-width: 2px;\n  border-right-width: 2px;\n}\n\n.htContextMenu .wtBorder {\n  visibility: hidden;\n}\n\n.htContextMenu table tbody tr td {\n  background: white;\n  border-width: 0;\n  padding: 4px 6px 0 6px;\n  cursor: pointer;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n}\n\n.htContextMenu table tbody tr td:first-child {\n  border: 0;\n}\n\n.htContextMenu table tbody tr td.htDimmed {\n  font-style: normal;\n  color: #323232;\n}\n\n.htContextMenu table tbody tr td.current,\n.htContextMenu table tbody tr td.zeroclipboard-is-hover {\n  background: #f3f3f3;\n}\n\n.htContextMenu table tbody tr td.htSeparator {\n  border-top: 1px solid #bbb;\n  height: 0;\n  padding: 0;\n  cursor: default;\n}\n\n.htContextMenu table tbody tr td.htDisabled {\n  color: #999;\n  cursor: default;\n}\n\n.htContextMenu table tbody tr td.htDisabled:hover {\n  background: #fff;\n  color: #999;\n  cursor: default;\n}\n\n.htContextMenu table tbody tr.htHidden {\n  display: none;\n}\n\n.htContextMenu table tbody tr td .htItemWrapper {\n  margin-left: 10px;\n  margin-right: 6px;\n}\n\n.htContextMenu table tbody tr td div span.selected {\n  margin-top: -2px;\n  position: absolute;\n  left: 4px;\n}\n\n.htContextMenu .ht_master .wtHolder {\n  overflow: hidden;\n}\n.htRowHeaders .ht_master.innerBorderLeft ~ .ht_clone_top_left_corner th:nth-child(2),\n.htRowHeaders .ht_master.innerBorderLeft ~ .ht_clone_left td:first-of-type {\n  border-left: 0 none;\n}\n.handsontable .wtHider {\n  position: relative;\n}\n.handsontable.ht__manualColumnMove.after-selection--columns thead th.ht__highlight {\n  cursor: move;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n  cursor: grab;\n}\n.handsontable.ht__manualColumnMove.on-moving--columns,\n.handsontable.ht__manualColumnMove.on-moving--columns thead th.ht__highlight {\n  cursor: move;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n  cursor: grabbing;\n}\n.handsontable.ht__manualColumnMove.on-moving--columns .manualColumnResizer {\n  display: none;\n}\n.handsontable .ht__manualColumnMove--guideline,\n.handsontable .ht__manualColumnMove--backlight {\n  position: absolute;\n  height: 100%;\n  display: none;\n}\n.handsontable .ht__manualColumnMove--guideline {\n  background: #757575;\n  width: 2px;\n  top: 0;\n  margin-left: -1px;\n  z-index: 105;\n}\n.handsontable .ht__manualColumnMove--backlight {\n  background: #343434;\n  background: rgba(52, 52, 52, 0.25);\n  display: none;\n  z-index: 105;\n  pointer-events: none;\n}\n.handsontable.on-moving--columns.show-ui .ht__manualColumnMove--guideline,\n.handsontable.on-moving--columns .ht__manualColumnMove--backlight {\n  display: block;\n}\n.handsontable .wtHider {\n  position: relative;\n}\n.handsontable.ht__manualRowMove.after-selection--rows tbody th.ht__highlight {\n  cursor: move;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n  cursor: grab;\n}\n.handsontable.ht__manualRowMove.on-moving--rows,\n.handsontable.ht__manualRowMove.on-moving--rows tbody th.ht__highlight {\n  cursor: move;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n  cursor: grabbing;\n}\n.handsontable.ht__manualRowMove.on-moving--rows .manualRowResizer {\n  display: none;\n}\n.handsontable .ht__manualRowMove--guideline,\n.handsontable .ht__manualRowMove--backlight {\n  position: absolute;\n  width: 100%;\n  display: none;\n}\n.handsontable .ht__manualRowMove--guideline {\n  background: #757575;\n  height: 2px;\n  left: 0;\n  margin-top: -1px;\n  z-index: 105;\n}\n.handsontable .ht__manualRowMove--backlight {\n  background: #343434;\n  background: rgba(52, 52, 52, 0.25);\n  display: none;\n  z-index: 105;\n  pointer-events: none;\n}\n.handsontable.on-moving--rows.show-ui .ht__manualRowMove--guideline,\n.handsontable.on-moving--rows .ht__manualRowMove--backlight {\n  display: block;\n}\n@charset \"UTF-8\";\n\n/*!\n * Pikaday\n * Copyright Â© 2014 David Bushell | BSD & MIT license | http://dbushell.com/\n */\n\n.pika-single {\n    z-index: 9999;\n    display: block;\n    position: relative;\n    color: #333;\n    background: #fff;\n    border: 1px solid #ccc;\n    border-bottom-color: #bbb;\n    font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif;\n}\n\n/*\nclear child float (pika-lendar), using the famous micro clearfix hack\nhttp://nicolasgallagher.com/micro-clearfix-hack/\n*/\n.pika-single:before,\n.pika-single:after {\n    content: \" \";\n    display: table;\n}\n.pika-single:after { clear: both }\n.pika-single { *zoom: 1 }\n\n.pika-single.is-hidden {\n    display: none;\n}\n\n.pika-single.is-bound {\n    position: absolute;\n    box-shadow: 0 5px 15px -5px rgba(0,0,0,.5);\n}\n\n.pika-lendar {\n    float: left;\n    width: 240px;\n    margin: 8px;\n}\n\n.pika-title {\n    position: relative;\n    text-align: center;\n}\n\n.pika-label {\n    display: inline-block;\n    *display: inline;\n    position: relative;\n    z-index: 9999;\n    overflow: hidden;\n    margin: 0;\n    padding: 5px 3px;\n    font-size: 14px;\n    line-height: 20px;\n    font-weight: bold;\n    background-color: #fff;\n}\n.pika-title select {\n    cursor: pointer;\n    position: absolute;\n    z-index: 9998;\n    margin: 0;\n    left: 0;\n    top: 5px;\n    filter: alpha(opacity=0);\n    opacity: 0;\n}\n\n.pika-prev,\n.pika-next {\n    display: block;\n    cursor: pointer;\n    position: relative;\n    outline: none;\n    border: 0;\n    padding: 0;\n    width: 20px;\n    height: 30px;\n    /* hide text using text-indent trick, using width value (it's enough) */\n    text-indent: 20px;\n    white-space: nowrap;\n    overflow: hidden;\n    background-color: transparent;\n    background-position: center center;\n    background-repeat: no-repeat;\n    background-size: 75% 75%;\n    opacity: .5;\n    *position: absolute;\n    *top: 0;\n}\n\n.pika-prev:hover,\n.pika-next:hover {\n    opacity: 1;\n}\n\n.pika-prev,\n.is-rtl .pika-next {\n    float: left;\n    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAUklEQVR42u3VMQoAIBADQf8Pgj+OD9hG2CtONJB2ymQkKe0HbwAP0xucDiQWARITIDEBEnMgMQ8S8+AqBIl6kKgHiXqQqAeJepBo/z38J/U0uAHlaBkBl9I4GwAAAABJRU5ErkJggg==');\n    *left: 0;\n}\n\n.pika-next,\n.is-rtl .pika-prev {\n    float: right;\n    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAU0lEQVR42u3VOwoAMAgE0dwfAnNjU26bYkBCFGwfiL9VVWoO+BJ4Gf3gtsEKKoFBNTCoCAYVwaAiGNQGMUHMkjGbgjk2mIONuXo0nC8XnCf1JXgArVIZAQh5TKYAAAAASUVORK5CYII=');\n    *right: 0;\n}\n\n.pika-prev.is-disabled,\n.pika-next.is-disabled {\n    cursor: default;\n    opacity: .2;\n}\n\n.pika-select {\n    display: inline-block;\n    *display: inline;\n}\n\n.pika-table {\n    width: 100%;\n    border-collapse: collapse;\n    border-spacing: 0;\n    border: 0;\n}\n\n.pika-table th,\n.pika-table td {\n    width: 14.285714285714286%;\n    padding: 0;\n}\n\n.pika-table th {\n    color: #999;\n    font-size: 12px;\n    line-height: 25px;\n    font-weight: bold;\n    text-align: center;\n}\n\n.pika-button {\n    cursor: pointer;\n    display: block;\n    box-sizing: border-box;\n    -moz-box-sizing: border-box;\n    outline: none;\n    border: 0;\n    margin: 0;\n    width: 100%;\n    padding: 5px;\n    color: #666;\n    font-size: 12px;\n    line-height: 15px;\n    text-align: right;\n    background: #f5f5f5;\n}\n\n.pika-week {\n    font-size: 11px;\n    color: #999;\n}\n\n.is-today .pika-button {\n    color: #33aaff;\n    font-weight: bold;\n}\n\n.is-selected .pika-button {\n    color: #fff;\n    font-weight: bold;\n    background: #33aaff;\n    box-shadow: inset 0 1px 3px #178fe5;\n    border-radius: 3px;\n}\n\n.is-inrange .pika-button {\n    background: #D5E9F7;\n}\n\n.is-startrange .pika-button {\n    color: #fff;\n    background: #6CB31D;\n    box-shadow: none;\n    border-radius: 3px;\n}\n\n.is-endrange .pika-button {\n    color: #fff;\n    background: #33aaff;\n    box-shadow: none;\n    border-radius: 3px;\n}\n\n.is-disabled .pika-button,\n.is-outside-current-month .pika-button {\n    pointer-events: none;\n    cursor: default;\n    color: #999;\n    opacity: .3;\n}\n\n.pika-button:hover {\n    color: #fff;\n    background: #ff8000;\n    box-shadow: none;\n    border-radius: 3px;\n}\n\n/* styling for abbr */\n.pika-table abbr {\n    border-bottom: none;\n    cursor: help;\n}\n\n"],"sourceRoot":""}]);

// exports


/***/ }),

/***/ 658:
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__(1)();
// imports
exports.i(__webpack_require__(655), "");

// module
exports.push([module.i, "\n", "", {"version":3,"sources":[],"names":[],"mappings":"","file":"Handsontable.vue","sourceRoot":""}]);

// exports


/***/ }),

/***/ 672:
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global, process) {var require;var require;/*!
(The MIT License)

Copyright (c) 2012-2014 Marcin Warpechowski
Copyright (c) 2015 Handsoncode sp. z o.o. <hello@handsoncode.net>

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
'Software'), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/
(function(f){if(true){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Handsontable = f()}})(function(){var define,module,exports;return (function outer (modules, cache, entry) {
  // Save the require from previous bundle to this closure if any
  var previousRequire = typeof require == "function" && require;
  var globalNS = JSON.parse('{"zeroclipboard":"ZeroClipboard","moment":"moment","numbro":"numbro","pikaday":"Pikaday"}') || {};

  function newRequire(name, jumped){
    if(!cache[name]) {

      if(!modules[name]) {
        // if we cannot find the the module within our internal map or
        // cache jump to the current global require ie. the last bundle
        // that was added to the page.
        var currentRequire = typeof require == "function" && require;
        if (!jumped && currentRequire) return require(name, true);

        // If there are other bundles on this page the require from the
        // previous one is saved to 'previousRequire'. Repeat this as
        // many times as there are bundles until the module is found or
        // we exhaust the require chain.
        if (previousRequire) return require(name, true);

        // Try to find module from global scope
        if (globalNS[name] && typeof window[globalNS[name]] !== 'undefined') {
          return window[globalNS[name]];
        }

        var err = new Error('Cannot find module \'' + name + '\'');
        err.code = 'MODULE_NOT_FOUND';
        throw err;
      }
      var m = cache[name] = {exports:{}};
      modules[name][0].call(m.exports, function(x){
        var id = modules[name][1][x];
        return newRequire(id ? id : x);
      },m,m.exports,outer,modules,cache,entry);
    }

    return cache[name].exports;
  }
  for(var i=0;i<entry.length;i++) newRequire(entry[i]);

  // Override the current require with this new one
  return newRequire;
})
({1:[function(_dereq_,module,exports){

},{}],2:[function(_dereq_,module,exports){
if (window.jQuery) {
  (function ($) {
    $.fn.handsontable = function (action) {
      var i,
        ilen,
        args,
        output,
        userSettings,
        $this = this.first(), // Use only first element from list
        instance = $this.data('handsontable');

      // Init case
      if (typeof action !== 'string') {
        userSettings = action || {};

        if (instance) {
          instance.updateSettings(userSettings);

        } else {
          instance = new Handsontable.Core($this[0], userSettings);
          $this.data('handsontable', instance);
          instance.init();
        }

        return $this;

      } else { // Action case
        args = [];

        if (arguments.length > 1) {
          for (i = 1, ilen = arguments.length; i < ilen; i++) {
            args.push(arguments[i]);
          }
        }

        if (instance) {
          if (typeof instance[action] !== 'undefined') {
            output = instance[action].apply(instance, args);

            if (action === 'destroy') {
              $this.removeData();
            }

          } else {
            throw new Error('Handsontable do not provide action: ' + action);
          }
        }

        return output;
      }
    };
  })(window.jQuery);
}



},{}],3:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableBorder: {get: function() {
      return WalkontableBorder;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_event__,
    $___46__46__47__46__46__47__46__46__47_helpers_47_browser__,
    $___46__46__47__46__46__47__46__46__47_eventManager__,
    $__cell_47_coords__,
    $__overlay_47__95_base_46_js__;
var $__0 = ($___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}),
    getComputedStyle = $__0.getComputedStyle,
    getTrimmingContainer = $__0.getTrimmingContainer,
    innerWidth = $__0.innerWidth,
    innerHeight = $__0.innerHeight,
    offset = $__0.offset,
    outerHeight = $__0.outerHeight,
    outerWidth = $__0.outerWidth;
var stopImmediatePropagation = ($___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_event__ && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_event__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_event__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_event__}).stopImmediatePropagation;
var isMobileBrowser = ($___46__46__47__46__46__47__46__46__47_helpers_47_browser__ = _dereq_("helpers/browser"), $___46__46__47__46__46__47__46__46__47_helpers_47_browser__ && $___46__46__47__46__46__47__46__46__47_helpers_47_browser__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_browser__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_browser__}).isMobileBrowser;
var EventManager = ($___46__46__47__46__46__47__46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47__46__46__47__46__46__47_eventManager__ && $___46__46__47__46__46__47__46__46__47_eventManager__.__esModule && $___46__46__47__46__46__47__46__46__47_eventManager__ || {default: $___46__46__47__46__46__47__46__46__47_eventManager__}).EventManager;
var WalkontableCellCoords = ($__cell_47_coords__ = _dereq_("cell/coords"), $__cell_47_coords__ && $__cell_47_coords__.__esModule && $__cell_47_coords__ || {default: $__cell_47_coords__}).WalkontableCellCoords;
var WalkontableOverlay = ($__overlay_47__95_base_46_js__ = _dereq_("overlay/_base.js"), $__overlay_47__95_base_46_js__ && $__overlay_47__95_base_46_js__.__esModule && $__overlay_47__95_base_46_js__ || {default: $__overlay_47__95_base_46_js__}).WalkontableOverlay;
var WalkontableBorder = function WalkontableBorder(wotInstance, settings) {
  if (!settings) {
    return;
  }
  this.eventManager = new EventManager(wotInstance);
  this.instance = wotInstance;
  this.wot = wotInstance;
  this.settings = settings;
  this.mouseDown = false;
  this.main = null;
  this.top = null;
  this.left = null;
  this.bottom = null;
  this.right = null;
  this.topStyle = null;
  this.leftStyle = null;
  this.bottomStyle = null;
  this.rightStyle = null;
  this.cornerDefaultStyle = {
    width: '5px',
    height: '5px',
    borderWidth: '2px',
    borderStyle: 'solid',
    borderColor: '#FFF'
  };
  this.corner = null;
  this.cornerStyle = null;
  this.createBorders(settings);
  this.registerListeners();
};
($traceurRuntime.createClass)(WalkontableBorder, {
  registerListeners: function() {
    var $__6 = this;
    this.eventManager.addEventListener(document.body, 'mousedown', (function() {
      return $__6.onMouseDown();
    }));
    this.eventManager.addEventListener(document.body, 'mouseup', (function() {
      return $__6.onMouseUp();
    }));
    var $__8 = this,
        $__9 = function(c, len) {
          $__8.eventManager.addEventListener($__8.main.childNodes[c], 'mouseenter', (function(event) {
            return $__6.onMouseEnter(event, $__6.main.childNodes[c]);
          }));
        };
    for (var c = 0,
        len = this.main.childNodes.length; c < len; c++) {
      $__9(c, len);
    }
  },
  onMouseDown: function() {
    this.mouseDown = true;
  },
  onMouseUp: function() {
    this.mouseDown = false;
  },
  onMouseEnter: function(event, parentElement) {
    if (!this.mouseDown || !this.wot.getSetting('hideBorderOnMouseDownOver')) {
      return;
    }
    event.preventDefault();
    stopImmediatePropagation(event);
    var _this = this;
    var bounds = parentElement.getBoundingClientRect();
    parentElement.style.display = 'none';
    function isOutside(event) {
      if (event.clientY < Math.floor(bounds.top)) {
        return true;
      }
      if (event.clientY > Math.ceil(bounds.top + bounds.height)) {
        return true;
      }
      if (event.clientX < Math.floor(bounds.left)) {
        return true;
      }
      if (event.clientX > Math.ceil(bounds.left + bounds.width)) {
        return true;
      }
    }
    function handler(event) {
      if (isOutside(event)) {
        _this.eventManager.removeEventListener(document.body, 'mousemove', handler);
        parentElement.style.display = 'block';
      }
    }
    this.eventManager.addEventListener(document.body, 'mousemove', handler);
  },
  createBorders: function(settings) {
    this.main = document.createElement('div');
    var borderDivs = ['top', 'left', 'bottom', 'right', 'corner'];
    var style = this.main.style;
    style.position = 'absolute';
    style.top = 0;
    style.left = 0;
    for (var i = 0; i < 5; i++) {
      var position = borderDivs[i];
      var div = document.createElement('div');
      div.className = 'wtBorder ' + (this.settings.className || '');
      if (this.settings[position] && this.settings[position].hide) {
        div.className += ' hidden';
      }
      style = div.style;
      style.backgroundColor = (this.settings[position] && this.settings[position].color) ? this.settings[position].color : settings.border.color;
      style.height = (this.settings[position] && this.settings[position].width) ? this.settings[position].width + 'px' : settings.border.width + 'px';
      style.width = (this.settings[position] && this.settings[position].width) ? this.settings[position].width + 'px' : settings.border.width + 'px';
      this.main.appendChild(div);
    }
    this.top = this.main.childNodes[0];
    this.left = this.main.childNodes[1];
    this.bottom = this.main.childNodes[2];
    this.right = this.main.childNodes[3];
    this.topStyle = this.top.style;
    this.leftStyle = this.left.style;
    this.bottomStyle = this.bottom.style;
    this.rightStyle = this.right.style;
    this.corner = this.main.childNodes[4];
    this.corner.className += ' corner';
    this.cornerStyle = this.corner.style;
    this.cornerStyle.width = this.cornerDefaultStyle.width;
    this.cornerStyle.height = this.cornerDefaultStyle.height;
    this.cornerStyle.border = [this.cornerDefaultStyle.borderWidth, this.cornerDefaultStyle.borderStyle, this.cornerDefaultStyle.borderColor].join(' ');
    if (isMobileBrowser()) {
      this.createMultipleSelectorHandles();
    }
    this.disappear();
    if (!this.wot.wtTable.bordersHolder) {
      this.wot.wtTable.bordersHolder = document.createElement('div');
      this.wot.wtTable.bordersHolder.className = 'htBorders';
      this.wot.wtTable.spreader.appendChild(this.wot.wtTable.bordersHolder);
    }
    this.wot.wtTable.bordersHolder.insertBefore(this.main, this.wot.wtTable.bordersHolder.firstChild);
  },
  createMultipleSelectorHandles: function() {
    this.selectionHandles = {
      topLeft: document.createElement('DIV'),
      topLeftHitArea: document.createElement('DIV'),
      bottomRight: document.createElement('DIV'),
      bottomRightHitArea: document.createElement('DIV')
    };
    var width = 10;
    var hitAreaWidth = 40;
    this.selectionHandles.topLeft.className = 'topLeftSelectionHandle';
    this.selectionHandles.topLeftHitArea.className = 'topLeftSelectionHandle-HitArea';
    this.selectionHandles.bottomRight.className = 'bottomRightSelectionHandle';
    this.selectionHandles.bottomRightHitArea.className = 'bottomRightSelectionHandle-HitArea';
    this.selectionHandles.styles = {
      topLeft: this.selectionHandles.topLeft.style,
      topLeftHitArea: this.selectionHandles.topLeftHitArea.style,
      bottomRight: this.selectionHandles.bottomRight.style,
      bottomRightHitArea: this.selectionHandles.bottomRightHitArea.style
    };
    var hitAreaStyle = {
      position: 'absolute',
      height: hitAreaWidth + 'px',
      width: hitAreaWidth + 'px',
      'border-radius': parseInt(hitAreaWidth / 1.5, 10) + 'px'
    };
    for (var prop in hitAreaStyle) {
      if (hitAreaStyle.hasOwnProperty(prop)) {
        this.selectionHandles.styles.bottomRightHitArea[prop] = hitAreaStyle[prop];
        this.selectionHandles.styles.topLeftHitArea[prop] = hitAreaStyle[prop];
      }
    }
    var handleStyle = {
      position: 'absolute',
      height: width + 'px',
      width: width + 'px',
      'border-radius': parseInt(width / 1.5, 10) + 'px',
      background: '#F5F5FF',
      border: '1px solid #4285c8'
    };
    for (var prop$__10 in handleStyle) {
      if (handleStyle.hasOwnProperty(prop$__10)) {
        this.selectionHandles.styles.bottomRight[prop$__10] = handleStyle[prop$__10];
        this.selectionHandles.styles.topLeft[prop$__10] = handleStyle[prop$__10];
      }
    }
    this.main.appendChild(this.selectionHandles.topLeft);
    this.main.appendChild(this.selectionHandles.bottomRight);
    this.main.appendChild(this.selectionHandles.topLeftHitArea);
    this.main.appendChild(this.selectionHandles.bottomRightHitArea);
  },
  isPartRange: function(row, col) {
    if (this.wot.selections.area.cellRange) {
      if (row != this.wot.selections.area.cellRange.to.row || col != this.wot.selections.area.cellRange.to.col) {
        return true;
      }
    }
    return false;
  },
  updateMultipleSelectionHandlesPosition: function(row, col, top, left, width, height) {
    var handleWidth = parseInt(this.selectionHandles.styles.topLeft.width, 10);
    var hitAreaWidth = parseInt(this.selectionHandles.styles.topLeftHitArea.width, 10);
    this.selectionHandles.styles.topLeft.top = parseInt(top - handleWidth, 10) + 'px';
    this.selectionHandles.styles.topLeft.left = parseInt(left - handleWidth, 10) + 'px';
    this.selectionHandles.styles.topLeftHitArea.top = parseInt(top - (hitAreaWidth / 4) * 3, 10) + 'px';
    this.selectionHandles.styles.topLeftHitArea.left = parseInt(left - (hitAreaWidth / 4) * 3, 10) + 'px';
    this.selectionHandles.styles.bottomRight.top = parseInt(top + height, 10) + 'px';
    this.selectionHandles.styles.bottomRight.left = parseInt(left + width, 10) + 'px';
    this.selectionHandles.styles.bottomRightHitArea.top = parseInt(top + height - hitAreaWidth / 4, 10) + 'px';
    this.selectionHandles.styles.bottomRightHitArea.left = parseInt(left + width - hitAreaWidth / 4, 10) + 'px';
    if (this.settings.border.multipleSelectionHandlesVisible && this.settings.border.multipleSelectionHandlesVisible()) {
      this.selectionHandles.styles.topLeft.display = 'block';
      this.selectionHandles.styles.topLeftHitArea.display = 'block';
      if (this.isPartRange(row, col)) {
        this.selectionHandles.styles.bottomRight.display = 'none';
        this.selectionHandles.styles.bottomRightHitArea.display = 'none';
      } else {
        this.selectionHandles.styles.bottomRight.display = 'block';
        this.selectionHandles.styles.bottomRightHitArea.display = 'block';
      }
    } else {
      this.selectionHandles.styles.topLeft.display = 'none';
      this.selectionHandles.styles.bottomRight.display = 'none';
      this.selectionHandles.styles.topLeftHitArea.display = 'none';
      this.selectionHandles.styles.bottomRightHitArea.display = 'none';
    }
    if (row == this.wot.wtSettings.getSetting('fixedRowsTop') || col == this.wot.wtSettings.getSetting('fixedColumnsLeft')) {
      this.selectionHandles.styles.topLeft.zIndex = '9999';
      this.selectionHandles.styles.topLeftHitArea.zIndex = '9999';
    } else {
      this.selectionHandles.styles.topLeft.zIndex = '';
      this.selectionHandles.styles.topLeftHitArea.zIndex = '';
    }
  },
  appear: function(corners) {
    if (this.disabled) {
      return;
    }
    var isMultiple,
        fromTD,
        toTD,
        fromOffset,
        toOffset,
        containerOffset,
        top,
        minTop,
        left,
        minLeft,
        height,
        width,
        fromRow,
        fromColumn,
        toRow,
        toColumn,
        trimmingContainer,
        cornerOverlappingContainer,
        ilen;
    ilen = this.wot.wtTable.getRenderedRowsCount();
    for (var i = 0; i < ilen; i++) {
      var s = this.wot.wtTable.rowFilter.renderedToSource(i);
      if (s >= corners[0] && s <= corners[2]) {
        fromRow = s;
        break;
      }
    }
    for (var i$__11 = ilen - 1; i$__11 >= 0; i$__11--) {
      var s$__12 = this.wot.wtTable.rowFilter.renderedToSource(i$__11);
      if (s$__12 >= corners[0] && s$__12 <= corners[2]) {
        toRow = s$__12;
        break;
      }
    }
    ilen = this.wot.wtTable.getRenderedColumnsCount();
    for (var i$__13 = 0; i$__13 < ilen; i$__13++) {
      var s$__14 = this.wot.wtTable.columnFilter.renderedToSource(i$__13);
      if (s$__14 >= corners[1] && s$__14 <= corners[3]) {
        fromColumn = s$__14;
        break;
      }
    }
    for (var i$__15 = ilen - 1; i$__15 >= 0; i$__15--) {
      var s$__16 = this.wot.wtTable.columnFilter.renderedToSource(i$__15);
      if (s$__16 >= corners[1] && s$__16 <= corners[3]) {
        toColumn = s$__16;
        break;
      }
    }
    if (fromRow === void 0 || fromColumn === void 0) {
      this.disappear();
      return;
    }
    isMultiple = (fromRow !== toRow || fromColumn !== toColumn);
    fromTD = this.wot.wtTable.getCell(new WalkontableCellCoords(fromRow, fromColumn));
    toTD = isMultiple ? this.wot.wtTable.getCell(new WalkontableCellCoords(toRow, toColumn)) : fromTD;
    fromOffset = offset(fromTD);
    toOffset = isMultiple ? offset(toTD) : fromOffset;
    containerOffset = offset(this.wot.wtTable.TABLE);
    minTop = fromOffset.top;
    height = toOffset.top + outerHeight(toTD) - minTop;
    minLeft = fromOffset.left;
    width = toOffset.left + outerWidth(toTD) - minLeft;
    top = minTop - containerOffset.top - 1;
    left = minLeft - containerOffset.left - 1;
    var style = getComputedStyle(fromTD);
    if (parseInt(style.borderTopWidth, 10) > 0) {
      top += 1;
      height = height > 0 ? height - 1 : 0;
    }
    if (parseInt(style.borderLeftWidth, 10) > 0) {
      left += 1;
      width = width > 0 ? width - 1 : 0;
    }
    this.topStyle.top = top + 'px';
    this.topStyle.left = left + 'px';
    this.topStyle.width = width + 'px';
    this.topStyle.display = 'block';
    this.leftStyle.top = top + 'px';
    this.leftStyle.left = left + 'px';
    this.leftStyle.height = height + 'px';
    this.leftStyle.display = 'block';
    var delta = Math.floor(this.settings.border.width / 2);
    this.bottomStyle.top = top + height - delta + 'px';
    this.bottomStyle.left = left + 'px';
    this.bottomStyle.width = width + 'px';
    this.bottomStyle.display = 'block';
    this.rightStyle.top = top + 'px';
    this.rightStyle.left = left + width - delta + 'px';
    this.rightStyle.height = height + 1 + 'px';
    this.rightStyle.display = 'block';
    if (isMobileBrowser() || (!this.hasSetting(this.settings.border.cornerVisible) || this.isPartRange(toRow, toColumn))) {
      this.cornerStyle.display = 'none';
    } else {
      this.cornerStyle.top = top + height - 4 + 'px';
      this.cornerStyle.left = left + width - 4 + 'px';
      this.cornerStyle.borderRightWidth = this.cornerDefaultStyle.borderWidth;
      this.cornerStyle.width = this.cornerDefaultStyle.width;
      this.cornerStyle.display = 'none';
      trimmingContainer = getTrimmingContainer(this.wot.wtTable.TABLE);
      if (toColumn === this.wot.getSetting('totalColumns') - 1) {
        cornerOverlappingContainer = toTD.offsetLeft + outerWidth(toTD) + (parseInt(this.cornerDefaultStyle.width) / 2) >= innerWidth(trimmingContainer);
        if (cornerOverlappingContainer) {
          this.cornerStyle.left = Math.floor(left + width - 3 - parseInt(this.cornerDefaultStyle.width) / 2) + 'px';
          this.cornerStyle.borderRightWidth = 0;
        }
      }
      if (toRow === this.wot.getSetting('totalRows') - 1) {
        cornerOverlappingContainer = toTD.offsetTop + outerHeight(toTD) + (parseInt(this.cornerDefaultStyle.height) / 2) >= innerHeight(trimmingContainer);
        if (cornerOverlappingContainer) {
          this.cornerStyle.top = Math.floor(top + height - 3 - parseInt(this.cornerDefaultStyle.height) / 2) + 'px';
          this.cornerStyle.borderBottomWidth = 0;
        }
      }
      this.cornerStyle.display = 'block';
    }
    if (isMobileBrowser()) {
      this.updateMultipleSelectionHandlesPosition(fromRow, fromColumn, top, left, width, height);
    }
  },
  disappear: function() {
    this.topStyle.display = 'none';
    this.leftStyle.display = 'none';
    this.bottomStyle.display = 'none';
    this.rightStyle.display = 'none';
    this.cornerStyle.display = 'none';
    if (isMobileBrowser()) {
      this.selectionHandles.styles.topLeft.display = 'none';
      this.selectionHandles.styles.bottomRight.display = 'none';
    }
  },
  hasSetting: function(setting) {
    if (typeof setting === 'function') {
      return setting();
    }
    return !!setting;
  }
}, {});
;
window.WalkontableBorder = WalkontableBorder;

//# 
},{"cell/coords":6,"eventManager":42,"helpers/browser":44,"helpers/dom/element":47,"helpers/dom/event":48,"overlay/_base.js":12}],4:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableViewportColumnsCalculator: {get: function() {
      return WalkontableViewportColumnsCalculator;
    }},
  __esModule: {value: true}
});
var privatePool = new WeakMap();
var WalkontableViewportColumnsCalculator = function WalkontableViewportColumnsCalculator(viewportWidth, scrollOffset, totalColumns, columnWidthFn, overrideFn, onlyFullyVisible, stretchH) {
  var stretchingColumnWidthFn = arguments[7] !== (void 0) ? arguments[7] : (function(width) {
    return width;
  });
  privatePool.set(this, {
    viewportWidth: viewportWidth,
    scrollOffset: scrollOffset,
    totalColumns: totalColumns,
    columnWidthFn: columnWidthFn,
    overrideFn: overrideFn,
    onlyFullyVisible: onlyFullyVisible,
    stretchingColumnWidthFn: stretchingColumnWidthFn
  });
  this.count = 0;
  this.startColumn = null;
  this.endColumn = null;
  this.startPosition = null;
  this.stretchAllRatio = 0;
  this.stretchLastWidth = 0;
  this.stretch = stretchH;
  this.totalTargetWidth = 0;
  this.needVerifyLastColumnWidth = true;
  this.stretchAllColumnsWidth = [];
  this.calculate();
};
var $WalkontableViewportColumnsCalculator = WalkontableViewportColumnsCalculator;
($traceurRuntime.createClass)(WalkontableViewportColumnsCalculator, {
  calculate: function() {
    var sum = 0;
    var needReverse = true;
    var startPositions = [];
    var columnWidth;
    var priv = privatePool.get(this);
    var onlyFullyVisible = priv.onlyFullyVisible;
    var overrideFn = priv.overrideFn;
    var scrollOffset = priv.scrollOffset;
    var totalColumns = priv.totalColumns;
    var viewportWidth = priv.viewportWidth;
    for (var i = 0; i < totalColumns; i++) {
      columnWidth = this._getColumnWidth(i);
      if (sum <= scrollOffset && !onlyFullyVisible) {
        this.startColumn = i;
      }
      var compensatedViewportWidth = scrollOffset > 0 ? viewportWidth + 1 : viewportWidth;
      if (sum >= scrollOffset && sum + columnWidth <= scrollOffset + compensatedViewportWidth) {
        if (this.startColumn == null) {
          this.startColumn = i;
        }
        this.endColumn = i;
      }
      startPositions.push(sum);
      sum += columnWidth;
      if (!onlyFullyVisible) {
        this.endColumn = i;
      }
      if (sum >= scrollOffset + viewportWidth) {
        needReverse = false;
        break;
      }
    }
    if (this.endColumn === totalColumns - 1 && needReverse) {
      this.startColumn = this.endColumn;
      while (this.startColumn > 0) {
        var viewportSum = startPositions[this.endColumn] + columnWidth - startPositions[this.startColumn - 1];
        if (viewportSum <= viewportWidth || !onlyFullyVisible) {
          this.startColumn--;
        }
        if (viewportSum > viewportWidth) {
          break;
        }
      }
    }
    if (this.startColumn !== null && overrideFn) {
      overrideFn(this);
    }
    this.startPosition = startPositions[this.startColumn];
    if (this.startPosition == void 0) {
      this.startPosition = null;
    }
    if (this.startColumn !== null) {
      this.count = this.endColumn - this.startColumn + 1;
    }
  },
  refreshStretching: function(totalWidth) {
    if (this.stretch === 'none') {
      return;
    }
    this.totalTargetWidth = totalWidth;
    var priv = privatePool.get(this);
    var totalColumns = priv.totalColumns;
    var sumAll = 0;
    for (var i = 0; i < totalColumns; i++) {
      var columnWidth = this._getColumnWidth(i);
      var permanentColumnWidth = priv.stretchingColumnWidthFn(void 0, i);
      if (typeof permanentColumnWidth === 'number') {
        totalWidth -= permanentColumnWidth;
      } else {
        sumAll += columnWidth;
      }
    }
    var remainingSize = totalWidth - sumAll;
    if (this.stretch === 'all' && remainingSize > 0) {
      this.stretchAllRatio = totalWidth / sumAll;
      this.stretchAllColumnsWidth = [];
      this.needVerifyLastColumnWidth = true;
    } else if (this.stretch === 'last' && totalWidth !== Infinity) {
      var columnWidth$__1 = this._getColumnWidth(totalColumns - 1);
      var lastColumnWidth = remainingSize + columnWidth$__1;
      this.stretchLastWidth = lastColumnWidth >= 0 ? lastColumnWidth : columnWidth$__1;
    }
  },
  getStretchedColumnWidth: function(column, baseWidth) {
    var result = null;
    if (this.stretch === 'all' && this.stretchAllRatio !== 0) {
      result = this._getStretchedAllColumnWidth(column, baseWidth);
    } else if (this.stretch === 'last' && this.stretchLastWidth !== 0) {
      result = this._getStretchedLastColumnWidth(column);
    }
    return result;
  },
  _getStretchedAllColumnWidth: function(column, baseWidth) {
    var sumRatioWidth = 0;
    var priv = privatePool.get(this);
    var totalColumns = priv.totalColumns;
    if (!this.stretchAllColumnsWidth[column]) {
      var stretchedWidth = Math.round(baseWidth * this.stretchAllRatio);
      var newStretchedWidth = priv.stretchingColumnWidthFn(stretchedWidth, column);
      if (newStretchedWidth === void 0) {
        this.stretchAllColumnsWidth[column] = stretchedWidth;
      } else {
        this.stretchAllColumnsWidth[column] = isNaN(newStretchedWidth) ? this._getColumnWidth(column) : newStretchedWidth;
      }
    }
    if (this.stretchAllColumnsWidth.length === totalColumns && this.needVerifyLastColumnWidth) {
      this.needVerifyLastColumnWidth = false;
      for (var i = 0; i < this.stretchAllColumnsWidth.length; i++) {
        sumRatioWidth += this.stretchAllColumnsWidth[i];
      }
      if (sumRatioWidth !== this.totalTargetWidth) {
        this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length - 1] += this.totalTargetWidth - sumRatioWidth;
      }
    }
    return this.stretchAllColumnsWidth[column];
  },
  _getStretchedLastColumnWidth: function(column) {
    var priv = privatePool.get(this);
    var totalColumns = priv.totalColumns;
    if (column === totalColumns - 1) {
      return this.stretchLastWidth;
    }
    return null;
  },
  _getColumnWidth: function(column) {
    var width = privatePool.get(this).columnWidthFn(column);
    if (width === void 0) {
      width = $WalkontableViewportColumnsCalculator.DEFAULT_WIDTH;
    }
    return width;
  }
}, {get DEFAULT_WIDTH() {
    return 50;
  }});
;
window.WalkontableViewportColumnsCalculator = WalkontableViewportColumnsCalculator;

//# 
},{}],5:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableViewportRowsCalculator: {get: function() {
      return WalkontableViewportRowsCalculator;
    }},
  __esModule: {value: true}
});
var privatePool = new WeakMap();
var WalkontableViewportRowsCalculator = function WalkontableViewportRowsCalculator(viewportHeight, scrollOffset, totalRows, rowHeightFn, overrideFn, onlyFullyVisible, horizontalScrollbarHeight) {
  privatePool.set(this, {
    viewportHeight: viewportHeight,
    scrollOffset: scrollOffset,
    totalRows: totalRows,
    rowHeightFn: rowHeightFn,
    overrideFn: overrideFn,
    onlyFullyVisible: onlyFullyVisible,
    horizontalScrollbarHeight: horizontalScrollbarHeight
  });
  this.count = 0;
  this.startRow = null;
  this.endRow = null;
  this.startPosition = null;
  this.calculate();
};
var $WalkontableViewportRowsCalculator = WalkontableViewportRowsCalculator;
($traceurRuntime.createClass)(WalkontableViewportRowsCalculator, {calculate: function() {
    var sum = 0;
    var needReverse = true;
    var startPositions = [];
    var priv = privatePool.get(this);
    var onlyFullyVisible = priv.onlyFullyVisible;
    var overrideFn = priv.overrideFn;
    var rowHeightFn = priv.rowHeightFn;
    var scrollOffset = priv.scrollOffset;
    var totalRows = priv.totalRows;
    var viewportHeight = priv.viewportHeight;
    var horizontalScrollbarHeight = priv.horizontalScrollbarHeight || 0;
    for (var i = 0; i < totalRows; i++) {
      var rowHeight = rowHeightFn(i);
      if (rowHeight === undefined) {
        rowHeight = $WalkontableViewportRowsCalculator.DEFAULT_HEIGHT;
      }
      if (sum <= scrollOffset && !onlyFullyVisible) {
        this.startRow = i;
      }
      if (sum >= scrollOffset && sum + rowHeight <= scrollOffset + viewportHeight - horizontalScrollbarHeight) {
        if (this.startRow === null) {
          this.startRow = i;
        }
        this.endRow = i;
      }
      startPositions.push(sum);
      sum += rowHeight;
      if (!onlyFullyVisible) {
        this.endRow = i;
      }
      if (sum >= scrollOffset + viewportHeight - horizontalScrollbarHeight) {
        needReverse = false;
        break;
      }
    }
    if (this.endRow === totalRows - 1 && needReverse) {
      this.startRow = this.endRow;
      while (this.startRow > 0) {
        var viewportSum = startPositions[this.endRow] + rowHeight - startPositions[this.startRow - 1];
        if (viewportSum <= viewportHeight - horizontalScrollbarHeight || !onlyFullyVisible) {
          this.startRow--;
        }
        if (viewportSum >= viewportHeight - horizontalScrollbarHeight) {
          break;
        }
      }
    }
    if (this.startRow !== null && overrideFn) {
      overrideFn(this);
    }
    this.startPosition = startPositions[this.startRow];
    if (this.startPosition == void 0) {
      this.startPosition = null;
    }
    if (this.startRow !== null) {
      this.count = this.endRow - this.startRow + 1;
    }
  }}, {get DEFAULT_HEIGHT() {
    return 23;
  }});
;
window.WalkontableViewportRowsCalculator = WalkontableViewportRowsCalculator;

//# 
},{}],6:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableCellCoords: {get: function() {
      return WalkontableCellCoords;
    }},
  __esModule: {value: true}
});
var WalkontableCellCoords = function WalkontableCellCoords(row, col) {
  if (typeof row !== 'undefined' && typeof col !== 'undefined') {
    this.row = row;
    this.col = col;
  } else {
    this.row = null;
    this.col = null;
  }
};
($traceurRuntime.createClass)(WalkontableCellCoords, {
  isValid: function(wotInstance) {
    if (this.row < 0 || this.col < 0) {
      return false;
    }
    if (this.row >= wotInstance.getSetting('totalRows') || this.col >= wotInstance.getSetting('totalColumns')) {
      return false;
    }
    return true;
  },
  isEqual: function(cellCoords) {
    if (cellCoords === this) {
      return true;
    }
    return this.row === cellCoords.row && this.col === cellCoords.col;
  },
  isSouthEastOf: function(testedCoords) {
    return this.row >= testedCoords.row && this.col >= testedCoords.col;
  },
  isNorthWestOf: function(testedCoords) {
    return this.row <= testedCoords.row && this.col <= testedCoords.col;
  },
  isSouthWestOf: function(testedCoords) {
    return this.row >= testedCoords.row && this.col <= testedCoords.col;
  },
  isNorthEastOf: function(testedCoords) {
    return this.row <= testedCoords.row && this.col >= testedCoords.col;
  }
}, {});
;
window.WalkontableCellCoords = WalkontableCellCoords;

//# 
},{}],7:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableCellRange: {get: function() {
      return WalkontableCellRange;
    }},
  __esModule: {value: true}
});
var $___46__46__47_cell_47_coords__;
var WalkontableCellCoords = ($___46__46__47_cell_47_coords__ = _dereq_("cell/coords"), $___46__46__47_cell_47_coords__ && $___46__46__47_cell_47_coords__.__esModule && $___46__46__47_cell_47_coords__ || {default: $___46__46__47_cell_47_coords__}).WalkontableCellCoords;
var WalkontableCellRange = function WalkontableCellRange(highlight, from, to) {
  this.highlight = highlight;
  this.from = from;
  this.to = to;
};
var $WalkontableCellRange = WalkontableCellRange;
($traceurRuntime.createClass)(WalkontableCellRange, {
  isValid: function(wotInstance) {
    return this.from.isValid(wotInstance) && this.to.isValid(wotInstance);
  },
  isSingle: function() {
    return this.from.row === this.to.row && this.from.col === this.to.col;
  },
  getHeight: function() {
    return Math.max(this.from.row, this.to.row) - Math.min(this.from.row, this.to.row) + 1;
  },
  getWidth: function() {
    return Math.max(this.from.col, this.to.col) - Math.min(this.from.col, this.to.col) + 1;
  },
  includes: function(cellCoords) {
    var $__2 = cellCoords,
        row = $__2.row,
        col = $__2.col;
    var topLeft = this.getTopLeftCorner();
    var bottomRight = this.getBottomRightCorner();
    return topLeft.row <= row && bottomRight.row >= row && topLeft.col <= col && bottomRight.col >= col;
  },
  includesRange: function(testedRange) {
    return this.includes(testedRange.getTopLeftCorner()) && this.includes(testedRange.getBottomRightCorner());
  },
  isEqual: function(testedRange) {
    return (Math.min(this.from.row, this.to.row) == Math.min(testedRange.from.row, testedRange.to.row)) && (Math.max(this.from.row, this.to.row) == Math.max(testedRange.from.row, testedRange.to.row)) && (Math.min(this.from.col, this.to.col) == Math.min(testedRange.from.col, testedRange.to.col)) && (Math.max(this.from.col, this.to.col) == Math.max(testedRange.from.col, testedRange.to.col));
  },
  overlaps: function(testedRange) {
    return testedRange.isSouthEastOf(this.getTopLeftCorner()) && testedRange.isNorthWestOf(this.getBottomRightCorner());
  },
  isSouthEastOf: function(testedCoords) {
    return this.getTopLeftCorner().isSouthEastOf(testedCoords) || this.getBottomRightCorner().isSouthEastOf(testedCoords);
  },
  isNorthWestOf: function(testedCoords) {
    return this.getTopLeftCorner().isNorthWestOf(testedCoords) || this.getBottomRightCorner().isNorthWestOf(testedCoords);
  },
  expand: function(cellCoords) {
    var topLeft = this.getTopLeftCorner();
    var bottomRight = this.getBottomRightCorner();
    if (cellCoords.row < topLeft.row || cellCoords.col < topLeft.col || cellCoords.row > bottomRight.row || cellCoords.col > bottomRight.col) {
      this.from = new WalkontableCellCoords(Math.min(topLeft.row, cellCoords.row), Math.min(topLeft.col, cellCoords.col));
      this.to = new WalkontableCellCoords(Math.max(bottomRight.row, cellCoords.row), Math.max(bottomRight.col, cellCoords.col));
      return true;
    }
    return false;
  },
  expandByRange: function(expandingRange) {
    if (this.includesRange(expandingRange) || !this.overlaps(expandingRange)) {
      return false;
    }
    var topLeft = this.getTopLeftCorner();
    var bottomRight = this.getBottomRightCorner();
    var topRight = this.getTopRightCorner();
    var bottomLeft = this.getBottomLeftCorner();
    var expandingTopLeft = expandingRange.getTopLeftCorner();
    var expandingBottomRight = expandingRange.getBottomRightCorner();
    var resultTopRow = Math.min(topLeft.row, expandingTopLeft.row);
    var resultTopCol = Math.min(topLeft.col, expandingTopLeft.col);
    var resultBottomRow = Math.max(bottomRight.row, expandingBottomRight.row);
    var resultBottomCol = Math.max(bottomRight.col, expandingBottomRight.col);
    var finalFrom = new WalkontableCellCoords(resultTopRow, resultTopCol),
        finalTo = new WalkontableCellCoords(resultBottomRow, resultBottomCol);
    var isCorner = new $WalkontableCellRange(finalFrom, finalFrom, finalTo).isCorner(this.from, expandingRange),
        onlyMerge = expandingRange.isEqual(new $WalkontableCellRange(finalFrom, finalFrom, finalTo));
    if (isCorner && !onlyMerge) {
      if (this.from.col > finalFrom.col) {
        finalFrom.col = resultBottomCol;
        finalTo.col = resultTopCol;
      }
      if (this.from.row > finalFrom.row) {
        finalFrom.row = resultBottomRow;
        finalTo.row = resultTopRow;
      }
    }
    this.from = finalFrom;
    this.to = finalTo;
    return true;
  },
  getDirection: function() {
    if (this.from.isNorthWestOf(this.to)) {
      return 'NW-SE';
    } else if (this.from.isNorthEastOf(this.to)) {
      return 'NE-SW';
    } else if (this.from.isSouthEastOf(this.to)) {
      return 'SE-NW';
    } else if (this.from.isSouthWestOf(this.to)) {
      return 'SW-NE';
    }
  },
  setDirection: function(direction) {
    var $__2,
        $__3,
        $__4,
        $__5;
    switch (direction) {
      case 'NW-SE':
        ($__2 = [this.getTopLeftCorner(), this.getBottomRightCorner()], this.from = $__2[0], this.to = $__2[1], $__2);
        break;
      case 'NE-SW':
        ($__3 = [this.getTopRightCorner(), this.getBottomLeftCorner()], this.from = $__3[0], this.to = $__3[1], $__3);
        break;
      case 'SE-NW':
        ($__4 = [this.getBottomRightCorner(), this.getTopLeftCorner()], this.from = $__4[0], this.to = $__4[1], $__4);
        break;
      case 'SW-NE':
        ($__5 = [this.getBottomLeftCorner(), this.getTopRightCorner()], this.from = $__5[0], this.to = $__5[1], $__5);
        break;
    }
  },
  getTopLeftCorner: function() {
    return new WalkontableCellCoords(Math.min(this.from.row, this.to.row), Math.min(this.from.col, this.to.col));
  },
  getBottomRightCorner: function() {
    return new WalkontableCellCoords(Math.max(this.from.row, this.to.row), Math.max(this.from.col, this.to.col));
  },
  getTopRightCorner: function() {
    return new WalkontableCellCoords(Math.min(this.from.row, this.to.row), Math.max(this.from.col, this.to.col));
  },
  getBottomLeftCorner: function() {
    return new WalkontableCellCoords(Math.max(this.from.row, this.to.row), Math.min(this.from.col, this.to.col));
  },
  isCorner: function(coords, expandedRange) {
    if (expandedRange) {
      if (expandedRange.includes(coords)) {
        if (this.getTopLeftCorner().isEqual(new WalkontableCellCoords(expandedRange.from.row, expandedRange.from.col)) || this.getTopRightCorner().isEqual(new WalkontableCellCoords(expandedRange.from.row, expandedRange.to.col)) || this.getBottomLeftCorner().isEqual(new WalkontableCellCoords(expandedRange.to.row, expandedRange.from.col)) || this.getBottomRightCorner().isEqual(new WalkontableCellCoords(expandedRange.to.row, expandedRange.to.col))) {
          return true;
        }
      }
    }
    return coords.isEqual(this.getTopLeftCorner()) || coords.isEqual(this.getTopRightCorner()) || coords.isEqual(this.getBottomLeftCorner()) || coords.isEqual(this.getBottomRightCorner());
  },
  getOppositeCorner: function(coords, expandedRange) {
    if (!(coords instanceof WalkontableCellCoords)) {
      return false;
    }
    if (expandedRange) {
      if (expandedRange.includes(coords)) {
        if (this.getTopLeftCorner().isEqual(new WalkontableCellCoords(expandedRange.from.row, expandedRange.from.col))) {
          return this.getBottomRightCorner();
        }
        if (this.getTopRightCorner().isEqual(new WalkontableCellCoords(expandedRange.from.row, expandedRange.to.col))) {
          return this.getBottomLeftCorner();
        }
        if (this.getBottomLeftCorner().isEqual(new WalkontableCellCoords(expandedRange.to.row, expandedRange.from.col))) {
          return this.getTopRightCorner();
        }
        if (this.getBottomRightCorner().isEqual(new WalkontableCellCoords(expandedRange.to.row, expandedRange.to.col))) {
          return this.getTopLeftCorner();
        }
      }
    }
    if (coords.isEqual(this.getBottomRightCorner())) {
      return this.getTopLeftCorner();
    } else if (coords.isEqual(this.getTopLeftCorner())) {
      return this.getBottomRightCorner();
    } else if (coords.isEqual(this.getTopRightCorner())) {
      return this.getBottomLeftCorner();
    } else if (coords.isEqual(this.getBottomLeftCorner())) {
      return this.getTopRightCorner();
    }
  },
  getBordersSharedWith: function(range) {
    if (!this.includesRange(range)) {
      return [];
    }
    var thisBorders = {
      top: Math.min(this.from.row, this.to.row),
      bottom: Math.max(this.from.row, this.to.row),
      left: Math.min(this.from.col, this.to.col),
      right: Math.max(this.from.col, this.to.col)
    };
    var rangeBorders = {
      top: Math.min(range.from.row, range.to.row),
      bottom: Math.max(range.from.row, range.to.row),
      left: Math.min(range.from.col, range.to.col),
      right: Math.max(range.from.col, range.to.col)
    };
    var result = [];
    if (thisBorders.top == rangeBorders.top) {
      result.push('top');
    }
    if (thisBorders.right == rangeBorders.right) {
      result.push('right');
    }
    if (thisBorders.bottom == rangeBorders.bottom) {
      result.push('bottom');
    }
    if (thisBorders.left == rangeBorders.left) {
      result.push('left');
    }
    return result;
  },
  getInner: function() {
    var topLeft = this.getTopLeftCorner();
    var bottomRight = this.getBottomRightCorner();
    var out = [];
    for (var r = topLeft.row; r <= bottomRight.row; r++) {
      for (var c = topLeft.col; c <= bottomRight.col; c++) {
        if (!(this.from.row === r && this.from.col === c) && !(this.to.row === r && this.to.col === c)) {
          out.push(new WalkontableCellCoords(r, c));
        }
      }
    }
    return out;
  },
  getAll: function() {
    var topLeft = this.getTopLeftCorner();
    var bottomRight = this.getBottomRightCorner();
    var out = [];
    for (var r = topLeft.row; r <= bottomRight.row; r++) {
      for (var c = topLeft.col; c <= bottomRight.col; c++) {
        if (topLeft.row === r && topLeft.col === c) {
          out.push(topLeft);
        } else if (bottomRight.row === r && bottomRight.col === c) {
          out.push(bottomRight);
        } else {
          out.push(new WalkontableCellCoords(r, c));
        }
      }
    }
    return out;
  },
  forAll: function(callback) {
    var topLeft = this.getTopLeftCorner();
    var bottomRight = this.getBottomRightCorner();
    for (var r = topLeft.row; r <= bottomRight.row; r++) {
      for (var c = topLeft.col; c <= bottomRight.col; c++) {
        var breakIteration = callback(r, c);
        if (breakIteration === false) {
          return;
        }
      }
    }
  }
}, {});
;
window.WalkontableCellRange = WalkontableCellRange;

//# 
},{"cell/coords":6}],8:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  Walkontable: {get: function() {
      return Walkontable;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47__46__46__47_helpers_47_object__,
    $___46__46__47__46__46__47__46__46__47_helpers_47_string__,
    $__event__,
    $__overlays__,
    $__scroll__,
    $__settings__,
    $__table__,
    $__viewport__,
    $__overlay_47__95_base_46_js__,
    $__overlay_47_top_46_js__,
    $__overlay_47_left_46_js__,
    $__overlay_47_debug_46_js__,
    $__overlay_47_topLeftCorner_46_js__;
var $__0 = ($___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}),
    addClass = $__0.addClass,
    fastInnerText = $__0.fastInnerText,
    isVisible = $__0.isVisible,
    removeClass = $__0.removeClass;
var objectEach = ($___46__46__47__46__46__47__46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47__46__46__47__46__46__47_helpers_47_object__ && $___46__46__47__46__46__47__46__46__47_helpers_47_object__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_object__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_object__}).objectEach;
var $__2 = ($___46__46__47__46__46__47__46__46__47_helpers_47_string__ = _dereq_("helpers/string"), $___46__46__47__46__46__47__46__46__47_helpers_47_string__ && $___46__46__47__46__46__47__46__46__47_helpers_47_string__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_string__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_string__}),
    toUpperCaseFirst = $__2.toUpperCaseFirst,
    randomString = $__2.randomString;
var WalkontableEvent = ($__event__ = _dereq_("event"), $__event__ && $__event__.__esModule && $__event__ || {default: $__event__}).WalkontableEvent;
var WalkontableOverlays = ($__overlays__ = _dereq_("overlays"), $__overlays__ && $__overlays__.__esModule && $__overlays__ || {default: $__overlays__}).WalkontableOverlays;
var WalkontableScroll = ($__scroll__ = _dereq_("scroll"), $__scroll__ && $__scroll__.__esModule && $__scroll__ || {default: $__scroll__}).WalkontableScroll;
var WalkontableSettings = ($__settings__ = _dereq_("settings"), $__settings__ && $__settings__.__esModule && $__settings__ || {default: $__settings__}).WalkontableSettings;
var WalkontableTable = ($__table__ = _dereq_("table"), $__table__ && $__table__.__esModule && $__table__ || {default: $__table__}).WalkontableTable;
var WalkontableViewport = ($__viewport__ = _dereq_("viewport"), $__viewport__ && $__viewport__.__esModule && $__viewport__ || {default: $__viewport__}).WalkontableViewport;
var WalkontableOverlay = ($__overlay_47__95_base_46_js__ = _dereq_("overlay/_base.js"), $__overlay_47__95_base_46_js__ && $__overlay_47__95_base_46_js__.__esModule && $__overlay_47__95_base_46_js__ || {default: $__overlay_47__95_base_46_js__}).WalkontableOverlay;
var WalkontableTopOverlay = ($__overlay_47_top_46_js__ = _dereq_("overlay/top.js"), $__overlay_47_top_46_js__ && $__overlay_47_top_46_js__.__esModule && $__overlay_47_top_46_js__ || {default: $__overlay_47_top_46_js__}).WalkontableTopOverlay;
var WalkontableLeftOverlay = ($__overlay_47_left_46_js__ = _dereq_("overlay/left.js"), $__overlay_47_left_46_js__ && $__overlay_47_left_46_js__.__esModule && $__overlay_47_left_46_js__ || {default: $__overlay_47_left_46_js__}).WalkontableLeftOverlay;
var WalkontableDebugOverlay = ($__overlay_47_debug_46_js__ = _dereq_("overlay/debug.js"), $__overlay_47_debug_46_js__ && $__overlay_47_debug_46_js__.__esModule && $__overlay_47_debug_46_js__ || {default: $__overlay_47_debug_46_js__}).WalkontableDebugOverlay;
var WalkontableTopLeftCornerOverlay = ($__overlay_47_topLeftCorner_46_js__ = _dereq_("overlay/topLeftCorner.js"), $__overlay_47_topLeftCorner_46_js__ && $__overlay_47_topLeftCorner_46_js__.__esModule && $__overlay_47_topLeftCorner_46_js__ || {default: $__overlay_47_topLeftCorner_46_js__}).WalkontableTopLeftCornerOverlay;
var Walkontable = function Walkontable(settings) {
  var originalHeaders = [];
  this.guid = 'wt_' + randomString();
  if (settings.cloneSource) {
    this.cloneSource = settings.cloneSource;
    this.cloneOverlay = settings.cloneOverlay;
    this.wtSettings = settings.cloneSource.wtSettings;
    this.wtTable = new WalkontableTable(this, settings.table, settings.wtRootElement);
    this.wtScroll = new WalkontableScroll(this);
    this.wtViewport = settings.cloneSource.wtViewport;
    this.wtEvent = new WalkontableEvent(this);
    this.selections = this.cloneSource.selections;
  } else {
    this.wtSettings = new WalkontableSettings(this, settings);
    this.wtTable = new WalkontableTable(this, settings.table);
    this.wtScroll = new WalkontableScroll(this);
    this.wtViewport = new WalkontableViewport(this);
    this.wtEvent = new WalkontableEvent(this);
    this.selections = this.getSetting('selections');
    this.wtOverlays = new WalkontableOverlays(this);
    this.exportSettingsAsClassNames();
  }
  if (this.wtTable.THEAD.childNodes.length && this.wtTable.THEAD.childNodes[0].childNodes.length) {
    for (var c = 0,
        clen = this.wtTable.THEAD.childNodes[0].childNodes.length; c < clen; c++) {
      originalHeaders.push(this.wtTable.THEAD.childNodes[0].childNodes[c].innerHTML);
    }
    if (!this.getSetting('columnHeaders').length) {
      this.update('columnHeaders', [function(column, TH) {
        fastInnerText(TH, originalHeaders[column]);
      }]);
    }
  }
  this.drawn = false;
  this.drawInterrupted = false;
};
($traceurRuntime.createClass)(Walkontable, {
  draw: function() {
    var fastDraw = arguments[0] !== (void 0) ? arguments[0] : false;
    this.drawInterrupted = false;
    if (!fastDraw && !isVisible(this.wtTable.TABLE)) {
      this.drawInterrupted = true;
    } else {
      this.wtTable.draw(fastDraw);
    }
    return this;
  },
  getCell: function(coords) {
    var topmost = arguments[1] !== (void 0) ? arguments[1] : false;
    if (!topmost) {
      return this.wtTable.getCell(coords);
    }
    var totalRows = this.wtSettings.getSetting('totalRows');
    var fixedRowsTop = this.wtSettings.getSetting('fixedRowsTop');
    var fixedRowsBottom = this.wtSettings.getSetting('fixedRowsBottom');
    var fixedColumns = this.wtSettings.getSetting('fixedColumnsLeft');
    if (coords.row < fixedRowsTop && coords.col < fixedColumns) {
      return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(coords);
    } else if (coords.row < fixedRowsTop) {
      return this.wtOverlays.topOverlay.clone.wtTable.getCell(coords);
    } else if (coords.col < fixedColumns && coords.row >= totalRows - fixedRowsBottom) {
      if (this.wtOverlays.bottomLeftCornerOverlay && this.wtOverlays.bottomLeftCornerOverlay.clone) {
        return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(coords);
      }
    } else if (coords.col < fixedColumns) {
      return this.wtOverlays.leftOverlay.clone.wtTable.getCell(coords);
    } else if (coords.row < totalRows && coords.row > totalRows - fixedRowsBottom) {
      if (this.wtOverlays.bottomOverlay && this.wtOverlays.bottomOverlay.clone) {
        return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(coords);
      }
    }
    return this.wtTable.getCell(coords);
  },
  update: function(settings, value) {
    return this.wtSettings.update(settings, value);
  },
  scrollVertical: function(row) {
    this.wtOverlays.topOverlay.scrollTo(row);
    this.getSetting('onScrollVertically');
    return this;
  },
  scrollHorizontal: function(column) {
    this.wtOverlays.leftOverlay.scrollTo(column);
    this.getSetting('onScrollHorizontally');
    return this;
  },
  scrollViewport: function(coords) {
    this.wtScroll.scrollViewport(coords);
    return this;
  },
  getViewport: function() {
    return [this.wtTable.getFirstVisibleRow(), this.wtTable.getFirstVisibleColumn(), this.wtTable.getLastVisibleRow(), this.wtTable.getLastVisibleColumn()];
  },
  getOverlayName: function() {
    return this.cloneOverlay ? this.cloneOverlay.type : 'master';
  },
  isOverlayName: function(name) {
    if (this.cloneOverlay) {
      return this.cloneOverlay.type === name;
    }
    return false;
  },
  exportSettingsAsClassNames: function() {
    var $__14 = this;
    var toExport = {
      rowHeaders: ['array'],
      columnHeaders: ['array']
    };
    var allClassNames = [];
    var newClassNames = [];
    objectEach(toExport, (function(optionType, key) {
      if (optionType.indexOf('array') > -1 && $__14.getSetting(key).length) {
        newClassNames.push('ht' + toUpperCaseFirst(key));
      }
      allClassNames.push('ht' + toUpperCaseFirst(key));
    }));
    removeClass(this.wtTable.wtRootElement.parentNode, allClassNames);
    addClass(this.wtTable.wtRootElement.parentNode, newClassNames);
  },
  getSetting: function(key, param1, param2, param3, param4) {
    return this.wtSettings.getSetting(key, param1, param2, param3, param4);
  },
  hasSetting: function(key) {
    return this.wtSettings.has(key);
  },
  destroy: function() {
    this.wtOverlays.destroy();
    this.wtEvent.destroy();
  }
}, {});
;
window.Walkontable = Walkontable;

//# 
},{"event":9,"helpers/dom/element":47,"helpers/object":53,"helpers/string":55,"overlay/_base.js":12,"overlay/debug.js":13,"overlay/left.js":14,"overlay/top.js":15,"overlay/topLeftCorner.js":16,"overlays":17,"scroll":18,"settings":20,"table":21,"viewport":23}],9:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableEvent: {get: function() {
      return WalkontableEvent;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47__46__46__47_helpers_47_function__,
    $___46__46__47__46__46__47__46__46__47_helpers_47_browser__,
    $___46__46__47__46__46__47__46__46__47_eventManager__;
var $__0 = ($___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}),
    closestDown = $__0.closestDown,
    hasClass = $__0.hasClass,
    isChildOf = $__0.isChildOf,
    getParent = $__0.getParent;
var partial = ($___46__46__47__46__46__47__46__46__47_helpers_47_function__ = _dereq_("helpers/function"), $___46__46__47__46__46__47__46__46__47_helpers_47_function__ && $___46__46__47__46__46__47__46__46__47_helpers_47_function__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_function__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_function__}).partial;
var isMobileBrowser = ($___46__46__47__46__46__47__46__46__47_helpers_47_browser__ = _dereq_("helpers/browser"), $___46__46__47__46__46__47__46__46__47_helpers_47_browser__ && $___46__46__47__46__46__47__46__46__47_helpers_47_browser__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_browser__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_browser__}).isMobileBrowser;
var eventManagerObject = ($___46__46__47__46__46__47__46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47__46__46__47__46__46__47_eventManager__ && $___46__46__47__46__46__47__46__46__47_eventManager__.__esModule && $___46__46__47__46__46__47__46__46__47_eventManager__ || {default: $___46__46__47__46__46__47__46__46__47_eventManager__}).eventManager;
function WalkontableEvent(instance) {
  var that = this;
  var eventManager = eventManagerObject(instance);
  this.instance = instance;
  var dblClickOrigin = [null, null];
  this.dblClickTimeout = [null, null];
  var onMouseDown = function(event) {
    var activeElement = document.activeElement;
    var getParentNode = partial(getParent, event.realTarget);
    var realTarget = event.realTarget;
    if (realTarget === activeElement || getParentNode(0) === activeElement || getParentNode(1) === activeElement) {
      return;
    }
    var cell = that.parentCell(realTarget);
    if (hasClass(realTarget, 'corner')) {
      that.instance.getSetting('onCellCornerMouseDown', event, realTarget);
    } else if (cell.TD) {
      if (that.instance.hasSetting('onCellMouseDown')) {
        that.instance.getSetting('onCellMouseDown', event, cell.coords, cell.TD, that.instance);
      }
    }
    if (event.button !== 2) {
      if (cell.TD) {
        dblClickOrigin[0] = cell.TD;
        clearTimeout(that.dblClickTimeout[0]);
        that.dblClickTimeout[0] = setTimeout(function() {
          dblClickOrigin[0] = null;
        }, 1000);
      }
    }
  };
  var onTouchMove = function(event) {
    that.instance.touchMoving = true;
  };
  var longTouchTimeout;
  var onTouchStart = function(event) {
    var container = this;
    eventManager.addEventListener(this, 'touchmove', onTouchMove);
    that.checkIfTouchMove = setTimeout(function() {
      if (that.instance.touchMoving === true) {
        that.instance.touchMoving = void 0;
        eventManager.removeEventListener('touchmove', onTouchMove, false);
        return;
      } else {
        onMouseDown(event);
      }
    }, 30);
  };
  var onMouseOver = function(event) {
    var table,
        td,
        mainWOT;
    if (that.instance.hasSetting('onCellMouseOver')) {
      table = that.instance.wtTable.TABLE;
      td = closestDown(event.realTarget, ['TD', 'TH'], table);
      mainWOT = that.instance.cloneSource || that.instance;
      if (td && td !== mainWOT.lastMouseOver && isChildOf(td, table)) {
        mainWOT.lastMouseOver = td;
        that.instance.getSetting('onCellMouseOver', event, that.instance.wtTable.getCoords(td), td, that.instance);
      }
    }
  };
  var onMouseOut = function(event) {
    var table,
        lastTD,
        nextTD;
    if (that.instance.hasSetting('onCellMouseOut')) {
      table = that.instance.wtTable.TABLE;
      lastTD = closestDown(event.realTarget, ['TD', 'TH'], table);
      nextTD = closestDown(event.relatedTarget, ['TD', 'TH'], table);
      if (lastTD && lastTD !== nextTD && isChildOf(lastTD, table)) {
        that.instance.getSetting('onCellMouseOut', event, that.instance.wtTable.getCoords(lastTD), lastTD, that.instance);
      }
    }
  };
  var onMouseUp = function(event) {
    if (event.button !== 2) {
      var cell = that.parentCell(event.realTarget);
      if (cell.TD === dblClickOrigin[0] && cell.TD === dblClickOrigin[1]) {
        if (hasClass(event.realTarget, 'corner')) {
          that.instance.getSetting('onCellCornerDblClick', event, cell.coords, cell.TD, that.instance);
        } else {
          that.instance.getSetting('onCellDblClick', event, cell.coords, cell.TD, that.instance);
        }
        dblClickOrigin[0] = null;
        dblClickOrigin[1] = null;
      } else if (cell.TD === dblClickOrigin[0]) {
        that.instance.getSetting('onCellMouseUp', event, cell.coords, cell.TD, that.instance);
        dblClickOrigin[1] = cell.TD;
        clearTimeout(that.dblClickTimeout[1]);
        that.dblClickTimeout[1] = setTimeout(function() {
          dblClickOrigin[1] = null;
        }, 500);
      } else if (cell.TD && that.instance.hasSetting('onCellMouseUp')) {
        that.instance.getSetting('onCellMouseUp', event, cell.coords, cell.TD, that.instance);
      }
    }
  };
  var onTouchEnd = function(event) {
    clearTimeout(longTouchTimeout);
    event.preventDefault();
    onMouseUp(event);
  };
  eventManager.addEventListener(this.instance.wtTable.holder, 'mousedown', onMouseDown);
  eventManager.addEventListener(this.instance.wtTable.TABLE, 'mouseover', onMouseOver);
  eventManager.addEventListener(this.instance.wtTable.TABLE, 'mouseout', onMouseOut);
  eventManager.addEventListener(this.instance.wtTable.holder, 'mouseup', onMouseUp);
  if (this.instance.wtTable.holder.parentNode.parentNode && isMobileBrowser() && !that.instance.wtTable.isWorkingOnClone()) {
    var classSelector = '.' + this.instance.wtTable.holder.parentNode.className.split(' ').join('.');
    eventManager.addEventListener(this.instance.wtTable.holder, 'touchstart', function(event) {
      that.instance.touchApplied = true;
      if (isChildOf(event.target, classSelector)) {
        onTouchStart.call(event.target, event);
      }
    });
    eventManager.addEventListener(this.instance.wtTable.holder, 'touchend', function(event) {
      that.instance.touchApplied = false;
      if (isChildOf(event.target, classSelector)) {
        onTouchEnd.call(event.target, event);
      }
    });
    if (!that.instance.momentumScrolling) {
      that.instance.momentumScrolling = {};
    }
    eventManager.addEventListener(this.instance.wtTable.holder, 'scroll', function(event) {
      clearTimeout(that.instance.momentumScrolling._timeout);
      if (!that.instance.momentumScrolling.ongoing) {
        that.instance.getSetting('onBeforeTouchScroll');
      }
      that.instance.momentumScrolling.ongoing = true;
      that.instance.momentumScrolling._timeout = setTimeout(function() {
        if (!that.instance.touchApplied) {
          that.instance.momentumScrolling.ongoing = false;
          that.instance.getSetting('onAfterMomentumScroll');
        }
      }, 200);
    });
  }
  eventManager.addEventListener(window, 'resize', function() {
    if (that.instance.getSetting('stretchH') !== 'none') {
      that.instance.draw();
    }
  });
  this.destroy = function() {
    clearTimeout(this.dblClickTimeout[0]);
    clearTimeout(this.dblClickTimeout[1]);
    eventManager.destroy();
  };
}
WalkontableEvent.prototype.parentCell = function(elem) {
  var cell = {};
  var TABLE = this.instance.wtTable.TABLE;
  var TD = closestDown(elem, ['TD', 'TH'], TABLE);
  if (TD) {
    cell.coords = this.instance.wtTable.getCoords(TD);
    cell.TD = TD;
  } else if (hasClass(elem, 'wtBorder') && hasClass(elem, 'current')) {
    cell.coords = this.instance.selections.current.cellRange.highlight;
    cell.TD = this.instance.wtTable.getCell(cell.coords);
  } else if (hasClass(elem, 'wtBorder') && hasClass(elem, 'area')) {
    if (this.instance.selections.area.cellRange) {
      cell.coords = this.instance.selections.area.cellRange.to;
      cell.TD = this.instance.wtTable.getCell(cell.coords);
    }
  }
  return cell;
};
;
window.WalkontableEvent = WalkontableEvent;

//# 
},{"eventManager":42,"helpers/browser":44,"helpers/dom/element":47,"helpers/function":50}],10:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableColumnFilter: {get: function() {
      return WalkontableColumnFilter;
    }},
  __esModule: {value: true}
});
var WalkontableColumnFilter = function WalkontableColumnFilter(offset, total, countTH) {
  this.offset = offset;
  this.total = total;
  this.countTH = countTH;
};
($traceurRuntime.createClass)(WalkontableColumnFilter, {
  offsetted: function(index) {
    return index + this.offset;
  },
  unOffsetted: function(index) {
    return index - this.offset;
  },
  renderedToSource: function(index) {
    return this.offsetted(index);
  },
  sourceToRendered: function(index) {
    return this.unOffsetted(index);
  },
  offsettedTH: function(index) {
    return index - this.countTH;
  },
  unOffsettedTH: function(index) {
    return index + this.countTH;
  },
  visibleRowHeadedColumnToSourceColumn: function(index) {
    return this.renderedToSource(this.offsettedTH(index));
  },
  sourceColumnToVisibleRowHeadedColumn: function(index) {
    return this.unOffsettedTH(this.sourceToRendered(index));
  }
}, {});
;
window.WalkontableColumnFilter = WalkontableColumnFilter;

//# 
},{}],11:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableRowFilter: {get: function() {
      return WalkontableRowFilter;
    }},
  __esModule: {value: true}
});
var WalkontableRowFilter = function WalkontableRowFilter(offset, total, countTH) {
  this.offset = offset;
  this.total = total;
  this.countTH = countTH;
};
($traceurRuntime.createClass)(WalkontableRowFilter, {
  offsetted: function(index) {
    return index + this.offset;
  },
  unOffsetted: function(index) {
    return index - this.offset;
  },
  renderedToSource: function(index) {
    return this.offsetted(index);
  },
  sourceToRendered: function(index) {
    return this.unOffsetted(index);
  },
  offsettedTH: function(index) {
    return index - this.countTH;
  },
  unOffsettedTH: function(index) {
    return index + this.countTH;
  },
  visibleColHeadedRowToSourceRow: function(index) {
    return this.renderedToSource(this.offsettedTH(index));
  },
  sourceRowToVisibleColHeadedRow: function(index) {
    return this.unOffsettedTH(this.sourceToRendered(index));
  }
}, {});
;
window.WalkontableRowFilter = WalkontableRowFilter;

//# 
},{}],12:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableOverlay: {get: function() {
      return WalkontableOverlay;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_object__,
    $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__46__46__47__46__46__47__46__46__47_eventManager__;
var $__0 = ($___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}),
    getScrollableElement = $__0.getScrollableElement,
    getTrimmingContainer = $__0.getTrimmingContainer;
var defineGetter = ($___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_object__ && $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_object__.__esModule && $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_object__ || {default: $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_object__}).defineGetter;
var arrayEach = ($___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_array__}).arrayEach;
var eventManagerObject = ($___46__46__47__46__46__47__46__46__47__46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47__46__46__47__46__46__47__46__46__47_eventManager__ && $___46__46__47__46__46__47__46__46__47__46__46__47_eventManager__.__esModule && $___46__46__47__46__46__47__46__46__47__46__46__47_eventManager__ || {default: $___46__46__47__46__46__47__46__46__47__46__46__47_eventManager__}).eventManager;
var registeredOverlays = {};
var WalkontableOverlay = function WalkontableOverlay(wotInstance) {
  defineGetter(this, 'wot', wotInstance, {writable: false});
  this.instance = this.wot;
  this.type = '';
  this.mainTableScrollableElement = null;
  this.TABLE = this.wot.wtTable.TABLE;
  this.hider = this.wot.wtTable.hider;
  this.spreader = this.wot.wtTable.spreader;
  this.holder = this.wot.wtTable.holder;
  this.wtRootElement = this.wot.wtTable.wtRootElement;
  this.trimmingContainer = getTrimmingContainer(this.hider.parentNode.parentNode);
  this.areElementSizesAdjusted = false;
  this.updateStateOfRendering();
};
var $WalkontableOverlay = WalkontableOverlay;
($traceurRuntime.createClass)(WalkontableOverlay, {
  updateStateOfRendering: function() {
    var previousState = this.needFullRender;
    this.needFullRender = this.shouldBeRendered();
    var changed = previousState !== this.needFullRender;
    if (changed && !this.needFullRender) {
      this.reset();
    }
    return changed;
  },
  shouldBeRendered: function() {
    return true;
  },
  updateTrimmingContainer: function() {
    this.trimmingContainer = getTrimmingContainer(this.hider.parentNode.parentNode);
  },
  updateMainScrollableElement: function() {
    this.mainTableScrollableElement = getScrollableElement(this.wot.wtTable.TABLE);
  },
  makeClone: function(direction) {
    if ($WalkontableOverlay.CLONE_TYPES.indexOf(direction) === -1) {
      throw new Error('Clone type "' + direction + '" is not supported.');
    }
    var clone = document.createElement('DIV');
    var clonedTable = document.createElement('TABLE');
    clone.className = 'ht_clone_' + direction + ' handsontable';
    clone.style.position = 'absolute';
    clone.style.top = 0;
    clone.style.left = 0;
    clone.style.overflow = 'hidden';
    clonedTable.className = this.wot.wtTable.TABLE.className;
    clone.appendChild(clonedTable);
    this.type = direction;
    this.wot.wtTable.wtRootElement.parentNode.appendChild(clone);
    var preventOverflow = this.wot.getSetting('preventOverflow');
    if (preventOverflow === true || preventOverflow === 'horizontal' && this.type === $WalkontableOverlay.CLONE_TOP || preventOverflow === 'vertical' && this.type === $WalkontableOverlay.CLONE_LEFT) {
      this.mainTableScrollableElement = window;
    } else {
      this.mainTableScrollableElement = getScrollableElement(this.wot.wtTable.TABLE);
    }
    return new Walkontable({
      cloneSource: this.wot,
      cloneOverlay: this,
      table: clonedTable
    });
  },
  refresh: function() {
    var fastDraw = arguments[0] !== (void 0) ? arguments[0] : false;
    var nextCycleRenderFlag = this.shouldBeRendered();
    if (this.clone && (this.needFullRender || nextCycleRenderFlag)) {
      this.clone.draw(fastDraw);
    }
    this.needFullRender = nextCycleRenderFlag;
  },
  reset: function() {
    if (!this.clone) {
      return;
    }
    var holder = this.clone.wtTable.holder;
    var hider = this.clone.wtTable.hider;
    var holderStyle = holder.style;
    var hidderStyle = hider.style;
    var rootStyle = holder.parentNode.style;
    arrayEach([holderStyle, hidderStyle, rootStyle], (function(style) {
      style.width = '';
      style.height = '';
    }));
  },
  destroy: function() {
    eventManagerObject(this.clone).destroy();
  }
}, {
  get CLONE_TOP() {
    return 'top';
  },
  get CLONE_BOTTOM() {
    return 'bottom';
  },
  get CLONE_LEFT() {
    return 'left';
  },
  get CLONE_TOP_LEFT_CORNER() {
    return 'top_left_corner';
  },
  get CLONE_BOTTOM_LEFT_CORNER() {
    return 'bottom_left_corner';
  },
  get CLONE_DEBUG() {
    return 'debug';
  },
  get CLONE_TYPES() {
    return [$WalkontableOverlay.CLONE_TOP, $WalkontableOverlay.CLONE_BOTTOM, $WalkontableOverlay.CLONE_LEFT, $WalkontableOverlay.CLONE_TOP_LEFT_CORNER, $WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER, $WalkontableOverlay.CLONE_DEBUG];
  },
  registerOverlay: function(type, overlayClass) {
    if ($WalkontableOverlay.CLONE_TYPES.indexOf(type) === -1) {
      throw new Error(("Unsupported overlay (" + type + ")."));
    }
    registeredOverlays[type] = overlayClass;
  },
  createOverlay: function(type, wot) {
    return new registeredOverlays[type](wot);
  },
  isOverlayTypeOf: function(overlay, type) {
    if (!overlay || !registeredOverlays[type]) {
      return false;
    }
    return overlay instanceof registeredOverlays[type];
  }
});
;
window.WalkontableOverlay = WalkontableOverlay;

//# 
},{"eventManager":42,"helpers/array":43,"helpers/dom/element":47,"helpers/object":53}],13:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableDebugOverlay: {get: function() {
      return WalkontableDebugOverlay;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___95_base__;
var addClass = ($___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}).addClass;
var WalkontableOverlay = ($___95_base__ = _dereq_("_base"), $___95_base__ && $___95_base__.__esModule && $___95_base__ || {default: $___95_base__}).WalkontableOverlay;
var WalkontableDebugOverlay = function WalkontableDebugOverlay(wotInstance) {
  $traceurRuntime.superConstructor($WalkontableDebugOverlay).call(this, wotInstance);
  this.clone = this.makeClone(WalkontableOverlay.CLONE_DEBUG);
  this.clone.wtTable.holder.style.opacity = 0.4;
  this.clone.wtTable.holder.style.textShadow = '0 0 2px #ff0000';
  addClass(this.clone.wtTable.holder.parentNode, 'wtDebugVisible');
};
var $WalkontableDebugOverlay = WalkontableDebugOverlay;
($traceurRuntime.createClass)(WalkontableDebugOverlay, {}, {}, WalkontableOverlay);
;
window.WalkontableDebugOverlay = WalkontableDebugOverlay;
WalkontableOverlay.registerOverlay(WalkontableOverlay.CLONE_DEBUG, WalkontableDebugOverlay);

//# 
},{"_base":12,"helpers/dom/element":47}],14:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableLeftOverlay: {get: function() {
      return WalkontableLeftOverlay;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___95_base__;
var $__0 = ($___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}),
    addClass = $__0.addClass,
    getScrollbarWidth = $__0.getScrollbarWidth,
    getScrollLeft = $__0.getScrollLeft,
    getWindowScrollTop = $__0.getWindowScrollTop,
    hasClass = $__0.hasClass,
    outerWidth = $__0.outerWidth,
    innerHeight = $__0.innerHeight,
    removeClass = $__0.removeClass,
    setOverlayPosition = $__0.setOverlayPosition,
    resetCssTransform = $__0.resetCssTransform;
var WalkontableOverlay = ($___95_base__ = _dereq_("_base"), $___95_base__ && $___95_base__.__esModule && $___95_base__ || {default: $___95_base__}).WalkontableOverlay;
var WalkontableLeftOverlay = function WalkontableLeftOverlay(wotInstance) {
  $traceurRuntime.superConstructor($WalkontableLeftOverlay).call(this, wotInstance);
  this.clone = this.makeClone(WalkontableOverlay.CLONE_LEFT);
};
var $WalkontableLeftOverlay = WalkontableLeftOverlay;
($traceurRuntime.createClass)(WalkontableLeftOverlay, {
  shouldBeRendered: function() {
    return this.wot.getSetting('fixedColumnsLeft') || this.wot.getSetting('rowHeaders').length ? true : false;
  },
  resetFixedPosition: function() {
    if (!this.needFullRender || !this.wot.wtTable.holder.parentNode) {
      return;
    }
    var overlayRoot = this.clone.wtTable.holder.parentNode;
    var headerPosition = 0;
    var preventOverflow = this.wot.getSetting('preventOverflow');
    if (this.trimmingContainer === window && (!preventOverflow || preventOverflow !== 'horizontal')) {
      var box = this.wot.wtTable.hider.getBoundingClientRect();
      var left = Math.ceil(box.left);
      var right = Math.ceil(box.right);
      var finalLeft;
      var finalTop;
      finalTop = this.wot.wtTable.hider.style.top;
      finalTop = finalTop === '' ? 0 : finalTop;
      if (left < 0 && (right - overlayRoot.offsetWidth) > 0) {
        finalLeft = -left;
      } else {
        finalLeft = 0;
      }
      headerPosition = finalLeft;
      finalLeft = finalLeft + 'px';
      setOverlayPosition(overlayRoot, finalLeft, finalTop);
    } else {
      headerPosition = this.getScrollPosition();
      resetCssTransform(overlayRoot);
    }
    this.adjustHeaderBordersPosition(headerPosition);
    this.adjustElementsSize();
  },
  setScrollPosition: function(pos) {
    if (this.mainTableScrollableElement === window) {
      window.scrollTo(pos, getWindowScrollTop());
    } else {
      this.mainTableScrollableElement.scrollLeft = pos;
    }
  },
  onScroll: function() {
    this.wot.getSetting('onScrollVertically');
  },
  sumCellSizes: function(from, to) {
    var sum = 0;
    var defaultColumnWidth = this.wot.wtSettings.defaultColumnWidth;
    while (from < to) {
      sum += this.wot.wtTable.getStretchedColumnWidth(from) || defaultColumnWidth;
      from++;
    }
    return sum;
  },
  adjustElementsSize: function() {
    var force = arguments[0] !== (void 0) ? arguments[0] : false;
    this.updateTrimmingContainer();
    if (this.needFullRender || force) {
      this.adjustRootElementSize();
      this.adjustRootChildrenSize();
      if (!force) {
        this.areElementSizesAdjusted = true;
      }
    }
  },
  adjustRootElementSize: function() {
    var masterHolder = this.wot.wtTable.holder;
    var scrollbarHeight = masterHolder.clientHeight === masterHolder.offsetHeight ? 0 : getScrollbarWidth();
    var overlayRoot = this.clone.wtTable.holder.parentNode;
    var overlayRootStyle = overlayRoot.style;
    var preventOverflow = this.wot.getSetting('preventOverflow');
    var tableWidth;
    if (this.trimmingContainer !== window || preventOverflow === 'vertical') {
      var height = this.wot.wtViewport.getWorkspaceHeight() - scrollbarHeight;
      height = Math.min(height, innerHeight(this.wot.wtTable.wtRootElement));
      overlayRootStyle.height = height + 'px';
    } else {
      overlayRootStyle.height = '';
    }
    this.clone.wtTable.holder.style.height = overlayRootStyle.height;
    tableWidth = outerWidth(this.clone.wtTable.TABLE);
    overlayRootStyle.width = (tableWidth === 0 ? tableWidth : tableWidth + 4) + 'px';
  },
  adjustRootChildrenSize: function() {
    var scrollbarWidth = getScrollbarWidth();
    this.clone.wtTable.hider.style.height = this.hider.style.height;
    this.clone.wtTable.holder.style.height = this.clone.wtTable.holder.parentNode.style.height;
    if (scrollbarWidth === 0) {
      scrollbarWidth = 30;
    }
    this.clone.wtTable.holder.style.width = parseInt(this.clone.wtTable.holder.parentNode.style.width, 10) + scrollbarWidth + 'px';
  },
  applyToDOM: function() {
    var total = this.wot.getSetting('totalColumns');
    if (!this.areElementSizesAdjusted) {
      this.adjustElementsSize();
    }
    if (typeof this.wot.wtViewport.columnsRenderCalculator.startPosition === 'number') {
      this.spreader.style.left = this.wot.wtViewport.columnsRenderCalculator.startPosition + 'px';
    } else if (total === 0) {
      this.spreader.style.left = '0';
    } else {
      throw new Error('Incorrect value of the columnsRenderCalculator');
    }
    this.spreader.style.right = '';
    if (this.needFullRender) {
      this.syncOverlayOffset();
    }
  },
  syncOverlayOffset: function() {
    if (typeof this.wot.wtViewport.rowsRenderCalculator.startPosition === 'number') {
      this.clone.wtTable.spreader.style.top = this.wot.wtViewport.rowsRenderCalculator.startPosition + 'px';
    } else {
      this.clone.wtTable.spreader.style.top = '';
    }
  },
  scrollTo: function(sourceCol, beyondRendered) {
    var newX = this.getTableParentOffset();
    var sourceInstance = this.wot.cloneSource ? this.wot.cloneSource : this.wot;
    var mainHolder = sourceInstance.wtTable.holder;
    var scrollbarCompensation = 0;
    if (beyondRendered && mainHolder.offsetWidth !== mainHolder.clientWidth) {
      scrollbarCompensation = getScrollbarWidth();
    }
    if (beyondRendered) {
      newX += this.sumCellSizes(0, sourceCol + 1);
      newX -= this.wot.wtViewport.getViewportWidth();
    } else {
      newX += this.sumCellSizes(this.wot.getSetting('fixedColumnsLeft'), sourceCol);
    }
    newX += scrollbarCompensation;
    this.setScrollPosition(newX);
  },
  getTableParentOffset: function() {
    var preventOverflow = this.wot.getSetting('preventOverflow');
    var offset = 0;
    if (!preventOverflow && this.trimmingContainer === window) {
      offset = this.wot.wtTable.holderOffset.left;
    }
    return offset;
  },
  getScrollPosition: function() {
    return getScrollLeft(this.mainTableScrollableElement);
  },
  adjustHeaderBordersPosition: function(position) {
    var masterParent = this.wot.wtTable.holder.parentNode;
    var rowHeaders = this.wot.getSetting('rowHeaders');
    var fixedColumnsLeft = this.wot.getSetting('fixedColumnsLeft');
    var totalRows = this.wot.getSetting('totalRows');
    if (totalRows) {
      removeClass(masterParent, 'emptyRows');
    } else {
      addClass(masterParent, 'emptyRows');
    }
    if (fixedColumnsLeft && !rowHeaders.length) {
      addClass(masterParent, 'innerBorderLeft');
    } else if (!fixedColumnsLeft && rowHeaders.length) {
      var previousState = hasClass(masterParent, 'innerBorderLeft');
      if (position) {
        addClass(masterParent, 'innerBorderLeft');
      } else {
        removeClass(masterParent, 'innerBorderLeft');
      }
      if (!previousState && position || previousState && !position) {
        this.wot.wtOverlays.adjustElementsSize();
      }
    }
  }
}, {}, WalkontableOverlay);
;
window.WalkontableLeftOverlay = WalkontableLeftOverlay;
WalkontableOverlay.registerOverlay(WalkontableOverlay.CLONE_LEFT, WalkontableLeftOverlay);

//# 
},{"_base":12,"helpers/dom/element":47}],15:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableTopOverlay: {get: function() {
      return WalkontableTopOverlay;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___95_base__;
var $__0 = ($___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}),
    addClass = $__0.addClass,
    getScrollbarWidth = $__0.getScrollbarWidth,
    getScrollTop = $__0.getScrollTop,
    getWindowScrollLeft = $__0.getWindowScrollLeft,
    hasClass = $__0.hasClass,
    outerHeight = $__0.outerHeight,
    innerWidth = $__0.innerWidth,
    removeClass = $__0.removeClass,
    setOverlayPosition = $__0.setOverlayPosition,
    resetCssTransform = $__0.resetCssTransform;
var WalkontableOverlay = ($___95_base__ = _dereq_("_base"), $___95_base__ && $___95_base__.__esModule && $___95_base__ || {default: $___95_base__}).WalkontableOverlay;
var WalkontableTopOverlay = function WalkontableTopOverlay(wotInstance) {
  $traceurRuntime.superConstructor($WalkontableTopOverlay).call(this, wotInstance);
  this.clone = this.makeClone(WalkontableOverlay.CLONE_TOP);
};
var $WalkontableTopOverlay = WalkontableTopOverlay;
($traceurRuntime.createClass)(WalkontableTopOverlay, {
  shouldBeRendered: function() {
    return this.wot.getSetting('fixedRowsTop') || this.wot.getSetting('columnHeaders').length ? true : false;
  },
  resetFixedPosition: function() {
    if (!this.needFullRender || !this.wot.wtTable.holder.parentNode) {
      return;
    }
    var overlayRoot = this.clone.wtTable.holder.parentNode;
    var headerPosition = 0;
    var preventOverflow = this.wot.getSetting('preventOverflow');
    if (this.trimmingContainer === window && (!preventOverflow || preventOverflow !== 'vertical')) {
      var box = this.wot.wtTable.hider.getBoundingClientRect();
      var top = Math.ceil(box.top);
      var bottom = Math.ceil(box.bottom);
      var finalLeft;
      var finalTop;
      finalLeft = this.wot.wtTable.hider.style.left;
      finalLeft = finalLeft === '' ? 0 : finalLeft;
      if (top < 0 && (bottom - overlayRoot.offsetHeight) > 0) {
        finalTop = -top;
      } else {
        finalTop = 0;
      }
      headerPosition = finalTop;
      finalTop = finalTop + 'px';
      setOverlayPosition(overlayRoot, finalLeft, finalTop);
    } else {
      headerPosition = this.getScrollPosition();
      resetCssTransform(overlayRoot);
    }
    this.adjustHeaderBordersPosition(headerPosition);
    this.adjustElementsSize();
  },
  setScrollPosition: function(pos) {
    if (this.mainTableScrollableElement === window) {
      window.scrollTo(getWindowScrollLeft(), pos);
    } else {
      this.mainTableScrollableElement.scrollTop = pos;
    }
  },
  onScroll: function() {
    this.wot.getSetting('onScrollHorizontally');
  },
  sumCellSizes: function(from, to) {
    var sum = 0;
    var defaultRowHeight = this.wot.wtSettings.settings.defaultRowHeight;
    while (from < to) {
      var height = this.wot.wtTable.getRowHeight(from);
      sum += height === void 0 ? defaultRowHeight : height;
      from++;
    }
    return sum;
  },
  adjustElementsSize: function() {
    var force = arguments[0] !== (void 0) ? arguments[0] : false;
    this.updateTrimmingContainer();
    if (this.needFullRender || force) {
      this.adjustRootElementSize();
      this.adjustRootChildrenSize();
      if (!force) {
        this.areElementSizesAdjusted = true;
      }
    }
  },
  adjustRootElementSize: function() {
    var masterHolder = this.wot.wtTable.holder;
    var scrollbarWidth = masterHolder.clientWidth === masterHolder.offsetWidth ? 0 : getScrollbarWidth();
    var overlayRoot = this.clone.wtTable.holder.parentNode;
    var overlayRootStyle = overlayRoot.style;
    var preventOverflow = this.wot.getSetting('preventOverflow');
    var tableHeight;
    if (this.trimmingContainer !== window || preventOverflow === 'horizontal') {
      var width = this.wot.wtViewport.getWorkspaceWidth() - scrollbarWidth;
      width = Math.min(width, innerWidth(this.wot.wtTable.wtRootElement));
      overlayRootStyle.width = width + 'px';
    } else {
      overlayRootStyle.width = '';
    }
    this.clone.wtTable.holder.style.width = overlayRootStyle.width;
    tableHeight = outerHeight(this.clone.wtTable.TABLE);
    overlayRootStyle.height = (tableHeight === 0 ? tableHeight : tableHeight + 4) + 'px';
  },
  adjustRootChildrenSize: function() {
    var scrollbarWidth = getScrollbarWidth();
    this.clone.wtTable.hider.style.width = this.hider.style.width;
    this.clone.wtTable.holder.style.width = this.clone.wtTable.holder.parentNode.style.width;
    if (scrollbarWidth === 0) {
      scrollbarWidth = 30;
    }
    this.clone.wtTable.holder.style.height = parseInt(this.clone.wtTable.holder.parentNode.style.height, 10) + scrollbarWidth + 'px';
  },
  applyToDOM: function() {
    var total = this.wot.getSetting('totalRows');
    if (!this.areElementSizesAdjusted) {
      this.adjustElementsSize();
    }
    if (typeof this.wot.wtViewport.rowsRenderCalculator.startPosition === 'number') {
      this.spreader.style.top = this.wot.wtViewport.rowsRenderCalculator.startPosition + 'px';
    } else if (total === 0) {
      this.spreader.style.top = '0';
    } else {
      throw new Error('Incorrect value of the rowsRenderCalculator');
    }
    this.spreader.style.bottom = '';
    if (this.needFullRender) {
      this.syncOverlayOffset();
    }
  },
  syncOverlayOffset: function() {
    if (typeof this.wot.wtViewport.columnsRenderCalculator.startPosition === 'number') {
      this.clone.wtTable.spreader.style.left = this.wot.wtViewport.columnsRenderCalculator.startPosition + 'px';
    } else {
      this.clone.wtTable.spreader.style.left = '';
    }
  },
  scrollTo: function(sourceRow, bottomEdge) {
    var newY = this.getTableParentOffset();
    var sourceInstance = this.wot.cloneSource ? this.wot.cloneSource : this.wot;
    var mainHolder = sourceInstance.wtTable.holder;
    var scrollbarCompensation = 0;
    if (bottomEdge && mainHolder.offsetHeight !== mainHolder.clientHeight) {
      scrollbarCompensation = getScrollbarWidth();
    }
    if (bottomEdge) {
      var fixedRowsBottom = this.wot.getSetting('fixedRowsBottom');
      var fixedRowsTop = this.wot.getSetting('fixedRowsTop');
      var totalRows = this.wot.getSetting('totalRows');
      newY += this.sumCellSizes(0, sourceRow + 1);
      newY -= this.wot.wtViewport.getViewportHeight() - this.sumCellSizes(totalRows - fixedRowsBottom, totalRows);
      newY += 1;
    } else {
      newY += this.sumCellSizes(this.wot.getSetting('fixedRowsTop'), sourceRow);
    }
    newY += scrollbarCompensation;
    this.setScrollPosition(newY);
  },
  getTableParentOffset: function() {
    if (this.mainTableScrollableElement === window) {
      return this.wot.wtTable.holderOffset.top;
    } else {
      return 0;
    }
  },
  getScrollPosition: function() {
    return getScrollTop(this.mainTableScrollableElement);
  },
  redrawSelectionBorders: function(selection) {
    if (selection && selection.cellRange) {
      var border = selection.getBorder(this.wot);
      if (border) {
        var corners = selection.getCorners();
        border.disappear();
        border.appear(corners);
      }
    }
  },
  redrawAllSelectionsBorders: function() {
    var selections = this.wot.selections;
    this.redrawSelectionBorders(selections.current);
    this.redrawSelectionBorders(selections.area);
    this.redrawSelectionBorders(selections.fill);
    this.wot.wtTable.wot.wtOverlays.leftOverlay.refresh();
  },
  adjustHeaderBordersPosition: function(position) {
    var masterParent = this.wot.wtTable.holder.parentNode;
    var totalColumns = this.wot.getSetting('totalColumns');
    if (totalColumns) {
      removeClass(masterParent, 'emptyColumns');
    } else {
      addClass(masterParent, 'emptyColumns');
    }
    if (this.wot.getSetting('fixedRowsTop') === 0 && this.wot.getSetting('columnHeaders').length > 0) {
      var previousState = hasClass(masterParent, 'innerBorderTop');
      if (position || this.wot.getSetting('totalRows') === 0) {
        addClass(masterParent, 'innerBorderTop');
      } else {
        removeClass(masterParent, 'innerBorderTop');
      }
      if (!previousState && position || previousState && !position) {
        this.wot.wtOverlays.adjustElementsSize();
        this.redrawAllSelectionsBorders();
      }
    }
    if (this.wot.getSetting('rowHeaders').length === 0) {
      var secondHeaderCell = this.clone.wtTable.THEAD.querySelectorAll('th:nth-of-type(2)');
      if (secondHeaderCell) {
        for (var i = 0; i < secondHeaderCell.length; i++) {
          secondHeaderCell[i].style['border-left-width'] = 0;
        }
      }
    }
  }
}, {}, WalkontableOverlay);
;
window.WalkontableTopOverlay = WalkontableTopOverlay;
WalkontableOverlay.registerOverlay(WalkontableOverlay.CLONE_TOP, WalkontableTopOverlay);

//# 
},{"_base":12,"helpers/dom/element":47}],16:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableTopLeftCornerOverlay: {get: function() {
      return WalkontableTopLeftCornerOverlay;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___95_base__;
var $__0 = ($___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}),
    outerHeight = $__0.outerHeight,
    outerWidth = $__0.outerWidth,
    setOverlayPosition = $__0.setOverlayPosition,
    resetCssTransform = $__0.resetCssTransform;
var WalkontableOverlay = ($___95_base__ = _dereq_("_base"), $___95_base__ && $___95_base__.__esModule && $___95_base__ || {default: $___95_base__}).WalkontableOverlay;
var WalkontableTopLeftCornerOverlay = function WalkontableTopLeftCornerOverlay(wotInstance) {
  $traceurRuntime.superConstructor($WalkontableTopLeftCornerOverlay).call(this, wotInstance);
  this.clone = this.makeClone(WalkontableOverlay.CLONE_TOP_LEFT_CORNER);
};
var $WalkontableTopLeftCornerOverlay = WalkontableTopLeftCornerOverlay;
($traceurRuntime.createClass)(WalkontableTopLeftCornerOverlay, {
  shouldBeRendered: function() {
    return (this.wot.getSetting('fixedRowsTop') || this.wot.getSetting('columnHeaders').length) && (this.wot.getSetting('fixedColumnsLeft') || this.wot.getSetting('rowHeaders').length) ? true : false;
  },
  resetFixedPosition: function() {
    this.updateTrimmingContainer();
    if (!this.wot.wtTable.holder.parentNode) {
      return;
    }
    var overlayRoot = this.clone.wtTable.holder.parentNode;
    var tableHeight = outerHeight(this.clone.wtTable.TABLE);
    var tableWidth = outerWidth(this.clone.wtTable.TABLE);
    var preventOverflow = this.wot.getSetting('preventOverflow');
    if (this.trimmingContainer === window) {
      var box = this.wot.wtTable.hider.getBoundingClientRect();
      var top = Math.ceil(box.top);
      var left = Math.ceil(box.left);
      var bottom = Math.ceil(box.bottom);
      var right = Math.ceil(box.right);
      var finalLeft = '0';
      var finalTop = '0';
      if (!preventOverflow || preventOverflow === 'vertical') {
        if (left < 0 && (right - overlayRoot.offsetWidth) > 0) {
          finalLeft = -left + 'px';
        }
      }
      if (!preventOverflow || preventOverflow === 'horizontal') {
        if (top < 0 && (bottom - overlayRoot.offsetHeight) > 0) {
          finalTop = -top + 'px';
        }
      }
      setOverlayPosition(overlayRoot, finalLeft, finalTop);
    } else {
      resetCssTransform(overlayRoot);
    }
    overlayRoot.style.height = (tableHeight === 0 ? tableHeight : tableHeight + 4) + 'px';
    overlayRoot.style.width = (tableWidth === 0 ? tableWidth : tableWidth + 4) + 'px';
  }
}, {}, WalkontableOverlay);
;
window.WalkontableTopLeftCornerOverlay = WalkontableTopLeftCornerOverlay;
WalkontableOverlay.registerOverlay(WalkontableOverlay.CLONE_TOP_LEFT_CORNER, WalkontableTopLeftCornerOverlay);

//# 
},{"_base":12,"helpers/dom/element":47}],17:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableOverlays: {get: function() {
      return WalkontableOverlays;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__46__46__47__46__46__47_helpers_47_unicode__,
    $___46__46__47__46__46__47__46__46__47_helpers_47_browser__,
    $___46__46__47__46__46__47__46__46__47_eventManager__;
var $__0 = ($___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}),
    getScrollableElement = $__0.getScrollableElement,
    getScrollbarWidth = $__0.getScrollbarWidth,
    getScrollLeft = $__0.getScrollLeft,
    getScrollTop = $__0.getScrollTop;
var arrayEach = ($___46__46__47__46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_array__}).arrayEach;
var isKey = ($___46__46__47__46__46__47__46__46__47_helpers_47_unicode__ = _dereq_("helpers/unicode"), $___46__46__47__46__46__47__46__46__47_helpers_47_unicode__ && $___46__46__47__46__46__47__46__46__47_helpers_47_unicode__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_unicode__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_unicode__}).isKey;
var isMobileBrowser = ($___46__46__47__46__46__47__46__46__47_helpers_47_browser__ = _dereq_("helpers/browser"), $___46__46__47__46__46__47__46__46__47_helpers_47_browser__ && $___46__46__47__46__46__47__46__46__47_helpers_47_browser__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_browser__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_browser__}).isMobileBrowser;
var EventManager = ($___46__46__47__46__46__47__46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47__46__46__47__46__46__47_eventManager__ && $___46__46__47__46__46__47__46__46__47_eventManager__.__esModule && $___46__46__47__46__46__47__46__46__47_eventManager__ || {default: $___46__46__47__46__46__47__46__46__47_eventManager__}).EventManager;
var WalkontableOverlays = function WalkontableOverlays(wotInstance) {
  this.wot = wotInstance;
  this.instance = this.wot;
  this.eventManager = new EventManager(this.wot);
  this.wot.update('scrollbarWidth', getScrollbarWidth());
  this.wot.update('scrollbarHeight', getScrollbarWidth());
  this.scrollableElement = getScrollableElement(this.wot.wtTable.TABLE);
  this.prepareOverlays();
  this.destroyed = false;
  this.keyPressed = false;
  this.spreaderLastSize = {
    width: null,
    height: null
  };
  this.overlayScrollPositions = {
    master: {
      top: 0,
      left: 0
    },
    top: {
      top: null,
      left: 0
    },
    bottom: {
      top: null,
      left: 0
    },
    left: {
      top: 0,
      left: null
    }
  };
  this.pendingScrollCallbacks = {
    master: {
      top: 0,
      left: 0
    },
    top: {left: 0},
    bottom: {left: 0},
    left: {top: 0}
  };
  this.verticalScrolling = false;
  this.horizontalScrolling = false;
  this.delegatedScrollCallback = false;
  this.registeredListeners = [];
  this.registerListeners();
};
($traceurRuntime.createClass)(WalkontableOverlays, {
  prepareOverlays: function() {
    var syncScroll = false;
    if (this.topOverlay) {
      syncScroll = this.topOverlay.updateStateOfRendering() || syncScroll;
    } else {
      this.topOverlay = WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_TOP, this.wot);
    }
    if (typeof WalkontableBottomOverlay === 'undefined') {
      this.bottomOverlay = {
        needFullRender: false,
        updateStateOfRendering: (function() {
          return false;
        })
      };
    }
    if (typeof WalkontableBottomLeftCornerOverlay === 'undefined') {
      this.bottomLeftCornerOverlay = {
        needFullRender: false,
        updateStateOfRendering: (function() {
          return false;
        })
      };
    }
    if (this.bottomOverlay) {
      syncScroll = this.bottomOverlay.updateStateOfRendering() || syncScroll;
    } else {
      this.bottomOverlay = WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_BOTTOM, this.wot);
    }
    if (this.leftOverlay) {
      syncScroll = this.leftOverlay.updateStateOfRendering() || syncScroll;
    } else {
      this.leftOverlay = WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_LEFT, this.wot);
    }
    if (this.topOverlay.needFullRender && this.leftOverlay.needFullRender) {
      if (this.topLeftCornerOverlay) {
        syncScroll = this.topLeftCornerOverlay.updateStateOfRendering() || syncScroll;
      } else {
        this.topLeftCornerOverlay = WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_TOP_LEFT_CORNER, this.wot);
      }
    }
    if (this.bottomOverlay.needFullRender && this.leftOverlay.needFullRender) {
      if (this.bottomLeftCornerOverlay) {
        syncScroll = this.bottomLeftCornerOverlay.updateStateOfRendering() || syncScroll;
      } else {
        this.bottomLeftCornerOverlay = WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER, this.wot);
      }
    }
    if (this.wot.getSetting('debug') && !this.debug) {
      this.debug = WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_DEBUG, this.wot);
    }
    return syncScroll;
  },
  refreshAll: function() {
    if (!this.wot.drawn) {
      return;
    }
    if (!this.wot.wtTable.holder.parentNode) {
      this.destroy();
      return;
    }
    this.wot.draw(true);
    if (this.verticalScrolling) {
      this.leftOverlay.onScroll();
    }
    if (this.horizontalScrolling) {
      this.topOverlay.onScroll();
    }
    this.verticalScrolling = false;
    this.horizontalScrolling = false;
  },
  registerListeners: function() {
    var $__5 = this;
    var topOverlayScrollable = this.topOverlay.mainTableScrollableElement;
    var leftOverlayScrollable = this.leftOverlay.mainTableScrollableElement;
    var listenersToRegister = [];
    listenersToRegister.push([document.documentElement, 'keydown', (function(event) {
      return $__5.onKeyDown(event);
    })]);
    listenersToRegister.push([document.documentElement, 'keyup', (function() {
      return $__5.onKeyUp();
    })]);
    listenersToRegister.push([document, 'visibilitychange', (function() {
      return $__5.onKeyUp();
    })]);
    listenersToRegister.push([topOverlayScrollable, 'scroll', (function(event) {
      return $__5.onTableScroll(event);
    })]);
    if (topOverlayScrollable !== leftOverlayScrollable) {
      listenersToRegister.push([leftOverlayScrollable, 'scroll', (function(event) {
        return $__5.onTableScroll(event);
      })]);
    }
    if (this.topOverlay.needFullRender) {
      listenersToRegister.push([this.topOverlay.clone.wtTable.holder, 'scroll', (function(event) {
        return $__5.onTableScroll(event);
      })]);
      listenersToRegister.push([this.topOverlay.clone.wtTable.holder, 'wheel', (function(event) {
        return $__5.onTableScroll(event);
      })]);
    }
    if (this.bottomOverlay.needFullRender) {
      listenersToRegister.push([this.bottomOverlay.clone.wtTable.holder, 'scroll', (function(event) {
        return $__5.onTableScroll(event);
      })]);
      listenersToRegister.push([this.bottomOverlay.clone.wtTable.holder, 'wheel', (function(event) {
        return $__5.onTableScroll(event);
      })]);
    }
    if (this.leftOverlay.needFullRender) {
      listenersToRegister.push([this.leftOverlay.clone.wtTable.holder, 'scroll', (function(event) {
        return $__5.onTableScroll(event);
      })]);
      listenersToRegister.push([this.leftOverlay.clone.wtTable.holder, 'wheel', (function(event) {
        return $__5.onTableScroll(event);
      })]);
    }
    if (this.topLeftCornerOverlay && this.topLeftCornerOverlay.needFullRender) {
      listenersToRegister.push([this.topLeftCornerOverlay.clone.wtTable.holder, 'wheel', (function(event) {
        return $__5.onTableScroll(event);
      })]);
    }
    if (this.bottomLeftCornerOverlay && this.bottomLeftCornerOverlay.needFullRender) {
      listenersToRegister.push([this.bottomLeftCornerOverlay.clone.wtTable.holder, 'wheel', (function(event) {
        return $__5.onTableScroll(event);
      })]);
    }
    if (this.topOverlay.trimmingContainer !== window && this.leftOverlay.trimmingContainer !== window) {
      listenersToRegister.push([window, 'wheel', (function(event) {
        var overlay;
        var deltaY = event.wheelDeltaY || event.deltaY;
        var deltaX = event.wheelDeltaX || event.deltaX;
        if ($__5.topOverlay.clone.wtTable.holder.contains(event.realTarget)) {
          overlay = 'top';
        } else if ($__5.bottomOverlay.clone && $__5.bottomOverlay.clone.wtTable.holder.contains(event.realTarget)) {
          overlay = 'bottom';
        } else if ($__5.leftOverlay.clone.wtTable.holder.contains(event.realTarget)) {
          overlay = 'left';
        } else if ($__5.topLeftCornerOverlay && $__5.topLeftCornerOverlay.clone && $__5.topLeftCornerOverlay.clone.wtTable.holder.contains(event.realTarget)) {
          overlay = 'topLeft';
        } else if ($__5.bottomLeftCornerOverlay && $__5.bottomLeftCornerOverlay.clone && $__5.bottomLeftCornerOverlay.clone.wtTable.holder.contains(event.realTarget)) {
          overlay = 'bottomLeft';
        }
        if ((overlay == 'top' && deltaY !== 0) || (overlay == 'left' && deltaX !== 0) || (overlay == 'bottom' && deltaY !== 0) || ((overlay === 'topLeft' || overlay === 'bottomLeft') && (deltaY !== 0 || deltaX !== 0))) {
          event.preventDefault();
        }
      })]);
    }
    while (listenersToRegister.length) {
      var listener = listenersToRegister.pop();
      this.eventManager.addEventListener(listener[0], listener[1], listener[2]);
      this.registeredListeners.push(listener);
    }
  },
  deregisterListeners: function() {
    while (this.registeredListeners.length) {
      var listener = this.registeredListeners.pop();
      this.eventManager.removeEventListener(listener[0], listener[1], listener[2]);
    }
  },
  onTableScroll: function(event) {
    if (isMobileBrowser()) {
      return;
    }
    var masterHorizontal = this.leftOverlay.mainTableScrollableElement;
    var masterVertical = this.topOverlay.mainTableScrollableElement;
    var target = event.target;
    if (this.keyPressed) {
      if ((masterVertical !== window && target !== window && !event.target.contains(masterVertical)) || (masterHorizontal !== window && target !== window && !event.target.contains(masterHorizontal))) {
        return;
      }
    }
    if (event.type === 'scroll') {
      this.syncScrollPositions(event);
    } else {
      this.translateMouseWheelToScroll(event);
    }
  },
  onKeyDown: function(event) {
    this.keyPressed = isKey(event.keyCode, 'ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT');
  },
  onKeyUp: function() {
    this.keyPressed = false;
  },
  translateMouseWheelToScroll: function(event) {
    var topOverlay = this.topOverlay.clone.wtTable.holder;
    var bottomOverlay = this.bottomOverlay.clone ? this.bottomOverlay.clone.wtTable.holder : null;
    var leftOverlay = this.leftOverlay.clone.wtTable.holder;
    var topLeftCornerOverlay = this.topLeftCornerOverlay && this.topLeftCornerOverlay.clone ? this.topLeftCornerOverlay.clone.wtTable.holder : null;
    var bottomLeftCornerOverlay = this.bottomLeftCornerOverlay && this.bottomLeftCornerOverlay.clone ? this.bottomLeftCornerOverlay.clone.wtTable.holder : null;
    var mouseWheelSpeedRatio = -0.2;
    var deltaY = event.wheelDeltaY || (-1) * event.deltaY;
    var deltaX = event.wheelDeltaX || (-1) * event.deltaX;
    var parentHolder = null;
    var eventMockup = {type: 'wheel'};
    var tempElem = event.target;
    var delta = null;
    if (event.deltaMode === 1) {
      deltaY = deltaY * 120;
      deltaX = deltaX * 120;
    }
    while (tempElem != document && tempElem != null) {
      if (tempElem.className.indexOf('wtHolder') > -1) {
        parentHolder = tempElem;
        break;
      }
      tempElem = tempElem.parentNode;
    }
    eventMockup.target = parentHolder;
    if (parentHolder === topLeftCornerOverlay || parentHolder === bottomLeftCornerOverlay) {
      this.syncScrollPositions(eventMockup, mouseWheelSpeedRatio * deltaX, 'x');
      this.syncScrollPositions(eventMockup, mouseWheelSpeedRatio * deltaY, 'y');
    } else {
      if (parentHolder === topOverlay || parentHolder === bottomOverlay) {
        delta = deltaY;
      } else if (parentHolder === leftOverlay) {
        delta = deltaX;
      }
      this.syncScrollPositions(eventMockup, mouseWheelSpeedRatio * delta);
    }
    return false;
  },
  syncScrollPositions: function(event) {
    var fakeScrollValue = arguments[1] !== (void 0) ? arguments[1] : null;
    var fakeScrollDirection = arguments[2] !== (void 0) ? arguments[2] : null;
    if (this.destroyed) {
      return;
    }
    if (arguments.length === 0) {
      this.syncScrollWithMaster();
      return;
    }
    var masterHorizontal = this.leftOverlay.mainTableScrollableElement;
    var masterVertical = this.topOverlay.mainTableScrollableElement;
    var target = event.target;
    var tempScrollValue = 0;
    var scrollValueChanged = false;
    var topOverlay;
    var leftOverlay;
    var topLeftCornerOverlay;
    var bottomLeftCornerOverlay;
    var bottomOverlay;
    var delegatedScroll = false;
    var preventOverflow = this.wot.getSetting('preventOverflow');
    if (this.topOverlay.needFullRender) {
      topOverlay = this.topOverlay.clone.wtTable.holder;
    }
    if (this.bottomOverlay.needFullRender) {
      bottomOverlay = this.bottomOverlay.clone.wtTable.holder;
    }
    if (this.leftOverlay.needFullRender) {
      leftOverlay = this.leftOverlay.clone.wtTable.holder;
    }
    if (this.leftOverlay.needFullRender && this.topOverlay.needFullRender) {
      topLeftCornerOverlay = this.topLeftCornerOverlay.clone.wtTable.holder;
    }
    if (this.leftOverlay.needFullRender && this.bottomOverlay.needFullRender) {
      bottomLeftCornerOverlay = this.bottomLeftCornerOverlay.clone.wtTable.holder;
    }
    if (target === document) {
      target = window;
    }
    if (target === masterHorizontal || target === masterVertical) {
      if (preventOverflow) {
        tempScrollValue = getScrollLeft(this.scrollableElement);
      } else {
        tempScrollValue = getScrollLeft(target);
      }
      this.horizontalScrolling = true;
      this.overlayScrollPositions.master.left = tempScrollValue;
      scrollValueChanged = true;
      if (this.pendingScrollCallbacks.master.left > 0) {
        this.pendingScrollCallbacks.master.left--;
      } else {
        if (topOverlay && topOverlay.scrollLeft !== tempScrollValue) {
          if (fakeScrollValue == null) {
            this.pendingScrollCallbacks.top.left++;
          }
          topOverlay.scrollLeft = tempScrollValue;
          delegatedScroll = (masterHorizontal !== window);
        }
        if (bottomOverlay && bottomOverlay.scrollLeft !== tempScrollValue) {
          if (fakeScrollValue == null) {
            this.pendingScrollCallbacks.bottom.left++;
          }
          bottomOverlay.scrollLeft = tempScrollValue;
          delegatedScroll = (masterHorizontal !== window);
        }
      }
      tempScrollValue = getScrollTop(target);
      this.verticalScrolling = true;
      this.overlayScrollPositions.master.top = tempScrollValue;
      scrollValueChanged = true;
      if (this.pendingScrollCallbacks.master.top > 0) {
        this.pendingScrollCallbacks.master.top--;
      } else {
        if (leftOverlay && leftOverlay.scrollTop !== tempScrollValue) {
          if (fakeScrollValue == null) {
            this.pendingScrollCallbacks.left.top++;
          }
          leftOverlay.scrollTop = tempScrollValue;
          delegatedScroll = (masterVertical !== window);
        }
      }
    } else if (target === bottomOverlay) {
      tempScrollValue = getScrollLeft(target);
      this.horizontalScrolling = true;
      this.overlayScrollPositions.bottom.left = tempScrollValue;
      scrollValueChanged = true;
      if (this.pendingScrollCallbacks.bottom.left > 0) {
        this.pendingScrollCallbacks.bottom.left--;
      } else {
        if (fakeScrollValue == null) {
          this.pendingScrollCallbacks.master.left++;
        }
        masterHorizontal.scrollLeft = tempScrollValue;
        if (topOverlay && topOverlay.scrollLeft !== tempScrollValue) {
          if (fakeScrollValue == null) {
            this.pendingScrollCallbacks.top.left++;
          }
          topOverlay.scrollLeft = tempScrollValue;
          delegatedScroll = (masterVertical !== window);
        }
      }
      if (fakeScrollValue !== null) {
        scrollValueChanged = true;
        masterVertical.scrollTop += fakeScrollValue;
      }
    } else if (target === topOverlay) {
      tempScrollValue = getScrollLeft(target);
      this.horizontalScrolling = true;
      this.overlayScrollPositions.top.left = tempScrollValue;
      scrollValueChanged = true;
      if (this.pendingScrollCallbacks.top.left > 0) {
        this.pendingScrollCallbacks.top.left--;
      } else {
        if (fakeScrollValue == null) {
          this.pendingScrollCallbacks.master.left++;
        }
        masterHorizontal.scrollLeft = tempScrollValue;
      }
      if (fakeScrollValue !== null) {
        scrollValueChanged = true;
        masterVertical.scrollTop += fakeScrollValue;
      }
      if (bottomOverlay && bottomOverlay.scrollLeft !== tempScrollValue) {
        if (fakeScrollValue == null) {
          this.pendingScrollCallbacks.bottom.left++;
        }
        bottomOverlay.scrollLeft = tempScrollValue;
        delegatedScroll = (masterVertical !== window);
      }
    } else if (target === leftOverlay) {
      tempScrollValue = getScrollTop(target);
      if (this.overlayScrollPositions.left.top !== tempScrollValue) {
        this.verticalScrolling = true;
        this.overlayScrollPositions.left.top = tempScrollValue;
        scrollValueChanged = true;
        if (this.pendingScrollCallbacks.left.top > 0) {
          this.pendingScrollCallbacks.left.top--;
        } else {
          if (fakeScrollValue == null) {
            this.pendingScrollCallbacks.master.top++;
          }
          masterVertical.scrollTop = tempScrollValue;
        }
      }
      if (fakeScrollValue !== null) {
        scrollValueChanged = true;
        masterVertical.scrollLeft += fakeScrollValue;
      }
    } else if (target === topLeftCornerOverlay || target === bottomLeftCornerOverlay) {
      if (fakeScrollValue !== null) {
        scrollValueChanged = true;
        if (fakeScrollDirection === 'x') {
          masterVertical.scrollLeft += fakeScrollValue;
        } else if (fakeScrollDirection === 'y') {
          masterVertical.scrollTop += fakeScrollValue;
        }
      }
    }
    if (!this.keyPressed && scrollValueChanged && event.type === 'scroll') {
      if (this.delegatedScrollCallback) {
        this.delegatedScrollCallback = false;
      } else {
        this.refreshAll();
      }
      if (delegatedScroll) {
        this.delegatedScrollCallback = true;
      }
    }
  },
  syncScrollWithMaster: function() {
    var master = this.topOverlay.mainTableScrollableElement;
    var $__7 = master,
        scrollLeft = $__7.scrollLeft,
        scrollTop = $__7.scrollTop;
    if (this.topOverlay.needFullRender) {
      this.topOverlay.clone.wtTable.holder.scrollLeft = scrollLeft;
    }
    if (this.bottomOverlay.needFullRender) {
      this.bottomOverlay.clone.wtTable.holder.scrollLeft = scrollLeft;
    }
    if (this.leftOverlay.needFullRender) {
      this.leftOverlay.clone.wtTable.holder.scrollTop = scrollTop;
    }
  },
  updateMainScrollableElements: function() {
    this.deregisterListeners();
    this.leftOverlay.updateMainScrollableElement();
    this.topOverlay.updateMainScrollableElement();
    if (this.bottomOverlay.needFullRender) {
      this.bottomOverlay.updateMainScrollableElement();
    }
    this.scrollableElement = getScrollableElement(this.wot.wtTable.TABLE);
    this.registerListeners();
  },
  destroy: function() {
    this.eventManager.destroy();
    this.topOverlay.destroy();
    if (this.bottomOverlay.clone) {
      this.bottomOverlay.destroy();
    }
    this.leftOverlay.destroy();
    if (this.topLeftCornerOverlay) {
      this.topLeftCornerOverlay.destroy();
    }
    if (this.bottomLeftCornerOverlay && this.bottomLeftCornerOverlay.clone) {
      this.bottomLeftCornerOverlay.destroy();
    }
    if (this.debug) {
      this.debug.destroy();
    }
    this.destroyed = true;
  },
  refresh: function() {
    var fastDraw = arguments[0] !== (void 0) ? arguments[0] : false;
    if (this.topOverlay.areElementSizesAdjusted && this.leftOverlay.areElementSizesAdjusted) {
      var container = this.wot.wtTable.wtRootElement.parentNode || this.wot.wtTable.wtRootElement;
      var width = container.clientWidth;
      var height = container.clientHeight;
      if (width !== this.spreaderLastSize.width || height !== this.spreaderLastSize.height) {
        this.spreaderLastSize.width = width;
        this.spreaderLastSize.height = height;
        this.adjustElementsSize();
      }
    }
    if (this.bottomOverlay.clone) {
      this.bottomOverlay.refresh(fastDraw);
    }
    this.leftOverlay.refresh(fastDraw);
    this.topOverlay.refresh(fastDraw);
    if (this.topLeftCornerOverlay) {
      this.topLeftCornerOverlay.refresh(fastDraw);
    }
    if (this.bottomLeftCornerOverlay && this.bottomLeftCornerOverlay.clone) {
      this.bottomLeftCornerOverlay.refresh(fastDraw);
    }
    if (this.debug) {
      this.debug.refresh(fastDraw);
    }
  },
  adjustElementsSize: function() {
    var force = arguments[0] !== (void 0) ? arguments[0] : false;
    var totalColumns = this.wot.getSetting('totalColumns');
    var totalRows = this.wot.getSetting('totalRows');
    var headerRowSize = this.wot.wtViewport.getRowHeaderWidth();
    var headerColumnSize = this.wot.wtViewport.getColumnHeaderHeight();
    var hiderStyle = this.wot.wtTable.hider.style;
    hiderStyle.width = (headerRowSize + this.leftOverlay.sumCellSizes(0, totalColumns)) + 'px';
    hiderStyle.height = (headerColumnSize + this.topOverlay.sumCellSizes(0, totalRows) + 1) + 'px';
    this.topOverlay.adjustElementsSize(force);
    this.leftOverlay.adjustElementsSize(force);
    if (this.bottomOverlay.clone) {
      this.bottomOverlay.adjustElementsSize(force);
    }
  },
  applyToDOM: function() {
    if (!this.topOverlay.areElementSizesAdjusted || !this.leftOverlay.areElementSizesAdjusted) {
      this.adjustElementsSize();
    }
    this.topOverlay.applyToDOM();
    if (this.bottomOverlay.clone) {
      this.bottomOverlay.applyToDOM();
    }
    this.leftOverlay.applyToDOM();
  },
  getParentOverlay: function(element) {
    if (!element) {
      return null;
    }
    var overlays = [this.topOverlay, this.leftOverlay, this.bottomOverlay, this.topLeftCornerOverlay, this.bottomLeftCornerOverlay];
    var result = null;
    arrayEach(overlays, (function(elem, i) {
      if (!elem) {
        return;
      }
      if (elem.clone && elem.clone.wtTable.TABLE.contains(element)) {
        result = elem.clone;
      }
    }));
    return result;
  }
}, {});
;
window.WalkontableOverlays = WalkontableOverlays;

//# 
},{"eventManager":42,"helpers/array":43,"helpers/browser":44,"helpers/dom/element":47,"helpers/unicode":56}],18:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableScroll: {get: function() {
      return WalkontableScroll;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47__46__46__47_helpers_47_number__;
var $__0 = ($___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}),
    innerHeight = $__0.innerHeight,
    innerWidth = $__0.innerWidth,
    getScrollLeft = $__0.getScrollLeft,
    getScrollTop = $__0.getScrollTop,
    offset = $__0.offset;
var $__1 = ($___46__46__47__46__46__47__46__46__47_helpers_47_number__ = _dereq_("helpers/number"), $___46__46__47__46__46__47__46__46__47_helpers_47_number__ && $___46__46__47__46__46__47__46__46__47_helpers_47_number__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_number__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_number__}),
    rangeEach = $__1.rangeEach,
    rangeEachReverse = $__1.rangeEachReverse;
var WalkontableScroll = function WalkontableScroll(wotInstance) {
  this.wot = wotInstance;
  this.instance = wotInstance;
};
($traceurRuntime.createClass)(WalkontableScroll, {
  scrollViewport: function(coords) {
    if (!this.wot.drawn) {
      return;
    }
    var $__3 = this._getVariables(),
        topOverlay = $__3.topOverlay,
        leftOverlay = $__3.leftOverlay,
        totalRows = $__3.totalRows,
        totalColumns = $__3.totalColumns,
        fixedRowsTop = $__3.fixedRowsTop,
        fixedRowsBottom = $__3.fixedRowsBottom,
        fixedColumnsLeft = $__3.fixedColumnsLeft;
    if (coords.row < 0 || coords.row > Math.max(totalRows - 1, 0)) {
      throw new Error(("row " + coords.row + " does not exist"));
    }
    if (coords.col < 0 || coords.col > Math.max(totalColumns - 1, 0)) {
      throw new Error(("column " + coords.col + " does not exist"));
    }
    if (coords.row >= fixedRowsTop && coords.row < this.getFirstVisibleRow()) {
      topOverlay.scrollTo(coords.row);
    } else if (coords.row > this.getLastVisibleRow() && coords.row < totalRows - fixedRowsBottom) {
      topOverlay.scrollTo(coords.row, true);
    }
    if (coords.col >= fixedColumnsLeft && coords.col < this.getFirstVisibleColumn()) {
      leftOverlay.scrollTo(coords.col);
    } else if (coords.col > this.getLastVisibleColumn()) {
      leftOverlay.scrollTo(coords.col, true);
    }
  },
  getFirstVisibleRow: function() {
    var $__3 = this._getVariables(),
        topOverlay = $__3.topOverlay,
        wtTable = $__3.wtTable,
        wtViewport = $__3.wtViewport,
        totalRows = $__3.totalRows,
        fixedRowsTop = $__3.fixedRowsTop;
    var firstVisibleRow = wtTable.getFirstVisibleRow();
    if (topOverlay.mainTableScrollableElement === window) {
      var rootElementOffset = offset(wtTable.wtRootElement);
      var totalTableHeight = innerHeight(wtTable.hider);
      var windowHeight = innerHeight(window);
      var windowScrollTop = getScrollTop(window);
      if (rootElementOffset.top + totalTableHeight - windowHeight <= windowScrollTop) {
        var rowsHeight = wtViewport.getColumnHeaderHeight();
        rowsHeight += topOverlay.sumCellSizes(0, fixedRowsTop);
        rangeEachReverse(totalRows, 1, (function(row) {
          rowsHeight += topOverlay.sumCellSizes(row - 1, row);
          if (rootElementOffset.top + totalTableHeight - rowsHeight <= windowScrollTop) {
            firstVisibleRow = row;
            return false;
          }
        }));
      }
    }
    return firstVisibleRow;
  },
  getLastVisibleRow: function() {
    var $__3 = this._getVariables(),
        topOverlay = $__3.topOverlay,
        wtTable = $__3.wtTable,
        wtViewport = $__3.wtViewport,
        totalRows = $__3.totalRows;
    var lastVisibleRow = wtTable.getLastVisibleRow();
    if (topOverlay.mainTableScrollableElement === window) {
      var rootElementOffset = offset(wtTable.wtRootElement);
      var windowHeight = innerHeight(window);
      var windowScrollTop = getScrollTop(window);
      if (rootElementOffset.top > windowScrollTop) {
        var rowsHeight = wtViewport.getColumnHeaderHeight();
        rangeEach(1, totalRows, (function(row) {
          rowsHeight += topOverlay.sumCellSizes(row - 1, row);
          if (rootElementOffset.top + rowsHeight - windowScrollTop >= windowHeight) {
            lastVisibleRow = row - 2;
            return false;
          }
        }));
      }
    }
    return lastVisibleRow;
  },
  getFirstVisibleColumn: function() {
    var $__3 = this._getVariables(),
        leftOverlay = $__3.leftOverlay,
        wtTable = $__3.wtTable,
        wtViewport = $__3.wtViewport,
        totalColumns = $__3.totalColumns,
        fixedColumnsLeft = $__3.fixedColumnsLeft;
    var firstVisibleColumn = wtTable.getFirstVisibleColumn();
    if (leftOverlay.mainTableScrollableElement === window) {
      var rootElementOffset = offset(wtTable.wtRootElement);
      var totalTableWidth = innerWidth(wtTable.hider);
      var windowWidth = innerWidth(window);
      var windowScrollLeft = getScrollLeft(window);
      if (rootElementOffset.left + totalTableWidth - windowWidth <= windowScrollLeft) {
        var columnsWidth = wtViewport.getRowHeaderWidth();
        rangeEachReverse(totalColumns, 1, (function(column) {
          columnsWidth += leftOverlay.sumCellSizes(column - 1, column);
          if (rootElementOffset.left + totalTableWidth - columnsWidth <= windowScrollLeft) {
            firstVisibleColumn = column;
            return false;
          }
        }));
      }
    }
    return firstVisibleColumn;
  },
  getLastVisibleColumn: function() {
    var $__3 = this._getVariables(),
        leftOverlay = $__3.leftOverlay,
        wtTable = $__3.wtTable,
        wtViewport = $__3.wtViewport,
        totalColumns = $__3.totalColumns;
    var lastVisibleColumn = wtTable.getLastVisibleColumn();
    if (leftOverlay.mainTableScrollableElement === window) {
      var rootElementOffset = offset(wtTable.wtRootElement);
      var windowWidth = innerWidth(window);
      var windowScrollLeft = getScrollLeft(window);
      if (rootElementOffset.left > windowScrollLeft) {
        var columnsWidth = wtViewport.getRowHeaderWidth();
        rangeEach(1, totalColumns, (function(column) {
          columnsWidth += leftOverlay.sumCellSizes(column - 1, column);
          if (rootElementOffset.left + columnsWidth - windowScrollLeft >= windowWidth) {
            lastVisibleColumn = column - 2;
            return false;
          }
        }));
      }
    }
    return lastVisibleColumn;
  },
  _getVariables: function() {
    var wot = this.wot;
    var topOverlay = wot.wtOverlays.topOverlay;
    var leftOverlay = wot.wtOverlays.leftOverlay;
    var wtTable = wot.wtTable;
    var wtViewport = wot.wtViewport;
    var totalRows = wot.getSetting('totalRows');
    var totalColumns = wot.getSetting('totalColumns');
    var fixedRowsTop = wot.getSetting('fixedRowsTop');
    var fixedRowsBottom = wot.getSetting('fixedRowsBottom');
    var fixedColumnsLeft = wot.getSetting('fixedColumnsLeft');
    return {
      topOverlay: topOverlay,
      leftOverlay: leftOverlay,
      wtTable: wtTable,
      wtViewport: wtViewport,
      totalRows: totalRows,
      totalColumns: totalColumns,
      fixedRowsTop: fixedRowsTop,
      fixedRowsBottom: fixedRowsBottom,
      fixedColumnsLeft: fixedColumnsLeft
    };
  }
}, {});
;
window.WalkontableScroll = WalkontableScroll;

//# 
},{"helpers/dom/element":47,"helpers/number":52}],19:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableSelection: {get: function() {
      return WalkontableSelection;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__,
    $__border__,
    $__cell_47_coords__,
    $__cell_47_range__;
var addClass = ($___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}).addClass;
var WalkontableBorder = ($__border__ = _dereq_("border"), $__border__ && $__border__.__esModule && $__border__ || {default: $__border__}).WalkontableBorder;
var WalkontableCellCoords = ($__cell_47_coords__ = _dereq_("cell/coords"), $__cell_47_coords__ && $__cell_47_coords__.__esModule && $__cell_47_coords__ || {default: $__cell_47_coords__}).WalkontableCellCoords;
var WalkontableCellRange = ($__cell_47_range__ = _dereq_("cell/range"), $__cell_47_range__ && $__cell_47_range__.__esModule && $__cell_47_range__ || {default: $__cell_47_range__}).WalkontableCellRange;
var WalkontableSelection = function WalkontableSelection(settings, cellRange) {
  this.settings = settings;
  this.cellRange = cellRange || null;
  this.instanceBorders = {};
};
($traceurRuntime.createClass)(WalkontableSelection, {
  getBorder: function(wotInstance) {
    if (this.instanceBorders[wotInstance.guid]) {
      return this.instanceBorders[wotInstance.guid];
    }
    this.instanceBorders[wotInstance.guid] = new WalkontableBorder(wotInstance, this.settings);
  },
  isEmpty: function() {
    return this.cellRange === null;
  },
  add: function(coords) {
    if (this.isEmpty()) {
      this.cellRange = new WalkontableCellRange(coords, coords, coords);
    } else {
      this.cellRange.expand(coords);
    }
  },
  replace: function(oldCoords, newCoords) {
    if (!this.isEmpty()) {
      if (this.cellRange.from.isEqual(oldCoords)) {
        this.cellRange.from = newCoords;
        return true;
      }
      if (this.cellRange.to.isEqual(oldCoords)) {
        this.cellRange.to = newCoords;
        return true;
      }
    }
    return false;
  },
  clear: function() {
    this.cellRange = null;
  },
  getCorners: function() {
    var topLeft = this.cellRange.getTopLeftCorner();
    var bottomRight = this.cellRange.getBottomRightCorner();
    return [topLeft.row, topLeft.col, bottomRight.row, bottomRight.col];
  },
  addClassAtCoords: function(wotInstance, sourceRow, sourceColumn, className) {
    var TD = wotInstance.wtTable.getCell(new WalkontableCellCoords(sourceRow, sourceColumn));
    if (typeof TD === 'object') {
      addClass(TD, className);
    }
  },
  draw: function(wotInstance) {
    if (this.isEmpty()) {
      if (this.settings.border) {
        var border = this.getBorder(wotInstance);
        if (border) {
          border.disappear();
        }
      }
      return;
    }
    var renderedRows = wotInstance.wtTable.getRenderedRowsCount();
    var renderedColumns = wotInstance.wtTable.getRenderedColumnsCount();
    var corners = this.getCorners();
    var sourceRow,
        sourceCol,
        TH;
    for (var column = 0; column < renderedColumns; column++) {
      sourceCol = wotInstance.wtTable.columnFilter.renderedToSource(column);
      if (sourceCol >= corners[1] && sourceCol <= corners[3]) {
        TH = wotInstance.wtTable.getColumnHeader(sourceCol);
        if (TH) {
          var newClasses = [];
          if (this.settings.highlightHeaderClassName) {
            newClasses.push(this.settings.highlightHeaderClassName);
          }
          if (this.settings.highlightColumnClassName) {
            newClasses.push(this.settings.highlightColumnClassName);
          }
          addClass(TH, newClasses);
        }
      }
    }
    for (var row = 0; row < renderedRows; row++) {
      sourceRow = wotInstance.wtTable.rowFilter.renderedToSource(row);
      if (sourceRow >= corners[0] && sourceRow <= corners[2]) {
        TH = wotInstance.wtTable.getRowHeader(sourceRow);
        if (TH) {
          var newClasses$__5 = [];
          if (this.settings.highlightHeaderClassName) {
            newClasses$__5.push(this.settings.highlightHeaderClassName);
          }
          if (this.settings.highlightRowClassName) {
            newClasses$__5.push(this.settings.highlightRowClassName);
          }
          addClass(TH, newClasses$__5);
        }
      }
      for (var column$__6 = 0; column$__6 < renderedColumns; column$__6++) {
        sourceCol = wotInstance.wtTable.columnFilter.renderedToSource(column$__6);
        if (sourceRow >= corners[0] && sourceRow <= corners[2] && sourceCol >= corners[1] && sourceCol <= corners[3]) {
          if (this.settings.className) {
            this.addClassAtCoords(wotInstance, sourceRow, sourceCol, this.settings.className);
          }
        } else if (sourceRow >= corners[0] && sourceRow <= corners[2]) {
          if (this.settings.highlightRowClassName) {
            this.addClassAtCoords(wotInstance, sourceRow, sourceCol, this.settings.highlightRowClassName);
          }
        } else if (sourceCol >= corners[1] && sourceCol <= corners[3]) {
          if (this.settings.highlightColumnClassName) {
            this.addClassAtCoords(wotInstance, sourceRow, sourceCol, this.settings.highlightColumnClassName);
          }
        }
      }
    }
    wotInstance.getSetting('onBeforeDrawBorders', corners, this.settings.className);
    if (this.settings.border) {
      var border$__7 = this.getBorder(wotInstance);
      if (border$__7) {
        border$__7.appear(corners);
      }
    }
  }
}, {});
;
window.WalkontableSelection = WalkontableSelection;

//# 
},{"border":3,"cell/coords":6,"cell/range":7,"helpers/dom/element":47}],20:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableSettings: {get: function() {
      return WalkontableSettings;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__;
var fastInnerText = ($___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}).fastInnerText;
var WalkontableSettings = function WalkontableSettings(wotInstance, settings) {
  var $__1 = this;
  this.wot = wotInstance;
  this.instance = wotInstance;
  this.defaults = {
    table: void 0,
    debug: false,
    externalRowCalculator: false,
    stretchH: 'none',
    currentRowClassName: null,
    currentColumnClassName: null,
    preventOverflow: function() {
      return false;
    },
    data: void 0,
    fixedColumnsLeft: 0,
    fixedRowsTop: 0,
    fixedRowsBottom: 0,
    minSpareRows: 0,
    rowHeaders: function() {
      return [];
    },
    columnHeaders: function() {
      return [];
    },
    totalRows: void 0,
    totalColumns: void 0,
    cellRenderer: (function(row, column, TD) {
      var cellData = $__1.getSetting('data', row, column);
      fastInnerText(TD, cellData === void 0 || cellData === null ? '' : cellData);
    }),
    columnWidth: function(col) {
      return;
    },
    rowHeight: function(row) {
      return;
    },
    defaultRowHeight: 23,
    defaultColumnWidth: 50,
    selections: null,
    hideBorderOnMouseDownOver: false,
    viewportRowCalculatorOverride: null,
    viewportColumnCalculatorOverride: null,
    onCellMouseDown: null,
    onCellMouseOver: null,
    onCellMouseOut: null,
    onCellMouseUp: null,
    onCellDblClick: null,
    onCellCornerMouseDown: null,
    onCellCornerDblClick: null,
    beforeDraw: null,
    onDraw: null,
    onBeforeDrawBorders: null,
    onScrollVertically: null,
    onScrollHorizontally: null,
    onBeforeTouchScroll: null,
    onAfterMomentumScroll: null,
    onBeforeStretchingColumnWidth: (function(width) {
      return width;
    }),
    onModifyRowHeaderWidth: null,
    scrollbarWidth: 10,
    scrollbarHeight: 10,
    renderAllRows: false,
    groups: false,
    rowHeaderWidth: null,
    columnHeaderHeight: null,
    headerClassName: null
  };
  this.settings = {};
  for (var i in this.defaults) {
    if (this.defaults.hasOwnProperty(i)) {
      if (settings[i] !== void 0) {
        this.settings[i] = settings[i];
      } else if (this.defaults[i] === void 0) {
        throw new Error('A required setting "' + i + '" was not provided');
      } else {
        this.settings[i] = this.defaults[i];
      }
    }
  }
};
($traceurRuntime.createClass)(WalkontableSettings, {
  update: function(settings, value) {
    if (value === void 0) {
      for (var i in settings) {
        if (settings.hasOwnProperty(i)) {
          this.settings[i] = settings[i];
        }
      }
    } else {
      this.settings[settings] = value;
    }
    return this.wot;
  },
  getSetting: function(key, param1, param2, param3, param4) {
    if (typeof this.settings[key] === 'function') {
      return this.settings[key](param1, param2, param3, param4);
    } else if (param1 !== void 0 && Array.isArray(this.settings[key])) {
      return this.settings[key][param1];
    } else {
      return this.settings[key];
    }
  },
  has: function(key) {
    return !!this.settings[key];
  }
}, {});
;
window.WalkontableSettings = WalkontableSettings;

//# 
},{"helpers/dom/element":47}],21:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableTable: {get: function() {
      return WalkontableTable;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47__46__46__47_helpers_47_function__,
    $__cell_47_coords__,
    $__cell_47_range__,
    $__filter_47_column__,
    $__filter_47_row__,
    $__tableRenderer__;
var $__0 = ($___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}),
    getStyle = $__0.getStyle,
    getTrimmingContainer = $__0.getTrimmingContainer,
    hasClass = $__0.hasClass,
    index = $__0.index,
    offset = $__0.offset,
    removeClass = $__0.removeClass,
    removeTextNodes = $__0.removeTextNodes,
    overlayContainsElement = $__0.overlayContainsElement,
    closest = $__0.closest;
var isFunction = ($___46__46__47__46__46__47__46__46__47_helpers_47_function__ = _dereq_("helpers/function"), $___46__46__47__46__46__47__46__46__47_helpers_47_function__ && $___46__46__47__46__46__47__46__46__47_helpers_47_function__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_function__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_function__}).isFunction;
var WalkontableCellCoords = ($__cell_47_coords__ = _dereq_("cell/coords"), $__cell_47_coords__ && $__cell_47_coords__.__esModule && $__cell_47_coords__ || {default: $__cell_47_coords__}).WalkontableCellCoords;
var WalkontableCellRange = ($__cell_47_range__ = _dereq_("cell/range"), $__cell_47_range__ && $__cell_47_range__.__esModule && $__cell_47_range__ || {default: $__cell_47_range__}).WalkontableCellRange;
var WalkontableColumnFilter = ($__filter_47_column__ = _dereq_("filter/column"), $__filter_47_column__ && $__filter_47_column__.__esModule && $__filter_47_column__ || {default: $__filter_47_column__}).WalkontableColumnFilter;
var WalkontableRowFilter = ($__filter_47_row__ = _dereq_("filter/row"), $__filter_47_row__ && $__filter_47_row__.__esModule && $__filter_47_row__ || {default: $__filter_47_row__}).WalkontableRowFilter;
var WalkontableTableRenderer = ($__tableRenderer__ = _dereq_("tableRenderer"), $__tableRenderer__ && $__tableRenderer__.__esModule && $__tableRenderer__ || {default: $__tableRenderer__}).WalkontableTableRenderer;
var WalkontableTable = function WalkontableTable(wotInstance, table) {
  var $__7 = this;
  this.wot = wotInstance;
  this.instance = this.wot;
  this.TABLE = table;
  this.TBODY = null;
  this.THEAD = null;
  this.COLGROUP = null;
  this.tableOffset = 0;
  this.holderOffset = 0;
  removeTextNodes(this.TABLE);
  this.spreader = this.createSpreader(this.TABLE);
  this.hider = this.createHider(this.spreader);
  this.holder = this.createHolder(this.hider);
  this.wtRootElement = this.holder.parentNode;
  this.alignOverlaysWithTrimmingContainer();
  this.fixTableDomTree();
  this.colgroupChildrenLength = this.COLGROUP.childNodes.length;
  this.theadChildrenLength = this.THEAD.firstChild ? this.THEAD.firstChild.childNodes.length : 0;
  this.tbodyChildrenLength = this.TBODY.childNodes.length;
  this.rowFilter = null;
  this.columnFilter = null;
  this.correctHeaderWidth = false;
  var origRowHeaderWidth = this.wot.wtSettings.settings.rowHeaderWidth;
  this.wot.wtSettings.settings.rowHeaderWidth = (function() {
    return $__7._modifyRowHeaderWidth(origRowHeaderWidth);
  });
};
($traceurRuntime.createClass)(WalkontableTable, {
  fixTableDomTree: function() {
    this.TBODY = this.TABLE.querySelector('tbody');
    if (!this.TBODY) {
      this.TBODY = document.createElement('tbody');
      this.TABLE.appendChild(this.TBODY);
    }
    this.THEAD = this.TABLE.querySelector('thead');
    if (!this.THEAD) {
      this.THEAD = document.createElement('thead');
      this.TABLE.insertBefore(this.THEAD, this.TBODY);
    }
    this.COLGROUP = this.TABLE.querySelector('colgroup');
    if (!this.COLGROUP) {
      this.COLGROUP = document.createElement('colgroup');
      this.TABLE.insertBefore(this.COLGROUP, this.THEAD);
    }
    if (this.wot.getSetting('columnHeaders').length && !this.THEAD.childNodes.length) {
      this.THEAD.appendChild(document.createElement('TR'));
    }
  },
  createSpreader: function(table) {
    var parent = table.parentNode;
    var spreader;
    if (!parent || parent.nodeType !== 1 || !hasClass(parent, 'wtHolder')) {
      spreader = document.createElement('div');
      spreader.className = 'wtSpreader';
      if (parent) {
        parent.insertBefore(spreader, table);
      }
      spreader.appendChild(table);
    }
    spreader.style.position = 'relative';
    return spreader;
  },
  createHider: function(spreader) {
    var parent = spreader.parentNode;
    var hider;
    if (!parent || parent.nodeType !== 1 || !hasClass(parent, 'wtHolder')) {
      hider = document.createElement('div');
      hider.className = 'wtHider';
      if (parent) {
        parent.insertBefore(hider, spreader);
      }
      hider.appendChild(spreader);
    }
    return hider;
  },
  createHolder: function(hider) {
    var parent = hider.parentNode;
    var holder;
    if (!parent || parent.nodeType !== 1 || !hasClass(parent, 'wtHolder')) {
      holder = document.createElement('div');
      holder.style.position = 'relative';
      holder.className = 'wtHolder';
      if (parent) {
        parent.insertBefore(holder, hider);
      }
      if (!this.isWorkingOnClone()) {
        holder.parentNode.className += 'ht_master handsontable';
      }
      holder.appendChild(hider);
    }
    return holder;
  },
  alignOverlaysWithTrimmingContainer: function() {
    var trimmingElement = getTrimmingContainer(this.wtRootElement);
    if (!this.isWorkingOnClone()) {
      this.holder.parentNode.style.position = 'relative';
      if (trimmingElement === window) {
        var preventOverflow = this.wot.getSetting('preventOverflow');
        if (!preventOverflow) {
          this.holder.style.overflow = 'visible';
          this.wtRootElement.style.overflow = 'visible';
        }
      } else {
        this.holder.style.width = getStyle(trimmingElement, 'width');
        this.holder.style.height = getStyle(trimmingElement, 'height');
        this.holder.style.overflow = '';
      }
    }
  },
  isWorkingOnClone: function() {
    return !!this.wot.cloneSource;
  },
  draw: function(fastDraw) {
    var $__9 = this.wot,
        wtOverlays = $__9.wtOverlays,
        wtViewport = $__9.wtViewport;
    var totalRows = this.instance.getSetting('totalRows');
    var rowHeaders = this.wot.getSetting('rowHeaders').length;
    var columnHeaders = this.wot.getSetting('columnHeaders').length;
    var syncScroll = false;
    if (!this.isWorkingOnClone()) {
      this.holderOffset = offset(this.holder);
      fastDraw = wtViewport.createRenderCalculators(fastDraw);
      if (rowHeaders && !this.wot.getSetting('fixedColumnsLeft')) {
        var leftScrollPos = wtOverlays.leftOverlay.getScrollPosition();
        var previousState = this.correctHeaderWidth;
        this.correctHeaderWidth = leftScrollPos > 0;
        if (previousState !== this.correctHeaderWidth) {
          fastDraw = false;
        }
      }
    }
    if (!this.isWorkingOnClone()) {
      syncScroll = wtOverlays.prepareOverlays();
    }
    if (fastDraw) {
      if (!this.isWorkingOnClone()) {
        wtViewport.createVisibleCalculators();
      }
      if (wtOverlays) {
        wtOverlays.refresh(true);
      }
    } else {
      if (this.isWorkingOnClone()) {
        this.tableOffset = this.wot.cloneSource.wtTable.tableOffset;
      } else {
        this.tableOffset = offset(this.TABLE);
      }
      var startRow;
      if (WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay, WalkontableOverlay.CLONE_DEBUG) || WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay, WalkontableOverlay.CLONE_TOP) || WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay, WalkontableOverlay.CLONE_TOP_LEFT_CORNER)) {
        startRow = 0;
      } else if (WalkontableOverlay.isOverlayTypeOf(this.instance.cloneOverlay, WalkontableOverlay.CLONE_BOTTOM) || WalkontableOverlay.isOverlayTypeOf(this.instance.cloneOverlay, WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)) {
        startRow = Math.max(totalRows - this.wot.getSetting('fixedRowsBottom'), 0);
      } else {
        startRow = wtViewport.rowsRenderCalculator.startRow;
      }
      var startColumn;
      if (WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay, WalkontableOverlay.CLONE_DEBUG) || WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay, WalkontableOverlay.CLONE_LEFT) || WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay, WalkontableOverlay.CLONE_TOP_LEFT_CORNER) || WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay, WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)) {
        startColumn = 0;
      } else {
        startColumn = wtViewport.columnsRenderCalculator.startColumn;
      }
      this.rowFilter = new WalkontableRowFilter(startRow, totalRows, columnHeaders);
      this.columnFilter = new WalkontableColumnFilter(startColumn, this.wot.getSetting('totalColumns'), rowHeaders);
      this.alignOverlaysWithTrimmingContainer();
      this._doDraw();
    }
    this.refreshSelections(fastDraw);
    if (!this.isWorkingOnClone()) {
      wtOverlays.topOverlay.resetFixedPosition();
      if (wtOverlays.bottomOverlay.clone) {
        wtOverlays.bottomOverlay.resetFixedPosition();
      }
      wtOverlays.leftOverlay.resetFixedPosition();
      if (wtOverlays.topLeftCornerOverlay) {
        wtOverlays.topLeftCornerOverlay.resetFixedPosition();
      }
      if (wtOverlays.bottomLeftCornerOverlay && wtOverlays.bottomLeftCornerOverlay.clone) {
        wtOverlays.bottomLeftCornerOverlay.resetFixedPosition();
      }
    }
    if (syncScroll) {
      wtOverlays.syncScrollWithMaster();
    }
    this.wot.drawn = true;
    return this;
  },
  _doDraw: function() {
    var wtRenderer = new WalkontableTableRenderer(this);
    wtRenderer.render();
  },
  removeClassFromCells: function(className) {
    var nodes = this.TABLE.querySelectorAll('.' + className);
    for (var i = 0,
        len = nodes.length; i < len; i++) {
      removeClass(nodes[i], className);
    }
  },
  refreshSelections: function(fastDraw) {
    if (!this.wot.selections) {
      return;
    }
    var len = this.wot.selections.length;
    if (fastDraw) {
      for (var i = 0; i < len; i++) {
        if (this.wot.selections[i].settings.className) {
          this.removeClassFromCells(this.wot.selections[i].settings.className);
        }
        if (this.wot.selections[i].settings.highlightHeaderClassName) {
          this.removeClassFromCells(this.wot.selections[i].settings.highlightHeaderClassName);
        }
        if (this.wot.selections[i].settings.highlightRowClassName) {
          this.removeClassFromCells(this.wot.selections[i].settings.highlightRowClassName);
        }
        if (this.wot.selections[i].settings.highlightColumnClassName) {
          this.removeClassFromCells(this.wot.selections[i].settings.highlightColumnClassName);
        }
      }
    }
    for (var i$__10 = 0; i$__10 < len; i$__10++) {
      this.wot.selections[i$__10].draw(this.wot, fastDraw);
    }
  },
  getCell: function(coords) {
    if (this.isRowBeforeRenderedRows(coords.row)) {
      return -1;
    } else if (this.isRowAfterRenderedRows(coords.row)) {
      return -2;
    }
    var TR = this.TBODY.childNodes[this.rowFilter.sourceToRendered(coords.row)];
    if (TR) {
      return TR.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(coords.col)];
    }
  },
  getColumnHeader: function(col) {
    var level = arguments[1] !== (void 0) ? arguments[1] : 0;
    var TR = this.THEAD.childNodes[level];
    if (TR) {
      return TR.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(col)];
    }
  },
  getRowHeader: function(row) {
    if (this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0) === 0) {
      return null;
    }
    var TR = this.TBODY.childNodes[this.rowFilter.sourceToRendered(row)];
    if (TR) {
      return TR.childNodes[0];
    }
  },
  getCoords: function(TD) {
    if (TD.nodeName !== 'TD' && TD.nodeName !== 'TH') {
      TD = closest(TD, ['TD', 'TH']);
    }
    var TR = TD.parentNode;
    var CONTAINER = TR.parentNode;
    var row = index(TR);
    var col = TD.cellIndex;
    if (overlayContainsElement(WalkontableOverlay.CLONE_TOP_LEFT_CORNER, TD) || overlayContainsElement(WalkontableOverlay.CLONE_TOP, TD)) {
      if (CONTAINER.nodeName === 'THEAD') {
        row -= CONTAINER.childNodes.length;
      }
    } else {
      if (CONTAINER === this.THEAD) {
        row = this.rowFilter.visibleColHeadedRowToSourceRow(row);
      } else {
        row = this.rowFilter.renderedToSource(row);
      }
    }
    if (overlayContainsElement(WalkontableOverlay.CLONE_TOP_LEFT_CORNER, TD) || overlayContainsElement(WalkontableOverlay.CLONE_LEFT, TD)) {
      col = this.columnFilter.offsettedTH(col);
    } else {
      col = this.columnFilter.visibleRowHeadedColumnToSourceColumn(col);
    }
    return new WalkontableCellCoords(row, col);
  },
  getTrForRow: function(row) {
    return this.TBODY.childNodes[this.rowFilter.sourceToRendered(row)];
  },
  getFirstRenderedRow: function() {
    return this.wot.wtViewport.rowsRenderCalculator.startRow;
  },
  getFirstVisibleRow: function() {
    return this.wot.wtViewport.rowsVisibleCalculator.startRow;
  },
  getFirstRenderedColumn: function() {
    return this.wot.wtViewport.columnsRenderCalculator.startColumn;
  },
  getFirstVisibleColumn: function() {
    return this.wot.wtViewport.columnsVisibleCalculator.startColumn;
  },
  getLastRenderedRow: function() {
    return this.wot.wtViewport.rowsRenderCalculator.endRow;
  },
  getLastVisibleRow: function() {
    return this.wot.wtViewport.rowsVisibleCalculator.endRow;
  },
  getLastRenderedColumn: function() {
    return this.wot.wtViewport.columnsRenderCalculator.endColumn;
  },
  getLastVisibleColumn: function() {
    return this.wot.wtViewport.columnsVisibleCalculator.endColumn;
  },
  isRowBeforeRenderedRows: function(row) {
    return this.rowFilter && (this.rowFilter.sourceToRendered(row) < 0 && row >= 0);
  },
  isRowAfterViewport: function(row) {
    return this.rowFilter && (this.rowFilter.sourceToRendered(row) > this.getLastVisibleRow());
  },
  isRowAfterRenderedRows: function(row) {
    return this.rowFilter && (this.rowFilter.sourceToRendered(row) > this.getLastRenderedRow());
  },
  isColumnBeforeViewport: function(column) {
    return this.columnFilter && (this.columnFilter.sourceToRendered(column) < 0 && column >= 0);
  },
  isColumnAfterViewport: function(column) {
    return this.columnFilter && (this.columnFilter.sourceToRendered(column) > this.getLastVisibleColumn());
  },
  isLastRowFullyVisible: function() {
    return this.getLastVisibleRow() === this.getLastRenderedRow();
  },
  isLastColumnFullyVisible: function() {
    return this.getLastVisibleColumn() === this.getLastRenderedColumn();
  },
  getRenderedColumnsCount: function() {
    var columnsCount = this.wot.wtViewport.columnsRenderCalculator.count;
    var totalColumns = this.wot.getSetting('totalColumns');
    if (this.wot.isOverlayName(WalkontableOverlay.CLONE_DEBUG)) {
      columnsCount = totalColumns;
    } else if (this.wot.isOverlayName(WalkontableOverlay.CLONE_LEFT) || this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP_LEFT_CORNER) || this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)) {
      return Math.min(this.wot.getSetting('fixedColumnsLeft'), totalColumns);
    }
    return columnsCount;
  },
  getRenderedRowsCount: function() {
    var rowsCount = this.wot.wtViewport.rowsRenderCalculator.count;
    var totalRows = this.wot.getSetting('totalRows');
    if (this.wot.isOverlayName(WalkontableOverlay.CLONE_DEBUG)) {
      rowsCount = totalRows;
    } else if (this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP) || this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP_LEFT_CORNER)) {
      rowsCount = Math.min(this.wot.getSetting('fixedRowsTop'), totalRows);
    } else if (this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM) || this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)) {
      rowsCount = Math.min(this.wot.getSetting('fixedRowsBottom'), totalRows);
    }
    return rowsCount;
  },
  getVisibleRowsCount: function() {
    return this.wot.wtViewport.rowsVisibleCalculator.count;
  },
  allRowsInViewport: function() {
    return this.wot.getSetting('totalRows') == this.getVisibleRowsCount();
  },
  getRowHeight: function(sourceRow) {
    var height = this.wot.wtSettings.settings.rowHeight(sourceRow);
    var oversizedHeight = this.wot.wtViewport.oversizedRows[sourceRow];
    if (oversizedHeight !== void 0) {
      height = height === void 0 ? oversizedHeight : Math.max(height, oversizedHeight);
    }
    return height;
  },
  getColumnHeaderHeight: function(level) {
    var height = this.wot.wtSettings.settings.defaultRowHeight;
    var oversizedHeight = this.wot.wtViewport.oversizedColumnHeaders[level];
    if (oversizedHeight !== void 0) {
      height = height ? Math.max(height, oversizedHeight) : oversizedHeight;
    }
    return height;
  },
  getVisibleColumnsCount: function() {
    return this.wot.wtViewport.columnsVisibleCalculator.count;
  },
  allColumnsInViewport: function() {
    return this.wot.getSetting('totalColumns') == this.getVisibleColumnsCount();
  },
  getColumnWidth: function(sourceColumn) {
    var width = this.wot.wtSettings.settings.columnWidth;
    if (typeof width === 'function') {
      width = width(sourceColumn);
    } else if (typeof width === 'object') {
      width = width[sourceColumn];
    }
    return width || this.wot.wtSettings.settings.defaultColumnWidth;
  },
  getStretchedColumnWidth: function(sourceColumn) {
    var columnWidth = this.getColumnWidth(sourceColumn);
    var width = columnWidth == null ? this.instance.wtSettings.settings.defaultColumnWidth : columnWidth;
    var calculator = this.wot.wtViewport.columnsRenderCalculator;
    if (calculator) {
      var stretchedWidth = calculator.getStretchedColumnWidth(sourceColumn, width);
      if (stretchedWidth) {
        width = stretchedWidth;
      }
    }
    return width;
  },
  _modifyRowHeaderWidth: function(rowHeaderWidthFactory) {
    var widths = isFunction(rowHeaderWidthFactory) ? rowHeaderWidthFactory() : null;
    if (Array.isArray(widths)) {
      widths = $traceurRuntime.spread(widths);
      widths[widths.length - 1] = this._correctRowHeaderWidth(widths[widths.length - 1]);
    } else {
      widths = this._correctRowHeaderWidth(widths);
    }
    return widths;
  },
  _correctRowHeaderWidth: function(width) {
    if (typeof width !== 'number') {
      width = this.wot.getSetting('defaultColumnWidth');
    }
    if (this.correctHeaderWidth) {
      width++;
    }
    return width;
  }
}, {});
;
window.WalkontableTable = WalkontableTable;

//# 
},{"cell/coords":6,"cell/range":7,"filter/column":10,"filter/row":11,"helpers/dom/element":47,"helpers/function":50,"tableRenderer":22}],22:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableTableRenderer: {get: function() {
      return WalkontableTableRenderer;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__;
var $__0 = ($___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}),
    addClass = $__0.addClass,
    empty = $__0.empty,
    getScrollbarWidth = $__0.getScrollbarWidth,
    hasClass = $__0.hasClass,
    innerHeight = $__0.innerHeight,
    outerWidth = $__0.outerWidth;
var performanceWarningAppeared = false;
var WalkontableTableRenderer = function WalkontableTableRenderer(wtTable) {
  this.wtTable = wtTable;
  this.wot = wtTable.instance;
  this.instance = wtTable.instance;
  this.rowFilter = wtTable.rowFilter;
  this.columnFilter = wtTable.columnFilter;
  this.TABLE = wtTable.TABLE;
  this.THEAD = wtTable.THEAD;
  this.TBODY = wtTable.TBODY;
  this.COLGROUP = wtTable.COLGROUP;
  this.rowHeaders = [];
  this.rowHeaderCount = 0;
  this.columnHeaders = [];
  this.columnHeaderCount = 0;
  this.fixedRowsTop = 0;
  this.fixedRowsBottom = 0;
};
($traceurRuntime.createClass)(WalkontableTableRenderer, {
  render: function() {
    if (!this.wtTable.isWorkingOnClone()) {
      var skipRender = {};
      this.wot.getSetting('beforeDraw', true, skipRender);
      if (skipRender.skipRender === true) {
        return;
      }
    }
    this.rowHeaders = this.wot.getSetting('rowHeaders');
    this.rowHeaderCount = this.rowHeaders.length;
    this.fixedRowsTop = this.wot.getSetting('fixedRowsTop');
    this.fixedRowsBottom = this.wot.getSetting('fixedRowsBottom');
    this.columnHeaders = this.wot.getSetting('columnHeaders');
    this.columnHeaderCount = this.columnHeaders.length;
    var columnsToRender = this.wtTable.getRenderedColumnsCount();
    var rowsToRender = this.wtTable.getRenderedRowsCount();
    var totalColumns = this.wot.getSetting('totalColumns');
    var totalRows = this.wot.getSetting('totalRows');
    var workspaceWidth;
    var adjusted = false;
    if (WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay, WalkontableOverlay.CLONE_BOTTOM) || WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay, WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)) {
      this.columnHeaders = [];
      this.columnHeaderCount = 0;
    }
    if (totalColumns >= 0) {
      this.adjustAvailableNodes();
      adjusted = true;
      this.renderColumnHeaders();
      this.renderRows(totalRows, rowsToRender, columnsToRender);
      if (!this.wtTable.isWorkingOnClone()) {
        workspaceWidth = this.wot.wtViewport.getWorkspaceWidth();
        this.wot.wtViewport.containerWidth = null;
      }
      this.adjustColumnWidths(columnsToRender);
      this.markOversizedColumnHeaders();
      this.adjustColumnHeaderHeights();
    }
    if (!adjusted) {
      this.adjustAvailableNodes();
    }
    this.removeRedundantRows(rowsToRender);
    if (!this.wtTable.isWorkingOnClone() || this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)) {
      this.markOversizedRows();
    }
    if (!this.wtTable.isWorkingOnClone()) {
      this.wot.wtViewport.createVisibleCalculators();
      this.wot.wtOverlays.refresh(false);
      this.wot.wtOverlays.applyToDOM();
      var hiderWidth = outerWidth(this.wtTable.hider);
      var tableWidth = outerWidth(this.wtTable.TABLE);
      if (hiderWidth !== 0 && (tableWidth !== hiderWidth)) {
        this.adjustColumnWidths(columnsToRender);
      }
      if (workspaceWidth !== this.wot.wtViewport.getWorkspaceWidth()) {
        this.wot.wtViewport.containerWidth = null;
        var firstRendered = this.wtTable.getFirstRenderedColumn();
        var lastRendered = this.wtTable.getLastRenderedColumn();
        var defaultColumnWidth = this.wot.getSetting('defaultColumnWidth');
        var rowHeaderWidthSetting = this.wot.getSetting('rowHeaderWidth');
        rowHeaderWidthSetting = this.instance.getSetting('onModifyRowHeaderWidth', rowHeaderWidthSetting);
        if (rowHeaderWidthSetting != null) {
          for (var i = 0; i < this.rowHeaderCount; i++) {
            var width = Array.isArray(rowHeaderWidthSetting) ? rowHeaderWidthSetting[i] : rowHeaderWidthSetting;
            width = width == null ? defaultColumnWidth : width;
            this.COLGROUP.childNodes[i].style.width = width + 'px';
          }
        }
        for (var i$__2 = firstRendered; i$__2 < lastRendered; i$__2++) {
          var width$__3 = this.wtTable.getStretchedColumnWidth(i$__2);
          var renderedIndex = this.columnFilter.sourceToRendered(i$__2);
          this.COLGROUP.childNodes[renderedIndex + this.rowHeaderCount].style.width = width$__3 + 'px';
        }
      }
      this.wot.getSetting('onDraw', true);
    } else if (this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)) {
      this.wot.cloneSource.wtOverlays.adjustElementsSize();
    }
  },
  removeRedundantRows: function(renderedRowsCount) {
    while (this.wtTable.tbodyChildrenLength > renderedRowsCount) {
      this.TBODY.removeChild(this.TBODY.lastChild);
      this.wtTable.tbodyChildrenLength--;
    }
  },
  renderRows: function(totalRows, rowsToRender, columnsToRender) {
    var lastTD,
        TR;
    var visibleRowIndex = 0;
    var sourceRowIndex = this.rowFilter.renderedToSource(visibleRowIndex);
    var isWorkingOnClone = this.wtTable.isWorkingOnClone();
    while (sourceRowIndex < totalRows && sourceRowIndex >= 0) {
      if (!performanceWarningAppeared && visibleRowIndex > 1000) {
        performanceWarningAppeared = true;
        console.warn('Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number ' + 'of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.');
      }
      if (rowsToRender !== void 0 && visibleRowIndex === rowsToRender) {
        break;
      }
      TR = this.getOrCreateTrForRow(visibleRowIndex, TR);
      this.renderRowHeaders(sourceRowIndex, TR);
      this.adjustColumns(TR, columnsToRender + this.rowHeaderCount);
      lastTD = this.renderCells(sourceRowIndex, TR, columnsToRender);
      if (!isWorkingOnClone || this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)) {
        this.resetOversizedRow(sourceRowIndex);
      }
      if (TR.firstChild) {
        var height = this.wot.wtTable.getRowHeight(sourceRowIndex);
        if (height) {
          height--;
          TR.firstChild.style.height = height + 'px';
        } else {
          TR.firstChild.style.height = '';
        }
      }
      visibleRowIndex++;
      sourceRowIndex = this.rowFilter.renderedToSource(visibleRowIndex);
    }
  },
  resetOversizedRow: function(sourceRow) {
    if (this.wot.getSetting('externalRowCalculator')) {
      return;
    }
    if (this.wot.wtViewport.oversizedRows && this.wot.wtViewport.oversizedRows[sourceRow]) {
      this.wot.wtViewport.oversizedRows[sourceRow] = void 0;
    }
  },
  markOversizedRows: function() {
    if (this.wot.getSetting('externalRowCalculator')) {
      return;
    }
    var rowCount = this.instance.wtTable.TBODY.childNodes.length;
    var expectedTableHeight = rowCount * this.instance.wtSettings.settings.defaultRowHeight;
    var actualTableHeight = innerHeight(this.instance.wtTable.TBODY) - 1;
    var previousRowHeight;
    var rowInnerHeight;
    var sourceRowIndex;
    var currentTr;
    var rowHeader;
    var totalRows = this.instance.getSetting('totalRows');
    if (expectedTableHeight === actualTableHeight && !this.instance.getSetting('fixedRowsBottom')) {
      return;
    }
    while (rowCount) {
      rowCount--;
      sourceRowIndex = this.instance.wtTable.rowFilter.renderedToSource(rowCount);
      previousRowHeight = this.instance.wtTable.getRowHeight(sourceRowIndex);
      currentTr = this.instance.wtTable.getTrForRow(sourceRowIndex);
      rowHeader = currentTr.querySelector('th');
      if (rowHeader) {
        rowInnerHeight = innerHeight(rowHeader);
      } else {
        rowInnerHeight = innerHeight(currentTr) - 1;
      }
      if ((!previousRowHeight && this.instance.wtSettings.settings.defaultRowHeight < rowInnerHeight || previousRowHeight < rowInnerHeight)) {
        this.instance.wtViewport.oversizedRows[sourceRowIndex] = ++rowInnerHeight;
      }
    }
  },
  markOversizedColumnHeaders: function() {
    var overlayName = this.wot.getOverlayName();
    if (!this.columnHeaderCount || this.wot.wtViewport.hasOversizedColumnHeadersMarked[overlayName] || this.wtTable.isWorkingOnClone()) {
      return;
    }
    var columnCount = this.wtTable.getRenderedColumnsCount();
    for (var i = 0; i < this.columnHeaderCount; i++) {
      for (var renderedColumnIndex = (-1) * this.rowHeaderCount; renderedColumnIndex < columnCount; renderedColumnIndex++) {
        this.markIfOversizedColumnHeader(renderedColumnIndex);
      }
    }
    this.wot.wtViewport.hasOversizedColumnHeadersMarked[overlayName] = true;
  },
  adjustColumnHeaderHeights: function() {
    var columnHeaders = this.wot.getSetting('columnHeaders');
    var children = this.wot.wtTable.THEAD.childNodes;
    var oversizedColumnHeaders = this.wot.wtViewport.oversizedColumnHeaders;
    for (var i = 0,
        len = columnHeaders.length; i < len; i++) {
      if (oversizedColumnHeaders[i]) {
        if (!children[i] || children[i].childNodes.length === 0) {
          return;
        }
        children[i].childNodes[0].style.height = oversizedColumnHeaders[i] + 'px';
      }
    }
  },
  markIfOversizedColumnHeader: function(col) {
    var sourceColIndex = this.wot.wtTable.columnFilter.renderedToSource(col);
    var level = this.columnHeaderCount;
    var defaultRowHeight = this.wot.wtSettings.settings.defaultRowHeight;
    var previousColHeaderHeight;
    var currentHeader;
    var currentHeaderHeight;
    var columnHeaderHeightSetting = this.wot.getSetting('columnHeaderHeight') || [];
    while (level) {
      level--;
      previousColHeaderHeight = this.wot.wtTable.getColumnHeaderHeight(level);
      currentHeader = this.wot.wtTable.getColumnHeader(sourceColIndex, level);
      if (!currentHeader) {
        continue;
      }
      currentHeaderHeight = innerHeight(currentHeader);
      if (!previousColHeaderHeight && defaultRowHeight < currentHeaderHeight || previousColHeaderHeight < currentHeaderHeight) {
        this.wot.wtViewport.oversizedColumnHeaders[level] = currentHeaderHeight;
      }
      if (Array.isArray(columnHeaderHeightSetting)) {
        if (columnHeaderHeightSetting[level] != null) {
          this.wot.wtViewport.oversizedColumnHeaders[level] = columnHeaderHeightSetting[level];
        }
      } else if (!isNaN(columnHeaderHeightSetting)) {
        this.wot.wtViewport.oversizedColumnHeaders[level] = columnHeaderHeightSetting;
      }
      if (this.wot.wtViewport.oversizedColumnHeaders[level] < (columnHeaderHeightSetting[level] || columnHeaderHeightSetting)) {
        this.wot.wtViewport.oversizedColumnHeaders[level] = (columnHeaderHeightSetting[level] || columnHeaderHeightSetting);
      }
    }
  },
  renderCells: function(sourceRowIndex, TR, columnsToRender) {
    var TD;
    var sourceColIndex;
    for (var visibleColIndex = 0; visibleColIndex < columnsToRender; visibleColIndex++) {
      sourceColIndex = this.columnFilter.renderedToSource(visibleColIndex);
      if (visibleColIndex === 0) {
        TD = TR.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(sourceColIndex)];
      } else {
        TD = TD.nextSibling;
      }
      if (TD.nodeName == 'TH') {
        TD = replaceThWithTd(TD, TR);
      }
      if (!hasClass(TD, 'hide')) {
        TD.className = '';
      }
      TD.removeAttribute('style');
      this.wot.wtSettings.settings.cellRenderer(sourceRowIndex, sourceColIndex, TD);
    }
    return TD;
  },
  adjustColumnWidths: function(columnsToRender) {
    var scrollbarCompensation = 0;
    var sourceInstance = this.wot.cloneSource ? this.wot.cloneSource : this.wot;
    var mainHolder = sourceInstance.wtTable.holder;
    var defaultColumnWidth = this.wot.getSetting('defaultColumnWidth');
    var rowHeaderWidthSetting = this.wot.getSetting('rowHeaderWidth');
    if (mainHolder.offsetHeight < mainHolder.scrollHeight) {
      scrollbarCompensation = getScrollbarWidth();
    }
    this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth() - scrollbarCompensation);
    rowHeaderWidthSetting = this.instance.getSetting('onModifyRowHeaderWidth', rowHeaderWidthSetting);
    if (rowHeaderWidthSetting != null) {
      for (var i = 0; i < this.rowHeaderCount; i++) {
        var width = Array.isArray(rowHeaderWidthSetting) ? rowHeaderWidthSetting[i] : rowHeaderWidthSetting;
        width = width == null ? defaultColumnWidth : width;
        this.COLGROUP.childNodes[i].style.width = width + 'px';
      }
    }
    for (var renderedColIndex = 0; renderedColIndex < columnsToRender; renderedColIndex++) {
      var width$__4 = this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(renderedColIndex));
      this.COLGROUP.childNodes[renderedColIndex + this.rowHeaderCount].style.width = width$__4 + 'px';
    }
  },
  appendToTbody: function(TR) {
    this.TBODY.appendChild(TR);
    this.wtTable.tbodyChildrenLength++;
  },
  getOrCreateTrForRow: function(rowIndex, currentTr) {
    var TR;
    if (rowIndex >= this.wtTable.tbodyChildrenLength) {
      TR = this.createRow();
      this.appendToTbody(TR);
    } else if (rowIndex === 0) {
      TR = this.TBODY.firstChild;
    } else {
      TR = currentTr.nextSibling;
    }
    if (TR.className) {
      TR.removeAttribute('class');
    }
    return TR;
  },
  createRow: function() {
    var TR = document.createElement('TR');
    for (var visibleColIndex = 0; visibleColIndex < this.rowHeaderCount; visibleColIndex++) {
      TR.appendChild(document.createElement('TH'));
    }
    return TR;
  },
  renderRowHeader: function(row, col, TH) {
    TH.className = '';
    TH.removeAttribute('style');
    this.rowHeaders[col](row, TH, col);
  },
  renderRowHeaders: function(row, TR) {
    for (var TH = TR.firstChild,
        visibleColIndex = 0; visibleColIndex < this.rowHeaderCount; visibleColIndex++) {
      if (!TH) {
        TH = document.createElement('TH');
        TR.appendChild(TH);
      } else if (TH.nodeName == 'TD') {
        TH = replaceTdWithTh(TH, TR);
      }
      this.renderRowHeader(row, visibleColIndex, TH);
      TH = TH.nextSibling;
    }
  },
  adjustAvailableNodes: function() {
    this.adjustColGroups();
    this.adjustThead();
  },
  renderColumnHeaders: function() {
    if (!this.columnHeaderCount) {
      return;
    }
    var columnCount = this.wtTable.getRenderedColumnsCount();
    for (var i = 0; i < this.columnHeaderCount; i++) {
      var TR = this.getTrForColumnHeaders(i);
      for (var renderedColumnIndex = (-1) * this.rowHeaderCount; renderedColumnIndex < columnCount; renderedColumnIndex++) {
        var sourceCol = this.columnFilter.renderedToSource(renderedColumnIndex);
        this.renderColumnHeader(i, sourceCol, TR.childNodes[renderedColumnIndex + this.rowHeaderCount]);
      }
    }
  },
  adjustColGroups: function() {
    var columnCount = this.wtTable.getRenderedColumnsCount();
    while (this.wtTable.colgroupChildrenLength < columnCount + this.rowHeaderCount) {
      this.COLGROUP.appendChild(document.createElement('COL'));
      this.wtTable.colgroupChildrenLength++;
    }
    while (this.wtTable.colgroupChildrenLength > columnCount + this.rowHeaderCount) {
      this.COLGROUP.removeChild(this.COLGROUP.lastChild);
      this.wtTable.colgroupChildrenLength--;
    }
    if (this.rowHeaderCount) {
      addClass(this.COLGROUP.childNodes[0], 'rowHeader');
    }
  },
  adjustThead: function() {
    var columnCount = this.wtTable.getRenderedColumnsCount();
    var TR = this.THEAD.firstChild;
    if (this.columnHeaders.length) {
      for (var i = 0,
          len = this.columnHeaders.length; i < len; i++) {
        TR = this.THEAD.childNodes[i];
        if (!TR) {
          TR = document.createElement('TR');
          this.THEAD.appendChild(TR);
        }
        this.theadChildrenLength = TR.childNodes.length;
        while (this.theadChildrenLength < columnCount + this.rowHeaderCount) {
          TR.appendChild(document.createElement('TH'));
          this.theadChildrenLength++;
        }
        while (this.theadChildrenLength > columnCount + this.rowHeaderCount) {
          TR.removeChild(TR.lastChild);
          this.theadChildrenLength--;
        }
      }
      var theadChildrenLength = this.THEAD.childNodes.length;
      if (theadChildrenLength > this.columnHeaders.length) {
        for (var i$__5 = this.columnHeaders.length; i$__5 < theadChildrenLength; i$__5++) {
          this.THEAD.removeChild(this.THEAD.lastChild);
        }
      }
    } else if (TR) {
      empty(TR);
    }
  },
  getTrForColumnHeaders: function(index) {
    return this.THEAD.childNodes[index];
  },
  renderColumnHeader: function(row, col, TH) {
    TH.className = '';
    TH.removeAttribute('style');
    return this.columnHeaders[row](col, TH, row);
  },
  adjustColumns: function(TR, desiredCount) {
    var count = TR.childNodes.length;
    while (count < desiredCount) {
      var TD = document.createElement('TD');
      TR.appendChild(TD);
      count++;
    }
    while (count > desiredCount) {
      TR.removeChild(TR.lastChild);
      count--;
    }
  },
  removeRedundantColumns: function(columnsToRender) {
    while (this.wtTable.tbodyChildrenLength > columnsToRender) {
      this.TBODY.removeChild(this.TBODY.lastChild);
      this.wtTable.tbodyChildrenLength--;
    }
  }
}, {});
function replaceTdWithTh(TD, TR) {
  var TH = document.createElement('TH');
  TR.insertBefore(TH, TD);
  TR.removeChild(TD);
  return TH;
}
function replaceThWithTd(TH, TR) {
  var TD = document.createElement('TD');
  TR.insertBefore(TD, TH);
  TR.removeChild(TH);
  return TD;
}
;
window.WalkontableTableRenderer = WalkontableTableRenderer;

//# 
},{"helpers/dom/element":47}],23:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  WalkontableViewport: {get: function() {
      return WalkontableViewport;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47__46__46__47_browser__,
    $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47__46__46__47_helpers_47_object__,
    $___46__46__47__46__46__47__46__46__47_eventManager__,
    $__calculator_47_viewportColumns__,
    $__calculator_47_viewportRows__;
var Handsontable = ($___46__46__47__46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47__46__46__47_browser__}).default;
var $__1 = ($___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}),
    getScrollbarWidth = $__1.getScrollbarWidth,
    getScrollTop = $__1.getScrollTop,
    getStyle = $__1.getStyle,
    offset = $__1.offset,
    outerHeight = $__1.outerHeight,
    outerWidth = $__1.outerWidth;
var objectEach = ($___46__46__47__46__46__47__46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47__46__46__47__46__46__47_helpers_47_object__ && $___46__46__47__46__46__47__46__46__47_helpers_47_object__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_object__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_object__}).objectEach;
var EventManager = ($___46__46__47__46__46__47__46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47__46__46__47__46__46__47_eventManager__ && $___46__46__47__46__46__47__46__46__47_eventManager__.__esModule && $___46__46__47__46__46__47__46__46__47_eventManager__ || {default: $___46__46__47__46__46__47__46__46__47_eventManager__}).EventManager;
var WalkontableViewportColumnsCalculator = ($__calculator_47_viewportColumns__ = _dereq_("calculator/viewportColumns"), $__calculator_47_viewportColumns__ && $__calculator_47_viewportColumns__.__esModule && $__calculator_47_viewportColumns__ || {default: $__calculator_47_viewportColumns__}).WalkontableViewportColumnsCalculator;
var WalkontableViewportRowsCalculator = ($__calculator_47_viewportRows__ = _dereq_("calculator/viewportRows"), $__calculator_47_viewportRows__ && $__calculator_47_viewportRows__.__esModule && $__calculator_47_viewportRows__ || {default: $__calculator_47_viewportRows__}).WalkontableViewportRowsCalculator;
var WalkontableViewport = function WalkontableViewport(wotInstance) {
  var $__6 = this;
  this.wot = wotInstance;
  this.instance = this.wot;
  this.oversizedRows = [];
  this.oversizedColumnHeaders = [];
  this.hasOversizedColumnHeadersMarked = {};
  this.clientHeight = 0;
  this.containerWidth = NaN;
  this.rowHeaderWidth = NaN;
  this.rowsVisibleCalculator = null;
  this.columnsVisibleCalculator = null;
  this.eventManager = new EventManager(this.wot);
  this.eventManager.addEventListener(window, 'resize', (function() {
    $__6.clientHeight = $__6.getWorkspaceHeight();
  }));
};
($traceurRuntime.createClass)(WalkontableViewport, {
  getWorkspaceHeight: function() {
    var trimmingContainer = this.instance.wtOverlays.topOverlay.trimmingContainer;
    var elemHeight;
    var height = 0;
    if (trimmingContainer === window) {
      height = document.documentElement.clientHeight;
    } else {
      elemHeight = outerHeight(trimmingContainer);
      height = (elemHeight > 0 && trimmingContainer.clientHeight > 0) ? trimmingContainer.clientHeight : Infinity;
    }
    return height;
  },
  getWorkspaceWidth: function() {
    var width;
    var totalColumns = this.wot.getSetting('totalColumns');
    var trimmingContainer = this.instance.wtOverlays.leftOverlay.trimmingContainer;
    var overflow;
    var stretchSetting = this.wot.getSetting('stretchH');
    var docOffsetWidth = document.documentElement.offsetWidth;
    var preventOverflow = this.wot.getSetting('preventOverflow');
    if (preventOverflow) {
      return outerWidth(this.instance.wtTable.wtRootElement);
    }
    if (Handsontable.freezeOverlays) {
      width = Math.min(docOffsetWidth - this.getWorkspaceOffset().left, docOffsetWidth);
    } else {
      width = Math.min(this.getContainerFillWidth(), docOffsetWidth - this.getWorkspaceOffset().left, docOffsetWidth);
    }
    if (trimmingContainer === window && totalColumns > 0 && this.sumColumnWidths(0, totalColumns - 1) > width) {
      return document.documentElement.clientWidth;
    }
    if (trimmingContainer !== window) {
      overflow = getStyle(this.instance.wtOverlays.leftOverlay.trimmingContainer, 'overflow');
      if (overflow == 'scroll' || overflow == 'hidden' || overflow == 'auto') {
        return Math.max(width, trimmingContainer.clientWidth);
      }
    }
    if (stretchSetting === 'none' || !stretchSetting) {
      return Math.max(width, outerWidth(this.instance.wtTable.TABLE));
    } else {
      return width;
    }
  },
  hasVerticalScroll: function() {
    return this.getWorkspaceActualHeight() > this.getWorkspaceHeight();
  },
  hasHorizontalScroll: function() {
    return this.getWorkspaceActualWidth() > this.getWorkspaceWidth();
  },
  sumColumnWidths: function(from, length) {
    var sum = 0;
    while (from < length) {
      sum += this.wot.wtTable.getColumnWidth(from);
      from++;
    }
    return sum;
  },
  getContainerFillWidth: function() {
    if (this.containerWidth) {
      return this.containerWidth;
    }
    var mainContainer = this.instance.wtTable.holder;
    var fillWidth;
    var dummyElement;
    dummyElement = document.createElement('div');
    dummyElement.style.width = '100%';
    dummyElement.style.height = '1px';
    mainContainer.appendChild(dummyElement);
    fillWidth = dummyElement.offsetWidth;
    this.containerWidth = fillWidth;
    mainContainer.removeChild(dummyElement);
    return fillWidth;
  },
  getWorkspaceOffset: function() {
    return offset(this.wot.wtTable.TABLE);
  },
  getWorkspaceActualHeight: function() {
    return outerHeight(this.wot.wtTable.TABLE);
  },
  getWorkspaceActualWidth: function() {
    return outerWidth(this.wot.wtTable.TABLE) || outerWidth(this.wot.wtTable.TBODY) || outerWidth(this.wot.wtTable.THEAD);
  },
  getColumnHeaderHeight: function() {
    if (isNaN(this.columnHeaderHeight)) {
      this.columnHeaderHeight = outerHeight(this.wot.wtTable.THEAD);
    }
    return this.columnHeaderHeight;
  },
  getViewportHeight: function() {
    var containerHeight = this.getWorkspaceHeight();
    var columnHeaderHeight;
    if (containerHeight === Infinity) {
      return containerHeight;
    }
    columnHeaderHeight = this.getColumnHeaderHeight();
    if (columnHeaderHeight > 0) {
      containerHeight -= columnHeaderHeight;
    }
    return containerHeight;
  },
  getRowHeaderWidth: function() {
    var rowHeadersHeightSetting = this.instance.getSetting('rowHeaderWidth');
    var rowHeaders = this.instance.getSetting('rowHeaders');
    if (rowHeadersHeightSetting) {
      this.rowHeaderWidth = 0;
      for (var i = 0,
          len = rowHeaders.length; i < len; i++) {
        this.rowHeaderWidth += rowHeadersHeightSetting[i] || rowHeadersHeightSetting;
      }
    }
    if (this.wot.cloneSource) {
      return this.wot.cloneSource.wtViewport.getRowHeaderWidth();
    }
    if (isNaN(this.rowHeaderWidth)) {
      if (rowHeaders.length) {
        var TH = this.instance.wtTable.TABLE.querySelector('TH');
        this.rowHeaderWidth = 0;
        for (var i$__8 = 0,
            len$__9 = rowHeaders.length; i$__8 < len$__9; i$__8++) {
          if (TH) {
            this.rowHeaderWidth += outerWidth(TH);
            TH = TH.nextSibling;
          } else {
            this.rowHeaderWidth += 50;
          }
        }
      } else {
        this.rowHeaderWidth = 0;
      }
    }
    this.rowHeaderWidth = this.instance.getSetting('onModifyRowHeaderWidth', this.rowHeaderWidth) || this.rowHeaderWidth;
    return this.rowHeaderWidth;
  },
  getViewportWidth: function() {
    var containerWidth = this.getWorkspaceWidth();
    var rowHeaderWidth;
    if (containerWidth === Infinity) {
      return containerWidth;
    }
    rowHeaderWidth = this.getRowHeaderWidth();
    if (rowHeaderWidth > 0) {
      return containerWidth - rowHeaderWidth;
    }
    return containerWidth;
  },
  createRowsCalculator: function() {
    var visible = arguments[0] !== (void 0) ? arguments[0] : false;
    var $__6 = this;
    var height;
    var pos;
    var fixedRowsTop;
    var scrollbarHeight;
    var fixedRowsBottom;
    var fixedRowsHeight;
    var totalRows;
    this.rowHeaderWidth = NaN;
    if (this.wot.wtSettings.settings.renderAllRows) {
      height = Infinity;
    } else {
      height = this.getViewportHeight();
    }
    pos = this.wot.wtOverlays.topOverlay.getScrollPosition() - this.wot.wtOverlays.topOverlay.getTableParentOffset();
    if (pos < 0) {
      pos = 0;
    }
    fixedRowsTop = this.wot.getSetting('fixedRowsTop');
    fixedRowsBottom = this.wot.getSetting('fixedRowsBottom');
    totalRows = this.wot.getSetting('totalRows');
    if (fixedRowsTop) {
      fixedRowsHeight = this.wot.wtOverlays.topOverlay.sumCellSizes(0, fixedRowsTop);
      pos += fixedRowsHeight;
      height -= fixedRowsHeight;
    }
    if (fixedRowsBottom && this.wot.wtOverlays.bottomOverlay.clone) {
      fixedRowsHeight = this.wot.wtOverlays.bottomOverlay.sumCellSizes(totalRows - fixedRowsBottom, totalRows);
      height -= fixedRowsHeight;
    }
    if (this.wot.wtTable.holder.clientHeight === this.wot.wtTable.holder.offsetHeight) {
      scrollbarHeight = 0;
    } else {
      scrollbarHeight = getScrollbarWidth();
    }
    return new WalkontableViewportRowsCalculator(height, pos, this.wot.getSetting('totalRows'), (function(sourceRow) {
      return $__6.wot.wtTable.getRowHeight(sourceRow);
    }), visible ? null : this.wot.wtSettings.settings.viewportRowCalculatorOverride, visible, scrollbarHeight);
  },
  createColumnsCalculator: function() {
    var visible = arguments[0] !== (void 0) ? arguments[0] : false;
    var $__6 = this;
    var width = this.getViewportWidth();
    var pos;
    var fixedColumnsLeft;
    this.columnHeaderHeight = NaN;
    pos = this.wot.wtOverlays.leftOverlay.getScrollPosition() - this.wot.wtOverlays.leftOverlay.getTableParentOffset();
    if (pos < 0) {
      pos = 0;
    }
    fixedColumnsLeft = this.wot.getSetting('fixedColumnsLeft');
    if (fixedColumnsLeft) {
      var fixedColumnsWidth = this.wot.wtOverlays.leftOverlay.sumCellSizes(0, fixedColumnsLeft);
      pos += fixedColumnsWidth;
      width -= fixedColumnsWidth;
    }
    if (this.wot.wtTable.holder.clientWidth !== this.wot.wtTable.holder.offsetWidth) {
      width -= getScrollbarWidth();
    }
    return new WalkontableViewportColumnsCalculator(width, pos, this.wot.getSetting('totalColumns'), (function(sourceCol) {
      return $__6.wot.wtTable.getColumnWidth(sourceCol);
    }), visible ? null : this.wot.wtSettings.settings.viewportColumnCalculatorOverride, visible, this.wot.getSetting('stretchH'), (function(stretchedWidth, column) {
      return $__6.wot.getSetting('onBeforeStretchingColumnWidth', stretchedWidth, column);
    }));
  },
  createRenderCalculators: function() {
    var fastDraw = arguments[0] !== (void 0) ? arguments[0] : false;
    if (fastDraw) {
      var proposedRowsVisibleCalculator = this.createRowsCalculator(true);
      var proposedColumnsVisibleCalculator = this.createColumnsCalculator(true);
      if (!(this.areAllProposedVisibleRowsAlreadyRendered(proposedRowsVisibleCalculator) && this.areAllProposedVisibleColumnsAlreadyRendered(proposedColumnsVisibleCalculator))) {
        fastDraw = false;
      }
    }
    if (!fastDraw) {
      this.rowsRenderCalculator = this.createRowsCalculator();
      this.columnsRenderCalculator = this.createColumnsCalculator();
    }
    this.rowsVisibleCalculator = null;
    this.columnsVisibleCalculator = null;
    return fastDraw;
  },
  createVisibleCalculators: function() {
    this.rowsVisibleCalculator = this.createRowsCalculator(true);
    this.columnsVisibleCalculator = this.createColumnsCalculator(true);
  },
  areAllProposedVisibleRowsAlreadyRendered: function(proposedRowsVisibleCalculator) {
    if (this.rowsVisibleCalculator) {
      if (proposedRowsVisibleCalculator.startRow < this.rowsRenderCalculator.startRow || (proposedRowsVisibleCalculator.startRow === this.rowsRenderCalculator.startRow && proposedRowsVisibleCalculator.startRow > 0)) {
        return false;
      } else if (proposedRowsVisibleCalculator.endRow > this.rowsRenderCalculator.endRow || (proposedRowsVisibleCalculator.endRow === this.rowsRenderCalculator.endRow && proposedRowsVisibleCalculator.endRow < this.wot.getSetting('totalRows') - 1)) {
        return false;
      } else {
        return true;
      }
    }
    return false;
  },
  areAllProposedVisibleColumnsAlreadyRendered: function(proposedColumnsVisibleCalculator) {
    if (this.columnsVisibleCalculator) {
      if (proposedColumnsVisibleCalculator.startColumn < this.columnsRenderCalculator.startColumn || (proposedColumnsVisibleCalculator.startColumn === this.columnsRenderCalculator.startColumn && proposedColumnsVisibleCalculator.startColumn > 0)) {
        return false;
      } else if (proposedColumnsVisibleCalculator.endColumn > this.columnsRenderCalculator.endColumn || (proposedColumnsVisibleCalculator.endColumn === this.columnsRenderCalculator.endColumn && proposedColumnsVisibleCalculator.endColumn < this.wot.getSetting('totalColumns') - 1)) {
        return false;
      } else {
        return true;
      }
    }
    return false;
  },
  resetHasOversizedColumnHeadersMarked: function() {
    objectEach(this.hasOversizedColumnHeadersMarked, function(value, key, object) {
      object[key] = void 0;
    });
  }
}, {});
;
window.WalkontableViewport = WalkontableViewport;

//# 
},{"browser":24,"calculator/viewportColumns":4,"calculator/viewportRows":5,"eventManager":42,"helpers/dom/element":47,"helpers/object":53}],24:[function(_dereq_,module,exports){
"use strict";
var $__shims_47_runtime__,
    $__es6collections__,
    $__pluginHooks__,
    $__numbro__,
    $__moment__,
    $__core__,
    $__renderers_47__95_cellDecorator__,
    $__cellTypes__,
    $___46__46__47_plugins_47_jqueryHandsontable__,
    $__helpers_47_array__,
    $__helpers_47_browser__,
    $__helpers_47_data__,
    $__helpers_47_date__,
    $__helpers_47_feature__,
    $__helpers_47_function__,
    $__helpers_47_mixed__,
    $__helpers_47_number__,
    $__helpers_47_object__,
    $__helpers_47_setting__,
    $__helpers_47_string__,
    $__helpers_47_unicode__,
    $__helpers_47_dom_47_element__,
    $__helpers_47_dom_47_event__,
    $__plugins__;
function Handsontable(rootElement, userSettings) {
  var instance = new Handsontable.Core(rootElement, userSettings || {});
  instance.init();
  return instance;
}
module.exports = Handsontable;
Handsontable.utils = {};
($__shims_47_runtime__ = _dereq_("shims/runtime"), $__shims_47_runtime__ && $__shims_47_runtime__.__esModule && $__shims_47_runtime__ || {default: $__shims_47_runtime__});
($__es6collections__ = _dereq_("es6collections"), $__es6collections__ && $__es6collections__.__esModule && $__es6collections__ || {default: $__es6collections__});
var Hooks = ($__pluginHooks__ = _dereq_("pluginHooks"), $__pluginHooks__ && $__pluginHooks__.__esModule && $__pluginHooks__ || {default: $__pluginHooks__}).Hooks;
var numbro = ($__numbro__ = _dereq_("numbro"), $__numbro__ && $__numbro__.__esModule && $__numbro__ || {default: $__numbro__}).default;
var moment = ($__moment__ = _dereq_("moment"), $__moment__ && $__moment__.__esModule && $__moment__ || {default: $__moment__}).default;
if (typeof window === 'object') {
  if (typeof window.numbro === 'undefined') {
    window.numbro = numbro;
  }
  if (typeof window.moment === 'undefined') {
    window.moment = moment;
  }
}
if (!Handsontable.hooks) {
  Handsontable.hooks = new Hooks();
}
Handsontable.utils.Hooks = Hooks;
($__core__ = _dereq_("core"), $__core__ && $__core__.__esModule && $__core__ || {default: $__core__});
($__renderers_47__95_cellDecorator__ = _dereq_("renderers/_cellDecorator"), $__renderers_47__95_cellDecorator__ && $__renderers_47__95_cellDecorator__.__esModule && $__renderers_47__95_cellDecorator__ || {default: $__renderers_47__95_cellDecorator__});
($__cellTypes__ = _dereq_("cellTypes"), $__cellTypes__ && $__cellTypes__.__esModule && $__cellTypes__ || {default: $__cellTypes__});
($___46__46__47_plugins_47_jqueryHandsontable__ = _dereq_("plugins/jqueryHandsontable"), $___46__46__47_plugins_47_jqueryHandsontable__ && $___46__46__47_plugins_47_jqueryHandsontable__.__esModule && $___46__46__47_plugins_47_jqueryHandsontable__ || {default: $___46__46__47_plugins_47_jqueryHandsontable__});
var arrayHelpers = ($__helpers_47_array__ = _dereq_("helpers/array"), $__helpers_47_array__ && $__helpers_47_array__.__esModule && $__helpers_47_array__ || {default: $__helpers_47_array__});
var browserHelpers = ($__helpers_47_browser__ = _dereq_("helpers/browser"), $__helpers_47_browser__ && $__helpers_47_browser__.__esModule && $__helpers_47_browser__ || {default: $__helpers_47_browser__});
var dataHelpers = ($__helpers_47_data__ = _dereq_("helpers/data"), $__helpers_47_data__ && $__helpers_47_data__.__esModule && $__helpers_47_data__ || {default: $__helpers_47_data__});
var dateHelpers = ($__helpers_47_date__ = _dereq_("helpers/date"), $__helpers_47_date__ && $__helpers_47_date__.__esModule && $__helpers_47_date__ || {default: $__helpers_47_date__});
var featureHelpers = ($__helpers_47_feature__ = _dereq_("helpers/feature"), $__helpers_47_feature__ && $__helpers_47_feature__.__esModule && $__helpers_47_feature__ || {default: $__helpers_47_feature__});
var functionHelpers = ($__helpers_47_function__ = _dereq_("helpers/function"), $__helpers_47_function__ && $__helpers_47_function__.__esModule && $__helpers_47_function__ || {default: $__helpers_47_function__});
var mixedHelpers = ($__helpers_47_mixed__ = _dereq_("helpers/mixed"), $__helpers_47_mixed__ && $__helpers_47_mixed__.__esModule && $__helpers_47_mixed__ || {default: $__helpers_47_mixed__});
var numberHelpers = ($__helpers_47_number__ = _dereq_("helpers/number"), $__helpers_47_number__ && $__helpers_47_number__.__esModule && $__helpers_47_number__ || {default: $__helpers_47_number__});
var objectHelpers = ($__helpers_47_object__ = _dereq_("helpers/object"), $__helpers_47_object__ && $__helpers_47_object__.__esModule && $__helpers_47_object__ || {default: $__helpers_47_object__});
var settingHelpers = ($__helpers_47_setting__ = _dereq_("helpers/setting"), $__helpers_47_setting__ && $__helpers_47_setting__.__esModule && $__helpers_47_setting__ || {default: $__helpers_47_setting__});
var stringHelpers = ($__helpers_47_string__ = _dereq_("helpers/string"), $__helpers_47_string__ && $__helpers_47_string__.__esModule && $__helpers_47_string__ || {default: $__helpers_47_string__});
var unicodeHelpers = ($__helpers_47_unicode__ = _dereq_("helpers/unicode"), $__helpers_47_unicode__ && $__helpers_47_unicode__.__esModule && $__helpers_47_unicode__ || {default: $__helpers_47_unicode__});
var domHelpers = ($__helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $__helpers_47_dom_47_element__ && $__helpers_47_dom_47_element__.__esModule && $__helpers_47_dom_47_element__ || {default: $__helpers_47_dom_47_element__});
var domEventHelpers = ($__helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $__helpers_47_dom_47_event__ && $__helpers_47_dom_47_event__.__esModule && $__helpers_47_dom_47_event__ || {default: $__helpers_47_dom_47_event__});
var HELPERS = [arrayHelpers, browserHelpers, dataHelpers, dateHelpers, featureHelpers, functionHelpers, mixedHelpers, numberHelpers, objectHelpers, settingHelpers, stringHelpers, unicodeHelpers];
var DOM = [domHelpers, domEventHelpers];
Handsontable.buildDate = 'Mon Apr 03 2017 14:22:01 GMT+0200 (CEST)';
Handsontable.packageName = 'handsontable';
Handsontable.version = '0.31.2';
var baseVersion = '@@baseVersion';
if (!/^@@/.test(baseVersion)) {
  Handsontable.baseVersion = baseVersion;
}
Handsontable.plugins = {};
var registerPlugin = ($__plugins__ = _dereq_("plugins"), $__plugins__ && $__plugins__.__esModule && $__plugins__ || {default: $__plugins__}).registerPlugin;
Handsontable.plugins.registerPlugin = registerPlugin;
Handsontable.helper = {};
Handsontable.dom = {};
Handsontable.Dom = Handsontable.dom;
arrayHelpers.arrayEach(HELPERS, (function(helper) {
  arrayHelpers.arrayEach(Object.getOwnPropertyNames(helper), (function(key) {
    if (key.charAt(0) !== '_') {
      Handsontable.helper[key] = helper[key];
    }
  }));
}));
arrayHelpers.arrayEach(DOM, (function(helper) {
  arrayHelpers.arrayEach(Object.getOwnPropertyNames(helper), (function(key) {
    if (key.charAt(0) !== '_') {
      Handsontable.dom[key] = helper[key];
    }
  }));
}));

//# 
},{"cellTypes":25,"core":26,"es6collections":"es6collections","helpers/array":43,"helpers/browser":44,"helpers/data":45,"helpers/date":46,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/feature":49,"helpers/function":50,"helpers/mixed":51,"helpers/number":52,"helpers/object":53,"helpers/setting":54,"helpers/string":55,"helpers/unicode":56,"moment":"moment","numbro":"numbro","pluginHooks":60,"plugins":61,"plugins/jqueryHandsontable":2,"renderers/_cellDecorator":118,"shims/runtime":125}],25:[function(_dereq_,module,exports){
"use strict";
var $__helpers_47_browser__,
    $__editors__,
    $__renderers__,
    $__editors_47_autocompleteEditor__,
    $__editors_47_checkboxEditor__,
    $__editors_47_dateEditor__,
    $__editors_47_dropdownEditor__,
    $__editors_47_handsontableEditor__,
    $__editors_47_mobileTextEditor__,
    $__editors_47_numericEditor__,
    $__editors_47_passwordEditor__,
    $__editors_47_selectEditor__,
    $__editors_47_textEditor__,
    $__renderers_47_autocompleteRenderer__,
    $__renderers_47_checkboxRenderer__,
    $__renderers_47_htmlRenderer__,
    $__renderers_47_numericRenderer__,
    $__renderers_47_passwordRenderer__,
    $__renderers_47_textRenderer__,
    $__validators_47_autocompleteValidator__,
    $__validators_47_dateValidator__,
    $__validators_47_timeValidator__,
    $__validators_47_numericValidator__,
    $__browser__;
var isMobileBrowser = ($__helpers_47_browser__ = _dereq_("helpers/browser"), $__helpers_47_browser__ && $__helpers_47_browser__.__esModule && $__helpers_47_browser__ || {default: $__helpers_47_browser__}).isMobileBrowser;
var getEditorConstructor = ($__editors__ = _dereq_("editors"), $__editors__ && $__editors__.__esModule && $__editors__ || {default: $__editors__}).getEditorConstructor;
var getRenderer = ($__renderers__ = _dereq_("renderers"), $__renderers__ && $__renderers__.__esModule && $__renderers__ || {default: $__renderers__}).getRenderer;
var AutocompleteEditor = ($__editors_47_autocompleteEditor__ = _dereq_("editors/autocompleteEditor"), $__editors_47_autocompleteEditor__ && $__editors_47_autocompleteEditor__.__esModule && $__editors_47_autocompleteEditor__ || {default: $__editors_47_autocompleteEditor__}).AutocompleteEditor;
var CheckboxEditor = ($__editors_47_checkboxEditor__ = _dereq_("editors/checkboxEditor"), $__editors_47_checkboxEditor__ && $__editors_47_checkboxEditor__.__esModule && $__editors_47_checkboxEditor__ || {default: $__editors_47_checkboxEditor__}).CheckboxEditor;
var DateEditor = ($__editors_47_dateEditor__ = _dereq_("editors/dateEditor"), $__editors_47_dateEditor__ && $__editors_47_dateEditor__.__esModule && $__editors_47_dateEditor__ || {default: $__editors_47_dateEditor__}).DateEditor;
var DropdownEditor = ($__editors_47_dropdownEditor__ = _dereq_("editors/dropdownEditor"), $__editors_47_dropdownEditor__ && $__editors_47_dropdownEditor__.__esModule && $__editors_47_dropdownEditor__ || {default: $__editors_47_dropdownEditor__}).DropdownEditor;
var HandsontableEditor = ($__editors_47_handsontableEditor__ = _dereq_("editors/handsontableEditor"), $__editors_47_handsontableEditor__ && $__editors_47_handsontableEditor__.__esModule && $__editors_47_handsontableEditor__ || {default: $__editors_47_handsontableEditor__}).HandsontableEditor;
var MobileTextEditor = ($__editors_47_mobileTextEditor__ = _dereq_("editors/mobileTextEditor"), $__editors_47_mobileTextEditor__ && $__editors_47_mobileTextEditor__.__esModule && $__editors_47_mobileTextEditor__ || {default: $__editors_47_mobileTextEditor__}).MobileTextEditor;
var NumericEditor = ($__editors_47_numericEditor__ = _dereq_("editors/numericEditor"), $__editors_47_numericEditor__ && $__editors_47_numericEditor__.__esModule && $__editors_47_numericEditor__ || {default: $__editors_47_numericEditor__}).NumericEditor;
var PasswordEditor = ($__editors_47_passwordEditor__ = _dereq_("editors/passwordEditor"), $__editors_47_passwordEditor__ && $__editors_47_passwordEditor__.__esModule && $__editors_47_passwordEditor__ || {default: $__editors_47_passwordEditor__}).PasswordEditor;
var SelectEditor = ($__editors_47_selectEditor__ = _dereq_("editors/selectEditor"), $__editors_47_selectEditor__ && $__editors_47_selectEditor__.__esModule && $__editors_47_selectEditor__ || {default: $__editors_47_selectEditor__}).SelectEditor;
var TextEditor = ($__editors_47_textEditor__ = _dereq_("editors/textEditor"), $__editors_47_textEditor__ && $__editors_47_textEditor__.__esModule && $__editors_47_textEditor__ || {default: $__editors_47_textEditor__}).TextEditor;
var AutocompleteRenderer = ($__renderers_47_autocompleteRenderer__ = _dereq_("renderers/autocompleteRenderer"), $__renderers_47_autocompleteRenderer__ && $__renderers_47_autocompleteRenderer__.__esModule && $__renderers_47_autocompleteRenderer__ || {default: $__renderers_47_autocompleteRenderer__}).AutocompleteRenderer;
var CheckboxRenderer = ($__renderers_47_checkboxRenderer__ = _dereq_("renderers/checkboxRenderer"), $__renderers_47_checkboxRenderer__ && $__renderers_47_checkboxRenderer__.__esModule && $__renderers_47_checkboxRenderer__ || {default: $__renderers_47_checkboxRenderer__}).CheckboxRenderer;
var HtmlRenderer = ($__renderers_47_htmlRenderer__ = _dereq_("renderers/htmlRenderer"), $__renderers_47_htmlRenderer__ && $__renderers_47_htmlRenderer__.__esModule && $__renderers_47_htmlRenderer__ || {default: $__renderers_47_htmlRenderer__}).HtmlRenderer;
var NumericRenderer = ($__renderers_47_numericRenderer__ = _dereq_("renderers/numericRenderer"), $__renderers_47_numericRenderer__ && $__renderers_47_numericRenderer__.__esModule && $__renderers_47_numericRenderer__ || {default: $__renderers_47_numericRenderer__}).NumericRenderer;
var PasswordRenderer = ($__renderers_47_passwordRenderer__ = _dereq_("renderers/passwordRenderer"), $__renderers_47_passwordRenderer__ && $__renderers_47_passwordRenderer__.__esModule && $__renderers_47_passwordRenderer__ || {default: $__renderers_47_passwordRenderer__}).PasswordRenderer;
var TextRenderer = ($__renderers_47_textRenderer__ = _dereq_("renderers/textRenderer"), $__renderers_47_textRenderer__ && $__renderers_47_textRenderer__.__esModule && $__renderers_47_textRenderer__ || {default: $__renderers_47_textRenderer__}).TextRenderer;
var AutocompleteValidator = ($__validators_47_autocompleteValidator__ = _dereq_("validators/autocompleteValidator"), $__validators_47_autocompleteValidator__ && $__validators_47_autocompleteValidator__.__esModule && $__validators_47_autocompleteValidator__ || {default: $__validators_47_autocompleteValidator__}).AutocompleteValidator;
var DateValidator = ($__validators_47_dateValidator__ = _dereq_("validators/dateValidator"), $__validators_47_dateValidator__ && $__validators_47_dateValidator__.__esModule && $__validators_47_dateValidator__ || {default: $__validators_47_dateValidator__}).DateValidator;
var TimeValidator = ($__validators_47_timeValidator__ = _dereq_("validators/timeValidator"), $__validators_47_timeValidator__ && $__validators_47_timeValidator__.__esModule && $__validators_47_timeValidator__ || {default: $__validators_47_timeValidator__}).TimeValidator;
var NumericValidator = ($__validators_47_numericValidator__ = _dereq_("validators/numericValidator"), $__validators_47_numericValidator__ && $__validators_47_numericValidator__.__esModule && $__validators_47_numericValidator__ || {default: $__validators_47_numericValidator__}).NumericValidator;
var Handsontable = ($__browser__ = _dereq_("browser"), $__browser__ && $__browser__.__esModule && $__browser__ || {default: $__browser__}).default;
Handsontable.AutocompleteCell = {
  editor: getEditorConstructor('autocomplete'),
  renderer: getRenderer('autocomplete'),
  validator: Handsontable.AutocompleteValidator
};
Handsontable.CheckboxCell = {
  editor: getEditorConstructor('checkbox'),
  renderer: getRenderer('checkbox')
};
Handsontable.TextCell = {
  editor: isMobileBrowser() ? getEditorConstructor('mobile') : getEditorConstructor('text'),
  renderer: getRenderer('text')
};
Handsontable.NumericCell = {
  editor: getEditorConstructor('numeric'),
  renderer: getRenderer('numeric'),
  validator: Handsontable.NumericValidator,
  dataType: 'number'
};
Handsontable.DateCell = {
  editor: getEditorConstructor('date'),
  validator: Handsontable.DateValidator,
  renderer: getRenderer('autocomplete')
};
Handsontable.TimeCell = {
  editor: getEditorConstructor('text'),
  validator: Handsontable.TimeValidator,
  renderer: getRenderer('text')
};
Handsontable.HandsontableCell = {
  editor: getEditorConstructor('handsontable'),
  renderer: getRenderer('autocomplete')
};
Handsontable.PasswordCell = {
  editor: getEditorConstructor('password'),
  renderer: getRenderer('password'),
  copyable: false
};
Handsontable.DropdownCell = {
  editor: getEditorConstructor('dropdown'),
  renderer: getRenderer('autocomplete'),
  validator: Handsontable.AutocompleteValidator
};
Handsontable.cellTypes = {
  text: Handsontable.TextCell,
  date: Handsontable.DateCell,
  time: Handsontable.TimeCell,
  numeric: Handsontable.NumericCell,
  checkbox: Handsontable.CheckboxCell,
  autocomplete: Handsontable.AutocompleteCell,
  handsontable: Handsontable.HandsontableCell,
  password: Handsontable.PasswordCell,
  dropdown: Handsontable.DropdownCell
};
Handsontable.cellLookup = {validator: {
    numeric: Handsontable.NumericValidator,
    autocomplete: Handsontable.AutocompleteValidator
  }};

//# 
},{"browser":24,"editors":30,"editors/autocompleteEditor":32,"editors/checkboxEditor":33,"editors/dateEditor":34,"editors/dropdownEditor":35,"editors/handsontableEditor":36,"editors/mobileTextEditor":37,"editors/numericEditor":38,"editors/passwordEditor":39,"editors/selectEditor":40,"editors/textEditor":41,"helpers/browser":44,"renderers":117,"renderers/autocompleteRenderer":119,"renderers/checkboxRenderer":120,"renderers/htmlRenderer":121,"renderers/numericRenderer":122,"renderers/passwordRenderer":123,"renderers/textRenderer":124,"validators/autocompleteValidator":133,"validators/dateValidator":134,"validators/numericValidator":135,"validators/timeValidator":136}],26:[function(_dereq_,module,exports){
"use strict";
var $__browser__,
    $__numbro__,
    $__helpers_47_dom_47_element__,
    $__helpers_47_setting__,
    $__helpers_47_function__,
    $__helpers_47_mixed__,
    $__helpers_47_browser__,
    $__dataMap__,
    $__editorManager__,
    $__eventManager__,
    $__helpers_47_object__,
    $__helpers_47_array__,
    $__plugins__,
    $__renderers__,
    $__helpers_47_string__,
    $__helpers_47_number__,
    $__tableView__,
    $__dataSource__,
    $__helpers_47_data__,
    $__utils_47_recordTranslator__,
    $__3rdparty_47_walkontable_47_src_47_cell_47_coords__,
    $__3rdparty_47_walkontable_47_src_47_cell_47_range__,
    $__3rdparty_47_walkontable_47_src_47_calculator_47_viewportColumns__;
var Handsontable = ($__browser__ = _dereq_("browser"), $__browser__ && $__browser__.__esModule && $__browser__ || {default: $__browser__}).default;
var numbro = ($__numbro__ = _dereq_("numbro"), $__numbro__ && $__numbro__.__esModule && $__numbro__ || {default: $__numbro__}).default;
var $__2 = ($__helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $__helpers_47_dom_47_element__ && $__helpers_47_dom_47_element__.__esModule && $__helpers_47_dom_47_element__ || {default: $__helpers_47_dom_47_element__}),
    addClass = $__2.addClass,
    empty = $__2.empty,
    isChildOfWebComponentTable = $__2.isChildOfWebComponentTable,
    removeClass = $__2.removeClass;
var columnFactory = ($__helpers_47_setting__ = _dereq_("helpers/setting"), $__helpers_47_setting__ && $__helpers_47_setting__.__esModule && $__helpers_47_setting__ || {default: $__helpers_47_setting__}).columnFactory;
var isFunction = ($__helpers_47_function__ = _dereq_("helpers/function"), $__helpers_47_function__ && $__helpers_47_function__.__esModule && $__helpers_47_function__ || {default: $__helpers_47_function__}).isFunction;
var $__5 = ($__helpers_47_mixed__ = _dereq_("helpers/mixed"), $__helpers_47_mixed__ && $__helpers_47_mixed__.__esModule && $__helpers_47_mixed__ || {default: $__helpers_47_mixed__}),
    isDefined = $__5.isDefined,
    isUndefined = $__5.isUndefined;
var isMobileBrowser = ($__helpers_47_browser__ = _dereq_("helpers/browser"), $__helpers_47_browser__ && $__helpers_47_browser__.__esModule && $__helpers_47_browser__ || {default: $__helpers_47_browser__}).isMobileBrowser;
var DataMap = ($__dataMap__ = _dereq_("dataMap"), $__dataMap__ && $__dataMap__.__esModule && $__dataMap__ || {default: $__dataMap__}).DataMap;
var EditorManager = ($__editorManager__ = _dereq_("editorManager"), $__editorManager__ && $__editorManager__.__esModule && $__editorManager__ || {default: $__editorManager__}).EditorManager;
var eventManagerObject = ($__eventManager__ = _dereq_("eventManager"), $__eventManager__ && $__eventManager__.__esModule && $__eventManager__ || {default: $__eventManager__}).eventManager;
var $__10 = ($__helpers_47_object__ = _dereq_("helpers/object"), $__helpers_47_object__ && $__helpers_47_object__.__esModule && $__helpers_47_object__ || {default: $__helpers_47_object__}),
    deepClone = $__10.deepClone,
    duckSchema = $__10.duckSchema,
    extend = $__10.extend,
    isObject = $__10.isObject,
    isObjectEquals = $__10.isObjectEquals,
    deepObjectSize = $__10.deepObjectSize,
    createObjectPropListener = $__10.createObjectPropListener;
var $__11 = ($__helpers_47_array__ = _dereq_("helpers/array"), $__helpers_47_array__ && $__helpers_47_array__.__esModule && $__helpers_47_array__ || {default: $__helpers_47_array__}),
    arrayFlatten = $__11.arrayFlatten,
    arrayMap = $__11.arrayMap;
var getPlugin = ($__plugins__ = _dereq_("plugins"), $__plugins__ && $__plugins__.__esModule && $__plugins__ || {default: $__plugins__}).getPlugin;
var getRenderer = ($__renderers__ = _dereq_("renderers"), $__renderers__ && $__renderers__.__esModule && $__renderers__ || {default: $__renderers__}).getRenderer;
var randomString = ($__helpers_47_string__ = _dereq_("helpers/string"), $__helpers_47_string__ && $__helpers_47_string__.__esModule && $__helpers_47_string__ || {default: $__helpers_47_string__}).randomString;
var rangeEach = ($__helpers_47_number__ = _dereq_("helpers/number"), $__helpers_47_number__ && $__helpers_47_number__.__esModule && $__helpers_47_number__ || {default: $__helpers_47_number__}).rangeEach;
var TableView = ($__tableView__ = _dereq_("tableView"), $__tableView__ && $__tableView__.__esModule && $__tableView__ || {default: $__tableView__}).TableView;
var DataSource = ($__dataSource__ = _dereq_("dataSource"), $__dataSource__ && $__dataSource__.__esModule && $__dataSource__ || {default: $__dataSource__}).DataSource;
var $__18 = ($__helpers_47_data__ = _dereq_("helpers/data"), $__helpers_47_data__ && $__helpers_47_data__.__esModule && $__helpers_47_data__ || {default: $__helpers_47_data__}),
    translateRowsToColumns = $__18.translateRowsToColumns,
    cellMethodLookupFactory = $__18.cellMethodLookupFactory,
    spreadsheetColumnLabel = $__18.spreadsheetColumnLabel;
var getTranslator = ($__utils_47_recordTranslator__ = _dereq_("utils/recordTranslator"), $__utils_47_recordTranslator__ && $__utils_47_recordTranslator__.__esModule && $__utils_47_recordTranslator__ || {default: $__utils_47_recordTranslator__}).getTranslator;
var WalkontableCellCoords = ($__3rdparty_47_walkontable_47_src_47_cell_47_coords__ = _dereq_("3rdparty/walkontable/src/cell/coords"), $__3rdparty_47_walkontable_47_src_47_cell_47_coords__ && $__3rdparty_47_walkontable_47_src_47_cell_47_coords__.__esModule && $__3rdparty_47_walkontable_47_src_47_cell_47_coords__ || {default: $__3rdparty_47_walkontable_47_src_47_cell_47_coords__}).WalkontableCellCoords;
var WalkontableCellRange = ($__3rdparty_47_walkontable_47_src_47_cell_47_range__ = _dereq_("3rdparty/walkontable/src/cell/range"), $__3rdparty_47_walkontable_47_src_47_cell_47_range__ && $__3rdparty_47_walkontable_47_src_47_cell_47_range__.__esModule && $__3rdparty_47_walkontable_47_src_47_cell_47_range__ || {default: $__3rdparty_47_walkontable_47_src_47_cell_47_range__}).WalkontableCellRange;
var WalkontableViewportColumnsCalculator = ($__3rdparty_47_walkontable_47_src_47_calculator_47_viewportColumns__ = _dereq_("3rdparty/walkontable/src/calculator/viewportColumns"), $__3rdparty_47_walkontable_47_src_47_calculator_47_viewportColumns__ && $__3rdparty_47_walkontable_47_src_47_calculator_47_viewportColumns__.__esModule && $__3rdparty_47_walkontable_47_src_47_calculator_47_viewportColumns__ || {default: $__3rdparty_47_walkontable_47_src_47_calculator_47_viewportColumns__}).WalkontableViewportColumnsCalculator;
Handsontable.activeGuid = null;
Handsontable.Core = function Core(rootElement, userSettings) {
  var priv,
      datamap,
      dataSource,
      grid,
      selection,
      editorManager,
      instance = this,
      GridSettings = function() {},
      eventManager = eventManagerObject(instance);
  var recordTranslator = getTranslator(instance);
  extend(GridSettings.prototype, DefaultSettings.prototype);
  extend(GridSettings.prototype, userSettings);
  extend(GridSettings.prototype, expandType(userSettings));
  this.rootElement = rootElement;
  this.isHotTableEnv = isChildOfWebComponentTable(this.rootElement);
  Handsontable.eventManager.isHotTableEnv = this.isHotTableEnv;
  this.container = document.createElement('DIV');
  this.renderCall = false;
  rootElement.insertBefore(this.container, rootElement.firstChild);
  this.guid = 'ht_' + randomString();
  dataSource = new DataSource(instance);
  if (!this.rootElement.id || this.rootElement.id.substring(0, 3) === 'ht_') {
    this.rootElement.id = this.guid;
  }
  priv = {
    cellSettings: [],
    columnSettings: [],
    columnsSettingConflicts: ['data', 'width'],
    settings: new GridSettings(),
    selRange: null,
    isPopulated: null,
    scrollable: null,
    firstRun: true
  };
  grid = {
    alter: function(action, index, amount, source, keepEmptyRows) {
      var delta;
      amount = amount || 1;
      function spliceWith(data, index, count, toInject) {
        var valueFactory = (function() {
          var result;
          if (toInject === 'array') {
            result = [];
          } else if (toInject === 'object') {
            result = {};
          }
          return result;
        });
        var spliceArgs = arrayMap(new Array(count), (function() {
          return valueFactory();
        }));
        spliceArgs.unshift(index, 0);
        data.splice.apply(data, spliceArgs);
      }
      switch (action) {
        case 'insert_row':
          var numberOfSourceRows = instance.countSourceRows();
          if (instance.getSettings().maxRows === numberOfSourceRows) {
            return;
          }
          index = (isDefined(index)) ? index : numberOfSourceRows;
          delta = datamap.createRow(index, amount, source);
          spliceWith(priv.cellSettings, index, amount, 'array');
          if (delta) {
            if (selection.isSelected() && priv.selRange.from.row >= index) {
              priv.selRange.from.row = priv.selRange.from.row + delta;
              selection.transformEnd(delta, 0);
            } else {
              selection.refreshBorders();
            }
          }
          break;
        case 'insert_col':
          delta = datamap.createCol(index, amount, source);
          for (var row = 0,
              len = instance.countSourceRows(); row < len; row++) {
            if (priv.cellSettings[row]) {
              spliceWith(priv.cellSettings[row], index, amount);
            }
          }
          if (delta) {
            if (Array.isArray(instance.getSettings().colHeaders)) {
              var spliceArray = [index, 0];
              spliceArray.length += delta;
              Array.prototype.splice.apply(instance.getSettings().colHeaders, spliceArray);
            }
            if (selection.isSelected() && priv.selRange.from.col >= index) {
              priv.selRange.from.col = priv.selRange.from.col + delta;
              selection.transformEnd(0, delta);
            } else {
              selection.refreshBorders();
            }
          }
          break;
        case 'remove_row':
          datamap.removeRow(index, amount, source);
          priv.cellSettings.splice(index, amount);
          var totalRows = instance.countRows();
          var fixedRowsTop = instance.getSettings().fixedRowsTop;
          if (fixedRowsTop >= index + 1) {
            instance.getSettings().fixedRowsTop -= Math.min(amount, fixedRowsTop - index);
          }
          var fixedRowsBottom = instance.getSettings().fixedRowsBottom;
          if (fixedRowsBottom && index >= totalRows - fixedRowsBottom) {
            instance.getSettings().fixedRowsBottom -= Math.min(amount, fixedRowsBottom);
          }
          grid.adjustRowsAndCols();
          selection.refreshBorders();
          break;
        case 'remove_col':
          var logicalColumnIndex = recordTranslator.toPhysicalColumn(index);
          datamap.removeCol(index, amount, source);
          for (var row$__27 = 0,
              len$__28 = instance.countSourceRows(); row$__27 < len$__28; row$__27++) {
            if (priv.cellSettings[row$__27]) {
              priv.cellSettings[row$__27].splice(logicalColumnIndex, amount);
            }
          }
          var fixedColumnsLeft = instance.getSettings().fixedColumnsLeft;
          if (fixedColumnsLeft >= index + 1) {
            instance.getSettings().fixedColumnsLeft -= Math.min(amount, fixedColumnsLeft - index);
          }
          if (Array.isArray(instance.getSettings().colHeaders)) {
            if (typeof logicalColumnIndex == 'undefined') {
              logicalColumnIndex = -1;
            }
            instance.getSettings().colHeaders.splice(logicalColumnIndex, amount);
          }
          grid.adjustRowsAndCols();
          selection.refreshBorders();
          break;
        default:
          throw new Error('There is no such action "' + action + '"');
      }
      if (!keepEmptyRows) {
        grid.adjustRowsAndCols();
      }
    },
    adjustRowsAndCols: function() {
      if (priv.settings.minRows) {
        var rows = instance.countRows();
        if (rows < priv.settings.minRows) {
          for (var r = 0,
              minRows = priv.settings.minRows; r < minRows - rows; r++) {
            datamap.createRow(instance.countRows(), 1, 'auto');
          }
        }
      }
      if (priv.settings.minSpareRows) {
        var emptyRows = instance.countEmptyRows(true);
        if (emptyRows < priv.settings.minSpareRows) {
          for (; emptyRows < priv.settings.minSpareRows && instance.countSourceRows() < priv.settings.maxRows; emptyRows++) {
            datamap.createRow(instance.countRows(), 1, 'auto');
          }
        }
      }
      {
        var emptyCols;
        if (priv.settings.minCols || priv.settings.minSpareCols) {
          emptyCols = instance.countEmptyCols(true);
        }
        if (priv.settings.minCols && !priv.settings.columns && instance.countCols() < priv.settings.minCols) {
          for (; instance.countCols() < priv.settings.minCols; emptyCols++) {
            datamap.createCol(instance.countCols(), 1, 'auto');
          }
        }
        if (priv.settings.minSpareCols && !priv.settings.columns && instance.dataType === 'array' && emptyCols < priv.settings.minSpareCols) {
          for (; emptyCols < priv.settings.minSpareCols && instance.countCols() < priv.settings.maxCols; emptyCols++) {
            datamap.createCol(instance.countCols(), 1, 'auto');
          }
        }
      }
      var rowCount = instance.countRows();
      var colCount = instance.countCols();
      if (rowCount === 0 || colCount === 0) {
        selection.deselect();
      }
      if (selection.isSelected()) {
        var selectionChanged = false;
        var fromRow = priv.selRange.from.row;
        var fromCol = priv.selRange.from.col;
        var toRow = priv.selRange.to.row;
        var toCol = priv.selRange.to.col;
        if (fromRow > rowCount - 1) {
          fromRow = rowCount - 1;
          selectionChanged = true;
          if (toRow > fromRow) {
            toRow = fromRow;
          }
        } else if (toRow > rowCount - 1) {
          toRow = rowCount - 1;
          selectionChanged = true;
          if (fromRow > toRow) {
            fromRow = toRow;
          }
        }
        if (fromCol > colCount - 1) {
          fromCol = colCount - 1;
          selectionChanged = true;
          if (toCol > fromCol) {
            toCol = fromCol;
          }
        } else if (toCol > colCount - 1) {
          toCol = colCount - 1;
          selectionChanged = true;
          if (fromCol > toCol) {
            fromCol = toCol;
          }
        }
        if (selectionChanged) {
          instance.selectCell(fromRow, fromCol, toRow, toCol);
        }
      }
      if (instance.view) {
        instance.view.wt.wtOverlays.adjustElementsSize();
      }
    },
    populateFromArray: function(start, input, end, source, method, direction, deltas) {
      var r,
          rlen,
          c,
          clen,
          setData = [],
          current = {};
      rlen = input.length;
      if (rlen === 0) {
        return false;
      }
      var repeatCol,
          repeatRow,
          cmax,
          rmax,
          baseEnd = {
            row: end === null ? null : end.row,
            col: end === null ? null : end.col
          };
      switch (method) {
        case 'shift_down':
          repeatCol = end ? end.col - start.col + 1 : 0;
          repeatRow = end ? end.row - start.row + 1 : 0;
          input = translateRowsToColumns(input);
          for (c = 0, clen = input.length, cmax = Math.max(clen, repeatCol); c < cmax; c++) {
            if (c < clen) {
              for (r = 0, rlen = input[c].length; r < repeatRow - rlen; r++) {
                input[c].push(input[c][r % rlen]);
              }
              input[c].unshift(start.col + c, start.row, 0);
              instance.spliceCol.apply(instance, input[c]);
            } else {
              input[c % clen][0] = start.col + c;
              instance.spliceCol.apply(instance, input[c % clen]);
            }
          }
          break;
        case 'shift_right':
          repeatCol = end ? end.col - start.col + 1 : 0;
          repeatRow = end ? end.row - start.row + 1 : 0;
          for (r = 0, rlen = input.length, rmax = Math.max(rlen, repeatRow); r < rmax; r++) {
            if (r < rlen) {
              for (c = 0, clen = input[r].length; c < repeatCol - clen; c++) {
                input[r].push(input[r][c % clen]);
              }
              input[r].unshift(start.row + r, start.col, 0);
              instance.spliceRow.apply(instance, input[r]);
            } else {
              input[r % rlen][0] = start.row + r;
              instance.spliceRow.apply(instance, input[r % rlen]);
            }
          }
          break;
        case 'overwrite':
        default:
          current.row = start.row;
          current.col = start.col;
          var selected = {
            row: (end && start) ? (end.row - start.row + 1) : 1,
            col: (end && start) ? (end.col - start.col + 1) : 1
          };
          var skippedRow = 0;
          var skippedColumn = 0;
          var pushData = true;
          var cellMeta;
          var getInputValue = function getInputValue(row) {
            var col = arguments[1] !== (void 0) ? arguments[1] : null;
            var rowValue = input[row % input.length];
            if (col !== null) {
              return rowValue[col % rowValue.length];
            }
            return rowValue;
          };
          var rowInputLength = input.length;
          var rowSelectionLength = end ? end.row - start.row + 1 : 0;
          if (end) {
            rlen = rowSelectionLength;
          } else {
            rlen = Math.max(rowInputLength, rowSelectionLength);
          }
          for (r = 0; r < rlen; r++) {
            if ((end && current.row > end.row && rowSelectionLength > rowInputLength) || (!priv.settings.allowInsertRow && current.row > instance.countRows() - 1) || (current.row >= priv.settings.maxRows)) {
              break;
            }
            var logicalRow = r - skippedRow;
            var colInputLength = getInputValue(logicalRow).length;
            var colSelectionLength = end ? end.col - start.col + 1 : 0;
            if (end) {
              clen = colSelectionLength;
            } else {
              clen = Math.max(colInputLength, colSelectionLength);
            }
            current.col = start.col;
            cellMeta = instance.getCellMeta(current.row, current.col);
            if ((source === 'CopyPaste.paste' || source === 'Autofill.autofill') && cellMeta.skipRowOnPaste) {
              skippedRow++;
              current.row++;
              rlen++;
              continue;
            }
            skippedColumn = 0;
            for (c = 0; c < clen; c++) {
              if ((end && current.col > end.col && colSelectionLength > colInputLength) || (!priv.settings.allowInsertColumn && current.col > instance.countCols() - 1) || (current.col >= priv.settings.maxCols)) {
                break;
              }
              cellMeta = instance.getCellMeta(current.row, current.col);
              if ((source === 'CopyPaste.paste' || source === 'Autofill.fill') && cellMeta.skipColumnOnPaste) {
                skippedColumn++;
                current.col++;
                clen++;
                continue;
              }
              if (cellMeta.readOnly) {
                current.col++;
                continue;
              }
              var logicalColumn = c - skippedColumn;
              var value = getInputValue(logicalRow, logicalColumn);
              var orgValue = instance.getDataAtCell(current.row, current.col);
              var index = {
                row: logicalRow,
                col: logicalColumn
              };
              if (source === 'Autofill.fill') {
                var result = instance.runHooks('beforeAutofillInsidePopulate', index, direction, input, deltas, {}, selected);
                if (result) {
                  value = isUndefined(result.value) ? value : result.value;
                }
              }
              if (value !== null && typeof value === 'object') {
                if (orgValue === null || typeof orgValue !== 'object') {
                  pushData = false;
                } else {
                  var orgValueSchema = duckSchema(orgValue[0] || orgValue);
                  var valueSchema = duckSchema(value[0] || value);
                  if (isObjectEquals(orgValueSchema, valueSchema)) {
                    value = deepClone(value);
                  } else {
                    pushData = false;
                  }
                }
              } else if (orgValue !== null && typeof orgValue === 'object') {
                pushData = false;
              }
              if (pushData) {
                setData.push([current.row, current.col, value]);
              }
              pushData = true;
              current.col++;
            }
            current.row++;
          }
          instance.setDataAtCell(setData, null, null, source || 'populateFromArray');
          break;
      }
    }
  };
  this.selection = selection = {
    inProgress: false,
    selectedHeader: {
      cols: false,
      rows: false
    },
    setSelectedHeaders: function() {
      var rows = arguments[0] !== (void 0) ? arguments[0] : false;
      var cols = arguments[1] !== (void 0) ? arguments[1] : false;
      var corner = arguments[2] !== (void 0) ? arguments[2] : false;
      instance.selection.selectedHeader.rows = rows;
      instance.selection.selectedHeader.cols = cols;
      instance.selection.selectedHeader.corner = corner;
    },
    begin: function() {
      instance.selection.inProgress = true;
    },
    finish: function() {
      var sel = instance.getSelected();
      Handsontable.hooks.run(instance, 'afterSelectionEnd', sel[0], sel[1], sel[2], sel[3]);
      Handsontable.hooks.run(instance, 'afterSelectionEndByProp', sel[0], instance.colToProp(sel[1]), sel[2], instance.colToProp(sel[3]));
      instance.selection.inProgress = false;
    },
    isInProgress: function() {
      return instance.selection.inProgress;
    },
    setRangeStart: function(coords, keepEditorOpened) {
      Handsontable.hooks.run(instance, 'beforeSetRangeStart', coords);
      priv.selRange = new WalkontableCellRange(coords, coords, coords);
      selection.setRangeEnd(coords, null, keepEditorOpened);
    },
    setRangeStartOnly: function(coords) {
      Handsontable.hooks.run(instance, 'beforeSetRangeStartOnly', coords);
      priv.selRange = new WalkontableCellRange(coords, coords, coords);
    },
    setRangeEnd: function(coords, scrollToCell, keepEditorOpened) {
      if (priv.selRange === null) {
        return;
      }
      var disableVisualSelection,
          isHeaderSelected = false,
          areCoordsPositive = true;
      var firstVisibleRow = instance.view.wt.wtTable.getFirstVisibleRow();
      var firstVisibleColumn = instance.view.wt.wtTable.getFirstVisibleColumn();
      var newRangeCoords = {
        row: null,
        col: null
      };
      Handsontable.hooks.run(instance, 'beforeSetRangeEnd', coords);
      instance.selection.begin();
      newRangeCoords.row = coords.row < 0 ? firstVisibleRow : coords.row;
      newRangeCoords.col = coords.col < 0 ? firstVisibleColumn : coords.col;
      priv.selRange.to = new WalkontableCellCoords(newRangeCoords.row, newRangeCoords.col);
      if (!priv.settings.multiSelect) {
        priv.selRange.from = coords;
      }
      instance.view.wt.selections.current.clear();
      disableVisualSelection = instance.getCellMeta(priv.selRange.highlight.row, priv.selRange.highlight.col).disableVisualSelection;
      if (typeof disableVisualSelection === 'string') {
        disableVisualSelection = [disableVisualSelection];
      }
      if (disableVisualSelection === false || Array.isArray(disableVisualSelection) && disableVisualSelection.indexOf('current') === -1) {
        instance.view.wt.selections.current.add(priv.selRange.highlight);
      }
      instance.view.wt.selections.area.clear();
      if ((disableVisualSelection === false || Array.isArray(disableVisualSelection) && disableVisualSelection.indexOf('area') === -1) && selection.isMultiple()) {
        instance.view.wt.selections.area.add(priv.selRange.from);
        instance.view.wt.selections.area.add(priv.selRange.to);
      }
      if (priv.settings.currentHeaderClassName || priv.settings.currentRowClassName || priv.settings.currentColClassName) {
        instance.view.wt.selections.highlight.clear();
        instance.view.wt.selections.highlight.add(priv.selRange.from);
        instance.view.wt.selections.highlight.add(priv.selRange.to);
      }
      var preventScrolling = createObjectPropListener('value');
      Handsontable.hooks.run(instance, 'afterSelection', priv.selRange.from.row, priv.selRange.from.col, priv.selRange.to.row, priv.selRange.to.col, preventScrolling);
      Handsontable.hooks.run(instance, 'afterSelectionByProp', priv.selRange.from.row, datamap.colToProp(priv.selRange.from.col), priv.selRange.to.row, datamap.colToProp(priv.selRange.to.col), preventScrolling);
      if ((priv.selRange.from.row === 0 && priv.selRange.to.row === instance.countRows() - 1 && instance.countRows() > 1) || (priv.selRange.from.col === 0 && priv.selRange.to.col === instance.countCols() - 1 && instance.countCols() > 1)) {
        isHeaderSelected = true;
      }
      if (coords.row < 0 || coords.col < 0) {
        areCoordsPositive = false;
      }
      if (preventScrolling.isTouched()) {
        scrollToCell = !preventScrolling.value;
      }
      if (scrollToCell !== false && !isHeaderSelected && areCoordsPositive) {
        if (priv.selRange.from && !selection.isMultiple()) {
          instance.view.scrollViewport(priv.selRange.from);
        } else {
          instance.view.scrollViewport(coords);
        }
      }
      if (selection.selectedHeader.rows && selection.selectedHeader.cols) {
        addClass(instance.rootElement, ['ht__selection--rows', 'ht__selection--columns']);
      } else if (selection.selectedHeader.rows) {
        removeClass(instance.rootElement, 'ht__selection--columns');
        addClass(instance.rootElement, 'ht__selection--rows');
      } else if (selection.selectedHeader.cols) {
        removeClass(instance.rootElement, 'ht__selection--rows');
        addClass(instance.rootElement, 'ht__selection--columns');
      } else {
        removeClass(instance.rootElement, ['ht__selection--rows', 'ht__selection--columns']);
      }
      selection.refreshBorders(null, keepEditorOpened);
    },
    refreshBorders: function(revertOriginal, keepEditor) {
      if (!keepEditor) {
        editorManager.destroyEditor(revertOriginal);
      }
      instance.view.render();
      if (selection.isSelected() && !keepEditor) {
        editorManager.prepareEditor();
      }
    },
    isMultiple: function() {
      var isMultiple = !(priv.selRange.to.col === priv.selRange.from.col && priv.selRange.to.row === priv.selRange.from.row),
          modifier = Handsontable.hooks.run(instance, 'afterIsMultipleSelection', isMultiple);
      if (isMultiple) {
        return modifier;
      }
    },
    transformStart: function(rowDelta, colDelta, force, keepEditorOpened) {
      var delta = new WalkontableCellCoords(rowDelta, colDelta),
          rowTransformDir = 0,
          colTransformDir = 0,
          totalRows,
          totalCols,
          coords,
          fixedRowsBottom;
      instance.runHooks('modifyTransformStart', delta);
      totalRows = instance.countRows();
      totalCols = instance.countCols();
      fixedRowsBottom = instance.getSettings().fixedRowsBottom;
      if (priv.selRange.highlight.row + rowDelta > totalRows - 1) {
        if (force && priv.settings.minSpareRows > 0 && !(fixedRowsBottom && priv.selRange.highlight.row >= totalRows - fixedRowsBottom - 1)) {
          instance.alter('insert_row', totalRows);
          totalRows = instance.countRows();
        } else if (priv.settings.autoWrapCol) {
          delta.row = 1 - totalRows;
          delta.col = priv.selRange.highlight.col + delta.col == totalCols - 1 ? 1 - totalCols : 1;
        }
      } else if (priv.settings.autoWrapCol && priv.selRange.highlight.row + delta.row < 0 && priv.selRange.highlight.col + delta.col >= 0) {
        delta.row = totalRows - 1;
        delta.col = priv.selRange.highlight.col + delta.col == 0 ? totalCols - 1 : -1;
      }
      if (priv.selRange.highlight.col + delta.col > totalCols - 1) {
        if (force && priv.settings.minSpareCols > 0) {
          instance.alter('insert_col', totalCols);
          totalCols = instance.countCols();
        } else if (priv.settings.autoWrapRow) {
          delta.row = priv.selRange.highlight.row + delta.row == totalRows - 1 ? 1 - totalRows : 1;
          delta.col = 1 - totalCols;
        }
      } else if (priv.settings.autoWrapRow && priv.selRange.highlight.col + delta.col < 0 && priv.selRange.highlight.row + delta.row >= 0) {
        delta.row = priv.selRange.highlight.row + delta.row == 0 ? totalRows - 1 : -1;
        delta.col = totalCols - 1;
      }
      coords = new WalkontableCellCoords(priv.selRange.highlight.row + delta.row, priv.selRange.highlight.col + delta.col);
      if (coords.row < 0) {
        rowTransformDir = -1;
        coords.row = 0;
      } else if (coords.row > 0 && coords.row >= totalRows) {
        rowTransformDir = 1;
        coords.row = totalRows - 1;
      }
      if (coords.col < 0) {
        colTransformDir = -1;
        coords.col = 0;
      } else if (coords.col > 0 && coords.col >= totalCols) {
        colTransformDir = 1;
        coords.col = totalCols - 1;
      }
      instance.runHooks('afterModifyTransformStart', coords, rowTransformDir, colTransformDir);
      selection.setRangeStart(coords, keepEditorOpened);
    },
    transformEnd: function(rowDelta, colDelta) {
      var delta = new WalkontableCellCoords(rowDelta, colDelta),
          rowTransformDir = 0,
          colTransformDir = 0,
          totalRows,
          totalCols,
          coords;
      instance.runHooks('modifyTransformEnd', delta);
      totalRows = instance.countRows();
      totalCols = instance.countCols();
      coords = new WalkontableCellCoords(priv.selRange.to.row + delta.row, priv.selRange.to.col + delta.col);
      if (coords.row < 0) {
        rowTransformDir = -1;
        coords.row = 0;
      } else if (coords.row > 0 && coords.row >= totalRows) {
        rowTransformDir = 1;
        coords.row = totalRows - 1;
      }
      if (coords.col < 0) {
        colTransformDir = -1;
        coords.col = 0;
      } else if (coords.col > 0 && coords.col >= totalCols) {
        colTransformDir = 1;
        coords.col = totalCols - 1;
      }
      instance.runHooks('afterModifyTransformEnd', coords, rowTransformDir, colTransformDir);
      selection.setRangeEnd(coords, true);
    },
    isSelected: function() {
      return (priv.selRange !== null);
    },
    inInSelection: function(coords) {
      if (!selection.isSelected()) {
        return false;
      }
      return priv.selRange.includes(coords);
    },
    deselect: function() {
      if (!selection.isSelected()) {
        return;
      }
      instance.selection.inProgress = false;
      priv.selRange = null;
      instance.view.wt.selections.current.clear();
      instance.view.wt.selections.area.clear();
      if (priv.settings.currentHeaderClassName || priv.settings.currentRowClassName || priv.settings.currentColClassName) {
        instance.view.wt.selections.highlight.clear();
      }
      editorManager.destroyEditor();
      selection.refreshBorders();
      removeClass(instance.rootElement, ['ht__selection--rows', 'ht__selection--columns']);
      Handsontable.hooks.run(instance, 'afterDeselect');
    },
    selectAll: function() {
      if (!priv.settings.multiSelect) {
        return;
      }
      selection.setSelectedHeaders(true, true, true);
      selection.setRangeStart(new WalkontableCellCoords(0, 0));
      selection.setRangeEnd(new WalkontableCellCoords(instance.countRows() - 1, instance.countCols() - 1), false);
    },
    empty: function() {
      if (!selection.isSelected()) {
        return;
      }
      var topLeft = priv.selRange.getTopLeftCorner();
      var bottomRight = priv.selRange.getBottomRightCorner();
      var r,
          c,
          changes = [];
      for (r = topLeft.row; r <= bottomRight.row; r++) {
        for (c = topLeft.col; c <= bottomRight.col; c++) {
          if (!instance.getCellMeta(r, c).readOnly) {
            changes.push([r, c, '']);
          }
        }
      }
      instance.setDataAtCell(changes);
    }
  };
  this.init = function() {
    dataSource.setData(priv.settings.data);
    Handsontable.hooks.run(instance, 'beforeInit');
    if (isMobileBrowser()) {
      addClass(instance.rootElement, 'mobile');
    }
    this.updateSettings(priv.settings, true);
    this.view = new TableView(this);
    editorManager = new EditorManager(instance, priv, selection, datamap);
    this.forceFullRender = true;
    Handsontable.hooks.run(instance, 'init');
    this.view.render();
    if (typeof priv.firstRun === 'object') {
      Handsontable.hooks.run(instance, 'afterChange', priv.firstRun[0], priv.firstRun[1]);
      priv.firstRun = false;
    }
    Handsontable.hooks.run(instance, 'afterInit');
  };
  function ValidatorsQueue() {
    var resolved = false;
    return {
      validatorsInQueue: 0,
      valid: true,
      addValidatorToQueue: function() {
        this.validatorsInQueue++;
        resolved = false;
      },
      removeValidatorFormQueue: function() {
        this.validatorsInQueue = this.validatorsInQueue - 1 < 0 ? 0 : this.validatorsInQueue - 1;
        this.checkIfQueueIsEmpty();
      },
      onQueueEmpty: function(valid) {},
      checkIfQueueIsEmpty: function() {
        if (this.validatorsInQueue == 0 && resolved == false) {
          resolved = true;
          this.onQueueEmpty(this.valid);
        }
      }
    };
  }
  function validateChanges(changes, source, callback) {
    var waitingForValidator = new ValidatorsQueue();
    waitingForValidator.onQueueEmpty = resolve;
    for (var i = changes.length - 1; i >= 0; i--) {
      if (changes[i] === null) {
        changes.splice(i, 1);
      } else {
        var row = changes[i][0];
        var col = datamap.propToCol(changes[i][1]);
        var cellProperties = instance.getCellMeta(row, col);
        if (cellProperties.type === 'numeric' && typeof changes[i][3] === 'string') {
          if (changes[i][3].length > 0 && (/^-?[\d\s]*(\.|\,)?\d*$/.test(changes[i][3]) || cellProperties.format)) {
            var len = changes[i][3].length;
            if (isUndefined(cellProperties.language)) {
              numbro.culture('en-US');
            } else if (changes[i][3].indexOf('.') === len - 3 && changes[i][3].indexOf(',') === -1) {
              numbro.culture('en-US');
            } else {
              numbro.culture(cellProperties.language);
            }
            var delimiters = numbro.cultureData(numbro.culture()).delimiters;
            if (numbro.validate(changes[i][3]) && !isNaN(changes[i][3])) {
              changes[i][3] = parseFloat(changes[i][3]);
            } else {
              changes[i][3] = numbro().unformat(changes[i][3]) || changes[i][3];
            }
          }
        }
        if (instance.getCellValidator(cellProperties)) {
          waitingForValidator.addValidatorToQueue();
          instance.validateCell(changes[i][3], cellProperties, (function(i, cellProperties) {
            return function(result) {
              if (typeof result !== 'boolean') {
                throw new Error('Validation error: result is not boolean');
              }
              if (result === false && cellProperties.allowInvalid === false) {
                changes.splice(i, 1);
                cellProperties.valid = true;
                var cell = instance.getCell(cellProperties.row, cellProperties.col);
                removeClass(cell, instance.getSettings().invalidCellClassName);
                --i;
              }
              waitingForValidator.removeValidatorFormQueue();
            };
          })(i, cellProperties), source);
        }
      }
    }
    waitingForValidator.checkIfQueueIsEmpty();
    function resolve() {
      var beforeChangeResult;
      if (changes.length) {
        beforeChangeResult = Handsontable.hooks.run(instance, 'beforeChange', changes, source);
        if (isFunction(beforeChangeResult)) {
          console.warn('Your beforeChange callback returns a function. It\'s not supported since Handsontable 0.12.1 (and the returned function will not be executed).');
        } else if (beforeChangeResult === false) {
          changes.splice(0, changes.length);
        }
      }
      callback();
    }
  }
  function applyChanges(changes, source) {
    var i = changes.length - 1;
    if (i < 0) {
      return;
    }
    for (; 0 <= i; i--) {
      var skipThisChange = false;
      if (changes[i] === null) {
        changes.splice(i, 1);
        continue;
      }
      if (changes[i][2] == null && changes[i][3] == null) {
        continue;
      }
      if (priv.settings.allowInsertRow) {
        while (changes[i][0] > instance.countRows() - 1) {
          var numberOfCreatedRows = datamap.createRow(void 0, void 0, source);
          if (numberOfCreatedRows === 0) {
            skipThisChange = true;
            break;
          }
        }
      }
      if (skipThisChange) {
        continue;
      }
      if (instance.dataType === 'array' && (!priv.settings.columns || priv.settings.columns.length === 0) && priv.settings.allowInsertColumn) {
        while (datamap.propToCol(changes[i][1]) > instance.countCols() - 1) {
          datamap.createCol(void 0, void 0, source);
        }
      }
      datamap.set(changes[i][0], changes[i][1], changes[i][3]);
    }
    instance.forceFullRender = true;
    grid.adjustRowsAndCols();
    Handsontable.hooks.run(instance, 'beforeChangeRender', changes, source);
    selection.refreshBorders(null, true);
    instance.view.wt.wtOverlays.adjustElementsSize();
    Handsontable.hooks.run(instance, 'afterChange', changes, source || 'edit');
    var activeEditor = instance.getActiveEditor();
    if (activeEditor && isDefined(activeEditor.refreshValue)) {
      activeEditor.refreshValue();
    }
  }
  this.validateCell = function(value, cellProperties, callback, source) {
    var validator = instance.getCellValidator(cellProperties);
    function done(valid) {
      var col = cellProperties.visualCol,
          row = cellProperties.visualRow,
          td = instance.getCell(row, col, true);
      if (td && td.nodeName != 'TH') {
        instance.view.wt.wtSettings.settings.cellRenderer(row, col, td);
      }
      callback(valid);
    }
    if (Object.prototype.toString.call(validator) === '[object RegExp]') {
      validator = (function(validator) {
        return function(value, callback) {
          callback(validator.test(value));
        };
      })(validator);
    }
    if (isFunction(validator)) {
      value = Handsontable.hooks.run(instance, 'beforeValidate', value, cellProperties.visualRow, cellProperties.prop, source);
      instance._registerTimeout(setTimeout(function() {
        validator.call(cellProperties, value, function(valid) {
          valid = Handsontable.hooks.run(instance, 'afterValidate', valid, value, cellProperties.visualRow, cellProperties.prop, source);
          cellProperties.valid = valid;
          done(valid);
          Handsontable.hooks.run(instance, 'postAfterValidate', valid, value, cellProperties.visualRow, cellProperties.prop, source);
        });
      }, 0));
    } else {
      instance._registerTimeout(setTimeout(function() {
        cellProperties.valid = true;
        done(cellProperties.valid);
      }, 0));
    }
  };
  function setDataInputToArray(row, propOrCol, value) {
    if (typeof row === 'object') {
      return row;
    } else {
      return [[row, propOrCol, value]];
    }
  }
  this.setDataAtCell = function(row, col, value, source) {
    var input = setDataInputToArray(row, col, value),
        i,
        ilen,
        changes = [],
        prop;
    for (i = 0, ilen = input.length; i < ilen; i++) {
      if (typeof input[i] !== 'object') {
        throw new Error('Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter');
      }
      if (typeof input[i][1] !== 'number') {
        throw new Error('Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`');
      }
      prop = datamap.colToProp(input[i][1]);
      changes.push([input[i][0], prop, dataSource.getAtCell(recordTranslator.toPhysicalRow(input[i][0]), input[i][1]), input[i][2]]);
    }
    if (!source && typeof row === 'object') {
      source = col;
    }
    instance.runHooks('afterSetDataAtCell', changes, source);
    validateChanges(changes, source, function() {
      applyChanges(changes, source);
    });
  };
  this.setDataAtRowProp = function(row, prop, value, source) {
    var input = setDataInputToArray(row, prop, value),
        i,
        ilen,
        changes = [];
    for (i = 0, ilen = input.length; i < ilen; i++) {
      changes.push([input[i][0], input[i][1], dataSource.getAtCell(recordTranslator.toPhysicalRow(input[i][0]), input[i][1]), input[i][2]]);
    }
    if (!source && typeof row === 'object') {
      source = prop;
    }
    instance.runHooks('afterSetDataAtRowProp', changes, source);
    validateChanges(changes, source, function() {
      applyChanges(changes, source);
    });
  };
  this.listen = function() {
    Handsontable.activeGuid = instance.guid;
  };
  this.unlisten = function() {
    Handsontable.activeGuid = null;
  };
  this.isListening = function() {
    return Handsontable.activeGuid === instance.guid;
  };
  this.destroyEditor = function(revertOriginal) {
    selection.refreshBorders(revertOriginal);
  };
  this.populateFromArray = function(row, col, input, endRow, endCol, source, method, direction, deltas) {
    var c;
    if (!(typeof input === 'object' && typeof input[0] === 'object')) {
      throw new Error('populateFromArray parameter `input` must be an array of arrays');
    }
    c = typeof endRow === 'number' ? new WalkontableCellCoords(endRow, endCol) : null;
    return grid.populateFromArray(new WalkontableCellCoords(row, col), input, c, source, method, direction, deltas);
  };
  this.spliceCol = function(col, index, amount) {
    return datamap.spliceCol.apply(datamap, arguments);
  };
  this.spliceRow = function(row, index, amount) {
    return datamap.spliceRow.apply(datamap, arguments);
  };
  this.getSelected = function() {
    if (selection.isSelected()) {
      return [priv.selRange.from.row, priv.selRange.from.col, priv.selRange.to.row, priv.selRange.to.col];
    }
  };
  this.getSelectedRange = function() {
    if (selection.isSelected()) {
      return priv.selRange;
    }
  };
  this.render = function() {
    if (instance.view) {
      instance.renderCall = true;
      instance.forceFullRender = true;
      selection.refreshBorders(null, true);
    }
  };
  this.loadData = function(data) {
    if (Array.isArray(priv.settings.dataSchema)) {
      instance.dataType = 'array';
    } else if (isFunction(priv.settings.dataSchema)) {
      instance.dataType = 'function';
    } else {
      instance.dataType = 'object';
    }
    if (datamap) {
      datamap.destroy();
    }
    datamap = new DataMap(instance, priv, GridSettings);
    if (typeof data === 'object' && data !== null) {
      if (!(data.push && data.splice)) {
        data = [data];
      }
    } else if (data === null) {
      data = [];
      var row;
      var r = 0;
      var rlen = 0;
      var dataSchema = datamap.getSchema();
      for (r = 0, rlen = priv.settings.startRows; r < rlen; r++) {
        if ((instance.dataType === 'object' || instance.dataType === 'function') && priv.settings.dataSchema) {
          row = deepClone(dataSchema);
          data.push(row);
        } else if (instance.dataType === 'array') {
          row = deepClone(dataSchema[0]);
          data.push(row);
        } else {
          row = [];
          for (var c = 0,
              clen = priv.settings.startCols; c < clen; c++) {
            row.push(null);
          }
          data.push(row);
        }
      }
    } else {
      throw new Error('loadData only accepts array of objects or array of arrays (' + typeof data + ' given)');
    }
    priv.isPopulated = false;
    GridSettings.prototype.data = data;
    if (Array.isArray(data[0])) {
      instance.dataType = 'array';
    }
    datamap.dataSource = data;
    dataSource.data = data;
    dataSource.dataType = instance.dataType;
    dataSource.colToProp = datamap.colToProp.bind(datamap);
    dataSource.propToCol = datamap.propToCol.bind(datamap);
    clearCellSettingCache();
    grid.adjustRowsAndCols();
    Handsontable.hooks.run(instance, 'afterLoadData', priv.firstRun);
    if (priv.firstRun) {
      priv.firstRun = [null, 'loadData'];
    } else {
      Handsontable.hooks.run(instance, 'afterChange', null, 'loadData');
      instance.render();
    }
    priv.isPopulated = true;
    function clearCellSettingCache() {
      priv.cellSettings.length = 0;
    }
  };
  this.getData = function(r, c, r2, c2) {
    if (isUndefined(r)) {
      return datamap.getAll();
    } else {
      return datamap.getRange(new WalkontableCellCoords(r, c), new WalkontableCellCoords(r2, c2), datamap.DESTINATION_RENDERER);
    }
  };
  this.getCopyableText = function(startRow, startCol, endRow, endCol) {
    return datamap.getCopyableText(new WalkontableCellCoords(startRow, startCol), new WalkontableCellCoords(endRow, endCol));
  };
  this.getCopyableData = function(row, column) {
    return datamap.getCopyable(row, datamap.colToProp(column));
  };
  this.getSchema = function() {
    return datamap.getSchema();
  };
  this.updateSettings = function(settings, init) {
    var columnsAsFunc = false;
    var i;
    var j;
    var clen;
    if (isDefined(settings.rows)) {
      throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');
    }
    if (isDefined(settings.cols)) {
      throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');
    }
    for (i in settings) {
      if (i === 'data') {
        continue;
      } else {
        if (Handsontable.hooks.getRegistered().indexOf(i) > -1) {
          if (isFunction(settings[i]) || Array.isArray(settings[i])) {
            settings[i].initialHook = true;
            instance.addHook(i, settings[i]);
          }
        } else {
          if (!init && settings.hasOwnProperty(i)) {
            GridSettings.prototype[i] = settings[i];
          }
        }
      }
    }
    if (settings.data === void 0 && priv.settings.data === void 0) {
      instance.loadData(null);
    } else if (settings.data !== void 0) {
      instance.loadData(settings.data);
    } else if (settings.columns !== void 0) {
      datamap.createMap();
    }
    clen = instance.countCols();
    var columnSetting = settings.columns || GridSettings.prototype.columns;
    if (columnSetting && isFunction(columnSetting)) {
      clen = instance.countSourceCols();
      columnsAsFunc = true;
    }
    if (settings.cell !== void 0 || settings.cells !== void 0 || settings.columns !== void 0) {
      priv.cellSettings.length = 0;
    }
    if (clen > 0) {
      var proto;
      var column;
      for (i = 0, j = 0; i < clen; i++) {
        if (columnsAsFunc && !columnSetting(i)) {
          continue;
        }
        priv.columnSettings[j] = columnFactory(GridSettings, priv.columnsSettingConflicts);
        proto = priv.columnSettings[j].prototype;
        if (columnSetting) {
          if (columnsAsFunc) {
            column = columnSetting(i);
          } else {
            column = columnSetting[j];
          }
          if (column) {
            extend(proto, column);
            extend(proto, expandType(column));
          }
        }
        j++;
      }
    }
    if (isDefined(settings.cell)) {
      for (var key in settings.cell) {
        if (settings.cell.hasOwnProperty(key)) {
          var cell = settings.cell[key];
          instance.setCellMetaObject(cell.row, cell.col, cell);
        }
      }
    }
    Handsontable.hooks.run(instance, 'afterCellMetaReset');
    if (isDefined(settings.className)) {
      if (GridSettings.prototype.className) {
        removeClass(instance.rootElement, GridSettings.prototype.className);
      }
      if (settings.className) {
        addClass(instance.rootElement, settings.className);
      }
    }
    var currentHeight = instance.rootElement.style.height;
    if (currentHeight !== '') {
      currentHeight = parseInt(instance.rootElement.style.height, 10);
    }
    var height = settings.height;
    if (isFunction(height)) {
      height = height();
    }
    if (init) {
      var initialStyle = instance.rootElement.getAttribute('style');
      if (initialStyle) {
        instance.rootElement.setAttribute('data-initialstyle', instance.rootElement.getAttribute('style'));
      }
    }
    if (height === null) {
      var initialStyle$__29 = instance.rootElement.getAttribute('data-initialstyle');
      if (initialStyle$__29 && (initialStyle$__29.indexOf('height') > -1 || initialStyle$__29.indexOf('overflow') > -1)) {
        instance.rootElement.setAttribute('style', initialStyle$__29);
      } else {
        instance.rootElement.style.height = '';
        instance.rootElement.style.overflow = '';
      }
    } else if (height !== void 0) {
      instance.rootElement.style.height = height + 'px';
      instance.rootElement.style.overflow = 'hidden';
    }
    if (typeof settings.width != 'undefined') {
      var width = settings.width;
      if (isFunction(width)) {
        width = width();
      }
      instance.rootElement.style.width = width + 'px';
    }
    if (!init) {
      datamap.clearLengthCache();
      if (instance.view) {
        instance.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked();
      }
      Handsontable.hooks.run(instance, 'afterUpdateSettings');
    }
    grid.adjustRowsAndCols();
    if (instance.view && !priv.firstRun) {
      instance.forceFullRender = true;
      selection.refreshBorders(null, true);
    }
    if (!init && instance.view && (currentHeight === '' || height === '' || height === void 0) && currentHeight !== height) {
      instance.view.wt.wtOverlays.updateMainScrollableElements();
    }
  };
  this.getValue = function() {
    var sel = instance.getSelected();
    if (GridSettings.prototype.getValue) {
      if (isFunction(GridSettings.prototype.getValue)) {
        return GridSettings.prototype.getValue.call(instance);
      } else if (sel) {
        return instance.getData()[sel[0]][GridSettings.prototype.getValue];
      }
    } else if (sel) {
      return instance.getDataAtCell(sel[0], sel[1]);
    }
  };
  function expandType(obj) {
    if (!obj.hasOwnProperty('type')) {
      return;
    }
    var type,
        expandedType = {};
    if (typeof obj.type === 'object') {
      type = obj.type;
    } else if (typeof obj.type === 'string') {
      type = Handsontable.cellTypes[obj.type];
      if (type === void 0) {
        throw new Error('You declared cell type "' + obj.type + '" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');
      }
    }
    for (var i in type) {
      if (type.hasOwnProperty(i) && !obj.hasOwnProperty(i)) {
        expandedType[i] = type[i];
      }
    }
    return expandedType;
  }
  this.getSettings = function() {
    return priv.settings;
  };
  this.clear = function() {
    selection.selectAll();
    selection.empty();
  };
  this.alter = function(action, index, amount, source, keepEmptyRows) {
    grid.alter(action, index, amount, source, keepEmptyRows);
  };
  this.getCell = function(row, col, topmost) {
    return instance.view.getCellAtCoords(new WalkontableCellCoords(row, col), topmost);
  };
  this.getCoords = function(elem) {
    return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable, elem);
  };
  this.colToProp = function(col) {
    return datamap.colToProp(col);
  };
  this.propToCol = function(prop) {
    return datamap.propToCol(prop);
  };
  this.toVisualRow = (function(row) {
    return recordTranslator.toVisualRow(row);
  });
  this.toVisualColumn = (function(column) {
    return recordTranslator.toVisualColumn(column);
  });
  this.toPhysicalRow = (function(row) {
    return recordTranslator.toPhysicalRow(row);
  });
  this.toPhysicalColumn = (function(column) {
    return recordTranslator.toPhysicalColumn(column);
  });
  this.getDataAtCell = function(row, col) {
    return datamap.get(row, datamap.colToProp(col));
  };
  this.getDataAtRowProp = function(row, prop) {
    return datamap.get(row, prop);
  };
  this.getDataAtCol = function(col) {
    var out = [];
    return out.concat.apply(out, datamap.getRange(new WalkontableCellCoords(0, col), new WalkontableCellCoords(priv.settings.data.length - 1, col), datamap.DESTINATION_RENDERER));
  };
  this.getDataAtProp = function(prop) {
    var out = [],
        range;
    range = datamap.getRange(new WalkontableCellCoords(0, datamap.propToCol(prop)), new WalkontableCellCoords(priv.settings.data.length - 1, datamap.propToCol(prop)), datamap.DESTINATION_RENDERER);
    return out.concat.apply(out, range);
  };
  this.getSourceData = function(r, c, r2, c2) {
    var data;
    if (r === void 0) {
      data = dataSource.getData();
    } else {
      data = dataSource.getByRange(new WalkontableCellCoords(r, c), new WalkontableCellCoords(r2, c2));
    }
    return data;
  };
  this.getSourceDataArray = function(r, c, r2, c2) {
    var data;
    if (r === void 0) {
      data = dataSource.getData(true);
    } else {
      data = dataSource.getByRange(new WalkontableCellCoords(r, c), new WalkontableCellCoords(r2, c2), true);
    }
    return data;
  };
  this.getSourceDataAtCol = function(column) {
    return dataSource.getAtColumn(column);
  };
  this.getSourceDataAtRow = function(row) {
    return dataSource.getAtRow(row);
  };
  this.getSourceDataAtCell = function(row, column) {
    return dataSource.getAtCell(row, column);
  };
  this.getDataAtRow = function(row) {
    var data = datamap.getRange(new WalkontableCellCoords(row, 0), new WalkontableCellCoords(row, this.countCols() - 1), datamap.DESTINATION_RENDERER);
    return data[0];
  };
  this.getDataType = function(rowFrom, columnFrom, rowTo, columnTo) {
    var $__23 = this;
    var previousType = null;
    var currentType = null;
    if (rowFrom === void 0) {
      rowFrom = 0;
      rowTo = this.countRows();
      columnFrom = 0;
      columnTo = this.countCols();
    }
    if (rowTo === void 0) {
      rowTo = rowFrom;
    }
    if (columnTo === void 0) {
      columnTo = columnFrom;
    }
    var type = 'mixed';
    rangeEach(Math.min(rowFrom, rowTo), Math.max(rowFrom, rowTo), (function(row) {
      var isTypeEqual = true;
      rangeEach(Math.min(columnFrom, columnTo), Math.max(columnFrom, columnTo), (function(column) {
        var cellType = $__23.getCellMeta(row, column);
        currentType = cellType.type;
        if (previousType) {
          isTypeEqual = previousType === currentType;
        } else {
          previousType = currentType;
        }
        return isTypeEqual;
      }));
      type = isTypeEqual ? currentType : 'mixed';
      return isTypeEqual;
    }));
    return type;
  };
  this.removeCellMeta = function(row, col, key) {
    var cellMeta = instance.getCellMeta(row, col);
    if (cellMeta[key] != undefined) {
      delete priv.cellSettings[row][col][key];
    }
  };
  this.spliceCellsMeta = function(index, deleteAmount) {
    var $__26;
    for (var items = [],
        $__24 = 2; $__24 < arguments.length; $__24++)
      items[$__24 - 2] = arguments[$__24];
    ($__26 = priv.cellSettings).splice.apply($__26, $traceurRuntime.spread([index, deleteAmount], items));
  };
  this.setCellMetaObject = function(row, col, prop) {
    if (typeof prop === 'object') {
      for (var key in prop) {
        if (prop.hasOwnProperty(key)) {
          var value = prop[key];
          this.setCellMeta(row, col, key, value);
        }
      }
    }
  };
  this.setCellMeta = function(row, col, key, val) {
    var $__25;
    ($__25 = recordTranslator.toPhysical(row, col), row = $__25[0], col = $__25[1], $__25);
    if (!priv.cellSettings[row]) {
      priv.cellSettings[row] = [];
    }
    if (!priv.cellSettings[row][col]) {
      priv.cellSettings[row][col] = new priv.columnSettings[col]();
    }
    priv.cellSettings[row][col][key] = val;
    Handsontable.hooks.run(instance, 'afterSetCellMeta', row, col, key, val);
  };
  this.getCellsMeta = function() {
    return arrayFlatten(priv.cellSettings);
  };
  this.getCellMeta = function(row, col) {
    var $__25;
    var prop = datamap.colToProp(col),
        cellProperties;
    var visualRow = row;
    var visualCol = col;
    ($__25 = recordTranslator.toPhysical(row, col), row = $__25[0], col = $__25[1], $__25);
    if (!priv.columnSettings[col]) {
      priv.columnSettings[col] = columnFactory(GridSettings, priv.columnsSettingConflicts);
    }
    if (!priv.cellSettings[row]) {
      priv.cellSettings[row] = [];
    }
    if (!priv.cellSettings[row][col]) {
      priv.cellSettings[row][col] = new priv.columnSettings[col]();
    }
    cellProperties = priv.cellSettings[row][col];
    cellProperties.row = row;
    cellProperties.col = col;
    cellProperties.visualRow = visualRow;
    cellProperties.visualCol = visualCol;
    cellProperties.prop = prop;
    cellProperties.instance = instance;
    Handsontable.hooks.run(instance, 'beforeGetCellMeta', row, col, cellProperties);
    extend(cellProperties, expandType(cellProperties));
    if (cellProperties.cells) {
      var settings = cellProperties.cells.call(cellProperties, row, col, prop);
      if (settings) {
        extend(cellProperties, settings);
        extend(cellProperties, expandType(settings));
      }
    }
    Handsontable.hooks.run(instance, 'afterGetCellMeta', row, col, cellProperties);
    return cellProperties;
  };
  this.getCellMetaAtRow = function(row) {
    return priv.cellSettings[row];
  };
  this.isColumnModificationAllowed = function() {
    return !(instance.dataType === 'object' || instance.getSettings().columns);
  };
  var rendererLookup = cellMethodLookupFactory('renderer');
  this.getCellRenderer = function(row, col) {
    var renderer = rendererLookup.call(this, row, col);
    return getRenderer(renderer);
  };
  this.getCellEditor = cellMethodLookupFactory('editor');
  this.getCellValidator = cellMethodLookupFactory('validator');
  this.validateCells = function(callback) {
    var waitingForValidator = new ValidatorsQueue();
    if (callback) {
      waitingForValidator.onQueueEmpty = callback;
    }
    var i = instance.countRows() - 1;
    while (i >= 0) {
      var j = instance.countCols() - 1;
      while (j >= 0) {
        waitingForValidator.addValidatorToQueue();
        instance.validateCell(instance.getDataAtCell(i, j), instance.getCellMeta(i, j), function(result) {
          if (typeof result !== 'boolean') {
            throw new Error('Validation error: result is not boolean');
          }
          if (result === false) {
            waitingForValidator.valid = false;
          }
          waitingForValidator.removeValidatorFormQueue();
        }, 'validateCells');
        j--;
      }
      i--;
    }
    waitingForValidator.checkIfQueueIsEmpty();
  };
  this.getRowHeader = function(row) {
    var rowHeader = priv.settings.rowHeaders;
    if (row !== void 0) {
      row = Handsontable.hooks.run(instance, 'modifyRowHeader', row);
    }
    if (row === void 0) {
      rowHeader = [];
      rangeEach(instance.countRows() - 1, (function(i) {
        rowHeader.push(instance.getRowHeader(i));
      }));
    } else if (Array.isArray(rowHeader) && rowHeader[row] !== void 0) {
      rowHeader = rowHeader[row];
    } else if (isFunction(rowHeader)) {
      rowHeader = rowHeader(row);
    } else if (rowHeader && typeof rowHeader !== 'string' && typeof rowHeader !== 'number') {
      rowHeader = row + 1;
    }
    return rowHeader;
  };
  this.hasRowHeaders = function() {
    return !!priv.settings.rowHeaders;
  };
  this.hasColHeaders = function() {
    if (priv.settings.colHeaders !== void 0 && priv.settings.colHeaders !== null) {
      return !!priv.settings.colHeaders;
    }
    for (var i = 0,
        ilen = instance.countCols(); i < ilen; i++) {
      if (instance.getColHeader(i)) {
        return true;
      }
    }
    return false;
  };
  this.getColHeader = function(col) {
    var columnsAsFunc = priv.settings.columns && isFunction(priv.settings.columns);
    var result = priv.settings.colHeaders;
    col = Handsontable.hooks.run(instance, 'modifyColHeader', col);
    if (col === void 0) {
      var out = [];
      var ilen = columnsAsFunc ? instance.countSourceCols() : instance.countCols();
      for (var i = 0; i < ilen; i++) {
        out.push(instance.getColHeader(i));
      }
      result = out;
    } else {
      var translateVisualIndexToColumns = function(col) {
        var arr = [];
        var columnsLen = instance.countSourceCols();
        var index = 0;
        for (; index < columnsLen; index++) {
          if (isFunction(instance.getSettings().columns) && instance.getSettings().columns(index)) {
            arr.push(index);
          }
        }
        return arr[col];
      };
      var baseCol = col;
      col = Handsontable.hooks.run(instance, 'modifyCol', col);
      var prop = translateVisualIndexToColumns(col);
      if (priv.settings.columns && isFunction(priv.settings.columns) && priv.settings.columns(prop) && priv.settings.columns(prop).title) {
        result = priv.settings.columns(prop).title;
      } else if (priv.settings.columns && priv.settings.columns[col] && priv.settings.columns[col].title) {
        result = priv.settings.columns[col].title;
      } else if (Array.isArray(priv.settings.colHeaders) && priv.settings.colHeaders[col] !== void 0) {
        result = priv.settings.colHeaders[col];
      } else if (isFunction(priv.settings.colHeaders)) {
        result = priv.settings.colHeaders(col);
      } else if (priv.settings.colHeaders && typeof priv.settings.colHeaders !== 'string' && typeof priv.settings.colHeaders !== 'number') {
        result = spreadsheetColumnLabel(baseCol);
      }
    }
    return result;
  };
  this._getColWidthFromSettings = function(col) {
    var cellProperties = instance.getCellMeta(0, col);
    var width = cellProperties.width;
    if (width === void 0 || width === priv.settings.width) {
      width = cellProperties.colWidths;
    }
    if (width !== void 0 && width !== null) {
      switch (typeof width) {
        case 'object':
          width = width[col];
          break;
        case 'function':
          width = width(col);
          break;
      }
      if (typeof width === 'string') {
        width = parseInt(width, 10);
      }
    }
    return width;
  };
  this.getColWidth = function(col) {
    var width = instance._getColWidthFromSettings(col);
    width = Handsontable.hooks.run(instance, 'modifyColWidth', width, col);
    if (width === void 0) {
      width = WalkontableViewportColumnsCalculator.DEFAULT_WIDTH;
    }
    return width;
  };
  this._getRowHeightFromSettings = function(row) {
    var height = priv.settings.rowHeights;
    if (height !== void 0 && height !== null) {
      switch (typeof height) {
        case 'object':
          height = height[row];
          break;
        case 'function':
          height = height(row);
          break;
      }
      if (typeof height === 'string') {
        height = parseInt(height, 10);
      }
    }
    return height;
  };
  this.getRowHeight = function(row) {
    var height = instance._getRowHeightFromSettings(row);
    height = Handsontable.hooks.run(instance, 'modifyRowHeight', height, row);
    return height;
  };
  this.countSourceRows = function() {
    var sourceLength = Handsontable.hooks.run(instance, 'modifySourceLength');
    return sourceLength || (instance.getSourceData() ? instance.getSourceData().length : 0);
  };
  this.countSourceCols = function() {
    var len = 0;
    var obj = instance.getSourceData() && instance.getSourceData()[0] ? instance.getSourceData()[0] : [];
    if (isObject(obj)) {
      len = deepObjectSize(obj);
    } else {
      len = obj.length || 0;
    }
    return len;
  };
  this.countRows = function() {
    return datamap.getLength();
  };
  this.countCols = function() {
    var dataHasLength = false;
    var dataLen = 0;
    if (instance.dataType === 'array') {
      dataHasLength = priv.settings.data && priv.settings.data[0] && priv.settings.data[0].length;
    }
    if (dataHasLength) {
      dataLen = priv.settings.data[0].length;
    }
    if (priv.settings.columns) {
      var columnsIsFunction = isFunction(priv.settings.columns);
      if (columnsIsFunction) {
        if (instance.dataType === 'array') {
          var columnLen = 0;
          for (var i = 0; i < dataLen; i++) {
            if (priv.settings.columns(i)) {
              columnLen++;
            }
          }
          dataLen = columnLen;
        } else if (instance.dataType === 'object' || instance.dataType === 'function') {
          dataLen = datamap.colToPropCache.length;
        }
      } else {
        dataLen = priv.settings.columns.length;
      }
    } else {
      if (instance.dataType === 'object' || instance.dataType === 'function') {
        dataLen = datamap.colToPropCache.length;
      }
    }
    return dataLen;
  };
  this.rowOffset = function() {
    return instance.view.wt.wtTable.getFirstRenderedRow();
  };
  this.colOffset = function() {
    return instance.view.wt.wtTable.getFirstRenderedColumn();
  };
  this.countRenderedRows = function() {
    return instance.view.wt.drawn ? instance.view.wt.wtTable.getRenderedRowsCount() : -1;
  };
  this.countVisibleRows = function() {
    return instance.view.wt.drawn ? instance.view.wt.wtTable.getVisibleRowsCount() : -1;
  };
  this.countRenderedCols = function() {
    return instance.view.wt.drawn ? instance.view.wt.wtTable.getRenderedColumnsCount() : -1;
  };
  this.countVisibleCols = function() {
    return instance.view.wt.drawn ? instance.view.wt.wtTable.getVisibleColumnsCount() : -1;
  };
  this.countEmptyRows = function(ending) {
    var i = instance.countRows() - 1,
        empty = 0,
        row;
    while (i >= 0) {
      row = Handsontable.hooks.run(this, 'modifyRow', i);
      if (instance.isEmptyRow(row)) {
        empty++;
      } else if (ending) {
        break;
      }
      i--;
    }
    return empty;
  };
  this.countEmptyCols = function(ending) {
    if (instance.countRows() < 1) {
      return 0;
    }
    var i = instance.countCols() - 1,
        empty = 0;
    while (i >= 0) {
      if (instance.isEmptyCol(i)) {
        empty++;
      } else if (ending) {
        break;
      }
      i--;
    }
    return empty;
  };
  this.isEmptyRow = function(row) {
    return priv.settings.isEmptyRow.call(instance, row);
  };
  this.isEmptyCol = function(col) {
    return priv.settings.isEmptyCol.call(instance, col);
  };
  this.selectCell = function(row, col, endRow, endCol, scrollToCell, changeListener) {
    var coords;
    changeListener = isUndefined(changeListener) || changeListener === true;
    if (typeof row !== 'number' || row < 0 || row >= instance.countRows()) {
      return false;
    }
    if (typeof col !== 'number' || col < 0 || col >= instance.countCols()) {
      return false;
    }
    if (isDefined(endRow)) {
      if (typeof endRow !== 'number' || endRow < 0 || endRow >= instance.countRows()) {
        return false;
      }
      if (typeof endCol !== 'number' || endCol < 0 || endCol >= instance.countCols()) {
        return false;
      }
    }
    coords = new WalkontableCellCoords(row, col);
    priv.selRange = new WalkontableCellRange(coords, coords, coords);
    if (changeListener) {
      instance.listen();
    }
    if (isUndefined(endRow)) {
      selection.setRangeEnd(priv.selRange.from, scrollToCell);
    } else {
      selection.setRangeEnd(new WalkontableCellCoords(endRow, endCol), scrollToCell);
    }
    instance.selection.finish();
    return true;
  };
  this.selectCellByProp = function(row, prop, endRow, endProp, scrollToCell) {
    arguments[1] = datamap.propToCol(arguments[1]);
    if (isDefined(arguments[3])) {
      arguments[3] = datamap.propToCol(arguments[3]);
    }
    return instance.selectCell.apply(instance, arguments);
  };
  this.deselectCell = function() {
    selection.deselect();
  };
  this.scrollViewportTo = function(row, column) {
    var snapToBottom = arguments[2] !== (void 0) ? arguments[2] : false;
    var snapToRight = arguments[3] !== (void 0) ? arguments[3] : false;
    if (row !== void 0 && (row < 0 || row >= instance.countRows())) {
      return false;
    }
    if (column !== void 0 && (column < 0 || column >= instance.countCols())) {
      return false;
    }
    var result = false;
    if (row !== void 0 && column !== void 0) {
      instance.view.wt.wtOverlays.topOverlay.scrollTo(row, snapToBottom);
      instance.view.wt.wtOverlays.leftOverlay.scrollTo(column, snapToRight);
      result = true;
    }
    if (typeof row === 'number' && typeof column !== 'number') {
      instance.view.wt.wtOverlays.topOverlay.scrollTo(row, snapToBottom);
      result = true;
    }
    if (typeof column === 'number' && typeof row !== 'number') {
      instance.view.wt.wtOverlays.leftOverlay.scrollTo(column, snapToRight);
      result = true;
    }
    return result;
  };
  this.destroy = function() {
    instance._clearTimeouts();
    if (instance.view) {
      instance.view.destroy();
    }
    if (dataSource) {
      dataSource.destroy();
    }
    dataSource = null;
    empty(instance.rootElement);
    eventManager.destroy();
    Handsontable.hooks.run(instance, 'afterDestroy');
    Handsontable.hooks.destroy(instance);
    for (var i in instance) {
      if (instance.hasOwnProperty(i)) {
        if (isFunction(instance[i])) {
          instance[i] = postMortem;
        } else if (i !== 'guid') {
          instance[i] = null;
        }
      }
    }
    if (datamap) {
      datamap.destroy();
    }
    datamap = null;
    priv = null;
    grid = null;
    selection = null;
    editorManager = null;
    instance = null;
    GridSettings = null;
  };
  function postMortem() {
    throw new Error('This method cannot be called because this Handsontable instance has been destroyed');
  }
  this.getActiveEditor = function() {
    return editorManager.getActiveEditor();
  };
  this.getPlugin = function(pluginName) {
    return getPlugin(this, pluginName);
  };
  this.getInstance = function() {
    return instance;
  };
  this.addHook = function(key, callback) {
    Handsontable.hooks.add(key, callback, instance);
  };
  this.hasHook = function(key) {
    return Handsontable.hooks.has(key, instance);
  };
  this.addHookOnce = function(key, callback) {
    Handsontable.hooks.once(key, callback, instance);
  };
  this.removeHook = function(key, callback) {
    Handsontable.hooks.remove(key, callback, instance);
  };
  this.runHooks = function(key, p1, p2, p3, p4, p5, p6) {
    return Handsontable.hooks.run(instance, key, p1, p2, p3, p4, p5, p6);
  };
  this.timeouts = [];
  this._registerTimeout = function(handle) {
    this.timeouts.push(handle);
  };
  this._clearTimeouts = function() {
    for (var i = 0,
        ilen = this.timeouts.length; i < ilen; i++) {
      clearTimeout(this.timeouts[i]);
    }
  };
  this.version = Handsontable.version;
  Handsontable.hooks.run(instance, 'construct');
};
var DefaultSettings = function() {};
DefaultSettings.prototype = {
  data: void 0,
  dataSchema: void 0,
  width: void 0,
  height: void 0,
  startRows: 5,
  startCols: 5,
  rowHeaders: void 0,
  colHeaders: null,
  colWidths: void 0,
  rowHeights: void 0,
  columns: void 0,
  cells: void 0,
  cell: [],
  comments: false,
  customBorders: false,
  minRows: 0,
  minCols: 0,
  maxRows: Infinity,
  maxCols: Infinity,
  minSpareRows: 0,
  minSpareCols: 0,
  allowInsertRow: true,
  allowInsertColumn: true,
  allowRemoveRow: true,
  allowRemoveColumn: true,
  multiSelect: true,
  fillHandle: true,
  fixedRowsTop: 0,
  fixedRowsBottom: 0,
  fixedColumnsLeft: 0,
  outsideClickDeselects: true,
  enterBeginsEditing: true,
  enterMoves: {
    row: 1,
    col: 0
  },
  tabMoves: {
    row: 0,
    col: 1
  },
  autoWrapRow: false,
  autoWrapCol: false,
  copyRowsLimit: 1000,
  copyColsLimit: 1000,
  pasteMode: 'overwrite',
  persistentState: void 0,
  currentRowClassName: void 0,
  currentColClassName: void 0,
  currentHeaderClassName: 'ht__highlight',
  className: void 0,
  tableClassName: void 0,
  stretchH: 'none',
  isEmptyRow: function(row) {
    var col,
        colLen,
        value,
        meta;
    for (col = 0, colLen = this.countCols(); col < colLen; col++) {
      value = this.getDataAtCell(row, col);
      if (value !== '' && value !== null && isDefined(value)) {
        if (typeof value === 'object') {
          meta = this.getCellMeta(row, col);
          return isObjectEquals(this.getSchema()[meta.prop], value);
        }
        return false;
      }
    }
    return true;
  },
  isEmptyCol: function(col) {
    var row,
        rowLen,
        value;
    for (row = 0, rowLen = this.countRows(); row < rowLen; row++) {
      value = this.getDataAtCell(row, col);
      if (value !== '' && value !== null && isDefined(value)) {
        return false;
      }
    }
    return true;
  },
  observeDOMVisibility: true,
  allowInvalid: true,
  allowEmpty: true,
  invalidCellClassName: 'htInvalid',
  placeholder: false,
  placeholderCellClassName: 'htPlaceholder',
  readOnlyCellClassName: 'htDimmed',
  renderer: void 0,
  commentedCellClassName: 'htCommentCell',
  fragmentSelection: false,
  readOnly: false,
  skipColumnOnPaste: false,
  search: false,
  type: 'text',
  copyable: true,
  editor: void 0,
  autoComplete: void 0,
  visibleRows: 10,
  trimDropdown: true,
  debug: false,
  wordWrap: true,
  noWordWrapClassName: 'htNoWrap',
  contextMenu: void 0,
  contextMenuCopyPaste: void 0,
  copyPaste: void 0,
  undo: void 0,
  columnSorting: void 0,
  manualColumnMove: void 0,
  manualColumnResize: void 0,
  manualRowMove: void 0,
  manualRowResize: void 0,
  mergeCells: false,
  viewportRowRenderingOffset: 'auto',
  viewportColumnRenderingOffset: 'auto',
  validator: void 0,
  disableVisualSelection: false,
  sortIndicator: void 0,
  manualColumnFreeze: void 0,
  trimWhitespace: true,
  settings: void 0,
  source: void 0,
  title: void 0,
  checkedTemplate: void 0,
  uncheckedTemplate: void 0,
  label: void 0,
  format: void 0,
  language: void 0,
  selectOptions: void 0,
  autoColumnSize: void 0,
  autoRowSize: void 0,
  dateFormat: void 0,
  correctFormat: false,
  defaultDate: void 0,
  strict: void 0,
  allowHtml: false,
  renderAllRows: void 0,
  preventOverflow: false,
  bindRowsWithHeaders: void 0,
  collapsibleColumns: void 0,
  columnSummary: void 0,
  dropdownMenu: void 0,
  filters: void 0,
  formulas: void 0,
  ganttChart: void 0,
  headerTooltips: void 0,
  hiddenColumns: void 0,
  hiddenRows: void 0,
  nestedHeaders: void 0,
  trimRows: void 0,
  rowHeaderWidth: void 0,
  columnHeaderHeight: void 0,
  observeChanges: void 0,
  sortFunction: void 0,
  sortByRelevance: true,
  filter: true,
  filteringCaseSensitive: false
};
Handsontable.DefaultSettings = DefaultSettings;

//# 
},{"3rdparty/walkontable/src/calculator/viewportColumns":4,"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/cell/range":7,"browser":24,"dataMap":27,"dataSource":28,"editorManager":29,"eventManager":42,"helpers/array":43,"helpers/browser":44,"helpers/data":45,"helpers/dom/element":47,"helpers/function":50,"helpers/mixed":51,"helpers/number":52,"helpers/object":53,"helpers/setting":54,"helpers/string":55,"numbro":"numbro","plugins":61,"renderers":117,"tableView":126,"utils/recordTranslator":130}],27:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  DataMap: {get: function() {
      return DataMap;
    }},
  __esModule: {value: true}
});
var $__browser__,
    $__SheetClip__,
    $__helpers_47_data__,
    $__helpers_47_setting__,
    $__helpers_47_object__,
    $__helpers_47_array__,
    $__utils_47_interval__,
    $__helpers_47_number__,
    $__multiMap__;
var Handsontable = ($__browser__ = _dereq_("browser"), $__browser__ && $__browser__.__esModule && $__browser__ || {default: $__browser__}).default;
var SheetClip = ($__SheetClip__ = _dereq_("SheetClip"), $__SheetClip__ && $__SheetClip__.__esModule && $__SheetClip__ || {default: $__SheetClip__}).default;
var cellMethodLookupFactory = ($__helpers_47_data__ = _dereq_("helpers/data"), $__helpers_47_data__ && $__helpers_47_data__.__esModule && $__helpers_47_data__ || {default: $__helpers_47_data__}).cellMethodLookupFactory;
var columnFactory = ($__helpers_47_setting__ = _dereq_("helpers/setting"), $__helpers_47_setting__ && $__helpers_47_setting__.__esModule && $__helpers_47_setting__ || {default: $__helpers_47_setting__}).columnFactory;
var $__4 = ($__helpers_47_object__ = _dereq_("helpers/object"), $__helpers_47_object__ && $__helpers_47_object__.__esModule && $__helpers_47_object__ || {default: $__helpers_47_object__}),
    createObjectPropListener = $__4.createObjectPropListener,
    duckSchema = $__4.duckSchema,
    deepExtend = $__4.deepExtend,
    deepClone = $__4.deepClone,
    isObject = $__4.isObject,
    deepObjectSize = $__4.deepObjectSize;
var $__5 = ($__helpers_47_array__ = _dereq_("helpers/array"), $__helpers_47_array__ && $__helpers_47_array__.__esModule && $__helpers_47_array__ || {default: $__helpers_47_array__}),
    extendArray = $__5.extendArray,
    to2dArray = $__5.to2dArray;
var Interval = ($__utils_47_interval__ = _dereq_("utils/interval"), $__utils_47_interval__ && $__utils_47_interval__.__esModule && $__utils_47_interval__ || {default: $__utils_47_interval__}).Interval;
var rangeEach = ($__helpers_47_number__ = _dereq_("helpers/number"), $__helpers_47_number__ && $__helpers_47_number__.__esModule && $__helpers_47_number__ || {default: $__helpers_47_number__}).rangeEach;
var MultiMap = ($__multiMap__ = _dereq_("multiMap"), $__multiMap__ && $__multiMap__.__esModule && $__multiMap__ || {default: $__multiMap__}).MultiMap;
function DataMap(instance, priv, GridSettings) {
  var $__9 = this;
  this.instance = instance;
  this.priv = priv;
  this.GridSettings = GridSettings;
  this.dataSource = this.instance.getSettings().data;
  this.cachedLength = null;
  this.skipCache = false;
  this.latestSourceRowsCount = 0;
  if (this.dataSource && this.dataSource[0]) {
    this.duckSchema = this.recursiveDuckSchema(this.dataSource[0]);
  } else {
    this.duckSchema = {};
  }
  this.createMap();
  this.interval = Interval.create((function() {
    return $__9.clearLengthCache();
  }), '15fps');
  this.instance.addHook('skipLengthCache', (function(delay) {
    return $__9.onSkipLengthCache(delay);
  }));
  this.onSkipLengthCache(500);
}
DataMap.prototype.DESTINATION_RENDERER = 1;
DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR = 2;
DataMap.prototype.recursiveDuckSchema = function(object) {
  return duckSchema(object);
};
DataMap.prototype.recursiveDuckColumns = function(schema, lastCol, parent) {
  var prop,
      i;
  if (typeof lastCol === 'undefined') {
    lastCol = 0;
    parent = '';
  }
  if (typeof schema === 'object' && !Array.isArray(schema)) {
    for (i in schema) {
      if (schema.hasOwnProperty(i)) {
        if (schema[i] === null) {
          prop = parent + i;
          this.colToPropCache.push(prop);
          this.propToColCache.set(prop, lastCol);
          lastCol++;
        } else {
          lastCol = this.recursiveDuckColumns(schema[i], lastCol, i + '.');
        }
      }
    }
  }
  return lastCol;
};
DataMap.prototype.createMap = function() {
  var i;
  var schema = this.getSchema();
  if (typeof schema === 'undefined') {
    throw new Error('trying to create `columns` definition but you didn\'t provide `schema` nor `data`');
  }
  this.colToPropCache = [];
  this.propToColCache = new MultiMap();
  var columns = this.instance.getSettings().columns;
  if (columns) {
    var columnsLen = columns.length;
    var filteredIndex = 0;
    var columnsAsFunc = false;
    var schemaLen = deepObjectSize(schema);
    if (typeof columns === 'function') {
      columnsLen = schemaLen > 0 ? schemaLen : this.instance.countSourceCols();
      columnsAsFunc = true;
    }
    for (i = 0; i < columnsLen; i++) {
      var column = columnsAsFunc ? columns(i) : columns[i];
      if (isObject(column)) {
        if (typeof column.data !== 'undefined') {
          var index = columnsAsFunc ? filteredIndex : i;
          this.colToPropCache[index] = column.data;
          this.propToColCache.set(column.data, index);
        }
        filteredIndex++;
      }
    }
  } else {
    this.recursiveDuckColumns(schema);
  }
};
DataMap.prototype.colToProp = function(col) {
  col = Handsontable.hooks.run(this.instance, 'modifyCol', col);
  if (this.colToPropCache && typeof this.colToPropCache[col] !== 'undefined') {
    return this.colToPropCache[col];
  }
  return col;
};
DataMap.prototype.propToCol = function(prop) {
  var col;
  if (typeof this.propToColCache.get(prop) === 'undefined') {
    col = prop;
  } else {
    col = this.propToColCache.get(prop);
  }
  col = Handsontable.hooks.run(this.instance, 'unmodifyCol', col);
  return col;
};
DataMap.prototype.getSchema = function() {
  var schema = this.instance.getSettings().dataSchema;
  if (schema) {
    if (typeof schema === 'function') {
      return schema();
    }
    return schema;
  }
  return this.duckSchema;
};
DataMap.prototype.createRow = function(index, amount, source) {
  var row,
      colCount = this.instance.countCols(),
      numberOfCreatedRows = 0,
      currentIndex;
  if (!amount) {
    amount = 1;
  }
  if (typeof index !== 'number' || index >= this.instance.countSourceRows()) {
    index = this.instance.countSourceRows();
  }
  Handsontable.hooks.run(this.instance, 'beforeCreateRow', index, amount, source);
  currentIndex = index;
  var maxRows = this.instance.getSettings().maxRows;
  while (numberOfCreatedRows < amount && this.instance.countSourceRows() < maxRows) {
    if (this.instance.dataType === 'array') {
      if (this.instance.getSettings().dataSchema) {
        row = deepClone(this.getSchema());
      } else {
        row = [];
        rangeEach(colCount - 1, (function() {
          return row.push(null);
        }));
      }
    } else if (this.instance.dataType === 'function') {
      row = this.instance.getSettings().dataSchema(index);
    } else {
      row = {};
      deepExtend(row, this.getSchema());
    }
    if (index === this.instance.countSourceRows()) {
      this.dataSource.push(row);
    } else {
      this.spliceData(index, 0, row);
    }
    numberOfCreatedRows++;
    currentIndex++;
  }
  Handsontable.hooks.run(this.instance, 'afterCreateRow', index, numberOfCreatedRows, source);
  this.instance.forceFullRender = true;
  return numberOfCreatedRows;
};
DataMap.prototype.createCol = function(index, amount, source) {
  if (!this.instance.isColumnModificationAllowed()) {
    throw new Error('Cannot create new column. When data source in an object, ' + 'you can only have as much columns as defined in first data row, data schema or in the \'columns\' setting.' + 'If you want to be able to add new columns, you have to use array datasource.');
  }
  var rlen = this.instance.countSourceRows(),
      data = this.dataSource,
      constructor,
      numberOfCreatedCols = 0,
      currentIndex;
  if (!amount) {
    amount = 1;
  }
  if (typeof index !== 'number' || index >= this.instance.countCols()) {
    index = this.instance.countCols();
  }
  Handsontable.hooks.run(this.instance, 'beforeCreateCol', index, amount, source);
  currentIndex = index;
  var maxCols = this.instance.getSettings().maxCols;
  while (numberOfCreatedCols < amount && this.instance.countCols() < maxCols) {
    constructor = columnFactory(this.GridSettings, this.priv.columnsSettingConflicts);
    if (typeof index !== 'number' || index >= this.instance.countCols()) {
      if (rlen > 0) {
        for (var r = 0; r < rlen; r++) {
          if (typeof data[r] === 'undefined') {
            data[r] = [];
          }
          data[r].push(null);
        }
      } else {
        data.push([null]);
      }
      this.priv.columnSettings.push(constructor);
    } else {
      for (var r = 0; r < rlen; r++) {
        data[r].splice(currentIndex, 0, null);
      }
      this.priv.columnSettings.splice(currentIndex, 0, constructor);
    }
    numberOfCreatedCols++;
    currentIndex++;
  }
  Handsontable.hooks.run(this.instance, 'afterCreateCol', index, numberOfCreatedCols, source);
  this.instance.forceFullRender = true;
  return numberOfCreatedCols;
};
DataMap.prototype.removeRow = function(index, amount, source) {
  if (!amount) {
    amount = 1;
  }
  if (typeof index !== 'number') {
    index = -amount;
  }
  amount = Handsontable.hooks.run(this.instance, 'modifyRemovedAmount', amount, index);
  index = (this.instance.countSourceRows() + index) % this.instance.countSourceRows();
  var logicRows = this.physicalRowsToLogical(index, amount);
  var actionWasNotCancelled = Handsontable.hooks.run(this.instance, 'beforeRemoveRow', index, amount, logicRows, source);
  if (actionWasNotCancelled === false) {
    return;
  }
  var data = this.dataSource;
  var newData;
  newData = this.filterData(index, amount);
  if (newData) {
    data.length = 0;
    Array.prototype.push.apply(data, newData);
  }
  Handsontable.hooks.run(this.instance, 'afterRemoveRow', index, amount, logicRows, source);
  this.instance.forceFullRender = true;
};
DataMap.prototype.removeCol = function(index, amount, source) {
  if (this.instance.dataType === 'object' || this.instance.getSettings().columns) {
    throw new Error('cannot remove column with object data source or columns option specified');
  }
  if (!amount) {
    amount = 1;
  }
  if (typeof index !== 'number') {
    index = -amount;
  }
  index = (this.instance.countCols() + index) % this.instance.countCols();
  var logicColumns = this.physicalColumnsToLogical(index, amount);
  var descendingLogicColumns = logicColumns.slice(0).sort(function(a, b) {
    return b - a;
  });
  var actionWasNotCancelled = Handsontable.hooks.run(this.instance, 'beforeRemoveCol', index, amount, logicColumns, source);
  if (actionWasNotCancelled === false) {
    return;
  }
  var isTableUniform = true;
  var removedColumnsCount = descendingLogicColumns.length;
  var data = this.dataSource;
  for (var c = 0; c < removedColumnsCount; c++) {
    if (isTableUniform && logicColumns[0] !== logicColumns[c] - c) {
      isTableUniform = false;
    }
  }
  if (isTableUniform) {
    for (var r = 0,
        rlen = this.instance.countSourceRows(); r < rlen; r++) {
      data[r].splice(logicColumns[0], amount);
    }
  } else {
    for (var r$__10 = 0,
        rlen$__11 = this.instance.countSourceRows(); r$__10 < rlen$__11; r$__10++) {
      for (var c$__12 = 0; c$__12 < removedColumnsCount; c$__12++) {
        data[r$__10].splice(descendingLogicColumns[c$__12], 1);
      }
    }
    for (var c$__13 = 0; c$__13 < removedColumnsCount; c$__13++) {
      this.priv.columnSettings.splice(logicColumns[c$__13], 1);
    }
  }
  Handsontable.hooks.run(this.instance, 'afterRemoveCol', index, amount, logicColumns, source);
  this.instance.forceFullRender = true;
};
DataMap.prototype.spliceCol = function(col, index, amount) {
  var elements = 4 <= arguments.length ? [].slice.call(arguments, 3) : [];
  var colData = this.instance.getDataAtCol(col);
  var removed = colData.slice(index, index + amount);
  var after = colData.slice(index + amount);
  extendArray(elements, after);
  var i = 0;
  while (i < amount) {
    elements.push(null);
    i++;
  }
  to2dArray(elements);
  this.instance.populateFromArray(index, col, elements, null, null, 'spliceCol');
  return removed;
};
DataMap.prototype.spliceRow = function(row, index, amount) {
  var elements = 4 <= arguments.length ? [].slice.call(arguments, 3) : [];
  var rowData = this.instance.getSourceDataAtRow(row);
  var removed = rowData.slice(index, index + amount);
  var after = rowData.slice(index + amount);
  extendArray(elements, after);
  var i = 0;
  while (i < amount) {
    elements.push(null);
    i++;
  }
  this.instance.populateFromArray(row, index, [elements], null, null, 'spliceRow');
  return removed;
};
DataMap.prototype.spliceData = function(index, amount, element) {
  var continueSplicing = Handsontable.hooks.run(this.instance, 'beforeDataSplice', index, amount, element);
  if (continueSplicing !== false) {
    this.dataSource.splice(index, amount, element);
  }
};
DataMap.prototype.filterData = function(index, amount) {
  var logicRows = this.physicalRowsToLogical(index, amount);
  var continueSplicing = Handsontable.hooks.run(this.instance, 'beforeDataFilter', index, amount, logicRows);
  if (continueSplicing !== false) {
    var newData = this.dataSource.filter(function(row, index) {
      return logicRows.indexOf(index) == -1;
    });
    return newData;
  }
};
DataMap.prototype.get = function(row, prop) {
  row = Handsontable.hooks.run(this.instance, 'modifyRow', row);
  var dataRow = this.dataSource[row];
  var modifiedRowData = Handsontable.hooks.run(this.instance, 'modifyRowData', row);
  dataRow = isNaN(modifiedRowData) ? modifiedRowData : dataRow;
  var value = null;
  if (dataRow && dataRow.hasOwnProperty && dataRow.hasOwnProperty(prop)) {
    value = dataRow[prop];
  } else if (typeof prop === 'string' && prop.indexOf('.') > -1) {
    var sliced = prop.split('.');
    var out = dataRow;
    if (!out) {
      return null;
    }
    for (var i = 0,
        ilen = sliced.length; i < ilen; i++) {
      out = out[sliced[i]];
      if (typeof out === 'undefined') {
        return null;
      }
    }
    value = out;
  } else if (typeof prop === 'function') {
    value = prop(this.dataSource.slice(row, row + 1)[0]);
  }
  if (Handsontable.hooks.has('modifyData', this.instance)) {
    var valueHolder = createObjectPropListener(value);
    Handsontable.hooks.run(this.instance, 'modifyData', row, this.propToCol(prop), valueHolder, 'get');
    if (valueHolder.isTouched()) {
      value = valueHolder.value;
    }
  }
  return value;
};
var copyableLookup = cellMethodLookupFactory('copyable', false);
DataMap.prototype.getCopyable = function(row, prop) {
  if (copyableLookup.call(this.instance, row, this.propToCol(prop))) {
    return this.get(row, prop);
  }
  return '';
};
DataMap.prototype.set = function(row, prop, value, source) {
  row = Handsontable.hooks.run(this.instance, 'modifyRow', row, source || 'datamapGet');
  var dataRow = this.dataSource[row];
  var modifiedRowData = Handsontable.hooks.run(this.instance, 'modifyRowData', row);
  dataRow = isNaN(modifiedRowData) ? modifiedRowData : dataRow;
  if (Handsontable.hooks.has('modifyData', this.instance)) {
    var valueHolder = createObjectPropListener(value);
    Handsontable.hooks.run(this.instance, 'modifyData', row, this.propToCol(prop), valueHolder, 'set');
    if (valueHolder.isTouched()) {
      value = valueHolder.value;
    }
  }
  if (dataRow && dataRow.hasOwnProperty && dataRow.hasOwnProperty(prop)) {
    dataRow[prop] = value;
  } else if (typeof prop === 'string' && prop.indexOf('.') > -1) {
    var sliced = prop.split('.');
    var out = dataRow;
    for (var i = 0,
        ilen = sliced.length - 1; i < ilen; i++) {
      if (typeof out[sliced[i]] === 'undefined') {
        out[sliced[i]] = {};
      }
      out = out[sliced[i]];
    }
    out[sliced[i]] = value;
  } else if (typeof prop === 'function') {
    prop(this.dataSource.slice(row, row + 1)[0], value);
  } else {
    dataRow[prop] = value;
  }
};
DataMap.prototype.physicalRowsToLogical = function(index, amount) {
  var totalRows = this.instance.countSourceRows();
  var physicRow = (totalRows + index) % totalRows;
  var logicRows = [];
  var rowsToRemove = amount;
  var row;
  while (physicRow < totalRows && rowsToRemove) {
    row = Handsontable.hooks.run(this.instance, 'modifyRow', physicRow);
    logicRows.push(row);
    rowsToRemove--;
    physicRow++;
  }
  return logicRows;
};
DataMap.prototype.physicalColumnsToLogical = function(index, amount) {
  var totalCols = this.instance.countCols();
  var physicalCol = (totalCols + index) % totalCols;
  var logicalCols = [];
  var colsToRemove = amount;
  while (physicalCol < totalCols && colsToRemove) {
    var col = Handsontable.hooks.run(this.instance, 'modifyCol', physicalCol);
    logicalCols.push(col);
    colsToRemove--;
    physicalCol++;
  }
  return logicalCols;
};
DataMap.prototype.clear = function() {
  for (var r = 0; r < this.instance.countSourceRows(); r++) {
    for (var c = 0; c < this.instance.countCols(); c++) {
      this.set(r, this.colToProp(c), '');
    }
  }
};
DataMap.prototype.clearLengthCache = function() {
  this.cachedLength = null;
};
DataMap.prototype.getLength = function() {
  var $__9 = this;
  var maxRows,
      maxRowsFromSettings = this.instance.getSettings().maxRows;
  if (maxRowsFromSettings < 0 || maxRowsFromSettings === 0) {
    maxRows = 0;
  } else {
    maxRows = maxRowsFromSettings || Infinity;
  }
  var length = this.instance.countSourceRows();
  if (Handsontable.hooks.has('modifyRow', this.instance)) {
    var reValidate = this.skipCache;
    this.interval.start();
    if (length !== this.latestSourceRowsCount) {
      reValidate = true;
    }
    this.latestSourceRowsCount = length;
    if (this.cachedLength === null || reValidate) {
      rangeEach(length - 1, (function(row) {
        row = Handsontable.hooks.run($__9.instance, 'modifyRow', row);
        if (row === null) {
          --length;
        }
      }));
      this.cachedLength = length;
    } else {
      length = this.cachedLength;
    }
  } else {
    this.interval.stop();
  }
  return Math.min(length, maxRows);
};
DataMap.prototype.getAll = function() {
  var start = {
    row: 0,
    col: 0
  };
  var maxRows = this.instance.getSettings().maxRows;
  if (maxRows === 0) {
    return [];
  }
  var end = {
    row: Math.min(Math.max(maxRows - 1, 0), Math.max(this.instance.countSourceRows() - 1, 0)),
    col: Math.max(this.instance.countCols() - 1, 0)
  };
  if (start.row - end.row === 0 && !this.instance.countSourceRows()) {
    return [];
  }
  return this.getRange(start, end, DataMap.prototype.DESTINATION_RENDERER);
};
DataMap.prototype.getRange = function(start, end, destination) {
  var r,
      rlen,
      c,
      clen,
      output = [],
      row;
  var getFn = destination === this.DESTINATION_CLIPBOARD_GENERATOR ? this.getCopyable : this.get;
  rlen = Math.max(start.row, end.row);
  clen = Math.max(start.col, end.col);
  for (r = Math.min(start.row, end.row); r <= rlen; r++) {
    row = [];
    var physicalRow = Handsontable.hooks.run(this.instance, 'modifyRow', r);
    for (c = Math.min(start.col, end.col); c <= clen; c++) {
      if (physicalRow === null) {
        break;
      }
      row.push(getFn.call(this, r, this.colToProp(c)));
    }
    if (physicalRow !== null) {
      output.push(row);
    }
  }
  return output;
};
DataMap.prototype.getText = function(start, end) {
  return SheetClip.stringify(this.getRange(start, end, this.DESTINATION_RENDERER));
};
DataMap.prototype.getCopyableText = function(start, end) {
  return SheetClip.stringify(this.getRange(start, end, this.DESTINATION_CLIPBOARD_GENERATOR));
};
DataMap.prototype.onSkipLengthCache = function(delay) {
  var $__9 = this;
  this.skipCache = true;
  setTimeout((function() {
    $__9.skipCache = false;
  }), delay);
};
DataMap.prototype.destroy = function() {
  this.interval.stop();
  this.interval = null;
  this.instance = null;
  this.priv = null;
  this.GridSettings = null;
  this.dataSource = null;
  this.cachedLength = null;
  this.duckSchema = null;
};
;

//# 
},{"SheetClip":"SheetClip","browser":24,"helpers/array":43,"helpers/data":45,"helpers/number":52,"helpers/object":53,"helpers/setting":54,"multiMap":59,"utils/interval":129}],28:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  DataSource: {get: function() {
      return DataSource;
    }},
  __esModule: {value: true}
});
var $__helpers_47_object__,
    $__helpers_47_array__,
    $__helpers_47_number__;
var getProperty = ($__helpers_47_object__ = _dereq_("helpers/object"), $__helpers_47_object__ && $__helpers_47_object__.__esModule && $__helpers_47_object__ || {default: $__helpers_47_object__}).getProperty;
var arrayEach = ($__helpers_47_array__ = _dereq_("helpers/array"), $__helpers_47_array__ && $__helpers_47_array__.__esModule && $__helpers_47_array__ || {default: $__helpers_47_array__}).arrayEach;
var rangeEach = ($__helpers_47_number__ = _dereq_("helpers/number"), $__helpers_47_number__ && $__helpers_47_number__.__esModule && $__helpers_47_number__ || {default: $__helpers_47_number__}).rangeEach;
var DataSource = function DataSource(hotInstance) {
  var dataSource = arguments[1] !== (void 0) ? arguments[1] : [];
  this.hot = hotInstance;
  this.data = dataSource;
  this.dataType = 'array';
  this.colToProp = (function() {});
  this.propToCol = (function() {});
};
($traceurRuntime.createClass)(DataSource, {
  getData: function() {
    var toArray = arguments[0] !== (void 0) ? arguments[0] : false;
    var result = this.data;
    if (toArray) {
      result = this.getByRange({
        row: 0,
        col: 0
      }, {
        row: Math.max(this.countRows() - 1, 0),
        col: Math.max(this.countColumns() - 1, 0)
      }, true);
    }
    return result;
  },
  setData: function(data) {
    this.data = data;
  },
  getAtColumn: function(column) {
    var $__3 = this;
    var result = [];
    arrayEach(this.data, (function(row) {
      var property = $__3.colToProp(column);
      if (typeof property === 'string') {
        row = getProperty(row, property);
      } else {
        row = row[property];
      }
      result.push(row);
    }));
    return result;
  },
  getAtRow: function(row) {
    return this.data[row];
  },
  getAtCell: function(row, column) {
    var result = null;
    var modifyRowData = this.hot.runHooks('modifyRowData', row);
    var dataRow = isNaN(modifyRowData) ? modifyRowData : this.data[row];
    if (dataRow) {
      var prop = this.colToProp(column);
      if (typeof prop === 'string') {
        result = getProperty(dataRow, prop);
      } else if (typeof prop === 'function') {
        result = prop(this.data.slice(row, row + 1)[0]);
      } else {
        result = dataRow[prop];
      }
    }
    return result;
  },
  getByRange: function(start, end) {
    var toArray = arguments[2] !== (void 0) ? arguments[2] : false;
    var $__3 = this;
    var startRow = Math.min(start.row, end.row);
    var startCol = Math.min(start.col, end.col);
    var endRow = Math.max(start.row, end.row);
    var endCol = Math.max(start.col, end.col);
    var result = [];
    rangeEach(startRow, endRow, (function(currentRow) {
      var row = $__3.getAtRow(currentRow);
      var newRow;
      if ($__3.dataType === 'array') {
        newRow = row.slice(startCol, endCol + 1);
      } else if ($__3.dataType === 'object') {
        newRow = toArray ? [] : {};
        rangeEach(startCol, endCol, (function(column) {
          var prop = $__3.colToProp(column);
          if (toArray) {
            newRow.push(row[prop]);
          } else {
            newRow[prop] = row[prop];
          }
        }));
      }
      result.push(newRow);
    }));
    return result;
  },
  countRows: function() {
    return Array.isArray(this.data) ? this.data.length : 0;
  },
  countColumns: function() {
    var result = 0;
    if (Array.isArray(this.data)) {
      if (this.dataType === 'array') {
        result = this.data[0].length;
      } else if (this.dataType === 'object') {
        result = Object.keys(this.data[0]).length;
      }
    }
    return result;
  },
  destroy: function() {
    this.data = null;
    this.hot = null;
  }
}, {});
;

//# 
},{"helpers/array":43,"helpers/number":52,"helpers/object":53}],29:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  EditorManager: {get: function() {
      return EditorManager;
    }},
  __esModule: {value: true}
});
var $__browser__,
    $__3rdparty_47_walkontable_47_src_47_cell_47_coords__,
    $__helpers_47_unicode__,
    $__helpers_47_dom_47_event__,
    $__editors__,
    $__eventManager__;
var Handsontable = ($__browser__ = _dereq_("browser"), $__browser__ && $__browser__.__esModule && $__browser__ || {default: $__browser__}).default;
var WalkontableCellCoords = ($__3rdparty_47_walkontable_47_src_47_cell_47_coords__ = _dereq_("3rdparty/walkontable/src/cell/coords"), $__3rdparty_47_walkontable_47_src_47_cell_47_coords__ && $__3rdparty_47_walkontable_47_src_47_cell_47_coords__.__esModule && $__3rdparty_47_walkontable_47_src_47_cell_47_coords__ || {default: $__3rdparty_47_walkontable_47_src_47_cell_47_coords__}).WalkontableCellCoords;
var $__2 = ($__helpers_47_unicode__ = _dereq_("helpers/unicode"), $__helpers_47_unicode__ && $__helpers_47_unicode__.__esModule && $__helpers_47_unicode__ || {default: $__helpers_47_unicode__}),
    KEY_CODES = $__2.KEY_CODES,
    isMetaKey = $__2.isMetaKey,
    isCtrlKey = $__2.isCtrlKey;
var $__3 = ($__helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $__helpers_47_dom_47_event__ && $__helpers_47_dom_47_event__.__esModule && $__helpers_47_dom_47_event__ || {default: $__helpers_47_dom_47_event__}),
    stopPropagation = $__3.stopPropagation,
    stopImmediatePropagation = $__3.stopImmediatePropagation,
    isImmediatePropagationStopped = $__3.isImmediatePropagationStopped;
var getEditor = ($__editors__ = _dereq_("editors"), $__editors__ && $__editors__.__esModule && $__editors__ || {default: $__editors__}).getEditor;
var eventManagerObject = ($__eventManager__ = _dereq_("eventManager"), $__eventManager__ && $__eventManager__.__esModule && $__eventManager__ || {default: $__eventManager__}).eventManager;
;
Handsontable.EditorManager = EditorManager;
function EditorManager(instance, priv, selection) {
  var _this = this,
      destroyed = false,
      eventManager,
      activeEditor;
  eventManager = eventManagerObject(instance);
  function moveSelectionAfterEnter(shiftKey) {
    selection.setSelectedHeaders(false, false, false);
    var enterMoves = typeof priv.settings.enterMoves === 'function' ? priv.settings.enterMoves(event) : priv.settings.enterMoves;
    if (shiftKey) {
      selection.transformStart(-enterMoves.row, -enterMoves.col);
    } else {
      selection.transformStart(enterMoves.row, enterMoves.col, true);
    }
  }
  function moveSelectionUp(shiftKey) {
    if (shiftKey) {
      if (selection.selectedHeader.cols) {
        selection.setSelectedHeaders(selection.selectedHeader.rows, false, false);
      }
      selection.transformEnd(-1, 0);
    } else {
      selection.setSelectedHeaders(false, false, false);
      selection.transformStart(-1, 0);
    }
  }
  function moveSelectionDown(shiftKey) {
    if (shiftKey) {
      selection.transformEnd(1, 0);
    } else {
      selection.setSelectedHeaders(false, false, false);
      selection.transformStart(1, 0);
    }
  }
  function moveSelectionRight(shiftKey) {
    if (shiftKey) {
      selection.transformEnd(0, 1);
    } else {
      selection.setSelectedHeaders(false, false, false);
      selection.transformStart(0, 1);
    }
  }
  function moveSelectionLeft(shiftKey) {
    if (shiftKey) {
      if (selection.selectedHeader.rows) {
        selection.setSelectedHeaders(false, selection.selectedHeader.cols, false);
      }
      selection.transformEnd(0, -1);
    } else {
      selection.setSelectedHeaders(false, false, false);
      selection.transformStart(0, -1);
    }
  }
  function onKeyDown(event) {
    var ctrlDown,
        rangeModifier;
    if (!instance.isListening()) {
      return;
    }
    Handsontable.hooks.run(instance, 'beforeKeyDown', event);
    if (destroyed) {
      return;
    }
    if (isImmediatePropagationStopped(event)) {
      return;
    }
    priv.lastKeyCode = event.keyCode;
    if (!selection.isSelected()) {
      return;
    }
    ctrlDown = (event.ctrlKey || event.metaKey) && !event.altKey;
    if (activeEditor && !activeEditor.isWaiting()) {
      if (!isMetaKey(event.keyCode) && !isCtrlKey(event.keyCode) && !ctrlDown && !_this.isEditorOpened()) {
        _this.openEditor('', event);
        return;
      }
    }
    rangeModifier = event.shiftKey ? selection.setRangeEnd : selection.setRangeStart;
    switch (event.keyCode) {
      case KEY_CODES.A:
        if (!_this.isEditorOpened() && ctrlDown) {
          selection.selectAll();
          event.preventDefault();
          stopPropagation(event);
        }
        break;
      case KEY_CODES.ARROW_UP:
        if (_this.isEditorOpened() && !activeEditor.isWaiting()) {
          _this.closeEditorAndSaveChanges(ctrlDown);
        }
        moveSelectionUp(event.shiftKey);
        event.preventDefault();
        stopPropagation(event);
        break;
      case KEY_CODES.ARROW_DOWN:
        if (_this.isEditorOpened() && !activeEditor.isWaiting()) {
          _this.closeEditorAndSaveChanges(ctrlDown);
        }
        moveSelectionDown(event.shiftKey);
        event.preventDefault();
        stopPropagation(event);
        break;
      case KEY_CODES.ARROW_RIGHT:
        if (_this.isEditorOpened() && !activeEditor.isWaiting()) {
          _this.closeEditorAndSaveChanges(ctrlDown);
        }
        moveSelectionRight(event.shiftKey);
        event.preventDefault();
        stopPropagation(event);
        break;
      case KEY_CODES.ARROW_LEFT:
        if (_this.isEditorOpened() && !activeEditor.isWaiting()) {
          _this.closeEditorAndSaveChanges(ctrlDown);
        }
        moveSelectionLeft(event.shiftKey);
        event.preventDefault();
        stopPropagation(event);
        break;
      case KEY_CODES.TAB:
        selection.setSelectedHeaders(false, false, false);
        var tabMoves = typeof priv.settings.tabMoves === 'function' ? priv.settings.tabMoves(event) : priv.settings.tabMoves;
        if (event.shiftKey) {
          selection.transformStart(-tabMoves.row, -tabMoves.col);
        } else {
          selection.transformStart(tabMoves.row, tabMoves.col, true);
        }
        event.preventDefault();
        stopPropagation(event);
        break;
      case KEY_CODES.BACKSPACE:
      case KEY_CODES.DELETE:
        selection.empty(event);
        _this.prepareEditor();
        event.preventDefault();
        break;
      case KEY_CODES.F2:
        _this.openEditor(null, event);
        if (activeEditor) {
          activeEditor.enableFullEditMode();
        }
        event.preventDefault();
        break;
      case KEY_CODES.ENTER:
        if (_this.isEditorOpened()) {
          if (activeEditor && activeEditor.state !== Handsontable.EditorState.WAITING) {
            _this.closeEditorAndSaveChanges(ctrlDown);
          }
          moveSelectionAfterEnter(event.shiftKey);
        } else {
          if (instance.getSettings().enterBeginsEditing) {
            _this.openEditor(null, event);
            if (activeEditor) {
              activeEditor.enableFullEditMode();
            }
          } else {
            moveSelectionAfterEnter(event.shiftKey);
          }
        }
        event.preventDefault();
        stopImmediatePropagation(event);
        break;
      case KEY_CODES.ESCAPE:
        if (_this.isEditorOpened()) {
          _this.closeEditorAndRestoreOriginalValue(ctrlDown);
        }
        event.preventDefault();
        break;
      case KEY_CODES.HOME:
        selection.setSelectedHeaders(false, false, false);
        if (event.ctrlKey || event.metaKey) {
          rangeModifier(new WalkontableCellCoords(0, priv.selRange.from.col));
        } else {
          rangeModifier(new WalkontableCellCoords(priv.selRange.from.row, 0));
        }
        event.preventDefault();
        stopPropagation(event);
        break;
      case KEY_CODES.END:
        selection.setSelectedHeaders(false, false, false);
        if (event.ctrlKey || event.metaKey) {
          rangeModifier(new WalkontableCellCoords(instance.countRows() - 1, priv.selRange.from.col));
        } else {
          rangeModifier(new WalkontableCellCoords(priv.selRange.from.row, instance.countCols() - 1));
        }
        event.preventDefault();
        stopPropagation(event);
        break;
      case KEY_CODES.PAGE_UP:
        selection.setSelectedHeaders(false, false, false);
        selection.transformStart(-instance.countVisibleRows(), 0);
        event.preventDefault();
        stopPropagation(event);
        break;
      case KEY_CODES.PAGE_DOWN:
        selection.setSelectedHeaders(false, false, false);
        selection.transformStart(instance.countVisibleRows(), 0);
        event.preventDefault();
        stopPropagation(event);
        break;
    }
  }
  function init() {
    instance.addHook('afterDocumentKeyDown', onKeyDown);
    eventManager.addEventListener(document.documentElement, 'keydown', function(event) {
      if (!destroyed) {
        instance.runHooks('afterDocumentKeyDown', event);
      }
    });
    function onDblClick(event, coords, elem) {
      if (elem.nodeName == 'TD') {
        _this.openEditor();
        if (activeEditor) {
          activeEditor.enableFullEditMode();
        }
      }
    }
    instance.view.wt.update('onCellDblClick', onDblClick);
    instance.addHook('afterDestroy', function() {
      destroyed = true;
    });
  }
  this.destroyEditor = function(revertOriginal) {
    this.closeEditor(revertOriginal);
  };
  this.getActiveEditor = function() {
    return activeEditor;
  };
  this.prepareEditor = function() {
    var row,
        col,
        prop,
        td,
        originalValue,
        cellProperties,
        editorClass;
    if (activeEditor && activeEditor.isWaiting()) {
      this.closeEditor(false, false, function(dataSaved) {
        if (dataSaved) {
          _this.prepareEditor();
        }
      });
      return;
    }
    row = priv.selRange.highlight.row;
    col = priv.selRange.highlight.col;
    prop = instance.colToProp(col);
    td = instance.getCell(row, col);
    originalValue = instance.getSourceDataAtCell(instance.runHooks('modifyRow', row), col);
    cellProperties = instance.getCellMeta(row, col);
    editorClass = instance.getCellEditor(cellProperties);
    if (editorClass) {
      activeEditor = Handsontable.editors.getEditor(editorClass, instance);
      activeEditor.prepare(row, col, prop, td, originalValue, cellProperties);
    } else {
      activeEditor = void 0;
    }
  };
  this.isEditorOpened = function() {
    return activeEditor && activeEditor.isOpened();
  };
  this.openEditor = function(initialValue, event) {
    if (activeEditor && !activeEditor.cellProperties.readOnly) {
      activeEditor.beginEditing(initialValue, event);
    } else if (activeEditor && activeEditor.cellProperties.readOnly) {
      if (event && event.keyCode === KEY_CODES.ENTER) {
        moveSelectionAfterEnter();
      }
    }
  };
  this.closeEditor = function(restoreOriginalValue, ctrlDown, callback) {
    if (activeEditor) {
      activeEditor.finishEditing(restoreOriginalValue, ctrlDown, callback);
    } else {
      if (callback) {
        callback(false);
      }
    }
  };
  this.closeEditorAndSaveChanges = function(ctrlDown) {
    return this.closeEditor(false, ctrlDown);
  };
  this.closeEditorAndRestoreOriginalValue = function(ctrlDown) {
    return this.closeEditor(true, ctrlDown);
  };
  init();
}

//# 
},{"3rdparty/walkontable/src/cell/coords":6,"browser":24,"editors":30,"eventManager":42,"helpers/dom/event":48,"helpers/unicode":56}],30:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  registerEditor: {get: function() {
      return registerEditor;
    }},
  getEditor: {get: function() {
      return getEditor;
    }},
  hasEditor: {get: function() {
      return hasEditor;
    }},
  getEditorConstructor: {get: function() {
      return getEditorConstructor;
    }},
  __esModule: {value: true}
});
var $__browser__,
    $__helpers_47_string__;
var Handsontable = ($__browser__ = _dereq_("browser"), $__browser__ && $__browser__.__esModule && $__browser__ || {default: $__browser__}).default;
var toUpperCaseFirst = ($__helpers_47_string__ = _dereq_("helpers/string"), $__helpers_47_string__ && $__helpers_47_string__.__esModule && $__helpers_47_string__ || {default: $__helpers_47_string__}).toUpperCaseFirst;
;
var registeredEditorNames = {},
    registeredEditorClasses = new WeakMap();
Handsontable.editors = Handsontable.editors || {};
Handsontable.editors.registerEditor = registerEditor;
Handsontable.editors.getEditor = getEditor;
function RegisteredEditor(editorClass) {
  var Clazz,
      instances;
  instances = {};
  Clazz = editorClass;
  this.getConstructor = function() {
    return editorClass;
  };
  this.getInstance = function(hotInstance) {
    if (!(hotInstance.guid in instances)) {
      instances[hotInstance.guid] = new Clazz(hotInstance);
    }
    return instances[hotInstance.guid];
  };
  Handsontable.hooks.add('afterDestroy', function() {
    instances = {};
  });
}
function registerEditor(editorName, editorClass) {
  var editor = new RegisteredEditor(editorClass);
  if (typeof editorName === 'string') {
    registeredEditorNames[editorName] = editor;
    Handsontable.editors[toUpperCaseFirst(editorName) + 'Editor'] = editorClass;
  }
  registeredEditorClasses.set(editorClass, editor);
}
function getEditor(editorName, hotInstance) {
  var editor;
  if (typeof editorName == 'function') {
    if (!(registeredEditorClasses.get(editorName))) {
      registerEditor(null, editorName);
    }
    editor = registeredEditorClasses.get(editorName);
  } else if (typeof editorName == 'string') {
    editor = registeredEditorNames[editorName];
  } else {
    throw Error('Only strings and functions can be passed as "editor" parameter ');
  }
  if (!editor) {
    throw Error('No editor registered under name "' + editorName + '"');
  }
  return editor.getInstance(hotInstance);
}
function getEditorConstructor(editorName) {
  var editor;
  if (typeof editorName == 'string') {
    editor = registeredEditorNames[editorName];
  } else {
    throw Error('Only strings and functions can be passed as "editor" parameter ');
  }
  if (!editor) {
    throw Error('No editor registered under name "' + editorName + '"');
  }
  return editor.getConstructor();
}
function hasEditor(editorName) {
  return registeredEditorNames[editorName] ? true : false;
}

//# 
},{"browser":24,"helpers/string":55}],31:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  BaseEditor: {get: function() {
      return BaseEditor;
    }},
  __esModule: {value: true}
});
var $___46__46__47_browser__,
    $___46__46__47_helpers_47_mixed__,
    $___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var stringify = ($___46__46__47_helpers_47_mixed__ = _dereq_("helpers/mixed"), $___46__46__47_helpers_47_mixed__ && $___46__46__47_helpers_47_mixed__.__esModule && $___46__46__47_helpers_47_mixed__ || {default: $___46__46__47_helpers_47_mixed__}).stringify;
var WalkontableCellCoords = ($___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ = _dereq_("3rdparty/walkontable/src/cell/coords"), $___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ && $___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__.__esModule && $___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ || {default: $___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__}).WalkontableCellCoords;
;
Handsontable.editors = Handsontable.editors || {};
Handsontable.editors.BaseEditor = BaseEditor;
Handsontable.EditorState = {
  VIRGIN: 'STATE_VIRGIN',
  EDITING: 'STATE_EDITING',
  WAITING: 'STATE_WAITING',
  FINISHED: 'STATE_FINISHED'
};
function BaseEditor(instance) {
  this.instance = instance;
  this.state = Handsontable.EditorState.VIRGIN;
  this._opened = false;
  this._fullEditMode = false;
  this._closeCallback = null;
  this.init();
}
BaseEditor.prototype._fireCallbacks = function(result) {
  if (this._closeCallback) {
    this._closeCallback(result);
    this._closeCallback = null;
  }
};
BaseEditor.prototype.init = function() {};
BaseEditor.prototype.getValue = function() {
  throw Error('Editor getValue() method unimplemented');
};
BaseEditor.prototype.setValue = function(newValue) {
  throw Error('Editor setValue() method unimplemented');
};
BaseEditor.prototype.open = function() {
  throw Error('Editor open() method unimplemented');
};
BaseEditor.prototype.close = function() {
  throw Error('Editor close() method unimplemented');
};
BaseEditor.prototype.prepare = function(row, col, prop, td, originalValue, cellProperties) {
  this.TD = td;
  this.row = row;
  this.col = col;
  this.prop = prop;
  this.originalValue = originalValue;
  this.cellProperties = cellProperties;
  var invalidActiveElement = !document.activeElement || (document.activeElement && document.activeElement.nodeName === void 0);
  if (this.instance.view.isMouseDown() && document.activeElement && document.activeElement !== document.body && !invalidActiveElement) {
    document.activeElement.blur();
  } else if (invalidActiveElement) {
    document.body.focus();
  }
  this.state = Handsontable.EditorState.VIRGIN;
};
BaseEditor.prototype.extend = function() {
  var baseClass = this.constructor;
  function Editor() {
    baseClass.apply(this, arguments);
  }
  function inherit(Child, Parent) {
    function Bridge() {}
    Bridge.prototype = Parent.prototype;
    Child.prototype = new Bridge();
    Child.prototype.constructor = Child;
    return Child;
  }
  return inherit(Editor, baseClass);
};
BaseEditor.prototype.saveValue = function(value, ctrlDown) {
  var selection,
      tmp;
  if (ctrlDown) {
    selection = this.instance.getSelected();
    if (selection[0] > selection[2]) {
      tmp = selection[0];
      selection[0] = selection[2];
      selection[2] = tmp;
    }
    if (selection[1] > selection[3]) {
      tmp = selection[1];
      selection[1] = selection[3];
      selection[3] = tmp;
    }
  } else {
    selection = [this.row, this.col, null, null];
  }
  this.instance.populateFromArray(selection[0], selection[1], value, selection[2], selection[3], 'edit');
};
BaseEditor.prototype.beginEditing = function(initialValue, event) {
  if (this.state != Handsontable.EditorState.VIRGIN) {
    return;
  }
  this.instance.view.scrollViewport(new WalkontableCellCoords(this.row, this.col));
  this.instance.view.render();
  this.state = Handsontable.EditorState.EDITING;
  initialValue = typeof initialValue == 'string' ? initialValue : this.originalValue;
  this.setValue(stringify(initialValue));
  this.open(event);
  this._opened = true;
  this.focus();
  this.instance.view.render();
  this.instance.runHooks('afterBeginEditing', this.row, this.col);
};
BaseEditor.prototype.finishEditing = function(restoreOriginalValue, ctrlDown, callback) {
  var _this = this,
      val;
  if (callback) {
    var previousCloseCallback = this._closeCallback;
    this._closeCallback = function(result) {
      if (previousCloseCallback) {
        previousCloseCallback(result);
      }
      callback(result);
      _this.instance.view.render();
    };
  }
  if (this.isWaiting()) {
    return;
  }
  if (this.state == Handsontable.EditorState.VIRGIN) {
    this.instance._registerTimeout(setTimeout(function() {
      _this._fireCallbacks(true);
    }, 0));
    return;
  }
  if (this.state == Handsontable.EditorState.EDITING) {
    if (restoreOriginalValue) {
      this.cancelChanges();
      this.instance.view.render();
      return;
    }
    var value = this.getValue();
    if (this.instance.getSettings().trimWhitespace) {
      val = [[typeof value === 'string' ? String.prototype.trim.call(value || '') : value]];
    } else {
      val = [[value]];
    }
    this.state = Handsontable.EditorState.WAITING;
    this.saveValue(val, ctrlDown);
    if (this.instance.getCellValidator(this.cellProperties)) {
      this.instance.addHookOnce('postAfterValidate', function(result) {
        _this.state = Handsontable.EditorState.FINISHED;
        _this.discardEditor(result);
      });
    } else {
      this.state = Handsontable.EditorState.FINISHED;
      this.discardEditor(true);
    }
  }
};
BaseEditor.prototype.cancelChanges = function() {
  this.state = Handsontable.EditorState.FINISHED;
  this.discardEditor();
};
BaseEditor.prototype.discardEditor = function(result) {
  if (this.state !== Handsontable.EditorState.FINISHED) {
    return;
  }
  if (result === false && this.cellProperties.allowInvalid !== true) {
    this.instance.selectCell(this.row, this.col);
    this.focus();
    this.state = Handsontable.EditorState.EDITING;
    this._fireCallbacks(false);
  } else {
    this.close();
    this._opened = false;
    this._fullEditMode = false;
    this.state = Handsontable.EditorState.VIRGIN;
    this._fireCallbacks(true);
  }
};
BaseEditor.prototype.enableFullEditMode = function() {
  this._fullEditMode = true;
};
BaseEditor.prototype.isInFullEditMode = function() {
  return this._fullEditMode;
};
BaseEditor.prototype.isOpened = function() {
  return this._opened;
};
BaseEditor.prototype.isWaiting = function() {
  return this.state === Handsontable.EditorState.WAITING;
};
BaseEditor.prototype.checkEditorSection = function() {
  var totalRows = this.instance.countRows();
  var section = '';
  if (this.row < this.instance.getSettings().fixedRowsTop) {
    if (this.col < this.instance.getSettings().fixedColumnsLeft) {
      section = 'top-left-corner';
    } else {
      section = 'top';
    }
  } else if (this.instance.getSettings().fixedRowsBottom && this.row >= totalRows - this.instance.getSettings().fixedRowsBottom) {
    if (this.col < this.instance.getSettings().fixedColumnsLeft) {
      section = 'bottom-left-corner';
    } else {
      section = 'bottom';
    }
  } else {
    if (this.col < this.instance.getSettings().fixedColumnsLeft) {
      section = 'left';
    }
  }
  return section;
};

//# 
},{"3rdparty/walkontable/src/cell/coords":6,"browser":24,"helpers/mixed":51}],32:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  AutocompleteEditor: {get: function() {
      return AutocompleteEditor;
    }},
  __esModule: {value: true}
});
var $___46__46__47_helpers_47_unicode__,
    $___46__46__47_helpers_47_mixed__,
    $___46__46__47_helpers_47_string__,
    $___46__46__47_helpers_47_array__,
    $___46__46__47_helpers_47_dom_47_element__,
    $___46__46__47_editors__,
    $__handsontableEditor__;
var $__0 = ($___46__46__47_helpers_47_unicode__ = _dereq_("helpers/unicode"), $___46__46__47_helpers_47_unicode__ && $___46__46__47_helpers_47_unicode__.__esModule && $___46__46__47_helpers_47_unicode__ || {default: $___46__46__47_helpers_47_unicode__}),
    KEY_CODES = $__0.KEY_CODES,
    isPrintableChar = $__0.isPrintableChar;
var stringify = ($___46__46__47_helpers_47_mixed__ = _dereq_("helpers/mixed"), $___46__46__47_helpers_47_mixed__ && $___46__46__47_helpers_47_mixed__.__esModule && $___46__46__47_helpers_47_mixed__ || {default: $___46__46__47_helpers_47_mixed__}).stringify;
var stripTags = ($___46__46__47_helpers_47_string__ = _dereq_("helpers/string"), $___46__46__47_helpers_47_string__ && $___46__46__47_helpers_47_string__.__esModule && $___46__46__47_helpers_47_string__ || {default: $___46__46__47_helpers_47_string__}).stripTags;
var $__3 = ($___46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47_helpers_47_array__ && $___46__46__47_helpers_47_array__.__esModule && $___46__46__47_helpers_47_array__ || {default: $___46__46__47_helpers_47_array__}),
    pivot = $__3.pivot,
    arrayFilter = $__3.arrayFilter,
    arrayMap = $__3.arrayMap;
var $__4 = ($___46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47_helpers_47_dom_47_element__ && $___46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47_helpers_47_dom_47_element__}),
    addClass = $__4.addClass,
    getCaretPosition = $__4.getCaretPosition,
    getScrollbarWidth = $__4.getScrollbarWidth,
    getSelectionEndPosition = $__4.getSelectionEndPosition,
    outerWidth = $__4.outerWidth,
    outerHeight = $__4.outerHeight,
    offset = $__4.offset,
    getTrimmingContainer = $__4.getTrimmingContainer,
    setCaretPosition = $__4.setCaretPosition;
var registerEditor = ($___46__46__47_editors__ = _dereq_("editors"), $___46__46__47_editors__ && $___46__46__47_editors__.__esModule && $___46__46__47_editors__ || {default: $___46__46__47_editors__}).registerEditor;
var HandsontableEditor = ($__handsontableEditor__ = _dereq_("handsontableEditor"), $__handsontableEditor__ && $__handsontableEditor__.__esModule && $__handsontableEditor__ || {default: $__handsontableEditor__}).HandsontableEditor;
var AutocompleteEditor = HandsontableEditor.prototype.extend();
AutocompleteEditor.prototype.init = function() {
  HandsontableEditor.prototype.init.apply(this, arguments);
  this.query = null;
  this.choices = [];
};
AutocompleteEditor.prototype.createElements = function() {
  HandsontableEditor.prototype.createElements.apply(this, arguments);
  addClass(this.htContainer, 'autocompleteEditor');
  addClass(this.htContainer, window.navigator.platform.indexOf('Mac') === -1 ? '' : 'htMacScroll');
};
var skipOne = false;
function onBeforeKeyDown(event) {
  skipOne = false;
  var editor = this.getActiveEditor();
  if (isPrintableChar(event.keyCode) || event.keyCode === KEY_CODES.BACKSPACE || event.keyCode === KEY_CODES.DELETE || event.keyCode === KEY_CODES.INSERT) {
    var timeOffset = 0;
    if (event.keyCode === KEY_CODES.C && (event.ctrlKey || event.metaKey)) {
      return;
    }
    if (!editor.isOpened()) {
      timeOffset += 10;
    }
    if (editor.htEditor) {
      editor.instance._registerTimeout(setTimeout(function() {
        editor.queryChoices(editor.TEXTAREA.value);
        skipOne = true;
      }, timeOffset));
    }
  }
}
AutocompleteEditor.prototype.prepare = function() {
  this.instance.addHook('beforeKeyDown', onBeforeKeyDown);
  HandsontableEditor.prototype.prepare.apply(this, arguments);
};
AutocompleteEditor.prototype.open = function() {
  this.TEXTAREA_PARENT.style.overflow = 'auto';
  HandsontableEditor.prototype.open.apply(this, arguments);
  this.TEXTAREA_PARENT.style.overflow = '';
  var choicesListHot = this.htEditor.getInstance();
  var _this = this;
  var trimDropdown = this.cellProperties.trimDropdown === void 0 ? true : this.cellProperties.trimDropdown;
  this.TEXTAREA.style.visibility = 'visible';
  this.focus();
  choicesListHot.updateSettings({
    colWidths: trimDropdown ? [outerWidth(this.TEXTAREA) - 2] : void 0,
    width: trimDropdown ? outerWidth(this.TEXTAREA) + getScrollbarWidth() + 2 : void 0,
    afterRenderer: function(TD, row, col, prop, value, cellProperties) {
      var $__8 = _this.cellProperties,
          filteringCaseSensitive = $__8.filteringCaseSensitive,
          allowHtml = $__8.allowHtml;
      var indexOfMatch;
      var match;
      value = stringify(value);
      if (value && !allowHtml) {
        indexOfMatch = filteringCaseSensitive === true ? value.indexOf(this.query) : value.toLowerCase().indexOf(_this.query.toLowerCase());
        if (indexOfMatch !== -1) {
          match = value.substr(indexOfMatch, _this.query.length);
          value = value.replace(match, '<strong>' + match + '</strong>');
        }
      }
      TD.innerHTML = value;
    },
    autoColumnSize: true,
    modifyColWidth: function(width, col) {
      var autoWidths = this.getPlugin('autoColumnSize').widths;
      if (autoWidths[col]) {
        width = autoWidths[col];
      }
      return trimDropdown ? width : width + 15;
    }
  });
  this.htEditor.view.wt.wtTable.holder.parentNode.style['padding-right'] = getScrollbarWidth() + 2 + 'px';
  if (skipOne) {
    skipOne = false;
  }
  _this.instance._registerTimeout(setTimeout(function() {
    _this.queryChoices(_this.TEXTAREA.value);
  }, 0));
};
AutocompleteEditor.prototype.close = function() {
  HandsontableEditor.prototype.close.apply(this, arguments);
};
AutocompleteEditor.prototype.queryChoices = function(query) {
  var $__7 = this;
  this.query = query;
  var $__8 = this.cellProperties,
      source = $__8.source,
      filter = $__8.filter,
      filteringCaseSensitive = $__8.filteringCaseSensitive,
      allowHtml = $__8.allowHtml;
  var stripTagsEach = (function(choices) {
    return arrayMap(choices, (function(choice) {
      return stripTags(choice);
    }));
  });
  if (typeof source == 'function') {
    source.call(this.cellProperties, query, (function(choices) {
      $__7.updateChoicesList(allowHtml ? choices : stripTagsEach(choices));
    }));
  } else if (Array.isArray(source)) {
    this.updateChoicesList(allowHtml ? source : stripTagsEach(source));
  } else {
    this.updateChoicesList([]);
  }
};
AutocompleteEditor.prototype.updateChoicesList = function(choices) {
  var pos = getCaretPosition(this.TEXTAREA);
  var endPos = getSelectionEndPosition(this.TEXTAREA);
  var sortByRelevanceSetting = this.cellProperties.sortByRelevance;
  var filterSetting = this.cellProperties.filter;
  var orderByRelevance = null;
  var highlightIndex = null;
  var flipped = null;
  if (sortByRelevanceSetting) {
    orderByRelevance = AutocompleteEditor.sortByRelevance(this.getValue(), choices, this.cellProperties.filteringCaseSensitive);
  }
  var orderByRelevanceLength = Array.isArray(orderByRelevance) ? orderByRelevance.length : 0;
  if (filterSetting === false) {
    if (orderByRelevanceLength) {
      highlightIndex = orderByRelevance[0];
    }
  } else {
    var sorted = [];
    for (var i = 0,
        choicesCount = choices.length; i < choicesCount; i++) {
      if (sortByRelevanceSetting && orderByRelevanceLength <= i) {
        break;
      }
      if (orderByRelevanceLength) {
        sorted.push(choices[orderByRelevance[i]]);
      } else {
        sorted.push(choices[i]);
      }
    }
    highlightIndex = 0;
    choices = sorted;
  }
  this.choices = choices;
  this.htEditor.loadData(pivot([choices]));
  this.updateDropdownHeight();
  this.flipDropdownIfNeeded();
  if (this.cellProperties.strict === true) {
    this.highlightBestMatchingChoice(highlightIndex);
  }
  this.instance.listen();
  this.TEXTAREA.focus();
  setCaretPosition(this.TEXTAREA, pos, (pos === endPos ? void 0 : endPos));
};
AutocompleteEditor.prototype.flipDropdownIfNeeded = function() {
  var textareaOffset = offset(this.TEXTAREA);
  var textareaHeight = outerHeight(this.TEXTAREA);
  var dropdownHeight = this.getDropdownHeight();
  var trimmingContainer = getTrimmingContainer(this.instance.view.wt.wtTable.TABLE);
  var trimmingContainerScrollTop = trimmingContainer.scrollTop;
  var headersHeight = outerHeight(this.instance.view.wt.wtTable.THEAD);
  var containerOffset = {
    row: 0,
    col: 0
  };
  if (trimmingContainer !== window) {
    containerOffset = offset(trimmingContainer);
  }
  var spaceAbove = textareaOffset.top - containerOffset.top - headersHeight + trimmingContainerScrollTop;
  var spaceBelow = trimmingContainer.scrollHeight - spaceAbove - headersHeight - textareaHeight;
  var flipNeeded = dropdownHeight > spaceBelow && spaceAbove > spaceBelow;
  if (flipNeeded) {
    this.flipDropdown(dropdownHeight);
  } else {
    this.unflipDropdown();
  }
  this.limitDropdownIfNeeded(flipNeeded ? spaceAbove : spaceBelow, dropdownHeight);
  return flipNeeded;
};
AutocompleteEditor.prototype.limitDropdownIfNeeded = function(spaceAvailable, dropdownHeight) {
  if (dropdownHeight > spaceAvailable) {
    var tempHeight = 0;
    var i = 0;
    var lastRowHeight = 0;
    var height = null;
    do {
      lastRowHeight = this.htEditor.getRowHeight(i) || this.htEditor.view.wt.wtSettings.settings.defaultRowHeight;
      tempHeight += lastRowHeight;
      i++;
    } while (tempHeight < spaceAvailable);
    height = tempHeight - lastRowHeight;
    if (this.htEditor.flipped) {
      this.htEditor.rootElement.style.top = parseInt(this.htEditor.rootElement.style.top, 10) + dropdownHeight - height + 'px';
    }
    this.setDropdownHeight(tempHeight - lastRowHeight);
  }
};
AutocompleteEditor.prototype.flipDropdown = function(dropdownHeight) {
  var dropdownStyle = this.htEditor.rootElement.style;
  dropdownStyle.position = 'absolute';
  dropdownStyle.top = -dropdownHeight + 'px';
  this.htEditor.flipped = true;
};
AutocompleteEditor.prototype.unflipDropdown = function() {
  var dropdownStyle = this.htEditor.rootElement.style;
  if (dropdownStyle.position === 'absolute') {
    dropdownStyle.position = '';
    dropdownStyle.top = '';
  }
  this.htEditor.flipped = void 0;
};
AutocompleteEditor.prototype.updateDropdownHeight = function() {
  var currentDropdownWidth = this.htEditor.getColWidth(0) + getScrollbarWidth() + 2;
  var trimDropdown = this.cellProperties.trimDropdown;
  this.htEditor.updateSettings({
    height: this.getDropdownHeight(),
    width: trimDropdown ? void 0 : currentDropdownWidth
  });
  this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer();
};
AutocompleteEditor.prototype.setDropdownHeight = function(height) {
  this.htEditor.updateSettings({height: height});
};
AutocompleteEditor.prototype.finishEditing = function(restoreOriginalValue) {
  if (!restoreOriginalValue) {
    this.instance.removeHook('beforeKeyDown', onBeforeKeyDown);
  }
  HandsontableEditor.prototype.finishEditing.apply(this, arguments);
};
AutocompleteEditor.prototype.highlightBestMatchingChoice = function(index) {
  if (typeof index === 'number') {
    this.htEditor.selectCell(index, 0);
  } else {
    this.htEditor.deselectCell();
  }
};
AutocompleteEditor.sortByRelevance = function(value, choices, caseSensitive) {
  var choicesRelevance = [];
  var currentItem;
  var valueLength = value.length;
  var valueIndex;
  var charsLeft;
  var result = [];
  var i;
  var choicesCount = choices.length;
  if (valueLength === 0) {
    for (i = 0; i < choicesCount; i++) {
      result.push(i);
    }
    return result;
  }
  for (i = 0; i < choicesCount; i++) {
    currentItem = stripTags(stringify(choices[i]));
    if (caseSensitive) {
      valueIndex = currentItem.indexOf(value);
    } else {
      valueIndex = currentItem.toLowerCase().indexOf(value.toLowerCase());
    }
    if (valueIndex == -1) {
      continue;
    }
    charsLeft = currentItem.length - valueIndex - valueLength;
    choicesRelevance.push({
      baseIndex: i,
      index: valueIndex,
      charsLeft: charsLeft,
      value: currentItem
    });
  }
  choicesRelevance.sort(function(a, b) {
    if (b.index === -1) {
      return -1;
    }
    if (a.index === -1) {
      return 1;
    }
    if (a.index < b.index) {
      return -1;
    } else if (b.index < a.index) {
      return 1;
    } else if (a.index === b.index) {
      if (a.charsLeft < b.charsLeft) {
        return -1;
      } else if (a.charsLeft > b.charsLeft) {
        return 1;
      } else {
        return 0;
      }
    }
  });
  for (i = 0, choicesCount = choicesRelevance.length; i < choicesCount; i++) {
    result.push(choicesRelevance[i].baseIndex);
  }
  return result;
};
AutocompleteEditor.prototype.getDropdownHeight = function() {
  var firstRowHeight = this.htEditor.getInstance().getRowHeight(0) || 23;
  var visibleRows = this.cellProperties.visibleRows;
  return this.choices.length >= visibleRows ? visibleRows * firstRowHeight : this.choices.length * firstRowHeight + 8;
};
AutocompleteEditor.prototype.allowKeyEventPropagation = function(keyCode) {
  var selected = {row: this.htEditor.getSelectedRange() ? this.htEditor.getSelectedRange().from.row : -1};
  var allowed = false;
  if (keyCode === KEY_CODES.ARROW_DOWN && selected.row > 0 && selected.row < this.htEditor.countRows() - 1) {
    allowed = true;
  }
  if (keyCode === KEY_CODES.ARROW_UP && selected.row > -1) {
    allowed = true;
  }
  return allowed;
};
AutocompleteEditor.prototype.discardEditor = function(result) {
  HandsontableEditor.prototype.discardEditor.apply(this, arguments);
  this.instance.view.render();
};
;
registerEditor('autocomplete', AutocompleteEditor);

//# 
},{"editors":30,"handsontableEditor":36,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,"helpers/string":55,"helpers/unicode":56}],33:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  CheckboxEditor: {get: function() {
      return CheckboxEditor;
    }},
  __esModule: {value: true}
});
var $___46__46__47_editors__,
    $___95_baseEditor__,
    $___46__46__47_helpers_47_dom_47_element__;
var registerEditor = ($___46__46__47_editors__ = _dereq_("editors"), $___46__46__47_editors__ && $___46__46__47_editors__.__esModule && $___46__46__47_editors__ || {default: $___46__46__47_editors__}).registerEditor;
var BaseEditor = ($___95_baseEditor__ = _dereq_("_baseEditor"), $___95_baseEditor__ && $___95_baseEditor__.__esModule && $___95_baseEditor__ || {default: $___95_baseEditor__}).BaseEditor;
var hasClass = ($___46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47_helpers_47_dom_47_element__ && $___46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47_helpers_47_dom_47_element__}).hasClass;
var CheckboxEditor = function CheckboxEditor() {
  $traceurRuntime.superConstructor($CheckboxEditor).apply(this, arguments);
};
var $CheckboxEditor = CheckboxEditor;
($traceurRuntime.createClass)(CheckboxEditor, {
  beginEditing: function(initialValue, event) {
    if (event === void 0) {
      var checkbox = this.TD.querySelector('input[type="checkbox"]');
      if (!hasClass(checkbox, 'htBadValue')) {
        checkbox.click();
      }
    }
  },
  finishEditing: function() {},
  init: function() {},
  open: function() {},
  close: function() {},
  getValue: function() {},
  setValue: function() {},
  focus: function() {}
}, {}, BaseEditor);
;
registerEditor('checkbox', CheckboxEditor);

//# 
},{"_baseEditor":31,"editors":30,"helpers/dom/element":47}],34:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  DateEditor: {get: function() {
      return DateEditor;
    }},
  __esModule: {value: true}
});
var $___46__46__47_browser__,
    $___46__46__47_helpers_47_dom_47_element__,
    $___46__46__47_helpers_47_object__,
    $___46__46__47_eventManager__,
    $___46__46__47_editors__,
    $___46__46__47_helpers_47_unicode__,
    $___46__46__47_helpers_47_dom_47_event__,
    $__textEditor__,
    $__moment__,
    $__pikaday__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var $__1 = ($___46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47_helpers_47_dom_47_element__ && $___46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47_helpers_47_dom_47_element__}),
    addClass = $__1.addClass,
    outerHeight = $__1.outerHeight;
var deepExtend = ($___46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47_helpers_47_object__ && $___46__46__47_helpers_47_object__.__esModule && $___46__46__47_helpers_47_object__ || {default: $___46__46__47_helpers_47_object__}).deepExtend;
var EventManager = ($___46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47_eventManager__ && $___46__46__47_eventManager__.__esModule && $___46__46__47_eventManager__ || {default: $___46__46__47_eventManager__}).EventManager;
var $__4 = ($___46__46__47_editors__ = _dereq_("editors"), $___46__46__47_editors__ && $___46__46__47_editors__.__esModule && $___46__46__47_editors__ || {default: $___46__46__47_editors__}),
    getEditor = $__4.getEditor,
    registerEditor = $__4.registerEditor;
var isMetaKey = ($___46__46__47_helpers_47_unicode__ = _dereq_("helpers/unicode"), $___46__46__47_helpers_47_unicode__ && $___46__46__47_helpers_47_unicode__.__esModule && $___46__46__47_helpers_47_unicode__ || {default: $___46__46__47_helpers_47_unicode__}).isMetaKey;
var stopPropagation = ($___46__46__47_helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $___46__46__47_helpers_47_dom_47_event__ && $___46__46__47_helpers_47_dom_47_event__.__esModule && $___46__46__47_helpers_47_dom_47_event__ || {default: $___46__46__47_helpers_47_dom_47_event__}).stopPropagation;
var TextEditor = ($__textEditor__ = _dereq_("textEditor"), $__textEditor__ && $__textEditor__.__esModule && $__textEditor__ || {default: $__textEditor__}).TextEditor;
var moment = ($__moment__ = _dereq_("moment"), $__moment__ && $__moment__.__esModule && $__moment__ || {default: $__moment__}).default;
var Pikaday = ($__pikaday__ = _dereq_("pikaday"), $__pikaday__ && $__pikaday__.__esModule && $__pikaday__ || {default: $__pikaday__}).default;
var DateEditor = function DateEditor(hotInstance) {
  this.$datePicker = null;
  this.datePicker = null;
  this.datePickerStyle = null;
  this.defaultDateFormat = 'DD/MM/YYYY';
  this.isCellEdited = false;
  this.parentDestroyed = false;
  $traceurRuntime.superConstructor($DateEditor).call(this, hotInstance);
};
var $DateEditor = DateEditor;
($traceurRuntime.createClass)(DateEditor, {
  init: function() {
    var $__10 = this;
    if (typeof moment !== 'function') {
      throw new Error('You need to include moment.js to your project.');
    }
    if (typeof Pikaday !== 'function') {
      throw new Error('You need to include Pikaday to your project.');
    }
    $traceurRuntime.superGet(this, $DateEditor.prototype, "init").call(this);
    this.instance.addHook('afterDestroy', (function() {
      $__10.parentDestroyed = true;
      $__10.destroyElements();
    }));
  },
  createElements: function() {
    $traceurRuntime.superGet(this, $DateEditor.prototype, "createElements").call(this);
    this.datePicker = document.createElement('DIV');
    this.datePickerStyle = this.datePicker.style;
    this.datePickerStyle.position = 'absolute';
    this.datePickerStyle.top = 0;
    this.datePickerStyle.left = 0;
    this.datePickerStyle.zIndex = 9999;
    addClass(this.datePicker, 'htDatepickerHolder');
    document.body.appendChild(this.datePicker);
    this.$datePicker = new Pikaday(this.getDatePickerConfig());
    var eventManager = new EventManager(this);
    eventManager.addEventListener(this.datePicker, 'mousedown', (function(event) {
      return stopPropagation(event);
    }));
    this.hideDatepicker();
  },
  destroyElements: function() {
    this.$datePicker.destroy();
  },
  prepare: function(row, col, prop, td, originalValue, cellProperties) {
    this._opened = false;
    $traceurRuntime.superGet(this, $DateEditor.prototype, "prepare").call(this, row, col, prop, td, originalValue, cellProperties);
  },
  open: function() {
    var event = arguments[0] !== (void 0) ? arguments[0] : null;
    $traceurRuntime.superGet(this, $DateEditor.prototype, "open").call(this);
    this.showDatepicker(event);
  },
  close: function() {
    var $__10 = this;
    this._opened = false;
    this.instance._registerTimeout(setTimeout((function() {
      $__10.instance.selection.refreshBorders();
    }), 0));
    $traceurRuntime.superGet(this, $DateEditor.prototype, "close").call(this);
  },
  finishEditing: function() {
    var isCancelled = arguments[0] !== (void 0) ? arguments[0] : false;
    var ctrlDown = arguments[1] !== (void 0) ? arguments[1] : false;
    if (isCancelled) {
      var value = this.originalValue;
      if (value !== void 0) {
        this.setValue(value);
      }
    }
    this.hideDatepicker();
    $traceurRuntime.superGet(this, $DateEditor.prototype, "finishEditing").call(this, isCancelled, ctrlDown);
  },
  showDatepicker: function(event) {
    this.$datePicker.config(this.getDatePickerConfig());
    var offset = this.TD.getBoundingClientRect();
    var dateFormat = this.cellProperties.dateFormat || this.defaultDateFormat;
    var datePickerConfig = this.$datePicker.config();
    var dateStr;
    var isMouseDown = this.instance.view.isMouseDown();
    var isMeta = event ? isMetaKey(event.keyCode) : false;
    this.datePickerStyle.top = (window.pageYOffset + offset.top + outerHeight(this.TD)) + 'px';
    this.datePickerStyle.left = (window.pageXOffset + offset.left) + 'px';
    this.$datePicker._onInputFocus = function() {};
    datePickerConfig.format = dateFormat;
    if (this.originalValue) {
      dateStr = this.originalValue;
      if (moment(dateStr, dateFormat, true).isValid()) {
        this.$datePicker.setMoment(moment(dateStr, dateFormat), true);
      }
      if (this.getValue() !== this.originalValue) {
        this.setValue(this.originalValue);
      }
      if (!isMeta && !isMouseDown) {
        this.setValue('');
      }
    } else {
      if (this.cellProperties.defaultDate) {
        dateStr = this.cellProperties.defaultDate;
        datePickerConfig.defaultDate = dateStr;
        if (moment(dateStr, dateFormat, true).isValid()) {
          this.$datePicker.setMoment(moment(dateStr, dateFormat), true);
        }
        if (!isMeta && !isMouseDown) {
          this.setValue('');
        }
      } else {
        this.$datePicker.gotoToday();
      }
    }
    this.datePickerStyle.display = 'block';
    this.$datePicker.show();
  },
  hideDatepicker: function() {
    this.datePickerStyle.display = 'none';
    this.$datePicker.hide();
  },
  getDatePickerConfig: function() {
    var $__10 = this;
    var htInput = this.TEXTAREA;
    var options = {};
    if (this.cellProperties && this.cellProperties.datePickerConfig) {
      deepExtend(options, this.cellProperties.datePickerConfig);
    }
    var origOnSelect = options.onSelect;
    var origOnClose = options.onClose;
    options.field = htInput;
    options.trigger = htInput;
    options.container = this.datePicker;
    options.bound = false;
    options.format = options.format || this.defaultDateFormat;
    options.reposition = options.reposition || false;
    options.onSelect = (function(dateStr) {
      if (!isNaN(dateStr.getTime())) {
        dateStr = moment(dateStr).format($__10.cellProperties.dateFormat || $__10.defaultDateFormat);
      }
      $__10.setValue(dateStr);
      $__10.hideDatepicker();
      if (origOnSelect) {
        origOnSelect();
      }
    });
    options.onClose = (function() {
      if (!$__10.parentDestroyed) {
        $__10.finishEditing(false);
      }
      if (origOnClose) {
        origOnClose();
      }
    });
    return options;
  }
}, {}, TextEditor);
;
Handsontable.editors = Handsontable.editors || {};
Handsontable.editors.DateEditor = DateEditor;
registerEditor('date', DateEditor);

//# 
},{"browser":24,"editors":30,"eventManager":42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/object":53,"helpers/unicode":56,"moment":"moment","pikaday":"pikaday","textEditor":41}],35:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  DropdownEditor: {get: function() {
      return DropdownEditor;
    }},
  __esModule: {value: true}
});
var $___46__46__47_browser__,
    $___46__46__47_editors__,
    $__autocompleteEditor__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var $__1 = ($___46__46__47_editors__ = _dereq_("editors"), $___46__46__47_editors__ && $___46__46__47_editors__.__esModule && $___46__46__47_editors__ || {default: $___46__46__47_editors__}),
    getEditor = $__1.getEditor,
    registerEditor = $__1.registerEditor,
    getEditorConstructor = $__1.getEditorConstructor;
var AutocompleteEditor = ($__autocompleteEditor__ = _dereq_("autocompleteEditor"), $__autocompleteEditor__ && $__autocompleteEditor__.__esModule && $__autocompleteEditor__ || {default: $__autocompleteEditor__}).AutocompleteEditor;
var DropdownEditor = function DropdownEditor() {
  $traceurRuntime.superConstructor($DropdownEditor).apply(this, arguments);
};
var $DropdownEditor = DropdownEditor;
($traceurRuntime.createClass)(DropdownEditor, {prepare: function(row, col, prop, td, originalValue, cellProperties) {
    $traceurRuntime.superGet(this, $DropdownEditor.prototype, "prepare").call(this, row, col, prop, td, originalValue, cellProperties);
    this.cellProperties.filter = false;
    this.cellProperties.strict = true;
  }}, {}, AutocompleteEditor);
Handsontable.hooks.add('beforeValidate', function(value, row, col, source) {
  var cellMeta = this.getCellMeta(row, this.propToCol(col));
  if (cellMeta.editor === Handsontable.editors.DropdownEditor) {
    if (cellMeta.strict === void 0) {
      cellMeta.filter = false;
      cellMeta.strict = true;
    }
  }
});
;
registerEditor('dropdown', DropdownEditor);

//# 
},{"autocompleteEditor":32,"browser":24,"editors":30}],36:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  HandsontableEditor: {get: function() {
      return HandsontableEditor;
    }},
  __esModule: {value: true}
});
var $___46__46__47_browser__,
    $___46__46__47_helpers_47_unicode__,
    $___46__46__47_helpers_47_object__,
    $___46__46__47_helpers_47_dom_47_element__,
    $___46__46__47_helpers_47_dom_47_event__,
    $___46__46__47_editors__,
    $__textEditor__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var KEY_CODES = ($___46__46__47_helpers_47_unicode__ = _dereq_("helpers/unicode"), $___46__46__47_helpers_47_unicode__ && $___46__46__47_helpers_47_unicode__.__esModule && $___46__46__47_helpers_47_unicode__ || {default: $___46__46__47_helpers_47_unicode__}).KEY_CODES;
var extend = ($___46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47_helpers_47_object__ && $___46__46__47_helpers_47_object__.__esModule && $___46__46__47_helpers_47_object__ || {default: $___46__46__47_helpers_47_object__}).extend;
var setCaretPosition = ($___46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47_helpers_47_dom_47_element__ && $___46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47_helpers_47_dom_47_element__}).setCaretPosition;
var $__4 = ($___46__46__47_helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $___46__46__47_helpers_47_dom_47_event__ && $___46__46__47_helpers_47_dom_47_event__.__esModule && $___46__46__47_helpers_47_dom_47_event__ || {default: $___46__46__47_helpers_47_dom_47_event__}),
    stopImmediatePropagation = $__4.stopImmediatePropagation,
    isImmediatePropagationStopped = $__4.isImmediatePropagationStopped;
var $__5 = ($___46__46__47_editors__ = _dereq_("editors"), $___46__46__47_editors__ && $___46__46__47_editors__.__esModule && $___46__46__47_editors__ || {default: $___46__46__47_editors__}),
    getEditor = $__5.getEditor,
    registerEditor = $__5.registerEditor;
var TextEditor = ($__textEditor__ = _dereq_("textEditor"), $__textEditor__ && $__textEditor__.__esModule && $__textEditor__ || {default: $__textEditor__}).TextEditor;
var HandsontableEditor = TextEditor.prototype.extend();
HandsontableEditor.prototype.createElements = function() {
  TextEditor.prototype.createElements.apply(this, arguments);
  var DIV = document.createElement('DIV');
  DIV.className = 'handsontableEditor';
  this.TEXTAREA_PARENT.appendChild(DIV);
  this.htContainer = DIV;
  this.assignHooks();
};
HandsontableEditor.prototype.prepare = function(td, row, col, prop, value, cellProperties) {
  TextEditor.prototype.prepare.apply(this, arguments);
  var parent = this;
  var options = {
    startRows: 0,
    startCols: 0,
    minRows: 0,
    minCols: 0,
    className: 'listbox',
    copyPaste: false,
    autoColumnSize: false,
    autoRowSize: false,
    readOnly: true,
    fillHandle: false,
    afterOnCellMouseDown: function() {
      var value = this.getValue();
      if (value !== void 0) {
        parent.setValue(value);
      }
      parent.instance.destroyEditor();
    }
  };
  if (this.cellProperties.handsontable) {
    extend(options, cellProperties.handsontable);
  }
  this.htOptions = options;
};
var onBeforeKeyDown = function(event) {
  if (isImmediatePropagationStopped(event)) {
    return;
  }
  var editor = this.getActiveEditor();
  var innerHOT = editor.htEditor.getInstance();
  var rowToSelect;
  if (event.keyCode == KEY_CODES.ARROW_DOWN) {
    if (!innerHOT.getSelected() && !innerHOT.flipped) {
      rowToSelect = 0;
    } else if (innerHOT.getSelected()) {
      if (innerHOT.flipped) {
        rowToSelect = innerHOT.getSelected()[0] + 1;
      } else if (!innerHOT.flipped) {
        var selectedRow = innerHOT.getSelected()[0];
        var lastRow = innerHOT.countRows() - 1;
        rowToSelect = Math.min(lastRow, selectedRow + 1);
      }
    }
  } else if (event.keyCode == KEY_CODES.ARROW_UP) {
    if (!innerHOT.getSelected() && innerHOT.flipped) {
      rowToSelect = innerHOT.countRows() - 1;
    } else if (innerHOT.getSelected()) {
      if (innerHOT.flipped) {
        var selectedRow = innerHOT.getSelected()[0];
        rowToSelect = Math.max(0, selectedRow - 1);
      } else {
        var selectedRow = innerHOT.getSelected()[0];
        rowToSelect = selectedRow - 1;
      }
    }
  }
  if (rowToSelect !== void 0) {
    if (rowToSelect < 0 || (innerHOT.flipped && rowToSelect > innerHOT.countRows() - 1)) {
      innerHOT.deselectCell();
    } else {
      innerHOT.selectCell(rowToSelect, 0);
    }
    if (innerHOT.getData().length) {
      event.preventDefault();
      stopImmediatePropagation(event);
      editor.instance.listen();
      editor.TEXTAREA.focus();
    }
  }
};
HandsontableEditor.prototype.open = function() {
  this.instance.addHook('beforeKeyDown', onBeforeKeyDown);
  TextEditor.prototype.open.apply(this, arguments);
  if (this.htEditor) {
    this.htEditor.destroy();
  }
  this.htEditor = new Handsontable(this.htContainer, this.htOptions);
  if (this.cellProperties.strict) {
    this.htEditor.selectCell(0, 0);
    this.TEXTAREA.style.visibility = 'hidden';
  } else {
    this.htEditor.deselectCell();
    this.TEXTAREA.style.visibility = 'visible';
  }
  setCaretPosition(this.TEXTAREA, 0, this.TEXTAREA.value.length);
};
HandsontableEditor.prototype.close = function() {
  this.instance.removeHook('beforeKeyDown', onBeforeKeyDown);
  this.instance.listen();
  TextEditor.prototype.close.apply(this, arguments);
};
HandsontableEditor.prototype.focus = function() {
  this.instance.listen();
  TextEditor.prototype.focus.apply(this, arguments);
};
HandsontableEditor.prototype.beginEditing = function(initialValue) {
  var onBeginEditing = this.instance.getSettings().onBeginEditing;
  if (onBeginEditing && onBeginEditing() === false) {
    return;
  }
  TextEditor.prototype.beginEditing.apply(this, arguments);
};
HandsontableEditor.prototype.finishEditing = function(isCancelled, ctrlDown) {
  if (this.htEditor && this.htEditor.isListening()) {
    this.instance.listen();
  }
  if (this.htEditor && this.htEditor.getSelected()) {
    var value = this.htEditor.getInstance().getValue();
    if (value !== void 0) {
      this.setValue(value);
    }
  }
  return TextEditor.prototype.finishEditing.apply(this, arguments);
};
HandsontableEditor.prototype.assignHooks = function() {
  var _this = this;
  this.instance.addHook('afterDestroy', function() {
    if (_this.htEditor) {
      _this.htEditor.destroy();
    }
  });
};
;
registerEditor('handsontable', HandsontableEditor);

//# 
},{"browser":24,"editors":30,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/object":53,"helpers/unicode":56,"textEditor":41}],37:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  MobileTextEditor: {get: function() {
      return MobileTextEditor;
    }},
  __esModule: {value: true}
});
var $___46__46__47_browser__,
    $___46__46__47_helpers_47_unicode__,
    $___46__46__47_helpers_47_dom_47_event__,
    $___46__46__47_helpers_47_dom_47_element__,
    $___46__46__47_editors__,
    $___95_baseEditor__,
    $___46__46__47_eventManager__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var KEY_CODES = ($___46__46__47_helpers_47_unicode__ = _dereq_("helpers/unicode"), $___46__46__47_helpers_47_unicode__ && $___46__46__47_helpers_47_unicode__.__esModule && $___46__46__47_helpers_47_unicode__ || {default: $___46__46__47_helpers_47_unicode__}).KEY_CODES;
var $__2 = ($___46__46__47_helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $___46__46__47_helpers_47_dom_47_event__ && $___46__46__47_helpers_47_dom_47_event__.__esModule && $___46__46__47_helpers_47_dom_47_event__ || {default: $___46__46__47_helpers_47_dom_47_event__}),
    stopImmediatePropagation = $__2.stopImmediatePropagation,
    isImmediatePropagationStopped = $__2.isImmediatePropagationStopped;
var $__3 = ($___46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47_helpers_47_dom_47_element__ && $___46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47_helpers_47_dom_47_element__}),
    addClass = $__3.addClass,
    getScrollLeft = $__3.getScrollLeft,
    getScrollTop = $__3.getScrollTop,
    hasClass = $__3.hasClass,
    isChildOf = $__3.isChildOf,
    offset = $__3.offset,
    outerHeight = $__3.outerHeight,
    outerWidth = $__3.outerWidth,
    removeClass = $__3.removeClass,
    setCaretPosition = $__3.setCaretPosition;
var $__4 = ($___46__46__47_editors__ = _dereq_("editors"), $___46__46__47_editors__ && $___46__46__47_editors__.__esModule && $___46__46__47_editors__ || {default: $___46__46__47_editors__}),
    getEditor = $__4.getEditor,
    registerEditor = $__4.registerEditor;
var BaseEditor = ($___95_baseEditor__ = _dereq_("_baseEditor"), $___95_baseEditor__ && $___95_baseEditor__.__esModule && $___95_baseEditor__ || {default: $___95_baseEditor__}).BaseEditor;
var eventManagerObject = ($___46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47_eventManager__ && $___46__46__47_eventManager__.__esModule && $___46__46__47_eventManager__ || {default: $___46__46__47_eventManager__}).eventManager;
var MobileTextEditor = BaseEditor.prototype.extend(),
    domDimensionsCache = {};
var createControls = function() {
  this.controls = {};
  this.controls.leftButton = document.createElement('DIV');
  this.controls.leftButton.className = 'leftButton';
  this.controls.rightButton = document.createElement('DIV');
  this.controls.rightButton.className = 'rightButton';
  this.controls.upButton = document.createElement('DIV');
  this.controls.upButton.className = 'upButton';
  this.controls.downButton = document.createElement('DIV');
  this.controls.downButton.className = 'downButton';
  for (var button in this.controls) {
    if (this.controls.hasOwnProperty(button)) {
      this.positionControls.appendChild(this.controls[button]);
    }
  }
};
MobileTextEditor.prototype.valueChanged = function() {
  return this.initValue != this.getValue();
};
MobileTextEditor.prototype.init = function() {
  var that = this;
  this.eventManager = eventManagerObject(this.instance);
  this.createElements();
  this.bindEvents();
  this.instance.addHook('afterDestroy', function() {
    that.destroy();
  });
};
MobileTextEditor.prototype.getValue = function() {
  return this.TEXTAREA.value;
};
MobileTextEditor.prototype.setValue = function(newValue) {
  this.initValue = newValue;
  this.TEXTAREA.value = newValue;
};
MobileTextEditor.prototype.createElements = function() {
  this.editorContainer = document.createElement('DIV');
  this.editorContainer.className = 'htMobileEditorContainer';
  this.cellPointer = document.createElement('DIV');
  this.cellPointer.className = 'cellPointer';
  this.moveHandle = document.createElement('DIV');
  this.moveHandle.className = 'moveHandle';
  this.inputPane = document.createElement('DIV');
  this.inputPane.className = 'inputs';
  this.positionControls = document.createElement('DIV');
  this.positionControls.className = 'positionControls';
  this.TEXTAREA = document.createElement('TEXTAREA');
  addClass(this.TEXTAREA, 'handsontableInput');
  this.inputPane.appendChild(this.TEXTAREA);
  this.editorContainer.appendChild(this.cellPointer);
  this.editorContainer.appendChild(this.moveHandle);
  this.editorContainer.appendChild(this.inputPane);
  this.editorContainer.appendChild(this.positionControls);
  createControls.call(this);
  document.body.appendChild(this.editorContainer);
};
MobileTextEditor.prototype.onBeforeKeyDown = function(event) {
  var instance = this;
  var that = instance.getActiveEditor();
  if (event.target !== that.TEXTAREA || isImmediatePropagationStopped(event)) {
    return;
  }
  switch (event.keyCode) {
    case KEY_CODES.ENTER:
      that.close();
      event.preventDefault();
      break;
    case KEY_CODES.BACKSPACE:
      stopImmediatePropagation(event);
      break;
  }
};
MobileTextEditor.prototype.open = function() {
  this.instance.addHook('beforeKeyDown', this.onBeforeKeyDown);
  addClass(this.editorContainer, 'active');
  removeClass(this.cellPointer, 'hidden');
  this.updateEditorPosition();
};
MobileTextEditor.prototype.focus = function() {
  this.TEXTAREA.focus();
  setCaretPosition(this.TEXTAREA, this.TEXTAREA.value.length);
};
MobileTextEditor.prototype.close = function() {
  this.TEXTAREA.blur();
  this.instance.removeHook('beforeKeyDown', this.onBeforeKeyDown);
  removeClass(this.editorContainer, 'active');
};
MobileTextEditor.prototype.scrollToView = function() {
  var coords = this.instance.getSelectedRange().highlight;
  this.instance.view.scrollViewport(coords);
};
MobileTextEditor.prototype.hideCellPointer = function() {
  if (!hasClass(this.cellPointer, 'hidden')) {
    addClass(this.cellPointer, 'hidden');
  }
};
MobileTextEditor.prototype.updateEditorPosition = function(x, y) {
  if (x && y) {
    x = parseInt(x, 10);
    y = parseInt(y, 10);
    this.editorContainer.style.top = y + 'px';
    this.editorContainer.style.left = x + 'px';
  } else {
    var selection = this.instance.getSelected(),
        selectedCell = this.instance.getCell(selection[0], selection[1]);
    if (!domDimensionsCache.cellPointer) {
      domDimensionsCache.cellPointer = {
        height: outerHeight(this.cellPointer),
        width: outerWidth(this.cellPointer)
      };
    }
    if (!domDimensionsCache.editorContainer) {
      domDimensionsCache.editorContainer = {width: outerWidth(this.editorContainer)};
    }
    if (selectedCell !== undefined) {
      var scrollLeft = this.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer == window ? 0 : getScrollLeft(this.instance.view.wt.wtOverlays.leftOverlay.holder);
      var scrollTop = this.instance.view.wt.wtOverlays.topOverlay.trimmingContainer == window ? 0 : getScrollTop(this.instance.view.wt.wtOverlays.topOverlay.holder);
      var selectedCellOffset = offset(selectedCell),
          selectedCellWidth = outerWidth(selectedCell),
          currentScrollPosition = {
            x: scrollLeft,
            y: scrollTop
          };
      this.editorContainer.style.top = parseInt(selectedCellOffset.top + outerHeight(selectedCell) - currentScrollPosition.y + domDimensionsCache.cellPointer.height, 10) + 'px';
      this.editorContainer.style.left = parseInt((window.innerWidth / 2) - (domDimensionsCache.editorContainer.width / 2), 10) + 'px';
      if (selectedCellOffset.left + selectedCellWidth / 2 > parseInt(this.editorContainer.style.left, 10) + domDimensionsCache.editorContainer.width) {
        this.editorContainer.style.left = window.innerWidth - domDimensionsCache.editorContainer.width + 'px';
      } else if (selectedCellOffset.left + selectedCellWidth / 2 < parseInt(this.editorContainer.style.left, 10) + 20) {
        this.editorContainer.style.left = 0 + 'px';
      }
      this.cellPointer.style.left = parseInt(selectedCellOffset.left - (domDimensionsCache.cellPointer.width / 2) - offset(this.editorContainer).left + (selectedCellWidth / 2) - currentScrollPosition.x, 10) + 'px';
    }
  }
};
MobileTextEditor.prototype.updateEditorData = function() {
  var selected = this.instance.getSelected(),
      selectedValue = this.instance.getDataAtCell(selected[0], selected[1]);
  this.row = selected[0];
  this.col = selected[1];
  this.setValue(selectedValue);
  this.updateEditorPosition();
};
MobileTextEditor.prototype.prepareAndSave = function() {
  var val;
  if (!this.valueChanged()) {
    return true;
  }
  if (this.instance.getSettings().trimWhitespace) {
    val = [[String.prototype.trim.call(this.getValue())]];
  } else {
    val = [[this.getValue()]];
  }
  this.saveValue(val);
};
MobileTextEditor.prototype.bindEvents = function() {
  var that = this;
  this.eventManager.addEventListener(this.controls.leftButton, 'touchend', function(event) {
    that.prepareAndSave();
    that.instance.selection.transformStart(0, -1, null, true);
    that.updateEditorData();
    event.preventDefault();
  });
  this.eventManager.addEventListener(this.controls.rightButton, 'touchend', function(event) {
    that.prepareAndSave();
    that.instance.selection.transformStart(0, 1, null, true);
    that.updateEditorData();
    event.preventDefault();
  });
  this.eventManager.addEventListener(this.controls.upButton, 'touchend', function(event) {
    that.prepareAndSave();
    that.instance.selection.transformStart(-1, 0, null, true);
    that.updateEditorData();
    event.preventDefault();
  });
  this.eventManager.addEventListener(this.controls.downButton, 'touchend', function(event) {
    that.prepareAndSave();
    that.instance.selection.transformStart(1, 0, null, true);
    that.updateEditorData();
    event.preventDefault();
  });
  this.eventManager.addEventListener(this.moveHandle, 'touchstart', function(event) {
    if (event.touches.length == 1) {
      var touch = event.touches[0],
          onTouchPosition = {
            x: that.editorContainer.offsetLeft,
            y: that.editorContainer.offsetTop
          },
          onTouchOffset = {
            x: touch.pageX - onTouchPosition.x,
            y: touch.pageY - onTouchPosition.y
          };
      that.eventManager.addEventListener(this, 'touchmove', function(event) {
        var touch = event.touches[0];
        that.updateEditorPosition(touch.pageX - onTouchOffset.x, touch.pageY - onTouchOffset.y);
        that.hideCellPointer();
        event.preventDefault();
      });
    }
  });
  this.eventManager.addEventListener(document.body, 'touchend', function(event) {
    if (!isChildOf(event.target, that.editorContainer) && !isChildOf(event.target, that.instance.rootElement)) {
      that.close();
    }
  });
  this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.leftOverlay.holder, 'scroll', function(event) {
    if (that.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer != window) {
      that.hideCellPointer();
    }
  });
  this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.topOverlay.holder, 'scroll', function(event) {
    if (that.instance.view.wt.wtOverlays.topOverlay.trimmingContainer != window) {
      that.hideCellPointer();
    }
  });
};
MobileTextEditor.prototype.destroy = function() {
  this.eventManager.clear();
  this.editorContainer.parentNode.removeChild(this.editorContainer);
};
;
registerEditor('mobile', MobileTextEditor);

//# 
},{"_baseEditor":31,"browser":24,"editors":30,"eventManager":42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/unicode":56}],38:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  NumericEditor: {get: function() {
      return NumericEditor;
    }},
  __esModule: {value: true}
});
var $__numbro__,
    $___46__46__47_editors__,
    $__textEditor__;
var numbro = ($__numbro__ = _dereq_("numbro"), $__numbro__ && $__numbro__.__esModule && $__numbro__ || {default: $__numbro__}).default;
var registerEditor = ($___46__46__47_editors__ = _dereq_("editors"), $___46__46__47_editors__ && $___46__46__47_editors__.__esModule && $___46__46__47_editors__ || {default: $___46__46__47_editors__}).registerEditor;
var TextEditor = ($__textEditor__ = _dereq_("textEditor"), $__textEditor__ && $__textEditor__.__esModule && $__textEditor__ || {default: $__textEditor__}).TextEditor;
var NumericEditor = function NumericEditor() {
  $traceurRuntime.superConstructor($NumericEditor).apply(this, arguments);
};
var $NumericEditor = NumericEditor;
($traceurRuntime.createClass)(NumericEditor, {beginEditing: function(initialValue) {
    if (typeof initialValue === 'undefined' && this.originalValue) {
      if (typeof this.cellProperties.language !== 'undefined') {
        numbro.culture(this.cellProperties.language);
      }
      var decimalDelimiter = numbro.cultureData().delimiters.decimal;
      initialValue = ('' + this.originalValue).replace('.', decimalDelimiter);
    }
    $traceurRuntime.superGet(this, $NumericEditor.prototype, "beginEditing").call(this, initialValue);
  }}, {}, TextEditor);
;
registerEditor('numeric', NumericEditor);

//# 
},{"editors":30,"numbro":"numbro","textEditor":41}],39:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  PasswordEditor: {get: function() {
      return PasswordEditor;
    }},
  __esModule: {value: true}
});
var $___46__46__47_browser__,
    $___46__46__47_helpers_47_dom_47_element__,
    $___46__46__47_editors__,
    $__textEditor__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var empty = ($___46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47_helpers_47_dom_47_element__ && $___46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47_helpers_47_dom_47_element__}).empty;
var $__2 = ($___46__46__47_editors__ = _dereq_("editors"), $___46__46__47_editors__ && $___46__46__47_editors__.__esModule && $___46__46__47_editors__ || {default: $___46__46__47_editors__}),
    getEditor = $__2.getEditor,
    registerEditor = $__2.registerEditor;
var TextEditor = ($__textEditor__ = _dereq_("textEditor"), $__textEditor__ && $__textEditor__.__esModule && $__textEditor__ || {default: $__textEditor__}).TextEditor;
var PasswordEditor = function PasswordEditor() {
  $traceurRuntime.superConstructor($PasswordEditor).apply(this, arguments);
};
var $PasswordEditor = PasswordEditor;
($traceurRuntime.createClass)(PasswordEditor, {createElements: function() {
    $traceurRuntime.superGet(this, $PasswordEditor.prototype, "createElements").call(this);
    this.TEXTAREA = document.createElement('input');
    this.TEXTAREA.setAttribute('type', 'password');
    this.TEXTAREA.className = 'handsontableInput';
    this.textareaStyle = this.TEXTAREA.style;
    this.textareaStyle.width = 0;
    this.textareaStyle.height = 0;
    empty(this.TEXTAREA_PARENT);
    this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);
  }}, {}, TextEditor);
;
registerEditor('password', PasswordEditor);

//# 
},{"browser":24,"editors":30,"helpers/dom/element":47,"textEditor":41}],40:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  SelectEditor: {get: function() {
      return SelectEditor;
    }},
  __esModule: {value: true}
});
var $___46__46__47_browser__,
    $___46__46__47_helpers_47_dom_47_element__,
    $___46__46__47_helpers_47_dom_47_event__,
    $___46__46__47_helpers_47_unicode__,
    $___46__46__47_editors__,
    $___95_baseEditor__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var $__1 = ($___46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47_helpers_47_dom_47_element__ && $___46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47_helpers_47_dom_47_element__}),
    addClass = $__1.addClass,
    empty = $__1.empty,
    fastInnerHTML = $__1.fastInnerHTML,
    getComputedStyle = $__1.getComputedStyle,
    getCssTransform = $__1.getCssTransform,
    getScrollableElement = $__1.getScrollableElement,
    offset = $__1.offset,
    outerHeight = $__1.outerHeight,
    outerWidth = $__1.outerWidth,
    resetCssTransform = $__1.resetCssTransform;
var stopImmediatePropagation = ($___46__46__47_helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $___46__46__47_helpers_47_dom_47_event__ && $___46__46__47_helpers_47_dom_47_event__.__esModule && $___46__46__47_helpers_47_dom_47_event__ || {default: $___46__46__47_helpers_47_dom_47_event__}).stopImmediatePropagation;
var KEY_CODES = ($___46__46__47_helpers_47_unicode__ = _dereq_("helpers/unicode"), $___46__46__47_helpers_47_unicode__ && $___46__46__47_helpers_47_unicode__.__esModule && $___46__46__47_helpers_47_unicode__ || {default: $___46__46__47_helpers_47_unicode__}).KEY_CODES;
var $__4 = ($___46__46__47_editors__ = _dereq_("editors"), $___46__46__47_editors__ && $___46__46__47_editors__.__esModule && $___46__46__47_editors__ || {default: $___46__46__47_editors__}),
    getEditor = $__4.getEditor,
    registerEditor = $__4.registerEditor;
var BaseEditor = ($___95_baseEditor__ = _dereq_("_baseEditor"), $___95_baseEditor__ && $___95_baseEditor__.__esModule && $___95_baseEditor__ || {default: $___95_baseEditor__}).BaseEditor;
var SelectEditor = BaseEditor.prototype.extend();
SelectEditor.prototype.init = function() {
  this.select = document.createElement('SELECT');
  addClass(this.select, 'htSelectEditor');
  this.select.style.display = 'none';
  this.instance.rootElement.appendChild(this.select);
  this.registerHooks();
};
SelectEditor.prototype.registerHooks = function() {
  var $__6 = this;
  this.instance.addHook('afterScrollHorizontally', (function() {
    return $__6.refreshDimensions();
  }));
  this.instance.addHook('afterScrollVertically', (function() {
    return $__6.refreshDimensions();
  }));
  this.instance.addHook('afterColumnResize', (function() {
    return $__6.refreshDimensions();
  }));
  this.instance.addHook('afterRowResize', (function() {
    return $__6.refreshDimensions();
  }));
};
SelectEditor.prototype.prepare = function() {
  BaseEditor.prototype.prepare.apply(this, arguments);
  var selectOptions = this.cellProperties.selectOptions;
  var options;
  if (typeof selectOptions == 'function') {
    options = this.prepareOptions(selectOptions(this.row, this.col, this.prop));
  } else {
    options = this.prepareOptions(selectOptions);
  }
  empty(this.select);
  for (var option in options) {
    if (options.hasOwnProperty(option)) {
      var optionElement = document.createElement('OPTION');
      optionElement.value = option;
      fastInnerHTML(optionElement, options[option]);
      this.select.appendChild(optionElement);
    }
  }
};
SelectEditor.prototype.prepareOptions = function(optionsToPrepare) {
  var preparedOptions = {};
  if (Array.isArray(optionsToPrepare)) {
    for (var i = 0,
        len = optionsToPrepare.length; i < len; i++) {
      preparedOptions[optionsToPrepare[i]] = optionsToPrepare[i];
    }
  } else if (typeof optionsToPrepare == 'object') {
    preparedOptions = optionsToPrepare;
  }
  return preparedOptions;
};
SelectEditor.prototype.getValue = function() {
  return this.select.value;
};
SelectEditor.prototype.setValue = function(value) {
  this.select.value = value;
};
var onBeforeKeyDown = function(event) {
  var instance = this;
  var editor = instance.getActiveEditor();
  switch (event.keyCode) {
    case KEY_CODES.ARROW_UP:
      var previousOptionIndex = editor.select.selectedIndex - 1;
      if (previousOptionIndex >= 0) {
        editor.select[previousOptionIndex].selected = true;
      }
      stopImmediatePropagation(event);
      event.preventDefault();
      break;
    case KEY_CODES.ARROW_DOWN:
      var nextOptionIndex = editor.select.selectedIndex + 1;
      if (nextOptionIndex <= editor.select.length - 1) {
        editor.select[nextOptionIndex].selected = true;
      }
      stopImmediatePropagation(event);
      event.preventDefault();
      break;
  }
};
SelectEditor.prototype.open = function() {
  this._opened = true;
  this.refreshDimensions();
  this.select.style.display = '';
  this.instance.addHook('beforeKeyDown', onBeforeKeyDown);
};
SelectEditor.prototype.close = function() {
  this._opened = false;
  this.select.style.display = 'none';
  this.instance.removeHook('beforeKeyDown', onBeforeKeyDown);
};
SelectEditor.prototype.focus = function() {
  this.select.focus();
};
SelectEditor.prototype.refreshValue = function() {
  var sourceData = this.instance.getSourceDataAtCell(this.row, this.prop);
  this.originalValue = sourceData;
  this.setValue(sourceData);
  this.refreshDimensions();
};
SelectEditor.prototype.refreshDimensions = function() {
  if (this.state !== Handsontable.EditorState.EDITING) {
    return;
  }
  this.TD = this.getEditedCell();
  if (!this.TD) {
    this.close();
    return;
  }
  var width = outerWidth(this.TD) + 1,
      height = outerHeight(this.TD) + 1,
      currentOffset = offset(this.TD),
      containerOffset = offset(this.instance.rootElement),
      scrollableContainer = getScrollableElement(this.TD),
      editTop = currentOffset.top - containerOffset.top - 1 - (scrollableContainer.scrollTop || 0),
      editLeft = currentOffset.left - containerOffset.left - 1 - (scrollableContainer.scrollLeft || 0),
      editorSection = this.checkEditorSection(),
      cssTransformOffset;
  var settings = this.instance.getSettings();
  var rowHeadersCount = settings.rowHeaders ? 1 : 0;
  var colHeadersCount = settings.colHeaders ? 1 : 0;
  switch (editorSection) {
    case 'top':
      cssTransformOffset = getCssTransform(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);
      break;
    case 'left':
      cssTransformOffset = getCssTransform(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);
      break;
    case 'top-left-corner':
      cssTransformOffset = getCssTransform(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);
      break;
    case 'bottom-left-corner':
      cssTransformOffset = getCssTransform(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);
      break;
    case 'bottom':
      cssTransformOffset = getCssTransform(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode);
      break;
  }
  if (this.instance.getSelected()[0] === 0) {
    editTop += 1;
  }
  if (this.instance.getSelected()[1] === 0) {
    editLeft += 1;
  }
  var selectStyle = this.select.style;
  if (cssTransformOffset && cssTransformOffset != -1) {
    selectStyle[cssTransformOffset[0]] = cssTransformOffset[1];
  } else {
    resetCssTransform(this.select);
  }
  var cellComputedStyle = getComputedStyle(this.TD);
  if (parseInt(cellComputedStyle.borderTopWidth, 10) > 0) {
    height -= 1;
  }
  if (parseInt(cellComputedStyle.borderLeftWidth, 10) > 0) {
    width -= 1;
  }
  selectStyle.height = height + 'px';
  selectStyle.minWidth = width + 'px';
  selectStyle.top = editTop + 'px';
  selectStyle.left = editLeft + 'px';
  selectStyle.margin = '0px';
};
SelectEditor.prototype.getEditedCell = function() {
  var editorSection = this.checkEditorSection(),
      editedCell;
  switch (editorSection) {
    case 'top':
      editedCell = this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({
        row: this.row,
        col: this.col
      });
      this.select.style.zIndex = 101;
      break;
    case 'corner':
      editedCell = this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({
        row: this.row,
        col: this.col
      });
      this.select.style.zIndex = 103;
      break;
    case 'left':
      editedCell = this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({
        row: this.row,
        col: this.col
      });
      this.select.style.zIndex = 102;
      break;
    default:
      editedCell = this.instance.getCell(this.row, this.col);
      this.select.style.zIndex = '';
      break;
  }
  return editedCell != -1 && editedCell != -2 ? editedCell : void 0;
};
;
registerEditor('select', SelectEditor);

//# 
},{"_baseEditor":31,"browser":24,"editors":30,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/unicode":56}],41:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  TextEditor: {get: function() {
      return TextEditor;
    }},
  __esModule: {value: true}
});
var $___46__46__47_browser__,
    $___46__46__47_helpers_47_dom_47_element__,
    $__autoResize__,
    $___95_baseEditor__,
    $___46__46__47_eventManager__,
    $___46__46__47_editors__,
    $___46__46__47_helpers_47_unicode__,
    $___46__46__47_helpers_47_dom_47_event__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var $__1 = ($___46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47_helpers_47_dom_47_element__ && $___46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47_helpers_47_dom_47_element__}),
    addClass = $__1.addClass,
    getCaretPosition = $__1.getCaretPosition,
    getComputedStyle = $__1.getComputedStyle,
    getCssTransform = $__1.getCssTransform,
    getScrollableElement = $__1.getScrollableElement,
    getScrollbarWidth = $__1.getScrollbarWidth,
    innerWidth = $__1.innerWidth,
    offset = $__1.offset,
    resetCssTransform = $__1.resetCssTransform,
    setCaretPosition = $__1.setCaretPosition,
    hasVerticalScrollbar = $__1.hasVerticalScrollbar,
    hasHorizontalScrollbar = $__1.hasHorizontalScrollbar;
var autoResize = ($__autoResize__ = _dereq_("autoResize"), $__autoResize__ && $__autoResize__.__esModule && $__autoResize__ || {default: $__autoResize__}).default;
var BaseEditor = ($___95_baseEditor__ = _dereq_("_baseEditor"), $___95_baseEditor__ && $___95_baseEditor__.__esModule && $___95_baseEditor__ || {default: $___95_baseEditor__}).BaseEditor;
var eventManagerObject = ($___46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47_eventManager__ && $___46__46__47_eventManager__.__esModule && $___46__46__47_eventManager__ || {default: $___46__46__47_eventManager__}).eventManager;
var $__5 = ($___46__46__47_editors__ = _dereq_("editors"), $___46__46__47_editors__ && $___46__46__47_editors__.__esModule && $___46__46__47_editors__ || {default: $___46__46__47_editors__}),
    getEditor = $__5.getEditor,
    registerEditor = $__5.registerEditor;
var KEY_CODES = ($___46__46__47_helpers_47_unicode__ = _dereq_("helpers/unicode"), $___46__46__47_helpers_47_unicode__ && $___46__46__47_helpers_47_unicode__.__esModule && $___46__46__47_helpers_47_unicode__ || {default: $___46__46__47_helpers_47_unicode__}).KEY_CODES;
var $__7 = ($___46__46__47_helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $___46__46__47_helpers_47_dom_47_event__ && $___46__46__47_helpers_47_dom_47_event__.__esModule && $___46__46__47_helpers_47_dom_47_event__ || {default: $___46__46__47_helpers_47_dom_47_event__}),
    stopPropagation = $__7.stopPropagation,
    stopImmediatePropagation = $__7.stopImmediatePropagation,
    isImmediatePropagationStopped = $__7.isImmediatePropagationStopped;
var TextEditor = BaseEditor.prototype.extend();
TextEditor.prototype.init = function() {
  var that = this;
  this.createElements();
  this.eventManager = eventManagerObject(this);
  this.bindEvents();
  this.autoResize = autoResize();
  this.instance.addHook('afterDestroy', function() {
    that.destroy();
  });
};
TextEditor.prototype.getValue = function() {
  return this.TEXTAREA.value;
};
TextEditor.prototype.setValue = function(newValue) {
  this.TEXTAREA.value = newValue;
};
var onBeforeKeyDown = function onBeforeKeyDown(event) {
  var instance = this,
      that = instance.getActiveEditor(),
      ctrlDown;
  ctrlDown = (event.ctrlKey || event.metaKey) && !event.altKey;
  if (event.target !== that.TEXTAREA || isImmediatePropagationStopped(event)) {
    return;
  }
  if (event.keyCode === 17 || event.keyCode === 224 || event.keyCode === 91 || event.keyCode === 93) {
    stopImmediatePropagation(event);
    return;
  }
  switch (event.keyCode) {
    case KEY_CODES.ARROW_RIGHT:
      if (that.isInFullEditMode()) {
        if ((!that.isWaiting() && !that.allowKeyEventPropagation) || (!that.isWaiting() && that.allowKeyEventPropagation && !that.allowKeyEventPropagation(event.keyCode))) {
          stopImmediatePropagation(event);
        }
      }
      break;
    case KEY_CODES.ARROW_LEFT:
      if (that.isInFullEditMode()) {
        if ((!that.isWaiting() && !that.allowKeyEventPropagation) || (!that.isWaiting() && that.allowKeyEventPropagation && !that.allowKeyEventPropagation(event.keyCode))) {
          stopImmediatePropagation(event);
        }
      }
      break;
    case KEY_CODES.ARROW_UP:
    case KEY_CODES.ARROW_DOWN:
      if (that.isInFullEditMode()) {
        if ((!that.isWaiting() && !that.allowKeyEventPropagation) || (!that.isWaiting() && that.allowKeyEventPropagation && !that.allowKeyEventPropagation(event.keyCode))) {
          stopImmediatePropagation(event);
        }
      }
      break;
    case KEY_CODES.ENTER:
      var selected = that.instance.getSelected();
      var isMultipleSelection = !(selected[0] === selected[2] && selected[1] === selected[3]);
      if ((ctrlDown && !isMultipleSelection) || event.altKey) {
        if (that.isOpened()) {
          var caretPosition = getCaretPosition(that.TEXTAREA),
              value = that.getValue();
          var newValue = value.slice(0, caretPosition) + '\n' + value.slice(caretPosition);
          that.setValue(newValue);
          setCaretPosition(that.TEXTAREA, caretPosition + 1);
        } else {
          that.beginEditing(that.originalValue + '\n');
        }
        stopImmediatePropagation(event);
      }
      event.preventDefault();
      break;
    case KEY_CODES.A:
    case KEY_CODES.X:
    case KEY_CODES.C:
    case KEY_CODES.V:
      if (ctrlDown) {
        stopImmediatePropagation(event);
      }
      break;
    case KEY_CODES.BACKSPACE:
    case KEY_CODES.DELETE:
    case KEY_CODES.HOME:
    case KEY_CODES.END:
      stopImmediatePropagation(event);
      break;
  }
  if ([KEY_CODES.ARROW_UP, KEY_CODES.ARROW_RIGHT, KEY_CODES.ARROW_DOWN, KEY_CODES.ARROW_LEFT].indexOf(event.keyCode) === -1) {
    that.autoResize.resize(String.fromCharCode(event.keyCode));
  }
};
TextEditor.prototype.open = function() {
  this.refreshDimensions();
  this.instance.addHook('beforeKeyDown', onBeforeKeyDown);
};
TextEditor.prototype.close = function(tdOutside) {
  this.textareaParentStyle.display = 'none';
  this.autoResize.unObserve();
  if (document.activeElement === this.TEXTAREA) {
    this.instance.listen();
  }
  this.instance.removeHook('beforeKeyDown', onBeforeKeyDown);
};
TextEditor.prototype.focus = function() {
  this.TEXTAREA.focus();
  setCaretPosition(this.TEXTAREA, this.TEXTAREA.value.length);
};
TextEditor.prototype.createElements = function() {
  this.TEXTAREA = document.createElement('TEXTAREA');
  addClass(this.TEXTAREA, 'handsontableInput');
  this.textareaStyle = this.TEXTAREA.style;
  this.textareaStyle.width = 0;
  this.textareaStyle.height = 0;
  this.TEXTAREA_PARENT = document.createElement('DIV');
  addClass(this.TEXTAREA_PARENT, 'handsontableInputHolder');
  this.textareaParentStyle = this.TEXTAREA_PARENT.style;
  this.textareaParentStyle.top = 0;
  this.textareaParentStyle.left = 0;
  this.textareaParentStyle.display = 'none';
  this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);
  this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);
  var that = this;
  this.instance._registerTimeout(setTimeout(function() {
    that.refreshDimensions();
  }, 0));
};
TextEditor.prototype.getEditedCell = function() {
  var editorSection = this.checkEditorSection(),
      editedCell;
  switch (editorSection) {
    case 'top':
      editedCell = this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({
        row: this.row,
        col: this.col
      });
      this.textareaParentStyle.zIndex = 101;
      break;
    case 'top-left-corner':
      editedCell = this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({
        row: this.row,
        col: this.col
      });
      this.textareaParentStyle.zIndex = 103;
      break;
    case 'bottom-left-corner':
      editedCell = this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({
        row: this.row,
        col: this.col
      });
      this.textareaParentStyle.zIndex = 103;
      break;
    case 'left':
      editedCell = this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({
        row: this.row,
        col: this.col
      });
      this.textareaParentStyle.zIndex = 102;
      break;
    case 'bottom':
      editedCell = this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({
        row: this.row,
        col: this.col
      });
      this.textareaParentStyle.zIndex = 102;
      break;
    default:
      editedCell = this.instance.getCell(this.row, this.col);
      this.textareaParentStyle.zIndex = '';
      break;
  }
  return editedCell != -1 && editedCell != -2 ? editedCell : void 0;
};
TextEditor.prototype.refreshValue = function() {
  var sourceData = this.instance.getSourceDataAtCell(this.row, this.prop);
  this.originalValue = sourceData;
  this.setValue(sourceData);
  this.refreshDimensions();
};
TextEditor.prototype.refreshDimensions = function() {
  if (this.state !== Handsontable.EditorState.EDITING) {
    return;
  }
  this.TD = this.getEditedCell();
  if (!this.TD) {
    this.close(true);
    return;
  }
  var currentOffset = offset(this.TD),
      containerOffset = offset(this.instance.rootElement),
      scrollableContainer = getScrollableElement(this.TD),
      totalRowsCount = this.instance.countRows(),
      editTopModifier = currentOffset.top === containerOffset.top ? 0 : 1,
      editTop = currentOffset.top - containerOffset.top - editTopModifier - (scrollableContainer.scrollTop || 0),
      editLeft = currentOffset.left - containerOffset.left - 1 - (scrollableContainer.scrollLeft || 0),
      settings = this.instance.getSettings(),
      rowHeadersCount = this.instance.hasRowHeaders(),
      colHeadersCount = this.instance.hasColHeaders(),
      editorSection = this.checkEditorSection(),
      backgroundColor = this.TD.style.backgroundColor,
      cssTransformOffset;
  switch (editorSection) {
    case 'top':
      cssTransformOffset = getCssTransform(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);
      break;
    case 'left':
      cssTransformOffset = getCssTransform(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);
      break;
    case 'top-left-corner':
      cssTransformOffset = getCssTransform(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);
      break;
    case 'bottom-left-corner':
      cssTransformOffset = getCssTransform(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);
      break;
    case 'bottom':
      cssTransformOffset = getCssTransform(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode);
      break;
  }
  if (colHeadersCount && this.instance.getSelected()[0] === 0 || (settings.fixedRowsBottom && this.instance.getSelected()[0] === totalRowsCount - settings.fixedRowsBottom)) {
    editTop += 1;
  }
  if (this.instance.getSelected()[1] === 0) {
    editLeft += 1;
  }
  if (cssTransformOffset && cssTransformOffset != -1) {
    this.textareaParentStyle[cssTransformOffset[0]] = cssTransformOffset[1];
  } else {
    resetCssTransform(this.TEXTAREA_PARENT);
  }
  this.textareaParentStyle.top = editTop + 'px';
  this.textareaParentStyle.left = editLeft + 'px';
  var firstRowOffset = this.instance.view.wt.wtViewport.rowsRenderCalculator.startPosition;
  var firstColumnOffset = this.instance.view.wt.wtViewport.columnsRenderCalculator.startPosition;
  var horizontalScrollPosition = this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition();
  var verticalScrollPosition = this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition();
  var scrollbarWidth = getScrollbarWidth();
  var cellTopOffset = this.TD.offsetTop + firstRowOffset - verticalScrollPosition;
  var cellLeftOffset = this.TD.offsetLeft + firstColumnOffset - horizontalScrollPosition;
  var width = innerWidth(this.TD) - 8;
  var actualVerticalScrollbarWidth = hasVerticalScrollbar(scrollableContainer) ? scrollbarWidth : 0;
  var actualHorizontalScrollbarWidth = hasHorizontalScrollbar(scrollableContainer) ? scrollbarWidth : 0;
  var maxWidth = this.instance.view.maximumVisibleElementWidth(cellLeftOffset) - 9 - actualVerticalScrollbarWidth;
  var height = this.TD.scrollHeight + 1;
  var maxHeight = Math.max(this.instance.view.maximumVisibleElementHeight(cellTopOffset) - actualHorizontalScrollbarWidth, 23);
  var cellComputedStyle = getComputedStyle(this.TD);
  this.TEXTAREA.style.fontSize = cellComputedStyle.fontSize;
  this.TEXTAREA.style.fontFamily = cellComputedStyle.fontFamily;
  this.TEXTAREA.style.backgroundColor = '';
  this.TEXTAREA.style.backgroundColor = backgroundColor ? backgroundColor : getComputedStyle(this.TEXTAREA).backgroundColor;
  this.autoResize.init(this.TEXTAREA, {
    minHeight: Math.min(height, maxHeight),
    maxHeight: maxHeight,
    minWidth: Math.min(width, maxWidth),
    maxWidth: maxWidth
  }, true);
  this.textareaParentStyle.display = 'block';
};
TextEditor.prototype.bindEvents = function() {
  var editor = this;
  this.eventManager.addEventListener(this.TEXTAREA, 'cut', function(event) {
    stopPropagation(event);
  });
  this.eventManager.addEventListener(this.TEXTAREA, 'paste', function(event) {
    stopPropagation(event);
  });
  this.instance.addHook('afterScrollHorizontally', function() {
    editor.refreshDimensions();
  });
  this.instance.addHook('afterScrollVertically', function() {
    editor.refreshDimensions();
  });
  this.instance.addHook('afterColumnResize', function() {
    editor.refreshDimensions();
    editor.focus();
  });
  this.instance.addHook('afterRowResize', function() {
    editor.refreshDimensions();
    editor.focus();
  });
  this.instance.addHook('afterDestroy', function() {
    editor.eventManager.destroy();
  });
};
TextEditor.prototype.destroy = function() {
  this.eventManager.destroy();
};
;
registerEditor('text', TextEditor);

//# 
},{"_baseEditor":31,"autoResize":"autoResize","browser":24,"editors":30,"eventManager":42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/unicode":56}],42:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  EventManager: {get: function() {
      return EventManager;
    }},
  eventManager: {get: function() {
      return eventManager;
    }},
  __esModule: {value: true}
});
var $__browser__,
    $__helpers_47_dom_47_element__,
    $__helpers_47_feature__,
    $__helpers_47_dom_47_event__;
var Handsontable = ($__browser__ = _dereq_("browser"), $__browser__ && $__browser__.__esModule && $__browser__ || {default: $__browser__}).default;
var $__1 = ($__helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $__helpers_47_dom_47_element__ && $__helpers_47_dom_47_element__.__esModule && $__helpers_47_dom_47_element__ || {default: $__helpers_47_dom_47_element__}),
    polymerWrap = $__1.polymerWrap,
    closest = $__1.closest;
var isWebComponentSupportedNatively = ($__helpers_47_feature__ = _dereq_("helpers/feature"), $__helpers_47_feature__ && $__helpers_47_feature__.__esModule && $__helpers_47_feature__ || {default: $__helpers_47_feature__}).isWebComponentSupportedNatively;
var _stopImmediatePropagation = ($__helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $__helpers_47_dom_47_event__ && $__helpers_47_dom_47_event__.__esModule && $__helpers_47_dom_47_event__ || {default: $__helpers_47_dom_47_event__}).stopImmediatePropagation;
var EventManager = function EventManager() {
  var context = arguments[0] !== (void 0) ? arguments[0] : null;
  this.context = context || this;
  if (!this.context.eventListeners) {
    this.context.eventListeners = [];
  }
};
($traceurRuntime.createClass)(EventManager, {
  addEventListener: function(element, eventName, callback) {
    var $__4 = this;
    var context = this.context;
    function callbackProxy(event) {
      event = extendEvent(context, event);
      callback.call(this, event);
    }
    this.context.eventListeners.push({
      element: element,
      event: eventName,
      callback: callback,
      callbackProxy: callbackProxy
    });
    if (window.addEventListener) {
      element.addEventListener(eventName, callbackProxy, false);
    } else {
      element.attachEvent('on' + eventName, callbackProxy);
    }
    Handsontable.countEventManagerListeners++;
    return (function() {
      $__4.removeEventListener(element, eventName, callback);
    });
  },
  removeEventListener: function(element, eventName, callback) {
    var len = this.context.eventListeners.length;
    var tmpEvent;
    while (len--) {
      tmpEvent = this.context.eventListeners[len];
      if (tmpEvent.event == eventName && tmpEvent.element == element) {
        if (callback && callback != tmpEvent.callback) {
          continue;
        }
        this.context.eventListeners.splice(len, 1);
        if (tmpEvent.element.removeEventListener) {
          tmpEvent.element.removeEventListener(tmpEvent.event, tmpEvent.callbackProxy, false);
        } else {
          tmpEvent.element.detachEvent('on' + tmpEvent.event, tmpEvent.callbackProxy);
        }
        Handsontable.countEventManagerListeners--;
      }
    }
  },
  clearEvents: function() {
    if (!this.context) {
      return;
    }
    var len = this.context.eventListeners.length;
    while (len--) {
      var event = this.context.eventListeners[len];
      if (event) {
        this.removeEventListener(event.element, event.event, event.callback);
      }
    }
  },
  clear: function() {
    this.clearEvents();
  },
  destroy: function() {
    this.clearEvents();
    this.context = null;
  },
  fireEvent: function(element, eventName) {
    var options = {
      bubbles: true,
      cancelable: (eventName !== 'mousemove'),
      view: window,
      detail: 0,
      screenX: 0,
      screenY: 0,
      clientX: 1,
      clientY: 1,
      ctrlKey: false,
      altKey: false,
      shiftKey: false,
      metaKey: false,
      button: 0,
      relatedTarget: undefined
    };
    var event;
    if (document.createEvent) {
      event = document.createEvent('MouseEvents');
      event.initMouseEvent(eventName, options.bubbles, options.cancelable, options.view, options.detail, options.screenX, options.screenY, options.clientX, options.clientY, options.ctrlKey, options.altKey, options.shiftKey, options.metaKey, options.button, options.relatedTarget || document.body.parentNode);
    } else {
      event = document.createEventObject();
    }
    if (element.dispatchEvent) {
      element.dispatchEvent(event);
    } else {
      element.fireEvent('on' + eventName, event);
    }
  }
}, {});
function extendEvent(context, event) {
  var componentName = 'HOT-TABLE';
  var isHotTableSpotted;
  var fromElement;
  var realTarget;
  var target;
  var len;
  var nativeStopImmediatePropagation;
  event.isTargetWebComponent = false;
  event.realTarget = event.target;
  nativeStopImmediatePropagation = event.stopImmediatePropagation;
  event.stopImmediatePropagation = function() {
    nativeStopImmediatePropagation.apply(this);
    _stopImmediatePropagation(this);
  };
  if (!Handsontable.eventManager.isHotTableEnv) {
    return event;
  }
  event = polymerWrap(event);
  len = event.path ? event.path.length : 0;
  while (len--) {
    if (event.path[len].nodeName === componentName) {
      isHotTableSpotted = true;
    } else if (isHotTableSpotted && event.path[len].shadowRoot) {
      target = event.path[len];
      break;
    }
    if (len === 0 && !target) {
      target = event.path[len];
    }
  }
  if (!target) {
    target = event.target;
  }
  event.isTargetWebComponent = true;
  if (isWebComponentSupportedNatively()) {
    event.realTarget = event.srcElement || event.toElement;
  } else if (context instanceof Handsontable.Core || context instanceof Walkontable) {
    if (context instanceof Handsontable.Core) {
      fromElement = context.view ? context.view.wt.wtTable.TABLE : null;
    } else if (context instanceof Walkontable) {
      fromElement = context.wtTable.TABLE.parentNode.parentNode;
    }
    realTarget = closest(event.target, [componentName], fromElement);
    if (realTarget) {
      event.realTarget = fromElement.querySelector(componentName) || event.target;
    } else {
      event.realTarget = event.target;
    }
  }
  Object.defineProperty(event, 'target', {
    get: function() {
      return polymerWrap(target);
    },
    enumerable: true,
    configurable: true
  });
  return event;
}
;
Handsontable.countEventManagerListeners = 0;
Handsontable.eventManager = eventManager;
function eventManager(context) {
  return new EventManager(context);
}

//# 
},{"browser":24,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/feature":49}],43:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  to2dArray: {get: function() {
      return to2dArray;
    }},
  extendArray: {get: function() {
      return extendArray;
    }},
  pivot: {get: function() {
      return pivot;
    }},
  arrayReduce: {get: function() {
      return arrayReduce;
    }},
  arrayFilter: {get: function() {
      return arrayFilter;
    }},
  arrayMap: {get: function() {
      return arrayMap;
    }},
  arrayEach: {get: function() {
      return arrayEach;
    }},
  arraySum: {get: function() {
      return arraySum;
    }},
  arrayMax: {get: function() {
      return arrayMax;
    }},
  arrayMin: {get: function() {
      return arrayMin;
    }},
  arrayAvg: {get: function() {
      return arrayAvg;
    }},
  arrayFlatten: {get: function() {
      return arrayFlatten;
    }},
  arrayUnique: {get: function() {
      return arrayUnique;
    }},
  arrayIncludes: {get: function() {
      return arrayIncludes;
    }},
  __esModule: {value: true}
});
function to2dArray(arr) {
  var i = 0,
      ilen = arr.length;
  while (i < ilen) {
    arr[i] = [arr[i]];
    i++;
  }
}
function extendArray(arr, extension) {
  var i = 0,
      ilen = extension.length;
  while (i < ilen) {
    arr.push(extension[i]);
    i++;
  }
}
function pivot(arr) {
  var pivotedArr = [];
  if (!arr || arr.length === 0 || !arr[0] || arr[0].length === 0) {
    return pivotedArr;
  }
  var rowCount = arr.length;
  var colCount = arr[0].length;
  for (var i = 0; i < rowCount; i++) {
    for (var j = 0; j < colCount; j++) {
      if (!pivotedArr[j]) {
        pivotedArr[j] = [];
      }
      pivotedArr[j][i] = arr[i][j];
    }
  }
  return pivotedArr;
}
function arrayReduce(array, iteratee, accumulator, initFromArray) {
  var index = -1,
      length = array.length;
  if (initFromArray && length) {
    accumulator = array[++index];
  }
  while (++index < length) {
    accumulator = iteratee(accumulator, array[index], index, array);
  }
  return accumulator;
}
function arrayFilter(array, predicate) {
  var index = -1,
      length = array.length,
      resIndex = -1,
      result = [];
  while (++index < length) {
    var value = array[index];
    if (predicate(value, index, array)) {
      result[++resIndex] = value;
    }
  }
  return result;
}
function arrayMap(array, iteratee) {
  var index = -1,
      length = array.length,
      resIndex = -1,
      result = [];
  while (++index < length) {
    var value = array[index];
    result[++resIndex] = iteratee(value, index, array);
  }
  return result;
}
function arrayEach(array, iteratee) {
  var index = -1,
      length = array.length;
  while (++index < length) {
    if (iteratee(array[index], index, array) === false) {
      break;
    }
  }
  return array;
}
function arraySum(array) {
  return arrayReduce(array, (function(a, b) {
    return (a + b);
  }), 0);
}
function arrayMax(array) {
  return arrayReduce(array, (function(a, b) {
    return (a > b ? a : b);
  }), Array.isArray(array) ? array[0] : void 0);
}
function arrayMin(array) {
  return arrayReduce(array, (function(a, b) {
    return (a < b ? a : b);
  }), Array.isArray(array) ? array[0] : void 0);
}
function arrayAvg(array) {
  if (!array.length) {
    return 0;
  }
  return arraySum(array) / array.length;
}
function arrayFlatten(array) {
  return arrayReduce(array, (function(initial, value) {
    return initial.concat(Array.isArray(value) ? arrayFlatten(value) : value);
  }), []);
}
function arrayUnique(array) {
  var unique = [];
  arrayEach(array, (function(value) {
    if (unique.indexOf(value) === -1) {
      unique.push(value);
    }
  }));
  return unique;
}
function arrayIncludes(array, searchElement, fromIndex) {
  if (array == null) {
    throw new TypeError('"array" is null or not defined');
  }
  var o = Object(array);
  var len = o.length >>> 0;
  if (len === 0) {
    return false;
  }
  var n = fromIndex | 0;
  var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);
  while (k < len) {
    if (o[k] === searchElement) {
      return true;
    }
    k++;
  }
  return false;
}

//# 
},{}],44:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  isIE8: {get: function() {
      return isIE8;
    }},
  isIE9: {get: function() {
      return isIE9;
    }},
  isSafari: {get: function() {
      return isSafari;
    }},
  isChrome: {get: function() {
      return isChrome;
    }},
  isMobileBrowser: {get: function() {
      return isMobileBrowser;
    }},
  __esModule: {value: true}
});
var _isIE8 = !(document.createTextNode('test').textContent);
function isIE8() {
  return _isIE8;
}
var _isIE9 = !!(document.documentMode);
function isIE9() {
  return _isIE9;
}
var _isSafari = (/Safari/.test(navigator.userAgent) && /Apple Computer/.test(navigator.vendor));
function isSafari() {
  return _isSafari;
}
var _isChrome = (/Chrome/.test(navigator.userAgent) && /Google/.test(navigator.vendor));
function isChrome() {
  return _isChrome;
}
function isMobileBrowser(userAgent) {
  if (!userAgent) {
    userAgent = navigator.userAgent;
  }
  return (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent));
}

//# 
},{}],45:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  spreadsheetColumnLabel: {get: function() {
      return spreadsheetColumnLabel;
    }},
  spreadsheetColumnIndex: {get: function() {
      return spreadsheetColumnIndex;
    }},
  createSpreadsheetData: {get: function() {
      return createSpreadsheetData;
    }},
  createSpreadsheetObjectData: {get: function() {
      return createSpreadsheetObjectData;
    }},
  createEmptySpreadsheetData: {get: function() {
      return createEmptySpreadsheetData;
    }},
  translateRowsToColumns: {get: function() {
      return translateRowsToColumns;
    }},
  cellMethodLookupFactory: {get: function() {
      return cellMethodLookupFactory;
    }},
  __esModule: {value: true}
});
var $___46__46__47_browser__,
    $__object__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var getPrototypeOf = ($__object__ = _dereq_("object"), $__object__ && $__object__.__esModule && $__object__ || {default: $__object__}).getPrototypeOf;
var COLUMN_LABEL_BASE = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
var COLUMN_LABEL_BASE_LENGTH = COLUMN_LABEL_BASE.length;
function spreadsheetColumnLabel(index) {
  var dividend = index + 1;
  var columnLabel = '';
  var modulo;
  while (dividend > 0) {
    modulo = (dividend - 1) % COLUMN_LABEL_BASE_LENGTH;
    columnLabel = String.fromCharCode(65 + modulo) + columnLabel;
    dividend = parseInt((dividend - modulo) / COLUMN_LABEL_BASE_LENGTH, 10);
  }
  return columnLabel;
}
function spreadsheetColumnIndex(label) {
  var result = 0;
  if (label) {
    for (var i = 0,
        j = label.length - 1; i < label.length; i += 1, j -= 1) {
      result += Math.pow(COLUMN_LABEL_BASE_LENGTH, j) * (COLUMN_LABEL_BASE.indexOf(label[i]) + 1);
    }
  }
  --result;
  return result;
}
function createSpreadsheetData() {
  var rows = arguments[0] !== (void 0) ? arguments[0] : 100;
  var columns = arguments[1] !== (void 0) ? arguments[1] : 4;
  var _rows = [],
      i,
      j;
  for (i = 0; i < rows; i++) {
    var row = [];
    for (j = 0; j < columns; j++) {
      row.push(spreadsheetColumnLabel(j) + (i + 1));
    }
    _rows.push(row);
  }
  return _rows;
}
function createSpreadsheetObjectData() {
  var rows = arguments[0] !== (void 0) ? arguments[0] : 100;
  var colCount = arguments[1] !== (void 0) ? arguments[1] : 4;
  var _rows = [],
      i,
      j;
  for (i = 0; i < rows; i++) {
    var row = {};
    for (j = 0; j < colCount; j++) {
      row['prop' + j] = spreadsheetColumnLabel(j) + (i + 1);
    }
    _rows.push(row);
  }
  return _rows;
}
function createEmptySpreadsheetData(rows, columns) {
  var data = [];
  var row;
  for (var i = 0; i < rows; i++) {
    row = [];
    for (var j = 0; j < columns; j++) {
      row.push('');
    }
    data.push(row);
  }
  return data;
}
function translateRowsToColumns(input) {
  var i,
      ilen,
      j,
      jlen,
      output = [],
      olen = 0;
  for (i = 0, ilen = input.length; i < ilen; i++) {
    for (j = 0, jlen = input[i].length; j < jlen; j++) {
      if (j == olen) {
        output.push([]);
        olen++;
      }
      output[j].push(input[i][j]);
    }
  }
  return output;
}
function cellMethodLookupFactory(methodName, allowUndefined) {
  allowUndefined = typeof allowUndefined == 'undefined' ? true : allowUndefined;
  return function cellMethodLookup(row, col) {
    return (function getMethodFromProperties(properties) {
      if (!properties) {
        return;
      } else if (properties.hasOwnProperty(methodName) && properties[methodName] !== void 0) {
        return properties[methodName];
      } else if (properties.hasOwnProperty('type') && properties.type) {
        var type;
        if (typeof properties.type != 'string') {
          throw new Error('Cell type must be a string ');
        }
        type = translateTypeNameToObject(properties.type);
        if (type.hasOwnProperty(methodName)) {
          return type[methodName];
        } else if (allowUndefined) {
          return;
        }
      }
      return getMethodFromProperties(getPrototypeOf(properties));
    })(typeof row == 'number' ? this.getCellMeta(row, col) : row);
  };
  function translateTypeNameToObject(typeName) {
    var type = Handsontable.cellTypes[typeName];
    if (typeof type == 'undefined') {
      throw new Error('You declared cell type "' + typeName + '" as a string that is not mapped to a known object. ' + 'Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');
    }
    return type;
  }
}

//# 
},{"browser":24,"object":53}],46:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  getNormalizedDate: {get: function() {
      return getNormalizedDate;
    }},
  __esModule: {value: true}
});
function getNormalizedDate(dateString) {
  var nativeDate = new Date(dateString);
  if (!isNaN(new Date(dateString + 'T00:00').getDate())) {
    return new Date(nativeDate.getTime() + nativeDate.getTimezoneOffset() * 60000);
  }
  return nativeDate;
}

//# 
},{}],47:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  getParent: {get: function() {
      return getParent;
    }},
  closest: {get: function() {
      return closest;
    }},
  closestDown: {get: function() {
      return closestDown;
    }},
  isChildOf: {get: function() {
      return isChildOf;
    }},
  isChildOfWebComponentTable: {get: function() {
      return isChildOfWebComponentTable;
    }},
  polymerWrap: {get: function() {
      return polymerWrap;
    }},
  polymerUnwrap: {get: function() {
      return polymerUnwrap;
    }},
  index: {get: function() {
      return index;
    }},
  overlayContainsElement: {get: function() {
      return overlayContainsElement;
    }},
  hasClass: {get: function() {
      return hasClass;
    }},
  addClass: {get: function() {
      return addClass;
    }},
  removeClass: {get: function() {
      return removeClass;
    }},
  removeTextNodes: {get: function() {
      return removeTextNodes;
    }},
  empty: {get: function() {
      return empty;
    }},
  HTML_CHARACTERS: {get: function() {
      return HTML_CHARACTERS;
    }},
  fastInnerHTML: {get: function() {
      return fastInnerHTML;
    }},
  fastInnerText: {get: function() {
      return fastInnerText;
    }},
  isVisible: {get: function() {
      return isVisible;
    }},
  offset: {get: function() {
      return offset;
    }},
  getWindowScrollTop: {get: function() {
      return getWindowScrollTop;
    }},
  getWindowScrollLeft: {get: function() {
      return getWindowScrollLeft;
    }},
  getScrollTop: {get: function() {
      return getScrollTop;
    }},
  getScrollLeft: {get: function() {
      return getScrollLeft;
    }},
  getScrollableElement: {get: function() {
      return getScrollableElement;
    }},
  getTrimmingContainer: {get: function() {
      return getTrimmingContainer;
    }},
  getStyle: {get: function() {
      return getStyle;
    }},
  getComputedStyle: {get: function() {
      return getComputedStyle;
    }},
  outerWidth: {get: function() {
      return outerWidth;
    }},
  outerHeight: {get: function() {
      return outerHeight;
    }},
  innerHeight: {get: function() {
      return innerHeight;
    }},
  innerWidth: {get: function() {
      return innerWidth;
    }},
  addEvent: {get: function() {
      return addEvent;
    }},
  removeEvent: {get: function() {
      return removeEvent;
    }},
  getCaretPosition: {get: function() {
      return getCaretPosition;
    }},
  getSelectionEndPosition: {get: function() {
      return getSelectionEndPosition;
    }},
  getSelectionText: {get: function() {
      return getSelectionText;
    }},
  setCaretPosition: {get: function() {
      return setCaretPosition;
    }},
  getScrollbarWidth: {get: function() {
      return getScrollbarWidth;
    }},
  hasVerticalScrollbar: {get: function() {
      return hasVerticalScrollbar;
    }},
  hasHorizontalScrollbar: {get: function() {
      return hasHorizontalScrollbar;
    }},
  setOverlayPosition: {get: function() {
      return setOverlayPosition;
    }},
  getCssTransform: {get: function() {
      return getCssTransform;
    }},
  resetCssTransform: {get: function() {
      return resetCssTransform;
    }},
  isInput: {get: function() {
      return isInput;
    }},
  isOutsideInput: {get: function() {
      return isOutsideInput;
    }},
  __esModule: {value: true}
});
var $___46__46__47_browser__,
    $___46__46__47_feature__;
var $__0 = ($___46__46__47_browser__ = _dereq_("../browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}),
    isIE8 = $__0.isIE8,
    isIE9 = $__0.isIE9,
    isSafari = $__0.isSafari;
var hasCaptionProblem = ($___46__46__47_feature__ = _dereq_("../feature"), $___46__46__47_feature__ && $___46__46__47_feature__.__esModule && $___46__46__47_feature__ || {default: $___46__46__47_feature__}).hasCaptionProblem;
function getParent(element) {
  var level = arguments[1] !== (void 0) ? arguments[1] : 0;
  var iteration = -1;
  var parent = null;
  while (element != null) {
    if (iteration === level) {
      parent = element;
      break;
    }
    if (element.host && element.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {
      element = element.host;
    } else {
      iteration++;
      element = element.parentNode;
    }
  }
  return parent;
}
function closest(element, nodes, until) {
  while (element != null && element !== until) {
    if (element.nodeType === Node.ELEMENT_NODE && (nodes.indexOf(element.nodeName) > -1 || nodes.indexOf(element) > -1)) {
      return element;
    }
    if (element.host && element.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {
      element = element.host;
    } else {
      element = element.parentNode;
    }
  }
  return null;
}
function closestDown(element, nodes, until) {
  var matched = [];
  while (element) {
    element = closest(element, nodes, until);
    if (!element || (until && !until.contains(element))) {
      break;
    }
    matched.push(element);
    if (element.host && element.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {
      element = element.host;
    } else {
      element = element.parentNode;
    }
  }
  var length = matched.length;
  return length ? matched[length - 1] : null;
}
function isChildOf(child, parent) {
  var node = child.parentNode;
  var queriedParents = [];
  if (typeof parent === 'string') {
    queriedParents = Array.prototype.slice.call(document.querySelectorAll(parent), 0);
  } else {
    queriedParents.push(parent);
  }
  while (node != null) {
    if (queriedParents.indexOf(node) > -1) {
      return true;
    }
    node = node.parentNode;
  }
  return false;
}
function isChildOfWebComponentTable(element) {
  var hotTableName = 'hot-table',
      result = false,
      parentNode;
  parentNode = polymerWrap(element);
  function isHotTable(element) {
    return element.nodeType === Node.ELEMENT_NODE && element.nodeName === hotTableName.toUpperCase();
  }
  while (parentNode != null) {
    if (isHotTable(parentNode)) {
      result = true;
      break;
    } else if (parentNode.host && parentNode.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {
      result = isHotTable(parentNode.host);
      if (result) {
        break;
      }
      parentNode = parentNode.host;
    }
    parentNode = parentNode.parentNode;
  }
  return result;
}
function polymerWrap(element) {
  return typeof Polymer !== 'undefined' && typeof wrap === 'function' ? wrap(element) : element;
}
function polymerUnwrap(element) {
  return typeof Polymer !== 'undefined' && typeof unwrap === 'function' ? unwrap(element) : element;
}
function index(element) {
  var i = 0;
  if (element.previousSibling) {
    while (element = element.previousSibling) {
      ++i;
    }
  }
  return i;
}
function overlayContainsElement(overlayType, element) {
  var overlayElement = document.querySelector('.ht_clone_' + overlayType);
  return overlayElement ? overlayElement.contains(element) : null;
}
var classListSupport = document.documentElement.classList ? true : false;
var _hasClass,
    _addClass,
    _removeClass;
function filterEmptyClassNames(classNames) {
  var len = 0,
      result = [];
  if (!classNames || !classNames.length) {
    return result;
  }
  while (classNames[len]) {
    result.push(classNames[len]);
    len++;
  }
  return result;
}
if (classListSupport) {
  var isSupportMultipleClassesArg = (function() {
    var element = document.createElement('div');
    element.classList.add('test', 'test2');
    return element.classList.contains('test2');
  }());
  _hasClass = function _hasClass(element, className) {
    if (className === '') {
      return false;
    }
    return element.classList.contains(className);
  };
  _addClass = function _addClass(element, className) {
    var len = 0;
    if (typeof className === 'string') {
      className = className.split(' ');
    }
    className = filterEmptyClassNames(className);
    if (isSupportMultipleClassesArg) {
      element.classList.add.apply(element.classList, className);
    } else {
      while (className && className[len]) {
        element.classList.add(className[len]);
        len++;
      }
    }
  };
  _removeClass = function _removeClass(element, className) {
    var len = 0;
    if (typeof className === 'string') {
      className = className.split(' ');
    }
    className = filterEmptyClassNames(className);
    if (isSupportMultipleClassesArg) {
      element.classList.remove.apply(element.classList, className);
    } else {
      while (className && className[len]) {
        element.classList.remove(className[len]);
        len++;
      }
    }
  };
} else {
  var createClassNameRegExp = function createClassNameRegExp(className) {
    return new RegExp('(\\s|^)' + className + '(\\s|$)');
  };
  _hasClass = function _hasClass(element, className) {
    return element.className.match(createClassNameRegExp(className)) ? true : false;
  };
  _addClass = function _addClass(element, className) {
    var len = 0,
        _className = element.className;
    if (typeof className === 'string') {
      className = className.split(' ');
    }
    if (_className === '') {
      _className = className.join(' ');
    } else {
      while (className && className[len]) {
        if (!createClassNameRegExp(className[len]).test(_className)) {
          _className += ' ' + className[len];
        }
        len++;
      }
    }
    element.className = _className;
  };
  _removeClass = function _removeClass(element, className) {
    var len = 0,
        _className = element.className;
    if (typeof className === 'string') {
      className = className.split(' ');
    }
    while (className && className[len]) {
      _className = _className.replace(createClassNameRegExp(className[len]), ' ').trim();
      len++;
    }
    if (element.className !== _className) {
      element.className = _className;
    }
  };
}
function hasClass(element, className) {
  return _hasClass(element, className);
}
function addClass(element, className) {
  return _addClass(element, className);
}
function removeClass(element, className) {
  return _removeClass(element, className);
}
function removeTextNodes(element, parent) {
  if (element.nodeType === 3) {
    parent.removeChild(element);
  } else if (['TABLE', 'THEAD', 'TBODY', 'TFOOT', 'TR'].indexOf(element.nodeName) > -1) {
    var childs = element.childNodes;
    for (var i = childs.length - 1; i >= 0; i--) {
      removeTextNodes(childs[i], element);
    }
  }
}
function empty(element) {
  var child;
  while (child = element.lastChild) {
    element.removeChild(child);
  }
}
var HTML_CHARACTERS = /(<(.*)>|&(.*);)/;
function fastInnerHTML(element, content) {
  if (HTML_CHARACTERS.test(content)) {
    element.innerHTML = content;
  } else {
    fastInnerText(element, content);
  }
}
var textContextSupport = document.createTextNode('test').textContent ? true : false;
function fastInnerText(element, content) {
  var child = element.firstChild;
  if (child && child.nodeType === 3 && child.nextSibling === null) {
    if (textContextSupport) {
      child.textContent = content;
    } else {
      child.data = content;
    }
  } else {
    empty(element);
    element.appendChild(document.createTextNode(content));
  }
}
function isVisible(elem) {
  var next = elem;
  while (polymerUnwrap(next) !== document.documentElement) {
    if (next === null) {
      return false;
    } else if (next.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {
      if (next.host) {
        if (next.host.impl) {
          return isVisible(next.host.impl);
        } else if (next.host) {
          return isVisible(next.host);
        } else {
          throw new Error('Lost in Web Components world');
        }
      } else {
        return false;
      }
    } else if (next.style.display === 'none') {
      return false;
    }
    next = next.parentNode;
  }
  return true;
}
function offset(elem) {
  var offsetLeft,
      offsetTop,
      lastElem,
      docElem,
      box;
  docElem = document.documentElement;
  if (hasCaptionProblem() && elem.firstChild && elem.firstChild.nodeName === 'CAPTION') {
    box = elem.getBoundingClientRect();
    return {
      top: box.top + (window.pageYOffset || docElem.scrollTop) - (docElem.clientTop || 0),
      left: box.left + (window.pageXOffset || docElem.scrollLeft) - (docElem.clientLeft || 0)
    };
  }
  offsetLeft = elem.offsetLeft;
  offsetTop = elem.offsetTop;
  lastElem = elem;
  while (elem = elem.offsetParent) {
    if (elem === document.body) {
      break;
    }
    offsetLeft += elem.offsetLeft;
    offsetTop += elem.offsetTop;
    lastElem = elem;
  }
  if (lastElem && lastElem.style.position === 'fixed') {
    offsetLeft += window.pageXOffset || docElem.scrollLeft;
    offsetTop += window.pageYOffset || docElem.scrollTop;
  }
  return {
    left: offsetLeft,
    top: offsetTop
  };
}
function getWindowScrollTop() {
  var res = window.scrollY;
  if (res === void 0) {
    res = document.documentElement.scrollTop;
  }
  return res;
}
function getWindowScrollLeft() {
  var res = window.scrollX;
  if (res === void 0) {
    res = document.documentElement.scrollLeft;
  }
  return res;
}
function getScrollTop(element) {
  if (element === window) {
    return getWindowScrollTop();
  } else {
    return element.scrollTop;
  }
}
function getScrollLeft(element) {
  if (element === window) {
    return getWindowScrollLeft();
  } else {
    return element.scrollLeft;
  }
}
function getScrollableElement(element) {
  var el = element.parentNode,
      props = ['auto', 'scroll'],
      overflow,
      overflowX,
      overflowY,
      computedStyle = '',
      computedOverflow = '',
      computedOverflowY = '',
      computedOverflowX = '';
  while (el && el.style && document.body !== el) {
    overflow = el.style.overflow;
    overflowX = el.style.overflowX;
    overflowY = el.style.overflowY;
    if (overflow == 'scroll' || overflowX == 'scroll' || overflowY == 'scroll') {
      return el;
    } else if (window.getComputedStyle) {
      computedStyle = window.getComputedStyle(el);
      computedOverflow = computedStyle.getPropertyValue('overflow');
      computedOverflowY = computedStyle.getPropertyValue('overflow-y');
      computedOverflowX = computedStyle.getPropertyValue('overflow-x');
      if (computedOverflow === 'scroll' || computedOverflowX === 'scroll' || computedOverflowY === 'scroll') {
        return el;
      }
    }
    if (el.clientHeight <= el.scrollHeight && (props.indexOf(overflowY) !== -1 || props.indexOf(overflow) !== -1 || props.indexOf(computedOverflow) !== -1 || props.indexOf(computedOverflowY) !== -1)) {
      return el;
    }
    if (el.clientWidth <= el.scrollWidth && (props.indexOf(overflowX) !== -1 || props.indexOf(overflow) !== -1 || props.indexOf(computedOverflow) !== -1 || props.indexOf(computedOverflowX) !== -1)) {
      return el;
    }
    el = el.parentNode;
  }
  return window;
}
function getTrimmingContainer(base) {
  var el = base.parentNode;
  while (el && el.style && document.body !== el) {
    if (el.style.overflow !== 'visible' && el.style.overflow !== '') {
      return el;
    } else if (window.getComputedStyle) {
      var computedStyle = window.getComputedStyle(el);
      if (computedStyle.getPropertyValue('overflow') !== 'visible' && computedStyle.getPropertyValue('overflow') !== '') {
        return el;
      }
    }
    el = el.parentNode;
  }
  return window;
}
function getStyle(element, prop) {
  if (!element) {
    return;
  } else if (element === window) {
    if (prop === 'width') {
      return window.innerWidth + 'px';
    } else if (prop === 'height') {
      return window.innerHeight + 'px';
    }
    return;
  }
  var styleProp = element.style[prop],
      computedStyle;
  if (styleProp !== '' && styleProp !== void 0) {
    return styleProp;
  } else {
    computedStyle = getComputedStyle(element);
    if (computedStyle[prop] !== '' && computedStyle[prop] !== void 0) {
      return computedStyle[prop];
    }
    return void 0;
  }
}
function getComputedStyle(element) {
  return element.currentStyle || document.defaultView.getComputedStyle(element);
}
function outerWidth(element) {
  return element.offsetWidth;
}
function outerHeight(elem) {
  if (hasCaptionProblem() && elem.firstChild && elem.firstChild.nodeName === 'CAPTION') {
    return elem.offsetHeight + elem.firstChild.offsetHeight;
  } else {
    return elem.offsetHeight;
  }
}
function innerHeight(element) {
  return element.clientHeight || element.innerHeight;
}
function innerWidth(element) {
  return element.clientWidth || element.innerWidth;
}
function addEvent(element, event, callback) {
  if (window.addEventListener) {
    element.addEventListener(event, callback, false);
  } else {
    element.attachEvent('on' + event, callback);
  }
}
function removeEvent(element, event, callback) {
  if (window.removeEventListener) {
    element.removeEventListener(event, callback, false);
  } else {
    element.detachEvent('on' + event, callback);
  }
}
function getCaretPosition(el) {
  if (el.selectionStart) {
    return el.selectionStart;
  } else if (document.selection) {
    el.focus();
    var r = document.selection.createRange();
    if (r == null) {
      return 0;
    }
    var re = el.createTextRange();
    var rc = re.duplicate();
    re.moveToBookmark(r.getBookmark());
    rc.setEndPoint('EndToStart', re);
    return rc.text.length;
  }
  return 0;
}
function getSelectionEndPosition(el) {
  if (el.selectionEnd) {
    return el.selectionEnd;
  } else if (document.selection) {
    var r = document.selection.createRange();
    if (r == null) {
      return 0;
    }
    var re = el.createTextRange();
    return re.text.indexOf(r.text) + r.text.length;
  }
}
function getSelectionText() {
  var text = '';
  if (window.getSelection) {
    text = window.getSelection().toString();
  } else if (document.selection && document.selection.type !== 'Control') {
    text = document.selection.createRange().text;
  }
  return text;
}
function setCaretPosition(element, pos, endPos) {
  if (endPos === void 0) {
    endPos = pos;
  }
  if (element.setSelectionRange) {
    element.focus();
    try {
      element.setSelectionRange(pos, endPos);
    } catch (err) {
      var elementParent = element.parentNode;
      var parentDisplayValue = elementParent.style.display;
      elementParent.style.display = 'block';
      element.setSelectionRange(pos, endPos);
      elementParent.style.display = parentDisplayValue;
    }
  } else if (element.createTextRange) {
    var range = element.createTextRange();
    range.collapse(true);
    range.moveEnd('character', endPos);
    range.moveStart('character', pos);
    range.select();
  }
}
var cachedScrollbarWidth;
function walkontableCalculateScrollbarWidth() {
  var inner = document.createElement('div');
  inner.style.height = '200px';
  inner.style.width = '100%';
  var outer = document.createElement('div');
  outer.style.boxSizing = 'content-box';
  outer.style.height = '150px';
  outer.style.left = '0px';
  outer.style.overflow = 'hidden';
  outer.style.position = 'absolute';
  outer.style.top = '0px';
  outer.style.width = '200px';
  outer.style.visibility = 'hidden';
  outer.appendChild(inner);
  (document.body || document.documentElement).appendChild(outer);
  var w1 = inner.offsetWidth;
  outer.style.overflow = 'scroll';
  var w2 = inner.offsetWidth;
  if (w1 == w2) {
    w2 = outer.clientWidth;
  }
  (document.body || document.documentElement).removeChild(outer);
  return (w1 - w2);
}
function getScrollbarWidth() {
  if (cachedScrollbarWidth === void 0) {
    cachedScrollbarWidth = walkontableCalculateScrollbarWidth();
  }
  return cachedScrollbarWidth;
}
function hasVerticalScrollbar(element) {
  return element.offsetWidth !== element.clientWidth;
}
function hasHorizontalScrollbar(element) {
  return element.offsetHeight !== element.clientHeight;
}
function setOverlayPosition(overlayElem, left, top) {
  if (isIE8() || isIE9()) {
    overlayElem.style.top = top;
    overlayElem.style.left = left;
  } else if (isSafari()) {
    overlayElem.style['-webkit-transform'] = 'translate3d(' + left + ',' + top + ',0)';
  } else {
    overlayElem.style.transform = 'translate3d(' + left + ',' + top + ',0)';
  }
}
function getCssTransform(element) {
  var transform;
  if (element.style.transform && (transform = element.style.transform) !== '') {
    return ['transform', transform];
  } else if (element.style['-webkit-transform'] && (transform = element.style['-webkit-transform']) !== '') {
    return ['-webkit-transform', transform];
  }
  return -1;
}
function resetCssTransform(element) {
  if (element.style.transform && element.style.transform !== '') {
    element.style.transform = '';
  } else if (element.style['-webkit-transform'] && element.style['-webkit-transform'] !== '') {
    element.style['-webkit-transform'] = '';
  }
}
function isInput(element) {
  var inputs = ['INPUT', 'SELECT', 'TEXTAREA'];
  return element && (inputs.indexOf(element.nodeName) > -1 || element.contentEditable === 'true');
}
function isOutsideInput(element) {
  return isInput(element) && element.className.indexOf('handsontableInput') == -1 && element.className.indexOf('copyPaste') == -1;
}

//# 
},{"../browser":44,"../feature":49}],48:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  stopImmediatePropagation: {get: function() {
      return stopImmediatePropagation;
    }},
  isImmediatePropagationStopped: {get: function() {
      return isImmediatePropagationStopped;
    }},
  stopPropagation: {get: function() {
      return stopPropagation;
    }},
  pageX: {get: function() {
      return pageX;
    }},
  pageY: {get: function() {
      return pageY;
    }},
  isRightClick: {get: function() {
      return isRightClick;
    }},
  isLeftClick: {get: function() {
      return isLeftClick;
    }},
  __esModule: {value: true}
});
var $__element__;
var $__0 = ($__element__ = _dereq_("element"), $__element__ && $__element__.__esModule && $__element__ || {default: $__element__}),
    getWindowScrollTop = $__0.getWindowScrollTop,
    getWindowScrollLeft = $__0.getWindowScrollLeft;
function stopImmediatePropagation(event) {
  event.isImmediatePropagationEnabled = false;
  event.cancelBubble = true;
}
function isImmediatePropagationStopped(event) {
  return event.isImmediatePropagationEnabled === false;
}
function stopPropagation(event) {
  if (typeof event.stopPropagation === 'function') {
    event.stopPropagation();
  } else {
    event.cancelBubble = true;
  }
}
function pageX(event) {
  if (event.pageX) {
    return event.pageX;
  }
  return event.clientX + getWindowScrollLeft();
}
function pageY(event) {
  if (event.pageY) {
    return event.pageY;
  }
  return event.clientY + getWindowScrollTop();
}
function isRightClick(event) {
  return event.button === 2;
}
function isLeftClick(event) {
  return event.button === 0;
}

//# 
},{"element":47}],49:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  requestAnimationFrame: {get: function() {
      return requestAnimationFrame;
    }},
  cancelAnimationFrame: {get: function() {
      return cancelAnimationFrame;
    }},
  isTouchSupported: {get: function() {
      return isTouchSupported;
    }},
  isWebComponentSupportedNatively: {get: function() {
      return isWebComponentSupportedNatively;
    }},
  hasCaptionProblem: {get: function() {
      return hasCaptionProblem;
    }},
  getComparisonFunction: {get: function() {
      return getComparisonFunction;
    }},
  __esModule: {value: true}
});
var lastTime = 0;
var vendors = ['ms', 'moz', 'webkit', 'o'];
var _requestAnimationFrame = window.requestAnimationFrame;
var _cancelAnimationFrame = window.cancelAnimationFrame;
for (var x = 0; x < vendors.length && !_requestAnimationFrame; ++x) {
  _requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];
  _cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] || window[vendors[x] + 'CancelRequestAnimationFrame'];
}
if (!_requestAnimationFrame) {
  _requestAnimationFrame = function(callback) {
    var currTime = new Date().getTime();
    var timeToCall = Math.max(0, 16 - (currTime - lastTime));
    var id = window.setTimeout(function() {
      callback(currTime + timeToCall);
    }, timeToCall);
    lastTime = currTime + timeToCall;
    return id;
  };
}
if (!_cancelAnimationFrame) {
  _cancelAnimationFrame = function(id) {
    clearTimeout(id);
  };
}
function requestAnimationFrame(callback) {
  return _requestAnimationFrame.call(window, callback);
}
function cancelAnimationFrame(id) {
  _cancelAnimationFrame.call(window, id);
}
function isTouchSupported() {
  return ('ontouchstart' in window);
}
function isWebComponentSupportedNatively() {
  var test = document.createElement('div');
  return test.createShadowRoot && test.createShadowRoot.toString().match(/\[native code\]/) ? true : false;
}
var _hasCaptionProblem;
function detectCaptionProblem() {
  var TABLE = document.createElement('TABLE');
  TABLE.style.borderSpacing = 0;
  TABLE.style.borderWidth = 0;
  TABLE.style.padding = 0;
  var TBODY = document.createElement('TBODY');
  TABLE.appendChild(TBODY);
  TBODY.appendChild(document.createElement('TR'));
  TBODY.firstChild.appendChild(document.createElement('TD'));
  TBODY.firstChild.firstChild.innerHTML = '<tr><td>t<br>t</td></tr>';
  var CAPTION = document.createElement('CAPTION');
  CAPTION.innerHTML = 'c<br>c<br>c<br>c';
  CAPTION.style.padding = 0;
  CAPTION.style.margin = 0;
  TABLE.insertBefore(CAPTION, TBODY);
  document.body.appendChild(TABLE);
  _hasCaptionProblem = (TABLE.offsetHeight < 2 * TABLE.lastChild.offsetHeight);
  document.body.removeChild(TABLE);
}
function hasCaptionProblem() {
  if (_hasCaptionProblem === void 0) {
    detectCaptionProblem();
  }
  return _hasCaptionProblem;
}
var comparisonFunction;
function getComparisonFunction(language) {
  var options = arguments[1] !== (void 0) ? arguments[1] : {};
  if (comparisonFunction) {
    return comparisonFunction;
  }
  if (typeof Intl === 'object') {
    comparisonFunction = new Intl.Collator(language, options).compare;
  } else if (typeof String.prototype.localeCompare === 'function') {
    comparisonFunction = (function(a, b) {
      return (a + '').localeCompare(b);
    });
  } else {
    comparisonFunction = (function(a, b) {
      if (a === b) {
        return 0;
      }
      return a > b ? -1 : 1;
    });
  }
  return comparisonFunction;
}

//# 
},{}],50:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  isFunction: {get: function() {
      return isFunction;
    }},
  proxy: {get: function() {
      return proxy;
    }},
  throttle: {get: function() {
      return throttle;
    }},
  throttleAfterHits: {get: function() {
      return throttleAfterHits;
    }},
  debounce: {get: function() {
      return debounce;
    }},
  pipe: {get: function() {
      return pipe;
    }},
  partial: {get: function() {
      return partial;
    }},
  curry: {get: function() {
      return curry;
    }},
  curryRight: {get: function() {
      return curryRight;
    }},
  __esModule: {value: true}
});
var $__array__;
var arrayReduce = ($__array__ = _dereq_("array"), $__array__ && $__array__.__esModule && $__array__ || {default: $__array__}).arrayReduce;
function isFunction(func) {
  return typeof func === 'function';
}
function proxy(func, context) {
  return function() {
    return func.apply(context, arguments);
  };
}
function throttle(func) {
  var wait = arguments[1] !== (void 0) ? arguments[1] : 200;
  var lastCalled = 0;
  var result = {lastCallThrottled: true};
  var lastTimer = null;
  function _throttle() {
    var $__1 = this;
    var args = arguments;
    var stamp = Date.now();
    var needCall = false;
    result.lastCallThrottled = true;
    if (!lastCalled) {
      lastCalled = stamp;
      needCall = true;
    }
    var remaining = wait - (stamp - lastCalled);
    if (needCall) {
      result.lastCallThrottled = false;
      func.apply(this, args);
    } else {
      if (lastTimer) {
        clearTimeout(lastTimer);
      }
      lastTimer = setTimeout((function() {
        result.lastCallThrottled = false;
        func.apply($__1, args);
        lastCalled = 0;
        lastTimer = void 0;
      }), remaining);
    }
    return result;
  }
  return _throttle;
}
function throttleAfterHits(func) {
  var wait = arguments[1] !== (void 0) ? arguments[1] : 200;
  var hits = arguments[2] !== (void 0) ? arguments[2] : 10;
  var funcThrottle = throttle(func, wait);
  var remainHits = hits;
  function _clearHits() {
    remainHits = hits;
  }
  function _throttleAfterHits() {
    if (remainHits) {
      remainHits--;
      return func.apply(this, arguments);
    }
    return funcThrottle.apply(this, arguments);
  }
  _throttleAfterHits.clearHits = _clearHits;
  return _throttleAfterHits;
}
function debounce(func) {
  var wait = arguments[1] !== (void 0) ? arguments[1] : 200;
  var lastTimer = null;
  var result;
  function _debounce() {
    var $__1 = this;
    var args = arguments;
    if (lastTimer) {
      clearTimeout(lastTimer);
    }
    lastTimer = setTimeout((function() {
      result = func.apply($__1, args);
    }), wait);
    return result;
  }
  return _debounce;
}
function pipe() {
  for (var functions = [],
      $__2 = 0; $__2 < arguments.length; $__2++)
    functions[$__2] = arguments[$__2];
  var $__5 = functions,
      firstFunc = $__5[0],
      restFunc = Array.prototype.slice.call($__5, 1);
  return function _pipe() {
    return arrayReduce(restFunc, (function(acc, fn) {
      return fn(acc);
    }), firstFunc.apply(this, arguments));
  };
}
function partial(func) {
  for (var params = [],
      $__3 = 1; $__3 < arguments.length; $__3++)
    params[$__3 - 1] = arguments[$__3];
  return function _partial() {
    for (var restParams = [],
        $__4 = 0; $__4 < arguments.length; $__4++)
      restParams[$__4] = arguments[$__4];
    return func.apply(this, params.concat(restParams));
  };
}
function curry(func) {
  var argsLength = func.length;
  function given(argsSoFar) {
    return function _curry() {
      for (var params = [],
          $__4 = 0; $__4 < arguments.length; $__4++)
        params[$__4] = arguments[$__4];
      var passedArgsSoFar = argsSoFar.concat(params);
      var result;
      if (passedArgsSoFar.length >= argsLength) {
        result = func.apply(this, passedArgsSoFar);
      } else {
        result = given(passedArgsSoFar);
      }
      return result;
    };
  }
  return given([]);
}
function curryRight(func) {
  var argsLength = func.length;
  function given(argsSoFar) {
    return function _curry() {
      for (var params = [],
          $__4 = 0; $__4 < arguments.length; $__4++)
        params[$__4] = arguments[$__4];
      var passedArgsSoFar = argsSoFar.concat(params.reverse());
      var result;
      if (passedArgsSoFar.length >= argsLength) {
        result = func.apply(this, passedArgsSoFar);
      } else {
        result = given(passedArgsSoFar);
      }
      return result;
    };
  }
  return given([]);
}

//# 
},{"array":43}],51:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  stringify: {get: function() {
      return stringify;
    }},
  isDefined: {get: function() {
      return isDefined;
    }},
  isUndefined: {get: function() {
      return isUndefined;
    }},
  isEmpty: {get: function() {
      return isEmpty;
    }},
  __esModule: {value: true}
});
function stringify(value) {
  switch (typeof value) {
    case 'string':
    case 'number':
      return value + '';
    case 'object':
      if (value === null) {
        return '';
      } else {
        return value.toString();
      }
      break;
    case 'undefined':
      return '';
    default:
      return value.toString();
  }
}
function isDefined(variable) {
  return typeof variable !== 'undefined';
}
function isUndefined(variable) {
  return typeof variable === 'undefined';
}
function isEmpty(variable) {
  return variable === null || variable === '' || isUndefined(variable);
}

//# 
},{}],52:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  isNumeric: {get: function() {
      return isNumeric;
    }},
  rangeEach: {get: function() {
      return rangeEach;
    }},
  rangeEachReverse: {get: function() {
      return rangeEachReverse;
    }},
  valueAccordingPercent: {get: function() {
      return valueAccordingPercent;
    }},
  __esModule: {value: true}
});
function isNumeric(n) {
  var t = typeof n;
  return t == 'number' ? !isNaN(n) && isFinite(n) : t == 'string' ? !n.length ? false : n.length == 1 ? /\d/.test(n) : /^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(n) : t == 'object' ? !!n && typeof n.valueOf() == 'number' && !(n instanceof Date) : false;
}
function rangeEach(rangeFrom, rangeTo, iteratee) {
  var index = -1;
  if (typeof rangeTo === 'function') {
    iteratee = rangeTo;
    rangeTo = rangeFrom;
  } else {
    index = rangeFrom - 1;
  }
  while (++index <= rangeTo) {
    if (iteratee(index) === false) {
      break;
    }
  }
}
function rangeEachReverse(rangeFrom, rangeTo, iteratee) {
  var index = rangeFrom + 1;
  if (typeof rangeTo === 'function') {
    iteratee = rangeTo;
    rangeTo = 0;
  }
  while (--index >= rangeTo) {
    if (iteratee(index) === false) {
      break;
    }
  }
}
function valueAccordingPercent(value, percent) {
  percent = parseInt(percent.toString().replace('%', ''), 10);
  percent = parseInt(value * percent / 100);
  return percent;
}

//# 
},{}],53:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  duckSchema: {get: function() {
      return duckSchema;
    }},
  inherit: {get: function() {
      return inherit;
    }},
  extend: {get: function() {
      return extend;
    }},
  deepExtend: {get: function() {
      return deepExtend;
    }},
  deepClone: {get: function() {
      return deepClone;
    }},
  clone: {get: function() {
      return clone;
    }},
  mixin: {get: function() {
      return mixin;
    }},
  isObjectEquals: {get: function() {
      return isObjectEquals;
    }},
  isObject: {get: function() {
      return isObject;
    }},
  getPrototypeOf: {get: function() {
      return getPrototypeOf;
    }},
  defineGetter: {get: function() {
      return defineGetter;
    }},
  objectEach: {get: function() {
      return objectEach;
    }},
  getProperty: {get: function() {
      return getProperty;
    }},
  deepObjectSize: {get: function() {
      return deepObjectSize;
    }},
  createObjectPropListener: {get: function() {
      return createObjectPropListener;
    }},
  __esModule: {value: true}
});
var $__array__;
var arrayEach = ($__array__ = _dereq_("array"), $__array__ && $__array__.__esModule && $__array__ || {default: $__array__}).arrayEach;
function duckSchema(object) {
  var schema;
  if (Array.isArray(object)) {
    schema = [];
  } else {
    schema = {};
    objectEach(object, function(value, key) {
      if (key === '__children') {
        return;
      }
      if (value && typeof value === 'object' && !Array.isArray(value)) {
        schema[key] = duckSchema(value);
      } else if (Array.isArray(value)) {
        if (value.length && typeof value[0] === 'object' && !Array.isArray(value[0])) {
          schema[key] = [duckSchema(value[0])];
        } else {
          schema[key] = [];
        }
      } else {
        schema[key] = null;
      }
    });
  }
  return schema;
}
function inherit(Child, Parent) {
  Parent.prototype.constructor = Parent;
  Child.prototype = new Parent();
  Child.prototype.constructor = Child;
  return Child;
}
function extend(target, extension) {
  objectEach(extension, function(value, key) {
    target[key] = value;
  });
  return target;
}
function deepExtend(target, extension) {
  objectEach(extension, function(value, key) {
    if (extension[key] && typeof extension[key] === 'object') {
      if (!target[key]) {
        if (Array.isArray(extension[key])) {
          target[key] = [];
        } else if (Object.prototype.toString.call(extension[key]) === '[object Date]') {
          target[key] = extension[key];
        } else {
          target[key] = {};
        }
      }
      deepExtend(target[key], extension[key]);
    } else {
      target[key] = extension[key];
    }
  });
}
function deepClone(obj) {
  if (typeof obj === 'object') {
    return JSON.parse(JSON.stringify(obj));
  }
  return obj;
}
function clone(object) {
  var result = {};
  objectEach(object, (function(value, key) {
    result[key] = value;
  }));
  return result;
}
function mixin(Base) {
  for (var mixins = [],
      $__2 = 1; $__2 < arguments.length; $__2++)
    mixins[$__2 - 1] = arguments[$__2];
  if (!Base.MIXINS) {
    Base.MIXINS = [];
  }
  arrayEach(mixins, (function(mixin) {
    Base.MIXINS.push(mixin.MIXIN_NAME);
    objectEach(mixin, (function(value, key) {
      if (Base.prototype[key] !== void 0) {
        throw new Error(("Mixin conflict. Property '" + key + "' already exist and cannot be overwritten."));
      }
      if (typeof value === 'function') {
        Base.prototype[key] = value;
      } else {
        var getter = function _getter(propertyName, initialValue) {
          propertyName = '_' + propertyName;
          var initValue = (function(value) {
            if (Array.isArray(value) || isObject(value)) {
              value = deepClone(value);
            }
            return value;
          });
          return function() {
            if (this[propertyName] === void 0) {
              this[propertyName] = initValue(initialValue);
            }
            return this[propertyName];
          };
        };
        var setter = function _setter(propertyName) {
          propertyName = '_' + propertyName;
          return function(value) {
            this[propertyName] = value;
          };
        };
        Object.defineProperty(Base.prototype, key, {
          get: getter(key, value),
          set: setter(key),
          configurable: true
        });
      }
    }));
  }));
  return Base;
}
function isObjectEquals(object1, object2) {
  return JSON.stringify(object1) === JSON.stringify(object2);
}
function isObject(obj) {
  return Object.prototype.toString.call(obj) == '[object Object]';
}
function getPrototypeOf(obj) {
  var prototype;
  if (typeof obj.__proto__ == 'object') {
    prototype = obj.__proto__;
  } else {
    var oldConstructor,
        constructor = obj.constructor;
    if (typeof obj.constructor == 'function') {
      oldConstructor = constructor;
      if (delete obj.constructor) {
        constructor = obj.constructor;
        obj.constructor = oldConstructor;
      }
    }
    prototype = constructor ? constructor.prototype : null;
  }
  return prototype;
}
function defineGetter(object, property, value, options) {
  options.value = value;
  options.writable = options.writable !== false;
  options.enumerable = options.enumerable !== false;
  options.configurable = options.configurable !== false;
  Object.defineProperty(object, property, options);
}
function objectEach(object, iteratee) {
  for (var key in object) {
    if (!object.hasOwnProperty || (object.hasOwnProperty && object.hasOwnProperty(key))) {
      if (iteratee(object[key], key, object) === false) {
        break;
      }
    }
  }
  return object;
}
function getProperty(object, name) {
  var names = name.split('.');
  var result = object;
  objectEach(names, (function(name) {
    result = result[name];
    if (result === void 0) {
      result = void 0;
      return false;
    }
  }));
  return result;
}
function deepObjectSize(object) {
  if (!isObject(object)) {
    return 0;
  }
  var recursObjLen = function(obj) {
    var result = 0;
    if (isObject(obj)) {
      objectEach(obj, (function(key) {
        result += recursObjLen(key);
      }));
    } else {
      result++;
    }
    return result;
  };
  return recursObjLen(object);
}
function createObjectPropListener(defaultValue) {
  var propertyToListen = arguments[1] !== (void 0) ? arguments[1] : 'value';
  var $__1;
  var privateProperty = ("_" + propertyToListen);
  var holder = ($__1 = {}, Object.defineProperty($__1, "_touched", {
    value: false,
    configurable: true,
    enumerable: true,
    writable: true
  }), Object.defineProperty($__1, privateProperty, {
    value: defaultValue,
    configurable: true,
    enumerable: true,
    writable: true
  }), Object.defineProperty($__1, "isTouched", {
    value: function() {
      return this._touched;
    },
    configurable: true,
    enumerable: true,
    writable: true
  }), $__1);
  Object.defineProperty(holder, propertyToListen, {
    get: function() {
      return this[privateProperty];
    },
    set: function(value) {
      this._touched = true;
      this[privateProperty] = value;
    },
    enumerable: true,
    configurable: true
  });
  return holder;
}

//# 
},{"array":43}],54:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  columnFactory: {get: function() {
      return columnFactory;
    }},
  __esModule: {value: true}
});
var $__object__;
var inherit = ($__object__ = _dereq_("object"), $__object__ && $__object__.__esModule && $__object__ || {default: $__object__}).inherit;
function columnFactory(GridSettings, conflictList) {
  function ColumnSettings() {}
  ;
  inherit(ColumnSettings, GridSettings);
  for (var i = 0,
      len = conflictList.length; i < len; i++) {
    ColumnSettings.prototype[conflictList[i]] = void 0;
  }
  return ColumnSettings;
}

//# 
},{"object":53}],55:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  toUpperCaseFirst: {get: function() {
      return toUpperCaseFirst;
    }},
  startsWith: {get: function() {
      return startsWith;
    }},
  endsWith: {get: function() {
      return endsWith;
    }},
  equalsIgnoreCase: {get: function() {
      return equalsIgnoreCase;
    }},
  randomString: {get: function() {
      return randomString;
    }},
  isPercentValue: {get: function() {
      return isPercentValue;
    }},
  substitute: {get: function() {
      return substitute;
    }},
  padStart: {get: function() {
      return padStart;
    }},
  stripTags: {get: function() {
      return stripTags;
    }},
  __esModule: {value: true}
});
var $__mixed__,
    $__number__;
var stringify = ($__mixed__ = _dereq_("mixed"), $__mixed__ && $__mixed__.__esModule && $__mixed__ || {default: $__mixed__}).stringify;
var rangeEach = ($__number__ = _dereq_("number"), $__number__ && $__number__.__esModule && $__number__ || {default: $__number__}).rangeEach;
function toUpperCaseFirst(string) {
  return string[0].toUpperCase() + string.substr(1);
}
function startsWith(string, needle) {
  var result = true;
  rangeEach(needle.length - 1, (function(index) {
    if (string.charAt(index) !== needle.charAt(index)) {
      result = false;
      return false;
    }
  }));
  return result;
}
function endsWith(string, needle) {
  var result = true;
  var needleLength = needle.length - 1;
  var stringLength = string.length - 1;
  rangeEach(needleLength, (function(index) {
    var stringIndex = stringLength - index;
    var needleIndex = needleLength - index;
    if (string.charAt(stringIndex) !== needle.charAt(needleIndex)) {
      result = false;
      return false;
    }
  }));
  return result;
}
function equalsIgnoreCase() {
  for (var strings = [],
      $__2 = 0; $__2 < arguments.length; $__2++)
    strings[$__2] = arguments[$__2];
  var unique = [];
  var length = strings.length;
  while (length--) {
    var string = stringify(strings[length]).toLowerCase();
    if (unique.indexOf(string) === -1) {
      unique.push(string);
    }
  }
  return unique.length === 1;
}
function randomString() {
  function s4() {
    return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);
  }
  return s4() + s4() + s4() + s4();
}
function isPercentValue(value) {
  return /^([0-9][0-9]?\%$)|(^100\%$)/.test(value);
}
function substitute(template) {
  var variables = arguments[1] !== (void 0) ? arguments[1] : {};
  return (template + '').replace(/(?:\\)?\[([^\[\]]+)]/g, function(match, name) {
    if (match.charAt(0) === '\\') {
      return match.substr(1, match.length - 1);
    }
    return variables[name] === void 0 ? '' : variables[name];
  });
}
function padStart(string, maxLength) {
  var fillString = arguments[2] !== (void 0) ? arguments[2] : ' ';
  string = string + '';
  if (string.length >= maxLength) {
    return string;
  }
  fillString = String(fillString);
  var fillStringLength = fillString.length;
  if (!fillStringLength) {
    fillString = ' ';
  }
  var fillLen = maxLength - string.length;
  var timesToRepeat = Math.ceil(fillLen / fillString.length);
  var truncatedString = '';
  rangeEach(timesToRepeat, (function(index) {
    truncatedString += fillString;
  }));
  truncatedString = truncatedString.slice(0, fillLen);
  return truncatedString + string;
}
;
var STRIP_TAGS_REGEX = /<\/?\w+\/?>|<\w+[\s|\/][^>]*>/gi;
function stripTags(string) {
  string = string + '';
  return string.replace(STRIP_TAGS_REGEX, '');
}

//# 
},{"mixed":51,"number":52}],56:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  KEY_CODES: {get: function() {
      return KEY_CODES;
    }},
  isPrintableChar: {get: function() {
      return isPrintableChar;
    }},
  isMetaKey: {get: function() {
      return isMetaKey;
    }},
  isCtrlKey: {get: function() {
      return isCtrlKey;
    }},
  isKey: {get: function() {
      return isKey;
    }},
  __esModule: {value: true}
});
var $__array__;
var arrayEach = ($__array__ = _dereq_("array"), $__array__ && $__array__.__esModule && $__array__ || {default: $__array__}).arrayEach;
var KEY_CODES = {
  MOUSE_LEFT: 1,
  MOUSE_RIGHT: 3,
  MOUSE_MIDDLE: 2,
  BACKSPACE: 8,
  COMMA: 188,
  INSERT: 45,
  DELETE: 46,
  END: 35,
  ENTER: 13,
  ESCAPE: 27,
  CONTROL_LEFT: 91,
  COMMAND_LEFT: 17,
  COMMAND_RIGHT: 93,
  ALT: 18,
  HOME: 36,
  PAGE_DOWN: 34,
  PAGE_UP: 33,
  PERIOD: 190,
  SPACE: 32,
  SHIFT: 16,
  CAPS_LOCK: 20,
  TAB: 9,
  ARROW_RIGHT: 39,
  ARROW_LEFT: 37,
  ARROW_UP: 38,
  ARROW_DOWN: 40,
  F1: 112,
  F2: 113,
  F3: 114,
  F4: 115,
  F5: 116,
  F6: 117,
  F7: 118,
  F8: 119,
  F9: 120,
  F10: 121,
  F11: 122,
  F12: 123,
  A: 65,
  X: 88,
  C: 67,
  V: 86
};
function isPrintableChar(keyCode) {
  return ((keyCode == 32) || (keyCode >= 48 && keyCode <= 57) || (keyCode >= 96 && keyCode <= 111) || (keyCode >= 186 && keyCode <= 192) || (keyCode >= 219 && keyCode <= 222) || keyCode >= 226 || (keyCode >= 65 && keyCode <= 90));
}
function isMetaKey(keyCode) {
  var metaKeys = [KEY_CODES.ARROW_DOWN, KEY_CODES.ARROW_UP, KEY_CODES.ARROW_LEFT, KEY_CODES.ARROW_RIGHT, KEY_CODES.HOME, KEY_CODES.END, KEY_CODES.DELETE, KEY_CODES.BACKSPACE, KEY_CODES.F1, KEY_CODES.F2, KEY_CODES.F3, KEY_CODES.F4, KEY_CODES.F5, KEY_CODES.F6, KEY_CODES.F7, KEY_CODES.F8, KEY_CODES.F9, KEY_CODES.F10, KEY_CODES.F11, KEY_CODES.F12, KEY_CODES.TAB, KEY_CODES.PAGE_DOWN, KEY_CODES.PAGE_UP, KEY_CODES.ENTER, KEY_CODES.ESCAPE, KEY_CODES.SHIFT, KEY_CODES.CAPS_LOCK, KEY_CODES.ALT];
  return metaKeys.indexOf(keyCode) !== -1;
}
function isCtrlKey(keyCode) {
  return [KEY_CODES.CONTROL_LEFT, 224, KEY_CODES.COMMAND_LEFT, KEY_CODES.COMMAND_RIGHT].indexOf(keyCode) !== -1;
}
function isKey(keyCode, baseCode) {
  var keys = baseCode.split('|');
  var result = false;
  arrayEach(keys, function(key) {
    if (keyCode === KEY_CODES[key]) {
      result = true;
      return false;
    }
  });
  return result;
}

//# 
},{"array":43}],57:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  arrayMapper: {get: function() {
      return arrayMapper;
    }},
  __esModule: {value: true}
});
var $___46__46__47_browser__,
    $___46__46__47_helpers_47_array__,
    $___46__46__47_helpers_47_object__,
    $___46__46__47_helpers_47_number__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var $__1 = ($___46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47_helpers_47_array__ && $___46__46__47_helpers_47_array__.__esModule && $___46__46__47_helpers_47_array__ || {default: $___46__46__47_helpers_47_array__}),
    arrayEach = $__1.arrayEach,
    arrayReduce = $__1.arrayReduce,
    arrayMap = $__1.arrayMap,
    arrayMax = $__1.arrayMax;
var defineGetter = ($___46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47_helpers_47_object__ && $___46__46__47_helpers_47_object__.__esModule && $___46__46__47_helpers_47_object__ || {default: $___46__46__47_helpers_47_object__}).defineGetter;
var rangeEach = ($___46__46__47_helpers_47_number__ = _dereq_("helpers/number"), $___46__46__47_helpers_47_number__ && $___46__46__47_helpers_47_number__.__esModule && $___46__46__47_helpers_47_number__ || {default: $___46__46__47_helpers_47_number__}).rangeEach;
var MIXIN_NAME = 'arrayMapper';
var arrayMapper = {
  _arrayMap: [],
  getValueByIndex: function(index) {
    var value;
    return (value = this._arrayMap[index]) === void 0 ? null : value;
  },
  getIndexByValue: function(value) {
    var index;
    return (index = this._arrayMap.indexOf(value)) === -1 ? null : index;
  },
  insertItems: function(index) {
    var amount = arguments[1] !== (void 0) ? arguments[1] : 1;
    var $__4 = this;
    var newIndex = arrayMax(this._arrayMap) + 1;
    var addedItems = [];
    rangeEach(amount - 1, (function(count) {
      addedItems.push($__4._arrayMap.splice(index + count, 0, newIndex + count));
    }));
    return addedItems;
  },
  removeItems: function(index) {
    var amount = arguments[1] !== (void 0) ? arguments[1] : 1;
    var $__4 = this;
    var removedItems = [];
    if (Array.isArray(index)) {
      var mapCopy = [].concat(this._arrayMap);
      index.sort((function(a, b) {
        return b - a;
      }));
      removedItems = arrayReduce(index, (function(acc, item) {
        $__4._arrayMap.splice(item, 1);
        return acc.concat(mapCopy.slice(item, item + 1));
      }), []);
    } else {
      removedItems = this._arrayMap.splice(index, amount);
    }
    return removedItems;
  },
  unshiftItems: function(index) {
    var amount = arguments[1] !== (void 0) ? arguments[1] : 1;
    var removedItems = this.removeItems(index, amount);
    function countRowShift(logicalRow) {
      return arrayReduce(removedItems, (function(count, removedLogicalRow) {
        if (logicalRow > removedLogicalRow) {
          count++;
        }
        return count;
      }), 0);
    }
    this._arrayMap = arrayMap(this._arrayMap, (function(logicalRow, physicalRow) {
      var rowShift = countRowShift(logicalRow);
      if (rowShift) {
        logicalRow -= rowShift;
      }
      return logicalRow;
    }));
  },
  shiftItems: function(index) {
    var amount = arguments[1] !== (void 0) ? arguments[1] : 1;
    var $__4 = this;
    this._arrayMap = arrayMap(this._arrayMap, (function(row) {
      if (row >= index) {
        row += amount;
      }
      return row;
    }));
    rangeEach(amount - 1, (function(count) {
      $__4._arrayMap.splice(index + count, 0, index + count);
    }));
  },
  clearMap: function() {
    this._arrayMap.length = 0;
  }
};
defineGetter(arrayMapper, 'MIXIN_NAME', MIXIN_NAME, {
  writable: false,
  enumerable: false
});
;
Handsontable.utils.arrayMapper = arrayMapper;

//# 
},{"browser":24,"helpers/array":43,"helpers/number":52,"helpers/object":53}],58:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  localHooks: {get: function() {
      return localHooks;
    }},
  __esModule: {value: true}
});
var $___46__46__47_browser__,
    $___46__46__47_helpers_47_array__,
    $___46__46__47_helpers_47_object__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var arrayEach = ($___46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47_helpers_47_array__ && $___46__46__47_helpers_47_array__.__esModule && $___46__46__47_helpers_47_array__ || {default: $___46__46__47_helpers_47_array__}).arrayEach;
var defineGetter = ($___46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47_helpers_47_object__ && $___46__46__47_helpers_47_object__.__esModule && $___46__46__47_helpers_47_object__ || {default: $___46__46__47_helpers_47_object__}).defineGetter;
var MIXIN_NAME = 'localHooks';
var localHooks = {
  _localHooks: Object.create(null),
  addLocalHook: function(key, callback) {
    if (!this._localHooks[key]) {
      this._localHooks[key] = [];
    }
    this._localHooks[key].push(callback);
  },
  runLocalHooks: function(key) {
    for (var params = [],
        $__4 = 1; $__4 < arguments.length; $__4++)
      params[$__4 - 1] = arguments[$__4];
    var $__3 = this;
    if (this._localHooks[key]) {
      arrayEach(this._localHooks[key], (function(callback) {
        return callback.apply($__3, params);
      }));
    }
  },
  clearLocalHooks: function() {
    this._localHooks = {};
  }
};
defineGetter(localHooks, 'MIXIN_NAME', MIXIN_NAME, {
  writable: false,
  enumerable: false
});
;
Handsontable.utils.localHooks = localHooks;

//# 
},{"browser":24,"helpers/array":43,"helpers/object":53}],59:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  MultiMap: {get: function() {
      return MultiMap;
    }},
  __esModule: {value: true}
});
;
window.MultiMap = MultiMap;
function MultiMap() {
  var map = {
    arrayMap: [],
    weakMap: new WeakMap()
  };
  return {
    get: function(key) {
      if (canBeAnArrayMapKey(key)) {
        return map.arrayMap[key];
      } else if (canBeAWeakMapKey(key)) {
        return map.weakMap.get(key);
      }
    },
    set: function(key, value) {
      if (canBeAnArrayMapKey(key)) {
        map.arrayMap[key] = value;
      } else if (canBeAWeakMapKey(key)) {
        map.weakMap.set(key, value);
      } else {
        throw new Error('Invalid key type');
      }
    },
    delete: function(key) {
      if (canBeAnArrayMapKey(key)) {
        delete map.arrayMap[key];
      } else if (canBeAWeakMapKey(key)) {
        map.weakMap.delete(key);
      }
    }
  };
  function canBeAnArrayMapKey(obj) {
    return obj !== null && !isNaNSymbol(obj) && (typeof obj == 'string' || typeof obj == 'number');
  }
  function canBeAWeakMapKey(obj) {
    return obj !== null && (typeof obj == 'object' || typeof obj == 'function');
  }
  function isNaNSymbol(obj) {
    return obj !== obj;
  }
}

//# 
},{}],60:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  Hooks: {get: function() {
      return Hooks;
    }},
  __esModule: {value: true}
});
var $__helpers_47_array__,
    $__helpers_47_object__;
var REGISTERED_HOOKS = ['afterCellMetaReset', 'afterChange', 'afterChangesObserved', 'afterContextMenuDefaultOptions', 'beforeContextMenuSetItems', 'afterDropdownMenuDefaultOptions', 'beforeDropdownMenuSetItems', 'afterContextMenuHide', 'afterContextMenuShow', 'afterCopyLimit', 'beforeCreateCol', 'afterCreateCol', 'beforeCreateRow', 'afterCreateRow', 'afterDeselect', 'afterDestroy', 'afterDocumentKeyDown', 'afterGetCellMeta', 'afterGetColHeader', 'afterGetRowHeader', 'afterInit', 'afterLoadData', 'afterMomentumScroll', 'afterOnCellCornerMouseDown', 'afterOnCellCornerDblClick', 'afterOnCellMouseDown', 'afterOnCellMouseOver', 'afterOnCellMouseOut', 'afterRemoveCol', 'afterRemoveRow', 'afterRender', 'beforeRenderer', 'afterRenderer', 'afterScrollHorizontally', 'afterScrollVertically', 'afterSelection', 'afterSelectionByProp', 'afterSelectionEnd', 'afterSelectionEndByProp', 'afterSetCellMeta', 'afterSetDataAtCell', 'afterSetDataAtRowProp', 'afterUpdateSettings', 'afterValidate', 'beforeAutofill', 'beforeCellAlignment', 'beforeChange', 'beforeChangeRender', 'beforeDrawBorders', 'beforeGetCellMeta', 'beforeInit', 'beforeInitWalkontable', 'beforeKeyDown', 'beforeOnCellMouseDown', 'beforeOnCellMouseOver', 'beforeOnCellMouseOut', 'beforeRemoveCol', 'beforeRemoveRow', 'beforeRender', 'beforeSetRangeStart', 'beforeSetRangeEnd', 'beforeTouchScroll', 'beforeValidate', 'beforeValueRender', 'construct', 'init', 'modifyCol', 'unmodifyCol', 'unmodifyRow', 'modifyColHeader', 'modifyColWidth', 'modifyRow', 'modifyRowHeader', 'modifyRowHeight', 'modifyData', 'modifyRowData', 'persistentStateLoad', 'persistentStateReset', 'persistentStateSave', 'beforeColumnSort', 'afterColumnSort', 'modifyAutofillRange', 'modifyCopyableRange', 'beforeCut', 'afterCut', 'beforeCopy', 'afterCopy', 'beforePaste', 'afterPaste', 'beforeColumnMove', 'afterColumnMove', 'beforeRowMove', 'afterRowMove', 'beforeColumnResize', 'afterColumnResize', 'beforeRowResize', 'afterRowResize', 'afterGetColumnHeaderRenderers', 'afterGetRowHeaderRenderers', 'beforeStretchingColumnWidth', 'beforeFilter', 'afterFilter', 'modifyColumnHeaderHeight', 'beforeUndo', 'afterUndo', 'beforeRedo', 'afterRedo', 'modifyRowHeaderWidth', 'beforeAutofillInsidePopulate', 'modifyTransformStart', 'modifyTransformEnd', 'afterModifyTransformStart', 'afterModifyTransformEnd', 'beforeValueRender', 'afterViewportRowCalculatorOverride', 'afterViewportColumnCalculatorOverride', 'afterPluginsInitialized', 'manualRowHeights', 'skipLengthCache', 'afterTrimRow', 'afterUntrimRow', 'afterDropdownMenuShow', 'afterDropdownMenuHide', 'hiddenRow', 'hiddenColumn', 'beforeAddChild', 'afterAddChild', 'beforeDetachChild', 'afterDetachChild', 'afterBeginEditing'];
var arrayEach = ($__helpers_47_array__ = _dereq_("helpers/array"), $__helpers_47_array__ && $__helpers_47_array__.__esModule && $__helpers_47_array__ || {default: $__helpers_47_array__}).arrayEach;
var objectEach = ($__helpers_47_object__ = _dereq_("helpers/object"), $__helpers_47_object__ && $__helpers_47_object__.__esModule && $__helpers_47_object__ || {default: $__helpers_47_object__}).objectEach;
var Hooks = function Hooks() {
  this.globalBucket = this.createEmptyBucket();
};
($traceurRuntime.createClass)(Hooks, {
  createEmptyBucket: function() {
    var bucket = Object.create(null);
    arrayEach(REGISTERED_HOOKS, (function(hook) {
      return (bucket[hook] = []);
    }));
    return bucket;
  },
  getBucket: function() {
    var context = arguments[0] !== (void 0) ? arguments[0] : null;
    if (context) {
      if (!context.pluginHookBucket) {
        context.pluginHookBucket = this.createEmptyBucket();
      }
      return context.pluginHookBucket;
    }
    return this.globalBucket;
  },
  add: function(key, callback) {
    var context = arguments[2] !== (void 0) ? arguments[2] : null;
    var $__2 = this;
    if (Array.isArray(callback)) {
      arrayEach(callback, (function(c) {
        return $__2.add(key, c, context);
      }));
    } else {
      var bucket = this.getBucket(context);
      if (typeof bucket[key] === 'undefined') {
        this.register(key);
        bucket[key] = [];
      }
      callback.skip = false;
      if (bucket[key].indexOf(callback) === -1) {
        var foundInitialHook = false;
        if (callback.initialHook) {
          arrayEach(bucket[key], (function(cb, i) {
            if (cb.initialHook) {
              bucket[key][i] = callback;
              foundInitialHook = true;
              return false;
            }
          }));
        }
        if (!foundInitialHook) {
          bucket[key].push(callback);
        }
      }
    }
    return this;
  },
  once: function(key, callback) {
    var context = arguments[2] !== (void 0) ? arguments[2] : null;
    var $__2 = this;
    if (Array.isArray(callback)) {
      arrayEach(callback, (function(c) {
        return $__2.once(key, c, context);
      }));
    } else {
      callback.runOnce = true;
      this.add(key, callback, context);
    }
  },
  remove: function(key, callback) {
    var context = arguments[2] !== (void 0) ? arguments[2] : null;
    var bucket = this.getBucket(context);
    if (typeof bucket[key] !== 'undefined') {
      if (bucket[key].indexOf(callback) >= 0) {
        callback.skip = true;
        return true;
      }
    }
    return false;
  },
  has: function(key) {
    var context = arguments[1] !== (void 0) ? arguments[1] : null;
    var bucket = this.getBucket(context);
    return bucket[key] !== void 0 && bucket[key].length ? true : false;
  },
  run: function(context, key, p1, p2, p3, p4, p5, p6) {
    {
      var globalHandlers = this.globalBucket[key];
      var index = -1;
      var length = globalHandlers ? globalHandlers.length : 0;
      if (length) {
        while (++index < length) {
          if (!globalHandlers[index] || globalHandlers[index].skip) {
            continue;
          }
          var res = globalHandlers[index].call(context, p1, p2, p3, p4, p5, p6);
          if (res !== void 0) {
            p1 = res;
          }
          if (globalHandlers[index] && globalHandlers[index].runOnce) {
            this.remove(key, globalHandlers[index]);
          }
        }
      }
    }
    {
      var localHandlers = this.getBucket(context)[key];
      var index$__4 = -1;
      var length$__5 = localHandlers ? localHandlers.length : 0;
      if (length$__5) {
        while (++index$__4 < length$__5) {
          if (!localHandlers[index$__4] || localHandlers[index$__4].skip) {
            continue;
          }
          var res$__6 = localHandlers[index$__4].call(context, p1, p2, p3, p4, p5, p6);
          if (res$__6 !== void 0) {
            p1 = res$__6;
          }
          if (localHandlers[index$__4] && localHandlers[index$__4].runOnce) {
            this.remove(key, localHandlers[index$__4], context);
          }
        }
      }
    }
    return p1;
  },
  destroy: function() {
    var context = arguments[0] !== (void 0) ? arguments[0] : null;
    objectEach(this.getBucket(context), (function(value, key, bucket) {
      return (bucket[key].length = 0);
    }));
  },
  register: function(key) {
    if (!this.isRegistered(key)) {
      REGISTERED_HOOKS.push(key);
    }
  },
  deregister: function(key) {
    if (this.isRegistered(key)) {
      REGISTERED_HOOKS.splice(REGISTERED_HOOKS.indexOf(key), 1);
    }
  },
  isRegistered: function(key) {
    return REGISTERED_HOOKS.indexOf(key) >= 0;
  },
  getRegistered: function() {
    return REGISTERED_HOOKS;
  }
}, {});
;

//# 
},{"helpers/array":43,"helpers/object":53}],61:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  registerPlugin: {get: function() {
      return registerPlugin;
    }},
  getPlugin: {get: function() {
      return getPlugin;
    }},
  getRegistredPluginNames: {get: function() {
      return getRegistredPluginNames;
    }},
  getPluginName: {get: function() {
      return getPluginName;
    }},
  __esModule: {value: true}
});
var $__browser__,
    $__helpers_47_object__,
    $__helpers_47_string__;
var Handsontable = ($__browser__ = _dereq_("browser"), $__browser__ && $__browser__.__esModule && $__browser__ || {default: $__browser__}).default;
var objectEach = ($__helpers_47_object__ = _dereq_("helpers/object"), $__helpers_47_object__ && $__helpers_47_object__.__esModule && $__helpers_47_object__ || {default: $__helpers_47_object__}).objectEach;
var toUpperCaseFirst = ($__helpers_47_string__ = _dereq_("helpers/string"), $__helpers_47_string__ && $__helpers_47_string__.__esModule && $__helpers_47_string__ || {default: $__helpers_47_string__}).toUpperCaseFirst;
var registeredPlugins = new WeakMap();
function registerPlugin(pluginName, PluginClass) {
  pluginName = toUpperCaseFirst(pluginName);
  Handsontable.plugins[pluginName] = PluginClass;
  Handsontable.hooks.add('construct', function() {
    var holder;
    if (!registeredPlugins.has(this)) {
      registeredPlugins.set(this, {});
    }
    holder = registeredPlugins.get(this);
    if (!holder[pluginName]) {
      holder[pluginName] = new PluginClass(this);
    }
  });
  Handsontable.hooks.add('afterDestroy', function() {
    if (registeredPlugins.has(this)) {
      var pluginsHolder = registeredPlugins.get(this);
      objectEach(pluginsHolder, (function(plugin) {
        return plugin.destroy();
      }));
      registeredPlugins.delete(this);
    }
  });
}
function getPlugin(instance, pluginName) {
  if (typeof pluginName != 'string') {
    throw Error('Only strings can be passed as "plugin" parameter');
  }
  var _pluginName = toUpperCaseFirst(pluginName);
  if (!registeredPlugins.has(instance) || !registeredPlugins.get(instance)[_pluginName]) {
    return void 0;
  }
  return registeredPlugins.get(instance)[_pluginName];
}
function getRegistredPluginNames(hotInstance) {
  return registeredPlugins.has(hotInstance) ? Object.keys(registeredPlugins.get(hotInstance)) : [];
}
function getPluginName(hotInstance, plugin) {
  var pluginName = null;
  if (registeredPlugins.has(hotInstance)) {
    objectEach(registeredPlugins.get(hotInstance), (function(pluginInstance, name) {
      if (pluginInstance === plugin) {
        pluginName = name;
      }
    }));
  }
  return pluginName;
}
;

//# 
},{"browser":24,"helpers/object":53,"helpers/string":55}],62:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  default: {get: function() {
      return $__default;
    }},
  __esModule: {value: true}
});
var $___46__46__47_browser__,
    $___46__46__47_helpers_47_object__,
    $___46__46__47_helpers_47_array__,
    $___46__46__47_utils_47_recordTranslator__,
    $___46__46__47_plugins__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var $__1 = ($___46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47_helpers_47_object__ && $___46__46__47_helpers_47_object__.__esModule && $___46__46__47_helpers_47_object__ || {default: $___46__46__47_helpers_47_object__}),
    defineGetter = $__1.defineGetter,
    objectEach = $__1.objectEach;
var arrayEach = ($___46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47_helpers_47_array__ && $___46__46__47_helpers_47_array__.__esModule && $___46__46__47_helpers_47_array__ || {default: $___46__46__47_helpers_47_array__}).arrayEach;
var $__3 = ($___46__46__47_utils_47_recordTranslator__ = _dereq_("utils/recordTranslator"), $___46__46__47_utils_47_recordTranslator__ && $___46__46__47_utils_47_recordTranslator__.__esModule && $___46__46__47_utils_47_recordTranslator__ || {default: $___46__46__47_utils_47_recordTranslator__}),
    registerIdentity = $__3.registerIdentity,
    getTranslator = $__3.getTranslator;
var $__4 = ($___46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47_plugins__ && $___46__46__47_plugins__.__esModule && $___46__46__47_plugins__ || {default: $___46__46__47_plugins__}),
    getRegistredPluginNames = $__4.getRegistredPluginNames,
    getPluginName = $__4.getPluginName;
var privatePool = new WeakMap();
var initializedPlugins = null;
var BasePlugin = function BasePlugin(hotInstance) {
  var $__5 = this;
  defineGetter(this, 'hot', hotInstance, {writable: false});
  defineGetter(this, 't', getTranslator(hotInstance), {writable: false});
  privatePool.set(this, {hooks: {}});
  initializedPlugins = null;
  this.pluginName = null;
  this.pluginsInitializedCallbacks = [];
  this.isPluginsReady = false;
  this.enabled = false;
  this.initialized = false;
  this.hot.addHook('afterPluginsInitialized', (function() {
    return $__5.onAfterPluginsInitialized();
  }));
  this.hot.addHook('afterUpdateSettings', (function() {
    return $__5.onUpdateSettings();
  }));
  this.hot.addHook('beforeInit', (function() {
    return $__5.init();
  }));
};
($traceurRuntime.createClass)(BasePlugin, {
  init: function() {
    this.pluginName = getPluginName(this.hot, this);
    if (this.isEnabled && this.isEnabled()) {
      this.enablePlugin();
    }
    if (!initializedPlugins) {
      initializedPlugins = getRegistredPluginNames(this.hot);
    }
    if (initializedPlugins.indexOf(this.pluginName) >= 0) {
      initializedPlugins.splice(initializedPlugins.indexOf(this.pluginName), 1);
    }
    if (!initializedPlugins.length) {
      this.hot.runHooks('afterPluginsInitialized');
    }
    this.initialized = true;
  },
  enablePlugin: function() {
    this.enabled = true;
  },
  disablePlugin: function() {
    if (this.eventManager) {
      this.eventManager.clear();
    }
    this.clearHooks();
    this.enabled = false;
  },
  addHook: function(name, callback) {
    var hooks = privatePool.get(this).hooks[name] = (privatePool.get(this).hooks[name] || []);
    this.hot.addHook(name, callback);
    hooks.push(callback);
    privatePool.get(this).hooks[name] = hooks;
  },
  removeHooks: function(name) {
    var $__5 = this;
    arrayEach(privatePool.get(this).hooks[name] || [], (function(callback) {
      $__5.hot.removeHook(name, callback);
    }));
  },
  clearHooks: function() {
    var $__5 = this;
    var hooks = privatePool.get(this).hooks;
    objectEach(hooks, (function(callbacks, name) {
      return $__5.removeHooks(name);
    }));
    hooks.length = 0;
  },
  callOnPluginsReady: function(callback) {
    if (this.isPluginsReady) {
      callback();
    } else {
      this.pluginsInitializedCallbacks.push(callback);
    }
  },
  onAfterPluginsInitialized: function() {
    arrayEach(this.pluginsInitializedCallbacks, (function(callback) {
      return callback();
    }));
    this.pluginsInitializedCallbacks.length = 0;
    this.isPluginsReady = true;
  },
  onUpdateSettings: function() {
    if (this.isEnabled) {
      if (this.enabled && !this.isEnabled()) {
        this.disablePlugin();
      }
      if (!this.enabled && this.isEnabled()) {
        this.enablePlugin();
      }
      if (this.enabled && this.isEnabled()) {
        this.updatePlugin();
      }
    }
  },
  updatePlugin: function() {},
  destroy: function() {
    var $__5 = this;
    if (this.eventManager) {
      this.eventManager.destroy();
    }
    this.clearHooks();
    objectEach(this, (function(value, property) {
      if (property !== 'hot' && property !== 't') {
        $__5[property] = null;
      }
    }));
    delete this.t;
    delete this.hot;
  }
}, {});
var $__default = BasePlugin;
Handsontable.plugins.BasePlugin = BasePlugin;

//# 
},{"browser":24,"helpers/array":43,"helpers/object":53,"plugins":61,"utils/recordTranslator":130}],63:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  AutoColumnSize: {get: function() {
      return AutoColumnSize;
    }},
  __esModule: {value: true}
});
var $___46__46__47__95_base__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__46__46__47_helpers_47_feature__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47_utils_47_ghostTable__,
    $___46__46__47__46__46__47_helpers_47_object__,
    $___46__46__47__46__46__47_helpers_47_number__,
    $___46__46__47__46__46__47_plugins__,
    $___46__46__47__46__46__47_utils_47_samplesGenerator__,
    $___46__46__47__46__46__47_helpers_47_string__,
    $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_calculator_47_viewportColumns__;
var BasePlugin = ($___46__46__47__95_base__ = _dereq_("_base"), $___46__46__47__95_base__ && $___46__46__47__95_base__.__esModule && $___46__46__47__95_base__ || {default: $___46__46__47__95_base__}).default;
var $__1 = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}),
    arrayEach = $__1.arrayEach,
    arrayFilter = $__1.arrayFilter,
    arrayReduce = $__1.arrayReduce,
    arrayMap = $__1.arrayMap;
var $__2 = ($___46__46__47__46__46__47_helpers_47_feature__ = _dereq_("helpers/feature"), $___46__46__47__46__46__47_helpers_47_feature__ && $___46__46__47__46__46__47_helpers_47_feature__.__esModule && $___46__46__47__46__46__47_helpers_47_feature__ || {default: $___46__46__47__46__46__47_helpers_47_feature__}),
    cancelAnimationFrame = $__2.cancelAnimationFrame,
    requestAnimationFrame = $__2.requestAnimationFrame;
var isVisible = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}).isVisible;
var GhostTable = ($___46__46__47__46__46__47_utils_47_ghostTable__ = _dereq_("utils/ghostTable"), $___46__46__47__46__46__47_utils_47_ghostTable__ && $___46__46__47__46__46__47_utils_47_ghostTable__.__esModule && $___46__46__47__46__46__47_utils_47_ghostTable__ || {default: $___46__46__47__46__46__47_utils_47_ghostTable__}).GhostTable;
var $__5 = ($___46__46__47__46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47__46__46__47_helpers_47_object__ && $___46__46__47__46__46__47_helpers_47_object__.__esModule && $___46__46__47__46__46__47_helpers_47_object__ || {default: $___46__46__47__46__46__47_helpers_47_object__}),
    isObject = $__5.isObject,
    objectEach = $__5.objectEach;
var $__6 = ($___46__46__47__46__46__47_helpers_47_number__ = _dereq_("helpers/number"), $___46__46__47__46__46__47_helpers_47_number__ && $___46__46__47__46__46__47_helpers_47_number__.__esModule && $___46__46__47__46__46__47_helpers_47_number__ || {default: $___46__46__47__46__46__47_helpers_47_number__}),
    valueAccordingPercent = $__6.valueAccordingPercent,
    rangeEach = $__6.rangeEach;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
var SamplesGenerator = ($___46__46__47__46__46__47_utils_47_samplesGenerator__ = _dereq_("utils/samplesGenerator"), $___46__46__47__46__46__47_utils_47_samplesGenerator__ && $___46__46__47__46__46__47_utils_47_samplesGenerator__.__esModule && $___46__46__47__46__46__47_utils_47_samplesGenerator__ || {default: $___46__46__47__46__46__47_utils_47_samplesGenerator__}).SamplesGenerator;
var isPercentValue = ($___46__46__47__46__46__47_helpers_47_string__ = _dereq_("helpers/string"), $___46__46__47__46__46__47_helpers_47_string__ && $___46__46__47__46__46__47_helpers_47_string__.__esModule && $___46__46__47__46__46__47_helpers_47_string__ || {default: $___46__46__47__46__46__47_helpers_47_string__}).isPercentValue;
var WalkontableViewportColumnsCalculator = ($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_calculator_47_viewportColumns__ = _dereq_("3rdparty/walkontable/src/calculator/viewportColumns"), $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_calculator_47_viewportColumns__ && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_calculator_47_viewportColumns__.__esModule && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_calculator_47_viewportColumns__ || {default: $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_calculator_47_viewportColumns__}).WalkontableViewportColumnsCalculator;
var privatePool = new WeakMap();
var AutoColumnSize = function AutoColumnSize(hotInstance) {
  var $__11 = this;
  $traceurRuntime.superConstructor($AutoColumnSize).call(this, hotInstance);
  privatePool.set(this, {cachedColumnHeaders: []});
  this.widths = [];
  this.ghostTable = new GhostTable(this.hot);
  this.samplesGenerator = new SamplesGenerator((function(row, col) {
    return $__11.hot.getDataAtCell(row, col);
  }));
  this.firstCalculation = true;
  this.inProgress = false;
  this.addHook('beforeColumnResize', (function(col, size, isDblClick) {
    return $__11.onBeforeColumnResize(col, size, isDblClick);
  }));
};
var $AutoColumnSize = AutoColumnSize;
($traceurRuntime.createClass)(AutoColumnSize, {
  isEnabled: function() {
    return this.hot.getSettings().autoColumnSize !== false && !this.hot.getSettings().colWidths;
  },
  enablePlugin: function() {
    var $__11 = this;
    if (this.enabled) {
      return;
    }
    var setting = this.hot.getSettings().autoColumnSize;
    if (setting && setting.useHeaders != null) {
      this.ghostTable.setSetting('useHeaders', setting.useHeaders);
    }
    this.addHook('afterLoadData', (function() {
      return $__11.onAfterLoadData();
    }));
    this.addHook('beforeChange', (function(changes) {
      return $__11.onBeforeChange(changes);
    }));
    this.addHook('beforeRender', (function(force) {
      return $__11.onBeforeRender(force);
    }));
    this.addHook('modifyColWidth', (function(width, col) {
      return $__11.getColumnWidth(col, width);
    }));
    this.addHook('afterInit', (function() {
      return $__11.onAfterInit();
    }));
    $traceurRuntime.superGet(this, $AutoColumnSize.prototype, "enablePlugin").call(this);
  },
  updatePlugin: function() {
    var changedColumns = this.findColumnsWhereHeaderWasChanged();
    if (changedColumns.length) {
      this.clearCache(changedColumns);
    }
    $traceurRuntime.superGet(this, $AutoColumnSize.prototype, "updatePlugin").call(this);
  },
  disablePlugin: function() {
    $traceurRuntime.superGet(this, $AutoColumnSize.prototype, "disablePlugin").call(this);
  },
  calculateColumnsWidth: function() {
    var colRange = arguments[0] !== (void 0) ? arguments[0] : {
      from: 0,
      to: this.hot.countCols() - 1
    };
    var rowRange = arguments[1] !== (void 0) ? arguments[1] : {
      from: 0,
      to: this.hot.countRows() - 1
    };
    var force = arguments[2] !== (void 0) ? arguments[2] : false;
    var $__11 = this;
    if (typeof colRange === 'number') {
      colRange = {
        from: colRange,
        to: colRange
      };
    }
    if (typeof rowRange === 'number') {
      rowRange = {
        from: rowRange,
        to: rowRange
      };
    }
    rangeEach(colRange.from, colRange.to, (function(col) {
      if (force || ($__11.widths[col] === void 0 && !$__11.hot._getColWidthFromSettings(col))) {
        var samples = $__11.samplesGenerator.generateColumnSamples(col, rowRange);
        samples.forEach((function(sample, col) {
          return $__11.ghostTable.addColumn(col, sample);
        }));
      }
    }));
    if (this.ghostTable.columns.length) {
      this.ghostTable.getWidths((function(col, width) {
        return $__11.widths[col] = width;
      }));
      this.ghostTable.clean();
    }
  },
  calculateAllColumnsWidth: function() {
    var rowRange = arguments[0] !== (void 0) ? arguments[0] : {
      from: 0,
      to: this.hot.countRows() - 1
    };
    var $__11 = this;
    var current = 0;
    var length = this.hot.countCols() - 1;
    var timer = null;
    this.inProgress = true;
    var loop = (function() {
      if (!$__11.hot) {
        cancelAnimationFrame(timer);
        $__11.inProgress = false;
        return;
      }
      $__11.calculateColumnsWidth({
        from: current,
        to: Math.min(current + $AutoColumnSize.CALCULATION_STEP, length)
      }, rowRange);
      current = current + $AutoColumnSize.CALCULATION_STEP + 1;
      if (current < length) {
        timer = requestAnimationFrame(loop);
      } else {
        cancelAnimationFrame(timer);
        $__11.inProgress = false;
        $__11.hot.view.wt.wtOverlays.adjustElementsSize(true);
        if ($__11.hot.view.wt.wtOverlays.leftOverlay.needFullRender) {
          $__11.hot.view.wt.wtOverlays.leftOverlay.clone.draw();
        }
      }
    });
    if (this.firstCalculation && this.getSyncCalculationLimit()) {
      this.calculateColumnsWidth({
        from: 0,
        to: this.getSyncCalculationLimit()
      }, rowRange);
      this.firstCalculation = false;
      current = this.getSyncCalculationLimit() + 1;
    }
    if (current < length) {
      loop();
    } else {
      this.inProgress = false;
    }
  },
  setSamplingOptions: function() {
    var setting = this.hot.getSettings().autoColumnSize;
    var samplingRatio = setting && setting.hasOwnProperty('samplingRatio') ? this.hot.getSettings().autoColumnSize.samplingRatio : void 0;
    var allowSampleDuplicates = setting && setting.hasOwnProperty('allowSampleDuplicates') ? this.hot.getSettings().autoColumnSize.allowSampleDuplicates : void 0;
    if (samplingRatio && !isNaN(samplingRatio)) {
      this.samplesGenerator.setSampleCount(parseInt(samplingRatio, 10));
    }
    if (allowSampleDuplicates) {
      this.samplesGenerator.setAllowDuplicates(allowSampleDuplicates);
    }
  },
  recalculateAllColumnsWidth: function() {
    if (this.hot.view && isVisible(this.hot.view.wt.wtTable.TABLE)) {
      this.clearCache();
      this.calculateAllColumnsWidth();
    }
  },
  getSyncCalculationLimit: function() {
    var limit = $AutoColumnSize.SYNC_CALCULATION_LIMIT;
    var colsLimit = this.hot.countCols() - 1;
    if (isObject(this.hot.getSettings().autoColumnSize)) {
      limit = this.hot.getSettings().autoColumnSize.syncLimit;
      if (isPercentValue(limit)) {
        limit = valueAccordingPercent(colsLimit, limit);
      } else {
        limit = limit >> 0;
      }
    }
    return Math.min(limit, colsLimit);
  },
  getColumnWidth: function(col) {
    var defaultWidth = arguments[1];
    var keepMinimum = arguments[2] !== (void 0) ? arguments[2] : true;
    var width = defaultWidth;
    if (width === void 0) {
      width = this.widths[col];
      if (keepMinimum && typeof width === 'number') {
        width = Math.max(width, WalkontableViewportColumnsCalculator.DEFAULT_WIDTH);
      }
    }
    return width;
  },
  getFirstVisibleColumn: function() {
    var wot = this.hot.view.wt;
    if (wot.wtViewport.columnsVisibleCalculator) {
      return wot.wtTable.getFirstVisibleColumn();
    }
    if (wot.wtViewport.columnsRenderCalculator) {
      return wot.wtTable.getFirstRenderedColumn();
    }
    return -1;
  },
  getLastVisibleColumn: function() {
    var wot = this.hot.view.wt;
    if (wot.wtViewport.columnsVisibleCalculator) {
      return wot.wtTable.getLastVisibleColumn();
    }
    if (wot.wtViewport.columnsRenderCalculator) {
      return wot.wtTable.getLastRenderedColumn();
    }
    return -1;
  },
  findColumnsWhereHeaderWasChanged: function() {
    var columnHeaders = this.hot.getColHeader();
    var cachedColumnHeaders = privatePool.get(this).cachedColumnHeaders;
    var changedColumns = arrayReduce(columnHeaders, (function(acc, columnTitle, physicalColumn) {
      var cachedColumnsLength = cachedColumnHeaders.length;
      if (cachedColumnsLength - 1 < physicalColumn || cachedColumnHeaders[physicalColumn] !== columnTitle) {
        acc.push(physicalColumn);
      }
      if (cachedColumnsLength - 1 < physicalColumn) {
        cachedColumnHeaders.push(columnTitle);
      } else {
        cachedColumnHeaders[physicalColumn] = columnTitle;
      }
      return acc;
    }), []);
    return changedColumns;
  },
  clearCache: function() {
    var columns = arguments[0] !== (void 0) ? arguments[0] : [];
    var $__11 = this;
    if (columns.length) {
      arrayEach(columns, (function(physicalIndex) {
        return $__11.widths[physicalIndex] = void 0;
      }));
    } else {
      this.widths.length = 0;
    }
  },
  isNeedRecalculate: function() {
    return arrayFilter(this.widths, (function(item) {
      return (item === void 0);
    })).length ? true : false;
  },
  onBeforeRender: function() {
    var force = this.hot.renderCall;
    var rowsCount = this.hot.countRows();
    if (!rowsCount) {
      return;
    }
    this.calculateColumnsWidth({
      from: this.getFirstVisibleColumn(),
      to: this.getLastVisibleColumn()
    }, void 0, force);
    if (this.isNeedRecalculate() && !this.inProgress) {
      this.calculateAllColumnsWidth();
    }
  },
  onAfterLoadData: function() {
    var $__11 = this;
    if (this.hot.view) {
      this.recalculateAllColumnsWidth();
    } else {
      setTimeout((function() {
        if ($__11.hot) {
          $__11.recalculateAllColumnsWidth();
        }
      }), 0);
    }
  },
  onBeforeChange: function(changes) {
    var $__11 = this;
    var changedColumns = arrayMap(changes, (function($__13) {
      var $__14 = $__13,
          row = $__14[0],
          column = $__14[1];
      return $__11.hot.propToCol(column);
    }));
    this.clearCache(changedColumns);
  },
  onBeforeColumnResize: function(col, size, isDblClick) {
    if (isDblClick) {
      this.calculateColumnsWidth(col, void 0, true);
      size = this.getColumnWidth(col, void 0, false);
    }
    return size;
  },
  onAfterInit: function() {
    privatePool.get(this).cachedColumnHeaders = this.hot.getColHeader();
  },
  destroy: function() {
    this.ghostTable.clean();
    $traceurRuntime.superGet(this, $AutoColumnSize.prototype, "destroy").call(this);
  }
}, {
  get CALCULATION_STEP() {
    return 50;
  },
  get SYNC_CALCULATION_LIMIT() {
    return 50;
  }
}, BasePlugin);
;
registerPlugin('autoColumnSize', AutoColumnSize);

//# 
},{"3rdparty/walkontable/src/calculator/viewportColumns":4,"_base":62,"helpers/array":43,"helpers/dom/element":47,"helpers/feature":49,"helpers/number":52,"helpers/object":53,"helpers/string":55,"plugins":61,"utils/ghostTable":128,"utils/samplesGenerator":131}],64:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  AutoRowSize: {get: function() {
      return AutoRowSize;
    }},
  __esModule: {value: true}
});
var $___46__46__47__95_base__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__46__46__47_helpers_47_feature__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47_utils_47_ghostTable__,
    $___46__46__47__46__46__47_helpers_47_object__,
    $___46__46__47__46__46__47_helpers_47_number__,
    $___46__46__47__46__46__47_plugins__,
    $___46__46__47__46__46__47_utils_47_samplesGenerator__,
    $___46__46__47__46__46__47_helpers_47_string__;
var BasePlugin = ($___46__46__47__95_base__ = _dereq_("_base"), $___46__46__47__95_base__ && $___46__46__47__95_base__.__esModule && $___46__46__47__95_base__ || {default: $___46__46__47__95_base__}).default;
var $__1 = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}),
    arrayEach = $__1.arrayEach,
    arrayFilter = $__1.arrayFilter;
var $__2 = ($___46__46__47__46__46__47_helpers_47_feature__ = _dereq_("helpers/feature"), $___46__46__47__46__46__47_helpers_47_feature__ && $___46__46__47__46__46__47_helpers_47_feature__.__esModule && $___46__46__47__46__46__47_helpers_47_feature__ || {default: $___46__46__47__46__46__47_helpers_47_feature__}),
    cancelAnimationFrame = $__2.cancelAnimationFrame,
    requestAnimationFrame = $__2.requestAnimationFrame;
var isVisible = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}).isVisible;
var GhostTable = ($___46__46__47__46__46__47_utils_47_ghostTable__ = _dereq_("utils/ghostTable"), $___46__46__47__46__46__47_utils_47_ghostTable__ && $___46__46__47__46__46__47_utils_47_ghostTable__.__esModule && $___46__46__47__46__46__47_utils_47_ghostTable__ || {default: $___46__46__47__46__46__47_utils_47_ghostTable__}).GhostTable;
var $__5 = ($___46__46__47__46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47__46__46__47_helpers_47_object__ && $___46__46__47__46__46__47_helpers_47_object__.__esModule && $___46__46__47__46__46__47_helpers_47_object__ || {default: $___46__46__47__46__46__47_helpers_47_object__}),
    isObject = $__5.isObject,
    objectEach = $__5.objectEach;
var $__6 = ($___46__46__47__46__46__47_helpers_47_number__ = _dereq_("helpers/number"), $___46__46__47__46__46__47_helpers_47_number__ && $___46__46__47__46__46__47_helpers_47_number__.__esModule && $___46__46__47__46__46__47_helpers_47_number__ || {default: $___46__46__47__46__46__47_helpers_47_number__}),
    valueAccordingPercent = $__6.valueAccordingPercent,
    rangeEach = $__6.rangeEach;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
var SamplesGenerator = ($___46__46__47__46__46__47_utils_47_samplesGenerator__ = _dereq_("utils/samplesGenerator"), $___46__46__47__46__46__47_utils_47_samplesGenerator__ && $___46__46__47__46__46__47_utils_47_samplesGenerator__.__esModule && $___46__46__47__46__46__47_utils_47_samplesGenerator__ || {default: $___46__46__47__46__46__47_utils_47_samplesGenerator__}).SamplesGenerator;
var isPercentValue = ($___46__46__47__46__46__47_helpers_47_string__ = _dereq_("helpers/string"), $___46__46__47__46__46__47_helpers_47_string__ && $___46__46__47__46__46__47_helpers_47_string__.__esModule && $___46__46__47__46__46__47_helpers_47_string__ || {default: $___46__46__47__46__46__47_helpers_47_string__}).isPercentValue;
var AutoRowSize = function AutoRowSize(hotInstance) {
  var $__10 = this;
  $traceurRuntime.superConstructor($AutoRowSize).call(this, hotInstance);
  this.heights = [];
  this.ghostTable = new GhostTable(this.hot);
  this.samplesGenerator = new SamplesGenerator((function(row, col) {
    if (row >= 0) {
      return $__10.hot.getDataAtCell(row, col);
    } else if (row === -1) {
      return $__10.hot.getColHeader(col);
    } else {
      return null;
    }
  }));
  this.firstCalculation = true;
  this.inProgress = false;
  this.addHook('beforeRowResize', (function(row, size, isDblClick) {
    return $__10.onBeforeRowResize(row, size, isDblClick);
  }));
};
var $AutoRowSize = AutoRowSize;
($traceurRuntime.createClass)(AutoRowSize, {
  isEnabled: function() {
    return this.hot.getSettings().autoRowSize === true || isObject(this.hot.getSettings().autoRowSize);
  },
  enablePlugin: function() {
    var $__10 = this;
    if (this.enabled) {
      return;
    }
    this.setSamplingOptions();
    this.addHook('afterLoadData', (function() {
      return $__10.onAfterLoadData();
    }));
    this.addHook('beforeChange', (function(changes) {
      return $__10.onBeforeChange(changes);
    }));
    this.addHook('beforeColumnMove', (function() {
      return $__10.recalculateAllRowsHeight();
    }));
    this.addHook('beforeColumnResize', (function() {
      return $__10.recalculateAllRowsHeight();
    }));
    this.addHook('beforeColumnSort', (function() {
      return $__10.clearCache();
    }));
    this.addHook('beforeRender', (function(force) {
      return $__10.onBeforeRender(force);
    }));
    this.addHook('beforeRowMove', (function(rowStart, rowEnd) {
      return $__10.onBeforeRowMove(rowStart, rowEnd);
    }));
    this.addHook('modifyRowHeight', (function(height, row) {
      return $__10.getRowHeight(row, height);
    }));
    this.addHook('modifyColumnHeaderHeight', (function() {
      return $__10.getColumnHeaderHeight();
    }));
    $traceurRuntime.superGet(this, $AutoRowSize.prototype, "enablePlugin").call(this);
  },
  disablePlugin: function() {
    $traceurRuntime.superGet(this, $AutoRowSize.prototype, "disablePlugin").call(this);
  },
  calculateRowsHeight: function() {
    var rowRange = arguments[0] !== (void 0) ? arguments[0] : {
      from: 0,
      to: this.hot.countRows() - 1
    };
    var colRange = arguments[1] !== (void 0) ? arguments[1] : {
      from: 0,
      to: this.hot.countCols() - 1
    };
    var force = arguments[2] !== (void 0) ? arguments[2] : false;
    var $__10 = this;
    if (typeof rowRange === 'number') {
      rowRange = {
        from: rowRange,
        to: rowRange
      };
    }
    if (typeof colRange === 'number') {
      colRange = {
        from: colRange,
        to: colRange
      };
    }
    if (this.hot.getColHeader(0) !== null) {
      var samples = this.samplesGenerator.generateRowSamples(-1, colRange);
      this.ghostTable.addColumnHeadersRow(samples.get(-1));
    }
    rangeEach(rowRange.from, rowRange.to, (function(row) {
      if (force || $__10.heights[row] === void 0) {
        var samples = $__10.samplesGenerator.generateRowSamples(row, colRange);
        samples.forEach((function(sample, row) {
          return $__10.ghostTable.addRow(row, sample);
        }));
      }
    }));
    if (this.ghostTable.rows.length) {
      this.ghostTable.getHeights((function(row, height) {
        return $__10.heights[row] = height;
      }));
      this.ghostTable.clean();
    }
  },
  calculateAllRowsHeight: function() {
    var colRange = arguments[0] !== (void 0) ? arguments[0] : {
      from: 0,
      to: this.hot.countCols() - 1
    };
    var $__10 = this;
    var current = 0;
    var length = this.hot.countRows() - 1;
    var timer = null;
    this.inProgress = true;
    var loop = (function() {
      if (!$__10.hot) {
        cancelAnimationFrame(timer);
        $__10.inProgress = false;
        return;
      }
      $__10.calculateRowsHeight({
        from: current,
        to: Math.min(current + $AutoRowSize.CALCULATION_STEP, length)
      }, colRange);
      current = current + $AutoRowSize.CALCULATION_STEP + 1;
      if (current < length) {
        timer = requestAnimationFrame(loop);
      } else {
        cancelAnimationFrame(timer);
        $__10.inProgress = false;
        $__10.hot.view.wt.wtOverlays.adjustElementsSize(true);
        if ($__10.hot.view.wt.wtOverlays.leftOverlay.needFullRender) {
          $__10.hot.view.wt.wtOverlays.leftOverlay.clone.draw();
        }
      }
    });
    if (this.firstCalculation && this.getSyncCalculationLimit()) {
      this.calculateRowsHeight({
        from: 0,
        to: this.getSyncCalculationLimit()
      }, colRange);
      this.firstCalculation = false;
      current = this.getSyncCalculationLimit() + 1;
    }
    if (current < length) {
      loop();
    } else {
      this.inProgress = false;
      this.hot.view.wt.wtOverlays.adjustElementsSize(false);
    }
  },
  setSamplingOptions: function() {
    var setting = this.hot.getSettings().autoRowSize;
    var samplingRatio = setting && setting.hasOwnProperty('samplingRatio') ? this.hot.getSettings().autoRowSize.samplingRatio : void 0;
    var allowSampleDuplicates = setting && setting.hasOwnProperty('allowSampleDuplicates') ? this.hot.getSettings().autoRowSize.allowSampleDuplicates : void 0;
    if (samplingRatio && !isNaN(samplingRatio)) {
      this.samplesGenerator.setSampleCount(parseInt(samplingRatio, 10));
    }
    if (allowSampleDuplicates) {
      this.samplesGenerator.setAllowDuplicates(allowSampleDuplicates);
    }
  },
  recalculateAllRowsHeight: function() {
    if (isVisible(this.hot.view.wt.wtTable.TABLE)) {
      this.clearCache();
      this.calculateAllRowsHeight();
    }
  },
  getSyncCalculationLimit: function() {
    var limit = $AutoRowSize.SYNC_CALCULATION_LIMIT;
    var rowsLimit = this.hot.countRows() - 1;
    if (isObject(this.hot.getSettings().autoRowSize)) {
      limit = this.hot.getSettings().autoRowSize.syncLimit;
      if (isPercentValue(limit)) {
        limit = valueAccordingPercent(rowsLimit, limit);
      } else {
        limit = limit >> 0;
      }
    }
    return Math.min(limit, rowsLimit);
  },
  getRowHeight: function(row) {
    var defaultHeight = arguments[1];
    var height = defaultHeight;
    if (this.heights[row] !== void 0 && this.heights[row] > (defaultHeight || 0)) {
      height = this.heights[row];
    }
    return height;
  },
  getColumnHeaderHeight: function() {
    return this.heights[-1];
  },
  getFirstVisibleRow: function() {
    var wot = this.hot.view.wt;
    if (wot.wtViewport.rowsVisibleCalculator) {
      return wot.wtTable.getFirstVisibleRow();
    }
    if (wot.wtViewport.rowsRenderCalculator) {
      return wot.wtTable.getFirstRenderedRow();
    }
    return -1;
  },
  getLastVisibleRow: function() {
    var wot = this.hot.view.wt;
    if (wot.wtViewport.rowsVisibleCalculator) {
      return wot.wtTable.getLastVisibleRow();
    }
    if (wot.wtViewport.rowsRenderCalculator) {
      return wot.wtTable.getLastRenderedRow();
    }
    return -1;
  },
  clearCache: function() {
    this.heights.length = 0;
    this.heights[-1] = void 0;
  },
  clearCacheByRange: function(range) {
    var $__10 = this;
    if (typeof range === 'number') {
      range = {
        from: range,
        to: range
      };
    }
    rangeEach(Math.min(range.from, range.to), Math.max(range.from, range.to), (function(row) {
      return $__10.heights[row] = void 0;
    }));
  },
  isNeedRecalculate: function() {
    return arrayFilter(this.heights, (function(item) {
      return (item === void 0);
    })).length ? true : false;
  },
  onBeforeRender: function() {
    var force = this.hot.renderCall;
    this.calculateRowsHeight({
      from: this.getFirstVisibleRow(),
      to: this.getLastVisibleRow()
    }, void 0, force);
    var fixedRowsBottom = this.hot.getSettings().fixedRowsBottom;
    if (fixedRowsBottom) {
      var totalRows = this.hot.countRows() - 1;
      this.calculateRowsHeight({
        from: totalRows - fixedRowsBottom,
        to: totalRows
      });
    }
    if (this.isNeedRecalculate() && !this.inProgress) {
      this.calculateAllRowsHeight();
    }
  },
  onBeforeRowMove: function(from, to) {
    this.clearCacheByRange({
      from: from,
      to: to
    });
    this.calculateAllRowsHeight();
  },
  onBeforeRowResize: function(row, size, isDblClick) {
    if (isDblClick) {
      this.calculateRowsHeight(row, void 0, true);
      size = this.getRowHeight(row);
    }
    return size;
  },
  onAfterLoadData: function() {
    var $__10 = this;
    if (this.hot.view) {
      this.recalculateAllRowsHeight();
    } else {
      setTimeout((function() {
        if ($__10.hot) {
          $__10.recalculateAllRowsHeight();
        }
      }), 0);
    }
  },
  onBeforeChange: function(changes) {
    var range = null;
    if (changes.length === 1) {
      range = changes[0][0];
    } else if (changes.length > 1) {
      range = {
        from: changes[0][0],
        to: changes[changes.length - 1][0]
      };
    }
    if (range !== null) {
      this.clearCacheByRange(range);
    }
  },
  destroy: function() {
    this.ghostTable.clean();
    $traceurRuntime.superGet(this, $AutoRowSize.prototype, "destroy").call(this);
  }
}, {
  get CALCULATION_STEP() {
    return 50;
  },
  get SYNC_CALCULATION_LIMIT() {
    return 500;
  }
}, BasePlugin);
;
registerPlugin('autoRowSize', AutoRowSize);

//# 
},{"_base":62,"helpers/array":43,"helpers/dom/element":47,"helpers/feature":49,"helpers/number":52,"helpers/object":53,"helpers/string":55,"plugins":61,"utils/ghostTable":128,"utils/samplesGenerator":131}],65:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  Autofill: {get: function() {
      return Autofill;
    }},
  __esModule: {value: true}
});
var $___46__46__47__95_base__,
    $___46__46__47__46__46__47_browser__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47_eventManager__,
    $___46__46__47__46__46__47_plugins__,
    $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__,
    $__utils__;
var BasePlugin = ($___46__46__47__95_base__ = _dereq_("_base"), $___46__46__47__95_base__ && $___46__46__47__95_base__.__esModule && $___46__46__47__95_base__ || {default: $___46__46__47__95_base__}).default;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var arrayIncludes = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}).arrayIncludes;
var $__3 = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}),
    offset = $__3.offset,
    outerHeight = $__3.outerHeight,
    outerWidth = $__3.outerWidth;
var eventManagerObject = ($___46__46__47__46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47__46__46__47_eventManager__ && $___46__46__47__46__46__47_eventManager__.__esModule && $___46__46__47__46__46__47_eventManager__ || {default: $___46__46__47__46__46__47_eventManager__}).eventManager;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
var WalkontableCellCoords = ($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ = _dereq_("3rdparty/walkontable/src/cell/coords"), $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__.__esModule && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ || {default: $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__}).WalkontableCellCoords;
var $__7 = ($__utils__ = _dereq_("utils"), $__utils__ && $__utils__.__esModule && $__utils__ || {default: $__utils__}),
    getDeltas = $__7.getDeltas,
    getDragDirectionAndRange = $__7.getDragDirectionAndRange,
    DIRECTIONS = $__7.DIRECTIONS,
    getMappedFillHandleSetting = $__7.getMappedFillHandleSetting;
var INSERT_ROW_ALTER_ACTION_NAME = 'insert_row';
var INTERVAL_FOR_ADDING_ROW = 200;
var Autofill = function Autofill(hotInstance) {
  $traceurRuntime.superConstructor($Autofill).call(this, hotInstance);
  this.eventManager = eventManagerObject(this);
  this.addingStarted = false;
  this.mouseDownOnCellCorner = false;
  this.mouseDragOutside = false;
  this.handleDraggedCells = 0;
  this.directions = [];
  this.autoInsertRow = false;
};
var $Autofill = Autofill;
($traceurRuntime.createClass)(Autofill, {
  isEnabled: function() {
    return this.hot.getSettings().fillHandle;
  },
  enablePlugin: function() {
    var $__8 = this;
    if (this.enabled) {
      return;
    }
    this.mapSettings();
    this.registerEvents();
    this.addHook('afterOnCellCornerMouseDown', (function(event) {
      return $__8.onAfterCellCornerMouseDown(event);
    }));
    this.addHook('afterOnCellCornerDblClick', (function(event) {
      return $__8.onCellCornerDblClick(event);
    }));
    this.addHook('beforeOnCellMouseOver', (function(event, coords, TD) {
      return $__8.onBeforeCellMouseOver(coords);
    }));
    $traceurRuntime.superGet(this, $Autofill.prototype, "enablePlugin").call(this);
  },
  updatePlugin: function() {
    this.disablePlugin();
    this.enablePlugin();
    $traceurRuntime.superGet(this, $Autofill.prototype, "updatePlugin").call(this);
  },
  disablePlugin: function() {
    this.clearMappedSettings();
    $traceurRuntime.superGet(this, $Autofill.prototype, "disablePlugin").call(this);
  },
  getSelectionData: function() {
    var selRange = {
      from: this.hot.getSelectedRange().from,
      to: this.hot.getSelectedRange().to
    };
    return this.hot.getData(selRange.from.row, selRange.from.col, selRange.to.row, selRange.to.col);
  },
  fillIn: function() {
    if (this.hot.view.wt.selections.fill.isEmpty()) {
      return false;
    }
    var cornersOfSelectionAndDragAreas = this.hot.view.wt.selections.fill.getCorners();
    this.resetSelectionOfDraggedArea();
    var cornersOfSelectedCells = this.getCornersOfSelectedCells();
    var $__10 = getDragDirectionAndRange(cornersOfSelectedCells, cornersOfSelectionAndDragAreas),
        directionOfDrag = $__10.directionOfDrag,
        startOfDragCoords = $__10.startOfDragCoords,
        endOfDragCoords = $__10.endOfDragCoords;
    this.hot.runHooks('modifyAutofillRange', cornersOfSelectedCells, cornersOfSelectionAndDragAreas);
    if (startOfDragCoords && startOfDragCoords.row > -1 && startOfDragCoords.col > -1) {
      var selectionData = this.getSelectionData();
      var deltas = getDeltas(startOfDragCoords, endOfDragCoords, selectionData, directionOfDrag);
      this.hot.runHooks('beforeAutofill', startOfDragCoords, endOfDragCoords, selectionData);
      this.hot.populateFromArray(startOfDragCoords.row, startOfDragCoords.col, selectionData, endOfDragCoords.row, endOfDragCoords.col, (this.pluginName + ".fill"), null, directionOfDrag, deltas);
      this.setSelection(cornersOfSelectionAndDragAreas);
    } else {
      this.hot.selection.refreshBorders();
    }
    return true;
  },
  reduceSelectionAreaIfNeeded: function(coords) {
    if (coords.row < 0) {
      coords.row = 0;
    }
    if (coords.col < 0) {
      coords.col = 0;
    }
    return coords;
  },
  getCoordsOfDragAndDropBorders: function(coordsOfSelection) {
    var topLeftCorner = this.hot.getSelectedRange().getTopLeftCorner();
    var bottomRightCorner = this.hot.getSelectedRange().getBottomRightCorner();
    var coords;
    if (arrayIncludes(this.directions, DIRECTIONS.vertical) && (bottomRightCorner.row < coordsOfSelection.row || topLeftCorner.row > coordsOfSelection.row)) {
      coords = new WalkontableCellCoords(coordsOfSelection.row, bottomRightCorner.col);
    } else if (arrayIncludes(this.directions, DIRECTIONS.horizontal)) {
      coords = new WalkontableCellCoords(bottomRightCorner.row, coordsOfSelection.col);
    } else {
      return;
    }
    return this.reduceSelectionAreaIfNeeded(coords);
  },
  showBorder: function(coordsOfSelection) {
    var coordsOfDragAndDropBorders = this.getCoordsOfDragAndDropBorders(coordsOfSelection);
    if (coordsOfDragAndDropBorders) {
      this.redrawBorders(coordsOfDragAndDropBorders);
    }
  },
  addRow: function() {
    var $__8 = this;
    this.hot._registerTimeout(setTimeout((function() {
      $__8.hot.alter(INSERT_ROW_ALTER_ACTION_NAME, void 0, 1, ($__8.pluginName + ".fill"));
      $__8.addingStarted = false;
    }), INTERVAL_FOR_ADDING_ROW));
  },
  addNewRowIfNeeded: function() {
    if (this.hot.view.wt.selections.fill.cellRange && this.addingStarted === false && this.autoInsertRow) {
      var cornersOfSelectedCells = this.hot.getSelected();
      var cornersOfSelectedDragArea = this.hot.view.wt.selections.fill.getCorners();
      var nrOfTableRows = this.hot.countRows();
      if (cornersOfSelectedCells[2] < nrOfTableRows - 1 && cornersOfSelectedDragArea[2] === nrOfTableRows - 1) {
        this.addingStarted = true;
        this.addRow();
      }
    }
  },
  getCornersOfSelectedCells: function() {
    if (this.hot.selection.isMultiple()) {
      return this.hot.view.wt.selections.area.getCorners();
    } else {
      return this.hot.view.wt.selections.current.getCorners();
    }
  },
  getIndexOfLastAdjacentFilledInRow: function(cornersOfSelectedCells) {
    var data = this.hot.getData();
    var nrOfTableRows = this.hot.countRows();
    var lastFilledInRowIndex;
    for (var rowIndex = cornersOfSelectedCells[2] + 1; rowIndex < nrOfTableRows; rowIndex++) {
      for (var columnIndex = cornersOfSelectedCells[1]; columnIndex <= cornersOfSelectedCells[3]; columnIndex++) {
        var dataInCell = data[rowIndex][columnIndex];
        if (dataInCell) {
          return -1;
        }
      }
      var dataInNextLeftCell = data[rowIndex][cornersOfSelectedCells[1] - 1];
      var dataInNextRightCell = data[rowIndex][cornersOfSelectedCells[3] + 1];
      if (!!dataInNextLeftCell || !!dataInNextRightCell) {
        lastFilledInRowIndex = rowIndex;
      }
    }
    return lastFilledInRowIndex;
  },
  addSelectionFromStartAreaToSpecificRowIndex: function(selectStartArea, rowIndex) {
    this.hot.view.wt.selections.fill.clear();
    this.hot.view.wt.selections.fill.add(new WalkontableCellCoords(selectStartArea[0], selectStartArea[1]));
    this.hot.view.wt.selections.fill.add(new WalkontableCellCoords(rowIndex, selectStartArea[3]));
  },
  setSelection: function(cornersOfArea) {
    this.hot.selection.setRangeStart(new WalkontableCellCoords(cornersOfArea[0], cornersOfArea[1]));
    this.hot.selection.setRangeEnd(new WalkontableCellCoords(cornersOfArea[2], cornersOfArea[3]));
  },
  selectAdjacent: function() {
    var cornersOfSelectedCells = this.getCornersOfSelectedCells();
    var lastFilledInRowIndex = this.getIndexOfLastAdjacentFilledInRow(cornersOfSelectedCells);
    if (lastFilledInRowIndex === -1) {
      return false;
    } else {
      this.addSelectionFromStartAreaToSpecificRowIndex(cornersOfSelectedCells, lastFilledInRowIndex);
      return true;
    }
  },
  resetSelectionOfDraggedArea: function() {
    this.handleDraggedCells = 0;
    this.hot.view.wt.selections.fill.clear();
  },
  redrawBorders: function(coords) {
    this.hot.view.wt.selections.fill.clear();
    this.hot.view.wt.selections.fill.add(this.hot.getSelectedRange().from);
    this.hot.view.wt.selections.fill.add(this.hot.getSelectedRange().to);
    this.hot.view.wt.selections.fill.add(coords);
    this.hot.view.render();
  },
  getIfMouseWasDraggedOutside: function(event) {
    var tableBottom = offset(this.hot.table).top - (window.pageYOffset || document.documentElement.scrollTop) + outerHeight(this.hot.table);
    var tableRight = offset(this.hot.table).left - (window.pageXOffset || document.documentElement.scrollLeft) + outerWidth(this.hot.table);
    return event.clientY > tableBottom && event.clientX <= tableRight;
  },
  registerEvents: function() {
    var $__8 = this;
    this.eventManager.addEventListener(document.documentElement, 'mouseup', (function() {
      return $__8.onMouseUp();
    }));
    this.eventManager.addEventListener(document.documentElement, 'mousemove', (function(event) {
      return $__8.onMouseMove(event);
    }));
  },
  onCellCornerDblClick: function() {
    var selectionApplied = this.selectAdjacent();
    if (selectionApplied) {
      this.fillIn();
    }
  },
  onAfterCellCornerMouseDown: function() {
    this.handleDraggedCells = 1;
    this.mouseDownOnCellCorner = true;
  },
  onBeforeCellMouseOver: function(coords) {
    if (this.mouseDownOnCellCorner && !this.hot.view.isMouseDown() && this.handleDraggedCells) {
      this.handleDraggedCells++;
      this.showBorder(coords);
      this.addNewRowIfNeeded();
    }
  },
  onMouseUp: function() {
    if (this.handleDraggedCells) {
      if (this.handleDraggedCells > 1) {
        this.fillIn();
      }
      this.handleDraggedCells = 0;
      this.mouseDownOnCellCorner = false;
    }
  },
  onMouseMove: function(event) {
    var mouseWasDraggedOutside = this.getIfMouseWasDraggedOutside(event);
    if (this.addingStarted === false && this.handleDraggedCells > 0 && mouseWasDraggedOutside) {
      this.mouseDragOutside = true;
      this.addingStarted = true;
    } else {
      this.mouseDragOutside = false;
    }
    if (this.mouseDragOutside && this.autoInsertRow) {
      this.addRow();
    }
  },
  clearMappedSettings: function() {
    this.directions.length = 0;
    this.autoInsertRow = false;
  },
  mapSettings: function() {
    var mappedSettings = getMappedFillHandleSetting(this.hot.getSettings().fillHandle);
    this.directions = mappedSettings.directions;
    this.autoInsertRow = mappedSettings.autoInsertRow;
  },
  destroy: function() {
    $traceurRuntime.superGet(this, $Autofill.prototype, "destroy").call(this);
  }
}, {}, BasePlugin);
;
registerPlugin('autofill', Autofill);
Handsontable.hooks.register('modifyAutofillRange');
Handsontable.hooks.register('beforeAutofill');

//# 
},{"3rdparty/walkontable/src/cell/coords":6,"_base":62,"browser":24,"eventManager":42,"helpers/array":43,"helpers/dom/element":47,"plugins":61,"utils":66}],66:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  DIRECTIONS: {get: function() {
      return DIRECTIONS;
    }},
  getDeltas: {get: function() {
      return getDeltas;
    }},
  getDragDirectionAndRange: {get: function() {
      return getDragDirectionAndRange;
    }},
  getMappedFillHandleSetting: {get: function() {
      return getMappedFillHandleSetting;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_helpers_47_object__,
    $___46__46__47__46__46__47_helpers_47_mixed__;
var isObject = ($___46__46__47__46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47__46__46__47_helpers_47_object__ && $___46__46__47__46__46__47_helpers_47_object__.__esModule && $___46__46__47__46__46__47_helpers_47_object__ || {default: $___46__46__47__46__46__47_helpers_47_object__}).isObject;
var isDefined = ($___46__46__47__46__46__47_helpers_47_mixed__ = _dereq_("helpers/mixed"), $___46__46__47__46__46__47_helpers_47_mixed__ && $___46__46__47__46__46__47_helpers_47_mixed__.__esModule && $___46__46__47__46__46__47_helpers_47_mixed__ || {default: $___46__46__47__46__46__47_helpers_47_mixed__}).isDefined;
var DIRECTIONS = {
  horizontal: 'horizontal',
  vertical: 'vertical'
};
function getDeltas(start, end, data, direction) {
  var rowsLength = data.length;
  var columnsLength = data ? data[0].length : 0;
  var deltas = [];
  var diffRow = end.row - start.row;
  var diffCol = end.col - start.col;
  if (['down', 'up'].indexOf(direction) !== -1) {
    var arr = [];
    for (var col = 0; col <= diffCol; col++) {
      var startValue = parseInt(data[0][col], 10);
      var endValue = parseInt(data[rowsLength - 1][col], 10);
      var delta = (direction === 'down' ? (endValue - startValue) : (startValue - endValue)) / (rowsLength - 1) || 0;
      arr.push(delta);
    }
    deltas.push(arr);
  }
  if (['right', 'left'].indexOf(direction) !== -1) {
    for (var row = 0; row <= diffRow; row++) {
      var startValue$__2 = parseInt(data[row][0], 10);
      var endValue$__3 = parseInt(data[row][columnsLength - 1], 10);
      var delta$__4 = (direction === 'right' ? (endValue$__3 - startValue$__2) : (startValue$__2 - endValue$__3)) / (columnsLength - 1) || 0;
      deltas.push([delta$__4]);
    }
  }
  return deltas;
}
function getDragDirectionAndRange(startSelection, endSelection) {
  var startOfDragCoords,
      endOfDragCoords,
      directionOfDrag;
  if (endSelection[0] === startSelection[0] && endSelection[1] < startSelection[1]) {
    directionOfDrag = 'left';
    startOfDragCoords = new WalkontableCellCoords(endSelection[0], endSelection[1]);
    endOfDragCoords = new WalkontableCellCoords(endSelection[2], startSelection[1] - 1);
  } else if (endSelection[0] === startSelection[0] && endSelection[3] > startSelection[3]) {
    directionOfDrag = 'right';
    startOfDragCoords = new WalkontableCellCoords(endSelection[0], startSelection[3] + 1);
    endOfDragCoords = new WalkontableCellCoords(endSelection[2], endSelection[3]);
  } else if (endSelection[0] < startSelection[0] && endSelection[1] === startSelection[1]) {
    directionOfDrag = 'up';
    startOfDragCoords = new WalkontableCellCoords(endSelection[0], endSelection[1]);
    endOfDragCoords = new WalkontableCellCoords(startSelection[0] - 1, endSelection[3]);
  } else if (endSelection[2] > startSelection[2] && endSelection[1] === startSelection[1]) {
    directionOfDrag = 'down';
    startOfDragCoords = new WalkontableCellCoords(startSelection[2] + 1, endSelection[1]);
    endOfDragCoords = new WalkontableCellCoords(endSelection[2], endSelection[3]);
  }
  return {
    directionOfDrag: directionOfDrag,
    startOfDragCoords: startOfDragCoords,
    endOfDragCoords: endOfDragCoords
  };
}
function getMappedFillHandleSetting(fillHandle) {
  var mappedSettings = {};
  if (fillHandle === true) {
    mappedSettings.directions = Object.keys(DIRECTIONS);
    mappedSettings.autoInsertRow = true;
  } else if (isObject(fillHandle)) {
    if (isDefined(fillHandle.autoInsertRow)) {
      if (fillHandle.direction === DIRECTIONS.horizontal) {
        mappedSettings.autoInsertRow = false;
      } else {
        mappedSettings.autoInsertRow = fillHandle.autoInsertRow;
      }
    } else {
      mappedSettings.autoInsertRow = false;
    }
    if (isDefined(fillHandle.direction)) {
      mappedSettings.directions = [fillHandle.direction];
    } else {
      mappedSettings.directions = Object.keys(DIRECTIONS);
    }
  } else if (typeof fillHandle === 'string') {
    mappedSettings.directions = [fillHandle];
    mappedSettings.autoInsertRow = true;
  } else {
    mappedSettings.directions = [];
    mappedSettings.autoInsertRow = false;
  }
  return mappedSettings;
}

//# 
},{"helpers/mixed":51,"helpers/object":53}],67:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  ColumnSorting: {get: function() {
      return ColumnSorting;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__,
    $__moment__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__46__46__47_helpers_47_mixed__,
    $___46__46__47__95_base__,
    $___46__46__47__46__46__47_plugins__,
    $___46__46__47__46__46__47_utils_47_sortingAlgorithms_47_mergeSort__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var moment = ($__moment__ = _dereq_("moment"), $__moment__ && $__moment__.__esModule && $__moment__ || {default: $__moment__}).default;
var $__2 = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}),
    addClass = $__2.addClass,
    hasClass = $__2.hasClass,
    removeClass = $__2.removeClass;
var $__3 = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}),
    arrayMap = $__3.arrayMap,
    arrayReduce = $__3.arrayReduce;
var isEmpty = ($___46__46__47__46__46__47_helpers_47_mixed__ = _dereq_("helpers/mixed"), $___46__46__47__46__46__47_helpers_47_mixed__ && $___46__46__47__46__46__47_helpers_47_mixed__.__esModule && $___46__46__47__46__46__47_helpers_47_mixed__ || {default: $___46__46__47__46__46__47_helpers_47_mixed__}).isEmpty;
var BasePlugin = ($___46__46__47__95_base__ = _dereq_("_base"), $___46__46__47__95_base__ && $___46__46__47__95_base__.__esModule && $___46__46__47__95_base__ || {default: $___46__46__47__95_base__}).default;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
var mergeSort = ($___46__46__47__46__46__47_utils_47_sortingAlgorithms_47_mergeSort__ = _dereq_("utils/sortingAlgorithms/mergeSort"), $___46__46__47__46__46__47_utils_47_sortingAlgorithms_47_mergeSort__ && $___46__46__47__46__46__47_utils_47_sortingAlgorithms_47_mergeSort__.__esModule && $___46__46__47__46__46__47_utils_47_sortingAlgorithms_47_mergeSort__ || {default: $___46__46__47__46__46__47_utils_47_sortingAlgorithms_47_mergeSort__}).mergeSort;
Handsontable.hooks.register('beforeColumnSort');
Handsontable.hooks.register('afterColumnSort');
var ColumnSorting = function ColumnSorting(hotInstance) {
  $traceurRuntime.superConstructor($ColumnSorting).call(this, hotInstance);
  this.sortIndicators = [];
  this.lastSortedColumn = null;
  this.sortEmptyCells = false;
};
var $ColumnSorting = ColumnSorting;
($traceurRuntime.createClass)(ColumnSorting, {
  isEnabled: function() {
    return !!(this.hot.getSettings().columnSorting);
  },
  enablePlugin: function() {
    var $__8 = this;
    if (this.enabled) {
      return;
    }
    this.setPluginOptions();
    var _this = this;
    this.hot.sortIndex = [];
    this.hot.sort = function() {
      var args = Array.prototype.slice.call(arguments);
      return _this.sortByColumn.apply(_this, args);
    };
    if (typeof this.hot.getSettings().observeChanges === 'undefined') {
      this.enableObserveChangesPlugin();
    }
    this.addHook('afterTrimRow', (function(row) {
      return $__8.sort();
    }));
    this.addHook('afterUntrimRow', (function(row) {
      return $__8.sort();
    }));
    this.addHook('modifyRow', (function(row) {
      return $__8.translateRow(row);
    }));
    this.addHook('unmodifyRow', (function(row) {
      return $__8.untranslateRow(row);
    }));
    this.addHook('afterUpdateSettings', (function() {
      return $__8.onAfterUpdateSettings();
    }));
    this.addHook('afterGetColHeader', (function(col, TH) {
      return $__8.getColHeader(col, TH);
    }));
    this.addHook('afterOnCellMouseDown', (function(event, target) {
      return $__8.onAfterOnCellMouseDown(event, target);
    }));
    this.addHook('afterCreateRow', function() {
      _this.afterCreateRow.apply(_this, arguments);
    });
    this.addHook('afterRemoveRow', function() {
      _this.afterRemoveRow.apply(_this, arguments);
    });
    this.addHook('afterInit', (function() {
      return $__8.sortBySettings();
    }));
    this.addHook('afterLoadData', (function() {
      $__8.hot.sortIndex = [];
      if ($__8.hot.view) {
        $__8.sortBySettings();
      }
    }));
    if (this.hot.view) {
      this.sortBySettings();
    }
    $traceurRuntime.superGet(this, $ColumnSorting.prototype, "enablePlugin").call(this);
  },
  disablePlugin: function() {
    this.hot.sort = void 0;
    $traceurRuntime.superGet(this, $ColumnSorting.prototype, "disablePlugin").call(this);
  },
  onAfterUpdateSettings: function() {
    this.sortBySettings();
  },
  sortBySettings: function() {
    var sortingSettings = this.hot.getSettings().columnSorting;
    var loadedSortingState = this.loadSortingState();
    var sortingColumn;
    var sortingOrder;
    if (typeof loadedSortingState === 'undefined') {
      sortingColumn = sortingSettings.column;
      sortingOrder = sortingSettings.sortOrder;
    } else {
      sortingColumn = loadedSortingState.sortColumn;
      sortingOrder = loadedSortingState.sortOrder;
    }
    if (typeof sortingColumn === 'number') {
      this.lastSortedColumn = sortingColumn;
      this.sortByColumn(sortingColumn, sortingOrder);
    }
  },
  setSortingColumn: function(col, order) {
    if (typeof col == 'undefined') {
      this.hot.sortColumn = void 0;
      this.hot.sortOrder = void 0;
      return;
    } else if (this.hot.sortColumn === col && typeof order == 'undefined') {
      if (this.hot.sortOrder === false) {
        this.hot.sortOrder = void 0;
      } else {
        this.hot.sortOrder = !this.hot.sortOrder;
      }
    } else {
      this.hot.sortOrder = typeof order === 'undefined' ? true : order;
    }
    this.hot.sortColumn = col;
  },
  sortByColumn: function(col, order) {
    this.setSortingColumn(col, order);
    if (typeof this.hot.sortColumn == 'undefined') {
      return;
    }
    var allowSorting = Handsontable.hooks.run(this.hot, 'beforeColumnSort', this.hot.sortColumn, this.hot.sortOrder);
    if (allowSorting !== false) {
      this.sort();
    }
    this.updateOrderClass();
    this.updateSortIndicator();
    Handsontable.hooks.run(this.hot, 'afterColumnSort', this.hot.sortColumn, this.hot.sortOrder);
    this.hot.render();
    this.saveSortingState();
  },
  saveSortingState: function() {
    var sortingState = {};
    if (typeof this.hot.sortColumn != 'undefined') {
      sortingState.sortColumn = this.hot.sortColumn;
    }
    if (typeof this.hot.sortOrder != 'undefined') {
      sortingState.sortOrder = this.hot.sortOrder;
    }
    if (sortingState.hasOwnProperty('sortColumn') || sortingState.hasOwnProperty('sortOrder')) {
      Handsontable.hooks.run(this.hot, 'persistentStateSave', 'columnSorting', sortingState);
    }
  },
  loadSortingState: function() {
    var storedState = {};
    Handsontable.hooks.run(this.hot, 'persistentStateLoad', 'columnSorting', storedState);
    return storedState.value;
  },
  updateOrderClass: function() {
    var orderClass;
    if (this.hot.sortOrder === true) {
      orderClass = 'ascending';
    } else if (this.hot.sortOrder === false) {
      orderClass = 'descending';
    }
    this.sortOrderClass = orderClass;
  },
  enableObserveChangesPlugin: function() {
    var _this = this;
    this.hot._registerTimeout(setTimeout(function() {
      _this.hot.updateSettings({observeChanges: true});
    }, 0));
  },
  defaultSort: function(sortOrder, columnMeta) {
    return function(a, b) {
      if (typeof a[1] == 'string') {
        a[1] = a[1].toLowerCase();
      }
      if (typeof b[1] == 'string') {
        b[1] = b[1].toLowerCase();
      }
      if (a[1] === b[1]) {
        return 0;
      }
      if (isEmpty(a[1])) {
        if (isEmpty(b[1])) {
          return 0;
        }
        if (columnMeta.columnSorting.sortEmptyCells) {
          return sortOrder ? -1 : 1;
        }
        return 1;
      }
      if (isEmpty(b[1])) {
        if (isEmpty(a[1])) {
          return 0;
        }
        if (columnMeta.columnSorting.sortEmptyCells) {
          return sortOrder ? 1 : -1;
        }
        return -1;
      }
      if (isNaN(a[1]) && !isNaN(b[1])) {
        return sortOrder ? 1 : -1;
      } else if (!isNaN(a[1]) && isNaN(b[1])) {
        return sortOrder ? -1 : 1;
      } else if (!(isNaN(a[1]) || isNaN(b[1]))) {
        a[1] = parseFloat(a[1]);
        b[1] = parseFloat(b[1]);
      }
      if (a[1] < b[1]) {
        return sortOrder ? -1 : 1;
      }
      if (a[1] > b[1]) {
        return sortOrder ? 1 : -1;
      }
      return 0;
    };
  },
  dateSort: function(sortOrder, columnMeta) {
    return function(a, b) {
      if (a[1] === b[1]) {
        return 0;
      }
      if (isEmpty(a[1])) {
        if (isEmpty(b[1])) {
          return 0;
        }
        if (columnMeta.columnSorting.sortEmptyCells) {
          return sortOrder ? -1 : 1;
        }
        return 1;
      }
      if (isEmpty(b[1])) {
        if (isEmpty(a[1])) {
          return 0;
        }
        if (columnMeta.columnSorting.sortEmptyCells) {
          return sortOrder ? 1 : -1;
        }
        return -1;
      }
      var aDate = moment(a[1], columnMeta.dateFormat);
      var bDate = moment(b[1], columnMeta.dateFormat);
      if (!aDate.isValid()) {
        return 1;
      }
      if (!bDate.isValid()) {
        return -1;
      }
      if (bDate.isAfter(aDate)) {
        return sortOrder ? -1 : 1;
      }
      if (bDate.isBefore(aDate)) {
        return sortOrder ? 1 : -1;
      }
      return 0;
    };
  },
  numericSort: function(sortOrder, columnMeta) {
    return function(a, b) {
      var parsedA = parseFloat(a[1]);
      var parsedB = parseFloat(b[1]);
      if (parsedA === parsedB || (isNaN(parsedA) && isNaN(parsedB))) {
        return 0;
      }
      if (columnMeta.columnSorting.sortEmptyCells) {
        if (isEmpty(a[1])) {
          return sortOrder ? -1 : 1;
        }
        if (isEmpty(b[1])) {
          return sortOrder ? 1 : -1;
        }
      }
      if (isNaN(parsedA)) {
        return 1;
      }
      if (isNaN(parsedB)) {
        return -1;
      }
      if (parsedA < parsedB) {
        return sortOrder ? -1 : 1;
      } else if (parsedA > parsedB) {
        return sortOrder ? 1 : -1;
      }
      return 0;
    };
  },
  sort: function() {
    if (typeof this.hot.sortOrder == 'undefined') {
      this.hot.sortIndex.length = 0;
      return;
    }
    var colMeta = this.hot.getCellMeta(0, this.hot.sortColumn);
    var emptyRows = this.hot.countEmptyRows();
    var sortFunction;
    var nrOfRows;
    this.hot.sortingEnabled = false;
    this.hot.sortIndex.length = 0;
    if (typeof colMeta.columnSorting.sortEmptyCells === 'undefined') {
      colMeta.columnSorting = {sortEmptyCells: this.sortEmptyCells};
    }
    if (this.hot.getSettings().maxRows === Number.POSITIVE_INFINITY) {
      nrOfRows = this.hot.countRows() - this.hot.getSettings().minSpareRows;
    } else {
      nrOfRows = this.hot.countRows() - emptyRows;
    }
    for (var i = 0,
        ilen = nrOfRows; i < ilen; i++) {
      this.hot.sortIndex.push([i, this.hot.getDataAtCell(i, this.hot.sortColumn)]);
    }
    if (colMeta.sortFunction) {
      sortFunction = colMeta.sortFunction;
    } else {
      switch (colMeta.type) {
        case 'date':
          sortFunction = this.dateSort;
          break;
        case 'numeric':
          sortFunction = this.numericSort;
          break;
        default:
          sortFunction = this.defaultSort;
      }
    }
    mergeSort(this.hot.sortIndex, sortFunction(this.hot.sortOrder, colMeta));
    for (var i$__10 = this.hot.sortIndex.length; i$__10 < this.hot.countRows(); i$__10++) {
      this.hot.sortIndex.push([i$__10, this.hot.getDataAtCell(i$__10, this.hot.sortColumn)]);
    }
    this.hot.sortingEnabled = true;
  },
  updateSortIndicator: function() {
    if (typeof this.hot.sortOrder == 'undefined') {
      return;
    }
    var colMeta = this.hot.getCellMeta(0, this.hot.sortColumn);
    this.sortIndicators[this.hot.sortColumn] = colMeta.sortIndicator;
  },
  translateRow: function(row) {
    if (this.hot.sortingEnabled && (typeof this.hot.sortOrder !== 'undefined') && this.hot.sortIndex && this.hot.sortIndex.length && this.hot.sortIndex[row]) {
      return this.hot.sortIndex[row][0];
    }
    return row;
  },
  untranslateRow: function(row) {
    if (this.hot.sortingEnabled && this.hot.sortIndex && this.hot.sortIndex.length) {
      for (var i = 0; i < this.hot.sortIndex.length; i++) {
        if (this.hot.sortIndex[i][0] == row) {
          return i;
        }
      }
    }
  },
  getColHeader: function(col, TH) {
    if (col < 0 || !TH.parentNode) {
      return false;
    }
    var headerLink = TH.querySelector('.colHeader');
    var colspan = TH.getAttribute('colspan');
    var TRs = TH.parentNode.parentNode.childNodes;
    var headerLevel = Array.prototype.indexOf.call(TRs, TH.parentNode);
    headerLevel = headerLevel - TRs.length;
    if (!headerLink) {
      return;
    }
    if (this.hot.getSettings().columnSorting && col >= 0 && headerLevel === -1) {
      addClass(headerLink, 'columnSorting');
    }
    removeClass(headerLink, 'descending');
    removeClass(headerLink, 'ascending');
    if (this.sortIndicators[col]) {
      if (col === this.hot.sortColumn) {
        if (this.sortOrderClass === 'ascending') {
          addClass(headerLink, 'ascending');
        } else if (this.sortOrderClass === 'descending') {
          addClass(headerLink, 'descending');
        }
      }
    }
  },
  isSorted: function() {
    return typeof this.hot.sortColumn != 'undefined';
  },
  afterCreateRow: function(index, amount) {
    if (!this.isSorted()) {
      return;
    }
    for (var i = 0; i < this.hot.sortIndex.length; i++) {
      if (this.hot.sortIndex[i][0] >= index) {
        this.hot.sortIndex[i][0] += amount;
      }
    }
    for (var i = 0; i < amount; i++) {
      this.hot.sortIndex.splice(index + i, 0, [index + i, this.hot.getSourceData()[index + i][this.hot.sortColumn + this.hot.colOffset()]]);
    }
    this.saveSortingState();
  },
  afterRemoveRow: function(index, amount) {
    if (!this.isSorted()) {
      return;
    }
    var removedRows = this.hot.sortIndex.splice(index, amount);
    removedRows = arrayMap(removedRows, (function(row) {
      return row[0];
    }));
    function countRowShift(logicalRow) {
      return arrayReduce(removedRows, (function(count, removedLogicalRow) {
        if (logicalRow > removedLogicalRow) {
          count++;
        }
        return count;
      }), 0);
    }
    this.hot.sortIndex = arrayMap(this.hot.sortIndex, (function(logicalRow, physicalRow) {
      var rowShift = countRowShift(logicalRow[0]);
      if (rowShift) {
        logicalRow[0] -= rowShift;
      }
      return logicalRow;
    }));
    this.saveSortingState();
  },
  setPluginOptions: function() {
    var columnSorting = this.hot.getSettings().columnSorting;
    if (typeof columnSorting === 'object') {
      this.sortEmptyCells = columnSorting.sortEmptyCells || false;
    } else {
      this.sortEmptyCells = false;
    }
  },
  onAfterOnCellMouseDown: function(event, coords) {
    if (coords.row > -1) {
      return;
    }
    if (hasClass(event.realTarget, 'columnSorting')) {
      if (coords.col !== this.lastSortedColumn) {
        this.hot.sortOrder = true;
      }
      this.lastSortedColumn = coords.col;
      this.sortByColumn(coords.col);
    }
  }
}, {}, BasePlugin);
;
registerPlugin('columnSorting', ColumnSorting);

//# 
},{"_base":62,"browser":24,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,"moment":"moment","plugins":61,"utils/sortingAlgorithms/mergeSort":132}],68:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  CommentEditor: {get: function() {
      return CommentEditor;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_helpers_47_dom_47_element__;
var addClass = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}).addClass;
var CommentEditor = function CommentEditor() {
  this.editor = this.createEditor();
  this.editorStyle = this.editor.style;
  this.hidden = true;
  this.hide();
};
var $CommentEditor = CommentEditor;
($traceurRuntime.createClass)(CommentEditor, {
  setPosition: function(x, y) {
    this.editorStyle.left = x + 'px';
    this.editorStyle.top = y + 'px';
  },
  setSize: function(width, height) {
    if (width && height) {
      var input = this.getInputElement();
      input.style.width = width + 'px';
      input.style.height = height + 'px';
    }
  },
  resetSize: function() {
    var input = this.getInputElement();
    input.style.width = '';
    input.style.height = '';
  },
  setReadOnlyState: function(state) {
    var input = this.getInputElement();
    input.readOnly = state;
  },
  show: function() {
    this.editorStyle.display = 'block';
    this.hidden = false;
  },
  hide: function() {
    this.editorStyle.display = 'none';
    this.hidden = true;
  },
  isVisible: function() {
    return this.editorStyle.display === 'block';
  },
  setValue: function() {
    var value = arguments[0] !== (void 0) ? arguments[0] : '';
    value = value || '';
    this.getInputElement().value = value;
  },
  getValue: function() {
    return this.getInputElement().value;
  },
  isFocused: function() {
    return document.activeElement === this.getInputElement();
  },
  focus: function() {
    this.getInputElement().focus();
  },
  createEditor: function() {
    var container = document.querySelector('.' + $CommentEditor.CLASS_EDITOR_CONTAINER);
    var editor;
    var textArea;
    if (!container) {
      container = document.createElement('div');
      addClass(container, $CommentEditor.CLASS_EDITOR_CONTAINER);
      document.body.appendChild(container);
    }
    editor = document.createElement('div');
    addClass(editor, $CommentEditor.CLASS_EDITOR);
    textArea = document.createElement('textarea');
    addClass(textArea, $CommentEditor.CLASS_INPUT);
    editor.appendChild(textArea);
    container.appendChild(editor);
    return editor;
  },
  getInputElement: function() {
    return this.editor.querySelector('.' + $CommentEditor.CLASS_INPUT);
  },
  destroy: function() {
    this.editor.parentNode.removeChild(this.editor);
    this.editor = null;
    this.editorStyle = null;
  }
}, {
  get CLASS_EDITOR_CONTAINER() {
    return 'htCommentsContainer';
  },
  get CLASS_EDITOR() {
    return 'htComments';
  },
  get CLASS_INPUT() {
    return 'htCommentTextArea';
  },
  get CLASS_CELL() {
    return 'htCommentCell';
  }
});
;

//# 
},{"helpers/dom/element":47}],69:[function(_dereq_,module,exports){
"use strict";
var $__13;
Object.defineProperties(exports, {
  Comments: {get: function() {
      return Comments;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47_helpers_47_object__,
    $___46__46__47__46__46__47_helpers_47_function__,
    $___46__46__47__46__46__47_eventManager__,
    $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__,
    $___46__46__47__46__46__47_plugins__,
    $___46__46__47__95_base__,
    $__commentEditor__,
    $___46__46__47_contextMenu_47_utils__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var $__1 = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}),
    addClass = $__1.addClass,
    closest = $__1.closest,
    isChildOf = $__1.isChildOf,
    hasClass = $__1.hasClass,
    offset = $__1.offset,
    outerWidth = $__1.outerWidth,
    outerHeight = $__1.outerHeight,
    getScrollableElement = $__1.getScrollableElement;
var $__2 = ($___46__46__47__46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47__46__46__47_helpers_47_object__ && $___46__46__47__46__46__47_helpers_47_object__.__esModule && $___46__46__47__46__46__47_helpers_47_object__ || {default: $___46__46__47__46__46__47_helpers_47_object__}),
    deepClone = $__2.deepClone,
    deepExtend = $__2.deepExtend;
var debounce = ($___46__46__47__46__46__47_helpers_47_function__ = _dereq_("helpers/function"), $___46__46__47__46__46__47_helpers_47_function__ && $___46__46__47__46__46__47_helpers_47_function__.__esModule && $___46__46__47__46__46__47_helpers_47_function__ || {default: $___46__46__47__46__46__47_helpers_47_function__}).debounce;
var EventManager = ($___46__46__47__46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47__46__46__47_eventManager__ && $___46__46__47__46__46__47_eventManager__.__esModule && $___46__46__47__46__46__47_eventManager__ || {default: $___46__46__47__46__46__47_eventManager__}).EventManager;
var WalkontableCellCoords = ($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ = _dereq_("3rdparty/walkontable/src/cell/coords"), $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__.__esModule && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ || {default: $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__}).WalkontableCellCoords;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
var BasePlugin = ($___46__46__47__95_base__ = _dereq_("_base"), $___46__46__47__95_base__ && $___46__46__47__95_base__.__esModule && $___46__46__47__95_base__ || {default: $___46__46__47__95_base__}).default;
var CommentEditor = ($__commentEditor__ = _dereq_("commentEditor"), $__commentEditor__ && $__commentEditor__.__esModule && $__commentEditor__ || {default: $__commentEditor__}).CommentEditor;
var $__9 = ($___46__46__47_contextMenu_47_utils__ = _dereq_("contextMenu/utils"), $___46__46__47_contextMenu_47_utils__ && $___46__46__47_contextMenu_47_utils__.__esModule && $___46__46__47_contextMenu_47_utils__ || {default: $___46__46__47_contextMenu_47_utils__}),
    checkSelectionConsistency = $__9.checkSelectionConsistency,
    markLabelAsSelected = $__9.markLabelAsSelected;
var privatePool = new WeakMap();
var META_COMMENT = 'comment';
var META_COMMENT_VALUE = 'value';
var META_STYLE = 'style';
var META_READONLY = 'readOnly';
var Comments = function Comments(hotInstance) {
  $traceurRuntime.superConstructor($Comments).call(this, hotInstance);
  this.editor = null;
  this.eventManager = null;
  this.range = {};
  this.mouseDown = false;
  this.contextMenuEvent = false;
  this.timer = null;
  this.displayDelay = 250;
  privatePool.set(this, {
    tempEditorDimensions: {},
    cellBelowCursor: null
  });
};
var $Comments = Comments;
($traceurRuntime.createClass)(Comments, ($__13 = {}, Object.defineProperty($__13, "isEnabled", {
  value: function() {
    return !!this.hot.getSettings().comments;
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "enablePlugin", {
  value: function() {
    var $__10 = this;
    if (this.enabled) {
      return;
    }
    if (!this.editor) {
      this.editor = new CommentEditor();
    }
    if (!this.eventManager) {
      this.eventManager = new EventManager(this);
    }
    this.addHook('afterContextMenuDefaultOptions', (function(options) {
      return $__10.addToContextMenu(options);
    }));
    this.addHook('afterRenderer', (function(TD, row, col, prop, value, cellProperties) {
      return $__10.onAfterRenderer(TD, cellProperties);
    }));
    this.addHook('afterScrollHorizontally', (function() {
      return $__10.hide();
    }));
    this.addHook('afterScrollVertically', (function() {
      return $__10.hide();
    }));
    this.addHook('afterBeginEditing', (function(args) {
      return $__10.onAfterBeginEditing(args);
    }));
    this.registerListeners();
    $traceurRuntime.superGet(this, $Comments.prototype, "enablePlugin").call(this);
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "disablePlugin", {
  value: function() {
    $traceurRuntime.superGet(this, $Comments.prototype, "disablePlugin").call(this);
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "registerListeners", {
  value: function() {
    var $__10 = this;
    this.eventManager.addEventListener(document, 'mouseover', (function(event) {
      return $__10.onMouseOver(event);
    }));
    this.eventManager.addEventListener(document, 'mousedown', (function(event) {
      return $__10.onMouseDown(event);
    }));
    this.eventManager.addEventListener(document, 'mouseup', (function(event) {
      return $__10.onMouseUp(event);
    }));
    this.eventManager.addEventListener(this.editor.getInputElement(), 'blur', (function(event) {
      return $__10.onEditorBlur(event);
    }));
    this.eventManager.addEventListener(this.editor.getInputElement(), 'mousedown', (function(event) {
      return $__10.onEditorMouseDown(event);
    }));
    this.eventManager.addEventListener(this.editor.getInputElement(), 'mouseup', (function(event) {
      return $__10.onEditorMouseUp(event);
    }));
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "setRange", {
  value: function(range) {
    this.range = range;
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "clearRange", {
  value: function() {
    this.range = {};
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "targetIsCellWithComment", {
  value: function(event) {
    var closestCell = closest(event.target, 'TD', 'TBODY');
    return closestCell && hasClass(closestCell, 'htCommentCell') && closest(closestCell, [this.hot.rootElement]) ? true : false;
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "targetIsCommentTextArea", {
  value: function(event) {
    return this.editor.getInputElement() === event.target;
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "setComment", {
  value: function(value) {
    var $__13;
    if (!this.range.from) {
      throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');
    }
    var editorValue = this.editor.getValue();
    var comment = '';
    if (value != null) {
      comment = value;
    } else if (editorValue != null) {
      comment = editorValue;
    }
    var row = this.range.from.row;
    var col = this.range.from.col;
    this.updateCommentMeta(row, col, ($__13 = {}, Object.defineProperty($__13, META_COMMENT_VALUE, {
      value: comment,
      configurable: true,
      enumerable: true,
      writable: true
    }), $__13));
    this.hot.render();
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "setCommentAtCell", {
  value: function(row, col, value) {
    this.setRange({from: new WalkontableCellCoords(row, col)});
    this.setComment(value);
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "removeComment", {
  value: function() {
    var forceRender = arguments[0] !== (void 0) ? arguments[0] : true;
    if (!this.range.from) {
      throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');
    }
    this.hot.setCellMeta(this.range.from.row, this.range.from.col, META_COMMENT, void 0);
    if (forceRender) {
      this.hot.render();
    }
    this.hide();
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "removeCommentAtCell", {
  value: function(row, col) {
    var forceRender = arguments[2] !== (void 0) ? arguments[2] : true;
    this.setRange({from: new WalkontableCellCoords(row, col)});
    this.removeComment(forceRender);
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "getComment", {
  value: function() {
    var row = this.range.from.row;
    var column = this.range.from.col;
    return this.getCommentMeta(row, column, META_COMMENT_VALUE);
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "getCommentAtCell", {
  value: function(row, column) {
    return this.getCommentMeta(row, column, META_COMMENT_VALUE);
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "show", {
  value: function() {
    if (!this.range.from) {
      throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');
    }
    var meta = this.hot.getCellMeta(this.range.from.row, this.range.from.col);
    this.refreshEditor(true);
    this.editor.setValue(meta[META_COMMENT] ? meta[META_COMMENT][META_COMMENT_VALUE] : null || '');
    if (this.editor.hidden) {
      this.editor.show();
    }
    return true;
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "showAtCell", {
  value: function(row, col) {
    this.setRange({from: new WalkontableCellCoords(row, col)});
    return this.show();
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "hide", {
  value: function() {
    if (!this.editor.hidden) {
      this.editor.hide();
    }
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "refreshEditor", {
  value: function() {
    var force = arguments[0] !== (void 0) ? arguments[0] : false;
    if (!force && (!this.range.from || !this.editor.isVisible())) {
      return;
    }
    var scrollableElement = getScrollableElement(this.hot.view.wt.wtTable.TABLE);
    var TD = this.hot.view.wt.wtTable.getCell(this.range.from);
    var row = this.range.from.row;
    var column = this.range.from.col;
    var cellOffset = offset(TD);
    var lastColWidth = this.hot.view.wt.wtTable.getStretchedColumnWidth(column);
    var cellTopOffset = cellOffset.top < 0 ? 0 : cellOffset.top;
    var cellLeftOffset = cellOffset.left;
    if (this.hot.view.wt.wtViewport.hasVerticalScroll() && scrollableElement !== window) {
      cellTopOffset = cellTopOffset - this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition();
    }
    if (this.hot.view.wt.wtViewport.hasHorizontalScroll() && scrollableElement !== window) {
      cellLeftOffset = cellLeftOffset - this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition();
    }
    var x = cellLeftOffset + lastColWidth;
    var y = cellTopOffset;
    var commentStyle = this.getCommentMeta(row, column, META_STYLE);
    var readOnly = this.getCommentMeta(row, column, META_READONLY);
    if (commentStyle) {
      this.editor.setSize(commentStyle.width, commentStyle.height);
    } else {
      this.editor.resetSize();
    }
    this.editor.setReadOnlyState(readOnly);
    this.editor.setPosition(x, y);
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "checkSelectionCommentsConsistency", {
  value: function() {
    var selected = this.hot.getSelectedRange();
    if (!selected) {
      return false;
    }
    var hasComment = false;
    var cell = selected.from;
    if (this.getCommentMeta(cell.row, cell.col, META_COMMENT_VALUE)) {
      hasComment = true;
    }
    return hasComment;
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "updateCommentMeta", {
  value: function(row, column, metaObject) {
    var oldComment = this.hot.getCellMeta(row, column)[META_COMMENT];
    var newComment;
    if (oldComment) {
      newComment = deepClone(oldComment);
      deepExtend(newComment, metaObject);
    } else {
      newComment = metaObject;
    }
    this.hot.setCellMeta(row, column, META_COMMENT, newComment);
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "getCommentMeta", {
  value: function(row, column, property) {
    var cellMeta = this.hot.getCellMeta(row, column);
    if (!cellMeta[META_COMMENT]) {
      return void 0;
    }
    return cellMeta[META_COMMENT][property];
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "onMouseDown", {
  value: function(event) {
    this.mouseDown = true;
    if (!this.hot.view || !this.hot.view.wt) {
      return;
    }
    if (!this.contextMenuEvent && !this.targetIsCommentTextArea(event)) {
      var eventCell = closest(event.target, 'TD', 'TBODY');
      var coordinates = null;
      if (eventCell) {
        coordinates = this.hot.view.wt.wtTable.getCoords(eventCell);
      }
      if (!eventCell || ((this.range.from && coordinates) && (this.range.from.row !== coordinates.row || this.range.from.col !== coordinates.col))) {
        this.hide();
      }
    }
    this.contextMenuEvent = false;
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "onMouseOver", {
  value: function(event) {
    var $__10 = this;
    if (this.mouseDown || this.editor.isFocused()) {
      return;
    }
    var priv = privatePool.get(this);
    priv.cellBelowCursor = document.elementFromPoint(event.clientX, event.clientY);
    debounce((function() {
      if (hasClass(event.target, 'wtBorder') || priv.cellBelowCursor !== event.target || !$__10.editor) {
        return;
      }
      if ($__10.targetIsCellWithComment(event)) {
        var coordinates = $__10.hot.view.wt.wtTable.getCoords(event.target);
        var range = {from: new WalkontableCellCoords(coordinates.row, coordinates.col)};
        $__10.setRange(range);
        $__10.show();
      } else if (isChildOf(event.target, document) && !$__10.targetIsCommentTextArea(event) && !$__10.editor.isFocused()) {
        $__10.hide();
      }
    }), this.displayDelay)();
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "onMouseUp", {
  value: function(event) {
    this.mouseDown = false;
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "onAfterRenderer", {
  value: function(TD, cellProperties) {
    if (cellProperties[META_COMMENT] && cellProperties[META_COMMENT][META_COMMENT_VALUE]) {
      addClass(TD, cellProperties.commentedCellClassName);
    }
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "onEditorBlur", {
  value: function(event) {
    this.setComment();
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "onEditorMouseDown", {
  value: function(event) {
    var priv = privatePool.get(this);
    priv.tempEditorDimensions = {
      width: outerWidth(event.target),
      height: outerHeight(event.target)
    };
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "onEditorMouseUp", {
  value: function(event) {
    var $__13;
    var priv = privatePool.get(this);
    var currentWidth = outerWidth(event.target);
    var currentHeight = outerHeight(event.target);
    if (currentWidth !== priv.tempEditorDimensions.width + 1 || currentHeight !== priv.tempEditorDimensions.height + 2) {
      this.updateCommentMeta(this.range.from.row, this.range.from.col, ($__13 = {}, Object.defineProperty($__13, META_STYLE, {
        value: {
          width: currentWidth,
          height: currentHeight
        },
        configurable: true,
        enumerable: true,
        writable: true
      }), $__13));
    }
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "onContextMenuAddComment", {
  value: function() {
    var $__10 = this;
    var coords = this.hot.getSelectedRange();
    this.contextMenuEvent = true;
    this.setRange({from: coords.from});
    this.show();
    setTimeout((function() {
      if ($__10.hot) {
        $__10.hot.deselectCell();
        $__10.editor.focus();
      }
    }), 10);
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "onContextMenuRemoveComment", {
  value: function(selection) {
    this.contextMenuEvent = true;
    for (var i = selection.start.row; i <= selection.end.row; i++) {
      for (var j = selection.start.col; j <= selection.end.col; j++) {
        this.removeCommentAtCell(i, j, false);
      }
    }
    this.hot.render();
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "onContextMenuMakeReadOnly", {
  value: function(selection) {
    var $__13;
    this.contextMenuEvent = true;
    for (var i = selection.start.row; i <= selection.end.row; i++) {
      for (var j = selection.start.col; j <= selection.end.col; j++) {
        var currentState = !!this.getCommentMeta(i, j, META_READONLY);
        this.updateCommentMeta(i, j, ($__13 = {}, Object.defineProperty($__13, META_READONLY, {
          value: !currentState,
          configurable: true,
          enumerable: true,
          writable: true
        }), $__13));
      }
    }
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "addToContextMenu", {
  value: function(defaultOptions) {
    var $__10 = this;
    defaultOptions.items.push(Handsontable.plugins.ContextMenu.SEPARATOR, {
      key: 'commentsAddEdit',
      name: (function() {
        return $__10.checkSelectionCommentsConsistency() ? 'Edit comment' : 'Add comment';
      }),
      callback: (function() {
        return $__10.onContextMenuAddComment();
      }),
      disabled: function() {
        return this.getSelected() && !this.selection.selectedHeader.corner ? false : true;
      }
    }, {
      key: 'commentsRemove',
      name: function() {
        return 'Delete comment';
      },
      callback: (function(key, selection) {
        return $__10.onContextMenuRemoveComment(selection);
      }),
      disabled: (function() {
        return $__10.hot.selection.selectedHeader.corner;
      })
    }, {
      key: 'commentsReadOnly',
      name: function() {
        var $__11 = this;
        var label = 'Read only comment';
        var hasProperty = checkSelectionConsistency(this.getSelectedRange(), (function(row, col) {
          var readOnlyProperty = $__11.getCellMeta(row, col)[META_COMMENT];
          if (readOnlyProperty) {
            readOnlyProperty = readOnlyProperty[META_READONLY];
          }
          if (readOnlyProperty) {
            return true;
          }
        }));
        if (hasProperty) {
          label = markLabelAsSelected(label);
        }
        return label;
      },
      callback: (function(key, selection) {
        return $__10.onContextMenuMakeReadOnly(selection);
      }),
      disabled: (function() {
        return $__10.hot.selection.selectedHeader.corner || !$__10.checkSelectionCommentsConsistency();
      })
    });
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "onAfterBeginEditing", {
  value: function(row, column) {
    this.hide();
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, "destroy", {
  value: function() {
    if (this.editor) {
      this.editor.destroy();
    }
    $traceurRuntime.superGet(this, $Comments.prototype, "destroy").call(this);
  },
  configurable: true,
  enumerable: true,
  writable: true
}), $__13), {}, BasePlugin);
;
registerPlugin('comments', Comments);

//# 
},{"3rdparty/walkontable/src/cell/coords":6,"_base":62,"browser":24,"commentEditor":68,"contextMenu/utils":88,"eventManager":42,"helpers/dom/element":47,"helpers/function":50,"helpers/object":53,"plugins":61}],70:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  CommandExecutor: {get: function() {
      return CommandExecutor;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_helpers_47_array__;
var arrayEach = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}).arrayEach;
var CommandExecutor = function CommandExecutor(hotInstance) {
  this.hot = hotInstance;
  this.commands = {};
  this.commonCallback = null;
};
($traceurRuntime.createClass)(CommandExecutor, {
  registerCommand: function(name, commandDescriptor) {
    this.commands[name] = commandDescriptor;
  },
  setCommonCallback: function(callback) {
    this.commonCallback = callback;
  },
  execute: function(commandName) {
    for (var params = [],
        $__3 = 1; $__3 < arguments.length; $__3++)
      params[$__3 - 1] = arguments[$__3];
    var $__1 = this;
    var commandSplit = commandName.split(':');
    commandName = commandSplit[0];
    var subCommandName = commandSplit.length === 2 ? commandSplit[1] : null;
    var command = this.commands[commandName];
    if (!command) {
      throw new Error(("Menu command '" + commandName + "' not exists."));
    }
    if (subCommandName && command.submenu) {
      command = findSubCommand(subCommandName, command.submenu.items);
    }
    if (command.disabled === true) {
      return;
    }
    if (typeof command.disabled == 'function' && command.disabled.call(this.hot) === true) {
      return;
    }
    if (command.hasOwnProperty('submenu')) {
      return;
    }
    var callbacks = [];
    if (typeof command.callback === 'function') {
      callbacks.push(command.callback);
    }
    if (typeof this.commonCallback === 'function') {
      callbacks.push(this.commonCallback);
    }
    params.unshift(commandSplit.join(':'));
    arrayEach(callbacks, (function(callback) {
      return callback.apply($__1.hot, params);
    }));
  }
}, {});
function findSubCommand(subCommandName, subCommands) {
  var command;
  arrayEach(subCommands, (function(cmd) {
    var cmds = cmd.key ? cmd.key.split(':') : null;
    if (Array.isArray(cmds) && cmds[1] === subCommandName) {
      command = cmd;
      return false;
    }
  }));
  return command;
}
;

//# 
},{"helpers/array":43}],71:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  ContextMenu: {get: function() {
      return ContextMenu;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__95_base__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $__commandExecutor__,
    $___46__46__47__46__46__47_eventManager__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $__itemsFactory__,
    $__menu__,
    $___46__46__47__46__46__47_plugins__,
    $___46__46__47__46__46__47_helpers_47_dom_47_event__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $__predefinedItems__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var BasePlugin = ($___46__46__47__95_base__ = _dereq_("_base"), $___46__46__47__95_base__ && $___46__46__47__95_base__.__esModule && $___46__46__47__95_base__ || {default: $___46__46__47__95_base__}).default;
var arrayEach = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}).arrayEach;
var CommandExecutor = ($__commandExecutor__ = _dereq_("commandExecutor"), $__commandExecutor__ && $__commandExecutor__.__esModule && $__commandExecutor__ || {default: $__commandExecutor__}).CommandExecutor;
var EventManager = ($___46__46__47__46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47__46__46__47_eventManager__ && $___46__46__47__46__46__47_eventManager__.__esModule && $___46__46__47__46__46__47_eventManager__ || {default: $___46__46__47__46__46__47_eventManager__}).EventManager;
var hasClass = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}).hasClass;
var ItemsFactory = ($__itemsFactory__ = _dereq_("itemsFactory"), $__itemsFactory__ && $__itemsFactory__.__esModule && $__itemsFactory__ || {default: $__itemsFactory__}).ItemsFactory;
var Menu = ($__menu__ = _dereq_("menu"), $__menu__ && $__menu__.__esModule && $__menu__ || {default: $__menu__}).Menu;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
var $__9 = ($___46__46__47__46__46__47_helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $___46__46__47__46__46__47_helpers_47_dom_47_event__ && $___46__46__47__46__46__47_helpers_47_dom_47_event__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_event__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_event__}),
    stopPropagation = $__9.stopPropagation,
    pageX = $__9.pageX,
    pageY = $__9.pageY;
var $__10 = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}),
    getWindowScrollLeft = $__10.getWindowScrollLeft,
    getWindowScrollTop = $__10.getWindowScrollTop;
var $__11 = ($__predefinedItems__ = _dereq_("predefinedItems"), $__predefinedItems__ && $__predefinedItems__.__esModule && $__predefinedItems__ || {default: $__predefinedItems__}),
    ROW_ABOVE = $__11.ROW_ABOVE,
    ROW_BELOW = $__11.ROW_BELOW,
    COLUMN_LEFT = $__11.COLUMN_LEFT,
    COLUMN_RIGHT = $__11.COLUMN_RIGHT,
    REMOVE_ROW = $__11.REMOVE_ROW,
    REMOVE_COLUMN = $__11.REMOVE_COLUMN,
    UNDO = $__11.UNDO,
    REDO = $__11.REDO,
    READ_ONLY = $__11.READ_ONLY,
    ALIGNMENT = $__11.ALIGNMENT,
    SEPARATOR = $__11.SEPARATOR;
var ContextMenu = function ContextMenu(hotInstance) {
  $traceurRuntime.superConstructor($ContextMenu).call(this, hotInstance);
  this.eventManager = new EventManager(this);
  this.commandExecutor = new CommandExecutor(this.hot);
  this.itemsFactory = null;
  this.menu = null;
};
var $ContextMenu = ContextMenu;
($traceurRuntime.createClass)(ContextMenu, {
  isEnabled: function() {
    return this.hot.getSettings().contextMenu;
  },
  enablePlugin: function() {
    var $__12 = this;
    if (this.enabled) {
      return;
    }
    this.itemsFactory = new ItemsFactory(this.hot, $ContextMenu.DEFAULT_ITEMS);
    var settings = this.hot.getSettings().contextMenu;
    var predefinedItems = {items: this.itemsFactory.getItems(settings)};
    this.registerEvents();
    if (typeof settings.callback === 'function') {
      this.commandExecutor.setCommonCallback(settings.callback);
    }
    $traceurRuntime.superGet(this, $ContextMenu.prototype, "enablePlugin").call(this);
    this.callOnPluginsReady((function() {
      $__12.hot.runHooks('afterContextMenuDefaultOptions', predefinedItems);
      $__12.itemsFactory.setPredefinedItems(predefinedItems.items);
      var menuItems = $__12.itemsFactory.getItems(settings);
      $__12.menu = new Menu($__12.hot, {
        className: 'htContextMenu',
        keepInViewport: true
      });
      $__12.hot.runHooks('beforeContextMenuSetItems', menuItems);
      $__12.menu.setMenuItems(menuItems);
      $__12.menu.addLocalHook('afterOpen', (function() {
        return $__12.onMenuAfterOpen();
      }));
      $__12.menu.addLocalHook('afterClose', (function() {
        return $__12.onMenuAfterClose();
      }));
      $__12.menu.addLocalHook('executeCommand', (function() {
        for (var params = [],
            $__14 = 0; $__14 < arguments.length; $__14++)
          params[$__14] = arguments[$__14];
        return $__12.executeCommand.apply($__12, params);
      }));
      arrayEach(menuItems, (function(command) {
        return $__12.commandExecutor.registerCommand(command.key, command);
      }));
    }));
  },
  updatePlugin: function() {
    this.disablePlugin();
    this.enablePlugin();
    $traceurRuntime.superGet(this, $ContextMenu.prototype, "updatePlugin").call(this);
  },
  disablePlugin: function() {
    this.close();
    if (this.menu) {
      this.menu.destroy();
      this.menu = null;
    }
    $traceurRuntime.superGet(this, $ContextMenu.prototype, "disablePlugin").call(this);
  },
  registerEvents: function() {
    var $__12 = this;
    this.eventManager.addEventListener(this.hot.rootElement, 'contextmenu', (function(event) {
      return $__12.onContextMenu(event);
    }));
  },
  open: function(event) {
    if (!this.menu) {
      return;
    }
    this.menu.open();
    this.menu.setPosition({
      top: parseInt(pageY(event), 10) - getWindowScrollTop(),
      left: parseInt(pageX(event), 10) - getWindowScrollLeft()
    });
    this.menu.hotMenu.isHotTableEnv = this.hot.isHotTableEnv;
    Handsontable.eventManager.isHotTableEnv = this.hot.isHotTableEnv;
  },
  close: function() {
    if (!this.menu) {
      return;
    }
    this.menu.close();
  },
  executeCommand: function() {
    for (var params = [],
        $__14 = 0; $__14 < arguments.length; $__14++)
      params[$__14] = arguments[$__14];
    this.commandExecutor.execute.apply(this.commandExecutor, params);
  },
  onContextMenu: function(event) {
    var settings = this.hot.getSettings();
    var showRowHeaders = settings.rowHeaders;
    var showColHeaders = settings.colHeaders;
    function isValidElement(element) {
      return element.nodeName === 'TD' || element.parentNode.nodeName === 'TD';
    }
    var element = event.realTarget;
    this.close();
    if (hasClass(element, 'handsontableInput')) {
      return;
    }
    event.preventDefault();
    stopPropagation(event);
    if (!(showRowHeaders || showColHeaders)) {
      if (!isValidElement(element) && !(hasClass(element, 'current') && hasClass(element, 'wtBorder'))) {
        return;
      }
    }
    this.open(event);
  },
  onMenuAfterOpen: function() {
    this.hot.runHooks('afterContextMenuShow', this);
  },
  onMenuAfterClose: function() {
    this.hot.listen();
    this.hot.runHooks('afterContextMenuHide', this);
  },
  destroy: function() {
    this.close();
    if (this.menu) {
      this.menu.destroy();
    }
    $traceurRuntime.superGet(this, $ContextMenu.prototype, "destroy").call(this);
  }
}, {get DEFAULT_ITEMS() {
    return [ROW_ABOVE, ROW_BELOW, SEPARATOR, COLUMN_LEFT, COLUMN_RIGHT, SEPARATOR, REMOVE_ROW, REMOVE_COLUMN, SEPARATOR, UNDO, REDO, SEPARATOR, READ_ONLY, SEPARATOR, ALIGNMENT];
  }}, BasePlugin);
ContextMenu.SEPARATOR = {name: SEPARATOR};
Handsontable.hooks.register('afterContextMenuDefaultOptions');
Handsontable.hooks.register('afterContextMenuShow');
Handsontable.hooks.register('afterContextMenuHide');
Handsontable.hooks.register('afterContextMenuExecute');
;
registerPlugin('contextMenu', ContextMenu);

//# 
},{"_base":62,"browser":24,"commandExecutor":70,"eventManager":42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"itemsFactory":73,"menu":74,"plugins":61,"predefinedItems":75}],72:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  Cursor: {get: function() {
      return Cursor;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47_helpers_47_dom_47_event__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var $__1 = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}),
    getWindowScrollLeft = $__1.getWindowScrollLeft,
    getWindowScrollTop = $__1.getWindowScrollTop;
var $__2 = ($___46__46__47__46__46__47_helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $___46__46__47__46__46__47_helpers_47_dom_47_event__ && $___46__46__47__46__46__47_helpers_47_dom_47_event__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_event__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_event__}),
    pageX = $__2.pageX,
    pageY = $__2.pageY;
var Cursor = function Cursor(object) {
  var windowScrollTop = getWindowScrollTop();
  var windowScrollLeft = getWindowScrollLeft();
  var top,
      topRelative;
  var left,
      leftRelative;
  var cellHeight,
      cellWidth;
  this.type = this.getSourceType(object);
  if (this.type === 'literal') {
    top = parseInt(object.top, 10);
    left = parseInt(object.left, 10);
    cellHeight = object.height || 0;
    cellWidth = object.width || 0;
    topRelative = top;
    leftRelative = left;
    top = top + windowScrollTop;
    left = left + windowScrollLeft;
  } else if (this.type === 'event') {
    top = parseInt(pageY(object), 10);
    left = parseInt(pageX(object), 10);
    cellHeight = object.target.clientHeight;
    cellWidth = object.target.clientWidth;
    topRelative = top - windowScrollTop;
    leftRelative = left - windowScrollLeft;
  }
  this.top = top;
  this.topRelative = topRelative;
  this.left = left;
  this.leftRelative = leftRelative;
  this.scrollTop = windowScrollTop;
  this.scrollLeft = windowScrollLeft;
  this.cellHeight = cellHeight;
  this.cellWidth = cellWidth;
};
($traceurRuntime.createClass)(Cursor, {
  getSourceType: function(object) {
    var type = 'literal';
    if (object instanceof Event) {
      type = 'event';
    }
    return type;
  },
  fitsAbove: function(element) {
    return this.topRelative >= element.offsetHeight;
  },
  fitsBelow: function(element) {
    var viewportHeight = arguments[1] !== (void 0) ? arguments[1] : window.innerHeight;
    return this.topRelative + element.offsetHeight <= viewportHeight;
  },
  fitsOnRight: function(element) {
    var viewportWidth = arguments[1] !== (void 0) ? arguments[1] : window.innerWidth;
    return this.leftRelative + this.cellWidth + element.offsetWidth <= viewportWidth;
  },
  fitsOnLeft: function(element) {
    return this.leftRelative >= element.offsetWidth;
  }
}, {});
;
Handsontable.plugins.utils = Handsontable.plugins.utils || {};
Handsontable.plugins.utils.Cursor = Cursor;

//# 
},{"browser":24,"helpers/dom/element":47,"helpers/dom/event":48}],73:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  ItemsFactory: {get: function() {
      return ItemsFactory;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_helpers_47_object__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $__predefinedItems__;
var $__0 = ($___46__46__47__46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47__46__46__47_helpers_47_object__ && $___46__46__47__46__46__47_helpers_47_object__.__esModule && $___46__46__47__46__46__47_helpers_47_object__ || {default: $___46__46__47__46__46__47_helpers_47_object__}),
    objectEach = $__0.objectEach,
    isObject = $__0.isObject,
    extend = $__0.extend;
var arrayEach = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}).arrayEach;
var $__2 = ($__predefinedItems__ = _dereq_("predefinedItems"), $__predefinedItems__ && $__predefinedItems__.__esModule && $__predefinedItems__ || {default: $__predefinedItems__}),
    SEPARATOR = $__2.SEPARATOR,
    ITEMS = $__2.ITEMS,
    predefinedItems = $__2.predefinedItems;
var ItemsFactory = function ItemsFactory(hotInstance) {
  var orderPattern = arguments[1] !== (void 0) ? arguments[1] : null;
  this.hot = hotInstance;
  this.predefinedItems = predefinedItems();
  this.defaultOrderPattern = orderPattern;
};
($traceurRuntime.createClass)(ItemsFactory, {
  setPredefinedItems: function(predefinedItems) {
    var $__3 = this;
    var items = {};
    this.defaultOrderPattern.length = 0;
    objectEach(predefinedItems, (function(value, key) {
      var menuItemKey = '';
      if (value.name === SEPARATOR) {
        items[SEPARATOR] = value;
        menuItemKey = SEPARATOR;
      } else if (isNaN(parseInt(key, 10))) {
        value.key = value.key === void 0 ? key : value.key;
        items[key] = value;
        menuItemKey = value.key;
      } else {
        items[value.key] = value;
        menuItemKey = value.key;
      }
      $__3.defaultOrderPattern.push(menuItemKey);
    }));
    this.predefinedItems = items;
  },
  getItems: function() {
    var pattern = arguments[0] !== (void 0) ? arguments[0] : null;
    return getItems(pattern, this.defaultOrderPattern, this.predefinedItems);
  }
}, {});
function getItems() {
  var pattern = arguments[0] !== (void 0) ? arguments[0] : null;
  var defaultPattern = arguments[1] !== (void 0) ? arguments[1] : [];
  var items = arguments[2] !== (void 0) ? arguments[2] : {};
  var result = [];
  if (pattern && pattern.items) {
    pattern = pattern.items;
  } else if (!Array.isArray(pattern)) {
    pattern = defaultPattern;
  }
  if (isObject(pattern)) {
    objectEach(pattern, (function(value, key) {
      var item = items[typeof value === 'string' ? value : key];
      if (!item) {
        item = value;
      }
      if (isObject(value)) {
        extend(item, value);
      } else if (typeof item === 'string') {
        item = {name: item};
      }
      if (item.key === void 0) {
        item.key = key;
      }
      result.push(item);
    }));
  } else {
    arrayEach(pattern, (function(name, key) {
      var item = items[name];
      if (!item && ITEMS.indexOf(name) >= 0) {
        return;
      }
      if (!item) {
        item = {
          name: name,
          key: key + ''
        };
      }
      if (isObject(name)) {
        extend(item, name);
      }
      if (item.key === void 0) {
        item.key = key;
      }
      result.push(item);
    }));
  }
  return result;
}
;

//# 
},{"helpers/array":43,"helpers/object":53,"predefinedItems":75}],74:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  Menu: {get: function() {
      return Menu;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $__cursor__,
    $___46__46__47__46__46__47_eventManager__,
    $___46__46__47__46__46__47_helpers_47_object__,
    $___46__46__47__46__46__47_helpers_47_function__,
    $__utils__,
    $___46__46__47__46__46__47_helpers_47_unicode__,
    $___46__46__47__46__46__47_mixins_47_localHooks__,
    $__predefinedItems__,
    $___46__46__47__46__46__47_helpers_47_dom_47_event__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var $__1 = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}),
    addClass = $__1.addClass,
    empty = $__1.empty,
    fastInnerHTML = $__1.fastInnerHTML,
    getScrollbarWidth = $__1.getScrollbarWidth,
    isChildOf = $__1.isChildOf,
    removeClass = $__1.removeClass;
var $__2 = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}),
    arrayEach = $__2.arrayEach,
    arrayFilter = $__2.arrayFilter,
    arrayReduce = $__2.arrayReduce;
var Cursor = ($__cursor__ = _dereq_("cursor"), $__cursor__ && $__cursor__.__esModule && $__cursor__ || {default: $__cursor__}).Cursor;
var EventManager = ($___46__46__47__46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47__46__46__47_eventManager__ && $___46__46__47__46__46__47_eventManager__.__esModule && $___46__46__47__46__46__47_eventManager__ || {default: $___46__46__47__46__46__47_eventManager__}).EventManager;
var mixin = ($___46__46__47__46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47__46__46__47_helpers_47_object__ && $___46__46__47__46__46__47_helpers_47_object__.__esModule && $___46__46__47__46__46__47_helpers_47_object__ || {default: $___46__46__47__46__46__47_helpers_47_object__}).mixin;
var debounce = ($___46__46__47__46__46__47_helpers_47_function__ = _dereq_("helpers/function"), $___46__46__47__46__46__47_helpers_47_function__ && $___46__46__47__46__46__47_helpers_47_function__.__esModule && $___46__46__47__46__46__47_helpers_47_function__ || {default: $___46__46__47__46__46__47_helpers_47_function__}).debounce;
var $__7 = ($__utils__ = _dereq_("utils"), $__utils__ && $__utils__.__esModule && $__utils__ || {default: $__utils__}),
    filterSeparators = $__7.filterSeparators,
    hasSubMenu = $__7.hasSubMenu,
    isDisabled = $__7.isDisabled,
    isItemHidden = $__7.isItemHidden,
    isSeparator = $__7.isSeparator,
    isSelectionDisabled = $__7.isSelectionDisabled,
    normalizeSelection = $__7.normalizeSelection;
var KEY_CODES = ($___46__46__47__46__46__47_helpers_47_unicode__ = _dereq_("helpers/unicode"), $___46__46__47__46__46__47_helpers_47_unicode__ && $___46__46__47__46__46__47_helpers_47_unicode__.__esModule && $___46__46__47__46__46__47_helpers_47_unicode__ || {default: $___46__46__47__46__46__47_helpers_47_unicode__}).KEY_CODES;
var localHooks = ($___46__46__47__46__46__47_mixins_47_localHooks__ = _dereq_("mixins/localHooks"), $___46__46__47__46__46__47_mixins_47_localHooks__ && $___46__46__47__46__46__47_mixins_47_localHooks__.__esModule && $___46__46__47__46__46__47_mixins_47_localHooks__ || {default: $___46__46__47__46__46__47_mixins_47_localHooks__}).localHooks;
var SEPARATOR = ($__predefinedItems__ = _dereq_("predefinedItems"), $__predefinedItems__ && $__predefinedItems__.__esModule && $__predefinedItems__ || {default: $__predefinedItems__}).SEPARATOR;
var stopImmediatePropagation = ($___46__46__47__46__46__47_helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $___46__46__47__46__46__47_helpers_47_dom_47_event__ && $___46__46__47__46__46__47_helpers_47_dom_47_event__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_event__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_event__}).stopImmediatePropagation;
var Menu = function Menu(hotInstance, options) {
  this.hot = hotInstance;
  this.options = options || {
    parent: null,
    name: null,
    className: '',
    keepInViewport: true,
    standalone: false
  };
  this.eventManager = new EventManager(this);
  this.container = this.createContainer(this.options.name);
  this.hotMenu = null;
  this.hotSubMenus = {};
  this.parentMenu = this.options.parent || null;
  this.menuItems = null;
  this.origOutsideClickDeselects = null;
  this.keyEvent = false;
  this.offset = {
    above: 0,
    below: 0,
    left: 0,
    right: 0
  };
  this._afterScrollCallback = null;
  this.registerEvents();
};
var $Menu = Menu;
($traceurRuntime.createClass)(Menu, {
  registerEvents: function() {
    var $__12 = this;
    this.eventManager.addEventListener(document.documentElement, 'mousedown', (function(event) {
      return $__12.onDocumentMouseDown(event);
    }));
  },
  setMenuItems: function(menuItems) {
    this.menuItems = menuItems;
  },
  setOffset: function(area) {
    var offset = arguments[1] !== (void 0) ? arguments[1] : 0;
    this.offset[area] = offset;
  },
  isSubMenu: function() {
    return this.parentMenu !== null;
  },
  open: function() {
    var $__12 = this;
    this.container.removeAttribute('style');
    this.container.style.display = 'block';
    var delayedOpenSubMenu = debounce((function(row) {
      return $__12.openSubMenu(row);
    }), 300);
    var filteredItems = arrayFilter(this.menuItems, (function(item) {
      return isItemHidden(item, $__12.hot);
    }));
    filteredItems = filterSeparators(filteredItems, SEPARATOR);
    var settings = {
      data: filteredItems,
      colHeaders: false,
      colWidths: [200],
      autoRowSize: false,
      readOnly: true,
      copyPaste: false,
      columns: [{
        data: 'name',
        renderer: (function(hot, TD, row, col, prop, value) {
          return $__12.menuItemRenderer(hot, TD, row, col, prop, value);
        })
      }],
      renderAllRows: true,
      fragmentSelection: 'cell',
      disableVisualSelection: 'area',
      beforeKeyDown: (function(event) {
        return $__12.onBeforeKeyDown(event);
      }),
      afterOnCellMouseOver: (function(event, coords, TD) {
        if ($__12.isAllSubMenusClosed()) {
          delayedOpenSubMenu(coords.row);
        } else {
          $__12.openSubMenu(coords.row);
        }
      }),
      rowHeights: (function(row) {
        return filteredItems[row].name === SEPARATOR ? 1 : 23;
      })
    };
    this.origOutsideClickDeselects = this.hot.getSettings().outsideClickDeselects;
    this.hot.getSettings().outsideClickDeselects = false;
    this.hotMenu = new Handsontable.Core(this.container, settings);
    this.hotMenu.addHook('afterInit', (function() {
      return $__12.onAfterInit();
    }));
    this.hotMenu.addHook('afterSelection', (function(r, c, r2, c2, preventScrolling) {
      return $__12.onAfterSelection(r, c, r2, c2, preventScrolling);
    }));
    this.hotMenu.init();
    this.hotMenu.listen();
    this.blockMainTableCallbacks();
    this.runLocalHooks('afterOpen');
  },
  close: function() {
    var closeParent = arguments[0] !== (void 0) ? arguments[0] : false;
    if (!this.isOpened()) {
      return;
    }
    if (closeParent && this.parentMenu) {
      this.parentMenu.close();
    } else {
      this.closeAllSubMenus();
      this.container.style.display = 'none';
      this.releaseMainTableCallbacks();
      this.hotMenu.destroy();
      this.hotMenu = null;
      this.hot.getSettings().outsideClickDeselects = this.origOutsideClickDeselects;
      this.runLocalHooks('afterClose');
      if (this.parentMenu) {
        this.parentMenu.hotMenu.listen();
      }
    }
  },
  openSubMenu: function(row) {
    if (!this.hotMenu) {
      return false;
    }
    var cell = this.hotMenu.getCell(row, 0);
    this.closeAllSubMenus();
    if (!cell || !hasSubMenu(cell)) {
      return false;
    }
    var dataItem = this.hotMenu.getSourceDataAtRow(row);
    var subMenu = new $Menu(this.hot, {
      parent: this,
      name: dataItem.name,
      className: this.options.className,
      keepInViewport: true
    });
    subMenu.setMenuItems(dataItem.submenu.items);
    subMenu.open();
    subMenu.setPosition(cell.getBoundingClientRect());
    this.hotSubMenus[dataItem.key] = subMenu;
    return subMenu;
  },
  closeSubMenu: function(row) {
    var dataItem = this.hotMenu.getSourceDataAtRow(row);
    var menus = this.hotSubMenus[dataItem.key];
    if (menus) {
      menus.destroy();
      delete this.hotSubMenus[dataItem.key];
    }
  },
  closeAllSubMenus: function() {
    var $__12 = this;
    arrayEach(this.hotMenu.getData(), (function(value, row) {
      return $__12.closeSubMenu(row);
    }));
  },
  isAllSubMenusClosed: function() {
    return Object.keys(this.hotSubMenus).length === 0;
  },
  destroy: function() {
    this.clearLocalHooks();
    this.close();
    this.parentMenu = null;
    this.eventManager.destroy();
  },
  isOpened: function() {
    return this.hotMenu !== null;
  },
  executeCommand: function(event) {
    if (!this.isOpened() || !this.hotMenu.getSelected()) {
      return;
    }
    var selectedItem = this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelected()[0]);
    this.runLocalHooks('select', selectedItem, event);
    if (selectedItem.isCommand === false || selectedItem.name === SEPARATOR) {
      return;
    }
    var selRange = this.hot.getSelectedRange();
    var normalizedSelection = selRange ? normalizeSelection(selRange) : {};
    var autoClose = true;
    if (selectedItem.disabled === true || (typeof selectedItem.disabled === 'function' && selectedItem.disabled.call(this.hot) === true) || selectedItem.submenu) {
      autoClose = false;
    }
    this.runLocalHooks('executeCommand', selectedItem.key, normalizedSelection, event);
    if (this.isSubMenu()) {
      this.parentMenu.runLocalHooks('executeCommand', selectedItem.key, normalizedSelection, event);
    }
    if (autoClose) {
      this.close(true);
    }
  },
  setPosition: function(coords) {
    var cursor = new Cursor(coords);
    if (this.options.keepInViewport) {
      if (cursor.fitsBelow(this.container)) {
        this.setPositionBelowCursor(cursor);
      } else if (cursor.fitsAbove(this.container)) {
        this.setPositionAboveCursor(cursor);
      } else {
        this.setPositionBelowCursor(cursor);
      }
      if (cursor.fitsOnRight(this.container)) {
        this.setPositionOnRightOfCursor(cursor);
      } else {
        this.setPositionOnLeftOfCursor(cursor);
      }
    } else {
      this.setPositionBelowCursor(cursor);
      this.setPositionOnRightOfCursor(cursor);
    }
  },
  setPositionAboveCursor: function(cursor) {
    var top = this.offset.above + cursor.top - this.container.offsetHeight;
    if (this.isSubMenu()) {
      top = cursor.top + cursor.cellHeight - this.container.offsetHeight + 3;
    }
    this.container.style.top = top + 'px';
  },
  setPositionBelowCursor: function(cursor) {
    var top = this.offset.below + cursor.top;
    if (this.isSubMenu()) {
      top = cursor.top - 1;
    }
    this.container.style.top = top + 'px';
  },
  setPositionOnRightOfCursor: function(cursor) {
    var left;
    if (this.isSubMenu()) {
      left = 1 + cursor.left + cursor.cellWidth;
    } else {
      left = this.offset.right + 1 + cursor.left;
    }
    this.container.style.left = left + 'px';
  },
  setPositionOnLeftOfCursor: function(cursor) {
    var left = this.offset.left + cursor.left - this.container.offsetWidth + getScrollbarWidth() + 4;
    this.container.style.left = left + 'px';
  },
  selectFirstCell: function() {
    var cell = this.hotMenu.getCell(0, 0);
    if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {
      this.selectNextCell(0, 0);
    } else {
      this.hotMenu.selectCell(0, 0);
    }
  },
  selectLastCell: function() {
    var lastRow = this.hotMenu.countRows() - 1;
    var cell = this.hotMenu.getCell(lastRow, 0);
    if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {
      this.selectPrevCell(lastRow, 0);
    } else {
      this.hotMenu.selectCell(lastRow, 0);
    }
  },
  selectNextCell: function(row, col) {
    var nextRow = row + 1;
    var cell = nextRow < this.hotMenu.countRows() ? this.hotMenu.getCell(nextRow, col) : null;
    if (!cell) {
      return;
    }
    if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {
      this.selectNextCell(nextRow, col);
    } else {
      this.hotMenu.selectCell(nextRow, col);
    }
  },
  selectPrevCell: function(row, col) {
    var prevRow = row - 1;
    var cell = prevRow >= 0 ? this.hotMenu.getCell(prevRow, col) : null;
    if (!cell) {
      return;
    }
    if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {
      this.selectPrevCell(prevRow, col);
    } else {
      this.hotMenu.selectCell(prevRow, col);
    }
  },
  menuItemRenderer: function(hot, TD, row, col, prop, value) {
    var $__12 = this;
    var item = hot.getSourceDataAtRow(row);
    var wrapper = document.createElement('div');
    var isSubMenu = (function(item) {
      return item.hasOwnProperty('submenu');
    });
    var itemIsSeparator = (function(item) {
      return new RegExp(SEPARATOR, 'i').test(item.name);
    });
    var itemIsDisabled = (function(item) {
      return item.disabled === true || (typeof item.disabled == 'function' && item.disabled.call($__12.hot) === true);
    });
    var itemIsSelectionDisabled = (function(item) {
      return item.disableSelection;
    });
    if (typeof value === 'function') {
      value = value.call(this.hot);
    }
    empty(TD);
    addClass(wrapper, 'htItemWrapper');
    TD.appendChild(wrapper);
    if (itemIsSeparator(item)) {
      addClass(TD, 'htSeparator');
    } else if (typeof item.renderer === 'function') {
      addClass(TD, 'htCustomMenuRenderer');
      TD.appendChild(item.renderer(hot, wrapper, row, col, prop, value));
    } else {
      fastInnerHTML(wrapper, value);
    }
    if (itemIsDisabled(item)) {
      addClass(TD, 'htDisabled');
      this.eventManager.addEventListener(TD, 'mouseenter', (function() {
        return hot.deselectCell();
      }));
    } else if (itemIsSelectionDisabled(item)) {
      addClass(TD, 'htSelectionDisabled');
      this.eventManager.addEventListener(TD, 'mouseenter', (function() {
        return hot.deselectCell();
      }));
    } else if (isSubMenu(item)) {
      addClass(TD, 'htSubmenu');
      if (itemIsSelectionDisabled(item)) {
        this.eventManager.addEventListener(TD, 'mouseenter', (function() {
          return hot.deselectCell();
        }));
      } else {
        this.eventManager.addEventListener(TD, 'mouseenter', (function() {
          return hot.selectCell(row, col, void 0, void 0, false, false);
        }));
      }
    } else {
      removeClass(TD, 'htSubmenu');
      removeClass(TD, 'htDisabled');
      if (itemIsSelectionDisabled(item)) {
        this.eventManager.addEventListener(TD, 'mouseenter', (function() {
          return hot.deselectCell();
        }));
      } else {
        this.eventManager.addEventListener(TD, 'mouseenter', (function() {
          return hot.selectCell(row, col, void 0, void 0, false, false);
        }));
      }
    }
  },
  createContainer: function() {
    var name = arguments[0] !== (void 0) ? arguments[0] : null;
    if (name) {
      name = name.replace(/[^A-z0-9]/g, '_');
      name = this.options.className + 'Sub_' + name;
    }
    var container;
    if (name) {
      container = document.querySelector('.' + this.options.className + '.' + name);
    } else {
      container = document.querySelector('.' + this.options.className);
    }
    if (!container) {
      container = document.createElement('div');
      addClass(container, 'htMenu ' + this.options.className);
      if (name) {
        addClass(container, name);
      }
      document.getElementsByTagName('body')[0].appendChild(container);
    }
    return container;
  },
  blockMainTableCallbacks: function() {
    this._afterScrollCallback = function() {};
    this.hot.addHook('afterScrollVertically', this._afterScrollCallback);
    this.hot.addHook('afterScrollHorizontally', this._afterScrollCallback);
  },
  releaseMainTableCallbacks: function() {
    if (this._afterScrollCallback) {
      this.hot.removeHook('afterScrollVertically', this._afterScrollCallback);
      this.hot.removeHook('afterScrollHorizontally', this._afterScrollCallback);
      this._afterScrollCallback = null;
    }
  },
  onBeforeKeyDown: function(event) {
    var selection = this.hotMenu.getSelected();
    var stopEvent = false;
    this.keyEvent = true;
    switch (event.keyCode) {
      case KEY_CODES.ESCAPE:
        this.close();
        stopEvent = true;
        break;
      case KEY_CODES.ENTER:
        if (selection) {
          if (this.hotMenu.getSourceDataAtRow(selection[0]).submenu) {
            stopEvent = true;
          } else {
            this.executeCommand(event);
            this.close(true);
          }
        }
        break;
      case KEY_CODES.ARROW_DOWN:
        if (selection) {
          this.selectNextCell(selection[0], selection[1]);
        } else {
          this.selectFirstCell();
        }
        stopEvent = true;
        break;
      case KEY_CODES.ARROW_UP:
        if (selection) {
          this.selectPrevCell(selection[0], selection[1]);
        } else {
          this.selectLastCell();
        }
        stopEvent = true;
        break;
      case KEY_CODES.ARROW_RIGHT:
        if (selection) {
          var menu = this.openSubMenu(selection[0]);
          if (menu) {
            menu.selectFirstCell();
          }
        }
        stopEvent = true;
        break;
      case KEY_CODES.ARROW_LEFT:
        if (selection && this.isSubMenu()) {
          this.close();
          if (this.parentMenu) {
            this.parentMenu.hotMenu.listen();
          }
          stopEvent = true;
        }
        break;
    }
    if (stopEvent) {
      event.preventDefault();
      stopImmediatePropagation(event);
    }
    this.keyEvent = false;
  },
  onAfterInit: function() {
    var data = this.hotMenu.getSettings().data;
    var hiderStyle = this.hotMenu.view.wt.wtTable.hider.style;
    var holderStyle = this.hotMenu.view.wt.wtTable.holder.style;
    var currentHiderWidth = parseInt(hiderStyle.width, 10);
    var realHeight = arrayReduce(data, (function(accumulator, value) {
      return accumulator + (value.name === SEPARATOR ? 1 : 26);
    }), 0);
    holderStyle.width = currentHiderWidth + 22 + 'px';
    holderStyle.height = realHeight + 4 + 'px';
    hiderStyle.height = holderStyle.height;
  },
  onAfterSelection: function(r, c, r2, c2, preventScrolling) {
    if (this.keyEvent === false) {
      preventScrolling.value = true;
    }
  },
  onDocumentMouseDown: function(event) {
    if (!this.isOpened()) {
      return;
    }
    if (this.container && isChildOf(event.target, this.container)) {
      this.executeCommand(event);
    }
    if (this.options.standalone && this.hotMenu && !isChildOf(event.target, this.hotMenu.rootElement)) {
      this.close(true);
    } else if ((this.isAllSubMenusClosed() || this.isSubMenu()) && (!isChildOf(event.target, '.htMenu') && isChildOf(event.target, document))) {
      this.close(true);
    }
  }
}, {});
mixin(Menu, localHooks);
;

//# 
},{"browser":24,"cursor":72,"eventManager":42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/function":50,"helpers/object":53,"helpers/unicode":56,"mixins/localHooks":58,"predefinedItems":75,"utils":88}],75:[function(_dereq_,module,exports){
"use strict";
var $__13;
Object.defineProperties(exports, {
  ALIGNMENT: {get: function() {
      return $__predefinedItems_47_alignment__.KEY;
    }},
  CLEAR_COLUMN: {get: function() {
      return $__predefinedItems_47_clearColumn__.KEY;
    }},
  COLUMN_LEFT: {get: function() {
      return $__predefinedItems_47_columnLeft__.KEY;
    }},
  COLUMN_RIGHT: {get: function() {
      return $__predefinedItems_47_columnRight__.KEY;
    }},
  READ_ONLY: {get: function() {
      return $__predefinedItems_47_readOnly__.KEY;
    }},
  REDO: {get: function() {
      return $__predefinedItems_47_redo__.KEY;
    }},
  REMOVE_COLUMN: {get: function() {
      return $__predefinedItems_47_removeColumn__.KEY;
    }},
  REMOVE_ROW: {get: function() {
      return $__predefinedItems_47_removeRow__.KEY;
    }},
  ROW_ABOVE: {get: function() {
      return $__predefinedItems_47_rowAbove__.KEY;
    }},
  ROW_BELOW: {get: function() {
      return $__predefinedItems_47_rowBelow__.KEY;
    }},
  SEPARATOR: {get: function() {
      return $__predefinedItems_47_separator__.KEY;
    }},
  UNDO: {get: function() {
      return $__predefinedItems_47_undo__.KEY;
    }},
  ITEMS: {get: function() {
      return ITEMS;
    }},
  predefinedItems: {get: function() {
      return predefinedItems;
    }},
  addItem: {get: function() {
      return addItem;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_helpers_47_object__,
    $__predefinedItems_47_alignment__,
    $__predefinedItems_47_clearColumn__,
    $__predefinedItems_47_columnLeft__,
    $__predefinedItems_47_columnRight__,
    $__predefinedItems_47_readOnly__,
    $__predefinedItems_47_redo__,
    $__predefinedItems_47_removeColumn__,
    $__predefinedItems_47_removeRow__,
    $__predefinedItems_47_rowAbove__,
    $__predefinedItems_47_rowBelow__,
    $__predefinedItems_47_separator__,
    $__predefinedItems_47_undo__,
    $__predefinedItems_47_alignment__,
    $__predefinedItems_47_clearColumn__,
    $__predefinedItems_47_columnLeft__,
    $__predefinedItems_47_columnRight__,
    $__predefinedItems_47_readOnly__,
    $__predefinedItems_47_redo__,
    $__predefinedItems_47_removeColumn__,
    $__predefinedItems_47_removeRow__,
    $__predefinedItems_47_rowAbove__,
    $__predefinedItems_47_rowBelow__,
    $__predefinedItems_47_separator__,
    $__predefinedItems_47_undo__;
var objectEach = ($___46__46__47__46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47__46__46__47_helpers_47_object__ && $___46__46__47__46__46__47_helpers_47_object__.__esModule && $___46__46__47__46__46__47_helpers_47_object__ || {default: $___46__46__47__46__46__47_helpers_47_object__}).objectEach;
var $__1 = ($__predefinedItems_47_alignment__ = _dereq_("predefinedItems/alignment"), $__predefinedItems_47_alignment__ && $__predefinedItems_47_alignment__.__esModule && $__predefinedItems_47_alignment__ || {default: $__predefinedItems_47_alignment__}),
    alignmentItem = $__1.alignmentItem,
    ALIGNMENT = $__1.KEY;
var $__2 = ($__predefinedItems_47_clearColumn__ = _dereq_("predefinedItems/clearColumn"), $__predefinedItems_47_clearColumn__ && $__predefinedItems_47_clearColumn__.__esModule && $__predefinedItems_47_clearColumn__ || {default: $__predefinedItems_47_clearColumn__}),
    clearColumnItem = $__2.clearColumnItem,
    CLEAR_COLUMN = $__2.KEY;
var $__3 = ($__predefinedItems_47_columnLeft__ = _dereq_("predefinedItems/columnLeft"), $__predefinedItems_47_columnLeft__ && $__predefinedItems_47_columnLeft__.__esModule && $__predefinedItems_47_columnLeft__ || {default: $__predefinedItems_47_columnLeft__}),
    columnLeftItem = $__3.columnLeftItem,
    COLUMN_LEFT = $__3.KEY;
var $__4 = ($__predefinedItems_47_columnRight__ = _dereq_("predefinedItems/columnRight"), $__predefinedItems_47_columnRight__ && $__predefinedItems_47_columnRight__.__esModule && $__predefinedItems_47_columnRight__ || {default: $__predefinedItems_47_columnRight__}),
    columnRightItem = $__4.columnRightItem,
    COLUMN_RIGHT = $__4.KEY;
var $__5 = ($__predefinedItems_47_readOnly__ = _dereq_("predefinedItems/readOnly"), $__predefinedItems_47_readOnly__ && $__predefinedItems_47_readOnly__.__esModule && $__predefinedItems_47_readOnly__ || {default: $__predefinedItems_47_readOnly__}),
    readOnlyItem = $__5.readOnlyItem,
    READ_ONLY = $__5.KEY;
var $__6 = ($__predefinedItems_47_redo__ = _dereq_("predefinedItems/redo"), $__predefinedItems_47_redo__ && $__predefinedItems_47_redo__.__esModule && $__predefinedItems_47_redo__ || {default: $__predefinedItems_47_redo__}),
    redoItem = $__6.redoItem,
    REDO = $__6.KEY;
var $__7 = ($__predefinedItems_47_removeColumn__ = _dereq_("predefinedItems/removeColumn"), $__predefinedItems_47_removeColumn__ && $__predefinedItems_47_removeColumn__.__esModule && $__predefinedItems_47_removeColumn__ || {default: $__predefinedItems_47_removeColumn__}),
    removeColumnItem = $__7.removeColumnItem,
    REMOVE_COLUMN = $__7.KEY;
var $__8 = ($__predefinedItems_47_removeRow__ = _dereq_("predefinedItems/removeRow"), $__predefinedItems_47_removeRow__ && $__predefinedItems_47_removeRow__.__esModule && $__predefinedItems_47_removeRow__ || {default: $__predefinedItems_47_removeRow__}),
    removeRowItem = $__8.removeRowItem,
    REMOVE_ROW = $__8.KEY;
var $__9 = ($__predefinedItems_47_rowAbove__ = _dereq_("predefinedItems/rowAbove"), $__predefinedItems_47_rowAbove__ && $__predefinedItems_47_rowAbove__.__esModule && $__predefinedItems_47_rowAbove__ || {default: $__predefinedItems_47_rowAbove__}),
    rowAboveItem = $__9.rowAboveItem,
    ROW_ABOVE = $__9.KEY;
var $__10 = ($__predefinedItems_47_rowBelow__ = _dereq_("predefinedItems/rowBelow"), $__predefinedItems_47_rowBelow__ && $__predefinedItems_47_rowBelow__.__esModule && $__predefinedItems_47_rowBelow__ || {default: $__predefinedItems_47_rowBelow__}),
    rowBelowItem = $__10.rowBelowItem,
    ROW_BELOW = $__10.KEY;
var $__11 = ($__predefinedItems_47_separator__ = _dereq_("predefinedItems/separator"), $__predefinedItems_47_separator__ && $__predefinedItems_47_separator__.__esModule && $__predefinedItems_47_separator__ || {default: $__predefinedItems_47_separator__}),
    separatorItem = $__11.separatorItem,
    SEPARATOR = $__11.KEY;
var $__12 = ($__predefinedItems_47_undo__ = _dereq_("predefinedItems/undo"), $__predefinedItems_47_undo__ && $__predefinedItems_47_undo__.__esModule && $__predefinedItems_47_undo__ || {default: $__predefinedItems_47_undo__}),
    undoItem = $__12.undoItem,
    UNDO = $__12.KEY;
var $__predefinedItems_47_alignment__ = ($__predefinedItems_47_alignment__ = _dereq_("predefinedItems/alignment"), $__predefinedItems_47_alignment__ && $__predefinedItems_47_alignment__.__esModule && $__predefinedItems_47_alignment__ || {default: $__predefinedItems_47_alignment__});
var $__predefinedItems_47_clearColumn__ = ($__predefinedItems_47_clearColumn__ = _dereq_("predefinedItems/clearColumn"), $__predefinedItems_47_clearColumn__ && $__predefinedItems_47_clearColumn__.__esModule && $__predefinedItems_47_clearColumn__ || {default: $__predefinedItems_47_clearColumn__});
var $__predefinedItems_47_columnLeft__ = ($__predefinedItems_47_columnLeft__ = _dereq_("predefinedItems/columnLeft"), $__predefinedItems_47_columnLeft__ && $__predefinedItems_47_columnLeft__.__esModule && $__predefinedItems_47_columnLeft__ || {default: $__predefinedItems_47_columnLeft__});
var $__predefinedItems_47_columnRight__ = ($__predefinedItems_47_columnRight__ = _dereq_("predefinedItems/columnRight"), $__predefinedItems_47_columnRight__ && $__predefinedItems_47_columnRight__.__esModule && $__predefinedItems_47_columnRight__ || {default: $__predefinedItems_47_columnRight__});
var $__predefinedItems_47_readOnly__ = ($__predefinedItems_47_readOnly__ = _dereq_("predefinedItems/readOnly"), $__predefinedItems_47_readOnly__ && $__predefinedItems_47_readOnly__.__esModule && $__predefinedItems_47_readOnly__ || {default: $__predefinedItems_47_readOnly__});
var $__predefinedItems_47_redo__ = ($__predefinedItems_47_redo__ = _dereq_("predefinedItems/redo"), $__predefinedItems_47_redo__ && $__predefinedItems_47_redo__.__esModule && $__predefinedItems_47_redo__ || {default: $__predefinedItems_47_redo__});
var $__predefinedItems_47_removeColumn__ = ($__predefinedItems_47_removeColumn__ = _dereq_("predefinedItems/removeColumn"), $__predefinedItems_47_removeColumn__ && $__predefinedItems_47_removeColumn__.__esModule && $__predefinedItems_47_removeColumn__ || {default: $__predefinedItems_47_removeColumn__});
var $__predefinedItems_47_removeRow__ = ($__predefinedItems_47_removeRow__ = _dereq_("predefinedItems/removeRow"), $__predefinedItems_47_removeRow__ && $__predefinedItems_47_removeRow__.__esModule && $__predefinedItems_47_removeRow__ || {default: $__predefinedItems_47_removeRow__});
var $__predefinedItems_47_rowAbove__ = ($__predefinedItems_47_rowAbove__ = _dereq_("predefinedItems/rowAbove"), $__predefinedItems_47_rowAbove__ && $__predefinedItems_47_rowAbove__.__esModule && $__predefinedItems_47_rowAbove__ || {default: $__predefinedItems_47_rowAbove__});
var $__predefinedItems_47_rowBelow__ = ($__predefinedItems_47_rowBelow__ = _dereq_("predefinedItems/rowBelow"), $__predefinedItems_47_rowBelow__ && $__predefinedItems_47_rowBelow__.__esModule && $__predefinedItems_47_rowBelow__ || {default: $__predefinedItems_47_rowBelow__});
var $__predefinedItems_47_separator__ = ($__predefinedItems_47_separator__ = _dereq_("predefinedItems/separator"), $__predefinedItems_47_separator__ && $__predefinedItems_47_separator__.__esModule && $__predefinedItems_47_separator__ || {default: $__predefinedItems_47_separator__});
var $__predefinedItems_47_undo__ = ($__predefinedItems_47_undo__ = _dereq_("predefinedItems/undo"), $__predefinedItems_47_undo__ && $__predefinedItems_47_undo__.__esModule && $__predefinedItems_47_undo__ || {default: $__predefinedItems_47_undo__});
var ITEMS = [ROW_ABOVE, ROW_BELOW, COLUMN_LEFT, COLUMN_RIGHT, CLEAR_COLUMN, REMOVE_ROW, REMOVE_COLUMN, UNDO, REDO, READ_ONLY, ALIGNMENT, SEPARATOR];
var _predefinedItems = ($__13 = {}, Object.defineProperty($__13, SEPARATOR, {
  value: separatorItem,
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, ROW_ABOVE, {
  value: rowAboveItem,
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, ROW_BELOW, {
  value: rowBelowItem,
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, COLUMN_LEFT, {
  value: columnLeftItem,
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, COLUMN_RIGHT, {
  value: columnRightItem,
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, CLEAR_COLUMN, {
  value: clearColumnItem,
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, REMOVE_ROW, {
  value: removeRowItem,
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, REMOVE_COLUMN, {
  value: removeColumnItem,
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, UNDO, {
  value: undoItem,
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, REDO, {
  value: redoItem,
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, READ_ONLY, {
  value: readOnlyItem,
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__13, ALIGNMENT, {
  value: alignmentItem,
  configurable: true,
  enumerable: true,
  writable: true
}), $__13);
function predefinedItems() {
  var items = {};
  objectEach(_predefinedItems, (function(itemFactory, key) {
    return items[key] = itemFactory();
  }));
  return items;
}
function addItem(key, item) {
  if (ITEMS.indexOf(key) === -1) {
    _predefinedItems[key] = item;
  }
}

//# 
},{"helpers/object":53,"predefinedItems/alignment":76,"predefinedItems/clearColumn":77,"predefinedItems/columnLeft":78,"predefinedItems/columnRight":79,"predefinedItems/readOnly":80,"predefinedItems/redo":81,"predefinedItems/removeColumn":82,"predefinedItems/removeRow":83,"predefinedItems/rowAbove":84,"predefinedItems/rowBelow":85,"predefinedItems/separator":86,"predefinedItems/undo":87}],76:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  KEY: {get: function() {
      return KEY;
    }},
  alignmentItem: {get: function() {
      return alignmentItem;
    }},
  __esModule: {value: true}
});
var $___46__46__47_utils__,
    $__separator__;
var $__0 = ($___46__46__47_utils__ = _dereq_("utils"), $___46__46__47_utils__ && $___46__46__47_utils__.__esModule && $___46__46__47_utils__ || {default: $___46__46__47_utils__}),
    align = $__0.align,
    getAlignmentClasses = $__0.getAlignmentClasses,
    checkSelectionConsistency = $__0.checkSelectionConsistency,
    markLabelAsSelected = $__0.markLabelAsSelected;
var SEPARATOR = ($__separator__ = _dereq_("separator"), $__separator__ && $__separator__.__esModule && $__separator__ || {default: $__separator__}).KEY;
var KEY = 'alignment';
function alignmentItem() {
  return {
    key: KEY,
    name: 'Alignment',
    disabled: function() {
      return this.getSelectedRange() && !this.selection.selectedHeader.corner ? false : true;
    },
    submenu: {items: [{
        key: (KEY + ":left"),
        name: function() {
          var $__2 = this;
          var label = 'Left';
          var hasClass = checkSelectionConsistency(this.getSelectedRange(), (function(row, col) {
            var className = $__2.getCellMeta(row, col).className;
            if (className && className.indexOf('htLeft') !== -1) {
              return true;
            }
          }));
          if (hasClass) {
            label = markLabelAsSelected(label);
          }
          return label;
        },
        callback: function() {
          var $__2 = this;
          var range = this.getSelectedRange();
          var stateBefore = getAlignmentClasses(range, (function(row, col) {
            return $__2.getCellMeta(row, col).className;
          }));
          var type = 'horizontal';
          var alignment = 'htLeft';
          this.runHooks('beforeCellAlignment', stateBefore, range, type, alignment);
          align(range, type, alignment, (function(row, col) {
            return $__2.getCellMeta(row, col);
          }), (function(row, col, key, value) {
            return $__2.setCellMeta(row, col, key, value);
          }));
          this.render();
        },
        disabled: false
      }, {
        key: (KEY + ":center"),
        name: function() {
          var $__2 = this;
          var label = 'Center';
          var hasClass = checkSelectionConsistency(this.getSelectedRange(), (function(row, col) {
            var className = $__2.getCellMeta(row, col).className;
            if (className && className.indexOf('htCenter') !== -1) {
              return true;
            }
          }));
          if (hasClass) {
            label = markLabelAsSelected(label);
          }
          return label;
        },
        callback: function() {
          var $__2 = this;
          var range = this.getSelectedRange();
          var stateBefore = getAlignmentClasses(range, (function(row, col) {
            return $__2.getCellMeta(row, col).className;
          }));
          var type = 'horizontal';
          var alignment = 'htCenter';
          this.runHooks('beforeCellAlignment', stateBefore, range, type, alignment);
          align(range, type, alignment, (function(row, col) {
            return $__2.getCellMeta(row, col);
          }), (function(row, col, key, value) {
            return $__2.setCellMeta(row, col, key, value);
          }));
          this.render();
        },
        disabled: false
      }, {
        key: (KEY + ":right"),
        name: function() {
          var $__2 = this;
          var label = 'Right';
          var hasClass = checkSelectionConsistency(this.getSelectedRange(), (function(row, col) {
            var className = $__2.getCellMeta(row, col).className;
            if (className && className.indexOf('htRight') !== -1) {
              return true;
            }
          }));
          if (hasClass) {
            label = markLabelAsSelected(label);
          }
          return label;
        },
        callback: function() {
          var $__2 = this;
          var range = this.getSelectedRange();
          var stateBefore = getAlignmentClasses(range, (function(row, col) {
            return $__2.getCellMeta(row, col).className;
          }));
          var type = 'horizontal';
          var alignment = 'htRight';
          this.runHooks('beforeCellAlignment', stateBefore, range, type, alignment);
          align(range, type, alignment, (function(row, col) {
            return $__2.getCellMeta(row, col);
          }), (function(row, col, key, value) {
            return $__2.setCellMeta(row, col, key, value);
          }));
          this.render();
        },
        disabled: false
      }, {
        key: (KEY + ":justify"),
        name: function() {
          var $__2 = this;
          var label = 'Justify';
          var hasClass = checkSelectionConsistency(this.getSelectedRange(), (function(row, col) {
            var className = $__2.getCellMeta(row, col).className;
            if (className && className.indexOf('htJustify') !== -1) {
              return true;
            }
          }));
          if (hasClass) {
            label = markLabelAsSelected(label);
          }
          return label;
        },
        callback: function() {
          var $__2 = this;
          var range = this.getSelectedRange();
          var stateBefore = getAlignmentClasses(range, (function(row, col) {
            return $__2.getCellMeta(row, col).className;
          }));
          var type = 'horizontal';
          var alignment = 'htJustify';
          this.runHooks('beforeCellAlignment', stateBefore, range, type, alignment);
          align(range, type, alignment, (function(row, col) {
            return $__2.getCellMeta(row, col);
          }), (function(row, col, key, value) {
            return $__2.setCellMeta(row, col, key, value);
          }));
          this.render();
        },
        disabled: false
      }, {name: SEPARATOR}, {
        key: (KEY + ":top"),
        name: function() {
          var $__2 = this;
          var label = 'Top';
          var hasClass = checkSelectionConsistency(this.getSelectedRange(), (function(row, col) {
            var className = $__2.getCellMeta(row, col).className;
            if (className && className.indexOf('htTop') !== -1) {
              return true;
            }
          }));
          if (hasClass) {
            label = markLabelAsSelected(label);
          }
          return label;
        },
        callback: function() {
          var $__2 = this;
          var range = this.getSelectedRange();
          var stateBefore = getAlignmentClasses(range, (function(row, col) {
            return $__2.getCellMeta(row, col).className;
          }));
          var type = 'vertical';
          var alignment = 'htTop';
          this.runHooks('beforeCellAlignment', stateBefore, range, type, alignment);
          align(range, type, alignment, (function(row, col) {
            return $__2.getCellMeta(row, col);
          }), (function(row, col, key, value) {
            return $__2.setCellMeta(row, col, key, value);
          }));
          this.render();
        },
        disabled: false
      }, {
        key: (KEY + ":middle"),
        name: function() {
          var $__2 = this;
          var label = 'Middle';
          var hasClass = checkSelectionConsistency(this.getSelectedRange(), (function(row, col) {
            var className = $__2.getCellMeta(row, col).className;
            if (className && className.indexOf('htMiddle') !== -1) {
              return true;
            }
          }));
          if (hasClass) {
            label = markLabelAsSelected(label);
          }
          return label;
        },
        callback: function() {
          var $__2 = this;
          var range = this.getSelectedRange();
          var stateBefore = getAlignmentClasses(range, (function(row, col) {
            return $__2.getCellMeta(row, col).className;
          }));
          var type = 'vertical';
          var alignment = 'htMiddle';
          this.runHooks('beforeCellAlignment', stateBefore, range, type, alignment);
          align(range, type, alignment, (function(row, col) {
            return $__2.getCellMeta(row, col);
          }), (function(row, col, key, value) {
            return $__2.setCellMeta(row, col, key, value);
          }));
          this.render();
        },
        disabled: false
      }, {
        key: (KEY + ":bottom"),
        name: function() {
          var $__2 = this;
          var label = 'Bottom';
          var hasClass = checkSelectionConsistency(this.getSelectedRange(), (function(row, col) {
            var className = $__2.getCellMeta(row, col).className;
            if (className && className.indexOf('htBottom') !== -1) {
              return true;
            }
          }));
          if (hasClass) {
            label = markLabelAsSelected(label);
          }
          return label;
        },
        callback: function() {
          var $__2 = this;
          var range = this.getSelectedRange();
          var stateBefore = getAlignmentClasses(range, (function(row, col) {
            return $__2.getCellMeta(row, col).className;
          }));
          var type = 'vertical';
          var alignment = 'htBottom';
          this.runHooks('beforeCellAlignment', stateBefore, range, type, alignment);
          align(range, type, alignment, (function(row, col) {
            return $__2.getCellMeta(row, col);
          }), (function(row, col, key, value) {
            return $__2.setCellMeta(row, col, key, value);
          }));
          this.render();
        },
        disabled: false
      }]}
  };
}

//# 
},{"separator":86,"utils":88}],77:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  KEY: {get: function() {
      return KEY;
    }},
  clearColumnItem: {get: function() {
      return clearColumnItem;
    }},
  __esModule: {value: true}
});
var $___46__46__47_utils__;
var getValidSelection = ($___46__46__47_utils__ = _dereq_("utils"), $___46__46__47_utils__ && $___46__46__47_utils__.__esModule && $___46__46__47_utils__ || {default: $___46__46__47_utils__}).getValidSelection;
var KEY = 'clear_column';
function clearColumnItem() {
  return {
    key: KEY,
    name: 'Clear column',
    callback: function(key, selection) {
      var column = selection.start.col;
      if (this.countRows()) {
        this.populateFromArray(0, column, [[null]], Math.max(selection.start.row, selection.end.row), column, 'ContextMenu.clearColumn');
      }
    },
    disabled: function() {
      var selected = getValidSelection(this);
      if (!selected) {
        return true;
      }
      var entireRowSelection = [selected[0], 0, selected[0], this.countCols() - 1];
      var rowSelected = entireRowSelection.join(',') == selected.join(',');
      return selected[1] < 0 || this.countCols() >= this.getSettings().maxCols || rowSelected;
    }
  };
}

//# 
},{"utils":88}],78:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  KEY: {get: function() {
      return KEY;
    }},
  columnLeftItem: {get: function() {
      return columnLeftItem;
    }},
  __esModule: {value: true}
});
var $___46__46__47_utils__;
var getValidSelection = ($___46__46__47_utils__ = _dereq_("utils"), $___46__46__47_utils__ && $___46__46__47_utils__.__esModule && $___46__46__47_utils__ || {default: $___46__46__47_utils__}).getValidSelection;
var KEY = 'col_left';
function columnLeftItem() {
  return {
    key: KEY,
    name: 'Insert column on the left',
    callback: function(key, selection) {
      this.alter('insert_col', selection.start.col, 1, 'ContextMenu.columnLeft');
    },
    disabled: function() {
      var selected = getValidSelection(this);
      if (!selected) {
        return true;
      }
      if (!this.isColumnModificationAllowed()) {
        return true;
      }
      var entireRowSelection = [selected[0], 0, selected[0], this.countCols() - 1];
      var rowSelected = entireRowSelection.join(',') == selected.join(',');
      var onlyOneColumn = this.countCols() === 1;
      return selected[1] < 0 || this.countCols() >= this.getSettings().maxCols || (!onlyOneColumn && rowSelected);
    },
    hidden: function() {
      return !this.getSettings().allowInsertColumn;
    }
  };
}

//# 
},{"utils":88}],79:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  KEY: {get: function() {
      return KEY;
    }},
  columnRightItem: {get: function() {
      return columnRightItem;
    }},
  __esModule: {value: true}
});
var $___46__46__47_utils__;
var getValidSelection = ($___46__46__47_utils__ = _dereq_("utils"), $___46__46__47_utils__ && $___46__46__47_utils__.__esModule && $___46__46__47_utils__ || {default: $___46__46__47_utils__}).getValidSelection;
var KEY = 'col_right';
function columnRightItem() {
  return {
    key: KEY,
    name: 'Insert column on the right',
    callback: function(key, selection) {
      this.alter('insert_col', selection.end.col + 1, 1, 'ContextMenu.columnRight');
    },
    disabled: function() {
      var selected = getValidSelection(this);
      if (!selected) {
        return true;
      }
      if (!this.isColumnModificationAllowed()) {
        return true;
      }
      var entireRowSelection = [selected[0], 0, selected[0], this.countCols() - 1];
      var rowSelected = entireRowSelection.join(',') == selected.join(',');
      var onlyOneColumn = this.countCols() === 1;
      return selected[1] < 0 || this.countCols() >= this.getSettings().maxCols || (!onlyOneColumn && rowSelected);
    },
    hidden: function() {
      return !this.getSettings().allowInsertColumn;
    }
  };
}

//# 
},{"utils":88}],80:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  KEY: {get: function() {
      return KEY;
    }},
  readOnlyItem: {get: function() {
      return readOnlyItem;
    }},
  __esModule: {value: true}
});
var $___46__46__47_utils__;
var $__0 = ($___46__46__47_utils__ = _dereq_("utils"), $___46__46__47_utils__ && $___46__46__47_utils__.__esModule && $___46__46__47_utils__ || {default: $___46__46__47_utils__}),
    checkSelectionConsistency = $__0.checkSelectionConsistency,
    markLabelAsSelected = $__0.markLabelAsSelected;
var KEY = 'make_read_only';
function readOnlyItem() {
  return {
    key: KEY,
    name: function() {
      var $__1 = this;
      var label = 'Read only';
      var atLeastOneReadOnly = checkSelectionConsistency(this.getSelectedRange(), (function(row, col) {
        return $__1.getCellMeta(row, col).readOnly;
      }));
      if (atLeastOneReadOnly) {
        label = markLabelAsSelected(label);
      }
      return label;
    },
    callback: function() {
      var $__1 = this;
      var range = this.getSelectedRange();
      var atLeastOneReadOnly = checkSelectionConsistency(range, (function(row, col) {
        return $__1.getCellMeta(row, col).readOnly;
      }));
      range.forAll((function(row, col) {
        $__1.setCellMeta(row, col, 'readOnly', atLeastOneReadOnly ? false : true);
      }));
      this.render();
    },
    disabled: function() {
      return this.getSelectedRange() && !this.selection.selectedHeader.corner ? false : true;
    }
  };
}

//# 
},{"utils":88}],81:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  KEY: {get: function() {
      return KEY;
    }},
  redoItem: {get: function() {
      return redoItem;
    }},
  __esModule: {value: true}
});
var KEY = 'redo';
function redoItem() {
  return {
    key: KEY,
    name: 'Redo',
    callback: function() {
      this.redo();
    },
    disabled: function() {
      return this.undoRedo && !this.undoRedo.isRedoAvailable();
    }
  };
}

//# 
},{}],82:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  KEY: {get: function() {
      return KEY;
    }},
  removeColumnItem: {get: function() {
      return removeColumnItem;
    }},
  __esModule: {value: true}
});
var $___46__46__47_utils__;
var getValidSelection = ($___46__46__47_utils__ = _dereq_("utils"), $___46__46__47_utils__ && $___46__46__47_utils__.__esModule && $___46__46__47_utils__ || {default: $___46__46__47_utils__}).getValidSelection;
var KEY = 'remove_col';
function removeColumnItem() {
  return {
    key: KEY,
    name: 'Remove column',
    callback: function(key, selection) {
      var amount = selection.end.col - selection.start.col + 1;
      this.alter('remove_col', selection.start.col, amount, 'ContextMenu.removeColumn');
    },
    disabled: function() {
      var selected = getValidSelection(this);
      var totalColumns = this.countCols();
      return !selected || this.selection.selectedHeader.rows || this.selection.selectedHeader.corner || !this.isColumnModificationAllowed() || !totalColumns;
    },
    hidden: function() {
      return !this.getSettings().allowRemoveColumn;
    }
  };
}

//# 
},{"utils":88}],83:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  KEY: {get: function() {
      return KEY;
    }},
  removeRowItem: {get: function() {
      return removeRowItem;
    }},
  __esModule: {value: true}
});
var $___46__46__47_utils__;
var getValidSelection = ($___46__46__47_utils__ = _dereq_("utils"), $___46__46__47_utils__ && $___46__46__47_utils__.__esModule && $___46__46__47_utils__ || {default: $___46__46__47_utils__}).getValidSelection;
var KEY = 'remove_row';
function removeRowItem() {
  return {
    key: KEY,
    name: 'Remove row',
    callback: function(key, selection) {
      var amount = selection.end.row - selection.start.row + 1;
      this.alter('remove_row', selection.start.row, amount, 'ContextMenu.removeRow');
    },
    disabled: function() {
      var selected = getValidSelection(this);
      var totalRows = this.countRows();
      return !selected || this.selection.selectedHeader.cols || this.selection.selectedHeader.corner || !totalRows;
    },
    hidden: function() {
      return !this.getSettings().allowRemoveRow;
    }
  };
}

//# 
},{"utils":88}],84:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  KEY: {get: function() {
      return KEY;
    }},
  rowAboveItem: {get: function() {
      return rowAboveItem;
    }},
  __esModule: {value: true}
});
var $___46__46__47_utils__;
var getValidSelection = ($___46__46__47_utils__ = _dereq_("utils"), $___46__46__47_utils__ && $___46__46__47_utils__.__esModule && $___46__46__47_utils__ || {default: $___46__46__47_utils__}).getValidSelection;
var KEY = 'row_above';
function rowAboveItem() {
  return {
    key: KEY,
    name: 'Insert row above',
    callback: function(key, selection) {
      this.alter('insert_row', selection.start.row, 1, 'ContextMenu.rowAbove');
    },
    disabled: function() {
      var selected = getValidSelection(this);
      return !selected || this.selection.selectedHeader.cols || this.countRows() >= this.getSettings().maxRows;
    },
    hidden: function() {
      return !this.getSettings().allowInsertRow;
    }
  };
}

//# 
},{"utils":88}],85:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  KEY: {get: function() {
      return KEY;
    }},
  rowBelowItem: {get: function() {
      return rowBelowItem;
    }},
  __esModule: {value: true}
});
var $___46__46__47_utils__;
var getValidSelection = ($___46__46__47_utils__ = _dereq_("utils"), $___46__46__47_utils__ && $___46__46__47_utils__.__esModule && $___46__46__47_utils__ || {default: $___46__46__47_utils__}).getValidSelection;
var KEY = 'row_below';
function rowBelowItem() {
  return {
    key: KEY,
    name: 'Insert row below',
    callback: function(key, selection) {
      this.alter('insert_row', selection.end.row + 1, 1, 'ContextMenu.rowBelow');
    },
    disabled: function() {
      var selected = getValidSelection(this);
      return !selected || this.selection.selectedHeader.cols || this.countRows() >= this.getSettings().maxRows;
    },
    hidden: function() {
      return !this.getSettings().allowInsertRow;
    }
  };
}

//# 
},{"utils":88}],86:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  KEY: {get: function() {
      return KEY;
    }},
  separatorItem: {get: function() {
      return separatorItem;
    }},
  __esModule: {value: true}
});
var KEY = '---------';
function separatorItem() {
  return {name: KEY};
}

//# 
},{}],87:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  KEY: {get: function() {
      return KEY;
    }},
  undoItem: {get: function() {
      return undoItem;
    }},
  __esModule: {value: true}
});
var KEY = 'undo';
function undoItem() {
  return {
    key: KEY,
    name: 'Undo',
    callback: function() {
      this.undo();
    },
    disabled: function() {
      return this.undoRedo && !this.undoRedo.isUndoAvailable();
    }
  };
}

//# 
},{}],88:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  normalizeSelection: {get: function() {
      return normalizeSelection;
    }},
  isSeparator: {get: function() {
      return isSeparator;
    }},
  hasSubMenu: {get: function() {
      return hasSubMenu;
    }},
  isDisabled: {get: function() {
      return isDisabled;
    }},
  isSelectionDisabled: {get: function() {
      return isSelectionDisabled;
    }},
  getValidSelection: {get: function() {
      return getValidSelection;
    }},
  prepareVerticalAlignClass: {get: function() {
      return prepareVerticalAlignClass;
    }},
  prepareHorizontalAlignClass: {get: function() {
      return prepareHorizontalAlignClass;
    }},
  getAlignmentClasses: {get: function() {
      return getAlignmentClasses;
    }},
  align: {get: function() {
      return align;
    }},
  checkSelectionConsistency: {get: function() {
      return checkSelectionConsistency;
    }},
  markLabelAsSelected: {get: function() {
      return markLabelAsSelected;
    }},
  isItemHidden: {get: function() {
      return isItemHidden;
    }},
  filterSeparators: {get: function() {
      return filterSeparators;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $__predefinedItems_47_separator__;
var arrayEach = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}).arrayEach;
var hasClass = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}).hasClass;
var SEPARATOR = ($__predefinedItems_47_separator__ = _dereq_("predefinedItems/separator"), $__predefinedItems_47_separator__ && $__predefinedItems_47_separator__.__esModule && $__predefinedItems_47_separator__ || {default: $__predefinedItems_47_separator__}).KEY;
function normalizeSelection(selRange) {
  return {
    start: selRange.getTopLeftCorner(),
    end: selRange.getBottomRightCorner()
  };
}
function isSeparator(cell) {
  return hasClass(cell, 'htSeparator');
}
function hasSubMenu(cell) {
  return hasClass(cell, 'htSubmenu');
}
function isDisabled(cell) {
  return hasClass(cell, 'htDisabled');
}
function isSelectionDisabled(cell) {
  return hasClass(cell, 'htSelectionDisabled');
}
function getValidSelection(hot) {
  var selected = hot.getSelected();
  if (!selected) {
    return null;
  }
  if (selected[0] < 0) {
    return null;
  }
  return selected;
}
function prepareVerticalAlignClass(className, alignment) {
  if (className.indexOf(alignment) != -1) {
    return className;
  }
  className = className.replace('htTop', '').replace('htMiddle', '').replace('htBottom', '').replace('  ', '');
  className += ' ' + alignment;
  return className;
}
function prepareHorizontalAlignClass(className, alignment) {
  if (className.indexOf(alignment) != -1) {
    return className;
  }
  className = className.replace('htLeft', '').replace('htCenter', '').replace('htRight', '').replace('htJustify', '').replace('  ', '');
  className += ' ' + alignment;
  return className;
}
function getAlignmentClasses(range, callback) {
  var classes = {};
  for (var row = range.from.row; row <= range.to.row; row++) {
    for (var col = range.from.col; col <= range.to.col; col++) {
      if (!classes[row]) {
        classes[row] = [];
      }
      classes[row][col] = callback(row, col);
    }
  }
  return classes;
}
function align(range, type, alignment, cellDescriptor, propertySetter) {
  if (range.from.row == range.to.row && range.from.col == range.to.col) {
    applyAlignClassName(range.from.row, range.from.col, type, alignment, cellDescriptor, propertySetter);
  } else {
    for (var row = range.from.row; row <= range.to.row; row++) {
      for (var col = range.from.col; col <= range.to.col; col++) {
        applyAlignClassName(row, col, type, alignment, cellDescriptor, propertySetter);
      }
    }
  }
}
function applyAlignClassName(row, col, type, alignment, cellDescriptor, propertySetter) {
  var cellMeta = cellDescriptor(row, col);
  var className = alignment;
  if (cellMeta.className) {
    if (type === 'vertical') {
      className = prepareVerticalAlignClass(cellMeta.className, alignment);
    } else {
      className = prepareHorizontalAlignClass(cellMeta.className, alignment);
    }
  }
  propertySetter(row, col, 'className', className);
}
function checkSelectionConsistency(range, comparator) {
  var result = false;
  if (range) {
    range.forAll(function(row, col) {
      if (comparator(row, col)) {
        result = true;
        return false;
      }
    });
  }
  return result;
}
function markLabelAsSelected(label) {
  return '<span class="selected">' + String.fromCharCode(10003) + '</span>' + label;
}
function isItemHidden(item, instance) {
  return !item.hidden || !(typeof item.hidden == 'function' && item.hidden.call(instance));
}
function shiftSeparators(items, separator) {
  var result = items.slice(0);
  for (var i = 0; i < result.length; ) {
    if (result[i].name === separator) {
      result.shift();
    } else {
      break;
    }
  }
  return result;
}
function popSeparators(items, separator) {
  var result = items.slice(0);
  result.reverse();
  result = shiftSeparators(result, separator);
  result.reverse();
  return result;
}
function removeDuplicatedSeparators(items) {
  var result = [];
  arrayEach(items, (function(value, index) {
    if (index > 0) {
      if (result[result.length - 1].name !== value.name) {
        result.push(value);
      }
    } else {
      result.push(value);
    }
  }));
  return result;
}
function filterSeparators(items) {
  var separator = arguments[1] !== (void 0) ? arguments[1] : SEPARATOR;
  var result = items.slice(0);
  result = shiftSeparators(result, separator);
  result = popSeparators(result, separator);
  result = removeDuplicatedSeparators(result);
  return result;
}

//# 
},{"helpers/array":43,"helpers/dom/element":47,"predefinedItems/separator":86}],89:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  ContextMenuCopyPaste: {get: function() {
      return ContextMenuCopyPaste;
    }},
  __esModule: {value: true}
});
var $___46__46__47__95_base__,
    $__zeroclipboard__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__46__46__47_eventManager__,
    $___46__46__47__46__46__47_plugins__,
    $___46__46__47_contextMenu_47_predefinedItems__;
var BasePlugin = ($___46__46__47__95_base__ = _dereq_("_base"), $___46__46__47__95_base__ && $___46__46__47__95_base__.__esModule && $___46__46__47__95_base__ || {default: $___46__46__47__95_base__}).default;
var ZeroClipboard = ($__zeroclipboard__ = _dereq_("zeroclipboard"), $__zeroclipboard__ && $__zeroclipboard__.__esModule && $__zeroclipboard__ || {default: $__zeroclipboard__}).default;
var removeClass = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}).removeClass;
var arrayEach = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}).arrayEach;
var EventManager = ($___46__46__47__46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47__46__46__47_eventManager__ && $___46__46__47__46__46__47_eventManager__.__esModule && $___46__46__47__46__46__47_eventManager__ || {default: $___46__46__47__46__46__47_eventManager__}).EventManager;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
var SEPARATOR = ($___46__46__47_contextMenu_47_predefinedItems__ = _dereq_("contextMenu/predefinedItems"), $___46__46__47_contextMenu_47_predefinedItems__ && $___46__46__47_contextMenu_47_predefinedItems__.__esModule && $___46__46__47_contextMenu_47_predefinedItems__ || {default: $___46__46__47_contextMenu_47_predefinedItems__}).SEPARATOR;
var ContextMenuCopyPaste = function ContextMenuCopyPaste(hotInstance) {
  $traceurRuntime.superConstructor($ContextMenuCopyPaste).call(this, hotInstance);
  this.eventManager = new EventManager(this);
  this.swfPath = null;
  this.outsideClickDeselectsCache = null;
};
var $ContextMenuCopyPaste = ContextMenuCopyPaste;
($traceurRuntime.createClass)(ContextMenuCopyPaste, {
  isEnabled: function() {
    return this.hot.getSettings().contextMenuCopyPaste;
  },
  enablePlugin: function() {
    var $__7 = this;
    if (this.enabled) {
      return;
    }
    if (typeof this.hot.getSettings().contextMenuCopyPaste === 'object') {
      this.swfPath = this.hot.getSettings().contextMenuCopyPaste.swfPath;
    }
    if (typeof ZeroClipboard === 'undefined') {
      console.error('To be able to use the Copy/Paste feature from the context menu, you need to manually include ZeroClipboard.js file to your website.');
    }
    try {
      new ActiveXObject('ShockwaveFlash.ShockwaveFlash');
    } catch (exception) {
      if (typeof navigator.mimeTypes['application/x-shockwave-flash'] == 'undefined') {
        console.error('To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.');
      }
    }
    if (this.swfPath) {
      ZeroClipboard.config({swfPath: this.swfPath});
    }
    this.hot.addHook('afterContextMenuShow', (function() {
      return $__7.onAfterContextMenuShow();
    }));
    this.hot.addHook('afterContextMenuDefaultOptions', (function(options) {
      return $__7.onAfterContextMenuDefaultOptions(options);
    }));
    this.registerEvents();
    $traceurRuntime.superGet(this, $ContextMenuCopyPaste.prototype, "enablePlugin").call(this);
  },
  disablePlugin: function() {
    $traceurRuntime.superGet(this, $ContextMenuCopyPaste.prototype, "disablePlugin").call(this);
  },
  registerEvents: function() {
    var $__7 = this;
    this.eventManager.addEventListener(document, 'mouseenter', (function() {
      return $__7.removeCurrentClass();
    }));
    this.eventManager.addEventListener(document, 'mouseleave', (function() {
      return $__7.removeZeroClipboardClass();
    }));
  },
  getCopyValue: function() {
    this.hot.copyPaste.setCopyableText();
    this.hot.copyPaste.copyPasteInstance.triggerCopy();
    return this.hot.copyPaste.copyPasteInstance.elTextarea.value;
  },
  onAfterContextMenuDefaultOptions: function(defaultOptions) {
    defaultOptions.items.unshift({
      key: 'copy',
      name: 'Copy',
      disabled: function() {
        return this.selection.selectedHeader.corner;
      }
    }, {
      key: 'paste',
      name: 'Paste',
      callback: function() {
        this.copyPaste.triggerPaste();
      },
      disabled: function() {
        return this.selection.selectedHeader.corner;
      }
    }, {name: SEPARATOR});
  },
  onAfterContextMenuShow: function() {
    var $__7 = this;
    var contextMenu = this.hot.getPlugin('contextMenu');
    var data = contextMenu.menu.hotMenu.getSourceData();
    arrayEach(data, (function(item, index) {
      if (item.key === 'copy') {
        var zeroClipboardInstance = new ZeroClipboard(contextMenu.menu.hotMenu.getCell(index, 0));
        zeroClipboardInstance.off();
        zeroClipboardInstance.on('copy', (function(event) {
          var clipboard = event.clipboardData;
          clipboard.setData('text/plain', $__7.getCopyValue());
          $__7.hot.getSettings().outsideClickDeselects = $__7.outsideClickDeselectsCache;
        }));
        return false;
      }
    }));
  },
  removeCurrentClass: function() {
    var contextMenu = this.hot.getPlugin('contextMenu');
    if (!contextMenu.enabled) {
      return;
    }
    if (contextMenu.menu.isOpened()) {
      var element = contextMenu.menu.hotMenu.rootElement.querySelector('td.current');
      if (element) {
        removeClass(element, 'current');
      }
    }
    this.outsideClickDeselectsCache = this.hot.getSettings().outsideClickDeselects;
    this.hot.getSettings().outsideClickDeselects = false;
  },
  removeZeroClipboardClass: function() {
    var contextMenu = this.hot.getPlugin('contextMenu');
    if (!contextMenu.enabled) {
      return;
    }
    if (contextMenu.menu.isOpened()) {
      var element = contextMenu.menu.hotMenu.rootElement.querySelector('td.zeroclipboard-is-hover');
      if (element) {
        removeClass(element, 'zeroclipboard-is-hover');
      }
    }
    this.hot.getSettings().outsideClickDeselects = this.outsideClickDeselectsCache;
  }
}, {}, BasePlugin);
;
registerPlugin('contextMenuCopyPaste', ContextMenuCopyPaste);

//# 
},{"_base":62,"contextMenu/predefinedItems":75,"eventManager":42,"helpers/array":43,"helpers/dom/element":47,"plugins":61,"zeroclipboard":"zeroclipboard"}],90:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  CopyPastePlugin: {get: function() {
      return CopyPastePlugin;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__,
    $__copyPaste__,
    $__SheetClip__,
    $___46__46__47__46__46__47_helpers_47_unicode__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__46__46__47_helpers_47_number__,
    $___46__46__47__46__46__47_helpers_47_dom_47_event__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47_helpers_47_function__,
    $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__,
    $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var copyPaste = ($__copyPaste__ = _dereq_("copyPaste"), $__copyPaste__ && $__copyPaste__.__esModule && $__copyPaste__ || {default: $__copyPaste__}).default;
var SheetClip = ($__SheetClip__ = _dereq_("SheetClip"), $__SheetClip__ && $__SheetClip__.__esModule && $__SheetClip__ || {default: $__SheetClip__}).default;
var $__3 = ($___46__46__47__46__46__47_helpers_47_unicode__ = _dereq_("helpers/unicode"), $___46__46__47__46__46__47_helpers_47_unicode__ && $___46__46__47__46__46__47_helpers_47_unicode__.__esModule && $___46__46__47__46__46__47_helpers_47_unicode__ || {default: $___46__46__47__46__46__47_helpers_47_unicode__}),
    KEY_CODES = $__3.KEY_CODES,
    isCtrlKey = $__3.isCtrlKey;
var arrayEach = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}).arrayEach;
var rangeEach = ($___46__46__47__46__46__47_helpers_47_number__ = _dereq_("helpers/number"), $___46__46__47__46__46__47_helpers_47_number__ && $___46__46__47__46__46__47_helpers_47_number__.__esModule && $___46__46__47__46__46__47_helpers_47_number__ || {default: $___46__46__47__46__46__47_helpers_47_number__}).rangeEach;
var $__6 = ($___46__46__47__46__46__47_helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $___46__46__47__46__46__47_helpers_47_dom_47_event__ && $___46__46__47__46__46__47_helpers_47_dom_47_event__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_event__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_event__}),
    stopImmediatePropagation = $__6.stopImmediatePropagation,
    isImmediatePropagationStopped = $__6.isImmediatePropagationStopped;
var getSelectionText = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}).getSelectionText;
var proxy = ($___46__46__47__46__46__47_helpers_47_function__ = _dereq_("helpers/function"), $___46__46__47__46__46__47_helpers_47_function__ && $___46__46__47__46__46__47_helpers_47_function__.__esModule && $___46__46__47__46__46__47_helpers_47_function__ || {default: $___46__46__47__46__46__47_helpers_47_function__}).proxy;
var WalkontableCellCoords = ($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ = _dereq_("3rdparty/walkontable/src/cell/coords"), $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__.__esModule && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ || {default: $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__}).WalkontableCellCoords;
var WalkontableCellRange = ($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__ = _dereq_("3rdparty/walkontable/src/cell/range"), $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__ && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__.__esModule && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__ || {default: $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__}).WalkontableCellRange;
function CopyPastePlugin(instance) {
  var _this = this;
  this.copyPasteInstance = copyPaste();
  this.copyPasteInstance.onCut(onCut);
  this.copyPasteInstance.triggerCopy = callCopyAction;
  this.copyPasteInstance.onPaste(onPaste);
  this.onPaste = onPaste;
  this.copyableRanges = [];
  instance.addHook('beforeKeyDown', onBeforeKeyDown);
  function onCut() {
    if (!instance.isListening()) {
      return;
    }
  }
  function callCutAction() {
    var rangedData = _this.getRangedData(_this.copyableRanges);
    if (instance.getSettings().fragmentSelection && (SheetClip.stringify(rangedData) != getSelectionText())) {
      return;
    }
    var allowCuttingOut = !!instance.runHooks('beforeCut', rangedData, _this.copyableRanges);
    if (allowCuttingOut) {
      instance.copyPaste.copyPasteInstance.copyable(SheetClip.stringify(rangedData));
      instance.selection.empty();
      instance.runHooks('afterCut', rangedData, _this.copyableRanges);
    } else {
      instance.copyPaste.copyPasteInstance.copyable('');
    }
  }
  function callCopyAction() {
    if (!instance.isListening()) {
      return;
    }
    var rangedData = _this.getRangedData(_this.copyableRanges);
    if (instance.getSettings().fragmentSelection && (SheetClip.stringify(rangedData) != getSelectionText())) {
      return;
    }
    var allowCopying = !!instance.runHooks('beforeCopy', rangedData, _this.copyableRanges);
    if (allowCopying) {
      instance.copyPaste.copyPasteInstance.copyable(SheetClip.stringify(rangedData));
      instance.runHooks('afterCopy', rangedData, _this.copyableRanges);
    } else {
      instance.copyPaste.copyPasteInstance.copyable('');
    }
  }
  function onPaste(str) {
    var input,
        inputArray,
        selected,
        coordsFrom,
        coordsTo,
        cellRange,
        topLeftCorner,
        bottomRightCorner,
        areaStart,
        areaEnd;
    if (!instance.isListening() || !instance.selection.isSelected()) {
      return;
    }
    input = str;
    inputArray = SheetClip.parse(input);
    selected = instance.getSelected();
    coordsFrom = new WalkontableCellCoords(selected[0], selected[1]);
    coordsTo = new WalkontableCellCoords(selected[2], selected[3]);
    cellRange = new WalkontableCellRange(coordsFrom, coordsFrom, coordsTo);
    topLeftCorner = cellRange.getTopLeftCorner();
    bottomRightCorner = cellRange.getBottomRightCorner();
    areaStart = topLeftCorner;
    areaEnd = new WalkontableCellCoords(Math.max(bottomRightCorner.row, inputArray.length - 1 + topLeftCorner.row), Math.max(bottomRightCorner.col, inputArray[0].length - 1 + topLeftCorner.col));
    var isSelRowAreaCoverInputValue = coordsTo.row - coordsFrom.row >= inputArray.length - 1;
    var isSelColAreaCoverInputValue = coordsTo.col - coordsFrom.col >= inputArray[0].length - 1;
    instance.addHookOnce('afterChange', (function(changes, source) {
      var changesLength = changes ? changes.length : 0;
      if (changesLength) {
        var offset = {
          row: 0,
          col: 0
        };
        var highestColumnIndex = -1;
        arrayEach(changes, (function(change, index) {
          var nextChange = changesLength > index + 1 ? changes[index + 1] : null;
          if (nextChange) {
            if (!isSelRowAreaCoverInputValue) {
              offset.row = offset.row + Math.max(nextChange[0] - change[0] - 1, 0);
            }
            if (!isSelColAreaCoverInputValue && change[1] > highestColumnIndex) {
              highestColumnIndex = change[1];
              offset.col = offset.col + Math.max(nextChange[1] - change[1] - 1, 0);
            }
          }
        }));
        instance.selectCell(areaStart.row, areaStart.col, areaEnd.row + offset.row, areaEnd.col + offset.col);
      }
    }));
    var allowPasting = !!instance.runHooks('beforePaste', inputArray, _this.copyableRanges);
    if (allowPasting) {
      instance.populateFromArray(areaStart.row, areaStart.col, inputArray, areaEnd.row, areaEnd.col, 'CopyPaste.paste', instance.getSettings().pasteMode);
      instance.runHooks('afterPaste', inputArray, _this.copyableRanges);
    }
  }
  function onBeforeKeyDown(event) {
    if (!instance.getSelected()) {
      return;
    }
    if (instance.getActiveEditor() && instance.getActiveEditor().isOpened()) {
      return;
    }
    if (isImmediatePropagationStopped(event)) {
      return;
    }
    if (isCtrlKey(event.keyCode)) {
      if (instance.getSettings().fragmentSelection && getSelectionText()) {
        return;
      }
      _this.setCopyableText();
      stopImmediatePropagation(event);
      return;
    }
    var ctrlDown = (event.ctrlKey || event.metaKey) && !event.altKey;
    if (ctrlDown) {
      if (event.keyCode == KEY_CODES.A) {
        instance._registerTimeout(setTimeout(proxy(_this.setCopyableText, _this), 0));
      }
      if (event.keyCode == KEY_CODES.X) {
        callCutAction();
      }
      if (event.keyCode == KEY_CODES.C) {
        callCopyAction();
      }
    }
  }
  this.destroy = function() {
    if (this.copyPasteInstance) {
      this.copyPasteInstance.removeCallback(onCut);
      this.copyPasteInstance.removeCallback(onPaste);
      this.copyPasteInstance.destroy();
      this.copyPasteInstance = null;
    }
    instance.removeHook('beforeKeyDown', onBeforeKeyDown);
  };
  instance.addHook('afterDestroy', proxy(this.destroy, this));
  this.triggerPaste = proxy(this.copyPasteInstance.triggerPaste, this.copyPasteInstance);
  this.triggerCut = proxy(this.copyPasteInstance.triggerCut, this.copyPasteInstance);
  this.setCopyableText = function() {
    var settings = instance.getSettings();
    var copyRowsLimit = settings.copyRowsLimit;
    var copyColsLimit = settings.copyColsLimit;
    var selRange = instance.getSelectedRange();
    var topLeft = selRange.getTopLeftCorner();
    var bottomRight = selRange.getBottomRightCorner();
    var startRow = topLeft.row;
    var startCol = topLeft.col;
    var endRow = bottomRight.row;
    var endCol = bottomRight.col;
    var finalEndRow = Math.min(endRow, startRow + copyRowsLimit - 1);
    var finalEndCol = Math.min(endCol, startCol + copyColsLimit - 1);
    this.copyableRanges.length = 0;
    this.copyableRanges.push({
      startRow: startRow,
      startCol: startCol,
      endRow: finalEndRow,
      endCol: finalEndCol
    });
    this.copyableRanges = instance.runHooks('modifyCopyableRange', this.copyableRanges);
    var copyableData = this.getRangedCopyableData(this.copyableRanges);
    instance.copyPaste.copyPasteInstance.copyable(copyableData);
    if (endRow !== finalEndRow || endCol !== finalEndCol) {
      Handsontable.hooks.run(instance, 'afterCopyLimit', endRow - startRow + 1, endCol - startCol + 1, copyRowsLimit, copyColsLimit);
    }
  };
  this.getRangedCopyableData = function(ranges) {
    var dataSet = [];
    var copyableRows = [];
    var copyableColumns = [];
    arrayEach(ranges, (function(range) {
      rangeEach(range.startRow, range.endRow, (function(row) {
        if (copyableRows.indexOf(row) === -1) {
          copyableRows.push(row);
        }
      }));
      rangeEach(range.startCol, range.endCol, (function(column) {
        if (copyableColumns.indexOf(column) === -1) {
          copyableColumns.push(column);
        }
      }));
    }));
    arrayEach(copyableRows, (function(row) {
      var rowSet = [];
      arrayEach(copyableColumns, (function(column) {
        rowSet.push(instance.getCopyableData(row, column));
      }));
      dataSet.push(rowSet);
    }));
    return SheetClip.stringify(dataSet);
  };
  this.getRangedData = function(ranges) {
    var dataSet = [];
    var copyableRows = [];
    var copyableColumns = [];
    arrayEach(ranges, (function(range) {
      rangeEach(range.startRow, range.endRow, (function(row) {
        if (copyableRows.indexOf(row) === -1) {
          copyableRows.push(row);
        }
      }));
      rangeEach(range.startCol, range.endCol, (function(column) {
        if (copyableColumns.indexOf(column) === -1) {
          copyableColumns.push(column);
        }
      }));
    }));
    arrayEach(copyableRows, (function(row) {
      var rowSet = [];
      arrayEach(copyableColumns, (function(column) {
        rowSet.push(instance.getCopyableData(row, column));
      }));
      dataSet.push(rowSet);
    }));
    return dataSet;
  };
}
function init() {
  var instance = this,
      pluginEnabled = instance.getSettings().copyPaste !== false;
  if (pluginEnabled && !instance.copyPaste) {
    instance.copyPaste = new CopyPastePlugin(instance);
  } else if (!pluginEnabled && instance.copyPaste) {
    instance.copyPaste.destroy();
    instance.copyPaste = null;
  }
}
Handsontable.hooks.add('afterInit', init);
Handsontable.hooks.add('afterUpdateSettings', init);
Handsontable.hooks.register('afterCopyLimit');
Handsontable.hooks.register('modifyCopyableRange');
Handsontable.hooks.register('beforeCut');
Handsontable.hooks.register('afterCut');
Handsontable.hooks.register('beforePaste');
Handsontable.hooks.register('afterPaste');
Handsontable.hooks.register('beforeCopy');
Handsontable.hooks.register('afterCopy');
;

//# 
},{"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/cell/range":7,"SheetClip":"SheetClip","browser":24,"copyPaste":"copyPaste","helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/function":50,"helpers/number":52,"helpers/unicode":56}],91:[function(_dereq_,module,exports){
"use strict";
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__46__46__47_plugins__,
    $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__,
    $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_selection__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
var WalkontableCellRange = ($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__ = _dereq_("3rdparty/walkontable/src/cell/range"), $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__ && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__.__esModule && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__ || {default: $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__}).WalkontableCellRange;
var WalkontableSelection = ($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_selection__ = _dereq_("3rdparty/walkontable/src/selection"), $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_selection__ && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_selection__.__esModule && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_selection__ || {default: $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_selection__}).WalkontableSelection;
function CustomBorders() {}
var instance;
var checkEnable = function(customBorders) {
  if (typeof customBorders === 'boolean') {
    if (customBorders === true) {
      return true;
    }
  }
  if (typeof customBorders === 'object') {
    if (customBorders.length > 0) {
      return true;
    }
  }
  return false;
};
var init = function() {
  if (checkEnable(this.getSettings().customBorders)) {
    if (!this.customBorders) {
      instance = this;
      this.customBorders = new CustomBorders();
    }
  }
};
var getSettingIndex = function(className) {
  for (var i = 0; i < instance.view.wt.selections.length; i++) {
    if (instance.view.wt.selections[i].settings.className == className) {
      return i;
    }
  }
  return -1;
};
var insertBorderIntoSettings = function(border) {
  var coordinates = {
    row: border.row,
    col: border.col
  };
  var selection = new WalkontableSelection(border, new WalkontableCellRange(coordinates, coordinates, coordinates));
  var index = getSettingIndex(border.className);
  if (index >= 0) {
    instance.view.wt.selections[index] = selection;
  } else {
    instance.view.wt.selections.push(selection);
  }
};
var prepareBorderFromCustomAdded = function(row, col, borderObj) {
  var border = createEmptyBorders(row, col);
  border = extendDefaultBorder(border, borderObj);
  this.setCellMeta(row, col, 'borders', border);
  insertBorderIntoSettings(border);
};
var prepareBorderFromCustomAddedRange = function(rowObj) {
  var range = rowObj.range;
  for (var row = range.from.row; row <= range.to.row; row++) {
    for (var col = range.from.col; col <= range.to.col; col++) {
      var border = createEmptyBorders(row, col);
      var add = 0;
      if (row == range.from.row) {
        add++;
        if (rowObj.hasOwnProperty('top')) {
          border.top = rowObj.top;
        }
      }
      if (row == range.to.row) {
        add++;
        if (rowObj.hasOwnProperty('bottom')) {
          border.bottom = rowObj.bottom;
        }
      }
      if (col == range.from.col) {
        add++;
        if (rowObj.hasOwnProperty('left')) {
          border.left = rowObj.left;
        }
      }
      if (col == range.to.col) {
        add++;
        if (rowObj.hasOwnProperty('right')) {
          border.right = rowObj.right;
        }
      }
      if (add > 0) {
        this.setCellMeta(row, col, 'borders', border);
        insertBorderIntoSettings(border);
      }
    }
  }
};
var createClassName = function(row, col) {
  return 'border_row' + row + 'col' + col;
};
var createDefaultCustomBorder = function() {
  return {
    width: 1,
    color: '#000'
  };
};
var createSingleEmptyBorder = function() {
  return {hide: true};
};
var createDefaultHtBorder = function() {
  return {
    width: 1,
    color: '#000',
    cornerVisible: false
  };
};
var createEmptyBorders = function(row, col) {
  return {
    className: createClassName(row, col),
    border: createDefaultHtBorder(),
    row: row,
    col: col,
    top: createSingleEmptyBorder(),
    right: createSingleEmptyBorder(),
    bottom: createSingleEmptyBorder(),
    left: createSingleEmptyBorder()
  };
};
var extendDefaultBorder = function(defaultBorder, customBorder) {
  if (customBorder.hasOwnProperty('border')) {
    defaultBorder.border = customBorder.border;
  }
  if (customBorder.hasOwnProperty('top')) {
    defaultBorder.top = customBorder.top;
  }
  if (customBorder.hasOwnProperty('right')) {
    defaultBorder.right = customBorder.right;
  }
  if (customBorder.hasOwnProperty('bottom')) {
    defaultBorder.bottom = customBorder.bottom;
  }
  if (customBorder.hasOwnProperty('left')) {
    defaultBorder.left = customBorder.left;
  }
  return defaultBorder;
};
var removeBordersFromDom = function(borderClassName) {
  var borders = document.querySelectorAll('.' + borderClassName);
  for (var i = 0; i < borders.length; i++) {
    if (borders[i]) {
      if (borders[i].nodeName != 'TD') {
        var parent = borders[i].parentNode;
        if (parent.parentNode) {
          parent.parentNode.removeChild(parent);
        }
      }
    }
  }
};
var removeAllBorders = function(row, col) {
  var borderClassName = createClassName(row, col);
  removeBordersFromDom(borderClassName);
  this.removeCellMeta(row, col, 'borders');
};
var setBorder = function(row, col, place, remove) {
  var bordersMeta = this.getCellMeta(row, col).borders;
  if (!bordersMeta || bordersMeta.border == undefined) {
    bordersMeta = createEmptyBorders(row, col);
  }
  if (remove) {
    bordersMeta[place] = createSingleEmptyBorder();
  } else {
    bordersMeta[place] = createDefaultCustomBorder();
  }
  this.setCellMeta(row, col, 'borders', bordersMeta);
  var borderClassName = createClassName(row, col);
  removeBordersFromDom(borderClassName);
  insertBorderIntoSettings(bordersMeta);
  this.render();
};
var prepareBorder = function(range, place, remove) {
  if (range.from.row == range.to.row && range.from.col == range.to.col) {
    if (place == 'noBorders') {
      removeAllBorders.call(this, range.from.row, range.from.col);
    } else {
      setBorder.call(this, range.from.row, range.from.col, place, remove);
    }
  } else {
    switch (place) {
      case 'noBorders':
        for (var column = range.from.col; column <= range.to.col; column++) {
          for (var row = range.from.row; row <= range.to.row; row++) {
            removeAllBorders.call(this, row, column);
          }
        }
        break;
      case 'top':
        for (var topCol = range.from.col; topCol <= range.to.col; topCol++) {
          setBorder.call(this, range.from.row, topCol, place, remove);
        }
        break;
      case 'right':
        for (var rowRight = range.from.row; rowRight <= range.to.row; rowRight++) {
          setBorder.call(this, rowRight, range.to.col, place);
        }
        break;
      case 'bottom':
        for (var bottomCol = range.from.col; bottomCol <= range.to.col; bottomCol++) {
          setBorder.call(this, range.to.row, bottomCol, place);
        }
        break;
      case 'left':
        for (var rowLeft = range.from.row; rowLeft <= range.to.row; rowLeft++) {
          setBorder.call(this, rowLeft, range.from.col, place);
        }
        break;
    }
  }
};
var checkSelectionBorders = function(hot, direction) {
  var atLeastOneHasBorder = false;
  hot.getSelectedRange().forAll(function(r, c) {
    var metaBorders = hot.getCellMeta(r, c).borders;
    if (metaBorders) {
      if (direction) {
        if (!metaBorders[direction].hasOwnProperty('hide')) {
          atLeastOneHasBorder = true;
          return false;
        }
      } else {
        atLeastOneHasBorder = true;
        return false;
      }
    }
  });
  return atLeastOneHasBorder;
};
var markSelected = function(label) {
  return '<span class="selected">' + String.fromCharCode(10003) + '</span>' + label;
};
var addBordersOptionsToContextMenu = function(defaultOptions) {
  if (!this.getSettings().customBorders) {
    return;
  }
  defaultOptions.items.push(Handsontable.plugins.ContextMenu.SEPARATOR);
  defaultOptions.items.push({
    key: 'borders',
    name: 'Borders',
    disabled: function() {
      return this.selection.selectedHeader.corner;
    },
    submenu: {items: [{
        key: 'borders:top',
        name: function() {
          var label = 'Top';
          var hasBorder = checkSelectionBorders(this, 'top');
          if (hasBorder) {
            label = markSelected(label);
          }
          return label;
        },
        callback: function() {
          var hasBorder = checkSelectionBorders(this, 'top');
          prepareBorder.call(this, this.getSelectedRange(), 'top', hasBorder);
        }
      }, {
        key: 'borders:right',
        name: function() {
          var label = 'Right';
          var hasBorder = checkSelectionBorders(this, 'right');
          if (hasBorder) {
            label = markSelected(label);
          }
          return label;
        },
        callback: function() {
          var hasBorder = checkSelectionBorders(this, 'right');
          prepareBorder.call(this, this.getSelectedRange(), 'right', hasBorder);
        }
      }, {
        key: 'borders:bottom',
        name: function() {
          var label = 'Bottom';
          var hasBorder = checkSelectionBorders(this, 'bottom');
          if (hasBorder) {
            label = markSelected(label);
          }
          return label;
        },
        callback: function() {
          var hasBorder = checkSelectionBorders(this, 'bottom');
          prepareBorder.call(this, this.getSelectedRange(), 'bottom', hasBorder);
        }
      }, {
        key: 'borders:left',
        name: function() {
          var label = 'Left';
          var hasBorder = checkSelectionBorders(this, 'left');
          if (hasBorder) {
            label = markSelected(label);
          }
          return label;
        },
        callback: function() {
          var hasBorder = checkSelectionBorders(this, 'left');
          prepareBorder.call(this, this.getSelectedRange(), 'left', hasBorder);
        }
      }, {
        key: 'borders:no_borders',
        name: 'Remove border(s)',
        callback: function() {
          prepareBorder.call(this, this.getSelectedRange(), 'noBorders');
        },
        disabled: function() {
          return !checkSelectionBorders(this);
        }
      }]}
  });
};
Handsontable.hooks.add('beforeInit', init);
Handsontable.hooks.add('afterContextMenuDefaultOptions', addBordersOptionsToContextMenu);
Handsontable.hooks.add('afterInit', function() {
  var customBorders = this.getSettings().customBorders;
  if (customBorders) {
    for (var i = 0; i < customBorders.length; i++) {
      if (customBorders[i].range) {
        prepareBorderFromCustomAddedRange.call(this, customBorders[i]);
      } else {
        prepareBorderFromCustomAdded.call(this, customBorders[i].row, customBorders[i].col, customBorders[i]);
      }
    }
    this.render();
    this.view.wt.draw(true);
  }
});
Handsontable.CustomBorders = CustomBorders;

//# 
},{"3rdparty/walkontable/src/cell/range":7,"3rdparty/walkontable/src/selection":19,"browser":24,"plugins":61}],92:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  DragToScroll: {get: function() {
      return DragToScroll;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__46__46__47_eventManager__,
    $___46__46__47__46__46__47_plugins__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var eventManagerObject = ($___46__46__47__46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47__46__46__47_eventManager__ && $___46__46__47__46__46__47_eventManager__.__esModule && $___46__46__47__46__46__47_eventManager__ || {default: $___46__46__47__46__46__47_eventManager__}).eventManager;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
;
Handsontable.plugins.DragToScroll = DragToScroll;
function DragToScroll() {
  this.boundaries = null;
  this.callback = null;
}
DragToScroll.prototype.setBoundaries = function(boundaries) {
  this.boundaries = boundaries;
};
DragToScroll.prototype.setCallback = function(callback) {
  this.callback = callback;
};
DragToScroll.prototype.check = function(x, y) {
  var diffX = 0;
  var diffY = 0;
  if (y < this.boundaries.top) {
    diffY = y - this.boundaries.top;
  } else if (y > this.boundaries.bottom) {
    diffY = y - this.boundaries.bottom;
  }
  if (x < this.boundaries.left) {
    diffX = x - this.boundaries.left;
  } else if (x > this.boundaries.right) {
    diffX = x - this.boundaries.right;
  }
  this.callback(diffX, diffY);
};
var dragToScroll;
var instance;
var setupListening = function(instance) {
  instance.dragToScrollListening = false;
  var scrollHandler = instance.view.wt.wtTable.holder;
  dragToScroll = new DragToScroll();
  if (scrollHandler === window) {
    return;
  } else {
    dragToScroll.setBoundaries(scrollHandler.getBoundingClientRect());
  }
  dragToScroll.setCallback(function(scrollX, scrollY) {
    if (scrollX < 0) {
      scrollHandler.scrollLeft -= 50;
    } else if (scrollX > 0) {
      scrollHandler.scrollLeft += 50;
    }
    if (scrollY < 0) {
      scrollHandler.scrollTop -= 20;
    } else if (scrollY > 0) {
      scrollHandler.scrollTop += 20;
    }
  });
  instance.dragToScrollListening = true;
};
Handsontable.hooks.add('afterInit', function() {
  var instance = this;
  var eventManager = eventManagerObject(this);
  eventManager.addEventListener(document, 'mouseup', function() {
    instance.dragToScrollListening = false;
  });
  eventManager.addEventListener(document, 'mousemove', function(event) {
    if (instance.dragToScrollListening) {
      dragToScroll.check(event.clientX, event.clientY);
    }
  });
});
Handsontable.hooks.add('afterDestroy', function() {
  eventManagerObject(this).clear();
});
Handsontable.hooks.add('afterOnCellMouseDown', function() {
  setupListening(this);
});
Handsontable.hooks.add('afterOnCellCornerMouseDown', function() {
  setupListening(this);
});
Handsontable.plugins.DragToScroll = DragToScroll;

//# 
},{"browser":24,"eventManager":42,"plugins":61}],93:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  freezeColumnItem: {get: function() {
      return freezeColumnItem;
    }},
  __esModule: {value: true}
});
function freezeColumnItem(manualColumnFreezePlugin) {
  return {
    key: 'freeze_column',
    name: 'Freeze this column',
    callback: function() {
      var selectedColumn = this.getSelectedRange().from.col;
      manualColumnFreezePlugin.freezeColumn(selectedColumn);
      this.render();
      this.view.wt.wtOverlays.adjustElementsSize(true);
    },
    hidden: function() {
      var selection = this.getSelectedRange();
      var hide = false;
      if (selection === void 0) {
        hide = true;
      } else if ((selection.from.col !== selection.to.col) || (selection.from.col <= this.getSettings().fixedColumnsLeft - 1)) {
        hide = true;
      }
      return hide;
    }
  };
}

//# 
},{}],94:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  unfreezeColumnItem: {get: function() {
      return unfreezeColumnItem;
    }},
  __esModule: {value: true}
});
function unfreezeColumnItem(manualColumnFreezePlugin) {
  return {
    key: 'unfreeze_column',
    name: 'Unfreeze this column',
    callback: function() {
      var selectedColumn = this.getSelectedRange().from.col;
      manualColumnFreezePlugin.unfreezeColumn(selectedColumn);
      this.render();
      this.view.wt.wtOverlays.adjustElementsSize(true);
    },
    hidden: function() {
      var selection = this.getSelectedRange();
      var hide = false;
      if (selection === void 0) {
        hide = true;
      } else if ((selection.from.col !== selection.to.col) || selection.from.col >= this.getSettings().fixedColumnsLeft) {
        hide = true;
      }
      return hide;
    }
  };
}

//# 
},{}],95:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  ManualColumnFreeze: {get: function() {
      return ManualColumnFreeze;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__95_base__,
    $___46__46__47__46__46__47_plugins__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $__contextMenuItem_47_freezeColumn__,
    $__contextMenuItem_47_unfreezeColumn__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var BasePlugin = ($___46__46__47__95_base__ = _dereq_("_base"), $___46__46__47__95_base__ && $___46__46__47__95_base__.__esModule && $___46__46__47__95_base__ || {default: $___46__46__47__95_base__}).default;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
var arrayEach = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}).arrayEach;
var freezeColumnItem = ($__contextMenuItem_47_freezeColumn__ = _dereq_("contextMenuItem/freezeColumn"), $__contextMenuItem_47_freezeColumn__ && $__contextMenuItem_47_freezeColumn__.__esModule && $__contextMenuItem_47_freezeColumn__ || {default: $__contextMenuItem_47_freezeColumn__}).freezeColumnItem;
var unfreezeColumnItem = ($__contextMenuItem_47_unfreezeColumn__ = _dereq_("contextMenuItem/unfreezeColumn"), $__contextMenuItem_47_unfreezeColumn__ && $__contextMenuItem_47_unfreezeColumn__.__esModule && $__contextMenuItem_47_unfreezeColumn__ || {default: $__contextMenuItem_47_unfreezeColumn__}).unfreezeColumnItem;
var privatePool = new WeakMap();
var ManualColumnFreeze = function ManualColumnFreeze(hotInstance) {
  $traceurRuntime.superConstructor($ManualColumnFreeze).call(this, hotInstance);
  privatePool.set(this, {
    moveByFreeze: false,
    afterFirstUse: false
  });
  this.frozenColumnsBasePositions = [];
  this.manualColumnMovePlugin = void 0;
};
var $ManualColumnFreeze = ManualColumnFreeze;
($traceurRuntime.createClass)(ManualColumnFreeze, {
  isEnabled: function() {
    return !!this.hot.getSettings().manualColumnFreeze;
  },
  enablePlugin: function() {
    var $__6 = this;
    if (this.enabled) {
      return;
    }
    this.addHook('afterContextMenuDefaultOptions', (function(options) {
      return $__6.addContextMenuEntry(options);
    }));
    this.addHook('afterInit', (function() {
      return $__6.onAfterInit();
    }));
    this.addHook('beforeColumnMove', (function(rows, target) {
      return $__6.onBeforeColumnMove(rows, target);
    }));
    $traceurRuntime.superGet(this, $ManualColumnFreeze.prototype, "enablePlugin").call(this);
  },
  disablePlugin: function() {
    var priv = privatePool.get(this);
    priv.afterFirstUse = false;
    priv.moveByFreeze = false;
    $traceurRuntime.superGet(this, $ManualColumnFreeze.prototype, "disablePlugin").call(this);
  },
  updatePlugin: function() {
    this.disablePlugin();
    this.enablePlugin();
    $traceurRuntime.superGet(this, $ManualColumnFreeze.prototype, "updatePlugin").call(this);
  },
  freezeColumn: function(column) {
    var priv = privatePool.get(this);
    var settings = this.hot.getSettings();
    if (!priv.afterFirstUse) {
      priv.afterFirstUse = true;
    }
    if (settings.fixedColumnsLeft === this.hot.countCols() || column <= settings.fixedColumnsLeft - 1) {
      return;
    }
    priv.moveByFreeze = true;
    if (column !== this.getMovePlugin().columnsMapper.getValueByIndex(column)) {
      this.frozenColumnsBasePositions[settings.fixedColumnsLeft] = column;
    }
    this.getMovePlugin().moveColumn(column, settings.fixedColumnsLeft++);
  },
  unfreezeColumn: function(column) {
    var priv = privatePool.get(this);
    var settings = this.hot.getSettings();
    if (!priv.afterFirstUse) {
      priv.afterFirstUse = true;
    }
    if (settings.fixedColumnsLeft <= 0 || (column > settings.fixedColumnsLeft - 1)) {
      return;
    }
    var returnCol = this.getBestColumnReturnPosition(column);
    priv.moveByFreeze = true;
    settings.fixedColumnsLeft--;
    this.getMovePlugin().moveColumn(column, returnCol + 1);
  },
  getMovePlugin: function() {
    if (!this.manualColumnMovePlugin) {
      this.manualColumnMovePlugin = this.hot.getPlugin('manualColumnMove');
    }
    return this.manualColumnMovePlugin;
  },
  getBestColumnReturnPosition: function(column) {
    var movePlugin = this.getMovePlugin();
    var settings = this.hot.getSettings();
    var i = settings.fixedColumnsLeft;
    var j = movePlugin.columnsMapper.getValueByIndex(i);
    var initialCol;
    if (this.frozenColumnsBasePositions[column] == null) {
      initialCol = movePlugin.columnsMapper.getValueByIndex(column);
      while (j < initialCol) {
        i++;
        j = movePlugin.columnsMapper.getValueByIndex(i);
      }
    } else {
      initialCol = this.frozenColumnsBasePositions[column];
      this.frozenColumnsBasePositions[column] = void 0;
      while (j <= initialCol) {
        i++;
        j = movePlugin.columnsMapper.getValueByIndex(i);
      }
      i = j;
    }
    return i - 1;
  },
  addContextMenuEntry: function(options) {
    options.items.push(Handsontable.plugins.ContextMenu.SEPARATOR, freezeColumnItem(this), unfreezeColumnItem(this));
  },
  onAfterInit: function() {
    if (!this.getMovePlugin().isEnabled()) {
      this.getMovePlugin().enablePlugin();
    }
  },
  onBeforeColumnMove: function(rows, target) {
    var priv = privatePool.get(this);
    if (priv.afterFirstUse && !priv.moveByFreeze) {
      var frozenLen = this.hot.getSettings().fixedColumnsLeft;
      var disallowMoving = target < frozenLen;
      if (!disallowMoving) {
        arrayEach(rows, (function(value, index, array) {
          if (value < frozenLen) {
            disallowMoving = true;
            return false;
          }
        }));
      }
      if (disallowMoving) {
        return false;
      }
    }
    if (priv.moveByFreeze) {
      priv.moveByFreeze = false;
    }
  },
  destroy: function() {
    $traceurRuntime.superGet(this, $ManualColumnFreeze.prototype, "destroy").call(this);
  }
}, {}, BasePlugin);
;
registerPlugin('manualColumnFreeze', ManualColumnFreeze);

//# 
},{"_base":62,"browser":24,"contextMenuItem/freezeColumn":93,"contextMenuItem/unfreezeColumn":94,"helpers/array":43,"plugins":61}],96:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  ColumnsMapper: {get: function() {
      return ColumnsMapper;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__46__46__47_mixins_47_arrayMapper__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__46__46__47_helpers_47_object__,
    $___46__46__47__46__46__47_helpers_47_number__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var arrayMapper = ($___46__46__47__46__46__47_mixins_47_arrayMapper__ = _dereq_("mixins/arrayMapper"), $___46__46__47__46__46__47_mixins_47_arrayMapper__ && $___46__46__47__46__46__47_mixins_47_arrayMapper__.__esModule && $___46__46__47__46__46__47_mixins_47_arrayMapper__ || {default: $___46__46__47__46__46__47_mixins_47_arrayMapper__}).arrayMapper;
var arrayFilter = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}).arrayFilter;
var mixin = ($___46__46__47__46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47__46__46__47_helpers_47_object__ && $___46__46__47__46__46__47_helpers_47_object__.__esModule && $___46__46__47__46__46__47_helpers_47_object__ || {default: $___46__46__47__46__46__47_helpers_47_object__}).mixin;
var rangeEach = ($___46__46__47__46__46__47_helpers_47_number__ = _dereq_("helpers/number"), $___46__46__47__46__46__47_helpers_47_number__ && $___46__46__47__46__46__47_helpers_47_number__.__esModule && $___46__46__47__46__46__47_helpers_47_number__ || {default: $___46__46__47__46__46__47_helpers_47_number__}).rangeEach;
var ColumnsMapper = function ColumnsMapper(manualColumnMove) {
  this.manualColumnMove = manualColumnMove;
};
($traceurRuntime.createClass)(ColumnsMapper, {
  createMap: function(length) {
    var $__5 = this;
    var originLength = length === void 0 ? this._arrayMap.length : length;
    this._arrayMap.length = 0;
    rangeEach(originLength - 1, (function(itemIndex) {
      $__5._arrayMap[itemIndex] = itemIndex;
    }));
  },
  destroy: function() {
    this._arrayMap = null;
  },
  moveColumn: function(from, to) {
    var indexToMove = this._arrayMap[from];
    this._arrayMap[from] = null;
    this._arrayMap.splice(to, 0, indexToMove);
  },
  clearNull: function() {
    this._arrayMap = arrayFilter(this._arrayMap, (function(i) {
      return i !== null;
    }));
  }
}, {});
mixin(ColumnsMapper, arrayMapper);
;
Handsontable.utils.ManualColumnMoveColumnsMapper = ColumnsMapper;

//# 
},{"browser":24,"helpers/array":43,"helpers/number":52,"helpers/object":53,"mixins/arrayMapper":57}],97:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  ManualColumnMove: {get: function() {
      return ManualColumnMove;
    }},
  __esModule: {value: true}
});
var $___46__46__47__95_base_46_js__,
    $___46__46__47__46__46__47_browser__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47_helpers_47_number__,
    $___46__46__47__46__46__47_eventManager__,
    $___46__46__47__46__46__47_plugins__,
    $__columnsMapper__,
    $__ui_47_backlight__,
    $__ui_47_guideline__;
var BasePlugin = ($___46__46__47__95_base_46_js__ = _dereq_("_base.js"), $___46__46__47__95_base_46_js__ && $___46__46__47__95_base_46_js__.__esModule && $___46__46__47__95_base_46_js__ || {default: $___46__46__47__95_base_46_js__}).default;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var arrayEach = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}).arrayEach;
var $__3 = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}),
    addClass = $__3.addClass,
    removeClass = $__3.removeClass,
    offset = $__3.offset;
var rangeEach = ($___46__46__47__46__46__47_helpers_47_number__ = _dereq_("helpers/number"), $___46__46__47__46__46__47_helpers_47_number__ && $___46__46__47__46__46__47_helpers_47_number__.__esModule && $___46__46__47__46__46__47_helpers_47_number__ || {default: $___46__46__47__46__46__47_helpers_47_number__}).rangeEach;
var eventManagerObject = ($___46__46__47__46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47__46__46__47_eventManager__ && $___46__46__47__46__46__47_eventManager__.__esModule && $___46__46__47__46__46__47_eventManager__ || {default: $___46__46__47__46__46__47_eventManager__}).eventManager;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
var ColumnsMapper = ($__columnsMapper__ = _dereq_("columnsMapper"), $__columnsMapper__ && $__columnsMapper__.__esModule && $__columnsMapper__ || {default: $__columnsMapper__}).ColumnsMapper;
var BacklightUI = ($__ui_47_backlight__ = _dereq_("ui/backlight"), $__ui_47_backlight__ && $__ui_47_backlight__.__esModule && $__ui_47_backlight__ || {default: $__ui_47_backlight__}).BacklightUI;
var GuidelineUI = ($__ui_47_guideline__ = _dereq_("ui/guideline"), $__ui_47_guideline__ && $__ui_47_guideline__.__esModule && $__ui_47_guideline__ || {default: $__ui_47_guideline__}).GuidelineUI;
var privatePool = new WeakMap();
var CSS_PLUGIN = 'ht__manualColumnMove';
var CSS_SHOW_UI = 'show-ui';
var CSS_ON_MOVING = 'on-moving--columns';
var CSS_AFTER_SELECTION = 'after-selection--columns';
var ManualColumnMove = function ManualColumnMove(hotInstance) {
  $traceurRuntime.superConstructor($ManualColumnMove).call(this, hotInstance);
  privatePool.set(this, {
    columnsToMove: [],
    countCols: 0,
    fixedColumns: 0,
    pressed: void 0,
    disallowMoving: void 0,
    target: {
      eventPageX: void 0,
      coords: void 0,
      TD: void 0,
      col: void 0
    }
  });
  this.removedColumns = [];
  this.columnsMapper = new ColumnsMapper(this);
  this.eventManager = eventManagerObject(this);
  this.backlight = new BacklightUI(hotInstance);
  this.guideline = new GuidelineUI(hotInstance);
};
var $ManualColumnMove = ManualColumnMove;
($traceurRuntime.createClass)(ManualColumnMove, {
  isEnabled: function() {
    return !!this.hot.getSettings().manualColumnMove;
  },
  enablePlugin: function() {
    var $__10 = this;
    if (this.enabled) {
      return;
    }
    this.addHook('beforeOnCellMouseDown', (function(event, coords, TD, blockCalculations) {
      return $__10.onBeforeOnCellMouseDown(event, coords, TD, blockCalculations);
    }));
    this.addHook('beforeOnCellMouseOver', (function(event, coords, TD, blockCalculations) {
      return $__10.onBeforeOnCellMouseOver(event, coords, TD, blockCalculations);
    }));
    this.addHook('afterScrollVertically', (function() {
      return $__10.onAfterScrollVertically();
    }));
    this.addHook('modifyCol', (function(row, source) {
      return $__10.onModifyCol(row, source);
    }));
    this.addHook('beforeRemoveCol', (function(index, amount) {
      return $__10.onBeforeRemoveCol(index, amount);
    }));
    this.addHook('afterRemoveCol', (function(index, amount) {
      return $__10.onAfterRemoveCol(index, amount);
    }));
    this.addHook('afterCreateCol', (function(index, amount) {
      return $__10.onAfterCreateCol(index, amount);
    }));
    this.addHook('afterLoadData', (function(firstTime) {
      return $__10.onAfterLoadData(firstTime);
    }));
    this.addHook('unmodifyCol', (function(column) {
      return $__10.onUnmodifyCol(column);
    }));
    this.registerEvents();
    addClass(this.hot.rootElement, CSS_PLUGIN);
    $traceurRuntime.superGet(this, $ManualColumnMove.prototype, "enablePlugin").call(this);
  },
  updatePlugin: function() {
    this.disablePlugin();
    this.enablePlugin();
    this.onAfterPluginsInitialized();
    $traceurRuntime.superGet(this, $ManualColumnMove.prototype, "updatePlugin").call(this);
  },
  disablePlugin: function() {
    var pluginSettings = this.hot.getSettings().manualColumnMove;
    if (Array.isArray(pluginSettings)) {
      this.columnsMapper.clearMap();
    }
    removeClass(this.hot.rootElement, CSS_PLUGIN);
    this.unregisterEvents();
    this.backlight.destroy();
    this.guideline.destroy();
    $traceurRuntime.superGet(this, $ManualColumnMove.prototype, "disablePlugin").call(this);
  },
  moveColumn: function(column, target) {
    this.moveColumns([column], target);
  },
  moveColumns: function(columns, target) {
    var $__10 = this;
    var priv = privatePool.get(this);
    var beforeColumnHook = this.hot.runHooks('beforeColumnMove', columns, target);
    priv.disallowMoving = !beforeColumnHook;
    if (beforeColumnHook !== false) {
      arrayEach(columns, (function(column, index, array) {
        array[index] = $__10.columnsMapper.getValueByIndex(column);
      }));
      arrayEach(columns, (function(column, index) {
        var actualPosition = $__10.columnsMapper.getIndexByValue(column);
        if (actualPosition !== target) {
          $__10.columnsMapper.moveColumn(actualPosition, target + index);
        }
      }));
      this.columnsMapper.clearNull();
    }
    this.hot.runHooks('afterColumnMove', columns, target);
  },
  changeSelection: function(startColumn, endColumn) {
    var selection = this.hot.selection;
    var lastRowIndex = this.hot.countRows() - 1;
    selection.setRangeStartOnly(new WalkontableCellCoords(0, startColumn));
    selection.setRangeEnd(new WalkontableCellCoords(lastRowIndex, endColumn), false);
  },
  getColumnsWidth: function(from, to) {
    var width = 0;
    for (var i = from; i < to; i++) {
      var columnWidth = 0;
      if (i < 0) {
        columnWidth = this.hot.view.wt.wtTable.getColumnWidth(i) || 0;
      } else {
        columnWidth = this.hot.view.wt.wtTable.getStretchedColumnWidth(i) || 0;
      }
      width += columnWidth;
    }
    return width;
  },
  initialSettings: function() {
    var pluginSettings = this.hot.getSettings().manualColumnMove;
    if (Array.isArray(pluginSettings)) {
      this.moveColumns(pluginSettings, 0);
    } else if (pluginSettings !== void 0) {
      this.persistentStateLoad();
    }
  },
  isFixedColumnsLeft: function(column) {
    return column < this.hot.getSettings().fixedColumnsLeft;
  },
  persistentStateSave: function() {
    Handsontable.hooks.run(this.hot, 'persistentStateSave', 'manualColumnMove', this.columnsMapper._arrayMap);
  },
  persistentStateLoad: function() {
    var storedState = {};
    Handsontable.hooks.run(this.hot, 'persistentStateLoad', 'manualColumnMove', storedState);
    if (storedState.value) {
      this.columnsMapper._arrayMap = storedState.value;
    }
  },
  prepareColumnsToMoving: function(start, end) {
    var selectedColumns = [];
    rangeEach(start, end, (function(i) {
      selectedColumns.push(i);
    }));
    return selectedColumns;
  },
  refreshPositions: function() {
    var priv = privatePool.get(this);
    var firstVisible = this.hot.view.wt.wtTable.getFirstVisibleColumn();
    var lastVisible = this.hot.view.wt.wtTable.getLastVisibleColumn();
    var wtTable = this.hot.view.wt.wtTable;
    var scrollableElement = this.hot.view.wt.wtOverlays.scrollableElement;
    var scrollLeft = typeof scrollableElement.scrollX === 'number' ? scrollableElement.scrollX : scrollableElement.scrollLeft;
    var tdOffsetLeft = this.hot.view.THEAD.offsetLeft + this.getColumnsWidth(0, priv.coordsColumn);
    var mouseOffsetLeft = priv.target.eventPageX - (priv.rootElementOffset - (scrollableElement.scrollX === void 0 ? scrollLeft : 0));
    var hiderWidth = wtTable.hider.offsetWidth;
    var tbodyOffsetLeft = wtTable.TBODY.offsetLeft;
    var backlightElemMarginLeft = this.backlight.getOffset().left;
    var backlightElemWidth = this.backlight.getSize().width;
    var rowHeaderWidth = 0;
    if ((priv.rootElementOffset + wtTable.holder.offsetWidth + scrollLeft) < priv.target.eventPageX) {
      if (priv.coordsColumn < priv.countCols) {
        priv.coordsColumn++;
      }
    }
    if (priv.hasRowHeaders) {
      rowHeaderWidth = this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth;
    }
    if (this.isFixedColumnsLeft(priv.coordsColumn)) {
      tdOffsetLeft += scrollLeft;
    }
    tdOffsetLeft += rowHeaderWidth;
    if (priv.coordsColumn < 0) {
      if (priv.fixedColumns > 0) {
        priv.target.col = 0;
      } else {
        priv.target.col = firstVisible > 0 ? firstVisible - 1 : firstVisible;
      }
    } else if ((priv.target.TD.offsetWidth / 2 + tdOffsetLeft) <= mouseOffsetLeft) {
      var newCoordsCol = priv.coordsColumn >= priv.countCols ? priv.countCols - 1 : priv.coordsColumn;
      priv.target.col = newCoordsCol + 1;
      tdOffsetLeft += priv.target.TD.offsetWidth;
      if (priv.target.col > lastVisible) {
        this.hot.scrollViewportTo(void 0, lastVisible + 1, void 0, true);
      }
    } else {
      priv.target.col = priv.coordsColumn;
      if (priv.target.col <= firstVisible && priv.target.col >= priv.fixedColumns) {
        this.hot.scrollViewportTo(void 0, firstVisible - 1);
      }
    }
    if (priv.target.col <= firstVisible && priv.target.col >= priv.fixedColumns) {
      this.hot.scrollViewportTo(void 0, firstVisible - 1);
    }
    var backlightLeft = mouseOffsetLeft;
    var guidelineLeft = tdOffsetLeft;
    if (mouseOffsetLeft + backlightElemWidth + backlightElemMarginLeft >= hiderWidth) {
      backlightLeft = hiderWidth - backlightElemWidth - backlightElemMarginLeft;
    } else if (mouseOffsetLeft + backlightElemMarginLeft < tbodyOffsetLeft + rowHeaderWidth) {
      backlightLeft = tbodyOffsetLeft + rowHeaderWidth + Math.abs(backlightElemMarginLeft);
    }
    if (tdOffsetLeft >= hiderWidth - 1) {
      guidelineLeft = hiderWidth - 1;
    } else if (guidelineLeft === 0) {
      guidelineLeft = 1;
    } else if (scrollableElement.scrollX !== void 0 && priv.coordsColumn < priv.fixedColumns) {
      guidelineLeft = guidelineLeft - ((priv.rootElementOffset <= scrollableElement.scrollX) ? priv.rootElementOffset : 0);
    }
    this.backlight.setPosition(null, backlightLeft);
    this.guideline.setPosition(null, guidelineLeft);
  },
  updateColumnsMapper: function() {
    var countCols = this.hot.countSourceCols();
    var columnsMapperLen = this.columnsMapper._arrayMap.length;
    if (columnsMapperLen === 0) {
      this.columnsMapper.createMap(countCols || this.hot.getSettings().startCols);
    } else if (columnsMapperLen < countCols) {
      var diff = countCols - columnsMapperLen;
      this.columnsMapper.insertItems(columnsMapperLen, diff);
    } else if (columnsMapperLen > countCols) {
      var maxIndex = countCols - 1;
      var columnsToRemove = [];
      arrayEach(this.columnsMapper._arrayMap, (function(value, index, array) {
        if (value > maxIndex) {
          columnsToRemove.push(index);
        }
      }));
      this.columnsMapper.removeItems(columnsToRemove);
    }
  },
  registerEvents: function() {
    var $__10 = this;
    this.eventManager.addEventListener(document.documentElement, 'mousemove', (function(event) {
      return $__10.onMouseMove(event);
    }));
    this.eventManager.addEventListener(document.documentElement, 'mouseup', (function() {
      return $__10.onMouseUp();
    }));
  },
  unregisterEvents: function() {
    this.eventManager.clear();
  },
  onBeforeOnCellMouseDown: function(event, coords, TD, blockCalculations) {
    var wtTable = this.hot.view.wt.wtTable;
    var isHeaderSelection = this.hot.selection.selectedHeader.cols;
    var selection = this.hot.getSelectedRange();
    var priv = privatePool.get(this);
    var isSortingElement = event.realTarget.className.indexOf('columnSorting') > -1;
    if (!selection || !isHeaderSelection || priv.pressed || event.button !== 0 || isSortingElement) {
      priv.pressed = false;
      priv.columnsToMove.length = 0;
      removeClass(this.hot.rootElement, [CSS_ON_MOVING, CSS_SHOW_UI]);
      return;
    }
    var guidelineIsNotReady = this.guideline.isBuilt() && !this.guideline.isAppended();
    var backlightIsNotReady = this.backlight.isBuilt() && !this.backlight.isAppended();
    if (guidelineIsNotReady && backlightIsNotReady) {
      this.guideline.appendTo(wtTable.hider);
      this.backlight.appendTo(wtTable.hider);
    }
    var $__12 = selection,
        from = $__12.from,
        to = $__12.to;
    var start = Math.min(from.col, to.col);
    var end = Math.max(from.col, to.col);
    if (coords.row < 0 && (coords.col >= start && coords.col <= end)) {
      blockCalculations.column = true;
      priv.pressed = true;
      priv.target.eventPageX = event.pageX;
      priv.coordsColumn = coords.col;
      priv.target.TD = TD;
      priv.target.col = coords.col;
      priv.columnsToMove = this.prepareColumnsToMoving(start, end);
      priv.hasRowHeaders = !!this.hot.getSettings().rowHeaders;
      priv.countCols = this.hot.countCols();
      priv.fixedColumns = this.hot.getSettings().fixedColumnsLeft;
      priv.rootElementOffset = offset(this.hot.rootElement).left;
      var countColumnsFrom = priv.hasRowHeaders ? -1 : 0;
      var topPos = wtTable.holder.scrollTop + wtTable.getColumnHeaderHeight(0) + 1;
      var fixedColumns = coords.col < priv.fixedColumns;
      var scrollableElement = this.hot.view.wt.wtOverlays.scrollableElement;
      var wrapperIsWindow = scrollableElement.scrollX ? scrollableElement.scrollX - priv.rootElementOffset : 0;
      var mouseOffset = event.layerX - (fixedColumns ? wrapperIsWindow : 0);
      var leftOffset = Math.abs(this.getColumnsWidth(start, coords.col) + mouseOffset);
      this.backlight.setPosition(topPos, this.getColumnsWidth(countColumnsFrom, start) + leftOffset);
      this.backlight.setSize(this.getColumnsWidth(start, end + 1), wtTable.hider.offsetHeight - topPos);
      this.backlight.setOffset(null, leftOffset * -1);
      addClass(this.hot.rootElement, CSS_ON_MOVING);
    } else {
      removeClass(this.hot.rootElement, CSS_AFTER_SELECTION);
      priv.pressed = false;
      priv.columnsToMove.length = 0;
    }
  },
  onMouseMove: function(event) {
    var priv = privatePool.get(this);
    if (!priv.pressed) {
      return;
    }
    if (event.realTarget === this.backlight.element) {
      var width = this.backlight.getSize().width;
      this.backlight.setSize(0);
      setTimeout(function() {
        this.backlight.setPosition(width);
      });
    }
    priv.target.eventPageX = event.pageX;
    this.refreshPositions();
  },
  onBeforeOnCellMouseOver: function(event, coords, TD, blockCalculations) {
    var selectedRange = this.hot.getSelectedRange();
    var priv = privatePool.get(this);
    if (!selectedRange || !priv.pressed) {
      return;
    }
    if (priv.columnsToMove.indexOf(coords.col) > -1) {
      removeClass(this.hot.rootElement, CSS_SHOW_UI);
    } else {
      addClass(this.hot.rootElement, CSS_SHOW_UI);
    }
    blockCalculations.row = true;
    blockCalculations.column = true;
    blockCalculations.cell = true;
    priv.coordsColumn = coords.col;
    priv.target.TD = TD;
  },
  onMouseUp: function() {
    var priv = privatePool.get(this);
    priv.coordsColumn = void 0;
    priv.pressed = false;
    priv.backlightWidth = 0;
    removeClass(this.hot.rootElement, [CSS_ON_MOVING, CSS_SHOW_UI, CSS_AFTER_SELECTION]);
    if (this.hot.selection.selectedHeader.cols) {
      addClass(this.hot.rootElement, CSS_AFTER_SELECTION);
    }
    if (priv.columnsToMove.length < 1 || priv.target.col === void 0 || priv.columnsToMove.indexOf(priv.target.col) > -1) {
      return;
    }
    this.moveColumns(priv.columnsToMove, priv.target.col);
    this.persistentStateSave();
    this.hot.render();
    this.hot.view.wt.wtOverlays.adjustElementsSize(true);
    if (!priv.disallowMoving) {
      var selectionStart = this.columnsMapper.getIndexByValue(priv.columnsToMove[0]);
      var selectionEnd = this.columnsMapper.getIndexByValue(priv.columnsToMove[priv.columnsToMove.length - 1]);
      this.changeSelection(selectionStart, selectionEnd);
    }
    priv.columnsToMove.length = 0;
  },
  onAfterScrollVertically: function() {
    var wtTable = this.hot.view.wt.wtTable;
    var headerHeight = wtTable.getColumnHeaderHeight(0) + 1;
    var scrollTop = wtTable.holder.scrollTop;
    var posTop = headerHeight + scrollTop;
    this.backlight.setPosition(posTop);
    this.backlight.setSize(null, wtTable.hider.offsetHeight - posTop);
  },
  onAfterCreateCol: function(index, amount) {
    this.columnsMapper.shiftItems(index, amount);
  },
  onBeforeRemoveCol: function(index, amount) {
    var $__10 = this;
    this.removedColumns.length = 0;
    if (index !== false) {
      rangeEach(index, index + amount - 1, (function(removedIndex) {
        $__10.removedColumns.push($__10.hot.runHooks('modifyCol', removedIndex, $__10.pluginName));
      }));
    }
  },
  onAfterRemoveCol: function(index, amount) {
    this.columnsMapper.unshiftItems(this.removedColumns);
  },
  onAfterLoadData: function(firstTime) {
    this.updateColumnsMapper();
  },
  onModifyCol: function(column, source) {
    if (source !== this.pluginName) {
      var columnInMapper = this.columnsMapper.getValueByIndex(column);
      column = columnInMapper === null ? column : columnInMapper;
    }
    return column;
  },
  onUnmodifyCol: function(column) {
    var indexInMapper = this.columnsMapper.getIndexByValue(column);
    return indexInMapper === null ? column : indexInMapper;
  },
  onAfterPluginsInitialized: function() {
    this.updateColumnsMapper();
    this.initialSettings();
    this.backlight.build();
    this.guideline.build();
  },
  destroy: function() {
    this.backlight.destroy();
    this.guideline.destroy();
    $traceurRuntime.superGet(this, $ManualColumnMove.prototype, "destroy").call(this);
  }
}, {}, BasePlugin);
;
registerPlugin('ManualColumnMove', ManualColumnMove);
Handsontable.hooks.register('beforeColumnMove');
Handsontable.hooks.register('afterColumnMove');
Handsontable.hooks.register('unmodifyCol');

//# 
},{"_base.js":62,"browser":24,"columnsMapper":96,"eventManager":42,"helpers/array":43,"helpers/dom/element":47,"helpers/number":52,"plugins":61,"ui/backlight":99,"ui/guideline":100}],98:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  BaseUI: {get: function() {
      return BaseUI;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47__46__46__47_helpers_47_number__;
var isNumeric = ($___46__46__47__46__46__47__46__46__47_helpers_47_number__ = _dereq_("helpers/number"), $___46__46__47__46__46__47__46__46__47_helpers_47_number__ && $___46__46__47__46__46__47__46__46__47_helpers_47_number__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_number__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_number__}).isNumeric;
var STATE_INITIALIZED = 0;
var STATE_BUILT = 1;
var STATE_APPENDED = 2;
var UNIT = 'px';
var BaseUI = function BaseUI(hotInstance) {
  this.hot = hotInstance;
  this._element = null;
  this.state = STATE_INITIALIZED;
};
($traceurRuntime.createClass)(BaseUI, {
  appendTo: function(wrapper) {
    wrapper.appendChild(this._element);
    this.state = STATE_APPENDED;
  },
  build: function() {
    this._element = document.createElement('div');
    this.state = STATE_BUILT;
  },
  destroy: function() {
    if (this.isAppended()) {
      this._element.parentElement.removeChild(this._element);
    }
    this._element = null;
    this.state = STATE_INITIALIZED;
  },
  isAppended: function() {
    return this.state === STATE_APPENDED;
  },
  isBuilt: function() {
    return this.state >= STATE_BUILT;
  },
  setPosition: function(top, left) {
    if (isNumeric(top)) {
      this._element.style.top = top + UNIT;
    }
    if (isNumeric(left)) {
      this._element.style.left = left + UNIT;
    }
  },
  getPosition: function() {
    return {
      top: this._element.style.top ? parseInt(this._element.style.top, 10) : 0,
      left: this._element.style.left ? parseInt(this._element.style.left, 10) : 0
    };
  },
  setSize: function(width, height) {
    if (isNumeric(width)) {
      this._element.style.width = width + UNIT;
    }
    if (isNumeric(height)) {
      this._element.style.height = height + UNIT;
    }
  },
  getSize: function() {
    return {
      width: this._element.style.width ? parseInt(this._element.style.width, 10) : 0,
      height: this._element.style.height ? parseInt(this._element.style.height, 10) : 0
    };
  },
  setOffset: function(top, left) {
    if (isNumeric(top)) {
      this._element.style.marginTop = top + UNIT;
    }
    if (isNumeric(left)) {
      this._element.style.marginLeft = left + UNIT;
    }
  },
  getOffset: function() {
    return {
      top: this._element.style.marginTop ? parseInt(this._element.style.marginTop, 10) : 0,
      left: this._element.style.marginLeft ? parseInt(this._element.style.marginLeft, 10) : 0
    };
  }
}, {});
;

//# 
},{"helpers/number":52}],99:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  BacklightUI: {get: function() {
      return BacklightUI;
    }},
  __esModule: {value: true}
});
var $___95_base__,
    $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__;
var BaseUI = ($___95_base__ = _dereq_("_base"), $___95_base__ && $___95_base__.__esModule && $___95_base__ || {default: $___95_base__}).BaseUI;
var addClass = ($___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}).addClass;
var CSS_CLASSNAME = 'ht__manualColumnMove--backlight';
var BacklightUI = function BacklightUI(hotInstance) {
  $traceurRuntime.superConstructor($BacklightUI).call(this, hotInstance);
};
var $BacklightUI = BacklightUI;
($traceurRuntime.createClass)(BacklightUI, {build: function() {
    $traceurRuntime.superGet(this, $BacklightUI.prototype, "build").call(this);
    addClass(this._element, CSS_CLASSNAME);
  }}, {}, BaseUI);
;

//# 
},{"_base":98,"helpers/dom/element":47}],100:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  GuidelineUI: {get: function() {
      return GuidelineUI;
    }},
  __esModule: {value: true}
});
var $___95_base__,
    $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__;
var BaseUI = ($___95_base__ = _dereq_("_base"), $___95_base__ && $___95_base__.__esModule && $___95_base__ || {default: $___95_base__}).BaseUI;
var addClass = ($___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}).addClass;
var CSS_CLASSNAME = 'ht__manualColumnMove--guideline';
var GuidelineUI = function GuidelineUI(hotInstance) {
  $traceurRuntime.superConstructor($GuidelineUI).call(this, hotInstance);
};
var $GuidelineUI = GuidelineUI;
($traceurRuntime.createClass)(GuidelineUI, {build: function() {
    $traceurRuntime.superGet(this, $GuidelineUI.prototype, "build").call(this);
    addClass(this._element, CSS_CLASSNAME);
  }}, {}, BaseUI);
;

//# 
},{"_base":98,"helpers/dom/element":47}],101:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  ManualColumnResize: {get: function() {
      return ManualColumnResize;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__95_base_46_js__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47_eventManager__,
    $___46__46__47__46__46__47_helpers_47_dom_47_event__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__46__46__47_helpers_47_number__,
    $___46__46__47__46__46__47_plugins__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var BasePlugin = ($___46__46__47__95_base_46_js__ = _dereq_("_base.js"), $___46__46__47__95_base_46_js__ && $___46__46__47__95_base_46_js__.__esModule && $___46__46__47__95_base_46_js__ || {default: $___46__46__47__95_base_46_js__}).default;
var $__2 = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}),
    addClass = $__2.addClass,
    hasClass = $__2.hasClass,
    removeClass = $__2.removeClass,
    outerHeight = $__2.outerHeight;
var eventManagerObject = ($___46__46__47__46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47__46__46__47_eventManager__ && $___46__46__47__46__46__47_eventManager__.__esModule && $___46__46__47__46__46__47_eventManager__ || {default: $___46__46__47__46__46__47_eventManager__}).eventManager;
var $__4 = ($___46__46__47__46__46__47_helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $___46__46__47__46__46__47_helpers_47_dom_47_event__ && $___46__46__47__46__46__47_helpers_47_dom_47_event__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_event__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_event__}),
    pageX = $__4.pageX,
    pageY = $__4.pageY;
var arrayEach = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}).arrayEach;
var rangeEach = ($___46__46__47__46__46__47_helpers_47_number__ = _dereq_("helpers/number"), $___46__46__47__46__46__47_helpers_47_number__ && $___46__46__47__46__46__47_helpers_47_number__.__esModule && $___46__46__47__46__46__47_helpers_47_number__ || {default: $___46__46__47__46__46__47_helpers_47_number__}).rangeEach;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
var ManualColumnResize = function ManualColumnResize(hotInstance) {
  $traceurRuntime.superConstructor($ManualColumnResize).call(this, hotInstance);
  this.currentTH = null;
  this.currentCol = null;
  this.selectedCols = [];
  this.currentWidth = null;
  this.newSize = null;
  this.startY = null;
  this.startWidth = null;
  this.startOffset = null;
  this.handle = document.createElement('DIV');
  this.guide = document.createElement('DIV');
  this.eventManager = eventManagerObject(this);
  this.pressed = null;
  this.dblclick = 0;
  this.autoresizeTimeout = null;
  this.manualColumnWidths = [];
  addClass(this.handle, 'manualColumnResizer');
  addClass(this.guide, 'manualColumnResizerGuide');
};
var $ManualColumnResize = ManualColumnResize;
($traceurRuntime.createClass)(ManualColumnResize, {
  isEnabled: function() {
    return this.hot.getSettings().manualColumnResize;
  },
  enablePlugin: function() {
    var $__8 = this;
    if (this.enabled) {
      return;
    }
    this.manualColumnWidths = [];
    var initialColumnWidth = this.hot.getSettings().manualColumnResize;
    var loadedManualColumnWidths = this.loadManualColumnWidths();
    this.addHook('modifyColWidth', (function(width, col) {
      return $__8.onModifyColWidth(width, col);
    }));
    this.addHook('beforeStretchingColumnWidth', (function(stretchedWidth, column) {
      return $__8.onBeforeStretchingColumnWidth(stretchedWidth, column);
    }));
    this.addHook('beforeColumnResize', (function(currentColumn, newSize, isDoubleClick) {
      return $__8.onBeforeColumnResize(currentColumn, newSize, isDoubleClick);
    }));
    if (typeof loadedManualColumnWidths != 'undefined') {
      this.manualColumnWidths = loadedManualColumnWidths;
    } else if (Array.isArray(initialColumnWidth)) {
      this.manualColumnWidths = initialColumnWidth;
    } else {
      this.manualColumnWidths = [];
    }
    Handsontable.hooks.register('beforeColumnResize');
    Handsontable.hooks.register('afterColumnResize');
    this.bindEvents();
    $traceurRuntime.superGet(this, $ManualColumnResize.prototype, "enablePlugin").call(this);
  },
  updatePlugin: function() {
    var initialColumnWidth = this.hot.getSettings().manualColumnResize;
    if (Array.isArray(initialColumnWidth)) {
      this.manualColumnWidths = initialColumnWidth;
    } else if (!initialColumnWidth) {
      this.manualColumnWidths = [];
    }
  },
  disablePlugin: function() {
    $traceurRuntime.superGet(this, $ManualColumnResize.prototype, "disablePlugin").call(this);
  },
  saveManualColumnWidths: function() {
    this.hot.runHooks('persistentStateSave', 'manualColumnWidths', this.manualColumnWidths);
  },
  loadManualColumnWidths: function() {
    var storedState = {};
    this.hot.runHooks('persistentStateLoad', 'manualColumnWidths', storedState);
    return storedState.value;
  },
  setupHandlePosition: function(TH) {
    var $__8 = this;
    if (!TH.parentNode) {
      return false;
    }
    this.currentTH = TH;
    var col = this.hot.view.wt.wtTable.getCoords(TH).col;
    var headerHeight = outerHeight(this.currentTH);
    if (col >= 0) {
      var box = this.currentTH.getBoundingClientRect();
      this.currentCol = col;
      this.selectedCols = [];
      if (this.hot.selection.isSelected() && this.hot.selection.selectedHeader.cols) {
        var $__10 = this.hot.getSelectedRange(),
            from = $__10.from,
            to = $__10.to;
        var start = from.col;
        var end = to.col;
        if (start >= end) {
          start = to.col;
          end = from.col;
        }
        if (this.currentCol >= start && this.currentCol <= end) {
          rangeEach(start, end, (function(i) {
            return $__8.selectedCols.push(i);
          }));
        } else {
          this.selectedCols.push(this.currentCol);
        }
      } else {
        this.selectedCols.push(this.currentCol);
      }
      this.startOffset = box.left - 6;
      this.startWidth = parseInt(box.width, 10);
      this.handle.style.top = box.top + 'px';
      this.handle.style.left = this.startOffset + this.startWidth + 'px';
      this.handle.style.height = headerHeight + 'px';
      this.hot.rootElement.appendChild(this.handle);
    }
  },
  refreshHandlePosition: function() {
    this.handle.style.left = this.startOffset + this.currentWidth + 'px';
  },
  setupGuidePosition: function() {
    var handleHeight = parseInt(outerHeight(this.handle), 10);
    var handleBottomPosition = parseInt(this.handle.style.top, 10) + handleHeight;
    var maximumVisibleElementHeight = parseInt(this.hot.view.maximumVisibleElementHeight(0), 10);
    addClass(this.handle, 'active');
    addClass(this.guide, 'active');
    this.guide.style.top = handleBottomPosition + 'px';
    this.guide.style.left = this.handle.style.left;
    this.guide.style.height = (maximumVisibleElementHeight - handleHeight) + 'px';
    this.hot.rootElement.appendChild(this.guide);
  },
  refreshGuidePosition: function() {
    this.guide.style.left = this.handle.style.left;
  },
  hideHandleAndGuide: function() {
    removeClass(this.handle, 'active');
    removeClass(this.guide, 'active');
  },
  checkIfColumnHeader: function(element) {
    if (element != this.hot.rootElement) {
      var parent = element.parentNode;
      if (parent.tagName === 'THEAD') {
        return true;
      }
      return this.checkIfColumnHeader(parent);
    }
    return false;
  },
  getTHFromTargetElement: function(element) {
    if (element.tagName != 'TABLE') {
      if (element.tagName == 'TH') {
        return element;
      } else {
        return this.getTHFromTargetElement(element.parentNode);
      }
    }
    return null;
  },
  onMouseOver: function(event) {
    if (this.checkIfColumnHeader(event.target)) {
      var th = this.getTHFromTargetElement(event.target);
      if (!th) {
        return;
      }
      var colspan = th.getAttribute('colspan');
      if (th && (colspan === null || colspan === 1)) {
        if (!this.pressed) {
          this.setupHandlePosition(th);
        }
      }
    }
  },
  afterMouseDownTimeout: function() {
    var $__8 = this;
    var render = (function() {
      $__8.hot.forceFullRender = true;
      $__8.hot.view.render();
      $__8.hot.view.wt.wtOverlays.adjustElementsSize(true);
    });
    var resize = (function(selectedCol, forceRender) {
      var hookNewSize = $__8.hot.runHooks('beforeColumnResize', selectedCol, $__8.newSize, true);
      if (hookNewSize !== void 0) {
        $__8.newSize = hookNewSize;
      }
      if ($__8.hot.getSettings().stretchH === 'all') {
        $__8.clearManualSize(selectedCol);
      } else {
        $__8.setManualSize(selectedCol, $__8.newSize);
      }
      if (forceRender) {
        render();
      }
      $__8.saveManualColumnWidths();
      $__8.hot.runHooks('afterColumnResize', selectedCol, $__8.newSize, true);
    });
    if (this.dblclick >= 2) {
      var selectedColsLength = this.selectedCols.length;
      if (selectedColsLength > 1) {
        arrayEach(this.selectedCols, (function(selectedCol) {
          resize(selectedCol);
        }));
        render();
      } else {
        arrayEach(this.selectedCols, (function(selectedCol) {
          resize(selectedCol, true);
        }));
      }
    }
    this.dblclick = 0;
    this.autoresizeTimeout = null;
  },
  onMouseDown: function(event) {
    var $__8 = this;
    if (hasClass(event.target, 'manualColumnResizer')) {
      this.setupGuidePosition();
      this.pressed = this.hot;
      if (this.autoresizeTimeout === null) {
        this.autoresizeTimeout = setTimeout((function() {
          return $__8.afterMouseDownTimeout();
        }), 500);
        this.hot._registerTimeout(this.autoresizeTimeout);
      }
      this.dblclick++;
      this.startX = pageX(event);
      this.newSize = this.startWidth;
    }
  },
  onMouseMove: function(event) {
    var $__8 = this;
    if (this.pressed) {
      this.currentWidth = this.startWidth + (pageX(event) - this.startX);
      arrayEach(this.selectedCols, (function(selectedCol) {
        $__8.newSize = $__8.setManualSize(selectedCol, $__8.currentWidth);
      }));
      this.refreshHandlePosition();
      this.refreshGuidePosition();
    }
  },
  onMouseUp: function(event) {
    var $__8 = this;
    var render = (function() {
      $__8.hot.forceFullRender = true;
      $__8.hot.view.render();
      $__8.hot.view.wt.wtOverlays.adjustElementsSize(true);
    });
    var resize = (function(selectedCol, forceRender) {
      $__8.hot.runHooks('beforeColumnResize', selectedCol, $__8.newSize);
      if (forceRender) {
        render();
      }
      $__8.saveManualColumnWidths();
      $__8.hot.runHooks('afterColumnResize', selectedCol, $__8.newSize);
    });
    if (this.pressed) {
      this.hideHandleAndGuide();
      this.pressed = false;
      if (this.newSize != this.startWidth) {
        var selectedColsLength = this.selectedCols.length;
        if (selectedColsLength > 1) {
          arrayEach(this.selectedCols, (function(selectedCol) {
            resize(selectedCol);
          }));
          render();
        } else {
          arrayEach(this.selectedCols, (function(selectedCol) {
            resize(selectedCol, true);
          }));
        }
      }
      this.setupHandlePosition(this.currentTH);
    }
  },
  bindEvents: function() {
    var $__8 = this;
    this.eventManager.addEventListener(this.hot.rootElement, 'mouseover', (function(e) {
      return $__8.onMouseOver(e);
    }));
    this.eventManager.addEventListener(this.hot.rootElement, 'mousedown', (function(e) {
      return $__8.onMouseDown(e);
    }));
    this.eventManager.addEventListener(window, 'mousemove', (function(e) {
      return $__8.onMouseMove(e);
    }));
    this.eventManager.addEventListener(window, 'mouseup', (function(e) {
      return $__8.onMouseUp(e);
    }));
  },
  setManualSize: function(column, width) {
    width = Math.max(width, 20);
    column = this.hot.runHooks('modifyCol', column);
    this.manualColumnWidths[column] = width;
    return width;
  },
  clearManualSize: function(column) {
    column = this.hot.runHooks('modifyCol', column);
    this.manualColumnWidths[column] = void 0;
  },
  onModifyColWidth: function(width, column) {
    if (this.enabled) {
      column = this.hot.runHooks('modifyCol', column);
      if (this.hot.getSettings().manualColumnResize && this.manualColumnWidths[column]) {
        return this.manualColumnWidths[column];
      }
    }
    return width;
  },
  onBeforeStretchingColumnWidth: function(stretchedWidth, column) {
    var width = this.manualColumnWidths[column];
    if (width === void 0) {
      width = stretchedWidth;
    }
    return width;
  },
  onBeforeColumnResize: function() {
    this.hot.view.wt.wtViewport.hasOversizedColumnHeadersMarked = {};
  }
}, {}, BasePlugin);
;
registerPlugin('manualColumnResize', ManualColumnResize);

//# 
},{"_base.js":62,"browser":24,"eventManager":42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/number":52,"plugins":61}],102:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  ManualRowMove: {get: function() {
      return ManualRowMove;
    }},
  __esModule: {value: true}
});
var $___46__46__47__95_base_46_js__,
    $___46__46__47__46__46__47_browser__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47_helpers_47_number__,
    $___46__46__47__46__46__47_eventManager__,
    $___46__46__47__46__46__47_plugins__,
    $__rowsMapper__,
    $__ui_47_backlight__,
    $__ui_47_guideline__;
var BasePlugin = ($___46__46__47__95_base_46_js__ = _dereq_("_base.js"), $___46__46__47__95_base_46_js__ && $___46__46__47__95_base_46_js__.__esModule && $___46__46__47__95_base_46_js__ || {default: $___46__46__47__95_base_46_js__}).default;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var arrayEach = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}).arrayEach;
var $__3 = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}),
    addClass = $__3.addClass,
    removeClass = $__3.removeClass,
    offset = $__3.offset;
var rangeEach = ($___46__46__47__46__46__47_helpers_47_number__ = _dereq_("helpers/number"), $___46__46__47__46__46__47_helpers_47_number__ && $___46__46__47__46__46__47_helpers_47_number__.__esModule && $___46__46__47__46__46__47_helpers_47_number__ || {default: $___46__46__47__46__46__47_helpers_47_number__}).rangeEach;
var eventManagerObject = ($___46__46__47__46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47__46__46__47_eventManager__ && $___46__46__47__46__46__47_eventManager__.__esModule && $___46__46__47__46__46__47_eventManager__ || {default: $___46__46__47__46__46__47_eventManager__}).eventManager;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
var RowsMapper = ($__rowsMapper__ = _dereq_("rowsMapper"), $__rowsMapper__ && $__rowsMapper__.__esModule && $__rowsMapper__ || {default: $__rowsMapper__}).RowsMapper;
var BacklightUI = ($__ui_47_backlight__ = _dereq_("ui/backlight"), $__ui_47_backlight__ && $__ui_47_backlight__.__esModule && $__ui_47_backlight__ || {default: $__ui_47_backlight__}).BacklightUI;
var GuidelineUI = ($__ui_47_guideline__ = _dereq_("ui/guideline"), $__ui_47_guideline__ && $__ui_47_guideline__.__esModule && $__ui_47_guideline__ || {default: $__ui_47_guideline__}).GuidelineUI;
var privatePool = new WeakMap();
var CSS_PLUGIN = 'ht__manualRowMove';
var CSS_SHOW_UI = 'show-ui';
var CSS_ON_MOVING = 'on-moving--rows';
var CSS_AFTER_SELECTION = 'after-selection--rows';
var ManualRowMove = function ManualRowMove(hotInstance) {
  $traceurRuntime.superConstructor($ManualRowMove).call(this, hotInstance);
  privatePool.set(this, {
    rowsToMove: [],
    pressed: void 0,
    disallowMoving: void 0,
    target: {
      eventPageY: void 0,
      coords: void 0,
      TD: void 0,
      row: void 0
    }
  });
  this.removedRows = [];
  this.rowsMapper = new RowsMapper(this);
  this.eventManager = eventManagerObject(this);
  this.backlight = new BacklightUI(hotInstance);
  this.guideline = new GuidelineUI(hotInstance);
};
var $ManualRowMove = ManualRowMove;
($traceurRuntime.createClass)(ManualRowMove, {
  isEnabled: function() {
    return !!this.hot.getSettings().manualRowMove;
  },
  enablePlugin: function() {
    var $__10 = this;
    if (this.enabled) {
      return;
    }
    this.addHook('beforeOnCellMouseDown', (function(event, coords, TD, blockCalculations) {
      return $__10.onBeforeOnCellMouseDown(event, coords, TD, blockCalculations);
    }));
    this.addHook('beforeOnCellMouseOver', (function(event, coords, TD, blockCalculations) {
      return $__10.onBeforeOnCellMouseOver(event, coords, TD, blockCalculations);
    }));
    this.addHook('afterScrollHorizontally', (function() {
      return $__10.onAfterScrollHorizontally();
    }));
    this.addHook('modifyRow', (function(row, source) {
      return $__10.onModifyRow(row, source);
    }));
    this.addHook('beforeRemoveRow', (function(index, amount) {
      return $__10.onBeforeRemoveRow(index, amount);
    }));
    this.addHook('afterRemoveRow', (function(index, amount) {
      return $__10.onAfterRemoveRow(index, amount);
    }));
    this.addHook('afterCreateRow', (function(index, amount) {
      return $__10.onAfterCreateRow(index, amount);
    }));
    this.addHook('afterLoadData', (function(firstTime) {
      return $__10.onAfterLoadData(firstTime);
    }));
    this.addHook('beforeColumnSort', (function(column, order) {
      return $__10.onBeforeColumnSort(column, order);
    }));
    this.addHook('unmodifyRow', (function(row) {
      return $__10.onUnmodifyRow(row);
    }));
    this.registerEvents();
    addClass(this.hot.rootElement, CSS_PLUGIN);
    $traceurRuntime.superGet(this, $ManualRowMove.prototype, "enablePlugin").call(this);
  },
  updatePlugin: function() {
    this.disablePlugin();
    this.enablePlugin();
    this.onAfterPluginsInitialized();
    $traceurRuntime.superGet(this, $ManualRowMove.prototype, "updatePlugin").call(this);
  },
  disablePlugin: function() {
    var pluginSettings = this.hot.getSettings().manualRowMove;
    if (Array.isArray(pluginSettings)) {
      this.rowsMapper.clearMap();
    }
    removeClass(this.hot.rootElement, CSS_PLUGIN);
    this.unregisterEvents();
    this.backlight.destroy();
    this.guideline.destroy();
    $traceurRuntime.superGet(this, $ManualRowMove.prototype, "disablePlugin").call(this);
  },
  moveRow: function(row, target) {
    this.moveRows([row], target);
  },
  moveRows: function(rows, target) {
    var $__10 = this;
    var priv = privatePool.get(this);
    var beforeMoveHook = this.hot.runHooks('beforeRowMove', rows, target);
    priv.disallowMoving = beforeMoveHook === false;
    if (!priv.disallowMoving) {
      arrayEach(rows, (function(row, index, array) {
        array[index] = $__10.rowsMapper.getValueByIndex(row);
      }));
      arrayEach(rows, (function(row, index) {
        var actualPosition = $__10.rowsMapper.getIndexByValue(row);
        if (actualPosition !== target) {
          $__10.rowsMapper.moveRow(actualPosition, target + index);
        }
      }));
      this.rowsMapper.clearNull();
    }
    this.hot.runHooks('afterRowMove', rows, target);
  },
  changeSelection: function(startRow, endRow) {
    var selection = this.hot.selection;
    var lastColIndex = this.hot.countCols() - 1;
    selection.setRangeStartOnly(new WalkontableCellCoords(startRow, 0));
    selection.setRangeEnd(new WalkontableCellCoords(endRow, lastColIndex), false);
  },
  getRowsHeight: function(from, to) {
    var height = 0;
    for (var i = from; i < to; i++) {
      var rowHeight = this.hot.view.wt.wtTable.getRowHeight(i) || 23;
      height += rowHeight;
    }
    return height;
  },
  initialSettings: function() {
    var pluginSettings = this.hot.getSettings().manualRowMove;
    if (Array.isArray(pluginSettings)) {
      this.moveRows(pluginSettings, 0);
    } else if (pluginSettings !== void 0) {
      var persistentState = this.persistentStateLoad();
      if (persistentState.length) {
        this.moveRows(persistentState, 0);
      }
    }
  },
  isFixedRowTop: function(row) {
    return row < this.hot.getSettings().fixedRowsTop;
  },
  isFixedRowBottom: function(row) {
    return row > this.hot.getSettings().fixedRowsBottom;
  },
  persistentStateSave: function() {
    Handsontable.hooks.run(this.hot, 'persistentStateSave', 'manualRowMove', this.rowsMapper._arrayMap);
  },
  persistentStateLoad: function() {
    var storedState = {};
    Handsontable.hooks.run(this.hot, 'persistentStateLoad', 'manualRowMove', storedState);
    return storedState.value ? storedState.value : [];
  },
  prepareRowsToMoving: function() {
    var selection = this.hot.getSelectedRange();
    var selectedRows = [];
    if (!selection) {
      return selectedRows;
    }
    var $__12 = selection,
        from = $__12.from,
        to = $__12.to;
    var start = Math.min(from.row, to.row);
    var end = Math.max(from.row, to.row);
    rangeEach(start, end, (function(i) {
      selectedRows.push(i);
    }));
    return selectedRows;
  },
  refreshPositions: function() {
    var priv = privatePool.get(this);
    var coords = priv.target.coords;
    var firstVisible = this.hot.view.wt.wtTable.getFirstVisibleRow();
    var lastVisible = this.hot.view.wt.wtTable.getLastVisibleRow();
    var fixedRows = this.hot.getSettings().fixedRowsTop;
    var countRows = this.hot.countRows();
    if (coords.row < fixedRows && firstVisible > 0) {
      this.hot.scrollViewportTo(firstVisible - 1);
    }
    if (coords.row >= lastVisible && lastVisible < countRows) {
      this.hot.scrollViewportTo(lastVisible + 1, undefined, true);
    }
    var wtTable = this.hot.view.wt.wtTable;
    var TD = priv.target.TD;
    var rootElementOffset = offset(this.hot.rootElement);
    var tdOffsetTop = this.hot.view.THEAD.offsetHeight + this.getRowsHeight(0, coords.row);
    var mouseOffsetTop = priv.target.eventPageY - rootElementOffset.top + wtTable.holder.scrollTop;
    var hiderHeight = wtTable.hider.offsetHeight;
    var tbodyOffsetTop = wtTable.TBODY.offsetTop;
    var backlightElemMarginTop = this.backlight.getOffset().top;
    var backlightElemHeight = this.backlight.getSize().height;
    if ((rootElementOffset.top + wtTable.holder.offsetHeight) < priv.target.eventPageY) {
      priv.target.coords.row++;
    }
    if (this.isFixedRowTop(coords.row)) {
      tdOffsetTop += wtTable.holder.scrollTop;
    }
    if (coords.row < 0) {
      priv.target.row = firstVisible > 0 ? firstVisible - 1 : firstVisible;
    } else if (TD.offsetHeight / 2 + tdOffsetTop <= mouseOffsetTop) {
      priv.target.row = coords.row + 1;
      tdOffsetTop += coords.row === 0 ? TD.offsetHeight - 1 : TD.offsetHeight;
    } else {
      priv.target.row = coords.row;
    }
    var backlightTop = mouseOffsetTop;
    var guidelineTop = tdOffsetTop;
    if (mouseOffsetTop + backlightElemHeight + backlightElemMarginTop >= hiderHeight) {
      backlightTop = hiderHeight - backlightElemHeight - backlightElemMarginTop;
    } else if (mouseOffsetTop + backlightElemMarginTop < tbodyOffsetTop) {
      backlightTop = tbodyOffsetTop + Math.abs(backlightElemMarginTop);
    }
    if (tdOffsetTop >= hiderHeight - 1) {
      guidelineTop = hiderHeight - 1;
    }
    var topOverlayHeight = 0;
    if (this.hot.view.wt.wtOverlays.topOverlay) {
      topOverlayHeight = this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight;
    }
    if (coords.row >= fixedRows && (guidelineTop - wtTable.holder.scrollTop) < topOverlayHeight) {
      this.hot.scrollViewportTo(coords.row);
    }
    this.backlight.setPosition(backlightTop);
    this.guideline.setPosition(guidelineTop);
  },
  updateRowsMapper: function() {
    var countRows = this.hot.countSourceRows();
    var rowsMapperLen = this.rowsMapper._arrayMap.length;
    if (rowsMapperLen === 0) {
      this.rowsMapper.createMap(countRows || this.hot.getSettings().startRows);
    } else if (rowsMapperLen < countRows) {
      var diff = countRows - rowsMapperLen;
      this.rowsMapper.insertItems(rowsMapperLen, diff);
    } else if (rowsMapperLen > countRows) {
      var maxIndex = countRows - 1;
      var rowsToRemove = [];
      arrayEach(this.rowsMapper._arrayMap, (function(value, index, array) {
        if (value > maxIndex) {
          rowsToRemove.push(index);
        }
      }));
      this.rowsMapper.removeItems(rowsToRemove);
    }
  },
  registerEvents: function() {
    var $__10 = this;
    this.eventManager.addEventListener(document.documentElement, 'mousemove', (function(event) {
      return $__10.onMouseMove(event);
    }));
    this.eventManager.addEventListener(document.documentElement, 'mouseup', (function() {
      return $__10.onMouseUp();
    }));
  },
  unregisterEvents: function() {
    this.eventManager.clear();
  },
  onBeforeColumnSort: function(column, order) {
    var priv = privatePool.get(this);
    priv.disallowMoving = order !== void 0;
  },
  onBeforeOnCellMouseDown: function(event, coords, TD, blockCalculations) {
    var wtTable = this.hot.view.wt.wtTable;
    var isHeaderSelection = this.hot.selection.selectedHeader.rows;
    var selection = this.hot.getSelectedRange();
    var priv = privatePool.get(this);
    if (!selection || !isHeaderSelection || priv.pressed || event.button !== 0) {
      priv.pressed = false;
      priv.rowsToMove.length = 0;
      removeClass(this.hot.rootElement, [CSS_ON_MOVING, CSS_SHOW_UI]);
      return;
    }
    var guidelineIsNotReady = this.guideline.isBuilt() && !this.guideline.isAppended();
    var backlightIsNotReady = this.backlight.isBuilt() && !this.backlight.isAppended();
    if (guidelineIsNotReady && backlightIsNotReady) {
      this.guideline.appendTo(wtTable.hider);
      this.backlight.appendTo(wtTable.hider);
    }
    var $__12 = selection,
        from = $__12.from,
        to = $__12.to;
    var start = Math.min(from.row, to.row);
    var end = Math.max(from.row, to.row);
    if (coords.col < 0 && (coords.row >= start && coords.row <= end)) {
      blockCalculations.row = true;
      priv.pressed = true;
      priv.target.eventPageY = event.pageY;
      priv.target.coords = coords;
      priv.target.TD = TD;
      priv.rowsToMove = this.prepareRowsToMoving();
      var leftPos = wtTable.holder.scrollLeft + wtTable.getColumnWidth(-1);
      this.backlight.setPosition(null, leftPos);
      this.backlight.setSize(wtTable.hider.offsetWidth - leftPos, this.getRowsHeight(start, end + 1));
      this.backlight.setOffset((this.getRowsHeight(start, coords.row) + event.layerY) * -1, null);
      addClass(this.hot.rootElement, CSS_ON_MOVING);
      this.refreshPositions();
    } else {
      removeClass(this.hot.rootElement, CSS_AFTER_SELECTION);
      priv.pressed = false;
      priv.rowsToMove.length = 0;
    }
  },
  onMouseMove: function(event) {
    var priv = privatePool.get(this);
    if (!priv.pressed) {
      return;
    }
    if (event.realTarget === this.backlight.element) {
      var height = this.backlight.getSize().height;
      this.backlight.setSize(null, 0);
      setTimeout(function() {
        this.backlight.setPosition(null, height);
      });
    }
    priv.target.eventPageY = event.pageY;
    this.refreshPositions();
  },
  onBeforeOnCellMouseOver: function(event, coords, TD, blockCalculations) {
    var selectedRange = this.hot.getSelectedRange();
    var priv = privatePool.get(this);
    if (!selectedRange || !priv.pressed) {
      return;
    }
    if (priv.rowsToMove.indexOf(coords.row) > -1) {
      removeClass(this.hot.rootElement, CSS_SHOW_UI);
    } else {
      addClass(this.hot.rootElement, CSS_SHOW_UI);
    }
    blockCalculations.row = true;
    blockCalculations.column = true;
    blockCalculations.cell = true;
    priv.target.coords = coords;
    priv.target.TD = TD;
  },
  onMouseUp: function() {
    var priv = privatePool.get(this);
    var target = priv.target.row;
    var rowsLen = priv.rowsToMove.length;
    priv.pressed = false;
    priv.backlightHeight = 0;
    removeClass(this.hot.rootElement, [CSS_ON_MOVING, CSS_SHOW_UI, CSS_AFTER_SELECTION]);
    if (this.hot.selection.selectedHeader.rows) {
      addClass(this.hot.rootElement, CSS_AFTER_SELECTION);
    }
    if (rowsLen < 1 || target === void 0 || priv.rowsToMove.indexOf(target) > -1 || (priv.rowsToMove[rowsLen - 1] === target - 1)) {
      return;
    }
    this.moveRows(priv.rowsToMove, target);
    this.persistentStateSave();
    this.hot.render();
    if (!priv.disallowMoving) {
      var selectionStart = this.rowsMapper.getIndexByValue(priv.rowsToMove[0]);
      var selectionEnd = this.rowsMapper.getIndexByValue(priv.rowsToMove[rowsLen - 1]);
      this.changeSelection(selectionStart, selectionEnd);
    }
    priv.rowsToMove.length = 0;
  },
  onAfterScrollHorizontally: function() {
    var wtTable = this.hot.view.wt.wtTable;
    var headerWidth = wtTable.getColumnWidth(-1);
    var scrollLeft = wtTable.holder.scrollLeft;
    var posLeft = headerWidth + scrollLeft;
    this.backlight.setPosition(null, posLeft);
    this.backlight.setSize(wtTable.hider.offsetWidth - posLeft);
  },
  onAfterCreateRow: function(index, amount) {
    this.rowsMapper.shiftItems(index, amount);
  },
  onBeforeRemoveRow: function(index, amount) {
    var $__10 = this;
    this.removedRows.length = 0;
    if (index !== false) {
      rangeEach(index, index + amount - 1, (function(removedIndex) {
        $__10.removedRows.push($__10.hot.runHooks('modifyRow', removedIndex, $__10.pluginName));
      }));
    }
  },
  onAfterRemoveRow: function(index, amount) {
    this.rowsMapper.unshiftItems(this.removedRows);
  },
  onAfterLoadData: function(firstTime) {
    this.updateRowsMapper();
  },
  onModifyRow: function(row, source) {
    if (source !== this.pluginName) {
      var rowInMapper = this.rowsMapper.getValueByIndex(row);
      row = rowInMapper === null ? row : rowInMapper;
    }
    return row;
  },
  onUnmodifyRow: function(row) {
    var indexInMapper = this.rowsMapper.getIndexByValue(row);
    return indexInMapper === null ? row : indexInMapper;
  },
  onAfterPluginsInitialized: function() {
    this.updateRowsMapper();
    this.initialSettings();
    this.backlight.build();
    this.guideline.build();
  },
  destroy: function() {
    this.backlight.destroy();
    this.guideline.destroy();
    $traceurRuntime.superGet(this, $ManualRowMove.prototype, "destroy").call(this);
  }
}, {}, BasePlugin);
;
registerPlugin('ManualRowMove', ManualRowMove);
Handsontable.hooks.register('beforeRowMove');
Handsontable.hooks.register('afterRowMove');
Handsontable.hooks.register('unmodifyRow');

//# 
},{"_base.js":62,"browser":24,"eventManager":42,"helpers/array":43,"helpers/dom/element":47,"helpers/number":52,"plugins":61,"rowsMapper":103,"ui/backlight":105,"ui/guideline":106}],103:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  RowsMapper: {get: function() {
      return RowsMapper;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__46__46__47_mixins_47_arrayMapper__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__46__46__47_helpers_47_object__,
    $___46__46__47__46__46__47_helpers_47_number__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var arrayMapper = ($___46__46__47__46__46__47_mixins_47_arrayMapper__ = _dereq_("mixins/arrayMapper"), $___46__46__47__46__46__47_mixins_47_arrayMapper__ && $___46__46__47__46__46__47_mixins_47_arrayMapper__.__esModule && $___46__46__47__46__46__47_mixins_47_arrayMapper__ || {default: $___46__46__47__46__46__47_mixins_47_arrayMapper__}).arrayMapper;
var arrayFilter = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}).arrayFilter;
var mixin = ($___46__46__47__46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47__46__46__47_helpers_47_object__ && $___46__46__47__46__46__47_helpers_47_object__.__esModule && $___46__46__47__46__46__47_helpers_47_object__ || {default: $___46__46__47__46__46__47_helpers_47_object__}).mixin;
var rangeEach = ($___46__46__47__46__46__47_helpers_47_number__ = _dereq_("helpers/number"), $___46__46__47__46__46__47_helpers_47_number__ && $___46__46__47__46__46__47_helpers_47_number__.__esModule && $___46__46__47__46__46__47_helpers_47_number__ || {default: $___46__46__47__46__46__47_helpers_47_number__}).rangeEach;
var RowsMapper = function RowsMapper(manualRowMove) {
  this.manualRowMove = manualRowMove;
};
($traceurRuntime.createClass)(RowsMapper, {
  createMap: function(length) {
    var $__5 = this;
    var originLength = length === void 0 ? this._arrayMap.length : length;
    this._arrayMap.length = 0;
    rangeEach(originLength - 1, (function(itemIndex) {
      $__5._arrayMap[itemIndex] = itemIndex;
    }));
  },
  destroy: function() {
    this._arrayMap = null;
  },
  moveRow: function(from, to) {
    var indexToMove = this._arrayMap[from];
    this._arrayMap[from] = null;
    this._arrayMap.splice(to, 0, indexToMove);
  },
  clearNull: function() {
    this._arrayMap = arrayFilter(this._arrayMap, (function(i) {
      return i !== null;
    }));
  }
}, {});
mixin(RowsMapper, arrayMapper);
;
Handsontable.utils.ManualRowMoveRowsMapper = RowsMapper;

//# 
},{"browser":24,"helpers/array":43,"helpers/number":52,"helpers/object":53,"mixins/arrayMapper":57}],104:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  BaseUI: {get: function() {
      return BaseUI;
    }},
  __esModule: {value: true}
});
var STATE_INITIALIZED = 0;
var STATE_BUILT = 1;
var STATE_APPENDED = 2;
var UNIT = 'px';
var BaseUI = function BaseUI(hotInstance) {
  this.hot = hotInstance;
  this._element = null;
  this.state = STATE_INITIALIZED;
};
($traceurRuntime.createClass)(BaseUI, {
  appendTo: function(wrapper) {
    wrapper.appendChild(this._element);
    this.state = STATE_APPENDED;
  },
  build: function() {
    this._element = document.createElement('div');
    this.state = STATE_BUILT;
  },
  destroy: function() {
    if (this.isAppended()) {
      this._element.parentElement.removeChild(this._element);
    }
    this._element = null;
    this.state = STATE_INITIALIZED;
  },
  isAppended: function() {
    return this.state === STATE_APPENDED;
  },
  isBuilt: function() {
    return this.state >= STATE_BUILT;
  },
  setPosition: function(top, left) {
    if (top) {
      this._element.style.top = top + UNIT;
    }
    if (left) {
      this._element.style.left = left + UNIT;
    }
  },
  getPosition: function() {
    return {
      top: this._element.style.top ? parseInt(this._element.style.top, 10) : 0,
      left: this._element.style.left ? parseInt(this._element.style.left, 10) : 0
    };
  },
  setSize: function(width, height) {
    if (width) {
      this._element.style.width = width + UNIT;
    }
    if (height) {
      this._element.style.height = height + UNIT;
    }
  },
  getSize: function() {
    return {
      width: this._element.style.width ? parseInt(this._element.style.width, 10) : 0,
      height: this._element.style.height ? parseInt(this._element.style.height, 10) : 0
    };
  },
  setOffset: function(top, left) {
    if (top) {
      this._element.style.marginTop = top + UNIT;
    }
    if (left) {
      this._element.style.marginLeft = left + UNIT;
    }
  },
  getOffset: function() {
    return {
      top: this._element.style.marginTop ? parseInt(this._element.style.marginTop, 10) : 0,
      left: this._element.style.marginLeft ? parseInt(this._element.style.marginLeft, 10) : 0
    };
  }
}, {});
;

//# 
},{}],105:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  BacklightUI: {get: function() {
      return BacklightUI;
    }},
  __esModule: {value: true}
});
var $___95_base__,
    $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__;
var BaseUI = ($___95_base__ = _dereq_("_base"), $___95_base__ && $___95_base__.__esModule && $___95_base__ || {default: $___95_base__}).BaseUI;
var addClass = ($___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}).addClass;
var CSS_CLASSNAME = 'ht__manualRowMove--backlight';
var BacklightUI = function BacklightUI(hotInstance) {
  $traceurRuntime.superConstructor($BacklightUI).call(this, hotInstance);
};
var $BacklightUI = BacklightUI;
($traceurRuntime.createClass)(BacklightUI, {build: function() {
    $traceurRuntime.superGet(this, $BacklightUI.prototype, "build").call(this);
    addClass(this._element, CSS_CLASSNAME);
  }}, {}, BaseUI);
;

//# 
},{"_base":104,"helpers/dom/element":47}],106:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  GuidelineUI: {get: function() {
      return GuidelineUI;
    }},
  __esModule: {value: true}
});
var $___95_base__,
    $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__;
var BaseUI = ($___95_base__ = _dereq_("_base"), $___95_base__ && $___95_base__.__esModule && $___95_base__ || {default: $___95_base__}).BaseUI;
var addClass = ($___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47__46__46__47_helpers_47_dom_47_element__}).addClass;
var CSS_CLASSNAME = 'ht__manualRowMove--guideline';
var GuidelineUI = function GuidelineUI(hotInstance) {
  $traceurRuntime.superConstructor($GuidelineUI).call(this, hotInstance);
};
var $GuidelineUI = GuidelineUI;
($traceurRuntime.createClass)(GuidelineUI, {build: function() {
    $traceurRuntime.superGet(this, $GuidelineUI.prototype, "build").call(this);
    addClass(this._element, CSS_CLASSNAME);
  }}, {}, BaseUI);
;

//# 
},{"_base":104,"helpers/dom/element":47}],107:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  ManualRowResize: {get: function() {
      return ManualRowResize;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__95_base_46_js__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47_eventManager__,
    $___46__46__47__46__46__47_helpers_47_dom_47_event__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__46__46__47_helpers_47_number__,
    $___46__46__47__46__46__47_plugins__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var BasePlugin = ($___46__46__47__95_base_46_js__ = _dereq_("_base.js"), $___46__46__47__95_base_46_js__ && $___46__46__47__95_base_46_js__.__esModule && $___46__46__47__95_base_46_js__ || {default: $___46__46__47__95_base_46_js__}).default;
var $__2 = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}),
    addClass = $__2.addClass,
    hasClass = $__2.hasClass,
    removeClass = $__2.removeClass,
    outerWidth = $__2.outerWidth;
var eventManagerObject = ($___46__46__47__46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47__46__46__47_eventManager__ && $___46__46__47__46__46__47_eventManager__.__esModule && $___46__46__47__46__46__47_eventManager__ || {default: $___46__46__47__46__46__47_eventManager__}).eventManager;
var $__4 = ($___46__46__47__46__46__47_helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $___46__46__47__46__46__47_helpers_47_dom_47_event__ && $___46__46__47__46__46__47_helpers_47_dom_47_event__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_event__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_event__}),
    pageX = $__4.pageX,
    pageY = $__4.pageY;
var arrayEach = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}).arrayEach;
var rangeEach = ($___46__46__47__46__46__47_helpers_47_number__ = _dereq_("helpers/number"), $___46__46__47__46__46__47_helpers_47_number__ && $___46__46__47__46__46__47_helpers_47_number__.__esModule && $___46__46__47__46__46__47_helpers_47_number__ || {default: $___46__46__47__46__46__47_helpers_47_number__}).rangeEach;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
var ManualRowResize = function ManualRowResize(hotInstance) {
  $traceurRuntime.superConstructor($ManualRowResize).call(this, hotInstance);
  this.currentTH = null;
  this.currentRow = null;
  this.selectedRows = [];
  this.currentHeight = null;
  this.newSize = null;
  this.startY = null;
  this.startHeight = null;
  this.startOffset = null;
  this.handle = document.createElement('DIV');
  this.guide = document.createElement('DIV');
  this.eventManager = eventManagerObject(this);
  this.pressed = null;
  this.dblclick = 0;
  this.autoresizeTimeout = null;
  this.manualRowHeights = [];
  addClass(this.handle, 'manualRowResizer');
  addClass(this.guide, 'manualRowResizerGuide');
};
var $ManualRowResize = ManualRowResize;
($traceurRuntime.createClass)(ManualRowResize, {
  isEnabled: function() {
    return this.hot.getSettings().manualRowResize;
  },
  enablePlugin: function() {
    var $__8 = this;
    if (this.enabled) {
      return;
    }
    this.manualRowHeights = [];
    var initialRowHeights = this.hot.getSettings().manualRowResize;
    var loadedManualRowHeights = this.loadManualRowHeights();
    if (typeof loadedManualRowHeights != 'undefined') {
      this.manualRowHeights = loadedManualRowHeights;
    } else if (Array.isArray(initialRowHeights)) {
      this.manualRowHeights = initialRowHeights;
    } else {
      this.manualRowHeights = [];
    }
    this.addHook('modifyRowHeight', (function(height, row) {
      return $__8.onModifyRowHeight(height, row);
    }));
    Handsontable.hooks.register('beforeRowResize');
    Handsontable.hooks.register('afterRowResize');
    this.bindEvents();
    $traceurRuntime.superGet(this, $ManualRowResize.prototype, "enablePlugin").call(this);
  },
  updatePlugin: function() {
    var initialRowHeights = this.hot.getSettings().manualRowResize;
    if (Array.isArray(initialRowHeights)) {
      this.manualRowHeights = initialRowHeights;
    } else if (!initialRowHeights) {
      this.manualRowHeights = [];
    }
  },
  disablePlugin: function() {
    $traceurRuntime.superGet(this, $ManualRowResize.prototype, "disablePlugin").call(this);
  },
  saveManualRowHeights: function() {
    this.hot.runHooks('persistentStateSave', 'manualRowHeights', this.manualRowHeights);
  },
  loadManualRowHeights: function() {
    var storedState = {};
    this.hot.runHooks('persistentStateLoad', 'manualRowHeights', storedState);
    return storedState.value;
  },
  setupHandlePosition: function(TH) {
    var $__8 = this;
    this.currentTH = TH;
    var row = this.hot.view.wt.wtTable.getCoords(TH).row;
    var headerWidth = outerWidth(this.currentTH);
    if (row >= 0) {
      var box = this.currentTH.getBoundingClientRect();
      this.currentRow = row;
      this.selectedRows = [];
      if (this.hot.selection.isSelected() && this.hot.selection.selectedHeader.rows) {
        var $__10 = this.hot.getSelectedRange(),
            from = $__10.from,
            to = $__10.to;
        var start = from.row;
        var end = to.row;
        if (start >= end) {
          start = to.row;
          end = from.row;
        }
        if (this.currentRow >= start && this.currentRow <= end) {
          rangeEach(start, end, (function(i) {
            return $__8.selectedRows.push(i);
          }));
        } else {
          this.selectedRows.push(this.currentRow);
        }
      } else {
        this.selectedRows.push(this.currentRow);
      }
      this.startOffset = box.top - 6;
      this.startHeight = parseInt(box.height, 10);
      this.handle.style.left = box.left + 'px';
      this.handle.style.top = this.startOffset + this.startHeight + 'px';
      this.handle.style.width = headerWidth + 'px';
      this.hot.rootElement.appendChild(this.handle);
    }
  },
  refreshHandlePosition: function() {
    this.handle.style.top = this.startOffset + this.currentHeight + 'px';
  },
  setupGuidePosition: function() {
    var handleWidth = parseInt(outerWidth(this.handle), 10);
    var handleRightPosition = parseInt(this.handle.style.left, 10) + handleWidth;
    var maximumVisibleElementWidth = parseInt(this.hot.view.maximumVisibleElementWidth(0), 10);
    addClass(this.handle, 'active');
    addClass(this.guide, 'active');
    this.guide.style.top = this.handle.style.top;
    this.guide.style.left = handleRightPosition + 'px';
    this.guide.style.width = (maximumVisibleElementWidth - handleWidth) + 'px';
    this.hot.rootElement.appendChild(this.guide);
  },
  refreshGuidePosition: function() {
    this.guide.style.top = this.handle.style.top;
  },
  hideHandleAndGuide: function() {
    removeClass(this.handle, 'active');
    removeClass(this.guide, 'active');
  },
  checkIfRowHeader: function(element) {
    if (element != this.hot.rootElement) {
      var parent = element.parentNode;
      if (parent.tagName === 'TBODY') {
        return true;
      }
      return this.checkIfRowHeader(parent);
    }
    return false;
  },
  getTHFromTargetElement: function(element) {
    if (element.tagName != 'TABLE') {
      if (element.tagName == 'TH') {
        return element;
      } else {
        return this.getTHFromTargetElement(element.parentNode);
      }
    }
    return null;
  },
  onMouseOver: function(event) {
    if (this.checkIfRowHeader(event.target)) {
      var th = this.getTHFromTargetElement(event.target);
      if (th) {
        if (!this.pressed) {
          this.setupHandlePosition(th);
        }
      }
    }
  },
  afterMouseDownTimeout: function() {
    var $__8 = this;
    var render = (function() {
      $__8.hot.forceFullRender = true;
      $__8.hot.view.render();
      $__8.hot.view.wt.wtOverlays.adjustElementsSize(true);
    });
    var resize = (function(selectedRow, forceRender) {
      var hookNewSize = $__8.hot.runHooks('beforeRowResize', selectedRow, $__8.newSize, true);
      if (hookNewSize !== void 0) {
        $__8.newSize = hookNewSize;
      }
      $__8.setManualSize(selectedRow, $__8.newSize);
      if (forceRender) {
        render();
      }
      $__8.hot.runHooks('afterRowResize', selectedRow, $__8.newSize, true);
    });
    if (this.dblclick >= 2) {
      var selectedRowsLength = this.selectedRows.length;
      if (selectedRowsLength > 1) {
        arrayEach(this.selectedRows, (function(selectedRow) {
          resize(selectedRow);
        }));
        render();
      } else {
        arrayEach(this.selectedRows, (function(selectedRow) {
          resize(selectedRow, true);
        }));
      }
    }
    this.dblclick = 0;
    this.autoresizeTimeout = null;
  },
  onMouseDown: function(event) {
    var $__8 = this;
    if (hasClass(event.target, 'manualRowResizer')) {
      this.setupGuidePosition();
      this.pressed = this.hot;
      if (this.autoresizeTimeout == null) {
        this.autoresizeTimeout = setTimeout((function() {
          return $__8.afterMouseDownTimeout();
        }), 500);
        this.hot._registerTimeout(this.autoresizeTimeout);
      }
      this.dblclick++;
      this.startY = pageY(event);
      this.newSize = this.startHeight;
    }
  },
  onMouseMove: function(event) {
    var $__8 = this;
    if (this.pressed) {
      this.currentHeight = this.startHeight + (pageY(event) - this.startY);
      arrayEach(this.selectedRows, (function(selectedRow) {
        $__8.newSize = $__8.setManualSize(selectedRow, $__8.currentHeight);
      }));
      this.refreshHandlePosition();
      this.refreshGuidePosition();
    }
  },
  onMouseUp: function(event) {
    var $__8 = this;
    var render = (function() {
      $__8.hot.forceFullRender = true;
      $__8.hot.view.render();
      $__8.hot.view.wt.wtOverlays.adjustElementsSize(true);
    });
    var runHooks = (function(selectedRow, forceRender) {
      $__8.hot.runHooks('beforeRowResize', selectedRow, $__8.newSize);
      if (forceRender) {
        render();
      }
      $__8.saveManualRowHeights();
      $__8.hot.runHooks('afterRowResize', selectedRow, $__8.newSize);
    });
    if (this.pressed) {
      this.hideHandleAndGuide();
      this.pressed = false;
      if (this.newSize != this.startHeight) {
        var selectedRowsLength = this.selectedRows.length;
        if (selectedRowsLength > 1) {
          arrayEach(this.selectedRows, (function(selectedRow) {
            runHooks(selectedRow);
          }));
          render();
        } else {
          arrayEach(this.selectedRows, (function(selectedRow) {
            runHooks(selectedRow, true);
          }));
        }
      }
      this.setupHandlePosition(this.currentTH);
    }
  },
  bindEvents: function() {
    var $__8 = this;
    this.eventManager.addEventListener(this.hot.rootElement, 'mouseover', (function(e) {
      return $__8.onMouseOver(e);
    }));
    this.eventManager.addEventListener(this.hot.rootElement, 'mousedown', (function(e) {
      return $__8.onMouseDown(e);
    }));
    this.eventManager.addEventListener(window, 'mousemove', (function(e) {
      return $__8.onMouseMove(e);
    }));
    this.eventManager.addEventListener(window, 'mouseup', (function(e) {
      return $__8.onMouseUp(e);
    }));
  },
  setManualSize: function(row, height) {
    row = this.hot.runHooks('modifyRow', row);
    this.manualRowHeights[row] = height;
    return height;
  },
  onModifyRowHeight: function(height, row) {
    if (this.enabled) {
      var autoRowSizePlugin = this.hot.getPlugin('autoRowSize');
      var autoRowHeightResult = autoRowSizePlugin ? autoRowSizePlugin.heights[row] : null;
      row = this.hot.runHooks('modifyRow', row);
      var manualRowHeight = this.manualRowHeights[row];
      if (manualRowHeight !== void 0 && (manualRowHeight === autoRowHeightResult || manualRowHeight > (height || 0))) {
        return manualRowHeight;
      }
    }
    return height;
  }
}, {}, BasePlugin);
;
registerPlugin('manualRowResize', ManualRowResize);

//# 
},{"_base.js":62,"browser":24,"eventManager":42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/number":52,"plugins":61}],108:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  MergeCells: {get: function() {
      return MergeCells;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__46__46__47_plugins__,
    $___46__46__47__46__46__47_helpers_47_dom_47_event__,
    $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__,
    $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__,
    $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_table__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
var stopImmediatePropagation = ($___46__46__47__46__46__47_helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $___46__46__47__46__46__47_helpers_47_dom_47_event__ && $___46__46__47__46__46__47_helpers_47_dom_47_event__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_event__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_event__}).stopImmediatePropagation;
var WalkontableCellCoords = ($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ = _dereq_("3rdparty/walkontable/src/cell/coords"), $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__.__esModule && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ || {default: $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__}).WalkontableCellCoords;
var WalkontableCellRange = ($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__ = _dereq_("3rdparty/walkontable/src/cell/range"), $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__ && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__.__esModule && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__ || {default: $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_range__}).WalkontableCellRange;
var WalkontableTable = ($___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_table__ = _dereq_("3rdparty/walkontable/src/table"), $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_table__ && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_table__.__esModule && $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_table__ || {default: $___46__46__47__46__46__47_3rdparty_47_walkontable_47_src_47_table__}).WalkontableTable;
;
function CellInfoCollection() {
  var collection = [];
  collection.getInfo = function(row, col) {
    for (var i = 0,
        ilen = this.length; i < ilen; i++) {
      if (this[i].row <= row && this[i].row + this[i].rowspan - 1 >= row && this[i].col <= col && this[i].col + this[i].colspan - 1 >= col) {
        return this[i];
      }
    }
  };
  collection.setInfo = function(info) {
    for (var i = 0,
        ilen = this.length; i < ilen; i++) {
      if (this[i].row === info.row && this[i].col === info.col) {
        this[i] = info;
        return;
      }
    }
    this.push(info);
  };
  collection.removeInfo = function(row, col) {
    for (var i = 0,
        ilen = this.length; i < ilen; i++) {
      if (this[i].row === row && this[i].col === col) {
        this.splice(i, 1);
        break;
      }
    }
  };
  return collection;
}
function MergeCells(mergeCellsSetting) {
  this.mergedCellInfoCollection = new CellInfoCollection();
  if (Array.isArray(mergeCellsSetting)) {
    for (var i = 0,
        ilen = mergeCellsSetting.length; i < ilen; i++) {
      this.mergedCellInfoCollection.setInfo(mergeCellsSetting[i]);
    }
  }
}
MergeCells.prototype.canMergeRange = function(cellRange) {
  return !cellRange.isSingle();
};
MergeCells.prototype.mergeRange = function(cellRange) {
  if (!this.canMergeRange(cellRange)) {
    return;
  }
  var topLeft = cellRange.getTopLeftCorner();
  var bottomRight = cellRange.getBottomRightCorner();
  var mergeParent = {};
  mergeParent.row = topLeft.row;
  mergeParent.col = topLeft.col;
  mergeParent.rowspan = bottomRight.row - topLeft.row + 1;
  mergeParent.colspan = bottomRight.col - topLeft.col + 1;
  this.mergedCellInfoCollection.setInfo(mergeParent);
};
MergeCells.prototype.mergeOrUnmergeSelection = function(cellRange) {
  var info = this.mergedCellInfoCollection.getInfo(cellRange.from.row, cellRange.from.col);
  if (info) {
    this.unmergeSelection(cellRange.from);
  } else {
    this.mergeSelection(cellRange);
  }
};
MergeCells.prototype.mergeSelection = function(cellRange) {
  this.mergeRange(cellRange);
};
MergeCells.prototype.unmergeSelection = function(cellRange) {
  var info = this.mergedCellInfoCollection.getInfo(cellRange.row, cellRange.col);
  this.mergedCellInfoCollection.removeInfo(info.row, info.col);
};
MergeCells.prototype.applySpanProperties = function(TD, row, col) {
  var info = this.mergedCellInfoCollection.getInfo(row, col);
  if (info) {
    if (info.row === row && info.col === col) {
      TD.setAttribute('rowspan', info.rowspan);
      TD.setAttribute('colspan', info.colspan);
    } else {
      TD.removeAttribute('rowspan');
      TD.removeAttribute('colspan');
      TD.style.display = 'none';
    }
  } else {
    TD.removeAttribute('rowspan');
    TD.removeAttribute('colspan');
  }
};
MergeCells.prototype.modifyTransform = function(hook, currentSelectedRange, delta) {
  var sameRowspan = function(merged, coords) {
    if (coords.row >= merged.row && coords.row <= (merged.row + merged.rowspan - 1)) {
      return true;
    }
    return false;
  },
      sameColspan = function(merged, coords) {
        if (coords.col >= merged.col && coords.col <= (merged.col + merged.colspan - 1)) {
          return true;
        }
        return false;
      },
      getNextPosition = function(newDelta) {
        return new WalkontableCellCoords(currentSelectedRange.to.row + newDelta.row, currentSelectedRange.to.col + newDelta.col);
      };
  var newDelta = {
    row: delta.row,
    col: delta.col
  };
  if (hook == 'modifyTransformStart') {
    if (!this.lastDesiredCoords) {
      this.lastDesiredCoords = new WalkontableCellCoords(null, null);
    }
    var currentPosition = new WalkontableCellCoords(currentSelectedRange.highlight.row, currentSelectedRange.highlight.col),
        mergedParent = this.mergedCellInfoCollection.getInfo(currentPosition.row, currentPosition.col),
        currentRangeContainsMerge;
    for (var i = 0,
        mergesLength = this.mergedCellInfoCollection.length; i < mergesLength; i++) {
      var range = this.mergedCellInfoCollection[i];
      range = new WalkontableCellCoords(range.row + range.rowspan - 1, range.col + range.colspan - 1);
      if (currentSelectedRange.includes(range)) {
        currentRangeContainsMerge = true;
        break;
      }
    }
    if (mergedParent) {
      var mergeTopLeft = new WalkontableCellCoords(mergedParent.row, mergedParent.col),
          mergeBottomRight = new WalkontableCellCoords(mergedParent.row + mergedParent.rowspan - 1, mergedParent.col + mergedParent.colspan - 1),
          mergeRange = new WalkontableCellRange(mergeTopLeft, mergeTopLeft, mergeBottomRight);
      if (!mergeRange.includes(this.lastDesiredCoords)) {
        this.lastDesiredCoords = new WalkontableCellCoords(null, null);
      }
      newDelta.row = this.lastDesiredCoords.row ? this.lastDesiredCoords.row - currentPosition.row : newDelta.row;
      newDelta.col = this.lastDesiredCoords.col ? this.lastDesiredCoords.col - currentPosition.col : newDelta.col;
      if (delta.row > 0) {
        newDelta.row = mergedParent.row + mergedParent.rowspan - 1 - currentPosition.row + delta.row;
      } else if (delta.row < 0) {
        newDelta.row = currentPosition.row - mergedParent.row + delta.row;
      }
      if (delta.col > 0) {
        newDelta.col = mergedParent.col + mergedParent.colspan - 1 - currentPosition.col + delta.col;
      } else if (delta.col < 0) {
        newDelta.col = currentPosition.col - mergedParent.col + delta.col;
      }
    }
    var nextPosition = new WalkontableCellCoords(currentSelectedRange.highlight.row + newDelta.row, currentSelectedRange.highlight.col + newDelta.col),
        nextParentIsMerged = this.mergedCellInfoCollection.getInfo(nextPosition.row, nextPosition.col);
    if (nextParentIsMerged) {
      this.lastDesiredCoords = nextPosition;
      newDelta = {
        row: nextParentIsMerged.row - currentPosition.row,
        col: nextParentIsMerged.col - currentPosition.col
      };
    }
  } else if (hook == 'modifyTransformEnd') {
    for (var i = 0,
        mergesLength = this.mergedCellInfoCollection.length; i < mergesLength; i++) {
      var currentMerge = this.mergedCellInfoCollection[i],
          mergeTopLeft = new WalkontableCellCoords(currentMerge.row, currentMerge.col),
          mergeBottomRight = new WalkontableCellCoords(currentMerge.row + currentMerge.rowspan - 1, currentMerge.col + currentMerge.colspan - 1),
          mergedRange = new WalkontableCellRange(mergeTopLeft, mergeTopLeft, mergeBottomRight),
          sharedBorders = currentSelectedRange.getBordersSharedWith(mergedRange);
      if (mergedRange.isEqual(currentSelectedRange)) {
        currentSelectedRange.setDirection('NW-SE');
      } else if (sharedBorders.length > 0) {
        var mergeHighlighted = (currentSelectedRange.highlight.isEqual(mergedRange.from));
        if (sharedBorders.indexOf('top') > -1) {
          if (currentSelectedRange.to.isSouthEastOf(mergedRange.from) && mergeHighlighted) {
            currentSelectedRange.setDirection('NW-SE');
          } else if (currentSelectedRange.to.isSouthWestOf(mergedRange.from) && mergeHighlighted) {
            currentSelectedRange.setDirection('NE-SW');
          }
        } else if (sharedBorders.indexOf('bottom') > -1) {
          if (currentSelectedRange.to.isNorthEastOf(mergedRange.from) && mergeHighlighted) {
            currentSelectedRange.setDirection('SW-NE');
          } else if (currentSelectedRange.to.isNorthWestOf(mergedRange.from) && mergeHighlighted) {
            currentSelectedRange.setDirection('SE-NW');
          }
        }
      }
      var nextPosition = getNextPosition(newDelta),
          withinRowspan = sameRowspan(currentMerge, nextPosition),
          withinColspan = sameColspan(currentMerge, nextPosition);
      if (currentSelectedRange.includesRange(mergedRange) && (mergedRange.includes(nextPosition) || withinRowspan || withinColspan)) {
        if (withinRowspan) {
          if (newDelta.row < 0) {
            newDelta.row -= currentMerge.rowspan - 1;
          } else if (newDelta.row > 0) {
            newDelta.row += currentMerge.rowspan - 1;
          }
        }
        if (withinColspan) {
          if (newDelta.col < 0) {
            newDelta.col -= currentMerge.colspan - 1;
          } else if (newDelta.col > 0) {
            newDelta.col += currentMerge.colspan - 1;
          }
        }
      }
    }
  }
  if (newDelta.row !== 0) {
    delta.row = newDelta.row;
  }
  if (newDelta.col !== 0) {
    delta.col = newDelta.col;
  }
};
MergeCells.prototype.shiftCollection = function(direction, index, count) {
  var shiftVector = [0, 0];
  switch (direction) {
    case 'right':
      shiftVector[0] += 1;
      break;
    case 'left':
      shiftVector[0] -= 1;
      break;
    case 'down':
      shiftVector[1] += 1;
      break;
    case 'up':
      shiftVector[1] -= 1;
      break;
  }
  for (var i = 0; i < this.mergedCellInfoCollection.length; i++) {
    var currentMerge = this.mergedCellInfoCollection[i];
    if (direction === 'right' || direction === 'left') {
      if (index <= currentMerge.col) {
        currentMerge.col += shiftVector[0];
      }
    } else {
      if (index <= currentMerge.row) {
        currentMerge.row += shiftVector[1];
      }
    }
  }
};
var beforeInit = function() {
  var instance = this;
  var mergeCellsSetting = instance.getSettings().mergeCells;
  if (mergeCellsSetting) {
    if (!instance.mergeCells) {
      instance.mergeCells = new MergeCells(mergeCellsSetting);
    }
  }
};
var afterInit = function() {
  var instance = this;
  if (instance.mergeCells) {
    instance.view.wt.wtTable.getCell = function(coords) {
      if (instance.getSettings().mergeCells) {
        var mergeParent = instance.mergeCells.mergedCellInfoCollection.getInfo(coords.row, coords.col);
        if (mergeParent) {
          coords = mergeParent;
        }
      }
      return WalkontableTable.prototype.getCell.call(this, coords);
    };
  }
};
var afterUpdateSettings = function() {
  var instance = this;
  var mergeCellsSetting = instance.getSettings().mergeCells;
  if (mergeCellsSetting) {
    if (instance.mergeCells) {
      instance.mergeCells.mergedCellInfoCollection = new CellInfoCollection();
      if (Array.isArray(mergeCellsSetting)) {
        for (var i = 0,
            ilen = mergeCellsSetting.length; i < ilen; i++) {
          instance.mergeCells.mergedCellInfoCollection.setInfo(mergeCellsSetting[i]);
        }
      }
    } else {
      instance.mergeCells = new MergeCells(mergeCellsSetting);
    }
  } else {
    if (instance.mergeCells) {
      instance.mergeCells.mergedCellInfoCollection = new CellInfoCollection();
    }
  }
};
var onBeforeKeyDown = function(event) {
  if (!this.mergeCells) {
    return;
  }
  var ctrlDown = (event.ctrlKey || event.metaKey) && !event.altKey;
  if (ctrlDown) {
    if (event.keyCode === 77) {
      this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange());
      this.render();
      stopImmediatePropagation(event);
    }
  }
};
var addMergeActionsToContextMenu = function(defaultOptions) {
  if (!this.getSettings().mergeCells) {
    return;
  }
  defaultOptions.items.push(Handsontable.plugins.ContextMenu.SEPARATOR);
  defaultOptions.items.push({
    key: 'mergeCells',
    name: function() {
      var sel = this.getSelected();
      var info = this.mergeCells.mergedCellInfoCollection.getInfo(sel[0], sel[1]);
      if (info) {
        return 'Unmerge cells';
      } else {
        return 'Merge cells';
      }
    },
    callback: function() {
      this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange());
      this.render();
    },
    disabled: function() {
      return this.selection.selectedHeader.corner;
    }
  });
};
var afterRenderer = function(TD, row, col, prop, value, cellProperties) {
  if (this.mergeCells) {
    this.mergeCells.applySpanProperties(TD, row, col);
  }
};
var modifyTransformFactory = function(hook) {
  return function(delta) {
    var mergeCellsSetting = this.getSettings().mergeCells;
    if (mergeCellsSetting) {
      var currentSelectedRange = this.getSelectedRange();
      this.mergeCells.modifyTransform(hook, currentSelectedRange, delta);
      if (hook === 'modifyTransformEnd') {
        var totalRows = this.countRows();
        var totalCols = this.countCols();
        if (currentSelectedRange.from.row < 0) {
          currentSelectedRange.from.row = 0;
        } else if (currentSelectedRange.from.row > 0 && currentSelectedRange.from.row >= totalRows) {
          currentSelectedRange.from.row = currentSelectedRange.from - 1;
        }
        if (currentSelectedRange.from.col < 0) {
          currentSelectedRange.from.col = 0;
        } else if (currentSelectedRange.from.col > 0 && currentSelectedRange.from.col >= totalCols) {
          currentSelectedRange.from.col = totalCols - 1;
        }
      }
    }
  };
};
var beforeSetRangeEnd = function(coords) {
  this.lastDesiredCoords = null;
  var mergeCellsSetting = this.getSettings().mergeCells;
  if (mergeCellsSetting) {
    var selRange = this.getSelectedRange();
    selRange.highlight = new WalkontableCellCoords(selRange.highlight.row, selRange.highlight.col);
    selRange.to = coords;
    var rangeExpanded = false;
    do {
      rangeExpanded = false;
      for (var i = 0,
          ilen = this.mergeCells.mergedCellInfoCollection.length; i < ilen; i++) {
        var cellInfo = this.mergeCells.mergedCellInfoCollection[i];
        var mergedCellTopLeft = new WalkontableCellCoords(cellInfo.row, cellInfo.col);
        var mergedCellBottomRight = new WalkontableCellCoords(cellInfo.row + cellInfo.rowspan - 1, cellInfo.col + cellInfo.colspan - 1);
        var mergedCellRange = new WalkontableCellRange(mergedCellTopLeft, mergedCellTopLeft, mergedCellBottomRight);
        if (selRange.expandByRange(mergedCellRange)) {
          coords.row = selRange.to.row;
          coords.col = selRange.to.col;
          rangeExpanded = true;
        }
      }
    } while (rangeExpanded);
  }
};
var beforeDrawAreaBorders = function(corners, className) {
  if (className && className == 'area') {
    var mergeCellsSetting = this.getSettings().mergeCells;
    if (mergeCellsSetting) {
      var selRange = this.getSelectedRange();
      var startRange = new WalkontableCellRange(selRange.from, selRange.from, selRange.from);
      var stopRange = new WalkontableCellRange(selRange.to, selRange.to, selRange.to);
      for (var i = 0,
          ilen = this.mergeCells.mergedCellInfoCollection.length; i < ilen; i++) {
        var cellInfo = this.mergeCells.mergedCellInfoCollection[i];
        var mergedCellTopLeft = new WalkontableCellCoords(cellInfo.row, cellInfo.col);
        var mergedCellBottomRight = new WalkontableCellCoords(cellInfo.row + cellInfo.rowspan - 1, cellInfo.col + cellInfo.colspan - 1);
        var mergedCellRange = new WalkontableCellRange(mergedCellTopLeft, mergedCellTopLeft, mergedCellBottomRight);
        if (startRange.expandByRange(mergedCellRange)) {
          corners[0] = startRange.from.row;
          corners[1] = startRange.from.col;
        }
        if (stopRange.expandByRange(mergedCellRange)) {
          corners[2] = stopRange.from.row;
          corners[3] = stopRange.from.col;
        }
      }
    }
  }
};
var afterGetCellMeta = function(row, col, cellProperties) {
  var mergeCellsSetting = this.getSettings().mergeCells;
  if (mergeCellsSetting) {
    var mergeParent = this.mergeCells.mergedCellInfoCollection.getInfo(row, col);
    if (mergeParent && (mergeParent.row != row || mergeParent.col != col)) {
      cellProperties.copyable = false;
    }
  }
};
var afterViewportRowCalculatorOverride = function(calc) {
  var mergeCellsSetting = this.getSettings().mergeCells;
  if (mergeCellsSetting) {
    var colCount = this.countCols();
    var mergeParent;
    for (var c = 0; c < colCount; c++) {
      mergeParent = this.mergeCells.mergedCellInfoCollection.getInfo(calc.startRow, c);
      if (mergeParent) {
        if (mergeParent.row < calc.startRow) {
          calc.startRow = mergeParent.row;
          return afterViewportRowCalculatorOverride.call(this, calc);
        }
      }
      mergeParent = this.mergeCells.mergedCellInfoCollection.getInfo(calc.endRow, c);
      if (mergeParent) {
        var mergeEnd = mergeParent.row + mergeParent.rowspan - 1;
        if (mergeEnd > calc.endRow) {
          calc.endRow = mergeEnd;
          return afterViewportRowCalculatorOverride.call(this, calc);
        }
      }
    }
  }
};
var afterViewportColumnCalculatorOverride = function(calc) {
  var mergeCellsSetting = this.getSettings().mergeCells;
  if (mergeCellsSetting) {
    var rowCount = this.countRows();
    var mergeParent;
    for (var r = 0; r < rowCount; r++) {
      mergeParent = this.mergeCells.mergedCellInfoCollection.getInfo(r, calc.startColumn);
      if (mergeParent) {
        if (mergeParent.col < calc.startColumn) {
          calc.startColumn = mergeParent.col;
          return afterViewportColumnCalculatorOverride.call(this, calc);
        }
      }
      mergeParent = this.mergeCells.mergedCellInfoCollection.getInfo(r, calc.endColumn);
      if (mergeParent) {
        var mergeEnd = mergeParent.col + mergeParent.colspan - 1;
        if (mergeEnd > calc.endColumn) {
          calc.endColumn = mergeEnd;
          return afterViewportColumnCalculatorOverride.call(this, calc);
        }
      }
    }
  }
};
var isMultipleSelection = function(isMultiple) {
  if (isMultiple && this.mergeCells) {
    var mergedCells = this.mergeCells.mergedCellInfoCollection,
        selectionRange = this.getSelectedRange();
    for (var group in mergedCells) {
      if (selectionRange.highlight.row == mergedCells[group].row && selectionRange.highlight.col == mergedCells[group].col && selectionRange.to.row == mergedCells[group].row + mergedCells[group].rowspan - 1 && selectionRange.to.col == mergedCells[group].col + mergedCells[group].colspan - 1) {
        return false;
      }
    }
  }
  return isMultiple;
};
function modifyAutofillRange(select, drag) {
  var mergeCellsSetting = this.getSettings().mergeCells;
  if (!mergeCellsSetting || this.selection.isMultiple()) {
    return;
  }
  var info = this.mergeCells.mergedCellInfoCollection.getInfo(select[0], select[1]);
  if (info) {
    select[0] = info.row;
    select[1] = info.col;
    select[2] = info.row + info.rowspan - 1;
    select[3] = info.col + info.colspan - 1;
  }
}
function onAfterCreateCol(col, count) {
  if (this.mergeCells) {
    this.mergeCells.shiftCollection('right', col, count);
  }
}
function onAfterRemoveCol(col, count) {
  if (this.mergeCells) {
    this.mergeCells.shiftCollection('left', col, count);
  }
}
function onAfterCreateRow(row, count) {
  if (this.mergeCells) {
    this.mergeCells.shiftCollection('down', row, count);
  }
}
function onAfterRemoveRow(row, count) {
  if (this.mergeCells) {
    this.mergeCells.shiftCollection('up', row, count);
  }
}
Handsontable.hooks.add('beforeInit', beforeInit);
Handsontable.hooks.add('afterInit', afterInit);
Handsontable.hooks.add('afterUpdateSettings', afterUpdateSettings);
Handsontable.hooks.add('beforeKeyDown', onBeforeKeyDown);
Handsontable.hooks.add('modifyTransformStart', modifyTransformFactory('modifyTransformStart'));
Handsontable.hooks.add('modifyTransformEnd', modifyTransformFactory('modifyTransformEnd'));
Handsontable.hooks.add('beforeSetRangeEnd', beforeSetRangeEnd);
Handsontable.hooks.add('beforeDrawBorders', beforeDrawAreaBorders);
Handsontable.hooks.add('afterIsMultipleSelection', isMultipleSelection);
Handsontable.hooks.add('afterRenderer', afterRenderer);
Handsontable.hooks.add('afterContextMenuDefaultOptions', addMergeActionsToContextMenu);
Handsontable.hooks.add('afterGetCellMeta', afterGetCellMeta);
Handsontable.hooks.add('afterViewportRowCalculatorOverride', afterViewportRowCalculatorOverride);
Handsontable.hooks.add('afterViewportColumnCalculatorOverride', afterViewportColumnCalculatorOverride);
Handsontable.hooks.add('modifyAutofillRange', modifyAutofillRange);
Handsontable.hooks.add('afterCreateCol', onAfterCreateCol);
Handsontable.hooks.add('afterRemoveCol', onAfterRemoveCol);
Handsontable.hooks.add('afterCreateRow', onAfterCreateRow);
Handsontable.hooks.add('afterRemoveRow', onAfterRemoveRow);
Handsontable.MergeCells = MergeCells;

//# 
},{"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/cell/range":7,"3rdparty/walkontable/src/table":21,"browser":24,"helpers/dom/event":48,"plugins":61}],109:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  MultipleSelectionHandles: {get: function() {
      return MultipleSelectionHandles;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47_helpers_47_browser__,
    $___46__46__47__95_base__,
    $___46__46__47__46__46__47_eventManager__,
    $___46__46__47__46__46__47_plugins__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var $__1 = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}),
    getWindowScrollTop = $__1.getWindowScrollTop,
    hasClass = $__1.hasClass,
    getWindowScrollLeft = $__1.getWindowScrollLeft;
var isMobileBrowser = ($___46__46__47__46__46__47_helpers_47_browser__ = _dereq_("helpers/browser"), $___46__46__47__46__46__47_helpers_47_browser__ && $___46__46__47__46__46__47_helpers_47_browser__.__esModule && $___46__46__47__46__46__47_helpers_47_browser__ || {default: $___46__46__47__46__46__47_helpers_47_browser__}).isMobileBrowser;
var BasePlugin = ($___46__46__47__95_base__ = _dereq_("_base"), $___46__46__47__95_base__ && $___46__46__47__95_base__.__esModule && $___46__46__47__95_base__ || {default: $___46__46__47__95_base__}).default;
var EventManager = ($___46__46__47__46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47__46__46__47_eventManager__ && $___46__46__47__46__46__47_eventManager__.__esModule && $___46__46__47__46__46__47_eventManager__ || {default: $___46__46__47__46__46__47_eventManager__}).EventManager;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
var MultipleSelectionHandles = function MultipleSelectionHandles(hotInstance) {
  $traceurRuntime.superConstructor($MultipleSelectionHandles).call(this, hotInstance);
  this.dragged = [];
  this.eventManager = null;
  this.lastSetCell = null;
};
var $MultipleSelectionHandles = MultipleSelectionHandles;
($traceurRuntime.createClass)(MultipleSelectionHandles, {
  isEnabled: function() {
    return isMobileBrowser();
  },
  enablePlugin: function() {
    if (this.enabled) {
      return;
    }
    if (!this.eventManager) {
      this.eventManager = new EventManager(this);
    }
    this.registerListeners();
    $traceurRuntime.superGet(this, $MultipleSelectionHandles.prototype, "enablePlugin").call(this);
  },
  registerListeners: function() {
    var _this = this;
    function removeFromDragged(query) {
      if (_this.dragged.length === 1) {
        _this.dragged.splice(0, _this.dragged.length);
        return true;
      }
      var entryPosition = _this.dragged.indexOf(query);
      if (entryPosition == -1) {
        return false;
      } else if (entryPosition === 0) {
        _this.dragged = _this.dragged.slice(0, 1);
      } else if (entryPosition == 1) {
        _this.dragged = _this.dragged.slice(-1);
      }
    }
    this.eventManager.addEventListener(this.hot.rootElement, 'touchstart', function(event) {
      var selectedRange;
      if (hasClass(event.target, 'topLeftSelectionHandle-HitArea')) {
        selectedRange = _this.hot.getSelectedRange();
        _this.dragged.push('topLeft');
        _this.touchStartRange = {
          width: selectedRange.getWidth(),
          height: selectedRange.getHeight(),
          direction: selectedRange.getDirection()
        };
        event.preventDefault();
        return false;
      } else if (hasClass(event.target, 'bottomRightSelectionHandle-HitArea')) {
        selectedRange = _this.hot.getSelectedRange();
        _this.dragged.push('bottomRight');
        _this.touchStartRange = {
          width: selectedRange.getWidth(),
          height: selectedRange.getHeight(),
          direction: selectedRange.getDirection()
        };
        event.preventDefault();
        return false;
      }
    });
    this.eventManager.addEventListener(this.hot.rootElement, 'touchend', function(event) {
      if (hasClass(event.target, 'topLeftSelectionHandle-HitArea')) {
        removeFromDragged.call(_this, 'topLeft');
        _this.touchStartRange = void 0;
        event.preventDefault();
        return false;
      } else if (hasClass(event.target, 'bottomRightSelectionHandle-HitArea')) {
        removeFromDragged.call(_this, 'bottomRight');
        _this.touchStartRange = void 0;
        event.preventDefault();
        return false;
      }
    });
    this.eventManager.addEventListener(this.hot.rootElement, 'touchmove', function(event) {
      var scrollTop = getWindowScrollTop(),
          scrollLeft = getWindowScrollLeft(),
          endTarget,
          targetCoords,
          selectedRange,
          rangeWidth,
          rangeHeight,
          rangeDirection,
          newRangeCoords;
      if (_this.dragged.length === 0) {
        return;
      }
      endTarget = document.elementFromPoint(event.touches[0].screenX - scrollLeft, event.touches[0].screenY - scrollTop);
      if (!endTarget || endTarget === _this.lastSetCell) {
        return;
      }
      if (endTarget.nodeName == 'TD' || endTarget.nodeName == 'TH') {
        targetCoords = _this.hot.getCoords(endTarget);
        if (targetCoords.col == -1) {
          targetCoords.col = 0;
        }
        selectedRange = _this.hot.getSelectedRange();
        rangeWidth = selectedRange.getWidth();
        rangeHeight = selectedRange.getHeight();
        rangeDirection = selectedRange.getDirection();
        if (rangeWidth == 1 && rangeHeight == 1) {
          _this.hot.selection.setRangeEnd(targetCoords);
        }
        newRangeCoords = _this.getCurrentRangeCoords(selectedRange, targetCoords, _this.touchStartRange.direction, rangeDirection, _this.dragged[0]);
        if (newRangeCoords.start !== null) {
          _this.hot.selection.setRangeStart(newRangeCoords.start);
        }
        _this.hot.selection.setRangeEnd(newRangeCoords.end);
        _this.lastSetCell = endTarget;
      }
      event.preventDefault();
    });
  },
  getCurrentRangeCoords: function(selectedRange, currentTouch, touchStartDirection, currentDirection, draggedHandle) {
    var topLeftCorner = selectedRange.getTopLeftCorner(),
        bottomRightCorner = selectedRange.getBottomRightCorner(),
        bottomLeftCorner = selectedRange.getBottomLeftCorner(),
        topRightCorner = selectedRange.getTopRightCorner();
    var newCoords = {
      start: null,
      end: null
    };
    switch (touchStartDirection) {
      case 'NE-SW':
        switch (currentDirection) {
          case 'NE-SW':
          case 'NW-SE':
            if (draggedHandle == 'topLeft') {
              newCoords = {
                start: new WalkontableCellCoords(currentTouch.row, selectedRange.highlight.col),
                end: new WalkontableCellCoords(bottomLeftCorner.row, currentTouch.col)
              };
            } else {
              newCoords = {
                start: new WalkontableCellCoords(selectedRange.highlight.row, currentTouch.col),
                end: new WalkontableCellCoords(currentTouch.row, topLeftCorner.col)
              };
            }
            break;
          case 'SE-NW':
            if (draggedHandle == 'bottomRight') {
              newCoords = {
                start: new WalkontableCellCoords(bottomRightCorner.row, currentTouch.col),
                end: new WalkontableCellCoords(currentTouch.row, topLeftCorner.col)
              };
            }
            break;
        }
        break;
      case 'NW-SE':
        switch (currentDirection) {
          case 'NE-SW':
            if (draggedHandle == 'topLeft') {
              newCoords = {
                start: currentTouch,
                end: bottomLeftCorner
              };
            } else {
              newCoords.end = currentTouch;
            }
            break;
          case 'NW-SE':
            if (draggedHandle == 'topLeft') {
              newCoords = {
                start: currentTouch,
                end: bottomRightCorner
              };
            } else {
              newCoords.end = currentTouch;
            }
            break;
          case 'SE-NW':
            if (draggedHandle == 'topLeft') {
              newCoords = {
                start: currentTouch,
                end: topLeftCorner
              };
            } else {
              newCoords.end = currentTouch;
            }
            break;
          case 'SW-NE':
            if (draggedHandle == 'topLeft') {
              newCoords = {
                start: currentTouch,
                end: topRightCorner
              };
            } else {
              newCoords.end = currentTouch;
            }
            break;
        }
        break;
      case 'SW-NE':
        switch (currentDirection) {
          case 'NW-SE':
            if (draggedHandle == 'bottomRight') {
              newCoords = {
                start: new WalkontableCellCoords(currentTouch.row, topLeftCorner.col),
                end: new WalkontableCellCoords(bottomLeftCorner.row, currentTouch.col)
              };
            } else {
              newCoords = {
                start: new WalkontableCellCoords(topLeftCorner.row, currentTouch.col),
                end: new WalkontableCellCoords(currentTouch.row, bottomRightCorner.col)
              };
            }
            break;
          case 'SW-NE':
            if (draggedHandle == 'topLeft') {
              newCoords = {
                start: new WalkontableCellCoords(selectedRange.highlight.row, currentTouch.col),
                end: new WalkontableCellCoords(currentTouch.row, bottomRightCorner.col)
              };
            } else {
              newCoords = {
                start: new WalkontableCellCoords(currentTouch.row, topLeftCorner.col),
                end: new WalkontableCellCoords(topLeftCorner.row, currentTouch.col)
              };
            }
            break;
          case 'SE-NW':
            if (draggedHandle == 'bottomRight') {
              newCoords = {
                start: new WalkontableCellCoords(currentTouch.row, topRightCorner.col),
                end: new WalkontableCellCoords(topLeftCorner.row, currentTouch.col)
              };
            } else if (draggedHandle == 'topLeft') {
              newCoords = {
                start: bottomLeftCorner,
                end: currentTouch
              };
            }
            break;
        }
        break;
      case 'SE-NW':
        switch (currentDirection) {
          case 'NW-SE':
          case 'NE-SW':
          case 'SW-NE':
            if (draggedHandle == 'topLeft') {
              newCoords.end = currentTouch;
            }
            break;
          case 'SE-NW':
            if (draggedHandle == 'topLeft') {
              newCoords.end = currentTouch;
            } else {
              newCoords = {
                start: currentTouch,
                end: topLeftCorner
              };
            }
            break;
        }
        break;
    }
    return newCoords;
  },
  isDragged: function() {
    return this.dragged.length > 0;
  }
}, {}, BasePlugin);
;
registerPlugin('multipleSelectionHandles', MultipleSelectionHandles);

//# 
},{"_base":62,"browser":24,"eventManager":42,"helpers/browser":44,"helpers/dom/element":47,"plugins":61}],110:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  DataObserver: {get: function() {
      return DataObserver;
    }},
  __esModule: {value: true}
});
var $__jsonpatch__,
    $___46__46__47__46__46__47_mixins_47_localHooks__,
    $___46__46__47__46__46__47_helpers_47_object__,
    $__utils__;
var jsonpatch = ($__jsonpatch__ = _dereq_("jsonpatch"), $__jsonpatch__ && $__jsonpatch__.__esModule && $__jsonpatch__ || {default: $__jsonpatch__}).default;
var localHooks = ($___46__46__47__46__46__47_mixins_47_localHooks__ = _dereq_("../../mixins/localHooks"), $___46__46__47__46__46__47_mixins_47_localHooks__ && $___46__46__47__46__46__47_mixins_47_localHooks__.__esModule && $___46__46__47__46__46__47_mixins_47_localHooks__ || {default: $___46__46__47__46__46__47_mixins_47_localHooks__}).localHooks;
var mixin = ($___46__46__47__46__46__47_helpers_47_object__ = _dereq_("../../helpers/object"), $___46__46__47__46__46__47_helpers_47_object__ && $___46__46__47__46__46__47_helpers_47_object__.__esModule && $___46__46__47__46__46__47_helpers_47_object__ || {default: $___46__46__47__46__46__47_helpers_47_object__}).mixin;
var cleanPatches = ($__utils__ = _dereq_("utils"), $__utils__ && $__utils__.__esModule && $__utils__ || {default: $__utils__}).cleanPatches;
var DataObserver = function DataObserver(observedData) {
  this.observedData = null;
  this.observer = null;
  this.paused = false;
  this.setObservedData(observedData);
};
($traceurRuntime.createClass)(DataObserver, {
  setObservedData: function(observedData) {
    var $__4 = this;
    if (this.observer) {
      jsonpatch.unobserve(this.observedData, this.observer);
    }
    this.observedData = observedData;
    this.observer = jsonpatch.observe(this.observedData, (function(patches) {
      return $__4.onChange(patches);
    }));
  },
  isPaused: function() {
    return this.paused;
  },
  pause: function() {
    this.paused = true;
  },
  resume: function() {
    this.paused = false;
  },
  onChange: function(patches) {
    this.runLocalHooks('change', cleanPatches(patches));
  },
  destroy: function() {
    jsonpatch.unobserve(this.observedData, this.observer);
    this.observedData = null;
    this.observer = null;
  }
}, {});
mixin(DataObserver, localHooks);
;

//# 
},{"../../helpers/object":53,"../../mixins/localHooks":58,"jsonpatch":"jsonpatch","utils":112}],111:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  ObserveChanges: {get: function() {
      return ObserveChanges;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__95_base__,
    $__jsonpatch__,
    $__dataObserver__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__46__46__47_plugins__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var BasePlugin = ($___46__46__47__95_base__ = _dereq_("_base"), $___46__46__47__95_base__ && $___46__46__47__95_base__.__esModule && $___46__46__47__95_base__ || {default: $___46__46__47__95_base__}).default;
var jsonpatch = ($__jsonpatch__ = _dereq_("jsonpatch"), $__jsonpatch__ && $__jsonpatch__.__esModule && $__jsonpatch__ || {default: $__jsonpatch__}).default;
var DataObserver = ($__dataObserver__ = _dereq_("dataObserver"), $__dataObserver__ && $__dataObserver__.__esModule && $__dataObserver__ || {default: $__dataObserver__}).DataObserver;
var arrayEach = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}).arrayEach;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
Handsontable.hooks.register('afterChangesObserved');
var ObserveChanges = function ObserveChanges(hotInstance) {
  $traceurRuntime.superConstructor($ObserveChanges).call(this, hotInstance);
  this.observer = null;
};
var $ObserveChanges = ObserveChanges;
($traceurRuntime.createClass)(ObserveChanges, {
  isEnabled: function() {
    return this.hot.getSettings().observeChanges;
  },
  enablePlugin: function() {
    var $__6 = this;
    if (this.enabled) {
      return;
    }
    if (!this.observer) {
      this.observer = new DataObserver(this.hot.getSourceData());
      this._exposePublicApi();
    }
    this.observer.addLocalHook('change', (function(patches) {
      return $__6.onDataChange(patches);
    }));
    this.addHook('afterCreateRow', (function() {
      return $__6.onAfterTableAlter();
    }));
    this.addHook('afterRemoveRow', (function() {
      return $__6.onAfterTableAlter();
    }));
    this.addHook('afterCreateCol', (function() {
      return $__6.onAfterTableAlter();
    }));
    this.addHook('afterRemoveCol', (function() {
      return $__6.onAfterTableAlter();
    }));
    this.addHook('afterChange', (function(changes, source) {
      return $__6.onAfterTableAlter(source);
    }));
    this.addHook('afterLoadData', (function(firstRun) {
      return $__6.onAfterLoadData(firstRun);
    }));
    $traceurRuntime.superGet(this, $ObserveChanges.prototype, "enablePlugin").call(this);
  },
  disablePlugin: function() {
    if (this.observer) {
      this.observer.destroy();
      this.observer = null;
      this._deletePublicApi();
    }
    $traceurRuntime.superGet(this, $ObserveChanges.prototype, "disablePlugin").call(this);
  },
  onDataChange: function(patches) {
    var $__6 = this;
    if (!this.observer.isPaused()) {
      var sourceName = (this.pluginName + ".change");
      var actions = {
        add: (function(patch) {
          if (isNaN(patch.col)) {
            $__6.hot.runHooks('afterCreateRow', patch.row, 1, sourceName);
          } else {
            $__6.hot.runHooks('afterCreateCol', patch.col, 1, sourceName);
          }
        }),
        remove: (function(patch) {
          if (isNaN(patch.col)) {
            $__6.hot.runHooks('afterRemoveRow', patch.row, 1, sourceName);
          } else {
            $__6.hot.runHooks('afterRemoveCol', patch.col, 1, sourceName);
          }
        }),
        replace: (function(patch) {
          $__6.hot.runHooks('afterChange', [patch.row, patch.col, null, patch.value], sourceName);
        })
      };
      arrayEach(patches, (function(patch) {
        if (actions[patch.op]) {
          actions[patch.op](patch);
        }
      }));
      this.hot.render();
    }
    this.hot.runHooks('afterChangesObserved');
  },
  onAfterTableAlter: function(source) {
    var $__6 = this;
    if (source !== 'loadData') {
      this.observer.pause();
      this.hot.addHookOnce('afterChangesObserved', (function() {
        return $__6.observer.resume();
      }));
    }
  },
  onAfterLoadData: function(firstRun) {
    if (!firstRun) {
      this.observer.setObservedData(this.hot.getSourceData());
    }
  },
  destroy: function() {
    if (this.observer) {
      this.observer.destroy();
      this._deletePublicApi();
    }
    $traceurRuntime.superGet(this, $ObserveChanges.prototype, "destroy").call(this);
  },
  _exposePublicApi: function() {
    var $__6 = this;
    var hot = this.hot;
    hot.pauseObservingChanges = (function() {
      return $__6.observer.pause();
    });
    hot.resumeObservingChanges = (function() {
      return $__6.observer.resume();
    });
    hot.isPausedObservingChanges = (function() {
      return $__6.observer.isPaused();
    });
  },
  _deletePublicApi: function() {
    var hot = this.hot;
    delete hot.pauseObservingChanges;
    delete hot.resumeObservingChanges;
    delete hot.isPausedObservingChanges;
  }
}, {}, BasePlugin);
;
registerPlugin('observeChanges', ObserveChanges);

//# 
},{"_base":62,"browser":24,"dataObserver":110,"helpers/array":43,"jsonpatch":"jsonpatch","plugins":61}],112:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  cleanPatches: {get: function() {
      return cleanPatches;
    }},
  parsePath: {get: function() {
      return parsePath;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_helpers_47_array__;
var $__0 = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("../../helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}),
    arrayFilter = $__0.arrayFilter,
    arrayMap = $__0.arrayMap;
function cleanPatches(patches) {
  var newOrRemovedColumns = [];
  patches = arrayFilter(patches, (function(patch) {
    if (/[/]length/ig.test(patch.path)) {
      return false;
    }
    if (!parsePath(patch.path)) {
      return false;
    }
    return true;
  }));
  patches = arrayMap(patches, (function(patch) {
    var coords = parsePath(patch.path);
    patch.row = coords.row;
    patch.col = coords.col;
    return patch;
  }));
  patches = arrayFilter(patches, function(patch) {
    if (['add', 'remove'].indexOf(patch.op) !== -1 && !isNaN(patch.col)) {
      if (newOrRemovedColumns.indexOf(patch.col) !== -1) {
        return false;
      }
      newOrRemovedColumns.push(patch.col);
    }
    return true;
  });
  newOrRemovedColumns.length = 0;
  return patches;
}
function parsePath(path) {
  var match = path.match(/^\/(\d+)\/?(.*)?$/);
  if (!match) {
    return null;
  }
  var $__1 = match,
      row = $__1[1],
      column = $__1[2];
  return {
    row: parseInt(row, 10),
    col: /^\d*$/.test(column) ? parseInt(column, 10) : column
  };
}

//# 
},{"../../helpers/array":43}],113:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  HandsontablePersistentState: {get: function() {
      return HandsontablePersistentState;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__46__46__47_plugins__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
;
function Storage(prefix) {
  var savedKeys;
  var saveSavedKeys = function() {
    window.localStorage[prefix + '__' + 'persistentStateKeys'] = JSON.stringify(savedKeys);
  };
  var loadSavedKeys = function() {
    var keysJSON = window.localStorage[prefix + '__' + 'persistentStateKeys'];
    var keys = typeof keysJSON == 'string' ? JSON.parse(keysJSON) : void 0;
    savedKeys = keys ? keys : [];
  };
  var clearSavedKeys = function() {
    savedKeys = [];
    saveSavedKeys();
  };
  loadSavedKeys();
  this.saveValue = function(key, value) {
    window.localStorage[prefix + '_' + key] = JSON.stringify(value);
    if (savedKeys.indexOf(key) == -1) {
      savedKeys.push(key);
      saveSavedKeys();
    }
  };
  this.loadValue = function(key, defaultValue) {
    key = typeof key === 'undefined' ? defaultValue : key;
    var value = window.localStorage[prefix + '_' + key];
    return typeof value == 'undefined' ? void 0 : JSON.parse(value);
  };
  this.reset = function(key) {
    window.localStorage.removeItem(prefix + '_' + key);
  };
  this.resetAll = function() {
    for (var index = 0; index < savedKeys.length; index++) {
      window.localStorage.removeItem(prefix + '_' + savedKeys[index]);
    }
    clearSavedKeys();
  };
}
function HandsontablePersistentState() {
  var plugin = this;
  this.init = function() {
    var instance = this,
        pluginSettings = instance.getSettings().persistentState;
    plugin.enabled = !!(pluginSettings);
    if (!plugin.enabled) {
      removeHooks.call(instance);
      return;
    }
    if (!instance.storage) {
      instance.storage = new Storage(instance.rootElement.id);
    }
    instance.resetState = plugin.resetValue;
    addHooks.call(instance);
  };
  this.saveValue = function(key, value) {
    var instance = this;
    instance.storage.saveValue(key, value);
  };
  this.loadValue = function(key, saveTo) {
    var instance = this;
    saveTo.value = instance.storage.loadValue(key);
  };
  this.resetValue = function(key) {
    var instance = this;
    if (typeof key === 'undefined') {
      instance.storage.resetAll();
    } else {
      instance.storage.reset(key);
    }
  };
  var hooks = {
    persistentStateSave: plugin.saveValue,
    persistentStateLoad: plugin.loadValue,
    persistentStateReset: plugin.resetValue
  };
  for (var hookName in hooks) {
    if (hooks.hasOwnProperty(hookName)) {
      Handsontable.hooks.register(hookName);
    }
  }
  function addHooks() {
    var instance = this;
    for (var hookName in hooks) {
      if (hooks.hasOwnProperty(hookName)) {
        instance.addHook(hookName, hooks[hookName]);
      }
    }
  }
  function removeHooks() {
    var instance = this;
    for (var hookName in hooks) {
      if (hooks.hasOwnProperty(hookName)) {
        instance.removeHook(hookName, hooks[hookName]);
      }
    }
  }
}
var htPersistentState = new HandsontablePersistentState();
Handsontable.hooks.add('beforeInit', htPersistentState.init);
Handsontable.hooks.add('afterUpdateSettings', htPersistentState.init);

//# 
},{"browser":24,"plugins":61}],114:[function(_dereq_,module,exports){
"use strict";
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47_renderers__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var $__1 = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}),
    addClass = $__1.addClass,
    removeClass = $__1.removeClass;
var $__2 = ($___46__46__47__46__46__47_renderers__ = _dereq_("renderers"), $___46__46__47__46__46__47_renderers__ && $___46__46__47__46__46__47_renderers__.__esModule && $___46__46__47__46__46__47_renderers__ || {default: $___46__46__47__46__46__47_renderers__}),
    registerRenderer = $__2.registerRenderer,
    getRenderer = $__2.getRenderer;
Handsontable.Search = function Search(instance) {
  this.query = function(queryStr, callback, queryMethod) {
    var rowCount = instance.countRows();
    var colCount = instance.countCols();
    var queryResult = [];
    if (!callback) {
      callback = Handsontable.Search.global.getDefaultCallback();
    }
    if (!queryMethod) {
      queryMethod = Handsontable.Search.global.getDefaultQueryMethod();
    }
    for (var rowIndex = 0; rowIndex < rowCount; rowIndex++) {
      for (var colIndex = 0; colIndex < colCount; colIndex++) {
        var cellData = instance.getDataAtCell(rowIndex, colIndex);
        var cellProperties = instance.getCellMeta(rowIndex, colIndex);
        var cellCallback = cellProperties.search.callback || callback;
        var cellQueryMethod = cellProperties.search.queryMethod || queryMethod;
        var testResult = cellQueryMethod(queryStr, cellData);
        if (testResult) {
          var singleResult = {
            row: rowIndex,
            col: colIndex,
            data: cellData
          };
          queryResult.push(singleResult);
        }
        if (cellCallback) {
          cellCallback(instance, rowIndex, colIndex, cellData, testResult);
        }
      }
    }
    return queryResult;
  };
};
Handsontable.Search.DEFAULT_CALLBACK = function(instance, row, col, data, testResult) {
  instance.getCellMeta(row, col).isSearchResult = testResult;
};
Handsontable.Search.DEFAULT_QUERY_METHOD = function(query, value) {
  if (typeof query == 'undefined' || query == null || !query.toLowerCase || query.length === 0) {
    return false;
  }
  if (typeof value == 'undefined' || value == null) {
    return false;
  }
  return value.toString().toLowerCase().indexOf(query.toLowerCase()) != -1;
};
Handsontable.Search.DEFAULT_SEARCH_RESULT_CLASS = 'htSearchResult';
Handsontable.Search.global = (function() {
  var defaultCallback = Handsontable.Search.DEFAULT_CALLBACK;
  var defaultQueryMethod = Handsontable.Search.DEFAULT_QUERY_METHOD;
  var defaultSearchResultClass = Handsontable.Search.DEFAULT_SEARCH_RESULT_CLASS;
  return {
    getDefaultCallback: function() {
      return defaultCallback;
    },
    setDefaultCallback: function(newDefaultCallback) {
      defaultCallback = newDefaultCallback;
    },
    getDefaultQueryMethod: function() {
      return defaultQueryMethod;
    },
    setDefaultQueryMethod: function(newDefaultQueryMethod) {
      defaultQueryMethod = newDefaultQueryMethod;
    },
    getDefaultSearchResultClass: function() {
      return defaultSearchResultClass;
    },
    setDefaultSearchResultClass: function(newSearchResultClass) {
      defaultSearchResultClass = newSearchResultClass;
    }
  };
})();
Handsontable.SearchCellDecorator = function(instance, TD, row, col, prop, value, cellProperties) {
  var searchResultClass = (cellProperties.search !== null && typeof cellProperties.search == 'object' && cellProperties.search.searchResultClass) || Handsontable.Search.global.getDefaultSearchResultClass();
  if (cellProperties.isSearchResult) {
    addClass(TD, searchResultClass);
  } else {
    removeClass(TD, searchResultClass);
  }
};
var originalBaseRenderer = getRenderer('base');
registerRenderer('base', function(instance, TD, row, col, prop, value, cellProperties) {
  originalBaseRenderer.apply(this, arguments);
  Handsontable.SearchCellDecorator.apply(this, arguments);
});
function init() {
  var instance = this;
  var pluginEnabled = !!instance.getSettings().search;
  if (pluginEnabled) {
    instance.search = new Handsontable.Search(instance);
  } else {
    delete instance.search;
  }
}
Handsontable.hooks.add('afterInit', init);
Handsontable.hooks.add('afterUpdateSettings', init);

//# 
},{"browser":24,"helpers/dom/element":47,"renderers":117}],115:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  TouchScroll: {get: function() {
      return TouchScroll;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__46__46__47_helpers_47_dom_47_element__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__95_base__,
    $___46__46__47__46__46__47_plugins__,
    $___46__46__47__46__46__47_helpers_47_feature__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var $__1 = ($___46__46__47__46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47__46__46__47_helpers_47_dom_47_element__ && $___46__46__47__46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_element__}),
    addClass = $__1.addClass,
    removeClass = $__1.removeClass;
var arrayEach = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}).arrayEach;
var BasePlugin = ($___46__46__47__95_base__ = _dereq_("_base"), $___46__46__47__95_base__ && $___46__46__47__95_base__.__esModule && $___46__46__47__95_base__ || {default: $___46__46__47__95_base__}).default;
var registerPlugin = ($___46__46__47__46__46__47_plugins__ = _dereq_("plugins"), $___46__46__47__46__46__47_plugins__ && $___46__46__47__46__46__47_plugins__.__esModule && $___46__46__47__46__46__47_plugins__ || {default: $___46__46__47__46__46__47_plugins__}).registerPlugin;
var isTouchSupported = ($___46__46__47__46__46__47_helpers_47_feature__ = _dereq_("helpers/feature"), $___46__46__47__46__46__47_helpers_47_feature__ && $___46__46__47__46__46__47_helpers_47_feature__.__esModule && $___46__46__47__46__46__47_helpers_47_feature__ || {default: $___46__46__47__46__46__47_helpers_47_feature__}).isTouchSupported;
var TouchScroll = function TouchScroll(hotInstance) {
  $traceurRuntime.superConstructor($TouchScroll).call(this, hotInstance);
  this.scrollbars = [];
  this.clones = [];
  this.lockedCollection = false;
};
var $TouchScroll = TouchScroll;
($traceurRuntime.createClass)(TouchScroll, {
  isEnabled: function() {
    return isTouchSupported();
  },
  enablePlugin: function() {
    var $__6 = this;
    if (this.enabled) {
      return;
    }
    this.addHook('afterRender', (function() {
      return $__6.onAfterRender();
    }));
    this.registerEvents();
    $traceurRuntime.superGet(this, $TouchScroll.prototype, "enablePlugin").call(this);
  },
  updatePlugin: function() {
    this.lockedCollection = false;
    $traceurRuntime.superGet(this, $TouchScroll.prototype, "updatePlugin").call(this);
  },
  disablePlugin: function() {
    $traceurRuntime.superGet(this, $TouchScroll.prototype, "disablePlugin").call(this);
  },
  registerEvents: function() {
    var $__6 = this;
    this.addHook('beforeTouchScroll', (function() {
      return $__6.onBeforeTouchScroll();
    }));
    this.addHook('afterMomentumScroll', (function() {
      return $__6.onAfterMomentumScroll();
    }));
  },
  onAfterRender: function() {
    if (this.lockedCollection) {
      return;
    }
    var $__8 = this.hot.view.wt.wtOverlays,
        topOverlay = $__8.topOverlay,
        bottomOverlay = $__8.bottomOverlay,
        leftOverlay = $__8.leftOverlay,
        topLeftCornerOverlay = $__8.topLeftCornerOverlay,
        bottomLeftCornerOverlay = $__8.bottomLeftCornerOverlay;
    this.lockedCollection = true;
    this.scrollbars.length = 0;
    this.scrollbars.push(topOverlay);
    if (bottomOverlay.clone) {
      this.scrollbars.push(bottomOverlay);
    }
    this.scrollbars.push(leftOverlay);
    if (topLeftCornerOverlay) {
      this.scrollbars.push(topLeftCornerOverlay);
    }
    if (bottomLeftCornerOverlay && bottomLeftCornerOverlay.clone) {
      this.scrollbars.push(bottomLeftCornerOverlay);
    }
    this.clones.length = 0;
    if (topOverlay.needFullRender) {
      this.clones.push(topOverlay.clone.wtTable.holder.parentNode);
    }
    if (bottomOverlay.needFullRender) {
      this.clones.push(bottomOverlay.clone.wtTable.holder.parentNode);
    }
    if (leftOverlay.needFullRender) {
      this.clones.push(leftOverlay.clone.wtTable.holder.parentNode);
    }
    if (topLeftCornerOverlay) {
      this.clones.push(topLeftCornerOverlay.clone.wtTable.holder.parentNode);
    }
    if (bottomLeftCornerOverlay && bottomLeftCornerOverlay.clone) {
      this.clones.push(bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);
    }
  },
  onBeforeTouchScroll: function() {
    Handsontable.freezeOverlays = true;
    arrayEach(this.clones, (function(clone) {
      addClass(clone, 'hide-tween');
    }));
  },
  onAfterMomentumScroll: function() {
    var $__6 = this;
    Handsontable.freezeOverlays = false;
    arrayEach(this.clones, (function(clone) {
      removeClass(clone, 'hide-tween');
      addClass(clone, 'show-tween');
    }));
    setTimeout((function() {
      arrayEach($__6.clones, (function(clone) {
        removeClass(clone, 'show-tween');
      }));
    }), 400);
    arrayEach(this.scrollbars, (function(scrollbar) {
      scrollbar.refresh();
      scrollbar.resetFixedPosition();
    }));
    this.hot.view.wt.wtOverlays.syncScrollWithMaster();
  }
}, {}, BasePlugin);
;
registerPlugin('touchScroll', TouchScroll);

//# 
},{"_base":62,"browser":24,"helpers/array":43,"helpers/dom/element":47,"helpers/feature":49,"plugins":61}],116:[function(_dereq_,module,exports){
"use strict";
var $___46__46__47__46__46__47_browser__,
    $___46__46__47__46__46__47_helpers_47_array__,
    $___46__46__47__46__46__47_helpers_47_number__,
    $___46__46__47__46__46__47_helpers_47_object__,
    $___46__46__47__46__46__47_helpers_47_dom_47_event__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var arrayMap = ($___46__46__47__46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47__46__46__47_helpers_47_array__ && $___46__46__47__46__46__47_helpers_47_array__.__esModule && $___46__46__47__46__46__47_helpers_47_array__ || {default: $___46__46__47__46__46__47_helpers_47_array__}).arrayMap;
var rangeEach = ($___46__46__47__46__46__47_helpers_47_number__ = _dereq_("helpers/number"), $___46__46__47__46__46__47_helpers_47_number__ && $___46__46__47__46__46__47_helpers_47_number__.__esModule && $___46__46__47__46__46__47_helpers_47_number__ || {default: $___46__46__47__46__46__47_helpers_47_number__}).rangeEach;
var $__3 = ($___46__46__47__46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47__46__46__47_helpers_47_object__ && $___46__46__47__46__46__47_helpers_47_object__.__esModule && $___46__46__47__46__46__47_helpers_47_object__ || {default: $___46__46__47__46__46__47_helpers_47_object__}),
    inherit = $__3.inherit,
    deepClone = $__3.deepClone;
var stopImmediatePropagation = ($___46__46__47__46__46__47_helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $___46__46__47__46__46__47_helpers_47_dom_47_event__ && $___46__46__47__46__46__47_helpers_47_dom_47_event__.__esModule && $___46__46__47__46__46__47_helpers_47_dom_47_event__ || {default: $___46__46__47__46__46__47_helpers_47_dom_47_event__}).stopImmediatePropagation;
Handsontable.UndoRedo = function(instance) {
  var plugin = this;
  this.instance = instance;
  this.doneActions = [];
  this.undoneActions = [];
  this.ignoreNewActions = false;
  instance.addHook('afterChange', function(changes, source) {
    if (changes && source !== 'UndoRedo.undo' && source !== 'UndoRedo.redo') {
      plugin.done(new Handsontable.UndoRedo.ChangeAction(changes));
    }
  });
  instance.addHook('afterCreateRow', function(index, amount, source) {
    if (source === 'UndoRedo.undo' || source === 'UndoRedo.undo' || source === 'auto') {
      return;
    }
    var action = new Handsontable.UndoRedo.CreateRowAction(index, amount);
    plugin.done(action);
  });
  instance.addHook('beforeRemoveRow', function(index, amount, logicRows, source) {
    if (source === 'UndoRedo.undo' || source === 'UndoRedo.redo' || source === 'auto') {
      return;
    }
    var originalData = plugin.instance.getSourceDataArray();
    index = (originalData.length + index) % originalData.length;
    var removedData = deepClone(originalData.slice(index, index + amount));
    plugin.done(new Handsontable.UndoRedo.RemoveRowAction(index, removedData));
  });
  instance.addHook('afterCreateCol', function(index, amount, source) {
    if (source === 'UndoRedo.undo' || source === 'UndoRedo.redo' || source === 'auto') {
      return;
    }
    plugin.done(new Handsontable.UndoRedo.CreateColumnAction(index, amount));
  });
  instance.addHook('beforeRemoveCol', function(index, amount, logicColumns, source) {
    if (source === 'UndoRedo.undo' || source === 'UndoRedo.redo' || source === 'auto') {
      return;
    }
    var originalData = plugin.instance.getSourceDataArray();
    index = (plugin.instance.countCols() + index) % plugin.instance.countCols();
    var removedData = [];
    var headers = [];
    var indexes = [];
    rangeEach(originalData.length - 1, (function(i) {
      var column = [];
      var origRow = originalData[i];
      rangeEach(index, index + (amount - 1), (function(j) {
        column.push(origRow[instance.runHooks('modifyCol', j)]);
      }));
      removedData.push(column);
    }));
    rangeEach(amount - 1, (function(i) {
      indexes.push(instance.runHooks('modifyCol', index + i));
    }));
    if (Array.isArray(instance.getSettings().colHeaders)) {
      rangeEach(amount - 1, (function(i) {
        headers.push(instance.getSettings().colHeaders[instance.runHooks('modifyCol', index + i)] || null);
      }));
    }
    var manualColumnMovePlugin = plugin.instance.getPlugin('manualColumnMove');
    var columnsMap = manualColumnMovePlugin.isEnabled() ? manualColumnMovePlugin.columnsMapper.__arrayMap : [];
    var action = new Handsontable.UndoRedo.RemoveColumnAction(index, indexes, removedData, headers, columnsMap);
    plugin.done(action);
  });
  instance.addHook('beforeCellAlignment', function(stateBefore, range, type, alignment) {
    var action = new Handsontable.UndoRedo.CellAlignmentAction(stateBefore, range, type, alignment);
    plugin.done(action);
  });
  instance.addHook('beforeFilter', function(formulaStacks) {
    plugin.done(new Handsontable.UndoRedo.FiltersAction(formulaStacks));
  });
  instance.addHook('beforeRowMove', function(movedRows, target) {
    if (movedRows === false) {
      return;
    }
    plugin.done(new Handsontable.UndoRedo.RowMoveAction(movedRows, target));
  });
};
Handsontable.UndoRedo.prototype.done = function(action) {
  if (!this.ignoreNewActions) {
    this.doneActions.push(action);
    this.undoneActions.length = 0;
  }
};
Handsontable.UndoRedo.prototype.undo = function() {
  if (this.isUndoAvailable()) {
    var action = this.doneActions.pop();
    var actionClone = deepClone(action);
    var instance = this.instance;
    var continueAction = instance.runHooks('beforeUndo', actionClone);
    if (continueAction === false) {
      return;
    }
    this.ignoreNewActions = true;
    var that = this;
    action.undo(this.instance, function() {
      that.ignoreNewActions = false;
      that.undoneActions.push(action);
    });
    instance.runHooks('afterUndo', actionClone);
  }
};
Handsontable.UndoRedo.prototype.redo = function() {
  if (this.isRedoAvailable()) {
    var action = this.undoneActions.pop();
    var actionClone = deepClone(action);
    var instance = this.instance;
    var continueAction = instance.runHooks('beforeRedo', actionClone);
    if (continueAction === false) {
      return;
    }
    this.ignoreNewActions = true;
    var that = this;
    action.redo(this.instance, function() {
      that.ignoreNewActions = false;
      that.doneActions.push(action);
    });
    instance.runHooks('afterRedo', actionClone);
  }
};
Handsontable.UndoRedo.prototype.isUndoAvailable = function() {
  return this.doneActions.length > 0;
};
Handsontable.UndoRedo.prototype.isRedoAvailable = function() {
  return this.undoneActions.length > 0;
};
Handsontable.UndoRedo.prototype.clear = function() {
  this.doneActions.length = 0;
  this.undoneActions.length = 0;
};
Handsontable.UndoRedo.Action = function() {};
Handsontable.UndoRedo.Action.prototype.undo = function() {};
Handsontable.UndoRedo.Action.prototype.redo = function() {};
Handsontable.UndoRedo.ChangeAction = function(changes) {
  this.changes = changes;
  this.actionType = 'change';
};
inherit(Handsontable.UndoRedo.ChangeAction, Handsontable.UndoRedo.Action);
Handsontable.UndoRedo.ChangeAction.prototype.undo = function(instance, undoneCallback) {
  var data = deepClone(this.changes),
      emptyRowsAtTheEnd = instance.countEmptyRows(true),
      emptyColsAtTheEnd = instance.countEmptyCols(true);
  for (var i = 0,
      len = data.length; i < len; i++) {
    data[i].splice(3, 1);
  }
  instance.addHookOnce('afterChange', undoneCallback);
  instance.setDataAtRowProp(data, null, null, 'UndoRedo.undo');
  for (var i$__6 = 0,
      len$__7 = data.length; i$__6 < len$__7; i$__6++) {
    if (instance.getSettings().minSpareRows && data[i$__6][0] + 1 + instance.getSettings().minSpareRows === instance.countRows() && emptyRowsAtTheEnd == instance.getSettings().minSpareRows) {
      instance.alter('remove_row', parseInt(data[i$__6][0] + 1, 10), instance.getSettings().minSpareRows);
      instance.undoRedo.doneActions.pop();
    }
    if (instance.getSettings().minSpareCols && data[i$__6][1] + 1 + instance.getSettings().minSpareCols === instance.countCols() && emptyColsAtTheEnd == instance.getSettings().minSpareCols) {
      instance.alter('remove_col', parseInt(data[i$__6][1] + 1, 10), instance.getSettings().minSpareCols);
      instance.undoRedo.doneActions.pop();
    }
  }
};
Handsontable.UndoRedo.ChangeAction.prototype.redo = function(instance, onFinishCallback) {
  var data = deepClone(this.changes);
  for (var i = 0,
      len = data.length; i < len; i++) {
    data[i].splice(2, 1);
  }
  instance.addHookOnce('afterChange', onFinishCallback);
  instance.setDataAtRowProp(data, null, null, 'UndoRedo.redo');
};
Handsontable.UndoRedo.CreateRowAction = function(index, amount) {
  this.index = index;
  this.amount = amount;
  this.actionType = 'insert_row';
};
inherit(Handsontable.UndoRedo.CreateRowAction, Handsontable.UndoRedo.Action);
Handsontable.UndoRedo.CreateRowAction.prototype.undo = function(instance, undoneCallback) {
  var rowCount = instance.countRows(),
      minSpareRows = instance.getSettings().minSpareRows;
  if (this.index >= rowCount && this.index - minSpareRows < rowCount) {
    this.index -= minSpareRows;
  }
  instance.addHookOnce('afterRemoveRow', undoneCallback);
  instance.alter('remove_row', this.index, this.amount, 'UndoRedo.undo');
};
Handsontable.UndoRedo.CreateRowAction.prototype.redo = function(instance, redoneCallback) {
  instance.addHookOnce('afterCreateRow', redoneCallback);
  instance.alter('insert_row', this.index, this.amount, 'UndoRedo.redo');
};
Handsontable.UndoRedo.RemoveRowAction = function(index, data) {
  this.index = index;
  this.data = data;
  this.actionType = 'remove_row';
};
inherit(Handsontable.UndoRedo.RemoveRowAction, Handsontable.UndoRedo.Action);
Handsontable.UndoRedo.RemoveRowAction.prototype.undo = function(instance, undoneCallback) {
  instance.alter('insert_row', this.index, this.data.length, 'UndoRedo.undo');
  instance.addHookOnce('afterRender', undoneCallback);
  instance.populateFromArray(this.index, 0, this.data, void 0, void 0, 'UndoRedo.undo');
};
Handsontable.UndoRedo.RemoveRowAction.prototype.redo = function(instance, redoneCallback) {
  instance.addHookOnce('afterRemoveRow', redoneCallback);
  instance.alter('remove_row', this.index, this.data.length, 'UndoRedo.redo');
};
Handsontable.UndoRedo.CreateColumnAction = function(index, amount) {
  this.index = index;
  this.amount = amount;
  this.actionType = 'insert_col';
};
inherit(Handsontable.UndoRedo.CreateColumnAction, Handsontable.UndoRedo.Action);
Handsontable.UndoRedo.CreateColumnAction.prototype.undo = function(instance, undoneCallback) {
  instance.addHookOnce('afterRemoveCol', undoneCallback);
  instance.alter('remove_col', this.index, this.amount, 'UndoRedo.undo');
};
Handsontable.UndoRedo.CreateColumnAction.prototype.redo = function(instance, redoneCallback) {
  instance.addHookOnce('afterCreateCol', redoneCallback);
  instance.alter('insert_col', this.index, this.amount, 'UndoRedo.redo');
};
Handsontable.UndoRedo.RemoveColumnAction = function(index, indexes, data, headers, columnPositions) {
  this.index = index;
  this.indexes = indexes;
  this.data = data;
  this.amount = this.data[0].length;
  this.headers = headers;
  this.columnPositions = columnPositions.slice(0);
  this.actionType = 'remove_col';
};
inherit(Handsontable.UndoRedo.RemoveColumnAction, Handsontable.UndoRedo.Action);
Handsontable.UndoRedo.RemoveColumnAction.prototype.undo = function(instance, undoneCallback) {
  var $__5 = this;
  var row;
  var ascendingIndexes = this.indexes.slice(0).sort();
  var sortByIndexes = (function(elem, j, arr) {
    return arr[$__5.indexes.indexOf(ascendingIndexes[j])];
  });
  var sortedData = [];
  rangeEach(this.data.length - 1, (function(i) {
    sortedData[i] = arrayMap($__5.data[i], sortByIndexes);
  }));
  var sortedHeaders = [];
  sortedHeaders = arrayMap(this.headers, sortByIndexes);
  var changes = [];
  Handsontable.hooks.run(instance, 'beforeCreateCol', this.indexes[0], this.indexes[this.indexes.length - 1], 'UndoRedo.undo');
  rangeEach(this.data.length - 1, (function(i) {
    row = instance.getSourceDataAtRow(i);
    rangeEach(ascendingIndexes.length - 1, (function(j) {
      row.splice(ascendingIndexes[j], 0, sortedData[i][j]);
      changes.push([i, ascendingIndexes[j], null, sortedData[i][j]]);
    }));
  }));
  if (instance.getPlugin('formulas')) {
    instance.getPlugin('formulas').onAfterSetDataAtCell(changes);
  }
  if (typeof this.headers !== 'undefined') {
    rangeEach(sortedHeaders.length - 1, (function(j) {
      instance.getSettings().colHeaders.splice(ascendingIndexes[j], 0, sortedHeaders[j]);
    }));
  }
  if (instance.getPlugin('manualColumnMove')) {
    instance.getPlugin('manualColumnMove').columnsMapper.__arrayMap = this.columnPositions;
  }
  instance.addHookOnce('afterRender', undoneCallback);
  Handsontable.hooks.run(instance, 'afterCreateCol', this.indexes[0], this.indexes[this.indexes.length - 1], 'UndoRedo.undo');
  if (instance.getPlugin('formulas')) {
    instance.getPlugin('formulas').recalculateFull();
  }
  instance.render();
};
Handsontable.UndoRedo.RemoveColumnAction.prototype.redo = function(instance, redoneCallback) {
  instance.addHookOnce('afterRemoveCol', redoneCallback);
  instance.alter('remove_col', this.index, this.amount, 'UndoRedo.redo');
};
Handsontable.UndoRedo.CellAlignmentAction = function(stateBefore, range, type, alignment) {
  this.stateBefore = stateBefore;
  this.range = range;
  this.type = type;
  this.alignment = alignment;
};
Handsontable.UndoRedo.CellAlignmentAction.prototype.undo = function(instance, undoneCallback) {
  if (!instance.getPlugin('contextMenu').isEnabled()) {
    return;
  }
  for (var row = this.range.from.row; row <= this.range.to.row; row++) {
    for (var col = this.range.from.col; col <= this.range.to.col; col++) {
      instance.setCellMeta(row, col, 'className', this.stateBefore[row][col] || ' htLeft');
    }
  }
  instance.addHookOnce('afterRender', undoneCallback);
  instance.render();
};
Handsontable.UndoRedo.CellAlignmentAction.prototype.redo = function(instance, undoneCallback) {
  if (!instance.getPlugin('contextMenu').isEnabled()) {
    return;
  }
  instance.selectCell(this.range.from.row, this.range.from.col, this.range.to.row, this.range.to.col);
  instance.getPlugin('contextMenu').executeCommand('alignment:' + this.alignment.replace('ht', '').toLowerCase());
  instance.addHookOnce('afterRender', undoneCallback);
  instance.render();
};
Handsontable.UndoRedo.FiltersAction = function(formulaStacks) {
  this.formulaStacks = formulaStacks;
  this.actionType = 'filter';
};
inherit(Handsontable.UndoRedo.FiltersAction, Handsontable.UndoRedo.Action);
Handsontable.UndoRedo.FiltersAction.prototype.undo = function(instance, undoneCallback) {
  var filters = instance.getPlugin('filters');
  instance.addHookOnce('afterRender', undoneCallback);
  filters.formulaCollection.importAllFormulas(this.formulaStacks.slice(0, this.formulaStacks.length - 1));
  filters.filter();
};
Handsontable.UndoRedo.FiltersAction.prototype.redo = function(instance, redoneCallback) {
  var filters = instance.getPlugin('filters');
  instance.addHookOnce('afterRender', redoneCallback);
  filters.formulaCollection.importAllFormulas(this.formulaStacks);
  filters.filter();
};
Handsontable.UndoRedo.RowMoveAction = function(movedRows, target) {
  this.rows = movedRows.slice();
  this.target = target;
};
inherit(Handsontable.UndoRedo.RowMoveAction, Handsontable.UndoRedo.Action);
Handsontable.UndoRedo.RowMoveAction.prototype.undo = function(instance, undoneCallback) {
  var manualRowMove = instance.getPlugin('manualRowMove');
  instance.addHookOnce('afterRender', undoneCallback);
  var mod = this.rows[0] < this.target ? -1 * this.rows.length : 0;
  var newTarget = this.rows[0] > this.target ? this.rows[0] + this.rows.length : this.rows[0];
  var newRows = [];
  var rowsLen = this.rows.length + mod;
  for (var i = mod; i < rowsLen; i++) {
    newRows.push(this.target + i);
  }
  manualRowMove.moveRows(newRows.slice(), newTarget);
  instance.render();
  instance.selection.setRangeStartOnly(new WalkontableCellCoords(this.rows[0], 0));
  instance.selection.setRangeEnd(new WalkontableCellCoords(this.rows[this.rows.length - 1], instance.countCols() - 1));
};
Handsontable.UndoRedo.RowMoveAction.prototype.redo = function(instance, redoneCallback) {
  var manualRowMove = instance.getPlugin('manualRowMove');
  instance.addHookOnce('afterRender', redoneCallback);
  manualRowMove.moveRows(this.rows.slice(), this.target);
  instance.render();
  var startSelection = this.rows[0] < this.target ? this.target - this.rows.length : this.target;
  instance.selection.setRangeStartOnly(new WalkontableCellCoords(startSelection, 0));
  instance.selection.setRangeEnd(new WalkontableCellCoords(startSelection + this.rows.length - 1, instance.countCols() - 1));
};
function init() {
  var instance = this;
  var pluginEnabled = typeof instance.getSettings().undo == 'undefined' || instance.getSettings().undo;
  if (pluginEnabled) {
    if (!instance.undoRedo) {
      instance.undoRedo = new Handsontable.UndoRedo(instance);
      exposeUndoRedoMethods(instance);
      instance.addHook('beforeKeyDown', onBeforeKeyDown);
      instance.addHook('afterChange', onAfterChange);
    }
  } else {
    if (instance.undoRedo) {
      delete instance.undoRedo;
      removeExposedUndoRedoMethods(instance);
      instance.removeHook('beforeKeyDown', onBeforeKeyDown);
      instance.removeHook('afterChange', onAfterChange);
    }
  }
}
function onBeforeKeyDown(event) {
  var instance = this;
  var ctrlDown = (event.ctrlKey || event.metaKey) && !event.altKey;
  if (ctrlDown) {
    if (event.keyCode === 89 || (event.shiftKey && event.keyCode === 90)) {
      instance.undoRedo.redo();
      stopImmediatePropagation(event);
    } else if (event.keyCode === 90) {
      instance.undoRedo.undo();
      stopImmediatePropagation(event);
    }
  }
}
function onAfterChange(changes, source) {
  var instance = this;
  if (source === 'loadData') {
    return instance.undoRedo.clear();
  }
}
function exposeUndoRedoMethods(instance) {
  instance.undo = function() {
    return instance.undoRedo.undo();
  };
  instance.redo = function() {
    return instance.undoRedo.redo();
  };
  instance.isUndoAvailable = function() {
    return instance.undoRedo.isUndoAvailable();
  };
  instance.isRedoAvailable = function() {
    return instance.undoRedo.isRedoAvailable();
  };
  instance.clearUndo = function() {
    return instance.undoRedo.clear();
  };
}
function removeExposedUndoRedoMethods(instance) {
  delete instance.undo;
  delete instance.redo;
  delete instance.isUndoAvailable;
  delete instance.isRedoAvailable;
  delete instance.clearUndo;
}
Handsontable.hooks.add('afterInit', init);
Handsontable.hooks.add('afterUpdateSettings', init);
Handsontable.hooks.register('beforeUndo');
Handsontable.hooks.register('afterUndo');
Handsontable.hooks.register('beforeRedo');
Handsontable.hooks.register('afterRedo');

//# 
},{"browser":24,"helpers/array":43,"helpers/dom/event":48,"helpers/number":52,"helpers/object":53}],117:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  registerRenderer: {get: function() {
      return registerRenderer;
    }},
  getRenderer: {get: function() {
      return getRenderer;
    }},
  hasRenderer: {get: function() {
      return hasRenderer;
    }},
  __esModule: {value: true}
});
var $__browser__,
    $__helpers_47_string__;
var Handsontable = ($__browser__ = _dereq_("browser"), $__browser__ && $__browser__.__esModule && $__browser__ || {default: $__browser__}).default;
var toUpperCaseFirst = ($__helpers_47_string__ = _dereq_("helpers/string"), $__helpers_47_string__ && $__helpers_47_string__.__esModule && $__helpers_47_string__ || {default: $__helpers_47_string__}).toUpperCaseFirst;
var registeredRenderers = {};
Handsontable.renderers = Handsontable.renderers || {};
Handsontable.renderers.registerRenderer = registerRenderer;
Handsontable.renderers.getRenderer = getRenderer;
function registerRenderer(rendererName, rendererFunction) {
  var registerName;
  registeredRenderers[rendererName] = rendererFunction;
  registerName = toUpperCaseFirst(rendererName) + 'Renderer';
  Handsontable.renderers[registerName] = rendererFunction;
  Handsontable[registerName] = rendererFunction;
  if (rendererName === 'base') {
    Handsontable.renderers.cellDecorator = rendererFunction;
  }
}
function getRenderer(rendererName) {
  if (typeof rendererName == 'function') {
    return rendererName;
  }
  if (typeof rendererName != 'string') {
    throw Error('Only strings and functions can be passed as "renderer" parameter');
  }
  if (!(rendererName in registeredRenderers)) {
    throw Error('No editor registered under name "' + rendererName + '"');
  }
  return registeredRenderers[rendererName];
}
function hasRenderer(rendererName) {
  return rendererName in registeredRenderers;
}
;

//# 
},{"browser":24,"helpers/string":55}],118:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  cellDecorator: {get: function() {
      return cellDecorator;
    }},
  __esModule: {value: true}
});
var $___46__46__47_helpers_47_dom_47_element__,
    $___46__46__47_renderers__;
var $__0 = ($___46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47_helpers_47_dom_47_element__ && $___46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47_helpers_47_dom_47_element__}),
    addClass = $__0.addClass,
    removeClass = $__0.removeClass;
var registerRenderer = ($___46__46__47_renderers__ = _dereq_("renderers"), $___46__46__47_renderers__ && $___46__46__47_renderers__.__esModule && $___46__46__47_renderers__ || {default: $___46__46__47_renderers__}).registerRenderer;
function cellDecorator(instance, TD, row, col, prop, value, cellProperties) {
  if (cellProperties.className) {
    if (TD.className) {
      TD.className = TD.className + ' ' + cellProperties.className;
    } else {
      TD.className = cellProperties.className;
    }
  }
  if (cellProperties.readOnly) {
    addClass(TD, cellProperties.readOnlyCellClassName);
  }
  if (cellProperties.valid === false && cellProperties.invalidCellClassName) {
    addClass(TD, cellProperties.invalidCellClassName);
  } else {
    removeClass(TD, cellProperties.invalidCellClassName);
  }
  if (cellProperties.wordWrap === false && cellProperties.noWordWrapClassName) {
    addClass(TD, cellProperties.noWordWrapClassName);
  }
  if (!value && cellProperties.placeholder) {
    addClass(TD, cellProperties.placeholderCellClassName);
  }
}
;
registerRenderer('base', cellDecorator);

//# 
},{"helpers/dom/element":47,"renderers":117}],119:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  autocompleteRenderer: {get: function() {
      return autocompleteRenderer;
    }},
  __esModule: {value: true}
});
var $___46__46__47_helpers_47_dom_47_element__,
    $___46__46__47_eventManager__,
    $___46__46__47_renderers__,
    $___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__;
var $__0 = ($___46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47_helpers_47_dom_47_element__ && $___46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47_helpers_47_dom_47_element__}),
    addClass = $__0.addClass,
    hasClass = $__0.hasClass,
    empty = $__0.empty;
var eventManagerObject = ($___46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47_eventManager__ && $___46__46__47_eventManager__.__esModule && $___46__46__47_eventManager__ || {default: $___46__46__47_eventManager__}).eventManager;
var $__2 = ($___46__46__47_renderers__ = _dereq_("renderers"), $___46__46__47_renderers__ && $___46__46__47_renderers__.__esModule && $___46__46__47_renderers__ || {default: $___46__46__47_renderers__}),
    getRenderer = $__2.getRenderer,
    registerRenderer = $__2.registerRenderer;
var WalkontableCellCoords = ($___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ = _dereq_("3rdparty/walkontable/src/cell/coords"), $___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ && $___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__.__esModule && $___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__ || {default: $___46__46__47_3rdparty_47_walkontable_47_src_47_cell_47_coords__}).WalkontableCellCoords;
var clonableWRAPPER = document.createElement('DIV');
clonableWRAPPER.className = 'htAutocompleteWrapper';
var clonableARROW = document.createElement('DIV');
clonableARROW.className = 'htAutocompleteArrow';
clonableARROW.appendChild(document.createTextNode(String.fromCharCode(9660)));
var wrapTdContentWithWrapper = function(TD, WRAPPER) {
  WRAPPER.innerHTML = TD.innerHTML;
  empty(TD);
  TD.appendChild(WRAPPER);
};
function autocompleteRenderer(instance, TD, row, col, prop, value, cellProperties) {
  var WRAPPER = clonableWRAPPER.cloneNode(true);
  var ARROW = clonableARROW.cloneNode(true);
  if (cellProperties.allowHtml) {
    getRenderer('html').apply(this, arguments);
  } else {
    getRenderer('text').apply(this, arguments);
  }
  TD.appendChild(ARROW);
  addClass(TD, 'htAutocomplete');
  if (!TD.firstChild) {
    TD.appendChild(document.createTextNode(String.fromCharCode(160)));
  }
  if (!instance.acArrowListener) {
    var eventManager = eventManagerObject(instance);
    instance.acArrowListener = function(event) {
      if (hasClass(event.target, 'htAutocompleteArrow')) {
        instance.view.wt.getSetting('onCellDblClick', null, new WalkontableCellCoords(row, col), TD);
      }
    };
    eventManager.addEventListener(instance.rootElement, 'mousedown', instance.acArrowListener);
    instance.addHookOnce('afterDestroy', function() {
      eventManager.destroy();
    });
  }
}
;
registerRenderer('autocomplete', autocompleteRenderer);

//# 
},{"3rdparty/walkontable/src/cell/coords":6,"eventManager":42,"helpers/dom/element":47,"renderers":117}],120:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  checkboxRenderer: {get: function() {
      return checkboxRenderer;
    }},
  __esModule: {value: true}
});
var $___46__46__47_helpers_47_dom_47_element__,
    $___46__46__47_helpers_47_string__,
    $___46__46__47_eventManager__,
    $___46__46__47_renderers__,
    $___46__46__47_helpers_47_unicode__,
    $___46__46__47_helpers_47_function__,
    $___46__46__47_helpers_47_dom_47_event__;
var $__0 = ($___46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47_helpers_47_dom_47_element__ && $___46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47_helpers_47_dom_47_element__}),
    empty = $__0.empty,
    addClass = $__0.addClass,
    hasClass = $__0.hasClass;
var equalsIgnoreCase = ($___46__46__47_helpers_47_string__ = _dereq_("helpers/string"), $___46__46__47_helpers_47_string__ && $___46__46__47_helpers_47_string__.__esModule && $___46__46__47_helpers_47_string__ || {default: $___46__46__47_helpers_47_string__}).equalsIgnoreCase;
var EventManager = ($___46__46__47_eventManager__ = _dereq_("eventManager"), $___46__46__47_eventManager__ && $___46__46__47_eventManager__.__esModule && $___46__46__47_eventManager__ || {default: $___46__46__47_eventManager__}).EventManager;
var $__3 = ($___46__46__47_renderers__ = _dereq_("renderers"), $___46__46__47_renderers__ && $___46__46__47_renderers__.__esModule && $___46__46__47_renderers__ || {default: $___46__46__47_renderers__}),
    getRenderer = $__3.getRenderer,
    registerRenderer = $__3.registerRenderer;
var isKey = ($___46__46__47_helpers_47_unicode__ = _dereq_("helpers/unicode"), $___46__46__47_helpers_47_unicode__ && $___46__46__47_helpers_47_unicode__.__esModule && $___46__46__47_helpers_47_unicode__ || {default: $___46__46__47_helpers_47_unicode__}).isKey;
var partial = ($___46__46__47_helpers_47_function__ = _dereq_("helpers/function"), $___46__46__47_helpers_47_function__ && $___46__46__47_helpers_47_function__.__esModule && $___46__46__47_helpers_47_function__ || {default: $___46__46__47_helpers_47_function__}).partial;
var $__6 = ($___46__46__47_helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $___46__46__47_helpers_47_dom_47_event__ && $___46__46__47_helpers_47_dom_47_event__.__esModule && $___46__46__47_helpers_47_dom_47_event__ || {default: $___46__46__47_helpers_47_dom_47_event__}),
    stopImmediatePropagation = $__6.stopImmediatePropagation,
    isImmediatePropagationStopped = $__6.isImmediatePropagationStopped;
var isListeningKeyDownEvent = new WeakMap();
var isCheckboxListenerAdded = new WeakMap();
var BAD_VALUE_CLASS = 'htBadValue';
function checkboxRenderer(instance, TD, row, col, prop, value, cellProperties) {
  getRenderer('base').apply(this, arguments);
  var eventManager = registerEvents(instance);
  var input = createInput();
  var labelOptions = cellProperties.label;
  var badValue = false;
  if (typeof cellProperties.checkedTemplate === 'undefined') {
    cellProperties.checkedTemplate = true;
  }
  if (typeof cellProperties.uncheckedTemplate === 'undefined') {
    cellProperties.uncheckedTemplate = false;
  }
  empty(TD);
  if (value === cellProperties.checkedTemplate || equalsIgnoreCase(value, cellProperties.checkedTemplate)) {
    input.checked = true;
  } else if (value === cellProperties.uncheckedTemplate || equalsIgnoreCase(value, cellProperties.uncheckedTemplate)) {
    input.checked = false;
  } else if (value === null) {
    addClass(input, 'noValue');
  } else {
    input.style.display = 'none';
    addClass(input, BAD_VALUE_CLASS);
    badValue = true;
  }
  input.setAttribute('data-row', row);
  input.setAttribute('data-col', col);
  if (!badValue && labelOptions) {
    var labelText = '';
    if (labelOptions.value) {
      labelText = typeof labelOptions.value === 'function' ? labelOptions.value.call(this, row, col, prop, value) : labelOptions.value;
    } else if (labelOptions.property) {
      labelText = instance.getDataAtRowProp(row, labelOptions.property);
    }
    var label = createLabel(labelText);
    if (labelOptions.position === 'before') {
      label.appendChild(input);
    } else {
      label.insertBefore(input, label.firstChild);
    }
    input = label;
  }
  TD.appendChild(input);
  if (badValue) {
    TD.appendChild(document.createTextNode('#bad-value#'));
  }
  if (!isListeningKeyDownEvent.has(instance)) {
    isListeningKeyDownEvent.set(instance, true);
    instance.addHook('beforeKeyDown', onBeforeKeyDown);
  }
  function onBeforeKeyDown(event) {
    var toggleKeys = 'SPACE|ENTER';
    var switchOffKeys = 'DELETE|BACKSPACE';
    var isKeyCode = partial(isKey, event.keyCode);
    if (isKeyCode((toggleKeys + "|" + switchOffKeys)) && !isImmediatePropagationStopped(event)) {
      eachSelectedCheckboxCell(function() {
        stopImmediatePropagation(event);
        event.preventDefault();
      });
    }
    if (isKeyCode(toggleKeys)) {
      changeSelectedCheckboxesState();
    }
    if (isKeyCode(switchOffKeys)) {
      changeSelectedCheckboxesState(true);
    }
  }
  function changeSelectedCheckboxesState() {
    var uncheckCheckbox = arguments[0] !== (void 0) ? arguments[0] : false;
    var selRange = instance.getSelectedRange();
    if (!selRange) {
      return;
    }
    var topLeft = selRange.getTopLeftCorner();
    var bottomRight = selRange.getBottomRightCorner();
    var changes = [];
    for (var row = topLeft.row; row <= bottomRight.row; row += 1) {
      for (var col = topLeft.col; col <= bottomRight.col; col += 1) {
        var cellProperties$__7 = instance.getCellMeta(row, col);
        if (cellProperties$__7.type !== 'checkbox') {
          return;
        }
        if (cellProperties$__7.readOnly === true) {
          continue;
        }
        if (typeof cellProperties$__7.checkedTemplate === 'undefined') {
          cellProperties$__7.checkedTemplate = true;
        }
        if (typeof cellProperties$__7.uncheckedTemplate === 'undefined') {
          cellProperties$__7.uncheckedTemplate = false;
        }
        var dataAtCell = instance.getDataAtCell(row, col);
        if (uncheckCheckbox === false) {
          if (dataAtCell === cellProperties$__7.checkedTemplate) {
            changes.push([row, col, cellProperties$__7.uncheckedTemplate]);
          } else if ([cellProperties$__7.uncheckedTemplate, null, void 0].indexOf(dataAtCell) !== -1) {
            changes.push([row, col, cellProperties$__7.checkedTemplate]);
          }
        } else {
          changes.push([row, col, cellProperties$__7.uncheckedTemplate]);
        }
      }
    }
    if (changes.length > 0) {
      instance.setDataAtCell(changes);
    }
  }
  function eachSelectedCheckboxCell(callback) {
    var selRange = instance.getSelectedRange();
    if (!selRange) {
      return;
    }
    var topLeft = selRange.getTopLeftCorner();
    var bottomRight = selRange.getBottomRightCorner();
    for (var row = topLeft.row; row <= bottomRight.row; row++) {
      for (var col = topLeft.col; col <= bottomRight.col; col++) {
        var cellProperties$__8 = instance.getCellMeta(row, col);
        if (cellProperties$__8.type !== 'checkbox') {
          return;
        }
        var cell = instance.getCell(row, col);
        if (cell == null) {
          callback(row, col, cellProperties$__8);
        } else {
          var checkboxes = cell.querySelectorAll('input[type=checkbox]');
          if (checkboxes.length > 0 && !cellProperties$__8.readOnly) {
            callback(checkboxes);
          }
        }
      }
    }
  }
}
function registerEvents(instance) {
  var eventManager = isCheckboxListenerAdded.get(instance);
  if (!eventManager) {
    eventManager = new EventManager(instance);
    eventManager.addEventListener(instance.rootElement, 'click', (function(event) {
      return onClick(event, instance);
    }));
    eventManager.addEventListener(instance.rootElement, 'mouseup', (function(event) {
      return onMouseUp(event, instance);
    }));
    eventManager.addEventListener(instance.rootElement, 'change', (function(event) {
      return onChange(event, instance);
    }));
    isCheckboxListenerAdded.set(instance, eventManager);
  }
  return eventManager;
}
function createInput() {
  var input = document.createElement('input');
  input.className = 'htCheckboxRendererInput';
  input.type = 'checkbox';
  input.setAttribute('autocomplete', 'off');
  input.setAttribute('tabindex', '-1');
  return input.cloneNode(false);
}
function createLabel(text) {
  var label = document.createElement('label');
  label.className = 'htCheckboxRendererLabel';
  label.appendChild(document.createTextNode(text));
  return label.cloneNode(true);
}
function onMouseUp(event, instance) {
  if (!isCheckboxInput(event.target)) {
    return;
  }
  setTimeout(instance.listen, 10);
}
function onClick(event, instance) {
  if (!isCheckboxInput(event.target)) {
    return false;
  }
  var row = parseInt(event.target.getAttribute('data-row'), 10);
  var col = parseInt(event.target.getAttribute('data-col'), 10);
  var cellProperties = instance.getCellMeta(row, col);
  if (cellProperties.readOnly) {
    event.preventDefault();
  }
}
function onChange(event, instance) {
  if (!isCheckboxInput(event.target)) {
    return false;
  }
  var row = parseInt(event.target.getAttribute('data-row'), 10);
  var col = parseInt(event.target.getAttribute('data-col'), 10);
  var cellProperties = instance.getCellMeta(row, col);
  if (!cellProperties.readOnly) {
    var newCheckboxValue = null;
    if (event.target.checked) {
      if (cellProperties.checkedTemplate === void 0) {
        newCheckboxValue = true;
      } else {
        newCheckboxValue = cellProperties.checkedTemplate;
      }
    } else {
      if (cellProperties.uncheckedTemplate === void 0) {
        newCheckboxValue = false;
      } else {
        newCheckboxValue = cellProperties.uncheckedTemplate;
      }
    }
    instance.setDataAtCell(row, col, newCheckboxValue);
  }
}
function isCheckboxInput(element) {
  return element.tagName === 'INPUT' && element.getAttribute('type') === 'checkbox';
}
;
registerRenderer('checkbox', checkboxRenderer);

//# 
},{"eventManager":42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/function":50,"helpers/string":55,"helpers/unicode":56,"renderers":117}],121:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  htmlRenderer: {get: function() {
      return htmlRenderer;
    }},
  __esModule: {value: true}
});
var $___46__46__47_helpers_47_dom_47_element__,
    $___46__46__47_renderers__;
var fastInnerHTML = ($___46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47_helpers_47_dom_47_element__ && $___46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47_helpers_47_dom_47_element__}).fastInnerHTML;
var $__1 = ($___46__46__47_renderers__ = _dereq_("renderers"), $___46__46__47_renderers__ && $___46__46__47_renderers__.__esModule && $___46__46__47_renderers__ || {default: $___46__46__47_renderers__}),
    getRenderer = $__1.getRenderer,
    registerRenderer = $__1.registerRenderer;
function htmlRenderer(instance, TD, row, col, prop, value, cellProperties) {
  getRenderer('base').apply(this, arguments);
  if (value === null || value === void 0) {
    value = '';
  }
  fastInnerHTML(TD, value);
}
;
registerRenderer('html', htmlRenderer);

//# 
},{"helpers/dom/element":47,"renderers":117}],122:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  numericRenderer: {get: function() {
      return numericRenderer;
    }},
  __esModule: {value: true}
});
var $__numbro__,
    $___46__46__47_renderers__,
    $___46__46__47_helpers_47_number__;
var numbro = ($__numbro__ = _dereq_("numbro"), $__numbro__ && $__numbro__.__esModule && $__numbro__ || {default: $__numbro__}).default;
var $__1 = ($___46__46__47_renderers__ = _dereq_("renderers"), $___46__46__47_renderers__ && $___46__46__47_renderers__.__esModule && $___46__46__47_renderers__ || {default: $___46__46__47_renderers__}),
    getRenderer = $__1.getRenderer,
    registerRenderer = $__1.registerRenderer;
var isNumeric = ($___46__46__47_helpers_47_number__ = _dereq_("helpers/number"), $___46__46__47_helpers_47_number__ && $___46__46__47_helpers_47_number__.__esModule && $___46__46__47_helpers_47_number__ || {default: $___46__46__47_helpers_47_number__}).isNumeric;
function numericRenderer(instance, TD, row, col, prop, value, cellProperties) {
  if (isNumeric(value)) {
    if (typeof cellProperties.language !== 'undefined') {
      numbro.culture(cellProperties.language);
    }
    value = numbro(value).format(cellProperties.format || '0');
    var className = cellProperties.className || '';
    var classArr = className.length ? className.split(' ') : [];
    if (classArr.indexOf('htLeft') < 0 && classArr.indexOf('htCenter') < 0 && classArr.indexOf('htRight') < 0 && classArr.indexOf('htJustify') < 0) {
      classArr.push('htRight');
    }
    if (classArr.indexOf('htNumeric') < 0) {
      classArr.push('htNumeric');
    }
    cellProperties.className = classArr.join(' ');
  }
  getRenderer('text')(instance, TD, row, col, prop, value, cellProperties);
}
;
registerRenderer('numeric', numericRenderer);

//# 
},{"helpers/number":52,"numbro":"numbro","renderers":117}],123:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  passwordRenderer: {get: function() {
      return passwordRenderer;
    }},
  __esModule: {value: true}
});
var $___46__46__47_helpers_47_dom_47_element__,
    $___46__46__47_renderers__;
var fastInnerHTML = ($___46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47_helpers_47_dom_47_element__ && $___46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47_helpers_47_dom_47_element__}).fastInnerHTML;
var $__1 = ($___46__46__47_renderers__ = _dereq_("renderers"), $___46__46__47_renderers__ && $___46__46__47_renderers__.__esModule && $___46__46__47_renderers__ || {default: $___46__46__47_renderers__}),
    getRenderer = $__1.getRenderer,
    registerRenderer = $__1.registerRenderer;
function passwordRenderer(instance, TD, row, col, prop, value, cellProperties) {
  getRenderer('text').apply(this, arguments);
  value = TD.innerHTML;
  var hash;
  var hashLength = cellProperties.hashLength || value.length;
  var hashSymbol = cellProperties.hashSymbol || '*';
  for (hash = ''; hash.split(hashSymbol).length - 1 < hashLength; hash += hashSymbol) {}
  fastInnerHTML(TD, hash);
}
;
registerRenderer('password', passwordRenderer);

//# 
},{"helpers/dom/element":47,"renderers":117}],124:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  textRenderer: {get: function() {
      return textRenderer;
    }},
  __esModule: {value: true}
});
var $___46__46__47_helpers_47_dom_47_element__,
    $___46__46__47_helpers_47_mixed__,
    $___46__46__47_renderers__;
var $__0 = ($___46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47_helpers_47_dom_47_element__ && $___46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47_helpers_47_dom_47_element__}),
    empty = $__0.empty,
    fastInnerText = $__0.fastInnerText;
var stringify = ($___46__46__47_helpers_47_mixed__ = _dereq_("helpers/mixed"), $___46__46__47_helpers_47_mixed__ && $___46__46__47_helpers_47_mixed__.__esModule && $___46__46__47_helpers_47_mixed__ || {default: $___46__46__47_helpers_47_mixed__}).stringify;
var $__2 = ($___46__46__47_renderers__ = _dereq_("renderers"), $___46__46__47_renderers__ && $___46__46__47_renderers__.__esModule && $___46__46__47_renderers__ || {default: $___46__46__47_renderers__}),
    getRenderer = $__2.getRenderer,
    registerRenderer = $__2.registerRenderer;
function textRenderer(instance, TD, row, col, prop, value, cellProperties) {
  getRenderer('base').apply(this, arguments);
  if (!value && cellProperties.placeholder) {
    value = cellProperties.placeholder;
  }
  var escaped = stringify(value);
  if (!instance.getSettings().trimWhitespace) {
    escaped = escaped.replace(/ /g, String.fromCharCode(160));
  }
  if (cellProperties.rendererTemplate) {
    empty(TD);
    var TEMPLATE = document.createElement('TEMPLATE');
    TEMPLATE.setAttribute('bind', '{{}}');
    TEMPLATE.innerHTML = cellProperties.rendererTemplate;
    HTMLTemplateElement.decorate(TEMPLATE);
    TEMPLATE.model = instance.getSourceDataAtRow(row);
    TD.appendChild(TEMPLATE);
  } else {
    fastInnerText(TD, escaped);
  }
}
;
registerRenderer('text', textRenderer);

//# 
},{"helpers/dom/element":47,"helpers/mixed":51,"renderers":117}],125:[function(_dereq_,module,exports){
// jscs:disable
/* jshint ignore:start */
(function(global) {
  'use strict';
  if (global.$traceurRuntime) {
    return;
  }
  var $Object = Object;
  var $TypeError = TypeError;
  var $create = $Object.create;
  var $defineProperties = $Object.defineProperties;
  var $defineProperty = $Object.defineProperty;
  var $freeze = $Object.freeze;
  var $getOwnPropertyDescriptor = $Object.getOwnPropertyDescriptor;
  var $getOwnPropertyNames = $Object.getOwnPropertyNames;
  var $keys = $Object.keys;
  var $isExtensible = Object.isExtensible;
  function nonEnum(value) {
    return {
      configurable: true,
      enumerable: false,
      value: value,
      writable: true
    };
  }
  var method = nonEnum;
  var counter = 0;
  function newUniqueString() {
    return '__$' + Math.floor(Math.random() * 1e9) + '$' + ++counter + '$__';
  }
  var symbolInternalProperty = newUniqueString();
  var symbolDescriptionProperty = newUniqueString();
  var symbolDataProperty = newUniqueString();
  var symbolValues = $create(null);
  var privateNames = $create(null);
  function isPrivateName(s) {
    return privateNames[s];
  }
  function createPrivateName() {
    var s = newUniqueString();
    privateNames[s] = true;
    return s;
  }
  function isShimSymbol(symbol) {
    return typeof symbol === 'object' && symbol instanceof SymbolValue;
  }
  function typeOf(v) {
    if (isShimSymbol(v))
      return 'symbol';
    return typeof v;
  }
  function Symbol(description) {
    var value = new SymbolValue(description);
    if (!(this instanceof Symbol))
      return value;
    throw new TypeError('Symbol cannot be new\'ed');
  }
  $defineProperty(Symbol.prototype, 'constructor', nonEnum(Symbol));
  $defineProperty(Symbol.prototype, 'toString', method(function() {
    var symbolValue = this[symbolDataProperty];
    if (!getOption('symbols'))
      return symbolValue[symbolInternalProperty];
    if (!symbolValue)
      throw TypeError('Conversion from symbol to string');
    var desc = symbolValue[symbolDescriptionProperty];
    if (desc === undefined)
      desc = '';
    return 'Symbol(' + desc + ')';
  }));
  $defineProperty(Symbol.prototype, 'valueOf', method(function() {
    var symbolValue = this[symbolDataProperty];
    if (!symbolValue)
      throw TypeError('Conversion from symbol to string');
    if (!getOption('symbols'))
      return symbolValue[symbolInternalProperty];
    return symbolValue;
  }));
  function SymbolValue(description) {
    var key = newUniqueString();
    $defineProperty(this, symbolDataProperty, {value: this});
    $defineProperty(this, symbolInternalProperty, {value: key});
    $defineProperty(this, symbolDescriptionProperty, {value: description});
    freeze(this);
    symbolValues[key] = this;
  }
  $defineProperty(SymbolValue.prototype, 'constructor', nonEnum(Symbol));
  $defineProperty(SymbolValue.prototype, 'toString', {
    value: Symbol.prototype.toString,
    enumerable: false
  });
  $defineProperty(SymbolValue.prototype, 'valueOf', {
    value: Symbol.prototype.valueOf,
    enumerable: false
  });
  var hashProperty = createPrivateName();
  var hashPropertyDescriptor = {value: undefined};
  var hashObjectProperties = {
    hash: {value: undefined},
    self: {value: undefined}
  };
  var hashCounter = 0;
  function getOwnHashObject(object) {
    var hashObject = object[hashProperty];
    if (hashObject && hashObject.self === object)
      return hashObject;
    if ($isExtensible(object)) {
      hashObjectProperties.hash.value = hashCounter++;
      hashObjectProperties.self.value = object;
      hashPropertyDescriptor.value = $create(null, hashObjectProperties);
      $defineProperty(object, hashProperty, hashPropertyDescriptor);
      return hashPropertyDescriptor.value;
    }
    return undefined;
  }
  function freeze(object) {
    getOwnHashObject(object);
    return $freeze.apply(this, arguments);
  }
  freeze(SymbolValue.prototype);
  function isSymbolString(s) {
    return symbolValues[s] || privateNames[s];
  }
  function toProperty(name) {
    if (isShimSymbol(name))
      return name[symbolInternalProperty];
    return name;
  }
  function getOwnPropertySymbols(object) {
    var rv = [];
    var names = $getOwnPropertyNames(object);
    for (var i = 0; i < names.length; i++) {
      var symbol = symbolValues[names[i]];
      if (symbol) {
        rv.push(symbol);
      }
    }
    return rv;
  }
  function getOption(name) {
    return global.traceur && global.traceur.options[name];
  }
  function exportStar(object) {
    for (var i = 1; i < arguments.length; i++) {
      var names = $getOwnPropertyNames(arguments[i]);
      for (var j = 0; j < names.length; j++) {
        var name = names[j];
        if (isSymbolString(name))
          continue;
        (function(mod, name) {
          $defineProperty(object, name, {
            get: function() {
              return mod[name];
            },
            enumerable: true
          });
        })(arguments[i], names[j]);
      }
    }
    return object;
  }
  function isObject(x) {
    return x != null && (typeof x === 'object' || typeof x === 'function');
  }
  function toObject(x) {
    if (x == null)
      throw $TypeError();
    return $Object(x);
  }
  function checkObjectCoercible(argument) {
    if (argument == null) {
      throw new TypeError('Value cannot be converted to an Object');
    }
    return argument;
  }
  function polyfillSymbol(global, Symbol) {
    if (!global.Symbol) {
      global.Symbol = Symbol;
      Object.getOwnPropertySymbols = getOwnPropertySymbols;
    }
    if (!global.Symbol.iterator) {
      global.Symbol.iterator = Symbol('Symbol.iterator');
    }
  }
  function setupGlobals(global) {
    polyfillSymbol(global, Symbol);
    global.Reflect = global.Reflect || {};
    global.Reflect.global = global.Reflect.global || global;
  }
  setupGlobals(global);
  global.$traceurRuntime = {
    checkObjectCoercible: checkObjectCoercible,
    createPrivateName: createPrivateName,
    defineProperties: $defineProperties,
    defineProperty: $defineProperty,
    exportStar: exportStar,
    getOwnHashObject: getOwnHashObject,
    getOwnPropertyDescriptor: $getOwnPropertyDescriptor,
    getOwnPropertyNames: $getOwnPropertyNames,
    isObject: isObject,
    isPrivateName: isPrivateName,
    isSymbolString: isSymbolString,
    keys: $keys,
    setupGlobals: setupGlobals,
    toObject: toObject,
    toProperty: toProperty,
    typeof: typeOf
  };
})(window);
(function() {
  'use strict';
  var $toProperty = $traceurRuntime.toProperty;

  function spread() {
    var rv = [],
      j = 0,
      iterResult;
    for (var i = 0; i < arguments.length; i++) {
      var valueToSpread = $traceurRuntime.checkObjectCoercible(arguments[i]);

      if (typeof valueToSpread[$toProperty(Symbol.iterator)] !== 'function') {
        valueToSpread[$toProperty(Symbol.iterator)] = function() {
          var value = this;
          var length = value.length;
          var index = 0;

          return {
            next: function() {
              var result = {done: true};

              if (index < length) {
                result.done = false;
                result.value = value[index];
                ++index;
              }

              return result;
            }
          }
        };
      }
      var iter = valueToSpread[$toProperty(Symbol.iterator)]();

      while (!(iterResult = iter.next()).done) {
        rv[j++] = iterResult.value;
      }
    }
    return rv;
  }
  $traceurRuntime.spread = spread;
})();
(function() {
  'use strict';
  var $Object = Object;
  var $TypeError = TypeError;
  var $create = $Object.create;
  var $defineProperties = $traceurRuntime.defineProperties;
  var $defineProperty = $traceurRuntime.defineProperty;
  var $getOwnPropertyDescriptor = $traceurRuntime.getOwnPropertyDescriptor;
  var $getPrototypeOf = Object.getPrototypeOf;
  var $toProperty = $traceurRuntime.toProperty;
  var $__0 = Object,
    getOwnPropertyNames = $__0.getOwnPropertyNames,
    getOwnPropertySymbols = $__0.getOwnPropertySymbols;
  function superDescriptor(homeObject, name) {
    var proto = $getPrototypeOf(homeObject);
    do {
      var result = $getOwnPropertyDescriptor(proto, name);
      if (result)
        return result;
      proto = $getPrototypeOf(proto);
    } while (proto);
    return undefined;
  }
  function superConstructor(ctor) {
    return ctor.__proto__;
  }
  function superCall(self, homeObject, name, args) {
    return superGet(self, homeObject, name).apply(self, args);
  }
  function superGet(self, homeObject, name) {
    var descriptor = superDescriptor(homeObject, name);
    if (descriptor) {
      if (!descriptor.get)
        return descriptor.value;
      return descriptor.get.call(self);
    }
    return undefined;
  }
  function superSet(self, homeObject, name, value) {
    var descriptor = superDescriptor(homeObject, name);
    if (descriptor && descriptor.set) {
      descriptor.set.call(self, value);
      return value;
    }
    throw $TypeError(("super has no setter '" + name + "'."));
  }
  function getDescriptors(object) {
    var descriptors = {};
    var names = getOwnPropertyNames(object);
    for (var i = 0; i < names.length; i++) {
      var name = names[i];
      descriptors[name] = $getOwnPropertyDescriptor(object, name);
    }
    var symbols = getOwnPropertySymbols(object);
    for (var i = 0; i < symbols.length; i++) {
      var symbol = symbols[i];
      descriptors[$toProperty(symbol)] = $getOwnPropertyDescriptor(object, $toProperty(symbol));
    }
    return descriptors;
  }
  function createClass(ctor, object, staticObject, superClass) {
    $defineProperty(object, 'constructor', {
      value: ctor,
      configurable: true,
      enumerable: false,
      writable: true
    });
    if (arguments.length > 3) {
      if (typeof superClass === 'function')
        ctor.__proto__ = superClass;
      ctor.prototype = $create(getProtoParent(superClass), getDescriptors(object));
    } else {
      ctor.prototype = object;
    }
    $defineProperty(ctor, 'prototype', {
      configurable: false,
      writable: false
    });
    return $defineProperties(ctor, getDescriptors(staticObject));
  }
  function getProtoParent(superClass) {
    if (typeof superClass === 'function') {
      var prototype = superClass.prototype;
      if ($Object(prototype) === prototype || prototype === null)
        return superClass.prototype;
      throw new $TypeError('super prototype must be an Object or null');
    }
    if (superClass === null)
      return null;
    throw new $TypeError(("Super expression must either be null or a function, not " + typeof superClass + "."));
  }
  function defaultSuperCall(self, homeObject, args) {
    if ($getPrototypeOf(homeObject) !== null)
      superCall(self, homeObject, 'constructor', args);
  }
  $traceurRuntime.createClass = createClass;
  $traceurRuntime.defaultSuperCall = defaultSuperCall;
  $traceurRuntime.superCall = superCall;
  $traceurRuntime.superConstructor = superConstructor;
  $traceurRuntime.superGet = superGet;
  $traceurRuntime.superSet = superSet;
})();
/* jshint ignore:end */

},{}],126:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  TableView: {get: function() {
      return TableView;
    }},
  __esModule: {value: true}
});
var $__browser__,
    $__helpers_47_dom_47_element__,
    $__helpers_47_object__,
    $__eventManager__,
    $__helpers_47_dom_47_event__,
    $__3rdparty_47_walkontable_47_src_47_cell_47_coords__,
    $__3rdparty_47_walkontable_47_src_47_selection__,
    $__3rdparty_47_walkontable_47_src_47_core__;
var Handsontable = ($__browser__ = _dereq_("browser"), $__browser__ && $__browser__.__esModule && $__browser__ || {default: $__browser__}).default;
var $__1 = ($__helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $__helpers_47_dom_47_element__ && $__helpers_47_dom_47_element__.__esModule && $__helpers_47_dom_47_element__ || {default: $__helpers_47_dom_47_element__}),
    addClass = $__1.addClass,
    empty = $__1.empty,
    fastInnerHTML = $__1.fastInnerHTML,
    fastInnerText = $__1.fastInnerText,
    getScrollbarWidth = $__1.getScrollbarWidth,
    hasClass = $__1.hasClass,
    isChildOf = $__1.isChildOf,
    isInput = $__1.isInput,
    isOutsideInput = $__1.isOutsideInput,
    removeClass = $__1.removeClass;
var createObjectPropListener = ($__helpers_47_object__ = _dereq_("helpers/object"), $__helpers_47_object__ && $__helpers_47_object__.__esModule && $__helpers_47_object__ || {default: $__helpers_47_object__}).createObjectPropListener;
var eventManagerObject = ($__eventManager__ = _dereq_("eventManager"), $__eventManager__ && $__eventManager__.__esModule && $__eventManager__ || {default: $__eventManager__}).eventManager;
var $__4 = ($__helpers_47_dom_47_event__ = _dereq_("helpers/dom/event"), $__helpers_47_dom_47_event__ && $__helpers_47_dom_47_event__.__esModule && $__helpers_47_dom_47_event__ || {default: $__helpers_47_dom_47_event__}),
    stopPropagation = $__4.stopPropagation,
    isImmediatePropagationStopped = $__4.isImmediatePropagationStopped,
    isRightClick = $__4.isRightClick,
    isLeftClick = $__4.isLeftClick;
var WalkontableCellCoords = ($__3rdparty_47_walkontable_47_src_47_cell_47_coords__ = _dereq_("3rdparty/walkontable/src/cell/coords"), $__3rdparty_47_walkontable_47_src_47_cell_47_coords__ && $__3rdparty_47_walkontable_47_src_47_cell_47_coords__.__esModule && $__3rdparty_47_walkontable_47_src_47_cell_47_coords__ || {default: $__3rdparty_47_walkontable_47_src_47_cell_47_coords__}).WalkontableCellCoords;
var WalkontableSelection = ($__3rdparty_47_walkontable_47_src_47_selection__ = _dereq_("3rdparty/walkontable/src/selection"), $__3rdparty_47_walkontable_47_src_47_selection__ && $__3rdparty_47_walkontable_47_src_47_selection__.__esModule && $__3rdparty_47_walkontable_47_src_47_selection__ || {default: $__3rdparty_47_walkontable_47_src_47_selection__}).WalkontableSelection;
var Walkontable = ($__3rdparty_47_walkontable_47_src_47_core__ = _dereq_("3rdparty/walkontable/src/core"), $__3rdparty_47_walkontable_47_src_47_core__ && $__3rdparty_47_walkontable_47_src_47_core__.__esModule && $__3rdparty_47_walkontable_47_src_47_core__ || {default: $__3rdparty_47_walkontable_47_src_47_core__}).Walkontable;
Handsontable.TableView = TableView;
function TableView(instance) {
  var $__8 = this;
  var that = this;
  this.eventManager = eventManagerObject(instance);
  this.instance = instance;
  this.settings = instance.getSettings();
  this.selectionMouseDown = false;
  var originalStyle = instance.rootElement.getAttribute('style');
  if (originalStyle) {
    instance.rootElement.setAttribute('data-originalstyle', originalStyle);
  }
  addClass(instance.rootElement, 'handsontable');
  var table = document.createElement('TABLE');
  addClass(table, 'htCore');
  if (instance.getSettings().tableClassName) {
    addClass(table, instance.getSettings().tableClassName);
  }
  this.THEAD = document.createElement('THEAD');
  table.appendChild(this.THEAD);
  this.TBODY = document.createElement('TBODY');
  table.appendChild(this.TBODY);
  instance.table = table;
  instance.container.insertBefore(table, instance.container.firstChild);
  this.eventManager.addEventListener(instance.rootElement, 'mousedown', function(event) {
    this.selectionMouseDown = true;
    if (!that.isTextSelectionAllowed(event.target)) {
      clearTextSelection();
      event.preventDefault();
      window.focus();
    }
  });
  this.eventManager.addEventListener(instance.rootElement, 'mouseup', function(event) {
    this.selectionMouseDown = false;
  });
  this.eventManager.addEventListener(instance.rootElement, 'mousemove', function(event) {
    if (this.selectionMouseDown && !that.isTextSelectionAllowed(event.target)) {
      clearTextSelection();
      event.preventDefault();
    }
  });
  this.eventManager.addEventListener(document.documentElement, 'keyup', function(event) {
    if (instance.selection.isInProgress() && !event.shiftKey) {
      instance.selection.finish();
    }
  });
  var isMouseDown;
  this.isMouseDown = function() {
    return isMouseDown;
  };
  this.eventManager.addEventListener(document.documentElement, 'mouseup', function(event) {
    if (instance.selection.isInProgress() && event.which === 1) {
      instance.selection.finish();
    }
    isMouseDown = false;
    if (isOutsideInput(document.activeElement)) {
      instance.unlisten();
    }
  });
  this.eventManager.addEventListener(document.documentElement, 'mousedown', function(event) {
    var originalTarget = event.target;
    var next = event.target;
    var eventX = event.x || event.clientX;
    var eventY = event.y || event.clientY;
    if (isMouseDown || !instance.rootElement) {
      return;
    }
    if (next === instance.view.wt.wtTable.holder) {
      var scrollbarWidth = getScrollbarWidth();
      if (document.elementFromPoint(eventX + scrollbarWidth, eventY) !== instance.view.wt.wtTable.holder || document.elementFromPoint(eventX, eventY + scrollbarWidth) !== instance.view.wt.wtTable.holder) {
        return;
      }
    } else {
      while (next !== document.documentElement) {
        if (next === null) {
          if (event.isTargetWebComponent) {
            break;
          }
          return;
        }
        if (next === instance.rootElement) {
          return;
        }
        next = next.parentNode;
      }
    }
    var outsideClickDeselects = typeof that.settings.outsideClickDeselects === 'function' ? that.settings.outsideClickDeselects(originalTarget) : that.settings.outsideClickDeselects;
    if (outsideClickDeselects) {
      instance.deselectCell();
    } else {
      instance.destroyEditor();
    }
  });
  this.eventManager.addEventListener(table, 'selectstart', function(event) {
    if (that.settings.fragmentSelection || isInput(event.target)) {
      return;
    }
    event.preventDefault();
  });
  var clearTextSelection = function() {
    if (window.getSelection) {
      if (window.getSelection().empty) {
        window.getSelection().empty();
      } else if (window.getSelection().removeAllRanges) {
        window.getSelection().removeAllRanges();
      }
    } else if (document.selection) {
      document.selection.empty();
    }
  };
  var selections = [new WalkontableSelection({
    className: 'current',
    border: {
      width: 2,
      color: '#5292F7',
      cornerVisible: function() {
        return that.settings.fillHandle && !that.isCellEdited() && !instance.selection.isMultiple();
      },
      multipleSelectionHandlesVisible: function() {
        return !that.isCellEdited() && !instance.selection.isMultiple();
      }
    }
  }), new WalkontableSelection({
    className: 'area',
    border: {
      width: 1,
      color: '#89AFF9',
      cornerVisible: function() {
        return that.settings.fillHandle && !that.isCellEdited() && instance.selection.isMultiple();
      },
      multipleSelectionHandlesVisible: function() {
        return !that.isCellEdited() && instance.selection.isMultiple();
      }
    }
  }), new WalkontableSelection({
    className: 'highlight',
    highlightHeaderClassName: that.settings.currentHeaderClassName,
    highlightRowClassName: that.settings.currentRowClassName,
    highlightColumnClassName: that.settings.currentColClassName
  }), new WalkontableSelection({
    className: 'fill',
    border: {
      width: 1,
      color: 'red'
    }
  })];
  selections.current = selections[0];
  selections.area = selections[1];
  selections.highlight = selections[2];
  selections.fill = selections[3];
  var walkontableConfig = {
    debug: function() {
      return that.settings.debug;
    },
    externalRowCalculator: this.instance.getPlugin('autoRowSize') && this.instance.getPlugin('autoRowSize').isEnabled(),
    table: table,
    preventOverflow: (function() {
      return $__8.settings.preventOverflow;
    }),
    stretchH: function() {
      return that.settings.stretchH;
    },
    data: instance.getDataAtCell,
    totalRows: (function() {
      return instance.countRows();
    }),
    totalColumns: (function() {
      return instance.countCols();
    }),
    fixedColumnsLeft: function() {
      return that.settings.fixedColumnsLeft;
    },
    fixedRowsTop: function() {
      return that.settings.fixedRowsTop;
    },
    fixedRowsBottom: function() {
      return that.settings.fixedRowsBottom;
    },
    minSpareRows: function() {
      return that.settings.minSpareRows;
    },
    renderAllRows: that.settings.renderAllRows,
    rowHeaders: function() {
      var headerRenderers = [];
      if (instance.hasRowHeaders()) {
        headerRenderers.push(function(row, TH) {
          that.appendRowHeader(row, TH);
        });
      }
      Handsontable.hooks.run(instance, 'afterGetRowHeaderRenderers', headerRenderers);
      return headerRenderers;
    },
    columnHeaders: function() {
      var headerRenderers = [];
      if (instance.hasColHeaders()) {
        headerRenderers.push(function(column, TH) {
          that.appendColHeader(column, TH);
        });
      }
      Handsontable.hooks.run(instance, 'afterGetColumnHeaderRenderers', headerRenderers);
      return headerRenderers;
    },
    columnWidth: instance.getColWidth,
    rowHeight: instance.getRowHeight,
    cellRenderer: function(row, col, TD) {
      var cellProperties = that.instance.getCellMeta(row, col);
      var prop = that.instance.colToProp(col);
      var value = that.instance.getDataAtRowProp(row, prop);
      if (that.instance.hasHook('beforeValueRender')) {
        value = that.instance.runHooks('beforeValueRender', value);
      }
      that.instance.runHooks('beforeRenderer', TD, row, col, prop, value, cellProperties);
      that.instance.getCellRenderer(cellProperties)(that.instance, TD, row, col, prop, value, cellProperties);
      that.instance.runHooks('afterRenderer', TD, row, col, prop, value, cellProperties);
    },
    selections: selections,
    hideBorderOnMouseDownOver: function() {
      return that.settings.fragmentSelection;
    },
    onCellMouseDown: function(event, coords, TD, wt) {
      var blockCalculations = {
        row: false,
        column: false,
        cells: false
      };
      instance.listen();
      that.activeWt = wt;
      isMouseDown = true;
      Handsontable.hooks.run(instance, 'beforeOnCellMouseDown', event, coords, TD, blockCalculations);
      if (isImmediatePropagationStopped(event)) {
        return;
      }
      var actualSelection = instance.getSelectedRange();
      var selection = instance.selection;
      var selectedHeader = selection.selectedHeader;
      if (event.shiftKey && actualSelection) {
        if (coords.row >= 0 && coords.col >= 0 && !blockCalculations.cells) {
          selection.setSelectedHeaders(false, false);
          selection.setRangeEnd(coords);
        } else if ((selectedHeader.cols || selectedHeader.rows) && coords.row >= 0 && coords.col >= 0 && !blockCalculations.cells) {
          selection.setSelectedHeaders(false, false);
          selection.setRangeEnd(new WalkontableCellCoords(coords.row, coords.col));
        } else if (selectedHeader.cols && coords.row < 0 && !blockCalculations.column) {
          selection.setRangeEnd(new WalkontableCellCoords(actualSelection.to.row, coords.col));
        } else if (selectedHeader.rows && coords.col < 0 && !blockCalculations.row) {
          selection.setRangeEnd(new WalkontableCellCoords(coords.row, actualSelection.to.col));
        } else if (((!selectedHeader.cols && !selectedHeader.rows && coords.col < 0) || (selectedHeader.cols && coords.col < 0)) && !blockCalculations.row) {
          selection.setSelectedHeaders(true, false);
          selection.setRangeStartOnly(new WalkontableCellCoords(actualSelection.from.row, 0));
          selection.setRangeEnd(new WalkontableCellCoords(coords.row, instance.countCols() - 1));
        } else if (((!selectedHeader.cols && !selectedHeader.rows && coords.row < 0) || (selectedHeader.rows && coords.row < 0)) && !blockCalculations.column) {
          selection.setSelectedHeaders(false, true);
          selection.setRangeStartOnly(new WalkontableCellCoords(0, actualSelection.from.col));
          selection.setRangeEnd(new WalkontableCellCoords(instance.countRows() - 1, coords.col));
        }
      } else {
        var doNewSelection = true;
        if (actualSelection) {
          var $__9 = actualSelection,
              from = $__9.from,
              to = $__9.to;
          var coordsNotInSelection = !selection.inInSelection(coords);
          if (coords.row < 0 && selectedHeader.cols) {
            var start = Math.min(from.col, to.col);
            var end = Math.max(from.col, to.col);
            doNewSelection = (coords.col < start || coords.col > end);
          } else if (coords.col < 0 && selectedHeader.rows) {
            var start$__10 = Math.min(from.row, to.row);
            var end$__11 = Math.max(from.row, to.row);
            doNewSelection = (coords.row < start$__10 || coords.row > end$__11);
          } else {
            doNewSelection = coordsNotInSelection;
          }
        }
        var rightClick = isRightClick(event);
        var leftClick = isLeftClick(event) || event.type === 'touchstart';
        if (coords.row < 0 && coords.col >= 0 && !blockCalculations.column) {
          selection.setSelectedHeaders(false, true);
          if (leftClick || (rightClick && doNewSelection)) {
            selection.setRangeStartOnly(new WalkontableCellCoords(0, coords.col));
            selection.setRangeEnd(new WalkontableCellCoords(Math.max(instance.countRows() - 1, 0), coords.col), false);
          }
        } else if (coords.col < 0 && coords.row >= 0 && !blockCalculations.row) {
          selection.setSelectedHeaders(true, false);
          if (leftClick || (rightClick && doNewSelection)) {
            selection.setRangeStartOnly(new WalkontableCellCoords(coords.row, 0));
            selection.setRangeEnd(new WalkontableCellCoords(coords.row, Math.max(instance.countCols() - 1, 0)), false);
          }
        } else if (coords.col >= 0 && coords.row >= 0 && !blockCalculations.cells) {
          if (leftClick || (rightClick && doNewSelection)) {
            selection.setSelectedHeaders(false, false);
            selection.setRangeStart(coords);
          }
        } else if (coords.col < 0 && coords.row < 0) {
          coords.row = 0;
          coords.col = 0;
          selection.setSelectedHeaders(false, false, true);
          selection.setRangeStart(coords);
        }
      }
      Handsontable.hooks.run(instance, 'afterOnCellMouseDown', event, coords, TD);
      that.activeWt = that.wt;
    },
    onCellMouseOut: function(event, coords, TD, wt) {
      that.activeWt = wt;
      Handsontable.hooks.run(instance, 'beforeOnCellMouseOut', event, coords, TD);
      if (isImmediatePropagationStopped(event)) {
        return;
      }
      Handsontable.hooks.run(instance, 'afterOnCellMouseOut', event, coords, TD);
      that.activeWt = that.wt;
    },
    onCellMouseOver: function(event, coords, TD, wt) {
      var blockCalculations = {
        row: false,
        column: false,
        cell: false
      };
      that.activeWt = wt;
      Handsontable.hooks.run(instance, 'beforeOnCellMouseOver', event, coords, TD, blockCalculations);
      if (isImmediatePropagationStopped(event)) {
        return;
      }
      if (event.button === 0 && isMouseDown) {
        if (coords.row >= 0 && coords.col >= 0) {
          if (instance.selection.selectedHeader.cols && !blockCalculations.column) {
            instance.selection.setRangeEnd(new WalkontableCellCoords(instance.countRows() - 1, coords.col), false);
          } else if (instance.selection.selectedHeader.rows && !blockCalculations.row) {
            instance.selection.setRangeEnd(new WalkontableCellCoords(coords.row, instance.countCols() - 1), false);
          } else if (!blockCalculations.cell) {
            instance.selection.setRangeEnd(coords);
          }
        } else {
          if (instance.selection.selectedHeader.cols && !blockCalculations.column) {
            instance.selection.setRangeEnd(new WalkontableCellCoords(instance.countRows() - 1, coords.col), false);
          } else if (instance.selection.selectedHeader.rows && !blockCalculations.row) {
            instance.selection.setRangeEnd(new WalkontableCellCoords(coords.row, instance.countCols() - 1), false);
          } else if (!blockCalculations.cell) {
            instance.selection.setRangeEnd(coords);
          }
        }
      }
      Handsontable.hooks.run(instance, 'afterOnCellMouseOver', event, coords, TD);
      that.activeWt = that.wt;
    },
    onCellMouseUp: function(event, coords, TD, wt) {
      that.activeWt = wt;
      Handsontable.hooks.run(instance, 'beforeOnCellMouseUp', event, coords, TD);
      Handsontable.hooks.run(instance, 'afterOnCellMouseUp', event, coords, TD);
      that.activeWt = that.wt;
    },
    onCellCornerMouseDown: function(event) {
      event.preventDefault();
      Handsontable.hooks.run(instance, 'afterOnCellCornerMouseDown', event);
    },
    onCellCornerDblClick: function(event) {
      event.preventDefault();
      Handsontable.hooks.run(instance, 'afterOnCellCornerDblClick', event);
    },
    beforeDraw: function(force, skipRender) {
      that.beforeRender(force, skipRender);
    },
    onDraw: function(force) {
      that.onDraw(force);
    },
    onScrollVertically: function() {
      instance.runHooks('afterScrollVertically');
    },
    onScrollHorizontally: function() {
      instance.runHooks('afterScrollHorizontally');
    },
    onBeforeDrawBorders: function(corners, borderClassName) {
      instance.runHooks('beforeDrawBorders', corners, borderClassName);
    },
    onBeforeTouchScroll: function() {
      instance.runHooks('beforeTouchScroll');
    },
    onAfterMomentumScroll: function() {
      instance.runHooks('afterMomentumScroll');
    },
    onBeforeStretchingColumnWidth: function(stretchedWidth, column) {
      return instance.runHooks('beforeStretchingColumnWidth', stretchedWidth, column);
    },
    onModifyRowHeaderWidth: function(rowHeaderWidth) {
      return instance.runHooks('modifyRowHeaderWidth', rowHeaderWidth);
    },
    viewportRowCalculatorOverride: function(calc) {
      var rows = instance.countRows();
      var viewportOffset = that.settings.viewportRowRenderingOffset;
      if (viewportOffset === 'auto' && that.settings.fixedRowsTop) {
        viewportOffset = 10;
      }
      if (typeof viewportOffset === 'number') {
        calc.startRow = Math.max(calc.startRow - viewportOffset, 0);
        calc.endRow = Math.min(calc.endRow + viewportOffset, rows - 1);
      }
      if (viewportOffset === 'auto') {
        var center = calc.startRow + calc.endRow - calc.startRow;
        var offset = Math.ceil(center / rows * 12);
        calc.startRow = Math.max(calc.startRow - offset, 0);
        calc.endRow = Math.min(calc.endRow + offset, rows - 1);
      }
      instance.runHooks('afterViewportRowCalculatorOverride', calc);
    },
    viewportColumnCalculatorOverride: function(calc) {
      var cols = instance.countCols();
      var viewportOffset = that.settings.viewportColumnRenderingOffset;
      if (viewportOffset === 'auto' && that.settings.fixedColumnsLeft) {
        viewportOffset = 10;
      }
      if (typeof viewportOffset === 'number') {
        calc.startColumn = Math.max(calc.startColumn - viewportOffset, 0);
        calc.endColumn = Math.min(calc.endColumn + viewportOffset, cols - 1);
      }
      if (viewportOffset === 'auto') {
        var center = calc.startColumn + calc.endColumn - calc.startColumn;
        var offset = Math.ceil(center / cols * 12);
        calc.startRow = Math.max(calc.startColumn - offset, 0);
        calc.endColumn = Math.min(calc.endColumn + offset, cols - 1);
      }
      instance.runHooks('afterViewportColumnCalculatorOverride', calc);
    },
    rowHeaderWidth: function() {
      return that.settings.rowHeaderWidth;
    },
    columnHeaderHeight: function() {
      var columnHeaderHeight = instance.runHooks('modifyColumnHeaderHeight');
      return that.settings.columnHeaderHeight || columnHeaderHeight;
    }
  };
  Handsontable.hooks.run(instance, 'beforeInitWalkontable', walkontableConfig);
  this.wt = new Walkontable(walkontableConfig);
  this.activeWt = this.wt;
  this.eventManager.addEventListener(that.wt.wtTable.spreader, 'mousedown', function(event) {
    if (event.target === that.wt.wtTable.spreader && event.which === 3) {
      stopPropagation(event);
    }
  });
  this.eventManager.addEventListener(that.wt.wtTable.spreader, 'contextmenu', function(event) {
    if (event.target === that.wt.wtTable.spreader && event.which === 3) {
      stopPropagation(event);
    }
  });
  this.eventManager.addEventListener(document.documentElement, 'click', function() {
    if (that.settings.observeDOMVisibility) {
      if (that.wt.drawInterrupted) {
        that.instance.forceFullRender = true;
        that.render();
      }
    }
  });
}
TableView.prototype.isTextSelectionAllowed = function(el) {
  if (isInput(el)) {
    return true;
  }
  var isChildOfTableBody = isChildOf(el, this.instance.view.wt.wtTable.spreader);
  if (this.settings.fragmentSelection === true && isChildOfTableBody) {
    return true;
  }
  if (this.settings.fragmentSelection === 'cell' && this.isSelectedOnlyCell() && isChildOfTableBody) {
    return true;
  }
  if (!this.settings.fragmentSelection && this.isCellEdited() && this.isSelectedOnlyCell()) {
    return true;
  }
  return false;
};
TableView.prototype.isSelectedOnlyCell = function() {
  var $__9 = this.instance.getSelected() || [],
      row = $__9[0],
      col = $__9[1],
      rowEnd = $__9[2],
      colEnd = $__9[3];
  return row !== void 0 && row === rowEnd && col === colEnd;
};
TableView.prototype.isCellEdited = function() {
  var activeEditor = this.instance.getActiveEditor();
  return activeEditor && activeEditor.isOpened();
};
TableView.prototype.beforeRender = function(force, skipRender) {
  if (force) {
    Handsontable.hooks.run(this.instance, 'beforeRender', this.instance.forceFullRender, skipRender);
  }
};
TableView.prototype.onDraw = function(force) {
  if (force) {
    Handsontable.hooks.run(this.instance, 'afterRender', this.instance.forceFullRender);
  }
};
TableView.prototype.render = function() {
  this.wt.draw(!this.instance.forceFullRender);
  this.instance.forceFullRender = false;
  this.instance.renderCall = false;
};
TableView.prototype.getCellAtCoords = function(coords, topmost) {
  var td = this.wt.getCell(coords, topmost);
  if (td < 0) {
    return null;
  } else {
    return td;
  }
};
TableView.prototype.scrollViewport = function(coords) {
  this.wt.scrollViewport(coords);
};
TableView.prototype.appendRowHeader = function(row, TH) {
  if (TH.firstChild) {
    var container = TH.firstChild;
    if (!hasClass(container, 'relative')) {
      empty(TH);
      this.appendRowHeader(row, TH);
      return;
    }
    this.updateCellHeader(container.querySelector('.rowHeader'), row, this.instance.getRowHeader);
  } else {
    var div = document.createElement('div');
    var span = document.createElement('span');
    div.className = 'relative';
    span.className = 'rowHeader';
    this.updateCellHeader(span, row, this.instance.getRowHeader);
    div.appendChild(span);
    TH.appendChild(div);
  }
  Handsontable.hooks.run(this.instance, 'afterGetRowHeader', row, TH);
};
TableView.prototype.appendColHeader = function(col, TH) {
  if (TH.firstChild) {
    var container = TH.firstChild;
    if (hasClass(container, 'relative')) {
      this.updateCellHeader(container.querySelector('.colHeader'), col, this.instance.getColHeader);
    } else {
      empty(TH);
      this.appendColHeader(col, TH);
    }
  } else {
    var div = document.createElement('div');
    var span = document.createElement('span');
    div.className = 'relative';
    span.className = 'colHeader';
    this.updateCellHeader(span, col, this.instance.getColHeader);
    div.appendChild(span);
    TH.appendChild(div);
  }
  Handsontable.hooks.run(this.instance, 'afterGetColHeader', col, TH);
};
TableView.prototype.updateCellHeader = function(element, index, content) {
  var renderedIndex = index;
  var parentOverlay = this.wt.wtOverlays.getParentOverlay(element) || this.wt;
  if (element.parentNode) {
    if (hasClass(element, 'colHeader')) {
      renderedIndex = parentOverlay.wtTable.columnFilter.sourceToRendered(index);
    } else if (hasClass(element, 'rowHeader')) {
      renderedIndex = parentOverlay.wtTable.rowFilter.sourceToRendered(index);
    }
  }
  if (renderedIndex > -1) {
    fastInnerHTML(element, content(index));
  } else {
    fastInnerText(element, String.fromCharCode(160));
    addClass(element, 'cornerHeader');
  }
};
TableView.prototype.maximumVisibleElementWidth = function(leftOffset) {
  var workspaceWidth = this.wt.wtViewport.getWorkspaceWidth();
  var maxWidth = workspaceWidth - leftOffset;
  return maxWidth > 0 ? maxWidth : 0;
};
TableView.prototype.maximumVisibleElementHeight = function(topOffset) {
  var workspaceHeight = this.wt.wtViewport.getWorkspaceHeight();
  var maxHeight = workspaceHeight - topOffset;
  return maxHeight > 0 ? maxHeight : 0;
};
TableView.prototype.mainViewIsActive = function() {
  return this.wt === this.activeWt;
};
TableView.prototype.destroy = function() {
  this.wt.destroy();
  this.eventManager.destroy();
};
;

//# 
},{"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/core":8,"3rdparty/walkontable/src/selection":19,"browser":24,"eventManager":42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/object":53}],127:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  NodeStructure: {get: function() {
      return NodeStructure;
    }},
  LinkedList: {get: function() {
      return LinkedList;
    }},
  __esModule: {value: true}
});
var $___46__46__47__46__46__47_browser__;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var NodeStructure = function NodeStructure(data) {
  this.data = data;
  this.next = null;
  this.prev = null;
};
($traceurRuntime.createClass)(NodeStructure, {}, {});
var LinkedList = function LinkedList() {
  this.first = null;
  this.last = null;
};
($traceurRuntime.createClass)(LinkedList, {
  push: function(data) {
    var node = new NodeStructure(data);
    if (this.first === null) {
      this.first = this.last = node;
    } else {
      var temp = this.last;
      this.last = node;
      node.prev = temp;
      temp.next = node;
    }
  },
  unshift: function(data) {
    var node = new NodeStructure(data);
    if (this.first === null) {
      this.first = this.last = node;
    } else {
      var temp = this.first;
      this.first = node;
      node.next = temp;
      temp.prev = node;
    }
  },
  inorder: function(callback) {
    var temp = this.first;
    while (temp) {
      callback(temp);
      temp = temp.next;
    }
  },
  remove: function(data) {
    if (this.first === null) {
      return false;
    }
    var temp = this.first;
    var next;
    var prev;
    while (temp) {
      if (temp.data === data) {
        next = temp.next;
        prev = temp.prev;
        if (next) {
          next.prev = prev;
        }
        if (prev) {
          prev.next = next;
        }
        if (temp === this.first) {
          this.first = next;
        }
        if (temp === this.last) {
          this.last = prev;
        }
        return true;
      }
      temp = temp.next;
    }
    return false;
  },
  hasCycle: function() {
    var fast = this.first;
    var slow = this.first;
    while (true) {
      if (fast === null) {
        return false;
      }
      fast = fast.next;
      if (fast === null) {
        return false;
      }
      fast = fast.next;
      slow = slow.next;
      if (fast === slow) {
        return true;
      }
    }
  },
  pop: function() {
    if (this.last === null) {
      return null;
    }
    var temp = this.last;
    this.last = this.last.prev;
    return temp;
  },
  shift: function() {
    if (this.first === null) {
      return null;
    }
    var temp = this.first;
    this.first = this.first.next;
    return temp;
  },
  recursiveReverse: function() {
    function inverse(current, next) {
      if (!next) {
        return;
      }
      inverse(next, next.next);
      next.next = current;
    }
    if (!this.first) {
      return;
    }
    inverse(this.first, this.first.next);
    this.first.next = null;
    var temp = this.first;
    this.first = this.last;
    this.last = temp;
  },
  reverse: function() {
    if (!this.first || !this.first.next) {
      return;
    }
    var current = this.first.next;
    var prev = this.first;
    var temp;
    while (current) {
      temp = current.next;
      current.next = prev;
      prev.prev = current;
      prev = current;
      current = temp;
    }
    this.first.next = null;
    this.last.prev = null;
    temp = this.first;
    this.first = prev;
    this.last = temp;
  }
}, {});
;
;
Handsontable.utils.NodeStructure = NodeStructure;
Handsontable.utils.LinkedList = LinkedList;

//# 
},{"browser":24}],128:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  GhostTable: {get: function() {
      return GhostTable;
    }},
  __esModule: {value: true}
});
var $___46__46__47_browser__,
    $___46__46__47_helpers_47_dom_47_element__,
    $___46__46__47_helpers_47_array__,
    $___46__46__47_helpers_47_object__,
    $___46__46__47_helpers_47_number__,
    $___46__46__47_helpers_47_mixed__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var $__1 = ($___46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47_helpers_47_dom_47_element__ && $___46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47_helpers_47_dom_47_element__}),
    addClass = $__1.addClass,
    outerHeight = $__1.outerHeight,
    outerWidth = $__1.outerWidth;
var arrayEach = ($___46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47_helpers_47_array__ && $___46__46__47_helpers_47_array__.__esModule && $___46__46__47_helpers_47_array__ || {default: $___46__46__47_helpers_47_array__}).arrayEach;
var objectEach = ($___46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47_helpers_47_object__ && $___46__46__47_helpers_47_object__.__esModule && $___46__46__47_helpers_47_object__ || {default: $___46__46__47_helpers_47_object__}).objectEach;
var rangeEach = ($___46__46__47_helpers_47_number__ = _dereq_("helpers/number"), $___46__46__47_helpers_47_number__ && $___46__46__47_helpers_47_number__.__esModule && $___46__46__47_helpers_47_number__ || {default: $___46__46__47_helpers_47_number__}).rangeEach;
var stringify = ($___46__46__47_helpers_47_mixed__ = _dereq_("helpers/mixed"), $___46__46__47_helpers_47_mixed__ && $___46__46__47_helpers_47_mixed__.__esModule && $___46__46__47_helpers_47_mixed__ || {default: $___46__46__47_helpers_47_mixed__}).stringify;
var GhostTable = function GhostTable(hotInstance) {
  this.hot = hotInstance;
  this.container = null;
  this.injected = false;
  this.rows = [];
  this.columns = [];
  this.samples = null;
  this.settings = {useHeaders: true};
};
($traceurRuntime.createClass)(GhostTable, {
  addRow: function(row, samples) {
    if (this.columns.length) {
      throw new Error('Doesn\'t support multi-dimensional table');
    }
    if (!this.rows.length) {
      this.container = this.createContainer(this.hot.rootElement.className);
    }
    var rowObject = {row: row};
    this.rows.push(rowObject);
    this.samples = samples;
    this.table = this.createTable(this.hot.table.className);
    this.table.colGroup.appendChild(this.createColGroupsCol());
    this.table.tr.appendChild(this.createRow(row));
    this.container.container.appendChild(this.table.fragment);
    rowObject.table = this.table.table;
  },
  addColumnHeadersRow: function(samples) {
    if (this.hot.getColHeader(0) != null) {
      var rowObject = {row: -1};
      this.rows.push(rowObject);
      this.container = this.createContainer(this.hot.rootElement.className);
      this.samples = samples;
      this.table = this.createTable(this.hot.table.className);
      this.table.colGroup.appendChild(this.createColGroupsCol());
      this.table.tHead.appendChild(this.createColumnHeadersRow());
      this.container.container.appendChild(this.table.fragment);
      rowObject.table = this.table.table;
    }
  },
  addColumn: function(column, samples) {
    if (this.rows.length) {
      throw new Error('Doesn\'t support multi-dimensional table');
    }
    if (!this.columns.length) {
      this.container = this.createContainer(this.hot.rootElement.className);
    }
    var columnObject = {col: column};
    this.columns.push(columnObject);
    this.samples = samples;
    this.table = this.createTable(this.hot.table.className);
    if (this.getSetting('useHeaders') && this.hot.getColHeader(column) !== null) {
      this.hot.view.appendColHeader(column, this.table.th);
    }
    this.table.tBody.appendChild(this.createCol(column));
    this.container.container.appendChild(this.table.fragment);
    columnObject.table = this.table.table;
  },
  getHeights: function(callback) {
    if (!this.injected) {
      this.injectTable();
    }
    arrayEach(this.rows, (function(row) {
      callback(row.row, outerHeight(row.table) - 1);
    }));
  },
  getWidths: function(callback) {
    if (!this.injected) {
      this.injectTable();
    }
    arrayEach(this.columns, (function(column) {
      callback(column.col, outerWidth(column.table));
    }));
  },
  setSettings: function(settings) {
    this.settings = settings;
  },
  setSetting: function(name, value) {
    if (!this.settings) {
      this.settings = {};
    }
    this.settings[name] = value;
  },
  getSettings: function() {
    return this.settings;
  },
  getSetting: function(name) {
    if (this.settings) {
      return this.settings[name];
    } else {
      return null;
    }
  },
  createColGroupsCol: function() {
    var $__6 = this;
    var d = document;
    var fragment = d.createDocumentFragment();
    if (this.hot.hasRowHeaders()) {
      fragment.appendChild(this.createColElement(-1));
    }
    this.samples.forEach((function(sample) {
      arrayEach(sample.strings, (function(string) {
        fragment.appendChild($__6.createColElement(string.col));
      }));
    }));
    return fragment;
  },
  createRow: function(row) {
    var $__6 = this;
    var d = document;
    var fragment = d.createDocumentFragment();
    var th = d.createElement('th');
    if (this.hot.hasRowHeaders()) {
      this.hot.view.appendRowHeader(row, th);
      fragment.appendChild(th);
    }
    this.samples.forEach((function(sample) {
      arrayEach(sample.strings, (function(string) {
        var column = string.col;
        var cellProperties = $__6.hot.getCellMeta(row, column);
        cellProperties.col = column;
        cellProperties.row = row;
        var renderer = $__6.hot.getCellRenderer(cellProperties);
        var td = d.createElement('td');
        renderer($__6.hot, td, row, column, $__6.hot.colToProp(column), string.value, cellProperties);
        fragment.appendChild(td);
      }));
    }));
    return fragment;
  },
  createColumnHeadersRow: function() {
    var $__6 = this;
    var d = document;
    var fragment = d.createDocumentFragment();
    if (this.hot.hasRowHeaders()) {
      var th = d.createElement('th');
      this.hot.view.appendColHeader(-1, th);
      fragment.appendChild(th);
    }
    this.samples.forEach((function(sample) {
      arrayEach(sample.strings, (function(string) {
        var column = string.col;
        var th = d.createElement('th');
        $__6.hot.view.appendColHeader(column, th);
        fragment.appendChild(th);
      }));
    }));
    return fragment;
  },
  createCol: function(column) {
    var $__6 = this;
    var d = document;
    var fragment = d.createDocumentFragment();
    this.samples.forEach((function(sample) {
      arrayEach(sample.strings, (function(string) {
        var row = string.row;
        var cellProperties = $__6.hot.getCellMeta(row, column);
        cellProperties.col = column;
        cellProperties.row = row;
        var renderer = $__6.hot.getCellRenderer(cellProperties);
        var td = d.createElement('td');
        var tr = d.createElement('tr');
        renderer($__6.hot, td, row, column, $__6.hot.colToProp(column), string.value, cellProperties);
        tr.appendChild(td);
        fragment.appendChild(tr);
      }));
    }));
    return fragment;
  },
  clean: function() {
    this.rows.length = 0;
    this.rows[-1] = void 0;
    this.columns.length = 0;
    if (this.samples) {
      this.samples.clear();
    }
    this.samples = null;
    this.removeTable();
  },
  injectTable: function() {
    var parent = arguments[0] !== (void 0) ? arguments[0] : null;
    if (!this.injected) {
      (parent || this.hot.rootElement).appendChild(this.container.fragment);
      this.injected = true;
    }
  },
  removeTable: function() {
    if (this.injected && this.container.container.parentNode) {
      this.container.container.parentNode.removeChild(this.container.container);
      this.container = null;
      this.injected = false;
    }
  },
  createColElement: function(column) {
    var d = document;
    var col = d.createElement('col');
    col.style.width = this.hot.view.wt.wtTable.getStretchedColumnWidth(column) + 'px';
    return col;
  },
  createTable: function() {
    var className = arguments[0] !== (void 0) ? arguments[0] : '';
    var d = document;
    var fragment = d.createDocumentFragment();
    var table = d.createElement('table');
    var tHead = d.createElement('thead');
    var tBody = d.createElement('tbody');
    var colGroup = d.createElement('colgroup');
    var tr = d.createElement('tr');
    var th = d.createElement('th');
    if (this.isVertical()) {
      table.appendChild(colGroup);
    }
    if (this.isHorizontal()) {
      tr.appendChild(th);
      tHead.appendChild(tr);
      table.style.tableLayout = 'auto';
      table.style.width = 'auto';
    }
    table.appendChild(tHead);
    if (this.isVertical()) {
      tBody.appendChild(tr);
    }
    table.appendChild(tBody);
    addClass(table, className);
    fragment.appendChild(table);
    return {
      fragment: fragment,
      table: table,
      tHead: tHead,
      tBody: tBody,
      colGroup: colGroup,
      tr: tr,
      th: th
    };
  },
  createContainer: function() {
    var className = arguments[0] !== (void 0) ? arguments[0] : '';
    var d = document;
    var fragment = d.createDocumentFragment();
    var container = d.createElement('div');
    className = 'htGhostTable htAutoSize ' + className.trim();
    addClass(container, className);
    fragment.appendChild(container);
    return {
      fragment: fragment,
      container: container
    };
  },
  isVertical: function() {
    return this.rows.length && !this.columns.length ? true : false;
  },
  isHorizontal: function() {
    return this.columns.length && !this.rows.length ? true : false;
  }
}, {});
;
Handsontable.utils.GhostTable = GhostTable;

//# 
},{"browser":24,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,"helpers/number":52,"helpers/object":53}],129:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  Interval: {get: function() {
      return Interval;
    }},
  __esModule: {value: true}
});
var $___46__46__47_browser__,
    $___46__46__47_helpers_47_feature__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var $__1 = ($___46__46__47_helpers_47_feature__ = _dereq_("helpers/feature"), $___46__46__47_helpers_47_feature__ && $___46__46__47_helpers_47_feature__.__esModule && $___46__46__47_helpers_47_feature__ || {default: $___46__46__47_helpers_47_feature__}),
    requestAnimationFrame = $__1.requestAnimationFrame,
    cancelAnimationFrame = $__1.cancelAnimationFrame;
var Interval = function Interval(func, delay) {
  var $__2 = this;
  this.timer = null;
  this.func = func;
  this.delay = parseDelay(delay);
  this.stopped = true;
  this._then = null;
  this._callback = (function() {
    return $__2.__callback();
  });
};
var $Interval = Interval;
($traceurRuntime.createClass)(Interval, {
  start: function() {
    if (this.stopped) {
      this._then = Date.now();
      this.stopped = false;
      this.timer = requestAnimationFrame(this._callback);
    }
    return this;
  },
  stop: function() {
    if (!this.stopped) {
      this.stopped = true;
      cancelAnimationFrame(this.timer);
      this.timer = null;
    }
    return this;
  },
  __callback: function() {
    this.timer = requestAnimationFrame(this._callback);
    if (this.delay) {
      var now = Date.now();
      var elapsed = now - this._then;
      if (elapsed > this.delay) {
        this._then = now - (elapsed % this.delay);
        this.func();
      }
    } else {
      this.func();
    }
  }
}, {create: function(func, delay) {
    return new $Interval(func, delay);
  }});
;
function parseDelay(delay) {
  if (typeof delay === 'string' && /fps$/.test(delay)) {
    delay = 1000 / parseInt(delay.replace('fps', '') || 0, 10);
  }
  return delay;
}
Handsontable.utils.Interval = Interval;

//# 
},{"browser":24,"helpers/feature":49}],130:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  registerIdentity: {get: function() {
      return registerIdentity;
    }},
  getTranslator: {get: function() {
      return getTranslator;
    }},
  __esModule: {value: true}
});
var $___46__46__47_browser__,
    $___46__46__47_helpers_47_object__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var isObject = ($___46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47_helpers_47_object__ && $___46__46__47_helpers_47_object__.__esModule && $___46__46__47_helpers_47_object__ || {default: $___46__46__47_helpers_47_object__}).isObject;
var RecordTranslator = function RecordTranslator(hot) {
  this.hot = hot;
};
($traceurRuntime.createClass)(RecordTranslator, {
  toVisualRow: function(row) {
    return this.hot.runHooks('unmodifyRow', row);
  },
  toVisualColumn: function(column) {
    return this.hot.runHooks('unmodifyCol', column);
  },
  toVisual: function(row, column) {
    var result;
    if (isObject(row)) {
      result = {
        row: this.toVisualRow(row.row),
        column: this.toVisualColumn(row.column)
      };
    } else {
      result = [this.toVisualRow(row), this.toVisualColumn(column)];
    }
    return result;
  },
  toPhysicalRow: function(row) {
    return this.hot.runHooks('modifyRow', row);
  },
  toPhysicalColumn: function(column) {
    return this.hot.runHooks('modifyCol', column);
  },
  toPhysical: function(row, column) {
    var result;
    if (isObject(row)) {
      result = {
        row: this.toPhysicalRow(row.row),
        column: this.toPhysicalColumn(row.column)
      };
    } else {
      result = [this.toPhysicalRow(row), this.toPhysicalColumn(column)];
    }
    return result;
  }
}, {});
var identities = new WeakMap();
var translatorSingletons = new WeakMap();
function registerIdentity(identity, hot) {
  identities.set(identity, hot);
}
function getTranslator(identity) {
  var singleton;
  if (!(identity instanceof Handsontable.Core)) {
    if (!identities.has(identity)) {
      throw Error('Record translator was not registered for this object identity');
    }
    identity = identities.get(identity);
  }
  if (translatorSingletons.has(identity)) {
    singleton = translatorSingletons.get(identity);
  } else {
    singleton = new RecordTranslator(identity);
    translatorSingletons.set(identity, singleton);
  }
  return singleton;
}
Handsontable.utils.RecordTranslator = RecordTranslator;
Handsontable.utils.RecordTranslatorUtils = {
  registerIdentity: registerIdentity,
  getTranslator: getTranslator
};

//# 
},{"browser":24,"helpers/object":53}],131:[function(_dereq_,module,exports){
"use strict";
var $__8;
Object.defineProperties(exports, {
  SamplesGenerator: {get: function() {
      return SamplesGenerator;
    }},
  __esModule: {value: true}
});
var $___46__46__47_browser__,
    $___46__46__47_helpers_47_dom_47_element__,
    $___46__46__47_helpers_47_array__,
    $___46__46__47_helpers_47_object__,
    $___46__46__47_helpers_47_number__,
    $___46__46__47_helpers_47_mixed__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var $__1 = ($___46__46__47_helpers_47_dom_47_element__ = _dereq_("helpers/dom/element"), $___46__46__47_helpers_47_dom_47_element__ && $___46__46__47_helpers_47_dom_47_element__.__esModule && $___46__46__47_helpers_47_dom_47_element__ || {default: $___46__46__47_helpers_47_dom_47_element__}),
    addClass = $__1.addClass,
    outerHeight = $__1.outerHeight,
    outerWidth = $__1.outerWidth;
var arrayEach = ($___46__46__47_helpers_47_array__ = _dereq_("helpers/array"), $___46__46__47_helpers_47_array__ && $___46__46__47_helpers_47_array__.__esModule && $___46__46__47_helpers_47_array__ || {default: $___46__46__47_helpers_47_array__}).arrayEach;
var $__3 = ($___46__46__47_helpers_47_object__ = _dereq_("helpers/object"), $___46__46__47_helpers_47_object__ && $___46__46__47_helpers_47_object__.__esModule && $___46__46__47_helpers_47_object__ || {default: $___46__46__47_helpers_47_object__}),
    objectEach = $__3.objectEach,
    isObject = $__3.isObject;
var rangeEach = ($___46__46__47_helpers_47_number__ = _dereq_("helpers/number"), $___46__46__47_helpers_47_number__ && $___46__46__47_helpers_47_number__.__esModule && $___46__46__47_helpers_47_number__ || {default: $___46__46__47_helpers_47_number__}).rangeEach;
var stringify = ($___46__46__47_helpers_47_mixed__ = _dereq_("helpers/mixed"), $___46__46__47_helpers_47_mixed__ && $___46__46__47_helpers_47_mixed__.__esModule && $___46__46__47_helpers_47_mixed__ || {default: $___46__46__47_helpers_47_mixed__}).stringify;
var SamplesGenerator = function SamplesGenerator(dataFactory) {
  this.samples = null;
  this.dataFactory = dataFactory;
  this.customSampleCount = null;
  this.allowDuplicates = false;
};
var $SamplesGenerator = SamplesGenerator;
($traceurRuntime.createClass)(SamplesGenerator, ($__8 = {}, Object.defineProperty($__8, "getSampleCount", {
  value: function() {
    if (this.customSampleCount) {
      return this.customSampleCount;
    }
    return $SamplesGenerator.SAMPLE_COUNT;
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__8, "setSampleCount", {
  value: function(sampleCount) {
    this.customSampleCount = sampleCount;
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__8, "setAllowDuplicates", {
  value: function(allowDuplicates) {
    this.allowDuplicates = allowDuplicates;
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__8, "generateRowSamples", {
  value: function(rowRange, colRange) {
    return this.generateSamples('row', colRange, rowRange);
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__8, "generateColumnSamples", {
  value: function(colRange, rowRange) {
    return this.generateSamples('col', rowRange, colRange);
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__8, "generateSamples", {
  value: function(type, range, specifierRange) {
    var $__6 = this;
    var samples = new Map();
    if (typeof specifierRange === 'number') {
      specifierRange = {
        from: specifierRange,
        to: specifierRange
      };
    }
    rangeEach(specifierRange.from, specifierRange.to, (function(index) {
      var sample = $__6.generateSample(type, range, index);
      samples.set(index, sample);
    }));
    return samples;
  },
  configurable: true,
  enumerable: true,
  writable: true
}), Object.defineProperty($__8, "generateSample", {
  value: function(type, range, specifierValue) {
    var $__6 = this;
    var samples = new Map();
    var sampledValues = [];
    var length;
    rangeEach(range.from, range.to, (function(index) {
      var $__8;
      var value;
      if (type === 'row') {
        value = $__6.dataFactory(specifierValue, index);
      } else if (type === 'col') {
        value = $__6.dataFactory(index, specifierValue);
      } else {
        throw new Error('Unsupported sample type');
      }
      if (isObject(value)) {
        length = Object.keys(value).length;
      } else if (Array.isArray(value)) {
        length = value.length;
      } else {
        length = stringify(value).length;
      }
      if (!samples.has(length)) {
        samples.set(length, {
          needed: $__6.getSampleCount(),
          strings: []
        });
      }
      var sample = samples.get(length);
      if (sample.needed) {
        var duplicate = sampledValues.indexOf(value) > -1;
        if (!duplicate || $__6.allowDuplicates) {
          var computedKey = type === 'row' ? 'col' : 'row';
          sample.strings.push(($__8 = {}, Object.defineProperty($__8, "value", {
            value: value,
            configurable: true,
            enumerable: true,
            writable: true
          }), Object.defineProperty($__8, computedKey, {
            value: index,
            configurable: true,
            enumerable: true,
            writable: true
          }), $__8));
          sampledValues.push(value);
          sample.needed--;
        }
      }
    }));
    return samples;
  },
  configurable: true,
  enumerable: true,
  writable: true
}), $__8), {get SAMPLE_COUNT() {
    return 3;
  }});
;
Handsontable.utils.SamplesGenerator = SamplesGenerator;

//# 
},{"browser":24,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,"helpers/number":52,"helpers/object":53}],132:[function(_dereq_,module,exports){
"use strict";
Object.defineProperties(exports, {
  mergeSort: {get: function() {
      return mergeSort;
    }},
  __esModule: {value: true}
});
var $___46__46__47_dataStructures_47_linkedList__,
    $___46__46__47__46__46__47_browser__;
var LinkedList = ($___46__46__47_dataStructures_47_linkedList__ = _dereq_("../dataStructures/linkedList"), $___46__46__47_dataStructures_47_linkedList__ && $___46__46__47_dataStructures_47_linkedList__.__esModule && $___46__46__47_dataStructures_47_linkedList__ || {default: $___46__46__47_dataStructures_47_linkedList__}).LinkedList;
var Handsontable = ($___46__46__47__46__46__47_browser__ = _dereq_("browser"), $___46__46__47__46__46__47_browser__ && $___46__46__47__46__46__47_browser__.__esModule && $___46__46__47__46__46__47_browser__ || {default: $___46__46__47__46__46__47_browser__}).default;
var defaultCompareFunction = function(a, b) {
  var firstValue = a.toString();
  var secondValue = b.toString();
  if (firstValue === secondValue) {
    return 0;
  } else if (firstValue < secondValue) {
    return -1;
  } else {
    return 1;
  }
};
function mergeSort(array) {
  var compareFunction = arguments[1] !== (void 0) ? arguments[1] : defaultCompareFunction;
  var startIndex = arguments[2] !== (void 0) ? arguments[2] : 0;
  var endIndex = arguments[3] !== (void 0) ? arguments[3] : array.length;
  if (Math.abs(endIndex - startIndex) <= 1) {
    return [];
  }
  var middleIndex = Math.ceil((startIndex + endIndex) / 2);
  mergeSort(array, compareFunction, startIndex, middleIndex);
  mergeSort(array, compareFunction, middleIndex, endIndex);
  return merge(array, compareFunction, startIndex, middleIndex, endIndex);
}
function merge(array, compareFunction, startIndex, middleIndex, endIndex) {
  var leftElements = new LinkedList();
  var rightElements = new LinkedList();
  var leftSize = middleIndex - startIndex;
  var rightSize = endIndex - middleIndex;
  var maxSize = Math.max(leftSize, rightSize);
  var size = endIndex - startIndex;
  for (var i$__2 = 0; i$__2 < maxSize; i$__2 += 1) {
    if (i$__2 < leftSize) {
      leftElements.push(array[startIndex + i$__2]);
    }
    if (i$__2 < rightSize) {
      rightElements.push(array[middleIndex + i$__2]);
    }
  }
  var i = 0;
  while (i < size) {
    if (leftElements.first && rightElements.first) {
      if (compareFunction(leftElements.first.data, rightElements.first.data) > 0) {
        array[startIndex + i] = rightElements.shift().data;
      } else {
        array[startIndex + i] = leftElements.shift().data;
      }
    } else if (leftElements.first) {
      array[startIndex + i] = leftElements.shift().data;
    } else {
      array[startIndex + i] = rightElements.shift().data;
    }
    i += 1;
  }
  return array;
}
;
Handsontable.utils.mergeSort = mergeSort;

//# 
},{"../dataStructures/linkedList":127,"browser":24}],133:[function(_dereq_,module,exports){
"use strict";
var $___46__46__47_browser__,
    $___46__46__47_helpers_47_mixed__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var stringify = ($___46__46__47_helpers_47_mixed__ = _dereq_("helpers/mixed"), $___46__46__47_helpers_47_mixed__ && $___46__46__47_helpers_47_mixed__.__esModule && $___46__46__47_helpers_47_mixed__ || {default: $___46__46__47_helpers_47_mixed__}).stringify;
Handsontable.AutocompleteValidator = function(value, callback) {
  if (value == null) {
    value = '';
  }
  if (this.allowEmpty && value === '') {
    callback(true);
    return;
  }
  if (this.strict && this.source) {
    if (typeof this.source === 'function') {
      this.source(value, process(value, callback));
    } else {
      process(value, callback)(this.source);
    }
  } else {
    callback(true);
  }
};
function process(value, callback) {
  var originalVal = value;
  return function(source) {
    var found = false;
    for (var s = 0,
        slen = source.length; s < slen; s++) {
      if (originalVal === source[s]) {
        found = true;
        break;
      }
    }
    callback(found);
  };
}

//# 
},{"browser":24,"helpers/mixed":51}],134:[function(_dereq_,module,exports){
"use strict";
var $___46__46__47_browser__,
    $__moment__,
    $___46__46__47_helpers_47_date__,
    $___46__46__47_editors__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var moment = ($__moment__ = _dereq_("moment"), $__moment__ && $__moment__.__esModule && $__moment__ || {default: $__moment__}).default;
var getNormalizedDate = ($___46__46__47_helpers_47_date__ = _dereq_("../helpers/date"), $___46__46__47_helpers_47_date__ && $___46__46__47_helpers_47_date__.__esModule && $___46__46__47_helpers_47_date__ || {default: $___46__46__47_helpers_47_date__}).getNormalizedDate;
var getEditor = ($___46__46__47_editors__ = _dereq_("editors"), $___46__46__47_editors__ && $___46__46__47_editors__.__esModule && $___46__46__47_editors__ || {default: $___46__46__47_editors__}).getEditor;
Handsontable.DateValidator = function(value, callback) {
  var valid = true;
  var dateEditor = getEditor('date', this.instance);
  if (value == null) {
    value = '';
  }
  var isValidDate = moment(new Date(value)).isValid() || moment(value, dateEditor.defaultDateFormat).isValid();
  var isValidFormat = moment(value, this.dateFormat || dateEditor.defaultDateFormat, true).isValid();
  if (this.allowEmpty && value === '') {
    isValidDate = true;
    isValidFormat = true;
  }
  if (!isValidDate) {
    valid = false;
  }
  if (!isValidDate && isValidFormat) {
    valid = true;
  }
  if (isValidDate && !isValidFormat) {
    if (this.correctFormat === true) {
      var correctedValue = correctFormat(value, this.dateFormat);
      var row = this.instance.runHooks('unmodifyRow', this.row);
      var column = this.instance.runHooks('unmodifyCol', this.col);
      this.instance.setDataAtCell(row, column, correctedValue, 'dateValidator');
      valid = true;
    } else {
      valid = false;
    }
  }
  callback(valid);
};
var correctFormat = function correctFormat(value, dateFormat) {
  var dateFromDate = moment(getNormalizedDate(value));
  var dateFromMoment = moment(value, dateFormat);
  var isAlphanumeric = value.search(/[A-z]/g) > -1;
  var date;
  if ((dateFromDate.isValid() && dateFromDate.format('x') === dateFromMoment.format('x')) || !dateFromMoment.isValid() || isAlphanumeric) {
    date = dateFromDate;
  } else {
    date = dateFromMoment;
  }
  return date.format(dateFormat);
};

//# 
},{"../helpers/date":46,"browser":24,"editors":30,"moment":"moment"}],135:[function(_dereq_,module,exports){
"use strict";
var $___46__46__47_browser__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
Handsontable.NumericValidator = function(value, callback) {
  if (value == null) {
    value = '';
  }
  if (this.allowEmpty && value === '') {
    callback(true);
  } else if (value === '') {
    callback(false);
  } else {
    callback(/^-?\d*(\.|\,)?\d*$/.test(value));
  }
};

//# 
},{"browser":24}],136:[function(_dereq_,module,exports){
"use strict";
var $___46__46__47_browser__,
    $__moment__;
var Handsontable = ($___46__46__47_browser__ = _dereq_("browser"), $___46__46__47_browser__ && $___46__46__47_browser__.__esModule && $___46__46__47_browser__ || {default: $___46__46__47_browser__}).default;
var moment = ($__moment__ = _dereq_("moment"), $__moment__ && $__moment__.__esModule && $__moment__ || {default: $__moment__}).default;
var STRICT_FORMATS = ['YYYY-MM-DDTHH:mm:ss.SSSZ', 'X', 'x'];
Handsontable.TimeValidator = function(value, callback) {
  var valid = true;
  var timeFormat = this.timeFormat || 'h:mm:ss a';
  if (value === null) {
    value = '';
  }
  value = /^\d{3,}$/.test(value) ? parseInt(value, 10) : value;
  var twoDigitValue = /^\d{1,2}$/.test(value);
  if (twoDigitValue) {
    value = value + ':00';
  }
  var date = moment(value, STRICT_FORMATS, true).isValid() ? moment(value) : moment(value, timeFormat);
  var isValidTime = date.isValid();
  var isValidFormat = moment(value, timeFormat, true).isValid() && !twoDigitValue;
  if (this.allowEmpty && value === '') {
    isValidTime = true;
    isValidFormat = true;
  }
  if (!isValidTime) {
    valid = false;
  }
  if (!isValidTime && isValidFormat) {
    valid = true;
  }
  if (isValidTime && !isValidFormat) {
    if (this.correctFormat === true) {
      var correctedValue = date.format(timeFormat);
      var row = this.instance.runHooks('unmodifyRow', this.row);
      var column = this.instance.runHooks('unmodifyCol', this.col);
      this.instance.setDataAtCell(row, column, correctedValue, 'timeValidator');
      valid = true;
    } else {
      valid = false;
    }
  }
  callback(valid);
};

//# 
},{"browser":24,"moment":"moment"}],"SheetClip":[function(_dereq_,module,exports){
/**
 * SheetClip - Spreadsheet Clipboard Parser
 * version 0.2
 *
 * This tiny library transforms JavaScript arrays to strings that are pasteable by LibreOffice, OpenOffice,
 * Google Docs and Microsoft Excel.
 *
 * Copyright 2012, Marcin Warpechowski
 * Licensed under the MIT license.
 * http://github.com/warpech/sheetclip/
 */
/*jslint white: true*/
(function (global) {
  "use strict";

  function countQuotes(str) {
    return str.split('"').length - 1;
  }

  var SheetClip = {
    /**
     * Decode spreadsheet string into array
     *
     * @param {String} str
     * @returns {Array}
     */
    parse: function (str) {
      var r, rLen, rows, arr = [], a = 0, c, cLen, multiline, last;

      rows = str.split('\n');

      if (rows.length > 1 && rows[rows.length - 1] === '') {
        rows.pop();
      }
      for (r = 0, rLen = rows.length; r < rLen; r += 1) {
        rows[r] = rows[r].split('\t');

        for (c = 0, cLen = rows[r].length; c < cLen; c += 1) {
          if (!arr[a]) {
            arr[a] = [];
          }
          if (multiline && c === 0) {
            last = arr[a].length - 1;
            arr[a][last] = arr[a][last] + '\n' + rows[r][0];

            if (multiline && (countQuotes(rows[r][0]) & 1)) { //& 1 is a bitwise way of performing mod 2
              multiline = false;
              arr[a][last] = arr[a][last].substring(0, arr[a][last].length - 1).replace(/""/g, '"');
            }
          }
          else {
            if (c === cLen - 1 && rows[r][c].indexOf('"') === 0 && (countQuotes(rows[r][c]) & 1)) {
              arr[a].push(rows[r][c].substring(1).replace(/""/g, '"'));
              multiline = true;
            }
            else {
              arr[a].push(rows[r][c].replace(/""/g, '"'));
              multiline = false;
            }
          }
        }
        if (!multiline) {
          a += 1;
        }
      }

      return arr;
    },

    /**
     * Encode array into valid spreadsheet string
     *
     * @param arr
     * @returns {String}
     */
    stringify: function (arr) {
      var r, rLen, c, cLen, str = '', val;

      for (r = 0, rLen = arr.length; r < rLen; r += 1) {
        cLen = arr[r].length;

        for (c = 0; c < cLen; c += 1) {
          if (c > 0) {
            str += '\t';
          }
          val = arr[r][c];

          if (typeof val === 'string') {
            if (val.indexOf('\n') > -1) {
              str += '"' + val.replace(/"/g, '""') + '"';
            }
            else {
              str += val;
            }
          }
          else if (val === null || val === void 0) { // void 0 resolves to undefined
            str += '';
          }
          else {
            str += val;
          }
        }
        str += '\n';
      }

      return str;
    }
  };

  if (typeof exports !== 'undefined') {
    exports.parse = SheetClip.parse;
    exports.stringify = SheetClip.stringify;
  } else {
    global.SheetClip = SheetClip;
  }
}(window));

},{}],"autoResize":[function(_dereq_,module,exports){
/**
 * autoResize - resizes a DOM element to the width and height of another DOM element
 *
 * Copyright 2014, Marcin Warpechowski
 * Licensed under the MIT license
 */


function autoResize() {
  var defaults = {
      minHeight: 200,
      maxHeight: 300,
      minWidth: 100,
      maxWidth: 300
    },
    el,
    body = document.body,
    text = document.createTextNode(''),
    span = document.createElement('SPAN'),
    observe = function (element, event, handler) {
      if (window.attachEvent) {
        element.attachEvent('on' + event, handler);
      } else {
        element.addEventListener(event, handler, false);
      }
    },
    unObserve = function (element, event, handler) {
      if (window.removeEventListener) {
        element.removeEventListener(event, handler, false);
      } else {
        element.detachEvent('on' + event, handler);
      }
    },
    resize = function (newChar) {
      var width, scrollHeight;

      if (!newChar) {
        newChar = "";
      } else if (!/^[a-zA-Z \.,\\\/\|0-9]$/.test(newChar)) {
        newChar = ".";
      }

      if (text.textContent !== void 0) {
        text.textContent = el.value + newChar;
      }
      else {
        text.data = el.value + newChar; //IE8
      }
      span.style.fontSize = getComputedStyle(el).fontSize;
      span.style.fontFamily = getComputedStyle(el).fontFamily;
      span.style.whiteSpace = "pre";

      body.appendChild(span);
      width = span.clientWidth + 2;
      body.removeChild(span);

      el.style.height = defaults.minHeight + 'px';

      if (defaults.minWidth > width) {
        el.style.width = defaults.minWidth + 'px';

      } else if (width > defaults.maxWidth) {
        el.style.width = defaults.maxWidth + 'px';

      } else {
        el.style.width = width + 'px';
      }
      scrollHeight = el.scrollHeight ? el.scrollHeight - 1 : 0;

      if (defaults.minHeight > scrollHeight) {
        el.style.height = defaults.minHeight + 'px';

      } else if (defaults.maxHeight < scrollHeight) {
        el.style.height = defaults.maxHeight + 'px';
        el.style.overflowY = 'visible';

      } else {
        el.style.height = scrollHeight + 'px';
      }
    },
    delayedResize = function () {
      window.setTimeout(resize, 0);
    },
    extendDefaults = function (config) {

      if (config && config.minHeight) {
        if (config.minHeight == 'inherit') {
          defaults.minHeight = el.clientHeight;
        } else {
          var minHeight = parseInt(config.minHeight);
          if (!isNaN(minHeight)) {
            defaults.minHeight = minHeight;
          }
        }
      }

      if (config && config.maxHeight) {
        if (config.maxHeight == 'inherit') {
          defaults.maxHeight = el.clientHeight;
        } else {
          var maxHeight = parseInt(config.maxHeight);
          if (!isNaN(maxHeight)) {
            defaults.maxHeight = maxHeight;
          }
        }
      }

      if (config && config.minWidth) {
        if (config.minWidth == 'inherit') {
          defaults.minWidth = el.clientWidth;
        } else {
          var minWidth = parseInt(config.minWidth);
          if (!isNaN(minWidth)) {
            defaults.minWidth = minWidth;
          }
        }
      }

      if (config && config.maxWidth) {
        if (config.maxWidth == 'inherit') {
          defaults.maxWidth = el.clientWidth;
        } else {
          var maxWidth = parseInt(config.maxWidth);
          if (!isNaN(maxWidth)) {
            defaults.maxWidth = maxWidth;
          }
        }
      }

      if(!span.firstChild) {
        span.className = "autoResize";
        span.style.display = 'inline-block';
        span.appendChild(text);
      }
    },
    init = function (el_, config, doObserve) {
      el = el_;
      extendDefaults(config);

      if (el.nodeName == 'TEXTAREA') {

        el.style.resize = 'none';
        el.style.overflowY = '';
        el.style.height = defaults.minHeight + 'px';
        el.style.minWidth = defaults.minWidth + 'px';
        el.style.maxWidth = defaults.maxWidth + 'px';
        el.style.overflowY = 'hidden';
      }

      if(doObserve) {
        observe(el, 'change', resize);
        observe(el, 'cut', delayedResize);
        observe(el, 'paste', delayedResize);
        observe(el, 'drop', delayedResize);
        observe(el, 'keydown', delayedResize);
        observe(el, 'focus', resize);
      }

      resize();
    };

  function getComputedStyle(element) {
    return element.currentStyle || document.defaultView.getComputedStyle(element);
  }

  return {
    init: function (el_, config, doObserve) {
      init(el_, config, doObserve);
    },
    unObserve: function () {
      unObserve(el, 'change', resize);
      unObserve(el, 'cut', delayedResize);
      unObserve(el, 'paste', delayedResize);
      unObserve(el, 'drop', delayedResize);
      unObserve(el, 'keydown', delayedResize);
      unObserve(el, 'focus', resize);
    },
    resize: resize
  };
}

if (typeof exports !== 'undefined') {
  module.exports = autoResize;
}

},{}],"copyPaste":[function(_dereq_,module,exports){
/**
 * Creates a textarea that stays hidden on the page and gets focused when user presses CTRL while not having a form
 * input focused.
 * In future we may implement a better driver when better APIs are available.
 *
 * @constructor
 * @private
 */

var instance;

function copyPaste() {
  if (!instance) {
    instance = new CopyPasteClass();

  } else if (instance.hasBeenDestroyed()){
    instance.init();
  }
  instance.refCounter++;

  return instance;
}

if (typeof exports !== 'undefined') {
  module.exports = copyPaste;
}

function CopyPasteClass() {
  this.refCounter = 0;
  this.init();
}

CopyPasteClass.prototype.init = function () {
  var
    style,
    parent;

  this.copyCallbacks = [];
  this.cutCallbacks = [];
  this.pasteCallbacks = [];

  // this.listenerElement = document.documentElement;
  parent = document.body;

  if (document.getElementById('CopyPasteDiv')) {
    this.elDiv = document.getElementById('CopyPasteDiv');
    this.elTextarea = this.elDiv.firstChild;

  } else {
    this.elDiv = document.createElement('div');
    this.elDiv.id = 'CopyPasteDiv';
    style = this.elDiv.style;
    style.position = 'fixed';
    style.top = '-10000px';
    style.left = '-10000px';
    parent.appendChild(this.elDiv);

    this.elTextarea = document.createElement('textarea');
    this.elTextarea.className = 'copyPaste';
    this.elTextarea.onpaste = function(event) {
      var clipboardContents,
        temp;

      if ('WebkitAppearance' in document.documentElement.style) { // chrome and safari
        clipboardContents = event.clipboardData.getData("Text");

        // Safari adds an additional newline to copied text
        if (navigator.userAgent.indexOf('Safari') !== -1 && navigator.userAgent.indexOf('Chrome') === -1) {
          temp = clipboardContents.split('\n');

          if (temp[temp.length - 1] === '') {
            temp.pop();
          }
          clipboardContents = temp.join('\n');
        }
        this.value = clipboardContents;

        event.preventDefault();
      }
    };
    style = this.elTextarea.style;
    style.width = '10000px';
    style.height = '10000px';
    style.overflow = 'hidden';
    this.elDiv.appendChild(this.elTextarea);

    if (typeof style.opacity !== 'undefined') {
      style.opacity = 0;
    }
  }
  this.onKeyDownRef = this.onKeyDown.bind(this);
  document.documentElement.addEventListener('keydown', this.onKeyDownRef, false);
};

/**
 * Call method on every key down event
 *
 * @param {Event} event
 */
CopyPasteClass.prototype.onKeyDown = function(event) {
  var _this = this,
    isCtrlDown = false;

  function isActiveElementEditable() {
    var element = document.activeElement;

    if (element.shadowRoot && element.shadowRoot.activeElement) {
      element = element.shadowRoot.activeElement;
    }

    return ['INPUT', 'SELECT', 'TEXTAREA'].indexOf(element.nodeName) > -1 || element.contentEditable === 'true';
  }

  // mac
  if (event.metaKey) {
    isCtrlDown = true;
  }
  // pc
  else if (event.ctrlKey && navigator.userAgent.indexOf('Mac') === -1) {
    isCtrlDown = true;
  }
  if (isCtrlDown) {
    // this is needed by fragmentSelection in Handsontable. Ignore copypaste.js behavior if fragment of cell text is selected
    if (document.activeElement !== this.elTextarea && (this.getSelectionText() !== '' || isActiveElementEditable())) {
      return;
    }
    this.selectNodeText(this.elTextarea);
    setTimeout(function() {
      if (document.activeElement !== _this.elTextarea) {
        _this.selectNodeText(_this.elTextarea);
      }
    }, 0);
  }

  if (event.isImmediatePropagationEnabled !== false && isCtrlDown &&
      (event.keyCode === 67 ||
      event.keyCode === 86 ||
      event.keyCode === 88)) {
    // works in all browsers, incl. Opera < 12.12
    if (event.keyCode === 88) {
      setTimeout(function () {
        _this.triggerCut(event);
      }, 0);

    } else if (event.keyCode === 86) {
      setTimeout(function () {
        _this.triggerPaste(event);
      }, 0);
    }
  }
};

//http://jsperf.com/textara-selection
//http://stackoverflow.com/questions/1502385/how-can-i-make-this-code-work-in-ie
/**
 * Select all text contains in passed node element
 *
 * @param {Element} element
 */
CopyPasteClass.prototype.selectNodeText = function(element) {
  if (element) {
    element.select();
  }
};

//http://stackoverflow.com/questions/5379120/get-the-highlighted-selected-text
/**
 * Get selection text
 *
 * @returns {String}
 */
CopyPasteClass.prototype.getSelectionText = function() {
  var text = '';

  if (window.getSelection) {
    text = window.getSelection().toString();

  } else if (document.selection && document.selection.type !== 'Control') {
    text = document.selection.createRange().text;
  }

  return text;
};

/**
 * Make string copyable
 *
 * @param {String} string
 */
CopyPasteClass.prototype.copyable = function(string) {
  if (typeof string !== 'string' && string.toString === void 0) {
    throw new Error('copyable requires string parameter');
  }
  this.elTextarea.value = string;
  this.selectNodeText(this.elTextarea);
};

/*CopyPasteClass.prototype.onCopy = function (fn) {
  this.copyCallbacks.push(fn);
};*/

/**
 * Add function callback to onCut event
 *
 * @param {Function} callback
 */
CopyPasteClass.prototype.onCut = function(callback) {
  this.cutCallbacks.push(callback);
};

/**
 * Add function callback to onPaste event
 *
 * @param {Function} callback
 */
CopyPasteClass.prototype.onPaste = function(callback) {
  this.pasteCallbacks.push(callback);
};

/**
 * Remove callback from all events
 *
 * @param {Function} callback
 * @returns {Boolean}
 */
CopyPasteClass.prototype.removeCallback = function(callback) {
  var i, len;

  for (i = 0, len = this.copyCallbacks.length; i < len; i++) {
    if (this.copyCallbacks[i] === callback) {
      this.copyCallbacks.splice(i, 1);

      return true;
    }
  }
  for (i = 0, len = this.cutCallbacks.length; i < len; i++) {
    if (this.cutCallbacks[i] === callback) {
      this.cutCallbacks.splice(i, 1);

      return true;
    }
  }
  for (i = 0, len = this.pasteCallbacks.length; i < len; i++) {
    if (this.pasteCallbacks[i] === callback) {
      this.pasteCallbacks.splice(i, 1);

      return true;
    }
  }

  return false;
};

/**
 * Trigger cut event
 *
 * @param {DOMEvent} event
 */
CopyPasteClass.prototype.triggerCut = function(event) {
  var _this = this;

  if (_this.cutCallbacks) {
    setTimeout(function () {
      for (var i = 0, len = _this.cutCallbacks.length; i < len; i++) {
        _this.cutCallbacks[i](event);
      }
    }, 50);
  }
};

/**
 * Trigger paste event
 *
 * @param {DOMEvent} event
 * @param {String} string
 */
CopyPasteClass.prototype.triggerPaste = function(event, string) {
  var _this = this;

  if (_this.pasteCallbacks) {
    setTimeout(function () {
      var val = string || _this.elTextarea.value;

      for (var i = 0, len = _this.pasteCallbacks.length; i < len; i++) {
        _this.pasteCallbacks[i](val, event);
      }
    }, 50);
  }
};

/**
 * Destroy instance
 */
CopyPasteClass.prototype.destroy = function() {
  if (!this.hasBeenDestroyed() && --this.refCounter === 0) {
    if (this.elDiv && this.elDiv.parentNode) {
      this.elDiv.parentNode.removeChild(this.elDiv);
      this.elDiv = null;
      this.elTextarea = null;
    }
    document.documentElement.removeEventListener('keydown', this.onKeyDownRef);
    this.onKeyDownRef = null;
  }
};

/**
 * Check if instance has been destroyed
 *
 * @returns {Boolean}
 */
CopyPasteClass.prototype.hasBeenDestroyed = function() {
  return !this.refCounter;
};



},{}],"es6collections":[function(_dereq_,module,exports){
/*!
 * Copyright (C) 2011 by Andrea Giammarchi, @WebReflection
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
(function(exports) {
  'use strict';
  //shared pointer
  var i;
  //shortcuts
  var defineProperty = Object.defineProperty,
    is = function(a, b) {
      return isNaN(a) ? isNaN(b) : a === b;
    };


  //Polyfill global objects
  if (typeof WeakMap == 'undefined') {
    exports.WeakMap = createCollection({
      // WeakMap#delete(key:void*):boolean
      'delete': sharedDelete,
      // WeakMap#clear():
      clear: sharedClear,
      // WeakMap#get(key:void*):void*
      get: sharedGet,
      // WeakMap#has(key:void*):boolean
      has: mapHas,
      // WeakMap#set(key:void*, value:void*):void
      set: sharedSet
    }, true);
  }

  if (typeof Map == 'undefined') {
    exports.Map = createCollection({
      // WeakMap#delete(key:void*):boolean
      'delete': sharedDelete,
      //:was Map#get(key:void*[, d3fault:void*]):void*
      // Map#has(key:void*):boolean
      has: mapHas,
      // Map#get(key:void*):boolean
      get: sharedGet,
      // Map#set(key:void*, value:void*):void
      set: sharedSet,
      // Map#keys(void):Iterator
      keys: sharedKeys,
      // Map#values(void):Iterator
      values: sharedValues,
      // Map#entries(void):Iterator
      entries: mapEntries,
      // Map#forEach(callback:Function, context:void*):void ==> callback.call(context, key, value, mapObject) === not in specs`
      forEach: sharedForEach,
      // Map#clear():
      clear: sharedClear
    });
  }

  if (typeof Set == 'undefined') {
    exports.Set = createCollection({
      // Set#has(value:void*):boolean
      has: setHas,
      // Set#add(value:void*):boolean
      add: sharedAdd,
      // Set#delete(key:void*):boolean
      'delete': sharedDelete,
      // Set#clear():
      clear: sharedClear,
      // Set#keys(void):Iterator
      keys: sharedValues, // specs actually say "the same function object as the initial value of the values property"
      // Set#values(void):Iterator
      values: sharedValues,
      // Set#entries(void):Iterator
      entries: setEntries,
      // Set#forEach(callback:Function, context:void*):void ==> callback.call(context, value, index) === not in specs
      forEach: sharedForEach
    });
  }

  if (typeof WeakSet == 'undefined') {
    exports.WeakSet = createCollection({
      // WeakSet#delete(key:void*):boolean
      'delete': sharedDelete,
      // WeakSet#add(value:void*):boolean
      add: sharedAdd,
      // WeakSet#clear():
      clear: sharedClear,
      // WeakSet#has(value:void*):boolean
      has: setHas
    }, true);
  }


  /**
   * ES6 collection constructor
   * @return {Function} a collection class
   */
  function createCollection(proto, objectOnly) {
    function Collection(a) {
      if (!this || this.constructor !== Collection) return new Collection(a);
      this._keys = [];
      this._values = [];
      this._itp = []; // iteration pointers
      this.objectOnly = objectOnly;

      //parse initial iterable argument passed
      if (a) init.call(this, a);
    }

    //define size for non object-only collections
    if (!objectOnly) {
      defineProperty(proto, 'size', {
        get: sharedSize
      });
    }

    //set prototype
    proto.constructor = Collection;
    Collection.prototype = proto;

    return Collection;
  }


  /** parse initial iterable argument passed */
  function init(a) {
    var i;
    //init Set argument, like `[1,2,3,{}]`
    if (this.add) a.forEach(this.add, this);
    //init Map argument like `[[1,2], [{}, 4]]`
    else a.forEach(function(a) {
      this.set(a[0], a[1])
    }, this);
  }


  /** delete */
  function sharedDelete(key) {
    if (this.has(key)) {
      this._keys.splice(i, 1);
      this._values.splice(i, 1);
      // update iteration pointers
      this._itp.forEach(function(p) {
        if (i < p[0]) p[0]--;
      });
    }
    // Aurora here does it while Canary doesn't
    return -1 < i;
  };

  function sharedGet(key) {
    return this.has(key) ? this._values[i] : undefined;
  }

  function has(list, key) {
    if (this.objectOnly && key !== Object(key)) throw new TypeError("Invalid value used as weak collection key");
    //NaN or 0 passed
    if (key != key || key === 0) for (i = list.length; i-- && !is(list[i], key);) {} else i = list.indexOf(key);
    return -1 < i;
  }

  function setHas(value) {
    return has.call(this, this._values, value);
  }

  function mapHas(value) {
    return has.call(this, this._keys, value);
  }

  /** @chainable */
  function sharedSet(key, value) {
    this.has(key) ? this._values[i] = value : this._values[this._keys.push(key) - 1] = value;
    return this;
  }

  /** @chainable */
  function sharedAdd(value) {
    if (!this.has(value)) this._values.push(value);
    return this;
  }

  function sharedClear() {
    this._values.length = 0;
  }

  /** keys, values, and iterate related methods */
  function sharedKeys() {
    return sharedIterator(this._itp, this._keys);
  }

  function sharedValues() {
    return sharedIterator(this._itp, this._values);
  }

  function mapEntries() {
    return sharedIterator(this._itp, this._keys, this._values);
  }

  function setEntries() {
    return sharedIterator(this._itp, this._values, this._values);
  }

  function sharedIterator(itp, array, array2) {
    var p = [0],
      done = false;
    itp.push(p);
    return {
      next: function() {
        var v, k = p[0];
        if (!done && k < array.length) {
          v = array2 ? [array[k], array2[k]] : array[k];
          p[0]++;
        } else {
          done = true;
          itp.splice(itp.indexOf(p), 1);
        }
        return {
          done: done,
          value: v
        };
      }
    };
  }

  function sharedSize() {
    return this._values.length;
  }

  function sharedForEach(callback, context) {
    var it = this.entries();
    for (;;) {
      var r = it.next();
      if (r.done) break;
      callback.call(context, r.value[1], r.value[0], this);
    }
  }

})(typeof exports != 'undefined' && typeof global != 'undefined' ? global : window);

},{}],"jsonpatch":[function(_dereq_,module,exports){
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * json-patch-duplex.js version: 0.5.7
 * (c) 2013 Joachim Wester
 * MIT license
 */
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var OriginalError = Error;
var jsonpatch;
(function (jsonpatch) {
    var _objectKeys = function (obj) {
        if (_isArray(obj)) {
            var keys = new Array(obj.length);
            for (var k = 0; k < keys.length; k++) {
                keys[k] = "" + k;
            }
            return keys;
        }
        if (Object.keys) {
            return Object.keys(obj);
        }
        var keys = [];
        for (var i in obj) {
            if (obj.hasOwnProperty(i)) {
                keys.push(i);
            }
        }
        return keys;
    };
    function _equals(a, b) {
        switch (typeof a) {
            case 'undefined': //backward compatibility, but really I think we should return false
            case 'boolean':
            case 'string':
            case 'number':
                return a === b;
            case 'object':
                if (a === null)
                    return b === null;
                if (_isArray(a)) {
                    if (!_isArray(b) || a.length !== b.length)
                        return false;
                    for (var i = 0, l = a.length; i < l; i++)
                        if (!_equals(a[i], b[i]))
                            return false;
                    return true;
                }
                var bKeys = _objectKeys(b);
                var bLength = bKeys.length;
                if (_objectKeys(a).length !== bLength)
                    return false;
                for (var i = 0; i < bLength; i++)
                    if (!_equals(a[i], b[i]))
                        return false;
                return true;
            default:
                return false;
        }
    }
    /* We use a Javascript hash to store each
     function. Each hash entry (property) uses
     the operation identifiers specified in rfc6902.
     In this way, we can map each patch operation
     to its dedicated function in efficient way.
     */
    /* The operations applicable to an object */
    var objOps = {
        add: function (obj, key) {
            obj[key] = this.value;
            return true;
        },
        remove: function (obj, key) {
            delete obj[key];
            return true;
        },
        replace: function (obj, key) {
            obj[key] = this.value;
            return true;
        },
        move: function (obj, key, tree) {
            var temp = { op: "_get", path: this.from };
            apply(tree, [temp]);
            apply(tree, [
                { op: "remove", path: this.from }
            ]);
            apply(tree, [
                { op: "add", path: this.path, value: temp.value }
            ]);
            return true;
        },
        copy: function (obj, key, tree) {
            var temp = { op: "_get", path: this.from };
            apply(tree, [temp]);
            apply(tree, [
                { op: "add", path: this.path, value: temp.value }
            ]);
            return true;
        },
        test: function (obj, key) {
            return _equals(obj[key], this.value);
        },
        _get: function (obj, key) {
            this.value = obj[key];
        }
    };
    /* The operations applicable to an array. Many are the same as for the object */
    var arrOps = {
        add: function (arr, i) {
            arr.splice(i, 0, this.value);
            return true;
        },
        remove: function (arr, i) {
            arr.splice(i, 1);
            return true;
        },
        replace: function (arr, i) {
            arr[i] = this.value;
            return true;
        },
        move: objOps.move,
        copy: objOps.copy,
        test: objOps.test,
        _get: objOps._get
    };
    /* The operations applicable to object root. Many are the same as for the object */
    var rootOps = {
        add: function (obj) {
            rootOps.remove.call(this, obj);
            for (var key in this.value) {
                if (this.value.hasOwnProperty(key)) {
                    obj[key] = this.value[key];
                }
            }
            return true;
        },
        remove: function (obj) {
            for (var key in obj) {
                if (obj.hasOwnProperty(key)) {
                    objOps.remove.call(this, obj, key);
                }
            }
            return true;
        },
        replace: function (obj) {
            apply(obj, [
                { op: "remove", path: this.path }
            ]);
            apply(obj, [
                { op: "add", path: this.path, value: this.value }
            ]);
            return true;
        },
        move: objOps.move,
        copy: objOps.copy,
        test: function (obj) {
            return (JSON.stringify(obj) === JSON.stringify(this.value));
        },
        _get: function (obj) {
            this.value = obj;
        }
    };
    var observeOps = {
        add: function (patches, path) {
            var patch = {
                op: "add",
                path: path + escapePathComponent(this.name),
                value: this.object[this.name] };
            patches.push(patch);
        },
        'delete': function (patches, path) {
            var patch = {
                op: "remove",
                path: path + escapePathComponent(this.name)
            };
            patches.push(patch);
        },
        update: function (patches, path) {
            var patch = {
                op: "replace",
                path: path + escapePathComponent(this.name),
                value: this.object[this.name]
            };
            patches.push(patch);
        }
    };
    function escapePathComponent(str) {
        if (str.indexOf('/') === -1 && str.indexOf('~') === -1)
            return str;
        return str.replace(/~/g, '~0').replace(/\//g, '~1');
    }
    function _getPathRecursive(root, obj) {
        var found;
        for (var key in root) {
            if (root.hasOwnProperty(key)) {
                if (root[key] === obj) {
                    return escapePathComponent(key) + '/';
                }
                else if (typeof root[key] === 'object') {
                    found = _getPathRecursive(root[key], obj);
                    if (found != '') {
                        return escapePathComponent(key) + '/' + found;
                    }
                }
            }
        }
        return '';
    }
    function getPath(root, obj) {
        if (root === obj) {
            return '/';
        }
        var path = _getPathRecursive(root, obj);
        if (path === '') {
            throw new OriginalError("Object not found in root");
        }
        return '/' + path;
    }
    var beforeDict = [];
    var Mirror = (function () {
        function Mirror(obj) {
            this.observers = [];
            this.obj = obj;
        }
        return Mirror;
    })();
    var ObserverInfo = (function () {
        function ObserverInfo(callback, observer) {
            this.callback = callback;
            this.observer = observer;
        }
        return ObserverInfo;
    })();
    function getMirror(obj) {
        for (var i = 0, ilen = beforeDict.length; i < ilen; i++) {
            if (beforeDict[i].obj === obj) {
                return beforeDict[i];
            }
        }
    }
    function getObserverFromMirror(mirror, callback) {
        for (var j = 0, jlen = mirror.observers.length; j < jlen; j++) {
            if (mirror.observers[j].callback === callback) {
                return mirror.observers[j].observer;
            }
        }
    }
    function removeObserverFromMirror(mirror, observer) {
        for (var j = 0, jlen = mirror.observers.length; j < jlen; j++) {
            if (mirror.observers[j].observer === observer) {
                mirror.observers.splice(j, 1);
                return;
            }
        }
    }
    function unobserve(root, observer) {
        observer.unobserve();
    }
    jsonpatch.unobserve = unobserve;
    function deepClone(obj) {
        if (typeof obj === "object") {
            return JSON.parse(JSON.stringify(obj)); //Faster than ES5 clone - http://jsperf.com/deep-cloning-of-objects/5
        }
        else {
            return obj; //no need to clone primitives
        }
    }
    function observe(obj, callback) {
        var patches = [];
        var root = obj;
        var observer;
        var mirror = getMirror(obj);
        if (!mirror) {
            mirror = new Mirror(obj);
            beforeDict.push(mirror);
        }
        else {
            observer = getObserverFromMirror(mirror, callback);
        }
        if (observer) {
            return observer;
        }
        observer = {};
        mirror.value = deepClone(obj);
        if (callback) {
            observer.callback = callback;
            observer.next = null;
            var intervals = this.intervals || [100, 1000, 10000, 60000];
            if (intervals.push === void 0) {
                throw new OriginalError("jsonpatch.intervals must be an array");
            }
            var currentInterval = 0;
            var dirtyCheck = function () {
                generate(observer);
            };
            var fastCheck = function () {
                clearTimeout(observer.next);
                observer.next = setTimeout(function () {
                    dirtyCheck();
                    currentInterval = 0;
                    observer.next = setTimeout(slowCheck, intervals[currentInterval++]);
                }, 0);
            };
            var slowCheck = function () {
                dirtyCheck();
                if (currentInterval == intervals.length)
                    currentInterval = intervals.length - 1;
                observer.next = setTimeout(slowCheck, intervals[currentInterval++]);
            };
            if (typeof window !== 'undefined') {
                if (window.addEventListener) {
                    window.addEventListener('mousedown', fastCheck);
                    window.addEventListener('mouseup', fastCheck);
                    window.addEventListener('keydown', fastCheck);
                }
                else {
                    document.documentElement.attachEvent('onmousedown', fastCheck);
                    document.documentElement.attachEvent('onmouseup', fastCheck);
                    document.documentElement.attachEvent('onkeydown', fastCheck);
                }
            }
            observer.next = setTimeout(slowCheck, intervals[currentInterval++]);
        }
        observer.patches = patches;
        observer.object = obj;
        observer.unobserve = function () {
            generate(observer);
            clearTimeout(observer.next);
            removeObserverFromMirror(mirror, observer);
            if (typeof window !== 'undefined') {
                if (window.removeEventListener) {
                    window.removeEventListener('mousedown', fastCheck);
                    window.removeEventListener('mouseup', fastCheck);
                    window.removeEventListener('keydown', fastCheck);
                }
                else {
                    document.documentElement.detachEvent('onmousedown', fastCheck);
                    document.documentElement.detachEvent('onmouseup', fastCheck);
                    document.documentElement.detachEvent('onkeydown', fastCheck);
                }
            }
        };
        mirror.observers.push(new ObserverInfo(callback, observer));
        return observer;
    }
    jsonpatch.observe = observe;
    function generate(observer) {
        var mirror;
        for (var i = 0, ilen = beforeDict.length; i < ilen; i++) {
            if (beforeDict[i].obj === observer.object) {
                mirror = beforeDict[i];
                break;
            }
        }
        _generate(mirror.value, observer.object, observer.patches, "");
        if (observer.patches.length) {
            apply(mirror.value, observer.patches);
        }
        var temp = observer.patches;
        if (temp.length > 0) {
            observer.patches = [];
            if (observer.callback) {
                observer.callback(temp);
            }
        }
        return temp;
    }
    jsonpatch.generate = generate;
    // Dirty check if obj is different from mirror, generate patches and update mirror
    function _generate(mirror, obj, patches, path) {
        var newKeys = _objectKeys(obj);
        var oldKeys = _objectKeys(mirror);
        var changed = false;
        var deleted = false;
        //if ever "move" operation is implemented here, make sure this test runs OK: "should not generate the same patch twice (move)"
        for (var t = oldKeys.length - 1; t >= 0; t--) {
            var key = oldKeys[t];
            var oldVal = mirror[key];
            if (obj.hasOwnProperty(key)) {
                var newVal = obj[key];
                if (typeof oldVal == "object" && oldVal != null && typeof newVal == "object" && newVal != null) {
                    _generate(oldVal, newVal, patches, path + "/" + escapePathComponent(key));
                }
                else {
                    if (oldVal != newVal) {
                        changed = true;
                        patches.push({ op: "replace", path: path + "/" + escapePathComponent(key), value: deepClone(newVal) });
                    }
                }
            }
            else {
                patches.push({ op: "remove", path: path + "/" + escapePathComponent(key) });
                deleted = true; // property has been deleted
            }
        }
        if (!deleted && newKeys.length == oldKeys.length) {
            return;
        }
        for (var t = 0; t < newKeys.length; t++) {
            var key = newKeys[t];
            if (!mirror.hasOwnProperty(key)) {
                patches.push({ op: "add", path: path + "/" + escapePathComponent(key), value: deepClone(obj[key]) });
            }
        }
    }
    var _isArray;
    if (Array.isArray) {
        _isArray = Array.isArray;
    }
    else {
        _isArray = function (obj) {
            return obj.push && typeof obj.length === 'number';
        };
    }
    //3x faster than cached /^\d+$/.test(str)
    function isInteger(str) {
        var i = 0;
        var len = str.length;
        var charCode;
        while (i < len) {
            charCode = str.charCodeAt(i);
            if (charCode >= 48 && charCode <= 57) {
                i++;
                continue;
            }
            return false;
        }
        return true;
    }
    /// Apply a json-patch operation on an object tree
    function apply(tree, patches, validate) {
        var result = false, p = 0, plen = patches.length, patch, key;
        while (p < plen) {
            patch = patches[p];
            p++;
            // Find the object
            var path = patch.path || "";
            var keys = path.split('/');
            var obj = tree;
            var t = 1; //skip empty element - http://jsperf.com/to-shift-or-not-to-shift
            var len = keys.length;
            var existingPathFragment = undefined;
            while (true) {
                key = keys[t];
                if (validate) {
                    if (existingPathFragment === undefined) {
                        if (obj[key] === undefined) {
                            existingPathFragment = keys.slice(0, t).join('/');
                        }
                        else if (t == len - 1) {
                            existingPathFragment = patch.path;
                        }
                        if (existingPathFragment !== undefined) {
                            this.validator(patch, p - 1, tree, existingPathFragment);
                        }
                    }
                }
                t++;
                if (key === undefined) {
                    if (t >= len) {
                        result = rootOps[patch.op].call(patch, obj, key, tree); // Apply patch
                        break;
                    }
                }
                if (_isArray(obj)) {
                    if (key === '-') {
                        key = obj.length;
                    }
                    else {
                        if (validate && !isInteger(key)) {
                            throw new JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index", "OPERATION_PATH_ILLEGAL_ARRAY_INDEX", p - 1, patch.path, patch);
                        }
                        key = parseInt(key, 10);
                    }
                    if (t >= len) {
                        if (validate && patch.op === "add" && key > obj.length) {
                            throw new JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array", "OPERATION_VALUE_OUT_OF_BOUNDS", p - 1, patch.path, patch);
                        }
                        result = arrOps[patch.op].call(patch, obj, key, tree); // Apply patch
                        break;
                    }
                }
                else {
                    if (key && key.indexOf('~') != -1)
                        key = key.replace(/~1/g, '/').replace(/~0/g, '~'); // escape chars
                    if (t >= len) {
                        result = objOps[patch.op].call(patch, obj, key, tree); // Apply patch
                        break;
                    }
                }
                obj = obj[key];
            }
        }
        return result;
    }
    jsonpatch.apply = apply;
    function compare(tree1, tree2) {
        var patches = [];
        _generate(tree1, tree2, patches, '');
        return patches;
    }
    jsonpatch.compare = compare;
    var JsonPatchError = (function (_super) {
        __extends(JsonPatchError, _super);
        function JsonPatchError(message, name, index, operation, tree) {
            _super.call(this, message);
            this.message = message;
            this.name = name;
            this.index = index;
            this.operation = operation;
            this.tree = tree;
        }
        return JsonPatchError;
    })(OriginalError);
    jsonpatch.JsonPatchError = JsonPatchError;
    jsonpatch.Error = JsonPatchError;
    /**
     * Recursively checks whether an object has any undefined values inside.
     */
    function hasUndefined(obj) {
        if (obj === undefined) {
            return true;
        }
        if (typeof obj == "array" || typeof obj == "object") {
            for (var i in obj) {
                if (hasUndefined(obj[i])) {
                    return true;
                }
            }
        }
        return false;
    }
    /**
     * Validates a single operation. Called from `jsonpatch.validate`. Throws `JsonPatchError` in case of an error.
     * @param {object} operation - operation object (patch)
     * @param {number} index - index of operation in the sequence
     * @param {object} [tree] - object where the operation is supposed to be applied
     * @param {string} [existingPathFragment] - comes along with `tree`
     */
    function validator(operation, index, tree, existingPathFragment) {
        if (typeof operation !== 'object' || operation === null || _isArray(operation)) {
            throw new JsonPatchError('Operation is not an object', 'OPERATION_NOT_AN_OBJECT', index, operation, tree);
        }
        else if (!objOps[operation.op]) {
            throw new JsonPatchError('Operation `op` property is not one of operations defined in RFC-6902', 'OPERATION_OP_INVALID', index, operation, tree);
        }
        else if (typeof operation.path !== 'string') {
            throw new JsonPatchError('Operation `path` property is not a string', 'OPERATION_PATH_INVALID', index, operation, tree);
        }
        else if ((operation.op === 'move' || operation.op === 'copy') && typeof operation.from !== 'string') {
            throw new JsonPatchError('Operation `from` property is not present (applicable in `move` and `copy` operations)', 'OPERATION_FROM_REQUIRED', index, operation, tree);
        }
        else if ((operation.op === 'add' || operation.op === 'replace' || operation.op === 'test') && operation.value === undefined) {
            throw new JsonPatchError('Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)', 'OPERATION_VALUE_REQUIRED', index, operation, tree);
        }
        else if ((operation.op === 'add' || operation.op === 'replace' || operation.op === 'test') && hasUndefined(operation.value)) {
            throw new JsonPatchError('Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)', 'OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED', index, operation, tree);
        }
        else if (tree) {
            if (operation.op == "add") {
                var pathLen = operation.path.split("/").length;
                var existingPathLen = existingPathFragment.split("/").length;
                if (pathLen !== existingPathLen + 1 && pathLen !== existingPathLen) {
                    throw new JsonPatchError('Cannot perform an `add` operation at the desired path', 'OPERATION_PATH_CANNOT_ADD', index, operation, tree);
                }
            }
            else if (operation.op === 'replace' || operation.op === 'remove' || operation.op === '_get') {
                if (operation.path !== existingPathFragment) {
                    throw new JsonPatchError('Cannot perform the operation at a path that does not exist', 'OPERATION_PATH_UNRESOLVABLE', index, operation, tree);
                }
            }
            else if (operation.op === 'move' || operation.op === 'copy') {
                var existingValue = { op: "_get", path: operation.from, value: undefined };
                var error = jsonpatch.validate([existingValue], tree);
                if (error && error.name === 'OPERATION_PATH_UNRESOLVABLE') {
                    throw new JsonPatchError('Cannot perform the operation from a path that does not exist', 'OPERATION_FROM_UNRESOLVABLE', index, operation, tree);
                }
            }
        }
    }
    jsonpatch.validator = validator;
    /**
     * Validates a sequence of operations. If `tree` parameter is provided, the sequence is additionally validated against the object tree.
     * If error is encountered, returns a JsonPatchError object
     * @param sequence
     * @param tree
     * @returns {JsonPatchError|undefined}
     */
    function validate(sequence, tree) {
        try {
            if (!_isArray(sequence)) {
                throw new JsonPatchError('Patch sequence must be an array', 'SEQUENCE_NOT_AN_ARRAY');
            }
            if (tree) {
                tree = JSON.parse(JSON.stringify(tree)); //clone tree so that we can safely try applying operations
                apply.call(this, tree, sequence, true);
            }
            else {
                for (var i = 0; i < sequence.length; i++) {
                    this.validator(sequence[i], i);
                }
            }
        }
        catch (e) {
            if (e instanceof JsonPatchError) {
                return e;
            }
            else {
                throw e;
            }
        }
    }
    jsonpatch.validate = validate;
})(jsonpatch || (jsonpatch = {}));
if (typeof exports !== "undefined") {
    exports.apply = jsonpatch.apply;
    exports.observe = jsonpatch.observe;
    exports.unobserve = jsonpatch.unobserve;
    exports.generate = jsonpatch.generate;
    exports.compare = jsonpatch.compare;
    exports.validate = jsonpatch.validate;
    exports.validator = jsonpatch.validator;
    exports.JsonPatchError = jsonpatch.JsonPatchError;
    exports.Error = jsonpatch.Error;
}

},{}],"moment":[function(_dereq_,module,exports){
//! moment.js
//! version : 2.18.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

;(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
    typeof define === 'function' && define.amd ? define(factory) :
    global.moment = factory()
}(this, (function () { 'use strict';

var hookCallback;

function hooks () {
    return hookCallback.apply(null, arguments);
}

// This is done to register the method called with moment()
// without creating circular dependencies.
function setHookCallback (callback) {
    hookCallback = callback;
}

function isArray(input) {
    return input instanceof Array || Object.prototype.toString.call(input) === '[object Array]';
}

function isObject(input) {
    // IE8 will treat undefined and null as object if it wasn't for
    // input != null
    return input != null && Object.prototype.toString.call(input) === '[object Object]';
}

function isObjectEmpty(obj) {
    var k;
    for (k in obj) {
        // even if its not own property I'd still call it non-empty
        return false;
    }
    return true;
}

function isUndefined(input) {
    return input === void 0;
}

function isNumber(input) {
    return typeof input === 'number' || Object.prototype.toString.call(input) === '[object Number]';
}

function isDate(input) {
    return input instanceof Date || Object.prototype.toString.call(input) === '[object Date]';
}

function map(arr, fn) {
    var res = [], i;
    for (i = 0; i < arr.length; ++i) {
        res.push(fn(arr[i], i));
    }
    return res;
}

function hasOwnProp(a, b) {
    return Object.prototype.hasOwnProperty.call(a, b);
}

function extend(a, b) {
    for (var i in b) {
        if (hasOwnProp(b, i)) {
            a[i] = b[i];
        }
    }

    if (hasOwnProp(b, 'toString')) {
        a.toString = b.toString;
    }

    if (hasOwnProp(b, 'valueOf')) {
        a.valueOf = b.valueOf;
    }

    return a;
}

function createUTC (input, format, locale, strict) {
    return createLocalOrUTC(input, format, locale, strict, true).utc();
}

function defaultParsingFlags() {
    // We need to deep clone this object.
    return {
        empty           : false,
        unusedTokens    : [],
        unusedInput     : [],
        overflow        : -2,
        charsLeftOver   : 0,
        nullInput       : false,
        invalidMonth    : null,
        invalidFormat   : false,
        userInvalidated : false,
        iso             : false,
        parsedDateParts : [],
        meridiem        : null,
        rfc2822         : false,
        weekdayMismatch : false
    };
}

function getParsingFlags(m) {
    if (m._pf == null) {
        m._pf = defaultParsingFlags();
    }
    return m._pf;
}

var some;
if (Array.prototype.some) {
    some = Array.prototype.some;
} else {
    some = function (fun) {
        var t = Object(this);
        var len = t.length >>> 0;

        for (var i = 0; i < len; i++) {
            if (i in t && fun.call(this, t[i], i, t)) {
                return true;
            }
        }

        return false;
    };
}

var some$1 = some;

function isValid(m) {
    if (m._isValid == null) {
        var flags = getParsingFlags(m);
        var parsedParts = some$1.call(flags.parsedDateParts, function (i) {
            return i != null;
        });
        var isNowValid = !isNaN(m._d.getTime()) &&
            flags.overflow < 0 &&
            !flags.empty &&
            !flags.invalidMonth &&
            !flags.invalidWeekday &&
            !flags.nullInput &&
            !flags.invalidFormat &&
            !flags.userInvalidated &&
            (!flags.meridiem || (flags.meridiem && parsedParts));

        if (m._strict) {
            isNowValid = isNowValid &&
                flags.charsLeftOver === 0 &&
                flags.unusedTokens.length === 0 &&
                flags.bigHour === undefined;
        }

        if (Object.isFrozen == null || !Object.isFrozen(m)) {
            m._isValid = isNowValid;
        }
        else {
            return isNowValid;
        }
    }
    return m._isValid;
}

function createInvalid (flags) {
    var m = createUTC(NaN);
    if (flags != null) {
        extend(getParsingFlags(m), flags);
    }
    else {
        getParsingFlags(m).userInvalidated = true;
    }

    return m;
}

// Plugins that add properties should also add the key here (null value),
// so we can properly clone ourselves.
var momentProperties = hooks.momentProperties = [];

function copyConfig(to, from) {
    var i, prop, val;

    if (!isUndefined(from._isAMomentObject)) {
        to._isAMomentObject = from._isAMomentObject;
    }
    if (!isUndefined(from._i)) {
        to._i = from._i;
    }
    if (!isUndefined(from._f)) {
        to._f = from._f;
    }
    if (!isUndefined(from._l)) {
        to._l = from._l;
    }
    if (!isUndefined(from._strict)) {
        to._strict = from._strict;
    }
    if (!isUndefined(from._tzm)) {
        to._tzm = from._tzm;
    }
    if (!isUndefined(from._isUTC)) {
        to._isUTC = from._isUTC;
    }
    if (!isUndefined(from._offset)) {
        to._offset = from._offset;
    }
    if (!isUndefined(from._pf)) {
        to._pf = getParsingFlags(from);
    }
    if (!isUndefined(from._locale)) {
        to._locale = from._locale;
    }

    if (momentProperties.length > 0) {
        for (i = 0; i < momentProperties.length; i++) {
            prop = momentProperties[i];
            val = from[prop];
            if (!isUndefined(val)) {
                to[prop] = val;
            }
        }
    }

    return to;
}

var updateInProgress = false;

// Moment prototype object
function Moment(config) {
    copyConfig(this, config);
    this._d = new Date(config._d != null ? config._d.getTime() : NaN);
    if (!this.isValid()) {
        this._d = new Date(NaN);
    }
    // Prevent infinite loop in case updateOffset creates new moment
    // objects.
    if (updateInProgress === false) {
        updateInProgress = true;
        hooks.updateOffset(this);
        updateInProgress = false;
    }
}

function isMoment (obj) {
    return obj instanceof Moment || (obj != null && obj._isAMomentObject != null);
}

function absFloor (number) {
    if (number < 0) {
        // -0 -> 0
        return Math.ceil(number) || 0;
    } else {
        return Math.floor(number);
    }
}

function toInt(argumentForCoercion) {
    var coercedNumber = +argumentForCoercion,
        value = 0;

    if (coercedNumber !== 0 && isFinite(coercedNumber)) {
        value = absFloor(coercedNumber);
    }

    return value;
}

// compare two arrays, return the number of differences
function compareArrays(array1, array2, dontConvert) {
    var len = Math.min(array1.length, array2.length),
        lengthDiff = Math.abs(array1.length - array2.length),
        diffs = 0,
        i;
    for (i = 0; i < len; i++) {
        if ((dontConvert && array1[i] !== array2[i]) ||
            (!dontConvert && toInt(array1[i]) !== toInt(array2[i]))) {
            diffs++;
        }
    }
    return diffs + lengthDiff;
}

function warn(msg) {
    if (hooks.suppressDeprecationWarnings === false &&
            (typeof console !==  'undefined') && console.warn) {
        console.warn('Deprecation warning: ' + msg);
    }
}

function deprecate(msg, fn) {
    var firstTime = true;

    return extend(function () {
        if (hooks.deprecationHandler != null) {
            hooks.deprecationHandler(null, msg);
        }
        if (firstTime) {
            var args = [];
            var arg;
            for (var i = 0; i < arguments.length; i++) {
                arg = '';
                if (typeof arguments[i] === 'object') {
                    arg += '\n[' + i + '] ';
                    for (var key in arguments[0]) {
                        arg += key + ': ' + arguments[0][key] + ', ';
                    }
                    arg = arg.slice(0, -2); // Remove trailing comma and space
                } else {
                    arg = arguments[i];
                }
                args.push(arg);
            }
            warn(msg + '\nArguments: ' + Array.prototype.slice.call(args).join('') + '\n' + (new Error()).stack);
            firstTime = false;
        }
        return fn.apply(this, arguments);
    }, fn);
}

var deprecations = {};

function deprecateSimple(name, msg) {
    if (hooks.deprecationHandler != null) {
        hooks.deprecationHandler(name, msg);
    }
    if (!deprecations[name]) {
        warn(msg);
        deprecations[name] = true;
    }
}

hooks.suppressDeprecationWarnings = false;
hooks.deprecationHandler = null;

function isFunction(input) {
    return input instanceof Function || Object.prototype.toString.call(input) === '[object Function]';
}

function set (config) {
    var prop, i;
    for (i in config) {
        prop = config[i];
        if (isFunction(prop)) {
            this[i] = prop;
        } else {
            this['_' + i] = prop;
        }
    }
    this._config = config;
    // Lenient ordinal parsing accepts just a number in addition to
    // number + (possibly) stuff coming from _dayOfMonthOrdinalParse.
    // TODO: Remove "ordinalParse" fallback in next major release.
    this._dayOfMonthOrdinalParseLenient = new RegExp(
        (this._dayOfMonthOrdinalParse.source || this._ordinalParse.source) +
            '|' + (/\d{1,2}/).source);
}

function mergeConfigs(parentConfig, childConfig) {
    var res = extend({}, parentConfig), prop;
    for (prop in childConfig) {
        if (hasOwnProp(childConfig, prop)) {
            if (isObject(parentConfig[prop]) && isObject(childConfig[prop])) {
                res[prop] = {};
                extend(res[prop], parentConfig[prop]);
                extend(res[prop], childConfig[prop]);
            } else if (childConfig[prop] != null) {
                res[prop] = childConfig[prop];
            } else {
                delete res[prop];
            }
        }
    }
    for (prop in parentConfig) {
        if (hasOwnProp(parentConfig, prop) &&
                !hasOwnProp(childConfig, prop) &&
                isObject(parentConfig[prop])) {
            // make sure changes to properties don't modify parent config
            res[prop] = extend({}, res[prop]);
        }
    }
    return res;
}

function Locale(config) {
    if (config != null) {
        this.set(config);
    }
}

var keys;

if (Object.keys) {
    keys = Object.keys;
} else {
    keys = function (obj) {
        var i, res = [];
        for (i in obj) {
            if (hasOwnProp(obj, i)) {
                res.push(i);
            }
        }
        return res;
    };
}

var keys$1 = keys;

var defaultCalendar = {
    sameDay : '[Today at] LT',
    nextDay : '[Tomorrow at] LT',
    nextWeek : 'dddd [at] LT',
    lastDay : '[Yesterday at] LT',
    lastWeek : '[Last] dddd [at] LT',
    sameElse : 'L'
};

function calendar (key, mom, now) {
    var output = this._calendar[key] || this._calendar['sameElse'];
    return isFunction(output) ? output.call(mom, now) : output;
}

var defaultLongDateFormat = {
    LTS  : 'h:mm:ss A',
    LT   : 'h:mm A',
    L    : 'MM/DD/YYYY',
    LL   : 'MMMM D, YYYY',
    LLL  : 'MMMM D, YYYY h:mm A',
    LLLL : 'dddd, MMMM D, YYYY h:mm A'
};

function longDateFormat (key) {
    var format = this._longDateFormat[key],
        formatUpper = this._longDateFormat[key.toUpperCase()];

    if (format || !formatUpper) {
        return format;
    }

    this._longDateFormat[key] = formatUpper.replace(/MMMM|MM|DD|dddd/g, function (val) {
        return val.slice(1);
    });

    return this._longDateFormat[key];
}

var defaultInvalidDate = 'Invalid date';

function invalidDate () {
    return this._invalidDate;
}

var defaultOrdinal = '%d';
var defaultDayOfMonthOrdinalParse = /\d{1,2}/;

function ordinal (number) {
    return this._ordinal.replace('%d', number);
}

var defaultRelativeTime = {
    future : 'in %s',
    past   : '%s ago',
    s  : 'a few seconds',
    ss : '%d seconds',
    m  : 'a minute',
    mm : '%d minutes',
    h  : 'an hour',
    hh : '%d hours',
    d  : 'a day',
    dd : '%d days',
    M  : 'a month',
    MM : '%d months',
    y  : 'a year',
    yy : '%d years'
};

function relativeTime (number, withoutSuffix, string, isFuture) {
    var output = this._relativeTime[string];
    return (isFunction(output)) ?
        output(number, withoutSuffix, string, isFuture) :
        output.replace(/%d/i, number);
}

function pastFuture (diff, output) {
    var format = this._relativeTime[diff > 0 ? 'future' : 'past'];
    return isFunction(format) ? format(output) : format.replace(/%s/i, output);
}

var aliases = {};

function addUnitAlias (unit, shorthand) {
    var lowerCase = unit.toLowerCase();
    aliases[lowerCase] = aliases[lowerCase + 's'] = aliases[shorthand] = unit;
}

function normalizeUnits(units) {
    return typeof units === 'string' ? aliases[units] || aliases[units.toLowerCase()] : undefined;
}

function normalizeObjectUnits(inputObject) {
    var normalizedInput = {},
        normalizedProp,
        prop;

    for (prop in inputObject) {
        if (hasOwnProp(inputObject, prop)) {
            normalizedProp = normalizeUnits(prop);
            if (normalizedProp) {
                normalizedInput[normalizedProp] = inputObject[prop];
            }
        }
    }

    return normalizedInput;
}

var priorities = {};

function addUnitPriority(unit, priority) {
    priorities[unit] = priority;
}

function getPrioritizedUnits(unitsObj) {
    var units = [];
    for (var u in unitsObj) {
        units.push({unit: u, priority: priorities[u]});
    }
    units.sort(function (a, b) {
        return a.priority - b.priority;
    });
    return units;
}

function makeGetSet (unit, keepTime) {
    return function (value) {
        if (value != null) {
            set$1(this, unit, value);
            hooks.updateOffset(this, keepTime);
            return this;
        } else {
            return get(this, unit);
        }
    };
}

function get (mom, unit) {
    return mom.isValid() ?
        mom._d['get' + (mom._isUTC ? 'UTC' : '') + unit]() : NaN;
}

function set$1 (mom, unit, value) {
    if (mom.isValid()) {
        mom._d['set' + (mom._isUTC ? 'UTC' : '') + unit](value);
    }
}

// MOMENTS

function stringGet (units) {
    units = normalizeUnits(units);
    if (isFunction(this[units])) {
        return this[units]();
    }
    return this;
}


function stringSet (units, value) {
    if (typeof units === 'object') {
        units = normalizeObjectUnits(units);
        var prioritized = getPrioritizedUnits(units);
        for (var i = 0; i < prioritized.length; i++) {
            this[prioritized[i].unit](units[prioritized[i].unit]);
        }
    } else {
        units = normalizeUnits(units);
        if (isFunction(this[units])) {
            return this[units](value);
        }
    }
    return this;
}

function zeroFill(number, targetLength, forceSign) {
    var absNumber = '' + Math.abs(number),
        zerosToFill = targetLength - absNumber.length,
        sign = number >= 0;
    return (sign ? (forceSign ? '+' : '') : '-') +
        Math.pow(10, Math.max(0, zerosToFill)).toString().substr(1) + absNumber;
}

var formattingTokens = /(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;

var localFormattingTokens = /(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g;

var formatFunctions = {};

var formatTokenFunctions = {};

// token:    'M'
// padded:   ['MM', 2]
// ordinal:  'Mo'
// callback: function () { this.month() + 1 }
function addFormatToken (token, padded, ordinal, callback) {
    var func = callback;
    if (typeof callback === 'string') {
        func = function () {
            return this[callback]();
        };
    }
    if (token) {
        formatTokenFunctions[token] = func;
    }
    if (padded) {
        formatTokenFunctions[padded[0]] = function () {
            return zeroFill(func.apply(this, arguments), padded[1], padded[2]);
        };
    }
    if (ordinal) {
        formatTokenFunctions[ordinal] = function () {
            return this.localeData().ordinal(func.apply(this, arguments), token);
        };
    }
}

function removeFormattingTokens(input) {
    if (input.match(/\[[\s\S]/)) {
        return input.replace(/^\[|\]$/g, '');
    }
    return input.replace(/\\/g, '');
}

function makeFormatFunction(format) {
    var array = format.match(formattingTokens), i, length;

    for (i = 0, length = array.length; i < length; i++) {
        if (formatTokenFunctions[array[i]]) {
            array[i] = formatTokenFunctions[array[i]];
        } else {
            array[i] = removeFormattingTokens(array[i]);
        }
    }

    return function (mom) {
        var output = '', i;
        for (i = 0; i < length; i++) {
            output += isFunction(array[i]) ? array[i].call(mom, format) : array[i];
        }
        return output;
    };
}

// format date using native date object
function formatMoment(m, format) {
    if (!m.isValid()) {
        return m.localeData().invalidDate();
    }

    format = expandFormat(format, m.localeData());
    formatFunctions[format] = formatFunctions[format] || makeFormatFunction(format);

    return formatFunctions[format](m);
}

function expandFormat(format, locale) {
    var i = 5;

    function replaceLongDateFormatTokens(input) {
        return locale.longDateFormat(input) || input;
    }

    localFormattingTokens.lastIndex = 0;
    while (i >= 0 && localFormattingTokens.test(format)) {
        format = format.replace(localFormattingTokens, replaceLongDateFormatTokens);
        localFormattingTokens.lastIndex = 0;
        i -= 1;
    }

    return format;
}

var match1         = /\d/;            //       0 - 9
var match2         = /\d\d/;          //      00 - 99
var match3         = /\d{3}/;         //     000 - 999
var match4         = /\d{4}/;         //    0000 - 9999
var match6         = /[+-]?\d{6}/;    // -999999 - 999999
var match1to2      = /\d\d?/;         //       0 - 99
var match3to4      = /\d\d\d\d?/;     //     999 - 9999
var match5to6      = /\d\d\d\d\d\d?/; //   99999 - 999999
var match1to3      = /\d{1,3}/;       //       0 - 999
var match1to4      = /\d{1,4}/;       //       0 - 9999
var match1to6      = /[+-]?\d{1,6}/;  // -999999 - 999999

var matchUnsigned  = /\d+/;           //       0 - inf
var matchSigned    = /[+-]?\d+/;      //    -inf - inf

var matchOffset    = /Z|[+-]\d\d:?\d\d/gi; // +00:00 -00:00 +0000 -0000 or Z
var matchShortOffset = /Z|[+-]\d\d(?::?\d\d)?/gi; // +00 -00 +00:00 -00:00 +0000 -0000 or Z

var matchTimestamp = /[+-]?\d+(\.\d{1,3})?/; // 123456789 123456789.123

// any word (or two) characters or numbers including two/three word month in arabic.
// includes scottish gaelic two word and hyphenated months
var matchWord = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i;


var regexes = {};

function addRegexToken (token, regex, strictRegex) {
    regexes[token] = isFunction(regex) ? regex : function (isStrict, localeData) {
        return (isStrict && strictRegex) ? strictRegex : regex;
    };
}

function getParseRegexForToken (token, config) {
    if (!hasOwnProp(regexes, token)) {
        return new RegExp(unescapeFormat(token));
    }

    return regexes[token](config._strict, config._locale);
}

// Code from http://stackoverflow.com/questions/3561493/is-there-a-regexp-escape-function-in-javascript
function unescapeFormat(s) {
    return regexEscape(s.replace('\\', '').replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g, function (matched, p1, p2, p3, p4) {
        return p1 || p2 || p3 || p4;
    }));
}

function regexEscape(s) {
    return s.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
}

var tokens = {};

function addParseToken (token, callback) {
    var i, func = callback;
    if (typeof token === 'string') {
        token = [token];
    }
    if (isNumber(callback)) {
        func = function (input, array) {
            array[callback] = toInt(input);
        };
    }
    for (i = 0; i < token.length; i++) {
        tokens[token[i]] = func;
    }
}

function addWeekParseToken (token, callback) {
    addParseToken(token, function (input, array, config, token) {
        config._w = config._w || {};
        callback(input, config._w, config, token);
    });
}

function addTimeToArrayFromToken(token, input, config) {
    if (input != null && hasOwnProp(tokens, token)) {
        tokens[token](input, config._a, config, token);
    }
}

var YEAR = 0;
var MONTH = 1;
var DATE = 2;
var HOUR = 3;
var MINUTE = 4;
var SECOND = 5;
var MILLISECOND = 6;
var WEEK = 7;
var WEEKDAY = 8;

var indexOf;

if (Array.prototype.indexOf) {
    indexOf = Array.prototype.indexOf;
} else {
    indexOf = function (o) {
        // I know
        var i;
        for (i = 0; i < this.length; ++i) {
            if (this[i] === o) {
                return i;
            }
        }
        return -1;
    };
}

var indexOf$1 = indexOf;

function daysInMonth(year, month) {
    return new Date(Date.UTC(year, month + 1, 0)).getUTCDate();
}

// FORMATTING

addFormatToken('M', ['MM', 2], 'Mo', function () {
    return this.month() + 1;
});

addFormatToken('MMM', 0, 0, function (format) {
    return this.localeData().monthsShort(this, format);
});

addFormatToken('MMMM', 0, 0, function (format) {
    return this.localeData().months(this, format);
});

// ALIASES

addUnitAlias('month', 'M');

// PRIORITY

addUnitPriority('month', 8);

// PARSING

addRegexToken('M',    match1to2);
addRegexToken('MM',   match1to2, match2);
addRegexToken('MMM',  function (isStrict, locale) {
    return locale.monthsShortRegex(isStrict);
});
addRegexToken('MMMM', function (isStrict, locale) {
    return locale.monthsRegex(isStrict);
});

addParseToken(['M', 'MM'], function (input, array) {
    array[MONTH] = toInt(input) - 1;
});

addParseToken(['MMM', 'MMMM'], function (input, array, config, token) {
    var month = config._locale.monthsParse(input, token, config._strict);
    // if we didn't find a month name, mark the date as invalid.
    if (month != null) {
        array[MONTH] = month;
    } else {
        getParsingFlags(config).invalidMonth = input;
    }
});

// LOCALES

var MONTHS_IN_FORMAT = /D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;
var defaultLocaleMonths = 'January_February_March_April_May_June_July_August_September_October_November_December'.split('_');
function localeMonths (m, format) {
    if (!m) {
        return isArray(this._months) ? this._months :
            this._months['standalone'];
    }
    return isArray(this._months) ? this._months[m.month()] :
        this._months[(this._months.isFormat || MONTHS_IN_FORMAT).test(format) ? 'format' : 'standalone'][m.month()];
}

var defaultLocaleMonthsShort = 'Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec'.split('_');
function localeMonthsShort (m, format) {
    if (!m) {
        return isArray(this._monthsShort) ? this._monthsShort :
            this._monthsShort['standalone'];
    }
    return isArray(this._monthsShort) ? this._monthsShort[m.month()] :
        this._monthsShort[MONTHS_IN_FORMAT.test(format) ? 'format' : 'standalone'][m.month()];
}

function handleStrictParse(monthName, format, strict) {
    var i, ii, mom, llc = monthName.toLocaleLowerCase();
    if (!this._monthsParse) {
        // this is not used
        this._monthsParse = [];
        this._longMonthsParse = [];
        this._shortMonthsParse = [];
        for (i = 0; i < 12; ++i) {
            mom = createUTC([2000, i]);
            this._shortMonthsParse[i] = this.monthsShort(mom, '').toLocaleLowerCase();
            this._longMonthsParse[i] = this.months(mom, '').toLocaleLowerCase();
        }
    }

    if (strict) {
        if (format === 'MMM') {
            ii = indexOf$1.call(this._shortMonthsParse, llc);
            return ii !== -1 ? ii : null;
        } else {
            ii = indexOf$1.call(this._longMonthsParse, llc);
            return ii !== -1 ? ii : null;
        }
    } else {
        if (format === 'MMM') {
            ii = indexOf$1.call(this._shortMonthsParse, llc);
            if (ii !== -1) {
                return ii;
            }
            ii = indexOf$1.call(this._longMonthsParse, llc);
            return ii !== -1 ? ii : null;
        } else {
            ii = indexOf$1.call(this._longMonthsParse, llc);
            if (ii !== -1) {
                return ii;
            }
            ii = indexOf$1.call(this._shortMonthsParse, llc);
            return ii !== -1 ? ii : null;
        }
    }
}

function localeMonthsParse (monthName, format, strict) {
    var i, mom, regex;

    if (this._monthsParseExact) {
        return handleStrictParse.call(this, monthName, format, strict);
    }

    if (!this._monthsParse) {
        this._monthsParse = [];
        this._longMonthsParse = [];
        this._shortMonthsParse = [];
    }

    // TODO: add sorting
    // Sorting makes sure if one month (or abbr) is a prefix of another
    // see sorting in computeMonthsParse
    for (i = 0; i < 12; i++) {
        // make the regex if we don't have it already
        mom = createUTC([2000, i]);
        if (strict && !this._longMonthsParse[i]) {
            this._longMonthsParse[i] = new RegExp('^' + this.months(mom, '').replace('.', '') + '$', 'i');
            this._shortMonthsParse[i] = new RegExp('^' + this.monthsShort(mom, '').replace('.', '') + '$', 'i');
        }
        if (!strict && !this._monthsParse[i]) {
            regex = '^' + this.months(mom, '') + '|^' + this.monthsShort(mom, '');
            this._monthsParse[i] = new RegExp(regex.replace('.', ''), 'i');
        }
        // test the regex
        if (strict && format === 'MMMM' && this._longMonthsParse[i].test(monthName)) {
            return i;
        } else if (strict && format === 'MMM' && this._shortMonthsParse[i].test(monthName)) {
            return i;
        } else if (!strict && this._monthsParse[i].test(monthName)) {
            return i;
        }
    }
}

// MOMENTS

function setMonth (mom, value) {
    var dayOfMonth;

    if (!mom.isValid()) {
        // No op
        return mom;
    }

    if (typeof value === 'string') {
        if (/^\d+$/.test(value)) {
            value = toInt(value);
        } else {
            value = mom.localeData().monthsParse(value);
            // TODO: Another silent failure?
            if (!isNumber(value)) {
                return mom;
            }
        }
    }

    dayOfMonth = Math.min(mom.date(), daysInMonth(mom.year(), value));
    mom._d['set' + (mom._isUTC ? 'UTC' : '') + 'Month'](value, dayOfMonth);
    return mom;
}

function getSetMonth (value) {
    if (value != null) {
        setMonth(this, value);
        hooks.updateOffset(this, true);
        return this;
    } else {
        return get(this, 'Month');
    }
}

function getDaysInMonth () {
    return daysInMonth(this.year(), this.month());
}

var defaultMonthsShortRegex = matchWord;
function monthsShortRegex (isStrict) {
    if (this._monthsParseExact) {
        if (!hasOwnProp(this, '_monthsRegex')) {
            computeMonthsParse.call(this);
        }
        if (isStrict) {
            return this._monthsShortStrictRegex;
        } else {
            return this._monthsShortRegex;
        }
    } else {
        if (!hasOwnProp(this, '_monthsShortRegex')) {
            this._monthsShortRegex = defaultMonthsShortRegex;
        }
        return this._monthsShortStrictRegex && isStrict ?
            this._monthsShortStrictRegex : this._monthsShortRegex;
    }
}

var defaultMonthsRegex = matchWord;
function monthsRegex (isStrict) {
    if (this._monthsParseExact) {
        if (!hasOwnProp(this, '_monthsRegex')) {
            computeMonthsParse.call(this);
        }
        if (isStrict) {
            return this._monthsStrictRegex;
        } else {
            return this._monthsRegex;
        }
    } else {
        if (!hasOwnProp(this, '_monthsRegex')) {
            this._monthsRegex = defaultMonthsRegex;
        }
        return this._monthsStrictRegex && isStrict ?
            this._monthsStrictRegex : this._monthsRegex;
    }
}

function computeMonthsParse () {
    function cmpLenRev(a, b) {
        return b.length - a.length;
    }

    var shortPieces = [], longPieces = [], mixedPieces = [],
        i, mom;
    for (i = 0; i < 12; i++) {
        // make the regex if we don't have it already
        mom = createUTC([2000, i]);
        shortPieces.push(this.monthsShort(mom, ''));
        longPieces.push(this.months(mom, ''));
        mixedPieces.push(this.months(mom, ''));
        mixedPieces.push(this.monthsShort(mom, ''));
    }
    // Sorting makes sure if one month (or abbr) is a prefix of another it
    // will match the longer piece.
    shortPieces.sort(cmpLenRev);
    longPieces.sort(cmpLenRev);
    mixedPieces.sort(cmpLenRev);
    for (i = 0; i < 12; i++) {
        shortPieces[i] = regexEscape(shortPieces[i]);
        longPieces[i] = regexEscape(longPieces[i]);
    }
    for (i = 0; i < 24; i++) {
        mixedPieces[i] = regexEscape(mixedPieces[i]);
    }

    this._monthsRegex = new RegExp('^(' + mixedPieces.join('|') + ')', 'i');
    this._monthsShortRegex = this._monthsRegex;
    this._monthsStrictRegex = new RegExp('^(' + longPieces.join('|') + ')', 'i');
    this._monthsShortStrictRegex = new RegExp('^(' + shortPieces.join('|') + ')', 'i');
}

// FORMATTING

addFormatToken('Y', 0, 0, function () {
    var y = this.year();
    return y <= 9999 ? '' + y : '+' + y;
});

addFormatToken(0, ['YY', 2], 0, function () {
    return this.year() % 100;
});

addFormatToken(0, ['YYYY',   4],       0, 'year');
addFormatToken(0, ['YYYYY',  5],       0, 'year');
addFormatToken(0, ['YYYYYY', 6, true], 0, 'year');

// ALIASES

addUnitAlias('year', 'y');

// PRIORITIES

addUnitPriority('year', 1);

// PARSING

addRegexToken('Y',      matchSigned);
addRegexToken('YY',     match1to2, match2);
addRegexToken('YYYY',   match1to4, match4);
addRegexToken('YYYYY',  match1to6, match6);
addRegexToken('YYYYYY', match1to6, match6);

addParseToken(['YYYYY', 'YYYYYY'], YEAR);
addParseToken('YYYY', function (input, array) {
    array[YEAR] = input.length === 2 ? hooks.parseTwoDigitYear(input) : toInt(input);
});
addParseToken('YY', function (input, array) {
    array[YEAR] = hooks.parseTwoDigitYear(input);
});
addParseToken('Y', function (input, array) {
    array[YEAR] = parseInt(input, 10);
});

// HELPERS

function daysInYear(year) {
    return isLeapYear(year) ? 366 : 365;
}

function isLeapYear(year) {
    return (year % 4 === 0 && year % 100 !== 0) || year % 400 === 0;
}

// HOOKS

hooks.parseTwoDigitYear = function (input) {
    return toInt(input) + (toInt(input) > 68 ? 1900 : 2000);
};

// MOMENTS

var getSetYear = makeGetSet('FullYear', true);

function getIsLeapYear () {
    return isLeapYear(this.year());
}

function createDate (y, m, d, h, M, s, ms) {
    // can't just apply() to create a date:
    // https://stackoverflow.com/q/181348
    var date = new Date(y, m, d, h, M, s, ms);

    // the date constructor remaps years 0-99 to 1900-1999
    if (y < 100 && y >= 0 && isFinite(date.getFullYear())) {
        date.setFullYear(y);
    }
    return date;
}

function createUTCDate (y) {
    var date = new Date(Date.UTC.apply(null, arguments));

    // the Date.UTC function remaps years 0-99 to 1900-1999
    if (y < 100 && y >= 0 && isFinite(date.getUTCFullYear())) {
        date.setUTCFullYear(y);
    }
    return date;
}

// start-of-first-week - start-of-year
function firstWeekOffset(year, dow, doy) {
    var // first-week day -- which january is always in the first week (4 for iso, 1 for other)
        fwd = 7 + dow - doy,
        // first-week day local weekday -- which local weekday is fwd
        fwdlw = (7 + createUTCDate(year, 0, fwd).getUTCDay() - dow) % 7;

    return -fwdlw + fwd - 1;
}

// https://en.wikipedia.org/wiki/ISO_week_date#Calculating_a_date_given_the_year.2C_week_number_and_weekday
function dayOfYearFromWeeks(year, week, weekday, dow, doy) {
    var localWeekday = (7 + weekday - dow) % 7,
        weekOffset = firstWeekOffset(year, dow, doy),
        dayOfYear = 1 + 7 * (week - 1) + localWeekday + weekOffset,
        resYear, resDayOfYear;

    if (dayOfYear <= 0) {
        resYear = year - 1;
        resDayOfYear = daysInYear(resYear) + dayOfYear;
    } else if (dayOfYear > daysInYear(year)) {
        resYear = year + 1;
        resDayOfYear = dayOfYear - daysInYear(year);
    } else {
        resYear = year;
        resDayOfYear = dayOfYear;
    }

    return {
        year: resYear,
        dayOfYear: resDayOfYear
    };
}

function weekOfYear(mom, dow, doy) {
    var weekOffset = firstWeekOffset(mom.year(), dow, doy),
        week = Math.floor((mom.dayOfYear() - weekOffset - 1) / 7) + 1,
        resWeek, resYear;

    if (week < 1) {
        resYear = mom.year() - 1;
        resWeek = week + weeksInYear(resYear, dow, doy);
    } else if (week > weeksInYear(mom.year(), dow, doy)) {
        resWeek = week - weeksInYear(mom.year(), dow, doy);
        resYear = mom.year() + 1;
    } else {
        resYear = mom.year();
        resWeek = week;
    }

    return {
        week: resWeek,
        year: resYear
    };
}

function weeksInYear(year, dow, doy) {
    var weekOffset = firstWeekOffset(year, dow, doy),
        weekOffsetNext = firstWeekOffset(year + 1, dow, doy);
    return (daysInYear(year) - weekOffset + weekOffsetNext) / 7;
}

// FORMATTING

addFormatToken('w', ['ww', 2], 'wo', 'week');
addFormatToken('W', ['WW', 2], 'Wo', 'isoWeek');

// ALIASES

addUnitAlias('week', 'w');
addUnitAlias('isoWeek', 'W');

// PRIORITIES

addUnitPriority('week', 5);
addUnitPriority('isoWeek', 5);

// PARSING

addRegexToken('w',  match1to2);
addRegexToken('ww', match1to2, match2);
addRegexToken('W',  match1to2);
addRegexToken('WW', match1to2, match2);

addWeekParseToken(['w', 'ww', 'W', 'WW'], function (input, week, config, token) {
    week[token.substr(0, 1)] = toInt(input);
});

// HELPERS

// LOCALES

function localeWeek (mom) {
    return weekOfYear(mom, this._week.dow, this._week.doy).week;
}

var defaultLocaleWeek = {
    dow : 0, // Sunday is the first day of the week.
    doy : 6  // The week that contains Jan 1st is the first week of the year.
};

function localeFirstDayOfWeek () {
    return this._week.dow;
}

function localeFirstDayOfYear () {
    return this._week.doy;
}

// MOMENTS

function getSetWeek (input) {
    var week = this.localeData().week(this);
    return input == null ? week : this.add((input - week) * 7, 'd');
}

function getSetISOWeek (input) {
    var week = weekOfYear(this, 1, 4).week;
    return input == null ? week : this.add((input - week) * 7, 'd');
}

// FORMATTING

addFormatToken('d', 0, 'do', 'day');

addFormatToken('dd', 0, 0, function (format) {
    return this.localeData().weekdaysMin(this, format);
});

addFormatToken('ddd', 0, 0, function (format) {
    return this.localeData().weekdaysShort(this, format);
});

addFormatToken('dddd', 0, 0, function (format) {
    return this.localeData().weekdays(this, format);
});

addFormatToken('e', 0, 0, 'weekday');
addFormatToken('E', 0, 0, 'isoWeekday');

// ALIASES

addUnitAlias('day', 'd');
addUnitAlias('weekday', 'e');
addUnitAlias('isoWeekday', 'E');

// PRIORITY
addUnitPriority('day', 11);
addUnitPriority('weekday', 11);
addUnitPriority('isoWeekday', 11);

// PARSING

addRegexToken('d',    match1to2);
addRegexToken('e',    match1to2);
addRegexToken('E',    match1to2);
addRegexToken('dd',   function (isStrict, locale) {
    return locale.weekdaysMinRegex(isStrict);
});
addRegexToken('ddd',   function (isStrict, locale) {
    return locale.weekdaysShortRegex(isStrict);
});
addRegexToken('dddd',   function (isStrict, locale) {
    return locale.weekdaysRegex(isStrict);
});

addWeekParseToken(['dd', 'ddd', 'dddd'], function (input, week, config, token) {
    var weekday = config._locale.weekdaysParse(input, token, config._strict);
    // if we didn't get a weekday name, mark the date as invalid
    if (weekday != null) {
        week.d = weekday;
    } else {
        getParsingFlags(config).invalidWeekday = input;
    }
});

addWeekParseToken(['d', 'e', 'E'], function (input, week, config, token) {
    week[token] = toInt(input);
});

// HELPERS

function parseWeekday(input, locale) {
    if (typeof input !== 'string') {
        return input;
    }

    if (!isNaN(input)) {
        return parseInt(input, 10);
    }

    input = locale.weekdaysParse(input);
    if (typeof input === 'number') {
        return input;
    }

    return null;
}

function parseIsoWeekday(input, locale) {
    if (typeof input === 'string') {
        return locale.weekdaysParse(input) % 7 || 7;
    }
    return isNaN(input) ? null : input;
}

// LOCALES

var defaultLocaleWeekdays = 'Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split('_');
function localeWeekdays (m, format) {
    if (!m) {
        return isArray(this._weekdays) ? this._weekdays :
            this._weekdays['standalone'];
    }
    return isArray(this._weekdays) ? this._weekdays[m.day()] :
        this._weekdays[this._weekdays.isFormat.test(format) ? 'format' : 'standalone'][m.day()];
}

var defaultLocaleWeekdaysShort = 'Sun_Mon_Tue_Wed_Thu_Fri_Sat'.split('_');
function localeWeekdaysShort (m) {
    return (m) ? this._weekdaysShort[m.day()] : this._weekdaysShort;
}

var defaultLocaleWeekdaysMin = 'Su_Mo_Tu_We_Th_Fr_Sa'.split('_');
function localeWeekdaysMin (m) {
    return (m) ? this._weekdaysMin[m.day()] : this._weekdaysMin;
}

function handleStrictParse$1(weekdayName, format, strict) {
    var i, ii, mom, llc = weekdayName.toLocaleLowerCase();
    if (!this._weekdaysParse) {
        this._weekdaysParse = [];
        this._shortWeekdaysParse = [];
        this._minWeekdaysParse = [];

        for (i = 0; i < 7; ++i) {
            mom = createUTC([2000, 1]).day(i);
            this._minWeekdaysParse[i] = this.weekdaysMin(mom, '').toLocaleLowerCase();
            this._shortWeekdaysParse[i] = this.weekdaysShort(mom, '').toLocaleLowerCase();
            this._weekdaysParse[i] = this.weekdays(mom, '').toLocaleLowerCase();
        }
    }

    if (strict) {
        if (format === 'dddd') {
            ii = indexOf$1.call(this._weekdaysParse, llc);
            return ii !== -1 ? ii : null;
        } else if (format === 'ddd') {
            ii = indexOf$1.call(this._shortWeekdaysParse, llc);
            return ii !== -1 ? ii : null;
        } else {
            ii = indexOf$1.call(this._minWeekdaysParse, llc);
            return ii !== -1 ? ii : null;
        }
    } else {
        if (format === 'dddd') {
            ii = indexOf$1.call(this._weekdaysParse, llc);
            if (ii !== -1) {
                return ii;
            }
            ii = indexOf$1.call(this._shortWeekdaysParse, llc);
            if (ii !== -1) {
                return ii;
            }
            ii = indexOf$1.call(this._minWeekdaysParse, llc);
            return ii !== -1 ? ii : null;
        } else if (format === 'ddd') {
            ii = indexOf$1.call(this._shortWeekdaysParse, llc);
            if (ii !== -1) {
                return ii;
            }
            ii = indexOf$1.call(this._weekdaysParse, llc);
            if (ii !== -1) {
                return ii;
            }
            ii = indexOf$1.call(this._minWeekdaysParse, llc);
            return ii !== -1 ? ii : null;
        } else {
            ii = indexOf$1.call(this._minWeekdaysParse, llc);
            if (ii !== -1) {
                return ii;
            }
            ii = indexOf$1.call(this._weekdaysParse, llc);
            if (ii !== -1) {
                return ii;
            }
            ii = indexOf$1.call(this._shortWeekdaysParse, llc);
            return ii !== -1 ? ii : null;
        }
    }
}

function localeWeekdaysParse (weekdayName, format, strict) {
    var i, mom, regex;

    if (this._weekdaysParseExact) {
        return handleStrictParse$1.call(this, weekdayName, format, strict);
    }

    if (!this._weekdaysParse) {
        this._weekdaysParse = [];
        this._minWeekdaysParse = [];
        this._shortWeekdaysParse = [];
        this._fullWeekdaysParse = [];
    }

    for (i = 0; i < 7; i++) {
        // make the regex if we don't have it already

        mom = createUTC([2000, 1]).day(i);
        if (strict && !this._fullWeekdaysParse[i]) {
            this._fullWeekdaysParse[i] = new RegExp('^' + this.weekdays(mom, '').replace('.', '\.?') + '$', 'i');
            this._shortWeekdaysParse[i] = new RegExp('^' + this.weekdaysShort(mom, '').replace('.', '\.?') + '$', 'i');
            this._minWeekdaysParse[i] = new RegExp('^' + this.weekdaysMin(mom, '').replace('.', '\.?') + '$', 'i');
        }
        if (!this._weekdaysParse[i]) {
            regex = '^' + this.weekdays(mom, '') + '|^' + this.weekdaysShort(mom, '') + '|^' + this.weekdaysMin(mom, '');
            this._weekdaysParse[i] = new RegExp(regex.replace('.', ''), 'i');
        }
        // test the regex
        if (strict && format === 'dddd' && this._fullWeekdaysParse[i].test(weekdayName)) {
            return i;
        } else if (strict && format === 'ddd' && this._shortWeekdaysParse[i].test(weekdayName)) {
            return i;
        } else if (strict && format === 'dd' && this._minWeekdaysParse[i].test(weekdayName)) {
            return i;
        } else if (!strict && this._weekdaysParse[i].test(weekdayName)) {
            return i;
        }
    }
}

// MOMENTS

function getSetDayOfWeek (input) {
    if (!this.isValid()) {
        return input != null ? this : NaN;
    }
    var day = this._isUTC ? this._d.getUTCDay() : this._d.getDay();
    if (input != null) {
        input = parseWeekday(input, this.localeData());
        return this.add(input - day, 'd');
    } else {
        return day;
    }
}

function getSetLocaleDayOfWeek (input) {
    if (!this.isValid()) {
        return input != null ? this : NaN;
    }
    var weekday = (this.day() + 7 - this.localeData()._week.dow) % 7;
    return input == null ? weekday : this.add(input - weekday, 'd');
}

function getSetISODayOfWeek (input) {
    if (!this.isValid()) {
        return input != null ? this : NaN;
    }

    // behaves the same as moment#day except
    // as a getter, returns 7 instead of 0 (1-7 range instead of 0-6)
    // as a setter, sunday should belong to the previous week.

    if (input != null) {
        var weekday = parseIsoWeekday(input, this.localeData());
        return this.day(this.day() % 7 ? weekday : weekday - 7);
    } else {
        return this.day() || 7;
    }
}

var defaultWeekdaysRegex = matchWord;
function weekdaysRegex (isStrict) {
    if (this._weekdaysParseExact) {
        if (!hasOwnProp(this, '_weekdaysRegex')) {
            computeWeekdaysParse.call(this);
        }
        if (isStrict) {
            return this._weekdaysStrictRegex;
        } else {
            return this._weekdaysRegex;
        }
    } else {
        if (!hasOwnProp(this, '_weekdaysRegex')) {
            this._weekdaysRegex = defaultWeekdaysRegex;
        }
        return this._weekdaysStrictRegex && isStrict ?
            this._weekdaysStrictRegex : this._weekdaysRegex;
    }
}

var defaultWeekdaysShortRegex = matchWord;
function weekdaysShortRegex (isStrict) {
    if (this._weekdaysParseExact) {
        if (!hasOwnProp(this, '_weekdaysRegex')) {
            computeWeekdaysParse.call(this);
        }
        if (isStrict) {
            return this._weekdaysShortStrictRegex;
        } else {
            return this._weekdaysShortRegex;
        }
    } else {
        if (!hasOwnProp(this, '_weekdaysShortRegex')) {
            this._weekdaysShortRegex = defaultWeekdaysShortRegex;
        }
        return this._weekdaysShortStrictRegex && isStrict ?
            this._weekdaysShortStrictRegex : this._weekdaysShortRegex;
    }
}

var defaultWeekdaysMinRegex = matchWord;
function weekdaysMinRegex (isStrict) {
    if (this._weekdaysParseExact) {
        if (!hasOwnProp(this, '_weekdaysRegex')) {
            computeWeekdaysParse.call(this);
        }
        if (isStrict) {
            return this._weekdaysMinStrictRegex;
        } else {
            return this._weekdaysMinRegex;
        }
    } else {
        if (!hasOwnProp(this, '_weekdaysMinRegex')) {
            this._weekdaysMinRegex = defaultWeekdaysMinRegex;
        }
        return this._weekdaysMinStrictRegex && isStrict ?
            this._weekdaysMinStrictRegex : this._weekdaysMinRegex;
    }
}


function computeWeekdaysParse () {
    function cmpLenRev(a, b) {
        return b.length - a.length;
    }

    var minPieces = [], shortPieces = [], longPieces = [], mixedPieces = [],
        i, mom, minp, shortp, longp;
    for (i = 0; i < 7; i++) {
        // make the regex if we don't have it already
        mom = createUTC([2000, 1]).day(i);
        minp = this.weekdaysMin(mom, '');
        shortp = this.weekdaysShort(mom, '');
        longp = this.weekdays(mom, '');
        minPieces.push(minp);
        shortPieces.push(shortp);
        longPieces.push(longp);
        mixedPieces.push(minp);
        mixedPieces.push(shortp);
        mixedPieces.push(longp);
    }
    // Sorting makes sure if one weekday (or abbr) is a prefix of another it
    // will match the longer piece.
    minPieces.sort(cmpLenRev);
    shortPieces.sort(cmpLenRev);
    longPieces.sort(cmpLenRev);
    mixedPieces.sort(cmpLenRev);
    for (i = 0; i < 7; i++) {
        shortPieces[i] = regexEscape(shortPieces[i]);
        longPieces[i] = regexEscape(longPieces[i]);
        mixedPieces[i] = regexEscape(mixedPieces[i]);
    }

    this._weekdaysRegex = new RegExp('^(' + mixedPieces.join('|') + ')', 'i');
    this._weekdaysShortRegex = this._weekdaysRegex;
    this._weekdaysMinRegex = this._weekdaysRegex;

    this._weekdaysStrictRegex = new RegExp('^(' + longPieces.join('|') + ')', 'i');
    this._weekdaysShortStrictRegex = new RegExp('^(' + shortPieces.join('|') + ')', 'i');
    this._weekdaysMinStrictRegex = new RegExp('^(' + minPieces.join('|') + ')', 'i');
}

// FORMATTING

function hFormat() {
    return this.hours() % 12 || 12;
}

function kFormat() {
    return this.hours() || 24;
}

addFormatToken('H', ['HH', 2], 0, 'hour');
addFormatToken('h', ['hh', 2], 0, hFormat);
addFormatToken('k', ['kk', 2], 0, kFormat);

addFormatToken('hmm', 0, 0, function () {
    return '' + hFormat.apply(this) + zeroFill(this.minutes(), 2);
});

addFormatToken('hmmss', 0, 0, function () {
    return '' + hFormat.apply(this) + zeroFill(this.minutes(), 2) +
        zeroFill(this.seconds(), 2);
});

addFormatToken('Hmm', 0, 0, function () {
    return '' + this.hours() + zeroFill(this.minutes(), 2);
});

addFormatToken('Hmmss', 0, 0, function () {
    return '' + this.hours() + zeroFill(this.minutes(), 2) +
        zeroFill(this.seconds(), 2);
});

function meridiem (token, lowercase) {
    addFormatToken(token, 0, 0, function () {
        return this.localeData().meridiem(this.hours(), this.minutes(), lowercase);
    });
}

meridiem('a', true);
meridiem('A', false);

// ALIASES

addUnitAlias('hour', 'h');

// PRIORITY
addUnitPriority('hour', 13);

// PARSING

function matchMeridiem (isStrict, locale) {
    return locale._meridiemParse;
}

addRegexToken('a',  matchMeridiem);
addRegexToken('A',  matchMeridiem);
addRegexToken('H',  match1to2);
addRegexToken('h',  match1to2);
addRegexToken('k',  match1to2);
addRegexToken('HH', match1to2, match2);
addRegexToken('hh', match1to2, match2);
addRegexToken('kk', match1to2, match2);

addRegexToken('hmm', match3to4);
addRegexToken('hmmss', match5to6);
addRegexToken('Hmm', match3to4);
addRegexToken('Hmmss', match5to6);

addParseToken(['H', 'HH'], HOUR);
addParseToken(['k', 'kk'], function (input, array, config) {
    var kInput = toInt(input);
    array[HOUR] = kInput === 24 ? 0 : kInput;
});
addParseToken(['a', 'A'], function (input, array, config) {
    config._isPm = config._locale.isPM(input);
    config._meridiem = input;
});
addParseToken(['h', 'hh'], function (input, array, config) {
    array[HOUR] = toInt(input);
    getParsingFlags(config).bigHour = true;
});
addParseToken('hmm', function (input, array, config) {
    var pos = input.length - 2;
    array[HOUR] = toInt(input.substr(0, pos));
    array[MINUTE] = toInt(input.substr(pos));
    getParsingFlags(config).bigHour = true;
});
addParseToken('hmmss', function (input, array, config) {
    var pos1 = input.length - 4;
    var pos2 = input.length - 2;
    array[HOUR] = toInt(input.substr(0, pos1));
    array[MINUTE] = toInt(input.substr(pos1, 2));
    array[SECOND] = toInt(input.substr(pos2));
    getParsingFlags(config).bigHour = true;
});
addParseToken('Hmm', function (input, array, config) {
    var pos = input.length - 2;
    array[HOUR] = toInt(input.substr(0, pos));
    array[MINUTE] = toInt(input.substr(pos));
});
addParseToken('Hmmss', function (input, array, config) {
    var pos1 = input.length - 4;
    var pos2 = input.length - 2;
    array[HOUR] = toInt(input.substr(0, pos1));
    array[MINUTE] = toInt(input.substr(pos1, 2));
    array[SECOND] = toInt(input.substr(pos2));
});

// LOCALES

function localeIsPM (input) {
    // IE8 Quirks Mode & IE7 Standards Mode do not allow accessing strings like arrays
    // Using charAt should be more compatible.
    return ((input + '').toLowerCase().charAt(0) === 'p');
}

var defaultLocaleMeridiemParse = /[ap]\.?m?\.?/i;
function localeMeridiem (hours, minutes, isLower) {
    if (hours > 11) {
        return isLower ? 'pm' : 'PM';
    } else {
        return isLower ? 'am' : 'AM';
    }
}


// MOMENTS

// Setting the hour should keep the time, because the user explicitly
// specified which hour he wants. So trying to maintain the same hour (in
// a new timezone) makes sense. Adding/subtracting hours does not follow
// this rule.
var getSetHour = makeGetSet('Hours', true);

// months
// week
// weekdays
// meridiem
var baseConfig = {
    calendar: defaultCalendar,
    longDateFormat: defaultLongDateFormat,
    invalidDate: defaultInvalidDate,
    ordinal: defaultOrdinal,
    dayOfMonthOrdinalParse: defaultDayOfMonthOrdinalParse,
    relativeTime: defaultRelativeTime,

    months: defaultLocaleMonths,
    monthsShort: defaultLocaleMonthsShort,

    week: defaultLocaleWeek,

    weekdays: defaultLocaleWeekdays,
    weekdaysMin: defaultLocaleWeekdaysMin,
    weekdaysShort: defaultLocaleWeekdaysShort,

    meridiemParse: defaultLocaleMeridiemParse
};

// internal storage for locale config files
var locales = {};
var localeFamilies = {};
var globalLocale;

function normalizeLocale(key) {
    return key ? key.toLowerCase().replace('_', '-') : key;
}

// pick the locale from the array
// try ['en-au', 'en-gb'] as 'en-au', 'en-gb', 'en', as in move through the list trying each
// substring from most specific to least, but move to the next array item if it's a more specific variant than the current root
function chooseLocale(names) {
    var i = 0, j, next, locale, split;

    while (i < names.length) {
        split = normalizeLocale(names[i]).split('-');
        j = split.length;
        next = normalizeLocale(names[i + 1]);
        next = next ? next.split('-') : null;
        while (j > 0) {
            locale = loadLocale(split.slice(0, j).join('-'));
            if (locale) {
                return locale;
            }
            if (next && next.length >= j && compareArrays(split, next, true) >= j - 1) {
                //the next array item is better than a shallower substring of this one
                break;
            }
            j--;
        }
        i++;
    }
    return null;
}

function loadLocale(name) {
    var oldLocale = null;
    // TODO: Find a better way to register and load all the locales in Node
    if (!locales[name] && (typeof module !== 'undefined') &&
            module && module.exports) {
        try {
            oldLocale = globalLocale._abbr;
            _dereq_('./locale/' + name);
            // because defineLocale currently also sets the global locale, we
            // want to undo that for lazy loaded locales
            getSetGlobalLocale(oldLocale);
        } catch (e) { }
    }
    return locales[name];
}

// This function will load locale and then set the global locale.  If
// no arguments are passed in, it will simply return the current global
// locale key.
function getSetGlobalLocale (key, values) {
    var data;
    if (key) {
        if (isUndefined(values)) {
            data = getLocale(key);
        }
        else {
            data = defineLocale(key, values);
        }

        if (data) {
            // moment.duration._locale = moment._locale = data;
            globalLocale = data;
        }
    }

    return globalLocale._abbr;
}

function defineLocale (name, config) {
    if (config !== null) {
        var parentConfig = baseConfig;
        config.abbr = name;
        if (locales[name] != null) {
            deprecateSimple('defineLocaleOverride',
                    'use moment.updateLocale(localeName, config) to change ' +
                    'an existing locale. moment.defineLocale(localeName, ' +
                    'config) should only be used for creating a new locale ' +
                    'See http://momentjs.com/guides/#/warnings/define-locale/ for more info.');
            parentConfig = locales[name]._config;
        } else if (config.parentLocale != null) {
            if (locales[config.parentLocale] != null) {
                parentConfig = locales[config.parentLocale]._config;
            } else {
                if (!localeFamilies[config.parentLocale]) {
                    localeFamilies[config.parentLocale] = [];
                }
                localeFamilies[config.parentLocale].push({
                    name: name,
                    config: config
                });
                return null;
            }
        }
        locales[name] = new Locale(mergeConfigs(parentConfig, config));

        if (localeFamilies[name]) {
            localeFamilies[name].forEach(function (x) {
                defineLocale(x.name, x.config);
            });
        }

        // backwards compat for now: also set the locale
        // make sure we set the locale AFTER all child locales have been
        // created, so we won't end up with the child locale set.
        getSetGlobalLocale(name);


        return locales[name];
    } else {
        // useful for testing
        delete locales[name];
        return null;
    }
}

function updateLocale(name, config) {
    if (config != null) {
        var locale, parentConfig = baseConfig;
        // MERGE
        if (locales[name] != null) {
            parentConfig = locales[name]._config;
        }
        config = mergeConfigs(parentConfig, config);
        locale = new Locale(config);
        locale.parentLocale = locales[name];
        locales[name] = locale;

        // backwards compat for now: also set the locale
        getSetGlobalLocale(name);
    } else {
        // pass null for config to unupdate, useful for tests
        if (locales[name] != null) {
            if (locales[name].parentLocale != null) {
                locales[name] = locales[name].parentLocale;
            } else if (locales[name] != null) {
                delete locales[name];
            }
        }
    }
    return locales[name];
}

// returns locale data
function getLocale (key) {
    var locale;

    if (key && key._locale && key._locale._abbr) {
        key = key._locale._abbr;
    }

    if (!key) {
        return globalLocale;
    }

    if (!isArray(key)) {
        //short-circuit everything else
        locale = loadLocale(key);
        if (locale) {
            return locale;
        }
        key = [key];
    }

    return chooseLocale(key);
}

function listLocales() {
    return keys$1(locales);
}

function checkOverflow (m) {
    var overflow;
    var a = m._a;

    if (a && getParsingFlags(m).overflow === -2) {
        overflow =
            a[MONTH]       < 0 || a[MONTH]       > 11  ? MONTH :
            a[DATE]        < 1 || a[DATE]        > daysInMonth(a[YEAR], a[MONTH]) ? DATE :
            a[HOUR]        < 0 || a[HOUR]        > 24 || (a[HOUR] === 24 && (a[MINUTE] !== 0 || a[SECOND] !== 0 || a[MILLISECOND] !== 0)) ? HOUR :
            a[MINUTE]      < 0 || a[MINUTE]      > 59  ? MINUTE :
            a[SECOND]      < 0 || a[SECOND]      > 59  ? SECOND :
            a[MILLISECOND] < 0 || a[MILLISECOND] > 999 ? MILLISECOND :
            -1;

        if (getParsingFlags(m)._overflowDayOfYear && (overflow < YEAR || overflow > DATE)) {
            overflow = DATE;
        }
        if (getParsingFlags(m)._overflowWeeks && overflow === -1) {
            overflow = WEEK;
        }
        if (getParsingFlags(m)._overflowWeekday && overflow === -1) {
            overflow = WEEKDAY;
        }

        getParsingFlags(m).overflow = overflow;
    }

    return m;
}

// iso 8601 regex
// 0000-00-00 0000-W00 or 0000-W00-0 + T + 00 or 00:00 or 00:00:00 or 00:00:00.000 + +00:00 or +0000 or +00)
var extendedIsoRegex = /^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;
var basicIsoRegex = /^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;

var tzRegex = /Z|[+-]\d\d(?::?\d\d)?/;

var isoDates = [
    ['YYYYYY-MM-DD', /[+-]\d{6}-\d\d-\d\d/],
    ['YYYY-MM-DD', /\d{4}-\d\d-\d\d/],
    ['GGGG-[W]WW-E', /\d{4}-W\d\d-\d/],
    ['GGGG-[W]WW', /\d{4}-W\d\d/, false],
    ['YYYY-DDD', /\d{4}-\d{3}/],
    ['YYYY-MM', /\d{4}-\d\d/, false],
    ['YYYYYYMMDD', /[+-]\d{10}/],
    ['YYYYMMDD', /\d{8}/],
    // YYYYMM is NOT allowed by the standard
    ['GGGG[W]WWE', /\d{4}W\d{3}/],
    ['GGGG[W]WW', /\d{4}W\d{2}/, false],
    ['YYYYDDD', /\d{7}/]
];

// iso time formats and regexes
var isoTimes = [
    ['HH:mm:ss.SSSS', /\d\d:\d\d:\d\d\.\d+/],
    ['HH:mm:ss,SSSS', /\d\d:\d\d:\d\d,\d+/],
    ['HH:mm:ss', /\d\d:\d\d:\d\d/],
    ['HH:mm', /\d\d:\d\d/],
    ['HHmmss.SSSS', /\d\d\d\d\d\d\.\d+/],
    ['HHmmss,SSSS', /\d\d\d\d\d\d,\d+/],
    ['HHmmss', /\d\d\d\d\d\d/],
    ['HHmm', /\d\d\d\d/],
    ['HH', /\d\d/]
];

var aspNetJsonRegex = /^\/?Date\((\-?\d+)/i;

// date from iso format
function configFromISO(config) {
    var i, l,
        string = config._i,
        match = extendedIsoRegex.exec(string) || basicIsoRegex.exec(string),
        allowTime, dateFormat, timeFormat, tzFormat;

    if (match) {
        getParsingFlags(config).iso = true;

        for (i = 0, l = isoDates.length; i < l; i++) {
            if (isoDates[i][1].exec(match[1])) {
                dateFormat = isoDates[i][0];
                allowTime = isoDates[i][2] !== false;
                break;
            }
        }
        if (dateFormat == null) {
            config._isValid = false;
            return;
        }
        if (match[3]) {
            for (i = 0, l = isoTimes.length; i < l; i++) {
                if (isoTimes[i][1].exec(match[3])) {
                    // match[2] should be 'T' or space
                    timeFormat = (match[2] || ' ') + isoTimes[i][0];
                    break;
                }
            }
            if (timeFormat == null) {
                config._isValid = false;
                return;
            }
        }
        if (!allowTime && timeFormat != null) {
            config._isValid = false;
            return;
        }
        if (match[4]) {
            if (tzRegex.exec(match[4])) {
                tzFormat = 'Z';
            } else {
                config._isValid = false;
                return;
            }
        }
        config._f = dateFormat + (timeFormat || '') + (tzFormat || '');
        configFromStringAndFormat(config);
    } else {
        config._isValid = false;
    }
}

// RFC 2822 regex: For details see https://tools.ietf.org/html/rfc2822#section-3.3
var basicRfcRegex = /^((?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d?\d\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(?:\d\d)?\d\d\s)(\d\d:\d\d)(\:\d\d)?(\s(?:UT|GMT|[ECMP][SD]T|[A-IK-Za-ik-z]|[+-]\d{4}))$/;

// date and time from ref 2822 format
function configFromRFC2822(config) {
    var string, match, dayFormat,
        dateFormat, timeFormat, tzFormat;
    var timezones = {
        ' GMT': ' +0000',
        ' EDT': ' -0400',
        ' EST': ' -0500',
        ' CDT': ' -0500',
        ' CST': ' -0600',
        ' MDT': ' -0600',
        ' MST': ' -0700',
        ' PDT': ' -0700',
        ' PST': ' -0800'
    };
    var military = 'YXWVUTSRQPONZABCDEFGHIKLM';
    var timezone, timezoneIndex;

    string = config._i
        .replace(/\([^\)]*\)|[\n\t]/g, ' ') // Remove comments and folding whitespace
        .replace(/(\s\s+)/g, ' ') // Replace multiple-spaces with a single space
        .replace(/^\s|\s$/g, ''); // Remove leading and trailing spaces
    match = basicRfcRegex.exec(string);

    if (match) {
        dayFormat = match[1] ? 'ddd' + ((match[1].length === 5) ? ', ' : ' ') : '';
        dateFormat = 'D MMM ' + ((match[2].length > 10) ? 'YYYY ' : 'YY ');
        timeFormat = 'HH:mm' + (match[4] ? ':ss' : '');

        // TODO: Replace the vanilla JS Date object with an indepentent day-of-week check.
        if (match[1]) { // day of week given
            var momentDate = new Date(match[2]);
            var momentDay = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'][momentDate.getDay()];

            if (match[1].substr(0,3) !== momentDay) {
                getParsingFlags(config).weekdayMismatch = true;
                config._isValid = false;
                return;
            }
        }

        switch (match[5].length) {
            case 2: // military
                if (timezoneIndex === 0) {
                    timezone = ' +0000';
                } else {
                    timezoneIndex = military.indexOf(match[5][1].toUpperCase()) - 12;
                    timezone = ((timezoneIndex < 0) ? ' -' : ' +') +
                        (('' + timezoneIndex).replace(/^-?/, '0')).match(/..$/)[0] + '00';
                }
                break;
            case 4: // Zone
                timezone = timezones[match[5]];
                break;
            default: // UT or +/-9999
                timezone = timezones[' GMT'];
        }
        match[5] = timezone;
        config._i = match.splice(1).join('');
        tzFormat = ' ZZ';
        config._f = dayFormat + dateFormat + timeFormat + tzFormat;
        configFromStringAndFormat(config);
        getParsingFlags(config).rfc2822 = true;
    } else {
        config._isValid = false;
    }
}

// date from iso format or fallback
function configFromString(config) {
    var matched = aspNetJsonRegex.exec(config._i);

    if (matched !== null) {
        config._d = new Date(+matched[1]);
        return;
    }

    configFromISO(config);
    if (config._isValid === false) {
        delete config._isValid;
    } else {
        return;
    }

    configFromRFC2822(config);
    if (config._isValid === false) {
        delete config._isValid;
    } else {
        return;
    }

    // Final attempt, use Input Fallback
    hooks.createFromInputFallback(config);
}

hooks.createFromInputFallback = deprecate(
    'value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), ' +
    'which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are ' +
    'discouraged and will be removed in an upcoming major release. Please refer to ' +
    'http://momentjs.com/guides/#/warnings/js-date/ for more info.',
    function (config) {
        config._d = new Date(config._i + (config._useUTC ? ' UTC' : ''));
    }
);

// Pick the first defined of two or three arguments.
function defaults(a, b, c) {
    if (a != null) {
        return a;
    }
    if (b != null) {
        return b;
    }
    return c;
}

function currentDateArray(config) {
    // hooks is actually the exported moment object
    var nowValue = new Date(hooks.now());
    if (config._useUTC) {
        return [nowValue.getUTCFullYear(), nowValue.getUTCMonth(), nowValue.getUTCDate()];
    }
    return [nowValue.getFullYear(), nowValue.getMonth(), nowValue.getDate()];
}

// convert an array to a date.
// the array should mirror the parameters below
// note: all values past the year are optional and will default to the lowest possible value.
// [year, month, day , hour, minute, second, millisecond]
function configFromArray (config) {
    var i, date, input = [], currentDate, yearToUse;

    if (config._d) {
        return;
    }

    currentDate = currentDateArray(config);

    //compute day of the year from weeks and weekdays
    if (config._w && config._a[DATE] == null && config._a[MONTH] == null) {
        dayOfYearFromWeekInfo(config);
    }

    //if the day of the year is set, figure out what it is
    if (config._dayOfYear != null) {
        yearToUse = defaults(config._a[YEAR], currentDate[YEAR]);

        if (config._dayOfYear > daysInYear(yearToUse) || config._dayOfYear === 0) {
            getParsingFlags(config)._overflowDayOfYear = true;
        }

        date = createUTCDate(yearToUse, 0, config._dayOfYear);
        config._a[MONTH] = date.getUTCMonth();
        config._a[DATE] = date.getUTCDate();
    }

    // Default to current date.
    // * if no year, month, day of month are given, default to today
    // * if day of month is given, default month and year
    // * if month is given, default only year
    // * if year is given, don't default anything
    for (i = 0; i < 3 && config._a[i] == null; ++i) {
        config._a[i] = input[i] = currentDate[i];
    }

    // Zero out whatever was not defaulted, including time
    for (; i < 7; i++) {
        config._a[i] = input[i] = (config._a[i] == null) ? (i === 2 ? 1 : 0) : config._a[i];
    }

    // Check for 24:00:00.000
    if (config._a[HOUR] === 24 &&
            config._a[MINUTE] === 0 &&
            config._a[SECOND] === 0 &&
            config._a[MILLISECOND] === 0) {
        config._nextDay = true;
        config._a[HOUR] = 0;
    }

    config._d = (config._useUTC ? createUTCDate : createDate).apply(null, input);
    // Apply timezone offset from input. The actual utcOffset can be changed
    // with parseZone.
    if (config._tzm != null) {
        config._d.setUTCMinutes(config._d.getUTCMinutes() - config._tzm);
    }

    if (config._nextDay) {
        config._a[HOUR] = 24;
    }
}

function dayOfYearFromWeekInfo(config) {
    var w, weekYear, week, weekday, dow, doy, temp, weekdayOverflow;

    w = config._w;
    if (w.GG != null || w.W != null || w.E != null) {
        dow = 1;
        doy = 4;

        // TODO: We need to take the current isoWeekYear, but that depends on
        // how we interpret now (local, utc, fixed offset). So create
        // a now version of current config (take local/utc/offset flags, and
        // create now).
        weekYear = defaults(w.GG, config._a[YEAR], weekOfYear(createLocal(), 1, 4).year);
        week = defaults(w.W, 1);
        weekday = defaults(w.E, 1);
        if (weekday < 1 || weekday > 7) {
            weekdayOverflow = true;
        }
    } else {
        dow = config._locale._week.dow;
        doy = config._locale._week.doy;

        var curWeek = weekOfYear(createLocal(), dow, doy);

        weekYear = defaults(w.gg, config._a[YEAR], curWeek.year);

        // Default to current week.
        week = defaults(w.w, curWeek.week);

        if (w.d != null) {
            // weekday -- low day numbers are considered next week
            weekday = w.d;
            if (weekday < 0 || weekday > 6) {
                weekdayOverflow = true;
            }
        } else if (w.e != null) {
            // local weekday -- counting starts from begining of week
            weekday = w.e + dow;
            if (w.e < 0 || w.e > 6) {
                weekdayOverflow = true;
            }
        } else {
            // default to begining of week
            weekday = dow;
        }
    }
    if (week < 1 || week > weeksInYear(weekYear, dow, doy)) {
        getParsingFlags(config)._overflowWeeks = true;
    } else if (weekdayOverflow != null) {
        getParsingFlags(config)._overflowWeekday = true;
    } else {
        temp = dayOfYearFromWeeks(weekYear, week, weekday, dow, doy);
        config._a[YEAR] = temp.year;
        config._dayOfYear = temp.dayOfYear;
    }
}

// constant that refers to the ISO standard
hooks.ISO_8601 = function () {};

// constant that refers to the RFC 2822 form
hooks.RFC_2822 = function () {};

// date from string and format string
function configFromStringAndFormat(config) {
    // TODO: Move this to another part of the creation flow to prevent circular deps
    if (config._f === hooks.ISO_8601) {
        configFromISO(config);
        return;
    }
    if (config._f === hooks.RFC_2822) {
        configFromRFC2822(config);
        return;
    }
    config._a = [];
    getParsingFlags(config).empty = true;

    // This array is used to make a Date, either with `new Date` or `Date.UTC`
    var string = '' + config._i,
        i, parsedInput, tokens, token, skipped,
        stringLength = string.length,
        totalParsedInputLength = 0;

    tokens = expandFormat(config._f, config._locale).match(formattingTokens) || [];

    for (i = 0; i < tokens.length; i++) {
        token = tokens[i];
        parsedInput = (string.match(getParseRegexForToken(token, config)) || [])[0];
        // console.log('token', token, 'parsedInput', parsedInput,
        //         'regex', getParseRegexForToken(token, config));
        if (parsedInput) {
            skipped = string.substr(0, string.indexOf(parsedInput));
            if (skipped.length > 0) {
                getParsingFlags(config).unusedInput.push(skipped);
            }
            string = string.slice(string.indexOf(parsedInput) + parsedInput.length);
            totalParsedInputLength += parsedInput.length;
        }
        // don't parse if it's not a known token
        if (formatTokenFunctions[token]) {
            if (parsedInput) {
                getParsingFlags(config).empty = false;
            }
            else {
                getParsingFlags(config).unusedTokens.push(token);
            }
            addTimeToArrayFromToken(token, parsedInput, config);
        }
        else if (config._strict && !parsedInput) {
            getParsingFlags(config).unusedTokens.push(token);
        }
    }

    // add remaining unparsed input length to the string
    getParsingFlags(config).charsLeftOver = stringLength - totalParsedInputLength;
    if (string.length > 0) {
        getParsingFlags(config).unusedInput.push(string);
    }

    // clear _12h flag if hour is <= 12
    if (config._a[HOUR] <= 12 &&
        getParsingFlags(config).bigHour === true &&
        config._a[HOUR] > 0) {
        getParsingFlags(config).bigHour = undefined;
    }

    getParsingFlags(config).parsedDateParts = config._a.slice(0);
    getParsingFlags(config).meridiem = config._meridiem;
    // handle meridiem
    config._a[HOUR] = meridiemFixWrap(config._locale, config._a[HOUR], config._meridiem);

    configFromArray(config);
    checkOverflow(config);
}


function meridiemFixWrap (locale, hour, meridiem) {
    var isPm;

    if (meridiem == null) {
        // nothing to do
        return hour;
    }
    if (locale.meridiemHour != null) {
        return locale.meridiemHour(hour, meridiem);
    } else if (locale.isPM != null) {
        // Fallback
        isPm = locale.isPM(meridiem);
        if (isPm && hour < 12) {
            hour += 12;
        }
        if (!isPm && hour === 12) {
            hour = 0;
        }
        return hour;
    } else {
        // this is not supposed to happen
        return hour;
    }
}

// date from string and array of format strings
function configFromStringAndArray(config) {
    var tempConfig,
        bestMoment,

        scoreToBeat,
        i,
        currentScore;

    if (config._f.length === 0) {
        getParsingFlags(config).invalidFormat = true;
        config._d = new Date(NaN);
        return;
    }

    for (i = 0; i < config._f.length; i++) {
        currentScore = 0;
        tempConfig = copyConfig({}, config);
        if (config._useUTC != null) {
            tempConfig._useUTC = config._useUTC;
        }
        tempConfig._f = config._f[i];
        configFromStringAndFormat(tempConfig);

        if (!isValid(tempConfig)) {
            continue;
        }

        // if there is any input that was not parsed add a penalty for that format
        currentScore += getParsingFlags(tempConfig).charsLeftOver;

        //or tokens
        currentScore += getParsingFlags(tempConfig).unusedTokens.length * 10;

        getParsingFlags(tempConfig).score = currentScore;

        if (scoreToBeat == null || currentScore < scoreToBeat) {
            scoreToBeat = currentScore;
            bestMoment = tempConfig;
        }
    }

    extend(config, bestMoment || tempConfig);
}

function configFromObject(config) {
    if (config._d) {
        return;
    }

    var i = normalizeObjectUnits(config._i);
    config._a = map([i.year, i.month, i.day || i.date, i.hour, i.minute, i.second, i.millisecond], function (obj) {
        return obj && parseInt(obj, 10);
    });

    configFromArray(config);
}

function createFromConfig (config) {
    var res = new Moment(checkOverflow(prepareConfig(config)));
    if (res._nextDay) {
        // Adding is smart enough around DST
        res.add(1, 'd');
        res._nextDay = undefined;
    }

    return res;
}

function prepareConfig (config) {
    var input = config._i,
        format = config._f;

    config._locale = config._locale || getLocale(config._l);

    if (input === null || (format === undefined && input === '')) {
        return createInvalid({nullInput: true});
    }

    if (typeof input === 'string') {
        config._i = input = config._locale.preparse(input);
    }

    if (isMoment(input)) {
        return new Moment(checkOverflow(input));
    } else if (isDate(input)) {
        config._d = input;
    } else if (isArray(format)) {
        configFromStringAndArray(config);
    } else if (format) {
        configFromStringAndFormat(config);
    }  else {
        configFromInput(config);
    }

    if (!isValid(config)) {
        config._d = null;
    }

    return config;
}

function configFromInput(config) {
    var input = config._i;
    if (isUndefined(input)) {
        config._d = new Date(hooks.now());
    } else if (isDate(input)) {
        config._d = new Date(input.valueOf());
    } else if (typeof input === 'string') {
        configFromString(config);
    } else if (isArray(input)) {
        config._a = map(input.slice(0), function (obj) {
            return parseInt(obj, 10);
        });
        configFromArray(config);
    } else if (isObject(input)) {
        configFromObject(config);
    } else if (isNumber(input)) {
        // from milliseconds
        config._d = new Date(input);
    } else {
        hooks.createFromInputFallback(config);
    }
}

function createLocalOrUTC (input, format, locale, strict, isUTC) {
    var c = {};

    if (locale === true || locale === false) {
        strict = locale;
        locale = undefined;
    }

    if ((isObject(input) && isObjectEmpty(input)) ||
            (isArray(input) && input.length === 0)) {
        input = undefined;
    }
    // object construction must be done this way.
    // https://github.com/moment/moment/issues/1423
    c._isAMomentObject = true;
    c._useUTC = c._isUTC = isUTC;
    c._l = locale;
    c._i = input;
    c._f = format;
    c._strict = strict;

    return createFromConfig(c);
}

function createLocal (input, format, locale, strict) {
    return createLocalOrUTC(input, format, locale, strict, false);
}

var prototypeMin = deprecate(
    'moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/',
    function () {
        var other = createLocal.apply(null, arguments);
        if (this.isValid() && other.isValid()) {
            return other < this ? this : other;
        } else {
            return createInvalid();
        }
    }
);

var prototypeMax = deprecate(
    'moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/',
    function () {
        var other = createLocal.apply(null, arguments);
        if (this.isValid() && other.isValid()) {
            return other > this ? this : other;
        } else {
            return createInvalid();
        }
    }
);

// Pick a moment m from moments so that m[fn](other) is true for all
// other. This relies on the function fn to be transitive.
//
// moments should either be an array of moment objects or an array, whose
// first element is an array of moment objects.
function pickBy(fn, moments) {
    var res, i;
    if (moments.length === 1 && isArray(moments[0])) {
        moments = moments[0];
    }
    if (!moments.length) {
        return createLocal();
    }
    res = moments[0];
    for (i = 1; i < moments.length; ++i) {
        if (!moments[i].isValid() || moments[i][fn](res)) {
            res = moments[i];
        }
    }
    return res;
}

// TODO: Use [].sort instead?
function min () {
    var args = [].slice.call(arguments, 0);

    return pickBy('isBefore', args);
}

function max () {
    var args = [].slice.call(arguments, 0);

    return pickBy('isAfter', args);
}

var now = function () {
    return Date.now ? Date.now() : +(new Date());
};

var ordering = ['year', 'quarter', 'month', 'week', 'day', 'hour', 'minute', 'second', 'millisecond'];

function isDurationValid(m) {
    for (var key in m) {
        if (!(ordering.indexOf(key) !== -1 && (m[key] == null || !isNaN(m[key])))) {
            return false;
        }
    }

    var unitHasDecimal = false;
    for (var i = 0; i < ordering.length; ++i) {
        if (m[ordering[i]]) {
            if (unitHasDecimal) {
                return false; // only allow non-integers for smallest unit
            }
            if (parseFloat(m[ordering[i]]) !== toInt(m[ordering[i]])) {
                unitHasDecimal = true;
            }
        }
    }

    return true;
}

function isValid$1() {
    return this._isValid;
}

function createInvalid$1() {
    return createDuration(NaN);
}

function Duration (duration) {
    var normalizedInput = normalizeObjectUnits(duration),
        years = normalizedInput.year || 0,
        quarters = normalizedInput.quarter || 0,
        months = normalizedInput.month || 0,
        weeks = normalizedInput.week || 0,
        days = normalizedInput.day || 0,
        hours = normalizedInput.hour || 0,
        minutes = normalizedInput.minute || 0,
        seconds = normalizedInput.second || 0,
        milliseconds = normalizedInput.millisecond || 0;

    this._isValid = isDurationValid(normalizedInput);

    // representation for dateAddRemove
    this._milliseconds = +milliseconds +
        seconds * 1e3 + // 1000
        minutes * 6e4 + // 1000 * 60
        hours * 1000 * 60 * 60; //using 1000 * 60 * 60 instead of 36e5 to avoid floating point rounding errors https://github.com/moment/moment/issues/2978
    // Because of dateAddRemove treats 24 hours as different from a
    // day when working around DST, we need to store them separately
    this._days = +days +
        weeks * 7;
    // It is impossible translate months into days without knowing
    // which months you are are talking about, so we have to store
    // it separately.
    this._months = +months +
        quarters * 3 +
        years * 12;

    this._data = {};

    this._locale = getLocale();

    this._bubble();
}

function isDuration (obj) {
    return obj instanceof Duration;
}

function absRound (number) {
    if (number < 0) {
        return Math.round(-1 * number) * -1;
    } else {
        return Math.round(number);
    }
}

// FORMATTING

function offset (token, separator) {
    addFormatToken(token, 0, 0, function () {
        var offset = this.utcOffset();
        var sign = '+';
        if (offset < 0) {
            offset = -offset;
            sign = '-';
        }
        return sign + zeroFill(~~(offset / 60), 2) + separator + zeroFill(~~(offset) % 60, 2);
    });
}

offset('Z', ':');
offset('ZZ', '');

// PARSING

addRegexToken('Z',  matchShortOffset);
addRegexToken('ZZ', matchShortOffset);
addParseToken(['Z', 'ZZ'], function (input, array, config) {
    config._useUTC = true;
    config._tzm = offsetFromString(matchShortOffset, input);
});

// HELPERS

// timezone chunker
// '+10:00' > ['10',  '00']
// '-1530'  > ['-15', '30']
var chunkOffset = /([\+\-]|\d\d)/gi;

function offsetFromString(matcher, string) {
    var matches = (string || '').match(matcher);

    if (matches === null) {
        return null;
    }

    var chunk   = matches[matches.length - 1] || [];
    var parts   = (chunk + '').match(chunkOffset) || ['-', 0, 0];
    var minutes = +(parts[1] * 60) + toInt(parts[2]);

    return minutes === 0 ?
      0 :
      parts[0] === '+' ? minutes : -minutes;
}

// Return a moment from input, that is local/utc/zone equivalent to model.
function cloneWithOffset(input, model) {
    var res, diff;
    if (model._isUTC) {
        res = model.clone();
        diff = (isMoment(input) || isDate(input) ? input.valueOf() : createLocal(input).valueOf()) - res.valueOf();
        // Use low-level api, because this fn is low-level api.
        res._d.setTime(res._d.valueOf() + diff);
        hooks.updateOffset(res, false);
        return res;
    } else {
        return createLocal(input).local();
    }
}

function getDateOffset (m) {
    // On Firefox.24 Date#getTimezoneOffset returns a floating point.
    // https://github.com/moment/moment/pull/1871
    return -Math.round(m._d.getTimezoneOffset() / 15) * 15;
}

// HOOKS

// This function will be called whenever a moment is mutated.
// It is intended to keep the offset in sync with the timezone.
hooks.updateOffset = function () {};

// MOMENTS

// keepLocalTime = true means only change the timezone, without
// affecting the local hour. So 5:31:26 +0300 --[utcOffset(2, true)]-->
// 5:31:26 +0200 It is possible that 5:31:26 doesn't exist with offset
// +0200, so we adjust the time as needed, to be valid.
//
// Keeping the time actually adds/subtracts (one hour)
// from the actual represented time. That is why we call updateOffset
// a second time. In case it wants us to change the offset again
// _changeInProgress == true case, then we have to adjust, because
// there is no such time in the given timezone.
function getSetOffset (input, keepLocalTime, keepMinutes) {
    var offset = this._offset || 0,
        localAdjust;
    if (!this.isValid()) {
        return input != null ? this : NaN;
    }
    if (input != null) {
        if (typeof input === 'string') {
            input = offsetFromString(matchShortOffset, input);
            if (input === null) {
                return this;
            }
        } else if (Math.abs(input) < 16 && !keepMinutes) {
            input = input * 60;
        }
        if (!this._isUTC && keepLocalTime) {
            localAdjust = getDateOffset(this);
        }
        this._offset = input;
        this._isUTC = true;
        if (localAdjust != null) {
            this.add(localAdjust, 'm');
        }
        if (offset !== input) {
            if (!keepLocalTime || this._changeInProgress) {
                addSubtract(this, createDuration(input - offset, 'm'), 1, false);
            } else if (!this._changeInProgress) {
                this._changeInProgress = true;
                hooks.updateOffset(this, true);
                this._changeInProgress = null;
            }
        }
        return this;
    } else {
        return this._isUTC ? offset : getDateOffset(this);
    }
}

function getSetZone (input, keepLocalTime) {
    if (input != null) {
        if (typeof input !== 'string') {
            input = -input;
        }

        this.utcOffset(input, keepLocalTime);

        return this;
    } else {
        return -this.utcOffset();
    }
}

function setOffsetToUTC (keepLocalTime) {
    return this.utcOffset(0, keepLocalTime);
}

function setOffsetToLocal (keepLocalTime) {
    if (this._isUTC) {
        this.utcOffset(0, keepLocalTime);
        this._isUTC = false;

        if (keepLocalTime) {
            this.subtract(getDateOffset(this), 'm');
        }
    }
    return this;
}

function setOffsetToParsedOffset () {
    if (this._tzm != null) {
        this.utcOffset(this._tzm, false, true);
    } else if (typeof this._i === 'string') {
        var tZone = offsetFromString(matchOffset, this._i);
        if (tZone != null) {
            this.utcOffset(tZone);
        }
        else {
            this.utcOffset(0, true);
        }
    }
    return this;
}

function hasAlignedHourOffset (input) {
    if (!this.isValid()) {
        return false;
    }
    input = input ? createLocal(input).utcOffset() : 0;

    return (this.utcOffset() - input) % 60 === 0;
}

function isDaylightSavingTime () {
    return (
        this.utcOffset() > this.clone().month(0).utcOffset() ||
        this.utcOffset() > this.clone().month(5).utcOffset()
    );
}

function isDaylightSavingTimeShifted () {
    if (!isUndefined(this._isDSTShifted)) {
        return this._isDSTShifted;
    }

    var c = {};

    copyConfig(c, this);
    c = prepareConfig(c);

    if (c._a) {
        var other = c._isUTC ? createUTC(c._a) : createLocal(c._a);
        this._isDSTShifted = this.isValid() &&
            compareArrays(c._a, other.toArray()) > 0;
    } else {
        this._isDSTShifted = false;
    }

    return this._isDSTShifted;
}

function isLocal () {
    return this.isValid() ? !this._isUTC : false;
}

function isUtcOffset () {
    return this.isValid() ? this._isUTC : false;
}

function isUtc () {
    return this.isValid() ? this._isUTC && this._offset === 0 : false;
}

// ASP.NET json date format regex
var aspNetRegex = /^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/;

// from http://docs.closure-library.googlecode.com/git/closure_goog_date_date.js.source.html
// somewhat more in line with 4.4.3.2 2004 spec, but allows decimal anywhere
// and further modified to allow for strings containing both week and day
var isoRegex = /^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;

function createDuration (input, key) {
    var duration = input,
        // matching against regexp is expensive, do it on demand
        match = null,
        sign,
        ret,
        diffRes;

    if (isDuration(input)) {
        duration = {
            ms : input._milliseconds,
            d  : input._days,
            M  : input._months
        };
    } else if (isNumber(input)) {
        duration = {};
        if (key) {
            duration[key] = input;
        } else {
            duration.milliseconds = input;
        }
    } else if (!!(match = aspNetRegex.exec(input))) {
        sign = (match[1] === '-') ? -1 : 1;
        duration = {
            y  : 0,
            d  : toInt(match[DATE])                         * sign,
            h  : toInt(match[HOUR])                         * sign,
            m  : toInt(match[MINUTE])                       * sign,
            s  : toInt(match[SECOND])                       * sign,
            ms : toInt(absRound(match[MILLISECOND] * 1000)) * sign // the millisecond decimal point is included in the match
        };
    } else if (!!(match = isoRegex.exec(input))) {
        sign = (match[1] === '-') ? -1 : 1;
        duration = {
            y : parseIso(match[2], sign),
            M : parseIso(match[3], sign),
            w : parseIso(match[4], sign),
            d : parseIso(match[5], sign),
            h : parseIso(match[6], sign),
            m : parseIso(match[7], sign),
            s : parseIso(match[8], sign)
        };
    } else if (duration == null) {// checks for null or undefined
        duration = {};
    } else if (typeof duration === 'object' && ('from' in duration || 'to' in duration)) {
        diffRes = momentsDifference(createLocal(duration.from), createLocal(duration.to));

        duration = {};
        duration.ms = diffRes.milliseconds;
        duration.M = diffRes.months;
    }

    ret = new Duration(duration);

    if (isDuration(input) && hasOwnProp(input, '_locale')) {
        ret._locale = input._locale;
    }

    return ret;
}

createDuration.fn = Duration.prototype;
createDuration.invalid = createInvalid$1;

function parseIso (inp, sign) {
    // We'd normally use ~~inp for this, but unfortunately it also
    // converts floats to ints.
    // inp may be undefined, so careful calling replace on it.
    var res = inp && parseFloat(inp.replace(',', '.'));
    // apply sign while we're at it
    return (isNaN(res) ? 0 : res) * sign;
}

function positiveMomentsDifference(base, other) {
    var res = {milliseconds: 0, months: 0};

    res.months = other.month() - base.month() +
        (other.year() - base.year()) * 12;
    if (base.clone().add(res.months, 'M').isAfter(other)) {
        --res.months;
    }

    res.milliseconds = +other - +(base.clone().add(res.months, 'M'));

    return res;
}

function momentsDifference(base, other) {
    var res;
    if (!(base.isValid() && other.isValid())) {
        return {milliseconds: 0, months: 0};
    }

    other = cloneWithOffset(other, base);
    if (base.isBefore(other)) {
        res = positiveMomentsDifference(base, other);
    } else {
        res = positiveMomentsDifference(other, base);
        res.milliseconds = -res.milliseconds;
        res.months = -res.months;
    }

    return res;
}

// TODO: remove 'name' arg after deprecation is removed
function createAdder(direction, name) {
    return function (val, period) {
        var dur, tmp;
        //invert the arguments, but complain about it
        if (period !== null && !isNaN(+period)) {
            deprecateSimple(name, 'moment().' + name  + '(period, number) is deprecated. Please use moment().' + name + '(number, period). ' +
            'See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.');
            tmp = val; val = period; period = tmp;
        }

        val = typeof val === 'string' ? +val : val;
        dur = createDuration(val, period);
        addSubtract(this, dur, direction);
        return this;
    };
}

function addSubtract (mom, duration, isAdding, updateOffset) {
    var milliseconds = duration._milliseconds,
        days = absRound(duration._days),
        months = absRound(duration._months);

    if (!mom.isValid()) {
        // No op
        return;
    }

    updateOffset = updateOffset == null ? true : updateOffset;

    if (milliseconds) {
        mom._d.setTime(mom._d.valueOf() + milliseconds * isAdding);
    }
    if (days) {
        set$1(mom, 'Date', get(mom, 'Date') + days * isAdding);
    }
    if (months) {
        setMonth(mom, get(mom, 'Month') + months * isAdding);
    }
    if (updateOffset) {
        hooks.updateOffset(mom, days || months);
    }
}

var add      = createAdder(1, 'add');
var subtract = createAdder(-1, 'subtract');

function getCalendarFormat(myMoment, now) {
    var diff = myMoment.diff(now, 'days', true);
    return diff < -6 ? 'sameElse' :
            diff < -1 ? 'lastWeek' :
            diff < 0 ? 'lastDay' :
            diff < 1 ? 'sameDay' :
            diff < 2 ? 'nextDay' :
            diff < 7 ? 'nextWeek' : 'sameElse';
}

function calendar$1 (time, formats) {
    // We want to compare the start of today, vs this.
    // Getting start-of-today depends on whether we're local/utc/offset or not.
    var now = time || createLocal(),
        sod = cloneWithOffset(now, this).startOf('day'),
        format = hooks.calendarFormat(this, sod) || 'sameElse';

    var output = formats && (isFunction(formats[format]) ? formats[format].call(this, now) : formats[format]);

    return this.format(output || this.localeData().calendar(format, this, createLocal(now)));
}

function clone () {
    return new Moment(this);
}

function isAfter (input, units) {
    var localInput = isMoment(input) ? input : createLocal(input);
    if (!(this.isValid() && localInput.isValid())) {
        return false;
    }
    units = normalizeUnits(!isUndefined(units) ? units : 'millisecond');
    if (units === 'millisecond') {
        return this.valueOf() > localInput.valueOf();
    } else {
        return localInput.valueOf() < this.clone().startOf(units).valueOf();
    }
}

function isBefore (input, units) {
    var localInput = isMoment(input) ? input : createLocal(input);
    if (!(this.isValid() && localInput.isValid())) {
        return false;
    }
    units = normalizeUnits(!isUndefined(units) ? units : 'millisecond');
    if (units === 'millisecond') {
        return this.valueOf() < localInput.valueOf();
    } else {
        return this.clone().endOf(units).valueOf() < localInput.valueOf();
    }
}

function isBetween (from, to, units, inclusivity) {
    inclusivity = inclusivity || '()';
    return (inclusivity[0] === '(' ? this.isAfter(from, units) : !this.isBefore(from, units)) &&
        (inclusivity[1] === ')' ? this.isBefore(to, units) : !this.isAfter(to, units));
}

function isSame (input, units) {
    var localInput = isMoment(input) ? input : createLocal(input),
        inputMs;
    if (!(this.isValid() && localInput.isValid())) {
        return false;
    }
    units = normalizeUnits(units || 'millisecond');
    if (units === 'millisecond') {
        return this.valueOf() === localInput.valueOf();
    } else {
        inputMs = localInput.valueOf();
        return this.clone().startOf(units).valueOf() <= inputMs && inputMs <= this.clone().endOf(units).valueOf();
    }
}

function isSameOrAfter (input, units) {
    return this.isSame(input, units) || this.isAfter(input,units);
}

function isSameOrBefore (input, units) {
    return this.isSame(input, units) || this.isBefore(input,units);
}

function diff (input, units, asFloat) {
    var that,
        zoneDelta,
        delta, output;

    if (!this.isValid()) {
        return NaN;
    }

    that = cloneWithOffset(input, this);

    if (!that.isValid()) {
        return NaN;
    }

    zoneDelta = (that.utcOffset() - this.utcOffset()) * 6e4;

    units = normalizeUnits(units);

    if (units === 'year' || units === 'month' || units === 'quarter') {
        output = monthDiff(this, that);
        if (units === 'quarter') {
            output = output / 3;
        } else if (units === 'year') {
            output = output / 12;
        }
    } else {
        delta = this - that;
        output = units === 'second' ? delta / 1e3 : // 1000
            units === 'minute' ? delta / 6e4 : // 1000 * 60
            units === 'hour' ? delta / 36e5 : // 1000 * 60 * 60
            units === 'day' ? (delta - zoneDelta) / 864e5 : // 1000 * 60 * 60 * 24, negate dst
            units === 'week' ? (delta - zoneDelta) / 6048e5 : // 1000 * 60 * 60 * 24 * 7, negate dst
            delta;
    }
    return asFloat ? output : absFloor(output);
}

function monthDiff (a, b) {
    // difference in months
    var wholeMonthDiff = ((b.year() - a.year()) * 12) + (b.month() - a.month()),
        // b is in (anchor - 1 month, anchor + 1 month)
        anchor = a.clone().add(wholeMonthDiff, 'months'),
        anchor2, adjust;

    if (b - anchor < 0) {
        anchor2 = a.clone().add(wholeMonthDiff - 1, 'months');
        // linear across the month
        adjust = (b - anchor) / (anchor - anchor2);
    } else {
        anchor2 = a.clone().add(wholeMonthDiff + 1, 'months');
        // linear across the month
        adjust = (b - anchor) / (anchor2 - anchor);
    }

    //check for negative zero, return zero if negative zero
    return -(wholeMonthDiff + adjust) || 0;
}

hooks.defaultFormat = 'YYYY-MM-DDTHH:mm:ssZ';
hooks.defaultFormatUtc = 'YYYY-MM-DDTHH:mm:ss[Z]';

function toString () {
    return this.clone().locale('en').format('ddd MMM DD YYYY HH:mm:ss [GMT]ZZ');
}

function toISOString() {
    if (!this.isValid()) {
        return null;
    }
    var m = this.clone().utc();
    if (m.year() < 0 || m.year() > 9999) {
        return formatMoment(m, 'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]');
    }
    if (isFunction(Date.prototype.toISOString)) {
        // native implementation is ~50x faster, use it when we can
        return this.toDate().toISOString();
    }
    return formatMoment(m, 'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]');
}

/**
 * Return a human readable representation of a moment that can
 * also be evaluated to get a new moment which is the same
 *
 * @link https://nodejs.org/dist/latest/docs/api/util.html#util_custom_inspect_function_on_objects
 */
function inspect () {
    if (!this.isValid()) {
        return 'moment.invalid(/* ' + this._i + ' */)';
    }
    var func = 'moment';
    var zone = '';
    if (!this.isLocal()) {
        func = this.utcOffset() === 0 ? 'moment.utc' : 'moment.parseZone';
        zone = 'Z';
    }
    var prefix = '[' + func + '("]';
    var year = (0 <= this.year() && this.year() <= 9999) ? 'YYYY' : 'YYYYYY';
    var datetime = '-MM-DD[T]HH:mm:ss.SSS';
    var suffix = zone + '[")]';

    return this.format(prefix + year + datetime + suffix);
}

function format (inputString) {
    if (!inputString) {
        inputString = this.isUtc() ? hooks.defaultFormatUtc : hooks.defaultFormat;
    }
    var output = formatMoment(this, inputString);
    return this.localeData().postformat(output);
}

function from (time, withoutSuffix) {
    if (this.isValid() &&
            ((isMoment(time) && time.isValid()) ||
             createLocal(time).isValid())) {
        return createDuration({to: this, from: time}).locale(this.locale()).humanize(!withoutSuffix);
    } else {
        return this.localeData().invalidDate();
    }
}

function fromNow (withoutSuffix) {
    return this.from(createLocal(), withoutSuffix);
}

function to (time, withoutSuffix) {
    if (this.isValid() &&
            ((isMoment(time) && time.isValid()) ||
             createLocal(time).isValid())) {
        return createDuration({from: this, to: time}).locale(this.locale()).humanize(!withoutSuffix);
    } else {
        return this.localeData().invalidDate();
    }
}

function toNow (withoutSuffix) {
    return this.to(createLocal(), withoutSuffix);
}

// If passed a locale key, it will set the locale for this
// instance.  Otherwise, it will return the locale configuration
// variables for this instance.
function locale (key) {
    var newLocaleData;

    if (key === undefined) {
        return this._locale._abbr;
    } else {
        newLocaleData = getLocale(key);
        if (newLocaleData != null) {
            this._locale = newLocaleData;
        }
        return this;
    }
}

var lang = deprecate(
    'moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.',
    function (key) {
        if (key === undefined) {
            return this.localeData();
        } else {
            return this.locale(key);
        }
    }
);

function localeData () {
    return this._locale;
}

function startOf (units) {
    units = normalizeUnits(units);
    // the following switch intentionally omits break keywords
    // to utilize falling through the cases.
    switch (units) {
        case 'year':
            this.month(0);
            /* falls through */
        case 'quarter':
        case 'month':
            this.date(1);
            /* falls through */
        case 'week':
        case 'isoWeek':
        case 'day':
        case 'date':
            this.hours(0);
            /* falls through */
        case 'hour':
            this.minutes(0);
            /* falls through */
        case 'minute':
            this.seconds(0);
            /* falls through */
        case 'second':
            this.milliseconds(0);
    }

    // weeks are a special case
    if (units === 'week') {
        this.weekday(0);
    }
    if (units === 'isoWeek') {
        this.isoWeekday(1);
    }

    // quarters are also special
    if (units === 'quarter') {
        this.month(Math.floor(this.month() / 3) * 3);
    }

    return this;
}

function endOf (units) {
    units = normalizeUnits(units);
    if (units === undefined || units === 'millisecond') {
        return this;
    }

    // 'date' is an alias for 'day', so it should be considered as such.
    if (units === 'date') {
        units = 'day';
    }

    return this.startOf(units).add(1, (units === 'isoWeek' ? 'week' : units)).subtract(1, 'ms');
}

function valueOf () {
    return this._d.valueOf() - ((this._offset || 0) * 60000);
}

function unix () {
    return Math.floor(this.valueOf() / 1000);
}

function toDate () {
    return new Date(this.valueOf());
}

function toArray () {
    var m = this;
    return [m.year(), m.month(), m.date(), m.hour(), m.minute(), m.second(), m.millisecond()];
}

function toObject () {
    var m = this;
    return {
        years: m.year(),
        months: m.month(),
        date: m.date(),
        hours: m.hours(),
        minutes: m.minutes(),
        seconds: m.seconds(),
        milliseconds: m.milliseconds()
    };
}

function toJSON () {
    // new Date(NaN).toJSON() === null
    return this.isValid() ? this.toISOString() : null;
}

function isValid$2 () {
    return isValid(this);
}

function parsingFlags () {
    return extend({}, getParsingFlags(this));
}

function invalidAt () {
    return getParsingFlags(this).overflow;
}

function creationData() {
    return {
        input: this._i,
        format: this._f,
        locale: this._locale,
        isUTC: this._isUTC,
        strict: this._strict
    };
}

// FORMATTING

addFormatToken(0, ['gg', 2], 0, function () {
    return this.weekYear() % 100;
});

addFormatToken(0, ['GG', 2], 0, function () {
    return this.isoWeekYear() % 100;
});

function addWeekYearFormatToken (token, getter) {
    addFormatToken(0, [token, token.length], 0, getter);
}

addWeekYearFormatToken('gggg',     'weekYear');
addWeekYearFormatToken('ggggg',    'weekYear');
addWeekYearFormatToken('GGGG',  'isoWeekYear');
addWeekYearFormatToken('GGGGG', 'isoWeekYear');

// ALIASES

addUnitAlias('weekYear', 'gg');
addUnitAlias('isoWeekYear', 'GG');

// PRIORITY

addUnitPriority('weekYear', 1);
addUnitPriority('isoWeekYear', 1);


// PARSING

addRegexToken('G',      matchSigned);
addRegexToken('g',      matchSigned);
addRegexToken('GG',     match1to2, match2);
addRegexToken('gg',     match1to2, match2);
addRegexToken('GGGG',   match1to4, match4);
addRegexToken('gggg',   match1to4, match4);
addRegexToken('GGGGG',  match1to6, match6);
addRegexToken('ggggg',  match1to6, match6);

addWeekParseToken(['gggg', 'ggggg', 'GGGG', 'GGGGG'], function (input, week, config, token) {
    week[token.substr(0, 2)] = toInt(input);
});

addWeekParseToken(['gg', 'GG'], function (input, week, config, token) {
    week[token] = hooks.parseTwoDigitYear(input);
});

// MOMENTS

function getSetWeekYear (input) {
    return getSetWeekYearHelper.call(this,
            input,
            this.week(),
            this.weekday(),
            this.localeData()._week.dow,
            this.localeData()._week.doy);
}

function getSetISOWeekYear (input) {
    return getSetWeekYearHelper.call(this,
            input, this.isoWeek(), this.isoWeekday(), 1, 4);
}

function getISOWeeksInYear () {
    return weeksInYear(this.year(), 1, 4);
}

function getWeeksInYear () {
    var weekInfo = this.localeData()._week;
    return weeksInYear(this.year(), weekInfo.dow, weekInfo.doy);
}

function getSetWeekYearHelper(input, week, weekday, dow, doy) {
    var weeksTarget;
    if (input == null) {
        return weekOfYear(this, dow, doy).year;
    } else {
        weeksTarget = weeksInYear(input, dow, doy);
        if (week > weeksTarget) {
            week = weeksTarget;
        }
        return setWeekAll.call(this, input, week, weekday, dow, doy);
    }
}

function setWeekAll(weekYear, week, weekday, dow, doy) {
    var dayOfYearData = dayOfYearFromWeeks(weekYear, week, weekday, dow, doy),
        date = createUTCDate(dayOfYearData.year, 0, dayOfYearData.dayOfYear);

    this.year(date.getUTCFullYear());
    this.month(date.getUTCMonth());
    this.date(date.getUTCDate());
    return this;
}

// FORMATTING

addFormatToken('Q', 0, 'Qo', 'quarter');

// ALIASES

addUnitAlias('quarter', 'Q');

// PRIORITY

addUnitPriority('quarter', 7);

// PARSING

addRegexToken('Q', match1);
addParseToken('Q', function (input, array) {
    array[MONTH] = (toInt(input) - 1) * 3;
});

// MOMENTS

function getSetQuarter (input) {
    return input == null ? Math.ceil((this.month() + 1) / 3) : this.month((input - 1) * 3 + this.month() % 3);
}

// FORMATTING

addFormatToken('D', ['DD', 2], 'Do', 'date');

// ALIASES

addUnitAlias('date', 'D');

// PRIOROITY
addUnitPriority('date', 9);

// PARSING

addRegexToken('D',  match1to2);
addRegexToken('DD', match1to2, match2);
addRegexToken('Do', function (isStrict, locale) {
    // TODO: Remove "ordinalParse" fallback in next major release.
    return isStrict ?
      (locale._dayOfMonthOrdinalParse || locale._ordinalParse) :
      locale._dayOfMonthOrdinalParseLenient;
});

addParseToken(['D', 'DD'], DATE);
addParseToken('Do', function (input, array) {
    array[DATE] = toInt(input.match(match1to2)[0], 10);
});

// MOMENTS

var getSetDayOfMonth = makeGetSet('Date', true);

// FORMATTING

addFormatToken('DDD', ['DDDD', 3], 'DDDo', 'dayOfYear');

// ALIASES

addUnitAlias('dayOfYear', 'DDD');

// PRIORITY
addUnitPriority('dayOfYear', 4);

// PARSING

addRegexToken('DDD',  match1to3);
addRegexToken('DDDD', match3);
addParseToken(['DDD', 'DDDD'], function (input, array, config) {
    config._dayOfYear = toInt(input);
});

// HELPERS

// MOMENTS

function getSetDayOfYear (input) {
    var dayOfYear = Math.round((this.clone().startOf('day') - this.clone().startOf('year')) / 864e5) + 1;
    return input == null ? dayOfYear : this.add((input - dayOfYear), 'd');
}

// FORMATTING

addFormatToken('m', ['mm', 2], 0, 'minute');

// ALIASES

addUnitAlias('minute', 'm');

// PRIORITY

addUnitPriority('minute', 14);

// PARSING

addRegexToken('m',  match1to2);
addRegexToken('mm', match1to2, match2);
addParseToken(['m', 'mm'], MINUTE);

// MOMENTS

var getSetMinute = makeGetSet('Minutes', false);

// FORMATTING

addFormatToken('s', ['ss', 2], 0, 'second');

// ALIASES

addUnitAlias('second', 's');

// PRIORITY

addUnitPriority('second', 15);

// PARSING

addRegexToken('s',  match1to2);
addRegexToken('ss', match1to2, match2);
addParseToken(['s', 'ss'], SECOND);

// MOMENTS

var getSetSecond = makeGetSet('Seconds', false);

// FORMATTING

addFormatToken('S', 0, 0, function () {
    return ~~(this.millisecond() / 100);
});

addFormatToken(0, ['SS', 2], 0, function () {
    return ~~(this.millisecond() / 10);
});

addFormatToken(0, ['SSS', 3], 0, 'millisecond');
addFormatToken(0, ['SSSS', 4], 0, function () {
    return this.millisecond() * 10;
});
addFormatToken(0, ['SSSSS', 5], 0, function () {
    return this.millisecond() * 100;
});
addFormatToken(0, ['SSSSSS', 6], 0, function () {
    return this.millisecond() * 1000;
});
addFormatToken(0, ['SSSSSSS', 7], 0, function () {
    return this.millisecond() * 10000;
});
addFormatToken(0, ['SSSSSSSS', 8], 0, function () {
    return this.millisecond() * 100000;
});
addFormatToken(0, ['SSSSSSSSS', 9], 0, function () {
    return this.millisecond() * 1000000;
});


// ALIASES

addUnitAlias('millisecond', 'ms');

// PRIORITY

addUnitPriority('millisecond', 16);

// PARSING

addRegexToken('S',    match1to3, match1);
addRegexToken('SS',   match1to3, match2);
addRegexToken('SSS',  match1to3, match3);

var token;
for (token = 'SSSS'; token.length <= 9; token += 'S') {
    addRegexToken(token, matchUnsigned);
}

function parseMs(input, array) {
    array[MILLISECOND] = toInt(('0.' + input) * 1000);
}

for (token = 'S'; token.length <= 9; token += 'S') {
    addParseToken(token, parseMs);
}
// MOMENTS

var getSetMillisecond = makeGetSet('Milliseconds', false);

// FORMATTING

addFormatToken('z',  0, 0, 'zoneAbbr');
addFormatToken('zz', 0, 0, 'zoneName');

// MOMENTS

function getZoneAbbr () {
    return this._isUTC ? 'UTC' : '';
}

function getZoneName () {
    return this._isUTC ? 'Coordinated Universal Time' : '';
}

var proto = Moment.prototype;

proto.add               = add;
proto.calendar          = calendar$1;
proto.clone             = clone;
proto.diff              = diff;
proto.endOf             = endOf;
proto.format            = format;
proto.from              = from;
proto.fromNow           = fromNow;
proto.to                = to;
proto.toNow             = toNow;
proto.get               = stringGet;
proto.invalidAt         = invalidAt;
proto.isAfter           = isAfter;
proto.isBefore          = isBefore;
proto.isBetween         = isBetween;
proto.isSame            = isSame;
proto.isSameOrAfter     = isSameOrAfter;
proto.isSameOrBefore    = isSameOrBefore;
proto.isValid           = isValid$2;
proto.lang              = lang;
proto.locale            = locale;
proto.localeData        = localeData;
proto.max               = prototypeMax;
proto.min               = prototypeMin;
proto.parsingFlags      = parsingFlags;
proto.set               = stringSet;
proto.startOf           = startOf;
proto.subtract          = subtract;
proto.toArray           = toArray;
proto.toObject          = toObject;
proto.toDate            = toDate;
proto.toISOString       = toISOString;
proto.inspect           = inspect;
proto.toJSON            = toJSON;
proto.toString          = toString;
proto.unix              = unix;
proto.valueOf           = valueOf;
proto.creationData      = creationData;

// Year
proto.year       = getSetYear;
proto.isLeapYear = getIsLeapYear;

// Week Year
proto.weekYear    = getSetWeekYear;
proto.isoWeekYear = getSetISOWeekYear;

// Quarter
proto.quarter = proto.quarters = getSetQuarter;

// Month
proto.month       = getSetMonth;
proto.daysInMonth = getDaysInMonth;

// Week
proto.week           = proto.weeks        = getSetWeek;
proto.isoWeek        = proto.isoWeeks     = getSetISOWeek;
proto.weeksInYear    = getWeeksInYear;
proto.isoWeeksInYear = getISOWeeksInYear;

// Day
proto.date       = getSetDayOfMonth;
proto.day        = proto.days             = getSetDayOfWeek;
proto.weekday    = getSetLocaleDayOfWeek;
proto.isoWeekday = getSetISODayOfWeek;
proto.dayOfYear  = getSetDayOfYear;

// Hour
proto.hour = proto.hours = getSetHour;

// Minute
proto.minute = proto.minutes = getSetMinute;

// Second
proto.second = proto.seconds = getSetSecond;

// Millisecond
proto.millisecond = proto.milliseconds = getSetMillisecond;

// Offset
proto.utcOffset            = getSetOffset;
proto.utc                  = setOffsetToUTC;
proto.local                = setOffsetToLocal;
proto.parseZone            = setOffsetToParsedOffset;
proto.hasAlignedHourOffset = hasAlignedHourOffset;
proto.isDST                = isDaylightSavingTime;
proto.isLocal              = isLocal;
proto.isUtcOffset          = isUtcOffset;
proto.isUtc                = isUtc;
proto.isUTC                = isUtc;

// Timezone
proto.zoneAbbr = getZoneAbbr;
proto.zoneName = getZoneName;

// Deprecations
proto.dates  = deprecate('dates accessor is deprecated. Use date instead.', getSetDayOfMonth);
proto.months = deprecate('months accessor is deprecated. Use month instead', getSetMonth);
proto.years  = deprecate('years accessor is deprecated. Use year instead', getSetYear);
proto.zone   = deprecate('moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/', getSetZone);
proto.isDSTShifted = deprecate('isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information', isDaylightSavingTimeShifted);

function createUnix (input) {
    return createLocal(input * 1000);
}

function createInZone () {
    return createLocal.apply(null, arguments).parseZone();
}

function preParsePostFormat (string) {
    return string;
}

var proto$1 = Locale.prototype;

proto$1.calendar        = calendar;
proto$1.longDateFormat  = longDateFormat;
proto$1.invalidDate     = invalidDate;
proto$1.ordinal         = ordinal;
proto$1.preparse        = preParsePostFormat;
proto$1.postformat      = preParsePostFormat;
proto$1.relativeTime    = relativeTime;
proto$1.pastFuture      = pastFuture;
proto$1.set             = set;

// Month
proto$1.months            =        localeMonths;
proto$1.monthsShort       =        localeMonthsShort;
proto$1.monthsParse       =        localeMonthsParse;
proto$1.monthsRegex       = monthsRegex;
proto$1.monthsShortRegex  = monthsShortRegex;

// Week
proto$1.week = localeWeek;
proto$1.firstDayOfYear = localeFirstDayOfYear;
proto$1.firstDayOfWeek = localeFirstDayOfWeek;

// Day of Week
proto$1.weekdays       =        localeWeekdays;
proto$1.weekdaysMin    =        localeWeekdaysMin;
proto$1.weekdaysShort  =        localeWeekdaysShort;
proto$1.weekdaysParse  =        localeWeekdaysParse;

proto$1.weekdaysRegex       =        weekdaysRegex;
proto$1.weekdaysShortRegex  =        weekdaysShortRegex;
proto$1.weekdaysMinRegex    =        weekdaysMinRegex;

// Hours
proto$1.isPM = localeIsPM;
proto$1.meridiem = localeMeridiem;

function get$1 (format, index, field, setter) {
    var locale = getLocale();
    var utc = createUTC().set(setter, index);
    return locale[field](utc, format);
}

function listMonthsImpl (format, index, field) {
    if (isNumber(format)) {
        index = format;
        format = undefined;
    }

    format = format || '';

    if (index != null) {
        return get$1(format, index, field, 'month');
    }

    var i;
    var out = [];
    for (i = 0; i < 12; i++) {
        out[i] = get$1(format, i, field, 'month');
    }
    return out;
}

// ()
// (5)
// (fmt, 5)
// (fmt)
// (true)
// (true, 5)
// (true, fmt, 5)
// (true, fmt)
function listWeekdaysImpl (localeSorted, format, index, field) {
    if (typeof localeSorted === 'boolean') {
        if (isNumber(format)) {
            index = format;
            format = undefined;
        }

        format = format || '';
    } else {
        format = localeSorted;
        index = format;
        localeSorted = false;

        if (isNumber(format)) {
            index = format;
            format = undefined;
        }

        format = format || '';
    }

    var locale = getLocale(),
        shift = localeSorted ? locale._week.dow : 0;

    if (index != null) {
        return get$1(format, (index + shift) % 7, field, 'day');
    }

    var i;
    var out = [];
    for (i = 0; i < 7; i++) {
        out[i] = get$1(format, (i + shift) % 7, field, 'day');
    }
    return out;
}

function listMonths (format, index) {
    return listMonthsImpl(format, index, 'months');
}

function listMonthsShort (format, index) {
    return listMonthsImpl(format, index, 'monthsShort');
}

function listWeekdays (localeSorted, format, index) {
    return listWeekdaysImpl(localeSorted, format, index, 'weekdays');
}

function listWeekdaysShort (localeSorted, format, index) {
    return listWeekdaysImpl(localeSorted, format, index, 'weekdaysShort');
}

function listWeekdaysMin (localeSorted, format, index) {
    return listWeekdaysImpl(localeSorted, format, index, 'weekdaysMin');
}

getSetGlobalLocale('en', {
    dayOfMonthOrdinalParse: /\d{1,2}(th|st|nd|rd)/,
    ordinal : function (number) {
        var b = number % 10,
            output = (toInt(number % 100 / 10) === 1) ? 'th' :
            (b === 1) ? 'st' :
            (b === 2) ? 'nd' :
            (b === 3) ? 'rd' : 'th';
        return number + output;
    }
});

// Side effect imports
hooks.lang = deprecate('moment.lang is deprecated. Use moment.locale instead.', getSetGlobalLocale);
hooks.langData = deprecate('moment.langData is deprecated. Use moment.localeData instead.', getLocale);

var mathAbs = Math.abs;

function abs () {
    var data           = this._data;

    this._milliseconds = mathAbs(this._milliseconds);
    this._days         = mathAbs(this._days);
    this._months       = mathAbs(this._months);

    data.milliseconds  = mathAbs(data.milliseconds);
    data.seconds       = mathAbs(data.seconds);
    data.minutes       = mathAbs(data.minutes);
    data.hours         = mathAbs(data.hours);
    data.months        = mathAbs(data.months);
    data.years         = mathAbs(data.years);

    return this;
}

function addSubtract$1 (duration, input, value, direction) {
    var other = createDuration(input, value);

    duration._milliseconds += direction * other._milliseconds;
    duration._days         += direction * other._days;
    duration._months       += direction * other._months;

    return duration._bubble();
}

// supports only 2.0-style add(1, 's') or add(duration)
function add$1 (input, value) {
    return addSubtract$1(this, input, value, 1);
}

// supports only 2.0-style subtract(1, 's') or subtract(duration)
function subtract$1 (input, value) {
    return addSubtract$1(this, input, value, -1);
}

function absCeil (number) {
    if (number < 0) {
        return Math.floor(number);
    } else {
        return Math.ceil(number);
    }
}

function bubble () {
    var milliseconds = this._milliseconds;
    var days         = this._days;
    var months       = this._months;
    var data         = this._data;
    var seconds, minutes, hours, years, monthsFromDays;

    // if we have a mix of positive and negative values, bubble down first
    // check: https://github.com/moment/moment/issues/2166
    if (!((milliseconds >= 0 && days >= 0 && months >= 0) ||
            (milliseconds <= 0 && days <= 0 && months <= 0))) {
        milliseconds += absCeil(monthsToDays(months) + days) * 864e5;
        days = 0;
        months = 0;
    }

    // The following code bubbles up values, see the tests for
    // examples of what that means.
    data.milliseconds = milliseconds % 1000;

    seconds           = absFloor(milliseconds / 1000);
    data.seconds      = seconds % 60;

    minutes           = absFloor(seconds / 60);
    data.minutes      = minutes % 60;

    hours             = absFloor(minutes / 60);
    data.hours        = hours % 24;

    days += absFloor(hours / 24);

    // convert days to months
    monthsFromDays = absFloor(daysToMonths(days));
    months += monthsFromDays;
    days -= absCeil(monthsToDays(monthsFromDays));

    // 12 months -> 1 year
    years = absFloor(months / 12);
    months %= 12;

    data.days   = days;
    data.months = months;
    data.years  = years;

    return this;
}

function daysToMonths (days) {
    // 400 years have 146097 days (taking into account leap year rules)
    // 400 years have 12 months === 4800
    return days * 4800 / 146097;
}

function monthsToDays (months) {
    // the reverse of daysToMonths
    return months * 146097 / 4800;
}

function as (units) {
    if (!this.isValid()) {
        return NaN;
    }
    var days;
    var months;
    var milliseconds = this._milliseconds;

    units = normalizeUnits(units);

    if (units === 'month' || units === 'year') {
        days   = this._days   + milliseconds / 864e5;
        months = this._months + daysToMonths(days);
        return units === 'month' ? months : months / 12;
    } else {
        // handle milliseconds separately because of floating point math errors (issue #1867)
        days = this._days + Math.round(monthsToDays(this._months));
        switch (units) {
            case 'week'   : return days / 7     + milliseconds / 6048e5;
            case 'day'    : return days         + milliseconds / 864e5;
            case 'hour'   : return days * 24    + milliseconds / 36e5;
            case 'minute' : return days * 1440  + milliseconds / 6e4;
            case 'second' : return days * 86400 + milliseconds / 1000;
            // Math.floor prevents floating point math errors here
            case 'millisecond': return Math.floor(days * 864e5) + milliseconds;
            default: throw new Error('Unknown unit ' + units);
        }
    }
}

// TODO: Use this.as('ms')?
function valueOf$1 () {
    if (!this.isValid()) {
        return NaN;
    }
    return (
        this._milliseconds +
        this._days * 864e5 +
        (this._months % 12) * 2592e6 +
        toInt(this._months / 12) * 31536e6
    );
}

function makeAs (alias) {
    return function () {
        return this.as(alias);
    };
}

var asMilliseconds = makeAs('ms');
var asSeconds      = makeAs('s');
var asMinutes      = makeAs('m');
var asHours        = makeAs('h');
var asDays         = makeAs('d');
var asWeeks        = makeAs('w');
var asMonths       = makeAs('M');
var asYears        = makeAs('y');

function get$2 (units) {
    units = normalizeUnits(units);
    return this.isValid() ? this[units + 's']() : NaN;
}

function makeGetter(name) {
    return function () {
        return this.isValid() ? this._data[name] : NaN;
    };
}

var milliseconds = makeGetter('milliseconds');
var seconds      = makeGetter('seconds');
var minutes      = makeGetter('minutes');
var hours        = makeGetter('hours');
var days         = makeGetter('days');
var months       = makeGetter('months');
var years        = makeGetter('years');

function weeks () {
    return absFloor(this.days() / 7);
}

var round = Math.round;
var thresholds = {
    ss: 44,         // a few seconds to seconds
    s : 45,         // seconds to minute
    m : 45,         // minutes to hour
    h : 22,         // hours to day
    d : 26,         // days to month
    M : 11          // months to year
};

// helper function for moment.fn.from, moment.fn.fromNow, and moment.duration.fn.humanize
function substituteTimeAgo(string, number, withoutSuffix, isFuture, locale) {
    return locale.relativeTime(number || 1, !!withoutSuffix, string, isFuture);
}

function relativeTime$1 (posNegDuration, withoutSuffix, locale) {
    var duration = createDuration(posNegDuration).abs();
    var seconds  = round(duration.as('s'));
    var minutes  = round(duration.as('m'));
    var hours    = round(duration.as('h'));
    var days     = round(duration.as('d'));
    var months   = round(duration.as('M'));
    var years    = round(duration.as('y'));

    var a = seconds <= thresholds.ss && ['s', seconds]  ||
            seconds < thresholds.s   && ['ss', seconds] ||
            minutes <= 1             && ['m']           ||
            minutes < thresholds.m   && ['mm', minutes] ||
            hours   <= 1             && ['h']           ||
            hours   < thresholds.h   && ['hh', hours]   ||
            days    <= 1             && ['d']           ||
            days    < thresholds.d   && ['dd', days]    ||
            months  <= 1             && ['M']           ||
            months  < thresholds.M   && ['MM', months]  ||
            years   <= 1             && ['y']           || ['yy', years];

    a[2] = withoutSuffix;
    a[3] = +posNegDuration > 0;
    a[4] = locale;
    return substituteTimeAgo.apply(null, a);
}

// This function allows you to set the rounding function for relative time strings
function getSetRelativeTimeRounding (roundingFunction) {
    if (roundingFunction === undefined) {
        return round;
    }
    if (typeof(roundingFunction) === 'function') {
        round = roundingFunction;
        return true;
    }
    return false;
}

// This function allows you to set a threshold for relative time strings
function getSetRelativeTimeThreshold (threshold, limit) {
    if (thresholds[threshold] === undefined) {
        return false;
    }
    if (limit === undefined) {
        return thresholds[threshold];
    }
    thresholds[threshold] = limit;
    if (threshold === 's') {
        thresholds.ss = limit - 1;
    }
    return true;
}

function humanize (withSuffix) {
    if (!this.isValid()) {
        return this.localeData().invalidDate();
    }

    var locale = this.localeData();
    var output = relativeTime$1(this, !withSuffix, locale);

    if (withSuffix) {
        output = locale.pastFuture(+this, output);
    }

    return locale.postformat(output);
}

var abs$1 = Math.abs;

function toISOString$1() {
    // for ISO strings we do not use the normal bubbling rules:
    //  * milliseconds bubble up until they become hours
    //  * days do not bubble at all
    //  * months bubble up until they become years
    // This is because there is no context-free conversion between hours and days
    // (think of clock changes)
    // and also not between days and months (28-31 days per month)
    if (!this.isValid()) {
        return this.localeData().invalidDate();
    }

    var seconds = abs$1(this._milliseconds) / 1000;
    var days         = abs$1(this._days);
    var months       = abs$1(this._months);
    var minutes, hours, years;

    // 3600 seconds -> 60 minutes -> 1 hour
    minutes           = absFloor(seconds / 60);
    hours             = absFloor(minutes / 60);
    seconds %= 60;
    minutes %= 60;

    // 12 months -> 1 year
    years  = absFloor(months / 12);
    months %= 12;


    // inspired by https://github.com/dordille/moment-isoduration/blob/master/moment.isoduration.js
    var Y = years;
    var M = months;
    var D = days;
    var h = hours;
    var m = minutes;
    var s = seconds;
    var total = this.asSeconds();

    if (!total) {
        // this is the same as C#'s (Noda) and python (isodate)...
        // but not other JS (goog.date)
        return 'P0D';
    }

    return (total < 0 ? '-' : '') +
        'P' +
        (Y ? Y + 'Y' : '') +
        (M ? M + 'M' : '') +
        (D ? D + 'D' : '') +
        ((h || m || s) ? 'T' : '') +
        (h ? h + 'H' : '') +
        (m ? m + 'M' : '') +
        (s ? s + 'S' : '');
}

var proto$2 = Duration.prototype;

proto$2.isValid        = isValid$1;
proto$2.abs            = abs;
proto$2.add            = add$1;
proto$2.subtract       = subtract$1;
proto$2.as             = as;
proto$2.asMilliseconds = asMilliseconds;
proto$2.asSeconds      = asSeconds;
proto$2.asMinutes      = asMinutes;
proto$2.asHours        = asHours;
proto$2.asDays         = asDays;
proto$2.asWeeks        = asWeeks;
proto$2.asMonths       = asMonths;
proto$2.asYears        = asYears;
proto$2.valueOf        = valueOf$1;
proto$2._bubble        = bubble;
proto$2.get            = get$2;
proto$2.milliseconds   = milliseconds;
proto$2.seconds        = seconds;
proto$2.minutes        = minutes;
proto$2.hours          = hours;
proto$2.days           = days;
proto$2.weeks          = weeks;
proto$2.months         = months;
proto$2.years          = years;
proto$2.humanize       = humanize;
proto$2.toISOString    = toISOString$1;
proto$2.toString       = toISOString$1;
proto$2.toJSON         = toISOString$1;
proto$2.locale         = locale;
proto$2.localeData     = localeData;

// Deprecations
proto$2.toIsoString = deprecate('toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)', toISOString$1);
proto$2.lang = lang;

// Side effect imports

// FORMATTING

addFormatToken('X', 0, 0, 'unix');
addFormatToken('x', 0, 0, 'valueOf');

// PARSING

addRegexToken('x', matchSigned);
addRegexToken('X', matchTimestamp);
addParseToken('X', function (input, array, config) {
    config._d = new Date(parseFloat(input, 10) * 1000);
});
addParseToken('x', function (input, array, config) {
    config._d = new Date(toInt(input));
});

// Side effect imports


hooks.version = '2.18.1';

setHookCallback(createLocal);

hooks.fn                    = proto;
hooks.min                   = min;
hooks.max                   = max;
hooks.now                   = now;
hooks.utc                   = createUTC;
hooks.unix                  = createUnix;
hooks.months                = listMonths;
hooks.isDate                = isDate;
hooks.locale                = getSetGlobalLocale;
hooks.invalid               = createInvalid;
hooks.duration              = createDuration;
hooks.isMoment              = isMoment;
hooks.weekdays              = listWeekdays;
hooks.parseZone             = createInZone;
hooks.localeData            = getLocale;
hooks.isDuration            = isDuration;
hooks.monthsShort           = listMonthsShort;
hooks.weekdaysMin           = listWeekdaysMin;
hooks.defineLocale          = defineLocale;
hooks.updateLocale          = updateLocale;
hooks.locales               = listLocales;
hooks.weekdaysShort         = listWeekdaysShort;
hooks.normalizeUnits        = normalizeUnits;
hooks.relativeTimeRounding = getSetRelativeTimeRounding;
hooks.relativeTimeThreshold = getSetRelativeTimeThreshold;
hooks.calendarFormat        = getCalendarFormat;
hooks.prototype             = proto;

return hooks;

})));

},{}],"numbro":[function(_dereq_,module,exports){
/*!
 * numbro.js
 * version : 1.10.1
 * author : FÃ¶retagsplatsen AB
 * license : MIT
 * http://www.foretagsplatsen.se
 */

(function () {
    'use strict';

    /************************************
        Constants
    ************************************/

    var numbro,
        VERSION = '1.10.1',
        binarySuffixes = ['B', 'KiB', 'MiB', 'GiB', 'TiB', 'PiB', 'EiB', 'ZiB', 'YiB'],
        decimalSuffixes = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'],
        bytes = {
            general: { scale: 1024, suffixes: decimalSuffixes, marker: 'bd' },
            binary:  { scale: 1024, suffixes: binarySuffixes, marker: 'b' },
            decimal: { scale: 1000, suffixes: decimalSuffixes, marker: 'd' }
        },
        // general must be before the others because it reuses their characters!
        byteFormatOrder = [ bytes.general, bytes.binary, bytes.decimal ],
    // internal storage for culture config files
        cultures = {},
    // Todo: Remove in 2.0.0
        languages = cultures,
        currentCulture = 'en-US',
        zeroFormat = null,
        defaultFormat = '0,0',
        defaultCurrencyFormat = '0$',
        // check for nodeJS
        hasModule = (typeof module !== 'undefined' && module.exports),
    // default culture
        enUS = {
            delimiters: {
                thousands: ',',
                decimal: '.'
            },
            abbreviations: {
                thousand: 'k',
                million: 'm',
                billion: 'b',
                trillion: 't'
            },
            ordinal: function(number) {
                var b = number % 10;
                return (~~(number % 100 / 10) === 1) ? 'th' :
                    (b === 1) ? 'st' :
                        (b === 2) ? 'nd' :
                            (b === 3) ? 'rd' : 'th';
            },
            currency: {
                symbol: '$',
                position: 'prefix'
            },
            defaults: {
                currencyFormat: ',0000 a'
            },
            formats: {
                fourDigits: '0000 a',
                fullWithTwoDecimals: '$ ,0.00',
                fullWithTwoDecimalsNoCurrency: ',0.00'
            }
        };

    /************************************
        Constructors
    ************************************/


    // Numbro prototype object
    function Numbro(number) {
        this._value = number;
    }

    function numberLength(number) {
        if (number === 0) { return 1; }
        return Math.floor(Math.log(Math.abs(number)) / Math.LN10) + 1;
    }

    function zeroes(count) {
        var i, ret = '';

        for (i = 0; i < count; i++) {
            ret += '0';
        }

        return ret;
    }
    /**
     * Implementation of toFixed() for numbers with exponents
     * This function may return negative representations for zero values e.g. "-0.0"
     */
    function toFixedLargeSmall(value, precision) {
        var mantissa,
            beforeDec,
            afterDec,
            exponent,
            prefix,
            endStr,
            zerosStr,
            str;

        str = value.toString();

        mantissa = str.split('e')[0];
        exponent = str.split('e')[1];

        beforeDec = mantissa.split('.')[0];
        afterDec = mantissa.split('.')[1] || '';

        if (+exponent > 0) {
            // exponent is positive - add zeros after the numbers
            str = beforeDec + afterDec + zeroes(exponent - afterDec.length);
        } else {
            // exponent is negative

            if (+beforeDec < 0) {
                prefix = '-0';
            } else {
                prefix = '0';
            }

            // tack on the decimal point if needed
            if (precision > 0) {
                prefix += '.';
            }

            zerosStr = zeroes((-1 * exponent) - 1);
            // substring off the end to satisfy the precision
            endStr = (zerosStr + Math.abs(beforeDec) + afterDec).substr(0, precision);
            str = prefix + endStr;
        }

        // only add percision 0's if the exponent is positive
        if (+exponent > 0 && precision > 0) {
            str += '.' + zeroes(precision);
        }

        return str;
    }

    /**
     * Implementation of toFixed() that treats floats more like decimals
     *
     * Fixes binary rounding issues (eg. (0.615).toFixed(2) === '0.61') that present
     * problems for accounting- and finance-related software.
     *
     * Also removes negative signs for zero-formatted numbers. e.g. -0.01 w/ precision 1 -> 0.0
     */
    function toFixed(value, precision, roundingFunction, optionals) {
        var power = Math.pow(10, precision),
            optionalsRegExp,
            output;

        if (value.toString().indexOf('e') > -1) {
            // toFixed returns scientific notation for numbers above 1e21 and below 1e-7
            output = toFixedLargeSmall(value, precision);
            // remove the leading negative sign if it exists and should not be present (e.g. -0.00)
            if (output.charAt(0) === '-' && +output >= 0) {
                output = output.substr(1); // chop off the '-'
            }
        }
        else {
            // Multiply up by precision, round accurately, then divide and use native toFixed():
            output = (roundingFunction(value + 'e+' + precision) / power).toFixed(precision);
        }

        if (optionals) {
            optionalsRegExp = new RegExp('0{1,' + optionals + '}$');
            output = output.replace(optionalsRegExp, '');
        }

        return output;
    }

    /************************************
        Formatting
    ************************************/

    // determine what type of formatting we need to do
    function formatNumbro(n, format, roundingFunction) {
        var output,
            escapedFormat = format.replace(/\{[^\{\}]*\}/g, '');

        // figure out what kind of format we are dealing with
        if (escapedFormat.indexOf('$') > -1) { // currency!!!!!
            output = formatCurrency(n, cultures[currentCulture].currency.symbol, format, roundingFunction);
        } else if (escapedFormat.indexOf('%') > -1) { // percentage
            output = formatPercentage(n, format, roundingFunction);
        } else if (escapedFormat.indexOf(':') > -1) { // time
            output = formatTime(n, format);
        } else { // plain ol' numbers or bytes
            output = formatNumber(n._value, format, roundingFunction);
        }

        // return string
        return output;
    }

    // revert to number
    function unformatNumbro(n, string) {
        var stringOriginal = string,
            thousandRegExp,
            millionRegExp,
            billionRegExp,
            trillionRegExp,
            bytesMultiplier = false,
            power;

        if (string.indexOf(':') > -1) {
            n._value = unformatTime(string);
        } else {
            if (string === zeroFormat) {
                n._value = 0;
            } else {
                if (cultures[currentCulture].delimiters.decimal !== '.') {
                    string = string.replace(/\./g, '').replace(cultures[currentCulture].delimiters.decimal, '.');
                }

                // see if abbreviations are there so that we can multiply to the correct number
                thousandRegExp = new RegExp('[^a-zA-Z]' + cultures[currentCulture].abbreviations.thousand +
                    '(?:\\)|(\\' + cultures[currentCulture].currency.symbol + ')?(?:\\))?)?$');
                millionRegExp = new RegExp('[^a-zA-Z]' + cultures[currentCulture].abbreviations.million +
                    '(?:\\)|(\\' + cultures[currentCulture].currency.symbol + ')?(?:\\))?)?$');
                billionRegExp = new RegExp('[^a-zA-Z]' + cultures[currentCulture].abbreviations.billion +
                    '(?:\\)|(\\' + cultures[currentCulture].currency.symbol + ')?(?:\\))?)?$');
                trillionRegExp = new RegExp('[^a-zA-Z]' + cultures[currentCulture].abbreviations.trillion +
                    '(?:\\)|(\\' + cultures[currentCulture].currency.symbol + ')?(?:\\))?)?$');

                // see if bytes are there so that we can multiply to the correct number
                for (power = 1; power < binarySuffixes.length && !bytesMultiplier; ++power) {
                    if (string.indexOf(binarySuffixes[power]) > -1) {
                        bytesMultiplier = Math.pow(1024, power);
                    } else if (string.indexOf(decimalSuffixes[power]) > -1) {
                        bytesMultiplier = Math.pow(1000, power);
                    }
                }

                var str = string.replace(/[^0-9\.]+/g, '');
                if (str === '') {
                    // An empty string is not a number.
                    n._value = NaN;

                } else {
                    // do some math to create our number
                    n._value = ((bytesMultiplier) ? bytesMultiplier : 1) *
                        ((stringOriginal.match(thousandRegExp)) ? Math.pow(10, 3) : 1) *
                        ((stringOriginal.match(millionRegExp)) ? Math.pow(10, 6) : 1) *
                        ((stringOriginal.match(billionRegExp)) ? Math.pow(10, 9) : 1) *
                        ((stringOriginal.match(trillionRegExp)) ? Math.pow(10, 12) : 1) *
                        ((string.indexOf('%') > -1) ? 0.01 : 1) *
                        (((string.split('-').length +
                            Math.min(string.split('(').length - 1, string.split(')').length - 1)) % 2) ? 1 : -1) *
                        Number(str);

                    // round if we are talking about bytes
                    n._value = (bytesMultiplier) ? Math.ceil(n._value) : n._value;
                }
            }
        }
        return n._value;
    }

    function formatCurrency(n, currencySymbol, originalFormat, roundingFunction) {
        var format = originalFormat,
            symbolIndex = format.indexOf('$'),
            openParenIndex = format.indexOf('('),
            plusSignIndex = format.indexOf('+'),
            minusSignIndex = format.indexOf('-'),
            space = '',
            decimalSeparator = '',
            spliceIndex,
            output;

        if(format.indexOf('$') === -1){
            // Use defaults instead of the format provided
            if (cultures[currentCulture].currency.position === 'infix') {
                decimalSeparator = currencySymbol;
                if (cultures[currentCulture].currency.spaceSeparated) {
                    decimalSeparator = ' ' + decimalSeparator + ' ';
                }
            } else if (cultures[currentCulture].currency.spaceSeparated) {
                space = ' ';
            }
        } else {
            // check for space before or after currency
            if (format.indexOf(' $') > -1) {
                space = ' ';
                format = format.replace(' $', '');
            } else if (format.indexOf('$ ') > -1) {
                space = ' ';
                format = format.replace('$ ', '');
            } else {
                format = format.replace('$', '');
            }
        }

        // Format The Number
        output = formatNumber(n._value, format, roundingFunction, decimalSeparator);

        if (originalFormat.indexOf('$') === -1) {
            // Use defaults instead of the format provided
            switch (cultures[currentCulture].currency.position) {
                case 'postfix':
                    if (output.indexOf(')') > -1) {
                        output = output.split('');
                        output.splice(-1, 0, space + currencySymbol);
                        output = output.join('');
                    } else {
                        output = output + space + currencySymbol;
                    }
                    break;
                case 'infix':
                    break;
                case 'prefix':
                    if (output.indexOf('(') > -1 || output.indexOf('-') > -1) {
                        output = output.split('');
                        spliceIndex = Math.max(openParenIndex, minusSignIndex) + 1;

                        output.splice(spliceIndex, 0, currencySymbol + space);
                        output = output.join('');
                    } else {
                        output = currencySymbol + space + output;
                    }
                    break;
                default:
                    throw Error('Currency position should be among ["prefix", "infix", "postfix"]');
            }
        } else {
            // position the symbol
            if (symbolIndex <= 1) {
                if (output.indexOf('(') > -1 || output.indexOf('+') > -1 || output.indexOf('-') > -1) {
                    output = output.split('');
                    spliceIndex = 1;
                    if (symbolIndex < openParenIndex || symbolIndex < plusSignIndex || symbolIndex < minusSignIndex) {
                        // the symbol appears before the "(", "+" or "-"
                        spliceIndex = 0;
                    }
                    output.splice(spliceIndex, 0, currencySymbol + space);
                    output = output.join('');
                } else {
                    output = currencySymbol + space + output;
                }
            } else {
                if (output.indexOf(')') > -1) {
                    output = output.split('');
                    output.splice(-1, 0, space + currencySymbol);
                    output = output.join('');
                } else {
                    output = output + space + currencySymbol;
                }
            }
        }

        return output;
    }

    function formatForeignCurrency(n, foreignCurrencySymbol, originalFormat, roundingFunction) {
        return formatCurrency(n, foreignCurrencySymbol, originalFormat, roundingFunction);
    }

    function formatPercentage(n, format, roundingFunction) {
        var space = '',
            output,
            value = n._value * 100;

        // check for space before %
        if (format.indexOf(' %') > -1) {
            space = ' ';
            format = format.replace(' %', '');
        } else {
            format = format.replace('%', '');
        }

        output = formatNumber(value, format, roundingFunction);

        if (output.indexOf(')') > -1) {
            output = output.split('');
            output.splice(-1, 0, space + '%');
            output = output.join('');
        } else {
            output = output + space + '%';
        }

        return output;
    }

    function formatTime(n) {
        var hours = Math.floor(n._value / 60 / 60),
            minutes = Math.floor((n._value - (hours * 60 * 60)) / 60),
            seconds = Math.round(n._value - (hours * 60 * 60) - (minutes * 60));
        return hours + ':' +
            ((minutes < 10) ? '0' + minutes : minutes) + ':' +
            ((seconds < 10) ? '0' + seconds : seconds);
    }

    function unformatTime(string) {
        var timeArray = string.split(':'),
            seconds = 0;
        // turn hours and minutes into seconds and add them all up
        if (timeArray.length === 3) {
            // hours
            seconds = seconds + (Number(timeArray[0]) * 60 * 60);
            // minutes
            seconds = seconds + (Number(timeArray[1]) * 60);
            // seconds
            seconds = seconds + Number(timeArray[2]);
        } else if (timeArray.length === 2) {
            // minutes
            seconds = seconds + (Number(timeArray[0]) * 60);
            // seconds
            seconds = seconds + Number(timeArray[1]);
        }
        return Number(seconds);
    }

    function formatByteUnits (value, suffixes, scale) {
        var suffix = suffixes[0],
            power,
            min,
            max,
            abs = Math.abs(value);

        if (abs >= scale) {
            for (power = 1; power < suffixes.length; ++power) {
                min = Math.pow(scale, power);
                max = Math.pow(scale, power + 1);

                if (abs >= min && abs < max) {
                    suffix = suffixes[power];
                    value = value / min;
                    break;
                }
            }

            // values greater than or equal to [scale] YB never set the suffix
            if (suffix === suffixes[0]) {
                value = value / Math.pow(scale, suffixes.length - 1);
                suffix = suffixes[suffixes.length - 1];
            }
        }

        return { value: value, suffix: suffix };
    }

    function formatNumber (value, format, roundingFunction, sep) {
        var negP = false,
            signed = false,
            optDec = false,
            abbr = '',
            abbrK = false, // force abbreviation to thousands
            abbrM = false, // force abbreviation to millions
            abbrB = false, // force abbreviation to billions
            abbrT = false, // force abbreviation to trillions
            abbrForce = false, // force abbreviation
            bytes = '',
            byteFormat,
            units,
            ord = '',
            abs = Math.abs(value),
            totalLength,
            length,
            minimumPrecision,
            pow,
            w,
            intPrecision,
            precision,
            prefix,
            postfix,
            thousands,
            d = '',
            forcedNeg = false,
            neg = false,
            indexOpenP,
            indexMinus,
            paren = '',
            minlen,
            i;

        // check if number is zero and a custom zero format has been set
        if (value === 0 && zeroFormat !== null) {
            return zeroFormat;
        }

        if (!isFinite(value)) {
            return '' + value;
        }

        if (format.indexOf('{') === 0) {
            var end = format.indexOf('}');
            if (end === -1) {
                throw Error('Format should also contain a "}"');
            }
            prefix = format.slice(1, end);
            format = format.slice(end + 1);
        } else {
            prefix = '';
        }

        if (format.indexOf('}') === format.length - 1 && format.length) {
            var start = format.indexOf('{');
            if (start === -1) {
                throw Error('Format should also contain a "{"');
            }
            postfix = format.slice(start + 1, -1);
            format = format.slice(0, start + 1);
        } else {
            postfix = '';
        }

        // check for min length
        var info;
        if (format.indexOf('.') === -1) {
            info = format.match(/([0-9]+).*/);
        } else {
            info = format.match(/([0-9]+)\..*/);
        }
        minlen = info === null ? -1 : info[1].length;

        // see if we should use parentheses for negative number or if we should prefix with a sign
        // if both are present we default to parentheses
        if (format.indexOf('-') !== -1) {
            forcedNeg = true;
        }
        if (format.indexOf('(') > -1) {
            negP = true;
            format = format.slice(1, -1);
        } else if (format.indexOf('+') > -1) {
            signed = true;
            format = format.replace(/\+/g, '');
        }

        // see if abbreviation is wanted
        if (format.indexOf('a') > -1) {
            intPrecision = format.split('.')[0].match(/[0-9]+/g) || ['0'];
            intPrecision = parseInt(intPrecision[0], 10);

            // check if abbreviation is specified
            abbrK = format.indexOf('aK') >= 0;
            abbrM = format.indexOf('aM') >= 0;
            abbrB = format.indexOf('aB') >= 0;
            abbrT = format.indexOf('aT') >= 0;
            abbrForce = abbrK || abbrM || abbrB || abbrT;

            // check for space before abbreviation
            if (format.indexOf(' a') > -1) {
                abbr = ' ';
                format = format.replace(' a', '');
            } else {
                format = format.replace('a', '');
            }

            totalLength = numberLength(value);
            minimumPrecision = totalLength % 3;
            minimumPrecision = minimumPrecision === 0 ? 3 : minimumPrecision;

            if (intPrecision && abs !== 0) {
                pow = 3 * ~~((Math.min(intPrecision, totalLength) - minimumPrecision) / 3);
                abs = abs / Math.pow(10, pow);
            }

            if (totalLength !== intPrecision) {
                if (abs >= Math.pow(10, 12) && !abbrForce || abbrT) {
                    // trillion
                    abbr = abbr + cultures[currentCulture].abbreviations.trillion;
                    value = value / Math.pow(10, 12);
                } else if (abs < Math.pow(10, 12) && abs >= Math.pow(10, 9) && !abbrForce || abbrB) {
                    // billion
                    abbr = abbr + cultures[currentCulture].abbreviations.billion;
                    value = value / Math.pow(10, 9);
                } else if (abs < Math.pow(10, 9) && abs >= Math.pow(10, 6) && !abbrForce || abbrM) {
                    // million
                    abbr = abbr + cultures[currentCulture].abbreviations.million;
                    value = value / Math.pow(10, 6);
                } else if (abs < Math.pow(10, 6) && abs >= Math.pow(10, 3) && !abbrForce || abbrK) {
                    // thousand
                    abbr = abbr + cultures[currentCulture].abbreviations.thousand;
                    value = value / Math.pow(10, 3);
                }
            }

            length = numberLength(value);
            if (intPrecision && length < intPrecision && format.indexOf('.') === -1) {
                format += '[.]';
                format += zeroes(intPrecision - length);
            }
        }

        // see if we are formatting
        //   binary-decimal bytes (1024 MB), binary bytes (1024 MiB), or decimal bytes (1000 MB)
        for (i = 0; i < byteFormatOrder.length; ++i) {
            byteFormat = byteFormatOrder[i];

            if (format.indexOf(byteFormat.marker) > -1) {
                // check for space before
                if (format.indexOf(' ' + byteFormat.marker) >-1) {
                    bytes = ' ';
                }

                // remove the marker (with the space if it had one)
                format = format.replace(bytes + byteFormat.marker, '');

                units = formatByteUnits(value, byteFormat.suffixes, byteFormat.scale);

                value = units.value;
                bytes = bytes + units.suffix;

                break;
            }
        }

        // see if ordinal is wanted
        if (format.indexOf('o') > -1) {
            // check for space before
            if (format.indexOf(' o') > -1) {
                ord = ' ';
                format = format.replace(' o', '');
            } else {
                format = format.replace('o', '');
            }

            if (cultures[currentCulture].ordinal) {
                ord = ord + cultures[currentCulture].ordinal(value);
            }
        }

        if (format.indexOf('[.]') > -1) {
            optDec = true;
            format = format.replace('[.]', '.');
        }

        precision = format.split('.')[1];
        thousands = format.indexOf(',');

        if (precision) {
            var dSplit = [];

            if (precision.indexOf('*') !== -1) {
                d = value.toString();
                dSplit = d.split('.');
                if (dSplit.length > 1) {
                    d = toFixed(value, dSplit[1].length, roundingFunction);
                }
            } else {
                if (precision.indexOf('[') > -1) {
                    precision = precision.replace(']', '');
                    precision = precision.split('[');
                    d = toFixed(value, (precision[0].length + precision[1].length), roundingFunction,
                        precision[1].length);
                } else {
                    d = toFixed(value, precision.length, roundingFunction);
                }
            }

            dSplit = d.split('.');
            w = dSplit[0];

            if (dSplit.length > 1 && dSplit[1].length) {
                var p = sep ? abbr + sep : cultures[currentCulture].delimiters.decimal;
                d = p + dSplit[1];
            } else {
                d = '';
            }

            if (optDec && Number(d.slice(1)) === 0) {
                d = '';
            }
        } else {
            w = toFixed(value, 0, roundingFunction);
        }

        // format number
        if (w.indexOf('-') > -1) {
            w = w.slice(1);
            neg = true;
        }

        if (w.length < minlen) {
            w = zeroes(minlen - w.length) + w;
        }

        if (thousands > -1) {
            w = w.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1' +
                cultures[currentCulture].delimiters.thousands);
        }

        if (format.indexOf('.') === 0) {
            w = '';
        }

        indexOpenP = format.indexOf('(');
        indexMinus = format.indexOf('-');

        if (indexOpenP < indexMinus) {
            paren = ((negP && neg) ? '(' : '') + (((forcedNeg && neg) || (!negP && neg)) ? '-' : '');
        } else {
            paren = (((forcedNeg && neg) || (!negP && neg)) ? '-' : '') + ((negP && neg) ? '(' : '');
        }

        return prefix +
            paren + ((!neg && signed && value !== 0) ? '+' : '') +
            w + d +
            ((ord) ? ord : '') +
            ((abbr && !sep) ? abbr : '') +
            ((bytes) ? bytes : '') +
            ((negP && neg) ? ')' : '') +
            postfix;
    }

    /************************************
        Top Level Functions
    ************************************/

    numbro = function(input) {
        if (numbro.isNumbro(input)) {
            input = input.value();
        } else if (typeof input === 'string' || typeof input === 'number') {
            input = numbro.fn.unformat(input);
        } else {
            input = NaN;
        }

        return new Numbro(Number(input));
    };

    // version number
    numbro.version = VERSION;

    // compare numbro object
    numbro.isNumbro = function(obj) {
        return obj instanceof Numbro;
    };

    /**
     * This function allow the user to set a new language with a fallback if
     * the language does not exist. If no fallback language is provided,
     * it fallbacks to english.
     *
     * @deprecated Since in version 1.6.0. It will be deleted in version 2.0
     * `setCulture` should be used instead.
     */
    numbro.setLanguage = function(newLanguage, fallbackLanguage) {
        console.warn('`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead');
        var key = newLanguage,
            prefix = newLanguage.split('-')[0],
            matchingLanguage = null;
        if (!languages[key]) {
            Object.keys(languages).forEach(function(language) {
                if (!matchingLanguage && language.split('-')[0] === prefix) {
                    matchingLanguage = language;
                }
            });
            key = matchingLanguage || fallbackLanguage || 'en-US';
        }
        chooseCulture(key);
    };

    /**
     * This function allow the user to set a new culture with a fallback if
     * the culture does not exist. If no fallback culture is provided,
     * it falls back to "en-US".
     */
    numbro.setCulture = function(newCulture, fallbackCulture) {
        var key = newCulture,
            suffix = newCulture.split('-')[1],
            matchingCulture = null;
        if (!cultures[key]) {
            if (suffix) {
                Object.keys(cultures).forEach(function(language) {
                    if (!matchingCulture && language.split('-')[1] === suffix) {
                        matchingCulture = language;
                    }
                });
            }

            key = matchingCulture || fallbackCulture || 'en-US';
        }
        chooseCulture(key);
    };

    /**
     * This function will load languages and then set the global language.  If
     * no arguments are passed in, it will simply return the current global
     * language key.
     *
     * @deprecated Since in version 1.6.0. It will be deleted in version 2.0
     * `culture` should be used instead.
     */
    numbro.language = function(key, values) {
        console.warn('`language` is deprecated since version 1.6.0. Use `culture` instead');

        if (!key) {
            return currentCulture;
        }

        if (key && !values) {
            if (!languages[key]) {
                throw new Error('Unknown language : ' + key);
            }
            chooseCulture(key);
        }

        if (values || !languages[key]) {
            setCulture(key, values);
        }

        return numbro;
    };

    /**
     * This function will load cultures and then set the global culture.  If
     * no arguments are passed in, it will simply return the current global
     * culture code.
     */
    numbro.culture = function(code, values) {
        if (!code) {
            return currentCulture;
        }

        if (code && !values) {
            if (!cultures[code]) {
                throw new Error('Unknown culture : ' + code);
            }
            chooseCulture(code);
        }

        if (values || !cultures[code]) {
            setCulture(code, values);
        }

        return numbro;
    };

    /**
     * This function provides access to the loaded language data.  If
     * no arguments are passed in, it will simply return the current
     * global language object.
     *
     * @deprecated Since in version 1.6.0. It will be deleted in version 2.0
     * `culture` should be used instead.
     */
    numbro.languageData = function(key) {
        console.warn('`languageData` is deprecated since version 1.6.0. Use `cultureData` instead');

        if (!key) {
            return languages[currentCulture];
        }

        if (!languages[key]) {
            throw new Error('Unknown language : ' + key);
        }

        return languages[key];
    };

    /**
     * This function provides access to the loaded culture data.  If
     * no arguments are passed in, it will simply return the current
     * global culture object.
     */
    numbro.cultureData = function(code) {
        if (!code) {
            return cultures[currentCulture];
        }

        if (!cultures[code]) {
            throw new Error('Unknown culture : ' + code);
        }

        return cultures[code];
    };

    numbro.culture('en-US', enUS);

    /**
     * @deprecated Since in version 1.6.0. It will be deleted in version 2.0
     * `cultures` should be used instead.
     */
    numbro.languages = function() {
        console.warn('`languages` is deprecated since version 1.6.0. Use `cultures` instead');

        return languages;
    };

    numbro.cultures = function() {
        return cultures;
    };

    numbro.zeroFormat = function(format) {
        zeroFormat = typeof(format) === 'string' ? format : null;
    };

    numbro.defaultFormat = function(format) {
        defaultFormat = typeof(format) === 'string' ? format : '0.0';
    };

    numbro.defaultCurrencyFormat = function (format) {
        defaultCurrencyFormat = typeof(format) === 'string' ? format : '0$';
    };

    numbro.validate = function(val, culture) {

        var _decimalSep,
            _thousandSep,
            _currSymbol,
            _valArray,
            _abbrObj,
            _thousandRegEx,
            cultureData,
            temp;

        //coerce val to string
        if (typeof val !== 'string') {
            val += '';
            if (console.warn) {
                console.warn('Numbro.js: Value is not string. It has been co-erced to: ', val);
            }
        }

        //trim whitespaces from either sides
        val = val.trim();

        //replace the initial '+' or '-' sign if present
        val = val.replace(/^[+-]?/, '');

        //if val is just digits return true
        if ( !! val.match(/^\d+$/)) {
            return true;
        }

        //if val is empty return false
        if (val === '') {
            return false;
        }

        //get the decimal and thousands separator from numbro.cultureData
        try {
            //check if the culture is understood by numbro. if not, default it to current culture
            cultureData = numbro.cultureData(culture);
        } catch (e) {
            cultureData = numbro.cultureData(numbro.culture());
        }

        //setup the delimiters and currency symbol based on culture
        _currSymbol = cultureData.currency.symbol;
        _abbrObj = cultureData.abbreviations;
        _decimalSep = cultureData.delimiters.decimal;
        if (cultureData.delimiters.thousands === '.') {
            _thousandSep = '\\.';
        } else {
            _thousandSep = cultureData.delimiters.thousands;
        }

        // validating currency symbol
        temp = val.match(/^[^\d\.\,]+/);
        if (temp !== null) {
            val = val.substr(1);
            if (temp[0] !== _currSymbol) {
                return false;
            }
        }

        //validating abbreviation symbol
        temp = val.match(/[^\d]+$/);
        if (temp !== null) {
            val = val.slice(0, -1);
            if (temp[0] !== _abbrObj.thousand && temp[0] !== _abbrObj.million &&
                    temp[0] !== _abbrObj.billion && temp[0] !== _abbrObj.trillion) {
                return false;
            }
        }

        _thousandRegEx = new RegExp(_thousandSep + '{2}');

        if (!val.match(/[^\d.,]/g)) {
            _valArray = val.split(_decimalSep);
            if (_valArray.length > 2) {
                return false;
            } else {
                if (_valArray.length < 2) {
                    return ( !! _valArray[0].match(/^\d+.*\d$/) && !_valArray[0].match(_thousandRegEx));
                } else {
                    if (_valArray[0] === '') {
                        // for values without leading zero eg. .984
                        return (!_valArray[0].match(_thousandRegEx) &&
                            !!_valArray[1].match(/^\d+$/));

                    } else if (_valArray[0].length === 1) {
                        return ( !! _valArray[0].match(/^\d+$/) &&
                            !_valArray[0].match(_thousandRegEx) &&
                            !! _valArray[1].match(/^\d+$/));
                    } else {
                        return ( !! _valArray[0].match(/^\d+.*\d$/) &&
                            !_valArray[0].match(_thousandRegEx) &&
                            !! _valArray[1].match(/^\d+$/));
                    }
                }
            }
        }

        return false;
    };

    /**
     * * @deprecated Since in version 1.6.0. It will be deleted in version 2.0
     * `loadCulturesInNode` should be used instead.
     */
    numbro.loadLanguagesInNode = function() {
        console.warn('`loadLanguagesInNode` is deprecated since version 1.6.0. Use `loadCulturesInNode` instead');

        numbro.loadCulturesInNode();
    };

    numbro.loadCulturesInNode = function() {
        // TODO: Rename the folder in 2.0.0
        var cultures = _dereq_('./languages');

        for(var langLocaleCode in cultures) {
            if(langLocaleCode) {
                numbro.culture(langLocaleCode, cultures[langLocaleCode]);
            }
        }
    };

    /************************************
        Helpers
    ************************************/

    function setCulture(code, values) {
        cultures[code] = values;
    }

    function chooseCulture(code) {
        currentCulture = code;
        var defaults = cultures[code].defaults;
        if (defaults && defaults.format) {
            numbro.defaultFormat(defaults.format);
        }
        if (defaults && defaults.currencyFormat) {
            numbro.defaultCurrencyFormat(defaults.currencyFormat);
        }
    }

    function inNodejsRuntime() {
        return (typeof process !== 'undefined') &&
            (process.browser === undefined) &&
            process.title &&
            (
                process.title.indexOf('node') !== -1 ||
                process.title.indexOf('meteor-tool') > 0 ||
                process.title === 'grunt' ||
                process.title === 'gulp'
            ) &&
            (typeof _dereq_ !== 'undefined');
    }

    /************************************
        Floating-point helpers
    ************************************/

    // The floating-point helper functions and implementation
    // borrows heavily from sinful.js: http://guipn.github.io/sinful.js/

    /**
     * Array.prototype.reduce for browsers that don't support it
     * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce#Compatibility
     */
    if ('function' !== typeof Array.prototype.reduce) {
        Array.prototype.reduce = function(callback, optInitialValue) {

            if (null === this || 'undefined' === typeof this) {
                // At the moment all modern browsers, that support strict mode, have
                // native implementation of Array.prototype.reduce. For instance, IE8
                // does not support strict mode, so this check is actually useless.
                throw new TypeError('Array.prototype.reduce called on null or undefined');
            }

            if ('function' !== typeof callback) {
                throw new TypeError(callback + ' is not a function');
            }

            var index,
                value,
                length = this.length >>> 0,
                isValueSet = false;

            if (1 < arguments.length) {
                value = optInitialValue;
                isValueSet = true;
            }

            for (index = 0; length > index; ++index) {
                if (this.hasOwnProperty(index)) {
                    if (isValueSet) {
                        value = callback(value, this[index], index, this);
                    } else {
                        value = this[index];
                        isValueSet = true;
                    }
                }
            }

            if (!isValueSet) {
                throw new TypeError('Reduce of empty array with no initial value');
            }

            return value;
        };
    }


    /**
     * Computes the multiplier necessary to make x >= 1,
     * effectively eliminating miscalculations caused by
     * finite precision.
     */
    function multiplier(x) {
        var parts = x.toString().split('.');
        if (parts.length < 2) {
            return 1;
        }
        return Math.pow(10, parts[1].length);
    }

    /**
     * Given a variable number of arguments, returns the maximum
     * multiplier that must be used to normalize an operation involving
     * all of them.
     */
    function correctionFactor() {
        var args = Array.prototype.slice.call(arguments);
        return args.reduce(function(prev, next) {
            var mp = multiplier(prev),
                mn = multiplier(next);
            return mp > mn ? mp : mn;
        }, -Infinity);
    }

    /************************************
        Numbro Prototype
    ************************************/


    numbro.fn = Numbro.prototype = {

        clone: function() {
            return numbro(this);
        },

        format: function(inputString, roundingFunction) {
            return formatNumbro(this,
                inputString ? inputString : defaultFormat,
                (roundingFunction !== undefined) ? roundingFunction : Math.round
            );
        },

        formatCurrency: function(inputString, roundingFunction) {
            return formatCurrency(this,
                cultures[currentCulture].currency.symbol,
                inputString ? inputString : defaultCurrencyFormat,
                (roundingFunction !== undefined) ? roundingFunction : Math.round
            );
        },

        formatForeignCurrency: function(currencySymbol, inputString, roundingFunction) {
            return formatForeignCurrency(this,
                currencySymbol,
                inputString ? inputString : defaultCurrencyFormat,
                (roundingFunction !== undefined) ? roundingFunction : Math.round
            );
        },

        unformat: function(inputString) {
            if (typeof inputString === 'number') {
                return inputString;
            } else if (typeof inputString === 'string') {
                var result = unformatNumbro(this, inputString);

                // Any unparseable string (represented as NaN in the result) is
                // converted into undefined.
                return isNaN(result) ? undefined : result;
            } else {
                return undefined;
            }
        },

        binaryByteUnits: function() {
            return formatByteUnits(this._value, bytes.binary.suffixes, bytes.binary.scale).suffix;
        },

        byteUnits: function() {
            return formatByteUnits(this._value, bytes.general.suffixes, bytes.general.scale).suffix;
        },

        decimalByteUnits: function() {
            return formatByteUnits(this._value, bytes.decimal.suffixes, bytes.decimal.scale).suffix;
        },

        value: function() {
            return this._value;
        },

        valueOf: function() {
            return this._value;
        },

        set: function(value) {
            this._value = Number(value);
            return this;
        },

        add: function(value) {
            var corrFactor = correctionFactor.call(null, this._value, value);

            function cback(accum, curr) {
                return accum + corrFactor * curr;
            }
            this._value = [this._value, value].reduce(cback, 0) / corrFactor;
            return this;
        },

        subtract: function(value) {
            var corrFactor = correctionFactor.call(null, this._value, value);

            function cback(accum, curr) {
                return accum - corrFactor * curr;
            }
            this._value = [value].reduce(cback, this._value * corrFactor) / corrFactor;
            return this;
        },

        multiply: function(value) {
            function cback(accum, curr) {
                var corrFactor = correctionFactor(accum, curr),
                    result = accum * corrFactor;
                result *= curr * corrFactor;
                result /= corrFactor * corrFactor;
                return result;
            }
            this._value = [this._value, value].reduce(cback, 1);
            return this;
        },

        divide: function(value) {
            function cback(accum, curr) {
                var corrFactor = correctionFactor(accum, curr);
                return (accum * corrFactor) / (curr * corrFactor);
            }
            this._value = [this._value, value].reduce(cback);
            return this;
        },

        difference: function(value) {
            return Math.abs(numbro(this._value).subtract(value).value());
        }

    };

    /************************************
        Exposing Numbro
    ************************************/

    if (inNodejsRuntime()) {
        //Todo: Rename the folder in 2.0.0
        numbro.loadCulturesInNode();
    }

    // CommonJS module is defined
    if (hasModule) {
        module.exports = numbro;
    } else {
        /*global ender:false */
        if (typeof ender === 'undefined') {
            // here, `this` means `window` in the browser, or `global` on the server
            // add `numbro` as a global object via a string identifier,
            // for Closure Compiler 'advanced' mode
            this.numbro = numbro;
        }

        /*global define:false */
        if (typeof define === 'function' && define.amd) {
            define([], function() {
                return numbro;
            });
        }
    }

}.call(typeof window === 'undefined' ? this : window));

},{"languages":1}],"pikaday":[function(_dereq_,module,exports){
/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */

(function (root, factory)
{
    'use strict';

    var moment;
    if (typeof exports === 'object') {
        // CommonJS module
        // Load moment.js as an optional dependency
        try { moment = _dereq_('moment'); } catch (e) {}
        module.exports = factory(moment);
    } else if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define(function (req)
        {
            // Load moment.js as an optional dependency
            var id = 'moment';
            try { moment = req(id); } catch (e) {}
            return factory(moment);
        });
    } else {
        root.Pikaday = factory(root.moment);
    }
}(this, function (moment)
{
    'use strict';

    /**
     * feature detection and helper functions
     */
    var hasMoment = typeof moment === 'function',

    hasEventListeners = !!window.addEventListener,

    document = window.document,

    sto = window.setTimeout,

    addEvent = function(el, e, callback, capture)
    {
        if (hasEventListeners) {
            el.addEventListener(e, callback, !!capture);
        } else {
            el.attachEvent('on' + e, callback);
        }
    },

    removeEvent = function(el, e, callback, capture)
    {
        if (hasEventListeners) {
            el.removeEventListener(e, callback, !!capture);
        } else {
            el.detachEvent('on' + e, callback);
        }
    },

    fireEvent = function(el, eventName, data)
    {
        var ev;

        if (document.createEvent) {
            ev = document.createEvent('HTMLEvents');
            ev.initEvent(eventName, true, false);
            ev = extend(ev, data);
            el.dispatchEvent(ev);
        } else if (document.createEventObject) {
            ev = document.createEventObject();
            ev = extend(ev, data);
            el.fireEvent('on' + eventName, ev);
        }
    },

    trim = function(str)
    {
        return str.trim ? str.trim() : str.replace(/^\s+|\s+$/g,'');
    },

    hasClass = function(el, cn)
    {
        return (' ' + el.className + ' ').indexOf(' ' + cn + ' ') !== -1;
    },

    addClass = function(el, cn)
    {
        if (!hasClass(el, cn)) {
            el.className = (el.className === '') ? cn : el.className + ' ' + cn;
        }
    },

    removeClass = function(el, cn)
    {
        el.className = trim((' ' + el.className + ' ').replace(' ' + cn + ' ', ' '));
    },

    isArray = function(obj)
    {
        return (/Array/).test(Object.prototype.toString.call(obj));
    },

    isDate = function(obj)
    {
        return (/Date/).test(Object.prototype.toString.call(obj)) && !isNaN(obj.getTime());
    },

    isWeekend = function(date)
    {
        var day = date.getDay();
        return day === 0 || day === 6;
    },

    isLeapYear = function(year)
    {
        // solution by Matti Virkkunen: http://stackoverflow.com/a/4881951
        return year % 4 === 0 && year % 100 !== 0 || year % 400 === 0;
    },

    getDaysInMonth = function(year, month)
    {
        return [31, isLeapYear(year) ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month];
    },

    setToStartOfDay = function(date)
    {
        if (isDate(date)) date.setHours(0,0,0,0);
    },

    compareDates = function(a,b)
    {
        // weak date comparison (use setToStartOfDay(date) to ensure correct result)
        return a.getTime() === b.getTime();
    },

    extend = function(to, from, overwrite)
    {
        var prop, hasProp;
        for (prop in from) {
            hasProp = to[prop] !== undefined;
            if (hasProp && typeof from[prop] === 'object' && from[prop] !== null && from[prop].nodeName === undefined) {
                if (isDate(from[prop])) {
                    if (overwrite) {
                        to[prop] = new Date(from[prop].getTime());
                    }
                }
                else if (isArray(from[prop])) {
                    if (overwrite) {
                        to[prop] = from[prop].slice(0);
                    }
                } else {
                    to[prop] = extend({}, from[prop], overwrite);
                }
            } else if (overwrite || !hasProp) {
                to[prop] = from[prop];
            }
        }
        return to;
    },

    adjustCalendar = function(calendar) {
        if (calendar.month < 0) {
            calendar.year -= Math.ceil(Math.abs(calendar.month)/12);
            calendar.month += 12;
        }
        if (calendar.month > 11) {
            calendar.year += Math.floor(Math.abs(calendar.month)/12);
            calendar.month -= 12;
        }
        return calendar;
    },

    /**
     * defaults and localisation
     */
    defaults = {

        // bind the picker to a form field
        field: null,

        // automatically show/hide the picker on `field` focus (default `true` if `field` is set)
        bound: undefined,

        // position of the datepicker, relative to the field (default to bottom & left)
        // ('bottom' & 'left' keywords are not used, 'top' & 'right' are modifier on the bottom/left position)
        position: 'bottom left',

        // automatically fit in the viewport even if it means repositioning from the position option
        reposition: true,

        // the default output format for `.toString()` and `field` value
        format: 'YYYY-MM-DD',

        // the initial date to view when first opened
        defaultDate: null,

        // make the `defaultDate` the initial selected value
        setDefaultDate: false,

        // first day of week (0: Sunday, 1: Monday etc)
        firstDay: 0,

        // the default flag for moment's strict date parsing
        formatStrict: false,

        // the minimum/earliest date that can be selected
        minDate: null,
        // the maximum/latest date that can be selected
        maxDate: null,

        // number of years either side, or array of upper/lower range
        yearRange: 10,

        // show week numbers at head of row
        showWeekNumber: false,

        // used internally (don't config outside)
        minYear: 0,
        maxYear: 9999,
        minMonth: undefined,
        maxMonth: undefined,

        startRange: null,
        endRange: null,

        isRTL: false,

        // Additional text to append to the year in the calendar title
        yearSuffix: '',

        // Render the month after year in the calendar title
        showMonthAfterYear: false,

        // Render days of the calendar grid that fall in the next or previous month
        showDaysInNextAndPreviousMonths: false,

        // how many months are visible
        numberOfMonths: 1,

        // when numberOfMonths is used, this will help you to choose where the main calendar will be (default `left`, can be set to `right`)
        // only used for the first display or when a selected date is not visible
        mainCalendar: 'left',

        // Specify a DOM element to render the calendar in
        container: undefined,

        // internationalization
        i18n: {
            previousMonth : 'Previous Month',
            nextMonth     : 'Next Month',
            months        : ['January','February','March','April','May','June','July','August','September','October','November','December'],
            weekdays      : ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],
            weekdaysShort : ['Sun','Mon','Tue','Wed','Thu','Fri','Sat']
        },

        // Theme Classname
        theme: null,

        // callback function
        onSelect: null,
        onOpen: null,
        onClose: null,
        onDraw: null
    },


    /**
     * templating functions to abstract HTML rendering
     */
    renderDayName = function(opts, day, abbr)
    {
        day += opts.firstDay;
        while (day >= 7) {
            day -= 7;
        }
        return abbr ? opts.i18n.weekdaysShort[day] : opts.i18n.weekdays[day];
    },

    renderDay = function(opts)
    {
        var arr = [];
        var ariaSelected = 'false';
        if (opts.isEmpty) {
            if (opts.showDaysInNextAndPreviousMonths) {
                arr.push('is-outside-current-month');
            } else {
                return '<td class="is-empty"></td>';
            }
        }
        if (opts.isDisabled) {
            arr.push('is-disabled');
        }
        if (opts.isToday) {
            arr.push('is-today');
        }
        if (opts.isSelected) {
            arr.push('is-selected');
            ariaSelected = 'true';
        }
        if (opts.isInRange) {
            arr.push('is-inrange');
        }
        if (opts.isStartRange) {
            arr.push('is-startrange');
        }
        if (opts.isEndRange) {
            arr.push('is-endrange');
        }
        return '<td data-day="' + opts.day + '" class="' + arr.join(' ') + '" aria-selected="' + ariaSelected + '">' +
                 '<button class="pika-button pika-day" type="button" ' +
                    'data-pika-year="' + opts.year + '" data-pika-month="' + opts.month + '" data-pika-day="' + opts.day + '">' +
                        opts.day +
                 '</button>' +
               '</td>';
    },

    renderWeek = function (d, m, y) {
        // Lifted from http://javascript.about.com/library/blweekyear.htm, lightly modified.
        var onejan = new Date(y, 0, 1),
            weekNum = Math.ceil((((new Date(y, m, d) - onejan) / 86400000) + onejan.getDay()+1)/7);
        return '<td class="pika-week">' + weekNum + '</td>';
    },

    renderRow = function(days, isRTL)
    {
        return '<tr>' + (isRTL ? days.reverse() : days).join('') + '</tr>';
    },

    renderBody = function(rows)
    {
        return '<tbody>' + rows.join('') + '</tbody>';
    },

    renderHead = function(opts)
    {
        var i, arr = [];
        if (opts.showWeekNumber) {
            arr.push('<th></th>');
        }
        for (i = 0; i < 7; i++) {
            arr.push('<th scope="col"><abbr title="' + renderDayName(opts, i) + '">' + renderDayName(opts, i, true) + '</abbr></th>');
        }
        return '<thead><tr>' + (opts.isRTL ? arr.reverse() : arr).join('') + '</tr></thead>';
    },

    renderTitle = function(instance, c, year, month, refYear, randId)
    {
        var i, j, arr,
            opts = instance._o,
            isMinYear = year === opts.minYear,
            isMaxYear = year === opts.maxYear,
            html = '<div id="' + randId + '" class="pika-title" role="heading" aria-live="assertive">',
            monthHtml,
            yearHtml,
            prev = true,
            next = true;

        for (arr = [], i = 0; i < 12; i++) {
            arr.push('<option value="' + (year === refYear ? i - c : 12 + i - c) + '"' +
                (i === month ? ' selected="selected"': '') +
                ((isMinYear && i < opts.minMonth) || (isMaxYear && i > opts.maxMonth) ? 'disabled="disabled"' : '') + '>' +
                opts.i18n.months[i] + '</option>');
        }

        monthHtml = '<div class="pika-label">' + opts.i18n.months[month] + '<select class="pika-select pika-select-month" tabindex="-1">' + arr.join('') + '</select></div>';

        if (isArray(opts.yearRange)) {
            i = opts.yearRange[0];
            j = opts.yearRange[1] + 1;
        } else {
            i = year - opts.yearRange;
            j = 1 + year + opts.yearRange;
        }

        for (arr = []; i < j && i <= opts.maxYear; i++) {
            if (i >= opts.minYear) {
                arr.push('<option value="' + i + '"' + (i === year ? ' selected="selected"': '') + '>' + (i) + '</option>');
            }
        }
        yearHtml = '<div class="pika-label">' + year + opts.yearSuffix + '<select class="pika-select pika-select-year" tabindex="-1">' + arr.join('') + '</select></div>';

        if (opts.showMonthAfterYear) {
            html += yearHtml + monthHtml;
        } else {
            html += monthHtml + yearHtml;
        }

        if (isMinYear && (month === 0 || opts.minMonth >= month)) {
            prev = false;
        }

        if (isMaxYear && (month === 11 || opts.maxMonth <= month)) {
            next = false;
        }

        if (c === 0) {
            html += '<button class="pika-prev' + (prev ? '' : ' is-disabled') + '" type="button">' + opts.i18n.previousMonth + '</button>';
        }
        if (c === (instance._o.numberOfMonths - 1) ) {
            html += '<button class="pika-next' + (next ? '' : ' is-disabled') + '" type="button">' + opts.i18n.nextMonth + '</button>';
        }

        return html += '</div>';
    },

    renderTable = function(opts, data, randId)
    {
        return '<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="' + randId + '">' + renderHead(opts) + renderBody(data) + '</table>';
    },


    /**
     * Pikaday constructor
     */
    Pikaday = function(options)
    {
        var self = this,
            opts = self.config(options);

        self._onMouseDown = function(e)
        {
            if (!self._v) {
                return;
            }
            e = e || window.event;
            var target = e.target || e.srcElement;
            if (!target) {
                return;
            }

            if (!hasClass(target, 'is-disabled')) {
                if (hasClass(target, 'pika-button') && !hasClass(target, 'is-empty') && !hasClass(target.parentNode, 'is-disabled')) {
                    self.setDate(new Date(target.getAttribute('data-pika-year'), target.getAttribute('data-pika-month'), target.getAttribute('data-pika-day')));
                    if (opts.bound) {
                        sto(function() {
                            self.hide();
                            if (opts.field) {
                                opts.field.blur();
                            }
                        }, 100);
                    }
                }
                else if (hasClass(target, 'pika-prev')) {
                    self.prevMonth();
                }
                else if (hasClass(target, 'pika-next')) {
                    self.nextMonth();
                }
            }
            if (!hasClass(target, 'pika-select')) {
                // if this is touch event prevent mouse events emulation
                if (e.preventDefault) {
                    e.preventDefault();
                } else {
                    e.returnValue = false;
                    return false;
                }
            } else {
                self._c = true;
            }
        };

        self._onChange = function(e)
        {
            e = e || window.event;
            var target = e.target || e.srcElement;
            if (!target) {
                return;
            }
            if (hasClass(target, 'pika-select-month')) {
                self.gotoMonth(target.value);
            }
            else if (hasClass(target, 'pika-select-year')) {
                self.gotoYear(target.value);
            }
        };

        self._onKeyChange = function(e)
        {
            e = e || window.event;

            if (self.isVisible()) {

                switch(e.keyCode){
                    case 13:
                    case 27:
                        opts.field.blur();
                        break;
                    case 37:
                        e.preventDefault();
                        self.adjustDate('subtract', 1);
                        break;
                    case 38:
                        self.adjustDate('subtract', 7);
                        break;
                    case 39:
                        self.adjustDate('add', 1);
                        break;
                    case 40:
                        self.adjustDate('add', 7);
                        break;
                }
            }
        };

        self._onInputChange = function(e)
        {
            var date;

            if (e.firedBy === self) {
                return;
            }
            if (hasMoment) {
                date = moment(opts.field.value, opts.format, opts.formatStrict);
                date = (date && date.isValid()) ? date.toDate() : null;
            }
            else {
                date = new Date(Date.parse(opts.field.value));
            }
            if (isDate(date)) {
              self.setDate(date);
            }
            if (!self._v) {
                self.show();
            }
        };

        self._onInputFocus = function()
        {
            self.show();
        };

        self._onInputClick = function()
        {
            self.show();
        };

        self._onInputBlur = function()
        {
            // IE allows pika div to gain focus; catch blur the input field
            var pEl = document.activeElement;
            do {
                if (hasClass(pEl, 'pika-single')) {
                    return;
                }
            }
            while ((pEl = pEl.parentNode));

            if (!self._c) {
                self._b = sto(function() {
                    self.hide();
                }, 50);
            }
            self._c = false;
        };

        self._onClick = function(e)
        {
            e = e || window.event;
            var target = e.target || e.srcElement,
                pEl = target;
            if (!target) {
                return;
            }
            if (!hasEventListeners && hasClass(target, 'pika-select')) {
                if (!target.onchange) {
                    target.setAttribute('onchange', 'return;');
                    addEvent(target, 'change', self._onChange);
                }
            }
            do {
                if (hasClass(pEl, 'pika-single') || pEl === opts.trigger) {
                    return;
                }
            }
            while ((pEl = pEl.parentNode));
            if (self._v && target !== opts.trigger && pEl !== opts.trigger) {
                self.hide();
            }
        };

        self.el = document.createElement('div');
        self.el.className = 'pika-single' + (opts.isRTL ? ' is-rtl' : '') + (opts.theme ? ' ' + opts.theme : '');

        addEvent(self.el, 'mousedown', self._onMouseDown, true);
        addEvent(self.el, 'touchend', self._onMouseDown, true);
        addEvent(self.el, 'change', self._onChange);
        addEvent(document, 'keydown', self._onKeyChange);

        if (opts.field) {
            if (opts.container) {
                opts.container.appendChild(self.el);
            } else if (opts.bound) {
                document.body.appendChild(self.el);
            } else {
                opts.field.parentNode.insertBefore(self.el, opts.field.nextSibling);
            }
            addEvent(opts.field, 'change', self._onInputChange);

            if (!opts.defaultDate) {
                if (hasMoment && opts.field.value) {
                    opts.defaultDate = moment(opts.field.value, opts.format).toDate();
                } else {
                    opts.defaultDate = new Date(Date.parse(opts.field.value));
                }
                opts.setDefaultDate = true;
            }
        }

        var defDate = opts.defaultDate;

        if (isDate(defDate)) {
            if (opts.setDefaultDate) {
                self.setDate(defDate, true);
            } else {
                self.gotoDate(defDate);
            }
        } else {
            self.gotoDate(new Date());
        }

        if (opts.bound) {
            this.hide();
            self.el.className += ' is-bound';
            addEvent(opts.trigger, 'click', self._onInputClick);
            addEvent(opts.trigger, 'focus', self._onInputFocus);
            addEvent(opts.trigger, 'blur', self._onInputBlur);
        } else {
            this.show();
        }
    };


    /**
     * public Pikaday API
     */
    Pikaday.prototype = {


        /**
         * configure functionality
         */
        config: function(options)
        {
            if (!this._o) {
                this._o = extend({}, defaults, true);
            }

            var opts = extend(this._o, options, true);

            opts.isRTL = !!opts.isRTL;

            opts.field = (opts.field && opts.field.nodeName) ? opts.field : null;

            opts.theme = (typeof opts.theme) === 'string' && opts.theme ? opts.theme : null;

            opts.bound = !!(opts.bound !== undefined ? opts.field && opts.bound : opts.field);

            opts.trigger = (opts.trigger && opts.trigger.nodeName) ? opts.trigger : opts.field;

            opts.disableWeekends = !!opts.disableWeekends;

            opts.disableDayFn = (typeof opts.disableDayFn) === 'function' ? opts.disableDayFn : null;

            var nom = parseInt(opts.numberOfMonths, 10) || 1;
            opts.numberOfMonths = nom > 4 ? 4 : nom;

            if (!isDate(opts.minDate)) {
                opts.minDate = false;
            }
            if (!isDate(opts.maxDate)) {
                opts.maxDate = false;
            }
            if ((opts.minDate && opts.maxDate) && opts.maxDate < opts.minDate) {
                opts.maxDate = opts.minDate = false;
            }
            if (opts.minDate) {
                this.setMinDate(opts.minDate);
            }
            if (opts.maxDate) {
                this.setMaxDate(opts.maxDate);
            }

            if (isArray(opts.yearRange)) {
                var fallback = new Date().getFullYear() - 10;
                opts.yearRange[0] = parseInt(opts.yearRange[0], 10) || fallback;
                opts.yearRange[1] = parseInt(opts.yearRange[1], 10) || fallback;
            } else {
                opts.yearRange = Math.abs(parseInt(opts.yearRange, 10)) || defaults.yearRange;
                if (opts.yearRange > 100) {
                    opts.yearRange = 100;
                }
            }

            return opts;
        },

        /**
         * return a formatted string of the current selection (using Moment.js if available)
         */
        toString: function(format)
        {
            return !isDate(this._d) ? '' : hasMoment ? moment(this._d).format(format || this._o.format) : this._d.toDateString();
        },

        /**
         * return a Moment.js object of the current selection (if available)
         */
        getMoment: function()
        {
            return hasMoment ? moment(this._d) : null;
        },

        /**
         * set the current selection from a Moment.js object (if available)
         */
        setMoment: function(date, preventOnSelect)
        {
            if (hasMoment && moment.isMoment(date)) {
                this.setDate(date.toDate(), preventOnSelect);
            }
        },

        /**
         * return a Date object of the current selection with fallback for the current date
         */
        getDate: function()
        {
            return isDate(this._d) ? new Date(this._d.getTime()) : new Date();
        },

        /**
         * set the current selection
         */
        setDate: function(date, preventOnSelect)
        {
            if (!date) {
                this._d = null;

                if (this._o.field) {
                    this._o.field.value = '';
                    fireEvent(this._o.field, 'change', { firedBy: this });
                }

                return this.draw();
            }
            if (typeof date === 'string') {
                date = new Date(Date.parse(date));
            }
            if (!isDate(date)) {
                return;
            }

            var min = this._o.minDate,
                max = this._o.maxDate;

            if (isDate(min) && date < min) {
                date = min;
            } else if (isDate(max) && date > max) {
                date = max;
            }

            this._d = new Date(date.getTime());
            setToStartOfDay(this._d);
            this.gotoDate(this._d);

            if (this._o.field) {
                this._o.field.value = this.toString();
                fireEvent(this._o.field, 'change', { firedBy: this });
            }
            if (!preventOnSelect && typeof this._o.onSelect === 'function') {
                this._o.onSelect.call(this, this.getDate());
            }
        },

        /**
         * change view to a specific date
         */
        gotoDate: function(date)
        {
            var newCalendar = true;

            if (!isDate(date)) {
                return;
            }

            if (this.calendars) {
                var firstVisibleDate = new Date(this.calendars[0].year, this.calendars[0].month, 1),
                    lastVisibleDate = new Date(this.calendars[this.calendars.length-1].year, this.calendars[this.calendars.length-1].month, 1),
                    visibleDate = date.getTime();
                // get the end of the month
                lastVisibleDate.setMonth(lastVisibleDate.getMonth()+1);
                lastVisibleDate.setDate(lastVisibleDate.getDate()-1);
                newCalendar = (visibleDate < firstVisibleDate.getTime() || lastVisibleDate.getTime() < visibleDate);
            }

            if (newCalendar) {
                this.calendars = [{
                    month: date.getMonth(),
                    year: date.getFullYear()
                }];
                if (this._o.mainCalendar === 'right') {
                    this.calendars[0].month += 1 - this._o.numberOfMonths;
                }
            }

            this.adjustCalendars();
        },

        adjustDate: function(sign, days) {

            var day = this.getDate();
            var difference = parseInt(days)*24*60*60*1000;

            var newDay;

            if (sign === 'add') {
                newDay = new Date(day.valueOf() + difference);
            } else if (sign === 'subtract') {
                newDay = new Date(day.valueOf() - difference);
            }

            if (hasMoment) {
                if (sign === 'add') {
                    newDay = moment(day).add(days, "days").toDate();
                } else if (sign === 'subtract') {
                    newDay = moment(day).subtract(days, "days").toDate();
                }
            }

            this.setDate(newDay);
        },

        adjustCalendars: function() {
            this.calendars[0] = adjustCalendar(this.calendars[0]);
            for (var c = 1; c < this._o.numberOfMonths; c++) {
                this.calendars[c] = adjustCalendar({
                    month: this.calendars[0].month + c,
                    year: this.calendars[0].year
                });
            }
            this.draw();
        },

        gotoToday: function()
        {
            this.gotoDate(new Date());
        },

        /**
         * change view to a specific month (zero-index, e.g. 0: January)
         */
        gotoMonth: function(month)
        {
            if (!isNaN(month)) {
                this.calendars[0].month = parseInt(month, 10);
                this.adjustCalendars();
            }
        },

        nextMonth: function()
        {
            this.calendars[0].month++;
            this.adjustCalendars();
        },

        prevMonth: function()
        {
            this.calendars[0].month--;
            this.adjustCalendars();
        },

        /**
         * change view to a specific full year (e.g. "2012")
         */
        gotoYear: function(year)
        {
            if (!isNaN(year)) {
                this.calendars[0].year = parseInt(year, 10);
                this.adjustCalendars();
            }
        },

        /**
         * change the minDate
         */
        setMinDate: function(value)
        {
            if(value instanceof Date) {
                setToStartOfDay(value);
                this._o.minDate = value;
                this._o.minYear  = value.getFullYear();
                this._o.minMonth = value.getMonth();
            } else {
                this._o.minDate = defaults.minDate;
                this._o.minYear  = defaults.minYear;
                this._o.minMonth = defaults.minMonth;
                this._o.startRange = defaults.startRange;
            }

            this.draw();
        },

        /**
         * change the maxDate
         */
        setMaxDate: function(value)
        {
            if(value instanceof Date) {
                setToStartOfDay(value);
                this._o.maxDate = value;
                this._o.maxYear = value.getFullYear();
                this._o.maxMonth = value.getMonth();
            } else {
                this._o.maxDate = defaults.maxDate;
                this._o.maxYear = defaults.maxYear;
                this._o.maxMonth = defaults.maxMonth;
                this._o.endRange = defaults.endRange;
            }

            this.draw();
        },

        setStartRange: function(value)
        {
            this._o.startRange = value;
        },

        setEndRange: function(value)
        {
            this._o.endRange = value;
        },

        /**
         * refresh the HTML
         */
        draw: function(force)
        {
            if (!this._v && !force) {
                return;
            }
            var opts = this._o,
                minYear = opts.minYear,
                maxYear = opts.maxYear,
                minMonth = opts.minMonth,
                maxMonth = opts.maxMonth,
                html = '',
                randId;

            if (this._y <= minYear) {
                this._y = minYear;
                if (!isNaN(minMonth) && this._m < minMonth) {
                    this._m = minMonth;
                }
            }
            if (this._y >= maxYear) {
                this._y = maxYear;
                if (!isNaN(maxMonth) && this._m > maxMonth) {
                    this._m = maxMonth;
                }
            }

            randId = 'pika-title-' + Math.random().toString(36).replace(/[^a-z]+/g, '').substr(0, 2);

            for (var c = 0; c < opts.numberOfMonths; c++) {
                html += '<div class="pika-lendar">' + renderTitle(this, c, this.calendars[c].year, this.calendars[c].month, this.calendars[0].year, randId) + this.render(this.calendars[c].year, this.calendars[c].month, randId) + '</div>';
            }

            this.el.innerHTML = html;

            if (opts.bound) {
                if(opts.field.type !== 'hidden') {
                    sto(function() {
                        opts.trigger.focus();
                    }, 1);
                }
            }

            if (typeof this._o.onDraw === 'function') {
                this._o.onDraw(this);
            }
            
            if (opts.bound) {
                // let the screen reader user know to use arrow keys
                opts.field.setAttribute('aria-label', 'Use the arrow keys to pick a date');
            }
        },

        adjustPosition: function()
        {
            var field, pEl, width, height, viewportWidth, viewportHeight, scrollTop, left, top, clientRect;

            if (this._o.container) return;

            this.el.style.position = 'absolute';

            field = this._o.trigger;
            pEl = field;
            width = this.el.offsetWidth;
            height = this.el.offsetHeight;
            viewportWidth = window.innerWidth || document.documentElement.clientWidth;
            viewportHeight = window.innerHeight || document.documentElement.clientHeight;
            scrollTop = window.pageYOffset || document.body.scrollTop || document.documentElement.scrollTop;

            if (typeof field.getBoundingClientRect === 'function') {
                clientRect = field.getBoundingClientRect();
                left = clientRect.left + window.pageXOffset;
                top = clientRect.bottom + window.pageYOffset;
            } else {
                left = pEl.offsetLeft;
                top  = pEl.offsetTop + pEl.offsetHeight;
                while((pEl = pEl.offsetParent)) {
                    left += pEl.offsetLeft;
                    top  += pEl.offsetTop;
                }
            }

            // default position is bottom & left
            if ((this._o.reposition && left + width > viewportWidth) ||
                (
                    this._o.position.indexOf('right') > -1 &&
                    left - width + field.offsetWidth > 0
                )
            ) {
                left = left - width + field.offsetWidth;
            }
            if ((this._o.reposition && top + height > viewportHeight + scrollTop) ||
                (
                    this._o.position.indexOf('top') > -1 &&
                    top - height - field.offsetHeight > 0
                )
            ) {
                top = top - height - field.offsetHeight;
            }

            this.el.style.left = left + 'px';
            this.el.style.top = top + 'px';
        },

        /**
         * render HTML for a particular month
         */
        render: function(year, month, randId)
        {
            var opts   = this._o,
                now    = new Date(),
                days   = getDaysInMonth(year, month),
                before = new Date(year, month, 1).getDay(),
                data   = [],
                row    = [];
            setToStartOfDay(now);
            if (opts.firstDay > 0) {
                before -= opts.firstDay;
                if (before < 0) {
                    before += 7;
                }
            }
            var previousMonth = month === 0 ? 11 : month - 1,
                nextMonth = month === 11 ? 0 : month + 1,
                yearOfPreviousMonth = month === 0 ? year - 1 : year,
                yearOfNextMonth = month === 11 ? year + 1 : year,
                daysInPreviousMonth = getDaysInMonth(yearOfPreviousMonth, previousMonth);
            var cells = days + before,
                after = cells;
            while(after > 7) {
                after -= 7;
            }
            cells += 7 - after;
            for (var i = 0, r = 0; i < cells; i++)
            {
                var day = new Date(year, month, 1 + (i - before)),
                    isSelected = isDate(this._d) ? compareDates(day, this._d) : false,
                    isToday = compareDates(day, now),
                    isEmpty = i < before || i >= (days + before),
                    dayNumber = 1 + (i - before),
                    monthNumber = month,
                    yearNumber = year,
                    isStartRange = opts.startRange && compareDates(opts.startRange, day),
                    isEndRange = opts.endRange && compareDates(opts.endRange, day),
                    isInRange = opts.startRange && opts.endRange && opts.startRange < day && day < opts.endRange,
                    isDisabled = (opts.minDate && day < opts.minDate) ||
                                 (opts.maxDate && day > opts.maxDate) ||
                                 (opts.disableWeekends && isWeekend(day)) ||
                                 (opts.disableDayFn && opts.disableDayFn(day));

                if (isEmpty) {
                    if (i < before) {
                        dayNumber = daysInPreviousMonth + dayNumber;
                        monthNumber = previousMonth;
                        yearNumber = yearOfPreviousMonth;
                    } else {
                        dayNumber = dayNumber - days;
                        monthNumber = nextMonth;
                        yearNumber = yearOfNextMonth;
                    }
                }

                var dayConfig = {
                        day: dayNumber,
                        month: monthNumber,
                        year: yearNumber,
                        isSelected: isSelected,
                        isToday: isToday,
                        isDisabled: isDisabled,
                        isEmpty: isEmpty,
                        isStartRange: isStartRange,
                        isEndRange: isEndRange,
                        isInRange: isInRange,
                        showDaysInNextAndPreviousMonths: opts.showDaysInNextAndPreviousMonths
                    };

                row.push(renderDay(dayConfig));

                if (++r === 7) {
                    if (opts.showWeekNumber) {
                        row.unshift(renderWeek(i - before, month, year));
                    }
                    data.push(renderRow(row, opts.isRTL));
                    row = [];
                    r = 0;
                }
            }
            return renderTable(opts, data, randId);
        },

        isVisible: function()
        {
            return this._v;
        },

        show: function()
        {
            if (!this.isVisible()) {
                removeClass(this.el, 'is-hidden');
                this._v = true;
                this.draw();
                if (this._o.bound) {
                    addEvent(document, 'click', this._onClick);
                    this.adjustPosition();
                }
                if (typeof this._o.onOpen === 'function') {
                    this._o.onOpen.call(this);
                }
            }
        },

        hide: function()
        {
            var v = this._v;
            if (v !== false) {
                if (this._o.bound) {
                    removeEvent(document, 'click', this._onClick);
                }
                this.el.style.position = 'static'; // reset
                this.el.style.left = 'auto';
                this.el.style.top = 'auto';
                addClass(this.el, 'is-hidden');
                this._v = false;
                if (v !== undefined && typeof this._o.onClose === 'function') {
                    this._o.onClose.call(this);
                }
            }
        },

        /**
         * GAME OVER
         */
        destroy: function()
        {
            this.hide();
            removeEvent(this.el, 'mousedown', this._onMouseDown, true);
            removeEvent(this.el, 'touchend', this._onMouseDown, true);
            removeEvent(this.el, 'change', this._onChange);
            if (this._o.field) {
                removeEvent(this._o.field, 'change', this._onInputChange);
                if (this._o.bound) {
                    removeEvent(this._o.trigger, 'click', this._onInputClick);
                    removeEvent(this._o.trigger, 'focus', this._onInputFocus);
                    removeEvent(this._o.trigger, 'blur', this._onInputBlur);
                }
            }
            if (this.el.parentNode) {
                this.el.parentNode.removeChild(this.el);
            }
        }

    };

    return Pikaday;

}));

},{"moment":"moment"}],"zeroclipboard":[function(_dereq_,module,exports){
/*!
 * ZeroClipboard
 * The ZeroClipboard library provides an easy way to copy text to the clipboard using an invisible Adobe Flash movie and a JavaScript interface
 * Copyright (c) 2009-2016 Jon Rohan, James M. Greene
 * Licensed MIT
 * http://zeroclipboard.org/
 * v2.3.0
 */
(function(window, undefined) {
  "use strict";
  /**
 * Store references to critically important global functions that may be
 * overridden on certain web pages.
 */
  var _window = window, _document = _window.document, _navigator = _window.navigator, _setTimeout = _window.setTimeout, _clearTimeout = _window.clearTimeout, _setInterval = _window.setInterval, _clearInterval = _window.clearInterval, _getComputedStyle = _window.getComputedStyle, _encodeURIComponent = _window.encodeURIComponent, _ActiveXObject = _window.ActiveXObject, _Error = _window.Error, _parseInt = _window.Number.parseInt || _window.parseInt, _parseFloat = _window.Number.parseFloat || _window.parseFloat, _isNaN = _window.Number.isNaN || _window.isNaN, _now = _window.Date.now, _keys = _window.Object.keys, _hasOwn = _window.Object.prototype.hasOwnProperty, _slice = _window.Array.prototype.slice, _unwrap = function() {
    var unwrapper = function(el) {
      return el;
    };
    if (typeof _window.wrap === "function" && typeof _window.unwrap === "function") {
      try {
        var div = _document.createElement("div");
        var unwrappedDiv = _window.unwrap(div);
        if (div.nodeType === 1 && unwrappedDiv && unwrappedDiv.nodeType === 1) {
          unwrapper = _window.unwrap;
        }
      } catch (e) {}
    }
    return unwrapper;
  }();
  /**
 * Convert an `arguments` object into an Array.
 *
 * @returns The arguments as an Array
 * @private
 */
  var _args = function(argumentsObj) {
    return _slice.call(argumentsObj, 0);
  };
  /**
 * Shallow-copy the owned, enumerable properties of one object over to another, similar to jQuery's `$.extend`.
 *
 * @returns The target object, augmented
 * @private
 */
  var _extend = function() {
    var i, len, arg, prop, src, copy, args = _args(arguments), target = args[0] || {};
    for (i = 1, len = args.length; i < len; i++) {
      if ((arg = args[i]) != null) {
        for (prop in arg) {
          if (_hasOwn.call(arg, prop)) {
            src = target[prop];
            copy = arg[prop];
            if (target !== copy && copy !== undefined) {
              target[prop] = copy;
            }
          }
        }
      }
    }
    return target;
  };
  /**
 * Return a deep copy of the source object or array.
 *
 * @returns Object or Array
 * @private
 */
  var _deepCopy = function(source) {
    var copy, i, len, prop;
    if (typeof source !== "object" || source == null || typeof source.nodeType === "number") {
      copy = source;
    } else if (typeof source.length === "number") {
      copy = [];
      for (i = 0, len = source.length; i < len; i++) {
        if (_hasOwn.call(source, i)) {
          copy[i] = _deepCopy(source[i]);
        }
      }
    } else {
      copy = {};
      for (prop in source) {
        if (_hasOwn.call(source, prop)) {
          copy[prop] = _deepCopy(source[prop]);
        }
      }
    }
    return copy;
  };
  /**
 * Makes a shallow copy of `obj` (like `_extend`) but filters its properties based on a list of `keys` to keep.
 * The inverse of `_omit`, mostly. The big difference is that these properties do NOT need to be enumerable to
 * be kept.
 *
 * @returns A new filtered object.
 * @private
 */
  var _pick = function(obj, keys) {
    var newObj = {};
    for (var i = 0, len = keys.length; i < len; i++) {
      if (keys[i] in obj) {
        newObj[keys[i]] = obj[keys[i]];
      }
    }
    return newObj;
  };
  /**
 * Makes a shallow copy of `obj` (like `_extend`) but filters its properties based on a list of `keys` to omit.
 * The inverse of `_pick`.
 *
 * @returns A new filtered object.
 * @private
 */
  var _omit = function(obj, keys) {
    var newObj = {};
    for (var prop in obj) {
      if (keys.indexOf(prop) === -1) {
        newObj[prop] = obj[prop];
      }
    }
    return newObj;
  };
  /**
 * Remove all owned, enumerable properties from an object.
 *
 * @returns The original object without its owned, enumerable properties.
 * @private
 */
  var _deleteOwnProperties = function(obj) {
    if (obj) {
      for (var prop in obj) {
        if (_hasOwn.call(obj, prop)) {
          delete obj[prop];
        }
      }
    }
    return obj;
  };
  /**
 * Determine if an element is contained within another element.
 *
 * @returns Boolean
 * @private
 */
  var _containedBy = function(el, ancestorEl) {
    if (el && el.nodeType === 1 && el.ownerDocument && ancestorEl && (ancestorEl.nodeType === 1 && ancestorEl.ownerDocument && ancestorEl.ownerDocument === el.ownerDocument || ancestorEl.nodeType === 9 && !ancestorEl.ownerDocument && ancestorEl === el.ownerDocument)) {
      do {
        if (el === ancestorEl) {
          return true;
        }
        el = el.parentNode;
      } while (el);
    }
    return false;
  };
  /**
 * Get the URL path's parent directory.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getDirPathOfUrl = function(url) {
    var dir;
    if (typeof url === "string" && url) {
      dir = url.split("#")[0].split("?")[0];
      dir = url.slice(0, url.lastIndexOf("/") + 1);
    }
    return dir;
  };
  /**
 * Get the current script's URL by throwing an `Error` and analyzing it.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getCurrentScriptUrlFromErrorStack = function(stack) {
    var url, matches;
    if (typeof stack === "string" && stack) {
      matches = stack.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/);
      if (matches && matches[1]) {
        url = matches[1];
      } else {
        matches = stack.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/);
        if (matches && matches[1]) {
          url = matches[1];
        }
      }
    }
    return url;
  };
  /**
 * Get the current script's URL by throwing an `Error` and analyzing it.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getCurrentScriptUrlFromError = function() {
    var url, err;
    try {
      throw new _Error();
    } catch (e) {
      err = e;
    }
    if (err) {
      url = err.sourceURL || err.fileName || _getCurrentScriptUrlFromErrorStack(err.stack);
    }
    return url;
  };
  /**
 * Get the current script's URL.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getCurrentScriptUrl = function() {
    var jsPath, scripts, i;
    if (_document.currentScript && (jsPath = _document.currentScript.src)) {
      return jsPath;
    }
    scripts = _document.getElementsByTagName("script");
    if (scripts.length === 1) {
      return scripts[0].src || undefined;
    }
    if ("readyState" in (scripts[0] || document.createElement("script"))) {
      for (i = scripts.length; i--; ) {
        if (scripts[i].readyState === "interactive" && (jsPath = scripts[i].src)) {
          return jsPath;
        }
      }
    }
    if (_document.readyState === "loading" && (jsPath = scripts[scripts.length - 1].src)) {
      return jsPath;
    }
    if (jsPath = _getCurrentScriptUrlFromError()) {
      return jsPath;
    }
    return undefined;
  };
  /**
 * Get the unanimous parent directory of ALL script tags.
 * If any script tags are either (a) inline or (b) from differing parent
 * directories, this method must return `undefined`.
 *
 * @returns String or `undefined`
 * @private
 */
  var _getUnanimousScriptParentDir = function() {
    var i, jsDir, jsPath, scripts = _document.getElementsByTagName("script");
    for (i = scripts.length; i--; ) {
      if (!(jsPath = scripts[i].src)) {
        jsDir = null;
        break;
      }
      jsPath = _getDirPathOfUrl(jsPath);
      if (jsDir == null) {
        jsDir = jsPath;
      } else if (jsDir !== jsPath) {
        jsDir = null;
        break;
      }
    }
    return jsDir || undefined;
  };
  /**
 * Get the presumed location of the "ZeroClipboard.swf" file, based on the location
 * of the executing JavaScript file (e.g. "ZeroClipboard.js", etc.).
 *
 * @returns String
 * @private
 */
  var _getDefaultSwfPath = function() {
    var jsDir = _getDirPathOfUrl(_getCurrentScriptUrl()) || _getUnanimousScriptParentDir() || "";
    return jsDir + "ZeroClipboard.swf";
  };
  /**
 * Is the client's operating system some version of Windows?
 *
 * @returns Boolean
 * @private
 */
  var _isWindows = function() {
    var isWindowsRegex = /win(dows|[\s]?(nt|me|ce|xp|vista|[\d]+))/i;
    return !!_navigator && (isWindowsRegex.test(_navigator.appVersion || "") || isWindowsRegex.test(_navigator.platform || "") || (_navigator.userAgent || "").indexOf("Windows") !== -1);
  };
  /**
 * Keep track of if the page is framed (in an `iframe`). This can never change.
 * @private
 */
  var _pageIsFramed = function() {
    return _window.opener == null && (!!_window.top && _window != _window.top || !!_window.parent && _window != _window.parent);
  }();
  /**
 * Keep track of if the page is XHTML (vs. HTML), which requires that everything
 * be rendering in XML mode.
 * @private
 */
  var _pageIsXhtml = _document.documentElement.nodeName === "html";
  /**
 * Keep track of the state of the Flash object.
 * @private
 */
  var _flashState = {
    bridge: null,
    version: "0.0.0",
    pluginType: "unknown",
    sandboxed: null,
    disabled: null,
    outdated: null,
    insecure: null,
    unavailable: null,
    degraded: null,
    deactivated: null,
    overdue: null,
    ready: null
  };
  /**
 * The minimum Flash Player version required to use ZeroClipboard completely.
 * @readonly
 * @private
 */
  var _minimumFlashVersion = "11.0.0";
  /**
 * The ZeroClipboard library version number, as reported by Flash, at the time the SWF was compiled.
 */
  var _zcSwfVersion;
  /**
 * Keep track of all event listener registrations.
 * @private
 */
  var _handlers = {};
  /**
 * Keep track of the currently activated element.
 * @private
 */
  var _currentElement;
  /**
 * Keep track of the element that was activated when a `copy` process started.
 * @private
 */
  var _copyTarget;
  /**
 * Keep track of data for the pending clipboard transaction.
 * @private
 */
  var _clipData = {};
  /**
 * Keep track of data formats for the pending clipboard transaction.
 * @private
 */
  var _clipDataFormatMap = null;
  /**
 * Keep track of the Flash availability check timeout.
 * @private
 */
  var _flashCheckTimeout = 0;
  /**
 * Keep track of SWF network errors interval polling.
 * @private
 */
  var _swfFallbackCheckInterval = 0;
  /**
 * The `message` store for events
 * @private
 */
  var _eventMessages = {
    ready: "Flash communication is established",
    error: {
      "flash-sandboxed": "Attempting to run Flash in a sandboxed iframe, which is impossible",
      "flash-disabled": "Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.",
      "flash-outdated": "Flash is too outdated to support ZeroClipboard",
      "flash-insecure": "Flash will be unable to communicate due to a protocol mismatch between your `swfPath` configuration and the page",
      "flash-unavailable": "Flash is unable to communicate bidirectionally with JavaScript",
      "flash-degraded": "Flash is unable to preserve data fidelity when communicating with JavaScript",
      "flash-deactivated": "Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.",
      "flash-overdue": "Flash communication was established but NOT within the acceptable time limit",
      "version-mismatch": "ZeroClipboard JS version number does not match ZeroClipboard SWF version number",
      "clipboard-error": "At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard",
      "config-mismatch": "ZeroClipboard configuration does not match Flash's reality",
      "swf-not-found": "The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity",
      "browser-unsupported": "The browser does not support the required HTML DOM and JavaScript features"
    }
  };
  /**
 * The `name`s of `error` events that can only occur is Flash has at least
 * been able to load the SWF successfully.
 * @private
 */
  var _errorsThatOnlyOccurAfterFlashLoads = [ "flash-unavailable", "flash-degraded", "flash-overdue", "version-mismatch", "config-mismatch", "clipboard-error" ];
  /**
 * The `name`s of `error` events that should likely result in the `_flashState`
 * variable's property values being updated.
 * @private
 */
  var _flashStateErrorNames = [ "flash-sandboxed", "flash-disabled", "flash-outdated", "flash-insecure", "flash-unavailable", "flash-degraded", "flash-deactivated", "flash-overdue" ];
  /**
 * A RegExp to match the `name` property of `error` events related to Flash.
 * @private
 */
  var _flashStateErrorNameMatchingRegex = new RegExp("^flash-(" + _flashStateErrorNames.map(function(errorName) {
    return errorName.replace(/^flash-/, "");
  }).join("|") + ")$");
  /**
 * A RegExp to match the `name` property of `error` events related to Flash,
 * which is enabled.
 * @private
 */
  var _flashStateEnabledErrorNameMatchingRegex = new RegExp("^flash-(" + _flashStateErrorNames.filter(function(errorName) {
    return errorName !== "flash-disabled";
  }).map(function(errorName) {
    return errorName.replace(/^flash-/, "");
  }).join("|") + ")$");
  /**
 * ZeroClipboard configuration defaults for the Core module.
 * @private
 */
  var _globalConfig = {
    swfPath: _getDefaultSwfPath(),
    trustedDomains: _window.location.host ? [ _window.location.host ] : [],
    cacheBust: true,
    forceEnhancedClipboard: false,
    flashLoadTimeout: 3e4,
    autoActivate: true,
    bubbleEvents: true,
    fixLineEndings: true,
    containerId: "global-zeroclipboard-html-bridge",
    containerClass: "global-zeroclipboard-container",
    swfObjectId: "global-zeroclipboard-flash-bridge",
    hoverClass: "zeroclipboard-is-hover",
    activeClass: "zeroclipboard-is-active",
    forceHandCursor: false,
    title: null,
    zIndex: 999999999
  };
  /**
 * The underlying implementation of `ZeroClipboard.config`.
 * @private
 */
  var _config = function(options) {
    if (typeof options === "object" && options && !("length" in options)) {
      _keys(options).forEach(function(prop) {
        if (/^(?:forceHandCursor|title|zIndex|bubbleEvents|fixLineEndings)$/.test(prop)) {
          _globalConfig[prop] = options[prop];
        } else if (_flashState.bridge == null) {
          if (prop === "containerId" || prop === "swfObjectId") {
            if (_isValidHtml4Id(options[prop])) {
              _globalConfig[prop] = options[prop];
            } else {
              throw new Error("The specified `" + prop + "` value is not valid as an HTML4 Element ID");
            }
          } else {
            _globalConfig[prop] = options[prop];
          }
        }
      });
    }
    if (typeof options === "string" && options) {
      if (_hasOwn.call(_globalConfig, options)) {
        return _globalConfig[options];
      }
      return;
    }
    return _deepCopy(_globalConfig);
  };
  /**
 * The underlying implementation of `ZeroClipboard.state`.
 * @private
 */
  var _state = function() {
    _detectSandbox();
    return {
      browser: _extend(_pick(_navigator, [ "userAgent", "platform", "appName", "appVersion" ]), {
        isSupported: _isBrowserSupported()
      }),
      flash: _omit(_flashState, [ "bridge" ]),
      zeroclipboard: {
        version: ZeroClipboard.version,
        config: ZeroClipboard.config()
      }
    };
  };
  /**
 * Does this browser support all of the necessary DOM and JS features necessary?
 * @private
 */
  var _isBrowserSupported = function() {
    return !!(_document.addEventListener && _window.Object.keys && _window.Array.prototype.map);
  };
  /**
 * The underlying implementation of `ZeroClipboard.isFlashUnusable`.
 * @private
 */
  var _isFlashUnusable = function() {
    return !!(_flashState.sandboxed || _flashState.disabled || _flashState.outdated || _flashState.unavailable || _flashState.degraded || _flashState.deactivated);
  };
  /**
 * The underlying implementation of `ZeroClipboard.on`.
 * @private
 */
  var _on = function(eventType, listener) {
    var i, len, events, added = {};
    if (typeof eventType === "string" && eventType) {
      events = eventType.toLowerCase().split(/\s+/);
    } else if (typeof eventType === "object" && eventType && !("length" in eventType) && typeof listener === "undefined") {
      _keys(eventType).forEach(function(key) {
        var listener = eventType[key];
        if (typeof listener === "function") {
          ZeroClipboard.on(key, listener);
        }
      });
    }
    if (events && events.length && listener) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].replace(/^on/, "");
        added[eventType] = true;
        if (!_handlers[eventType]) {
          _handlers[eventType] = [];
        }
        _handlers[eventType].push(listener);
      }
      if (added.ready && _flashState.ready) {
        ZeroClipboard.emit({
          type: "ready"
        });
      }
      if (added.error) {
        if (!_isBrowserSupported()) {
          ZeroClipboard.emit({
            type: "error",
            name: "browser-unsupported"
          });
        }
        for (i = 0, len = _flashStateErrorNames.length; i < len; i++) {
          if (_flashState[_flashStateErrorNames[i].replace(/^flash-/, "")] === true) {
            ZeroClipboard.emit({
              type: "error",
              name: _flashStateErrorNames[i]
            });
            break;
          }
        }
        if (_zcSwfVersion !== undefined && ZeroClipboard.version !== _zcSwfVersion) {
          ZeroClipboard.emit({
            type: "error",
            name: "version-mismatch",
            jsVersion: ZeroClipboard.version,
            swfVersion: _zcSwfVersion
          });
        }
      }
    }
    return ZeroClipboard;
  };
  /**
 * The underlying implementation of `ZeroClipboard.off`.
 * @private
 */
  var _off = function(eventType, listener) {
    var i, len, foundIndex, events, perEventHandlers;
    if (arguments.length === 0) {
      events = _keys(_handlers);
    } else if (typeof eventType === "string" && eventType) {
      events = eventType.toLowerCase().split(/\s+/);
    } else if (typeof eventType === "object" && eventType && !("length" in eventType) && typeof listener === "undefined") {
      _keys(eventType).forEach(function(key) {
        var listener = eventType[key];
        if (typeof listener === "function") {
          ZeroClipboard.off(key, listener);
        }
      });
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].replace(/^on/, "");
        perEventHandlers = _handlers[eventType];
        if (perEventHandlers && perEventHandlers.length) {
          if (listener) {
            foundIndex = perEventHandlers.indexOf(listener);
            while (foundIndex !== -1) {
              perEventHandlers.splice(foundIndex, 1);
              foundIndex = perEventHandlers.indexOf(listener, foundIndex);
            }
          } else {
            perEventHandlers.length = 0;
          }
        }
      }
    }
    return ZeroClipboard;
  };
  /**
 * The underlying implementation of `ZeroClipboard.handlers`.
 * @private
 */
  var _listeners = function(eventType) {
    var copy;
    if (typeof eventType === "string" && eventType) {
      copy = _deepCopy(_handlers[eventType]) || null;
    } else {
      copy = _deepCopy(_handlers);
    }
    return copy;
  };
  /**
 * The underlying implementation of `ZeroClipboard.emit`.
 * @private
 */
  var _emit = function(event) {
    var eventCopy, returnVal, tmp;
    event = _createEvent(event);
    if (!event) {
      return;
    }
    if (_preprocessEvent(event)) {
      return;
    }
    if (event.type === "ready" && _flashState.overdue === true) {
      return ZeroClipboard.emit({
        type: "error",
        name: "flash-overdue"
      });
    }
    eventCopy = _extend({}, event);
    _dispatchCallbacks.call(this, eventCopy);
    if (event.type === "copy") {
      tmp = _mapClipDataToFlash(_clipData);
      returnVal = tmp.data;
      _clipDataFormatMap = tmp.formatMap;
    }
    return returnVal;
  };
  /**
 * Get the protocol of the configured SWF path.
 * @private
 */
  var _getSwfPathProtocol = function() {
    var swfPath = _globalConfig.swfPath || "", swfPathFirstTwoChars = swfPath.slice(0, 2), swfProtocol = swfPath.slice(0, swfPath.indexOf("://") + 1);
    return swfPathFirstTwoChars === "\\\\" ? "file:" : swfPathFirstTwoChars === "//" || swfProtocol === "" ? _window.location.protocol : swfProtocol;
  };
  /**
 * The underlying implementation of `ZeroClipboard.create`.
 * @private
 */
  var _create = function() {
    var maxWait, swfProtocol, previousState = _flashState.sandboxed;
    if (!_isBrowserSupported()) {
      _flashState.ready = false;
      ZeroClipboard.emit({
        type: "error",
        name: "browser-unsupported"
      });
      return;
    }
    _detectSandbox();
    if (typeof _flashState.ready !== "boolean") {
      _flashState.ready = false;
    }
    if (_flashState.sandboxed !== previousState && _flashState.sandboxed === true) {
      _flashState.ready = false;
      ZeroClipboard.emit({
        type: "error",
        name: "flash-sandboxed"
      });
    } else if (!ZeroClipboard.isFlashUnusable() && _flashState.bridge === null) {
      swfProtocol = _getSwfPathProtocol();
      if (swfProtocol && swfProtocol !== _window.location.protocol) {
        ZeroClipboard.emit({
          type: "error",
          name: "flash-insecure"
        });
      } else {
        maxWait = _globalConfig.flashLoadTimeout;
        if (typeof maxWait === "number" && maxWait >= 0) {
          _flashCheckTimeout = _setTimeout(function() {
            if (typeof _flashState.deactivated !== "boolean") {
              _flashState.deactivated = true;
            }
            if (_flashState.deactivated === true) {
              ZeroClipboard.emit({
                type: "error",
                name: "flash-deactivated"
              });
            }
          }, maxWait);
        }
        _flashState.overdue = false;
        _embedSwf();
      }
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.destroy`.
 * @private
 */
  var _destroy = function() {
    ZeroClipboard.clearData();
    ZeroClipboard.blur();
    ZeroClipboard.emit("destroy");
    _unembedSwf();
    ZeroClipboard.off();
  };
  /**
 * The underlying implementation of `ZeroClipboard.setData`.
 * @private
 */
  var _setData = function(format, data) {
    var dataObj;
    if (typeof format === "object" && format && typeof data === "undefined") {
      dataObj = format;
      ZeroClipboard.clearData();
    } else if (typeof format === "string" && format) {
      dataObj = {};
      dataObj[format] = data;
    } else {
      return;
    }
    for (var dataFormat in dataObj) {
      if (typeof dataFormat === "string" && dataFormat && _hasOwn.call(dataObj, dataFormat) && typeof dataObj[dataFormat] === "string" && dataObj[dataFormat]) {
        _clipData[dataFormat] = _fixLineEndings(dataObj[dataFormat]);
      }
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.clearData`.
 * @private
 */
  var _clearData = function(format) {
    if (typeof format === "undefined") {
      _deleteOwnProperties(_clipData);
      _clipDataFormatMap = null;
    } else if (typeof format === "string" && _hasOwn.call(_clipData, format)) {
      delete _clipData[format];
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.getData`.
 * @private
 */
  var _getData = function(format) {
    if (typeof format === "undefined") {
      return _deepCopy(_clipData);
    } else if (typeof format === "string" && _hasOwn.call(_clipData, format)) {
      return _clipData[format];
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.focus`/`ZeroClipboard.activate`.
 * @private
 */
  var _focus = function(element) {
    if (!(element && element.nodeType === 1)) {
      return;
    }
    if (_currentElement) {
      _removeClass(_currentElement, _globalConfig.activeClass);
      if (_currentElement !== element) {
        _removeClass(_currentElement, _globalConfig.hoverClass);
      }
    }
    _currentElement = element;
    _addClass(element, _globalConfig.hoverClass);
    var newTitle = element.getAttribute("title") || _globalConfig.title;
    if (typeof newTitle === "string" && newTitle) {
      var htmlBridge = _getHtmlBridge(_flashState.bridge);
      if (htmlBridge) {
        htmlBridge.setAttribute("title", newTitle);
      }
    }
    var useHandCursor = _globalConfig.forceHandCursor === true || _getStyle(element, "cursor") === "pointer";
    _setHandCursor(useHandCursor);
    _reposition();
  };
  /**
 * The underlying implementation of `ZeroClipboard.blur`/`ZeroClipboard.deactivate`.
 * @private
 */
  var _blur = function() {
    var htmlBridge = _getHtmlBridge(_flashState.bridge);
    if (htmlBridge) {
      htmlBridge.removeAttribute("title");
      htmlBridge.style.left = "0px";
      htmlBridge.style.top = "-9999px";
      htmlBridge.style.width = "1px";
      htmlBridge.style.height = "1px";
    }
    if (_currentElement) {
      _removeClass(_currentElement, _globalConfig.hoverClass);
      _removeClass(_currentElement, _globalConfig.activeClass);
      _currentElement = null;
    }
  };
  /**
 * The underlying implementation of `ZeroClipboard.activeElement`.
 * @private
 */
  var _activeElement = function() {
    return _currentElement || null;
  };
  /**
 * Check if a value is a valid HTML4 `ID` or `Name` token.
 * @private
 */
  var _isValidHtml4Id = function(id) {
    return typeof id === "string" && id && /^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(id);
  };
  /**
 * Create or update an `event` object, based on the `eventType`.
 * @private
 */
  var _createEvent = function(event) {
    var eventType;
    if (typeof event === "string" && event) {
      eventType = event;
      event = {};
    } else if (typeof event === "object" && event && typeof event.type === "string" && event.type) {
      eventType = event.type;
    }
    if (!eventType) {
      return;
    }
    eventType = eventType.toLowerCase();
    if (!event.target && (/^(copy|aftercopy|_click)$/.test(eventType) || eventType === "error" && event.name === "clipboard-error")) {
      event.target = _copyTarget;
    }
    _extend(event, {
      type: eventType,
      target: event.target || _currentElement || null,
      relatedTarget: event.relatedTarget || null,
      currentTarget: _flashState && _flashState.bridge || null,
      timeStamp: event.timeStamp || _now() || null
    });
    var msg = _eventMessages[event.type];
    if (event.type === "error" && event.name && msg) {
      msg = msg[event.name];
    }
    if (msg) {
      event.message = msg;
    }
    if (event.type === "ready") {
      _extend(event, {
        target: null,
        version: _flashState.version
      });
    }
    if (event.type === "error") {
      if (_flashStateErrorNameMatchingRegex.test(event.name)) {
        _extend(event, {
          target: null,
          minimumVersion: _minimumFlashVersion
        });
      }
      if (_flashStateEnabledErrorNameMatchingRegex.test(event.name)) {
        _extend(event, {
          version: _flashState.version
        });
      }
      if (event.name === "flash-insecure") {
        _extend(event, {
          pageProtocol: _window.location.protocol,
          swfProtocol: _getSwfPathProtocol()
        });
      }
    }
    if (event.type === "copy") {
      event.clipboardData = {
        setData: ZeroClipboard.setData,
        clearData: ZeroClipboard.clearData
      };
    }
    if (event.type === "aftercopy") {
      event = _mapClipResultsFromFlash(event, _clipDataFormatMap);
    }
    if (event.target && !event.relatedTarget) {
      event.relatedTarget = _getRelatedTarget(event.target);
    }
    return _addMouseData(event);
  };
  /**
 * Get a relatedTarget from the target's `data-clipboard-target` attribute
 * @private
 */
  var _getRelatedTarget = function(targetEl) {
    var relatedTargetId = targetEl && targetEl.getAttribute && targetEl.getAttribute("data-clipboard-target");
    return relatedTargetId ? _document.getElementById(relatedTargetId) : null;
  };
  /**
 * Add element and position data to `MouseEvent` instances
 * @private
 */
  var _addMouseData = function(event) {
    if (event && /^_(?:click|mouse(?:over|out|down|up|move))$/.test(event.type)) {
      var srcElement = event.target;
      var fromElement = event.type === "_mouseover" && event.relatedTarget ? event.relatedTarget : undefined;
      var toElement = event.type === "_mouseout" && event.relatedTarget ? event.relatedTarget : undefined;
      var pos = _getElementPosition(srcElement);
      var screenLeft = _window.screenLeft || _window.screenX || 0;
      var screenTop = _window.screenTop || _window.screenY || 0;
      var scrollLeft = _document.body.scrollLeft + _document.documentElement.scrollLeft;
      var scrollTop = _document.body.scrollTop + _document.documentElement.scrollTop;
      var pageX = pos.left + (typeof event._stageX === "number" ? event._stageX : 0);
      var pageY = pos.top + (typeof event._stageY === "number" ? event._stageY : 0);
      var clientX = pageX - scrollLeft;
      var clientY = pageY - scrollTop;
      var screenX = screenLeft + clientX;
      var screenY = screenTop + clientY;
      var moveX = typeof event.movementX === "number" ? event.movementX : 0;
      var moveY = typeof event.movementY === "number" ? event.movementY : 0;
      delete event._stageX;
      delete event._stageY;
      _extend(event, {
        srcElement: srcElement,
        fromElement: fromElement,
        toElement: toElement,
        screenX: screenX,
        screenY: screenY,
        pageX: pageX,
        pageY: pageY,
        clientX: clientX,
        clientY: clientY,
        x: clientX,
        y: clientY,
        movementX: moveX,
        movementY: moveY,
        offsetX: 0,
        offsetY: 0,
        layerX: 0,
        layerY: 0
      });
    }
    return event;
  };
  /**
 * Determine if an event's registered handlers should be execute synchronously or asynchronously.
 *
 * @returns {boolean}
 * @private
 */
  var _shouldPerformAsync = function(event) {
    var eventType = event && typeof event.type === "string" && event.type || "";
    return !/^(?:(?:before)?copy|destroy)$/.test(eventType);
  };
  /**
 * Control if a callback should be executed asynchronously or not.
 *
 * @returns `undefined`
 * @private
 */
  var _dispatchCallback = function(func, context, args, async) {
    if (async) {
      _setTimeout(function() {
        func.apply(context, args);
      }, 0);
    } else {
      func.apply(context, args);
    }
  };
  /**
 * Handle the actual dispatching of events to client instances.
 *
 * @returns `undefined`
 * @private
 */
  var _dispatchCallbacks = function(event) {
    if (!(typeof event === "object" && event && event.type)) {
      return;
    }
    var async = _shouldPerformAsync(event);
    var wildcardTypeHandlers = _handlers["*"] || [];
    var specificTypeHandlers = _handlers[event.type] || [];
    var handlers = wildcardTypeHandlers.concat(specificTypeHandlers);
    if (handlers && handlers.length) {
      var i, len, func, context, eventCopy, originalContext = this;
      for (i = 0, len = handlers.length; i < len; i++) {
        func = handlers[i];
        context = originalContext;
        if (typeof func === "string" && typeof _window[func] === "function") {
          func = _window[func];
        }
        if (typeof func === "object" && func && typeof func.handleEvent === "function") {
          context = func;
          func = func.handleEvent;
        }
        if (typeof func === "function") {
          eventCopy = _extend({}, event);
          _dispatchCallback(func, context, [ eventCopy ], async);
        }
      }
    }
    return this;
  };
  /**
 * Check an `error` event's `name` property to see if Flash has
 * already loaded, which rules out possible `iframe` sandboxing.
 * @private
 */
  var _getSandboxStatusFromErrorEvent = function(event) {
    var isSandboxed = null;
    if (_pageIsFramed === false || event && event.type === "error" && event.name && _errorsThatOnlyOccurAfterFlashLoads.indexOf(event.name) !== -1) {
      isSandboxed = false;
    }
    return isSandboxed;
  };
  /**
 * Preprocess any special behaviors, reactions, or state changes after receiving this event.
 * Executes only once per event emitted, NOT once per client.
 * @private
 */
  var _preprocessEvent = function(event) {
    var element = event.target || _currentElement || null;
    var sourceIsSwf = event._source === "swf";
    delete event._source;
    switch (event.type) {
     case "error":
      var isSandboxed = event.name === "flash-sandboxed" || _getSandboxStatusFromErrorEvent(event);
      if (typeof isSandboxed === "boolean") {
        _flashState.sandboxed = isSandboxed;
      }
      if (event.name === "browser-unsupported") {
        _extend(_flashState, {
          disabled: false,
          outdated: false,
          unavailable: false,
          degraded: false,
          deactivated: false,
          overdue: false,
          ready: false
        });
      } else if (_flashStateErrorNames.indexOf(event.name) !== -1) {
        _extend(_flashState, {
          disabled: event.name === "flash-disabled",
          outdated: event.name === "flash-outdated",
          insecure: event.name === "flash-insecure",
          unavailable: event.name === "flash-unavailable",
          degraded: event.name === "flash-degraded",
          deactivated: event.name === "flash-deactivated",
          overdue: event.name === "flash-overdue",
          ready: false
        });
      } else if (event.name === "version-mismatch") {
        _zcSwfVersion = event.swfVersion;
        _extend(_flashState, {
          disabled: false,
          outdated: false,
          insecure: false,
          unavailable: false,
          degraded: false,
          deactivated: false,
          overdue: false,
          ready: false
        });
      }
      _clearTimeoutsAndPolling();
      break;

     case "ready":
      _zcSwfVersion = event.swfVersion;
      var wasDeactivated = _flashState.deactivated === true;
      _extend(_flashState, {
        sandboxed: false,
        disabled: false,
        outdated: false,
        insecure: false,
        unavailable: false,
        degraded: false,
        deactivated: false,
        overdue: wasDeactivated,
        ready: !wasDeactivated
      });
      _clearTimeoutsAndPolling();
      break;

     case "beforecopy":
      _copyTarget = element;
      break;

     case "copy":
      var textContent, htmlContent, targetEl = event.relatedTarget;
      if (!(_clipData["text/html"] || _clipData["text/plain"]) && targetEl && (htmlContent = targetEl.value || targetEl.outerHTML || targetEl.innerHTML) && (textContent = targetEl.value || targetEl.textContent || targetEl.innerText)) {
        event.clipboardData.clearData();
        event.clipboardData.setData("text/plain", textContent);
        if (htmlContent !== textContent) {
          event.clipboardData.setData("text/html", htmlContent);
        }
      } else if (!_clipData["text/plain"] && event.target && (textContent = event.target.getAttribute("data-clipboard-text"))) {
        event.clipboardData.clearData();
        event.clipboardData.setData("text/plain", textContent);
      }
      break;

     case "aftercopy":
      _queueEmitClipboardErrors(event);
      ZeroClipboard.clearData();
      if (element && element !== _safeActiveElement() && element.focus) {
        element.focus();
      }
      break;

     case "_mouseover":
      ZeroClipboard.focus(element);
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        if (element && element !== event.relatedTarget && !_containedBy(event.relatedTarget, element)) {
          _fireMouseEvent(_extend({}, event, {
            type: "mouseenter",
            bubbles: false,
            cancelable: false
          }));
        }
        _fireMouseEvent(_extend({}, event, {
          type: "mouseover"
        }));
      }
      break;

     case "_mouseout":
      ZeroClipboard.blur();
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        if (element && element !== event.relatedTarget && !_containedBy(event.relatedTarget, element)) {
          _fireMouseEvent(_extend({}, event, {
            type: "mouseleave",
            bubbles: false,
            cancelable: false
          }));
        }
        _fireMouseEvent(_extend({}, event, {
          type: "mouseout"
        }));
      }
      break;

     case "_mousedown":
      _addClass(element, _globalConfig.activeClass);
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;

     case "_mouseup":
      _removeClass(element, _globalConfig.activeClass);
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;

     case "_click":
      _copyTarget = null;
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;

     case "_mousemove":
      if (_globalConfig.bubbleEvents === true && sourceIsSwf) {
        _fireMouseEvent(_extend({}, event, {
          type: event.type.slice(1)
        }));
      }
      break;
    }
    if (/^_(?:click|mouse(?:over|out|down|up|move))$/.test(event.type)) {
      return true;
    }
  };
  /**
 * Check an "aftercopy" event for clipboard errors and emit a corresponding "error" event.
 * @private
 */
  var _queueEmitClipboardErrors = function(aftercopyEvent) {
    if (aftercopyEvent.errors && aftercopyEvent.errors.length > 0) {
      var errorEvent = _deepCopy(aftercopyEvent);
      _extend(errorEvent, {
        type: "error",
        name: "clipboard-error"
      });
      delete errorEvent.success;
      _setTimeout(function() {
        ZeroClipboard.emit(errorEvent);
      }, 0);
    }
  };
  /**
 * Dispatch a synthetic MouseEvent.
 *
 * @returns `undefined`
 * @private
 */
  var _fireMouseEvent = function(event) {
    if (!(event && typeof event.type === "string" && event)) {
      return;
    }
    var e, target = event.target || null, doc = target && target.ownerDocument || _document, defaults = {
      view: doc.defaultView || _window,
      canBubble: true,
      cancelable: true,
      detail: event.type === "click" ? 1 : 0,
      button: typeof event.which === "number" ? event.which - 1 : typeof event.button === "number" ? event.button : doc.createEvent ? 0 : 1
    }, args = _extend(defaults, event);
    if (!target) {
      return;
    }
    if (doc.createEvent && target.dispatchEvent) {
      args = [ args.type, args.canBubble, args.cancelable, args.view, args.detail, args.screenX, args.screenY, args.clientX, args.clientY, args.ctrlKey, args.altKey, args.shiftKey, args.metaKey, args.button, args.relatedTarget ];
      e = doc.createEvent("MouseEvents");
      if (e.initMouseEvent) {
        e.initMouseEvent.apply(e, args);
        e._source = "js";
        target.dispatchEvent(e);
      }
    }
  };
  /**
 * Continuously poll the DOM until either:
 *  (a) the fallback content becomes visible, or
 *  (b) we receive an event from SWF (handled elsewhere)
 *
 * IMPORTANT:
 * This is NOT a necessary check but it can result in significantly faster
 * detection of bad `swfPath` configuration and/or network/server issues [in
 * supported browsers] than waiting for the entire `flashLoadTimeout` duration
 * to elapse before detecting that the SWF cannot be loaded. The detection
 * duration can be anywhere from 10-30 times faster [in supported browsers] by
 * using this approach.
 *
 * @returns `undefined`
 * @private
 */
  var _watchForSwfFallbackContent = function() {
    var maxWait = _globalConfig.flashLoadTimeout;
    if (typeof maxWait === "number" && maxWait >= 0) {
      var pollWait = Math.min(1e3, maxWait / 10);
      var fallbackContentId = _globalConfig.swfObjectId + "_fallbackContent";
      _swfFallbackCheckInterval = _setInterval(function() {
        var el = _document.getElementById(fallbackContentId);
        if (_isElementVisible(el)) {
          _clearTimeoutsAndPolling();
          _flashState.deactivated = null;
          ZeroClipboard.emit({
            type: "error",
            name: "swf-not-found"
          });
        }
      }, pollWait);
    }
  };
  /**
 * Create the HTML bridge element to embed the Flash object into.
 * @private
 */
  var _createHtmlBridge = function() {
    var container = _document.createElement("div");
    container.id = _globalConfig.containerId;
    container.className = _globalConfig.containerClass;
    container.style.position = "absolute";
    container.style.left = "0px";
    container.style.top = "-9999px";
    container.style.width = "1px";
    container.style.height = "1px";
    container.style.zIndex = "" + _getSafeZIndex(_globalConfig.zIndex);
    return container;
  };
  /**
 * Get the HTML element container that wraps the Flash bridge object/element.
 * @private
 */
  var _getHtmlBridge = function(flashBridge) {
    var htmlBridge = flashBridge && flashBridge.parentNode;
    while (htmlBridge && htmlBridge.nodeName === "OBJECT" && htmlBridge.parentNode) {
      htmlBridge = htmlBridge.parentNode;
    }
    return htmlBridge || null;
  };
  /**
 *
 * @private
 */
  var _escapeXmlValue = function(val) {
    if (typeof val !== "string" || !val) {
      return val;
    }
    return val.replace(/["&'<>]/g, function(chr) {
      switch (chr) {
       case '"':
        return "&quot;";

       case "&":
        return "&amp;";

       case "'":
        return "&apos;";

       case "<":
        return "&lt;";

       case ">":
        return "&gt;";

       default:
        return chr;
      }
    });
  };
  /**
 * Create the SWF object.
 *
 * @returns The SWF object reference.
 * @private
 */
  var _embedSwf = function() {
    var len, flashBridge = _flashState.bridge, container = _getHtmlBridge(flashBridge);
    if (!flashBridge) {
      var allowScriptAccess = _determineScriptAccess(_window.location.host, _globalConfig);
      var allowNetworking = allowScriptAccess === "never" ? "none" : "all";
      var flashvars = _vars(_extend({
        jsVersion: ZeroClipboard.version
      }, _globalConfig));
      var swfUrl = _globalConfig.swfPath + _cacheBust(_globalConfig.swfPath, _globalConfig);
      if (_pageIsXhtml) {
        swfUrl = _escapeXmlValue(swfUrl);
      }
      container = _createHtmlBridge();
      var divToBeReplaced = _document.createElement("div");
      container.appendChild(divToBeReplaced);
      _document.body.appendChild(container);
      var tmpDiv = _document.createElement("div");
      var usingActiveX = _flashState.pluginType === "activex";
      tmpDiv.innerHTML = '<object id="' + _globalConfig.swfObjectId + '" name="' + _globalConfig.swfObjectId + '" ' + 'width="100%" height="100%" ' + (usingActiveX ? 'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"' : 'type="application/x-shockwave-flash" data="' + swfUrl + '"') + ">" + (usingActiveX ? '<param name="movie" value="' + swfUrl + '"/>' : "") + '<param name="allowScriptAccess" value="' + allowScriptAccess + '"/>' + '<param name="allowNetworking" value="' + allowNetworking + '"/>' + '<param name="menu" value="false"/>' + '<param name="wmode" value="transparent"/>' + '<param name="flashvars" value="' + flashvars + '"/>' + '<div id="' + _globalConfig.swfObjectId + '_fallbackContent">&nbsp;</div>' + "</object>";
      flashBridge = tmpDiv.firstChild;
      tmpDiv = null;
      _unwrap(flashBridge).ZeroClipboard = ZeroClipboard;
      container.replaceChild(flashBridge, divToBeReplaced);
      _watchForSwfFallbackContent();
    }
    if (!flashBridge) {
      flashBridge = _document[_globalConfig.swfObjectId];
      if (flashBridge && (len = flashBridge.length)) {
        flashBridge = flashBridge[len - 1];
      }
      if (!flashBridge && container) {
        flashBridge = container.firstChild;
      }
    }
    _flashState.bridge = flashBridge || null;
    return flashBridge;
  };
  /**
 * Destroy the SWF object.
 * @private
 */
  var _unembedSwf = function() {
    var flashBridge = _flashState.bridge;
    if (flashBridge) {
      var htmlBridge = _getHtmlBridge(flashBridge);
      if (htmlBridge) {
        if (_flashState.pluginType === "activex" && "readyState" in flashBridge) {
          flashBridge.style.display = "none";
          (function removeSwfFromIE() {
            if (flashBridge.readyState === 4) {
              for (var prop in flashBridge) {
                if (typeof flashBridge[prop] === "function") {
                  flashBridge[prop] = null;
                }
              }
              if (flashBridge.parentNode) {
                flashBridge.parentNode.removeChild(flashBridge);
              }
              if (htmlBridge.parentNode) {
                htmlBridge.parentNode.removeChild(htmlBridge);
              }
            } else {
              _setTimeout(removeSwfFromIE, 10);
            }
          })();
        } else {
          if (flashBridge.parentNode) {
            flashBridge.parentNode.removeChild(flashBridge);
          }
          if (htmlBridge.parentNode) {
            htmlBridge.parentNode.removeChild(htmlBridge);
          }
        }
      }
      _clearTimeoutsAndPolling();
      _flashState.ready = null;
      _flashState.bridge = null;
      _flashState.deactivated = null;
      _flashState.insecure = null;
      _zcSwfVersion = undefined;
    }
  };
  /**
 * Map the data format names of the "clipData" to Flash-friendly names.
 *
 * @returns A new transformed object.
 * @private
 */
  var _mapClipDataToFlash = function(clipData) {
    var newClipData = {}, formatMap = {};
    if (!(typeof clipData === "object" && clipData)) {
      return;
    }
    for (var dataFormat in clipData) {
      if (dataFormat && _hasOwn.call(clipData, dataFormat) && typeof clipData[dataFormat] === "string" && clipData[dataFormat]) {
        switch (dataFormat.toLowerCase()) {
         case "text/plain":
         case "text":
         case "air:text":
         case "flash:text":
          newClipData.text = clipData[dataFormat];
          formatMap.text = dataFormat;
          break;

         case "text/html":
         case "html":
         case "air:html":
         case "flash:html":
          newClipData.html = clipData[dataFormat];
          formatMap.html = dataFormat;
          break;

         case "application/rtf":
         case "text/rtf":
         case "rtf":
         case "richtext":
         case "air:rtf":
         case "flash:rtf":
          newClipData.rtf = clipData[dataFormat];
          formatMap.rtf = dataFormat;
          break;

         default:
          break;
        }
      }
    }
    return {
      data: newClipData,
      formatMap: formatMap
    };
  };
  /**
 * Map the data format names from Flash-friendly names back to their original "clipData" names (via a format mapping).
 *
 * @returns A new transformed object.
 * @private
 */
  var _mapClipResultsFromFlash = function(clipResults, formatMap) {
    if (!(typeof clipResults === "object" && clipResults && typeof formatMap === "object" && formatMap)) {
      return clipResults;
    }
    var newResults = {};
    for (var prop in clipResults) {
      if (_hasOwn.call(clipResults, prop)) {
        if (prop === "errors") {
          newResults[prop] = clipResults[prop] ? clipResults[prop].slice() : [];
          for (var i = 0, len = newResults[prop].length; i < len; i++) {
            newResults[prop][i].format = formatMap[newResults[prop][i].format];
          }
        } else if (prop !== "success" && prop !== "data") {
          newResults[prop] = clipResults[prop];
        } else {
          newResults[prop] = {};
          var tmpHash = clipResults[prop];
          for (var dataFormat in tmpHash) {
            if (dataFormat && _hasOwn.call(tmpHash, dataFormat) && _hasOwn.call(formatMap, dataFormat)) {
              newResults[prop][formatMap[dataFormat]] = tmpHash[dataFormat];
            }
          }
        }
      }
    }
    return newResults;
  };
  /**
 * Will look at a path, and will create a "?noCache={time}" or "&noCache={time}"
 * query param string to return. Does NOT append that string to the original path.
 * This is useful because ExternalInterface often breaks when a Flash SWF is cached.
 *
 * @returns The `noCache` query param with necessary "?"/"&" prefix.
 * @private
 */
  var _cacheBust = function(path, options) {
    var cacheBust = options == null || options && options.cacheBust === true;
    if (cacheBust) {
      return (path.indexOf("?") === -1 ? "?" : "&") + "noCache=" + _now();
    } else {
      return "";
    }
  };
  /**
 * Creates a query string for the FlashVars param.
 * Does NOT include the cache-busting query param.
 *
 * @returns FlashVars query string
 * @private
 */
  var _vars = function(options) {
    var i, len, domain, domains, str = "", trustedOriginsExpanded = [];
    if (options.trustedDomains) {
      if (typeof options.trustedDomains === "string") {
        domains = [ options.trustedDomains ];
      } else if (typeof options.trustedDomains === "object" && "length" in options.trustedDomains) {
        domains = options.trustedDomains;
      }
    }
    if (domains && domains.length) {
      for (i = 0, len = domains.length; i < len; i++) {
        if (_hasOwn.call(domains, i) && domains[i] && typeof domains[i] === "string") {
          domain = _extractDomain(domains[i]);
          if (!domain) {
            continue;
          }
          if (domain === "*") {
            trustedOriginsExpanded.length = 0;
            trustedOriginsExpanded.push(domain);
            break;
          }
          trustedOriginsExpanded.push.apply(trustedOriginsExpanded, [ domain, "//" + domain, _window.location.protocol + "//" + domain ]);
        }
      }
    }
    if (trustedOriginsExpanded.length) {
      str += "trustedOrigins=" + _encodeURIComponent(trustedOriginsExpanded.join(","));
    }
    if (options.forceEnhancedClipboard === true) {
      str += (str ? "&" : "") + "forceEnhancedClipboard=true";
    }
    if (typeof options.swfObjectId === "string" && options.swfObjectId) {
      str += (str ? "&" : "") + "swfObjectId=" + _encodeURIComponent(options.swfObjectId);
    }
    if (typeof options.jsVersion === "string" && options.jsVersion) {
      str += (str ? "&" : "") + "jsVersion=" + _encodeURIComponent(options.jsVersion);
    }
    return str;
  };
  /**
 * Extract the domain (e.g. "github.com") from an origin (e.g. "https://github.com") or
 * URL (e.g. "https://github.com/zeroclipboard/zeroclipboard/").
 *
 * @returns the domain
 * @private
 */
  var _extractDomain = function(originOrUrl) {
    if (originOrUrl == null || originOrUrl === "") {
      return null;
    }
    originOrUrl = originOrUrl.replace(/^\s+|\s+$/g, "");
    if (originOrUrl === "") {
      return null;
    }
    var protocolIndex = originOrUrl.indexOf("//");
    originOrUrl = protocolIndex === -1 ? originOrUrl : originOrUrl.slice(protocolIndex + 2);
    var pathIndex = originOrUrl.indexOf("/");
    originOrUrl = pathIndex === -1 ? originOrUrl : protocolIndex === -1 || pathIndex === 0 ? null : originOrUrl.slice(0, pathIndex);
    if (originOrUrl && originOrUrl.slice(-4).toLowerCase() === ".swf") {
      return null;
    }
    return originOrUrl || null;
  };
  /**
 * Set `allowScriptAccess` based on `trustedDomains` and `window.location.host` vs. `swfPath`.
 *
 * @returns The appropriate script access level.
 * @private
 */
  var _determineScriptAccess = function() {
    var _extractAllDomains = function(origins) {
      var i, len, tmp, resultsArray = [];
      if (typeof origins === "string") {
        origins = [ origins ];
      }
      if (!(typeof origins === "object" && origins && typeof origins.length === "number")) {
        return resultsArray;
      }
      for (i = 0, len = origins.length; i < len; i++) {
        if (_hasOwn.call(origins, i) && (tmp = _extractDomain(origins[i]))) {
          if (tmp === "*") {
            resultsArray.length = 0;
            resultsArray.push("*");
            break;
          }
          if (resultsArray.indexOf(tmp) === -1) {
            resultsArray.push(tmp);
          }
        }
      }
      return resultsArray;
    };
    return function(currentDomain, configOptions) {
      var swfDomain = _extractDomain(configOptions.swfPath);
      if (swfDomain === null) {
        swfDomain = currentDomain;
      }
      var trustedDomains = _extractAllDomains(configOptions.trustedDomains);
      var len = trustedDomains.length;
      if (len > 0) {
        if (len === 1 && trustedDomains[0] === "*") {
          return "always";
        }
        if (trustedDomains.indexOf(currentDomain) !== -1) {
          if (len === 1 && currentDomain === swfDomain) {
            return "sameDomain";
          }
          return "always";
        }
      }
      return "never";
    };
  }();
  /**
 * Get the currently active/focused DOM element.
 *
 * @returns the currently active/focused element, or `null`
 * @private
 */
  var _safeActiveElement = function() {
    try {
      return _document.activeElement;
    } catch (err) {
      return null;
    }
  };
  /**
 * Add a class to an element, if it doesn't already have it.
 *
 * @returns The element, with its new class added.
 * @private
 */
  var _addClass = function(element, value) {
    var c, cl, className, classNames = [];
    if (typeof value === "string" && value) {
      classNames = value.split(/\s+/);
    }
    if (element && element.nodeType === 1 && classNames.length > 0) {
      className = (" " + (element.className || "") + " ").replace(/[\t\r\n\f]/g, " ");
      for (c = 0, cl = classNames.length; c < cl; c++) {
        if (className.indexOf(" " + classNames[c] + " ") === -1) {
          className += classNames[c] + " ";
        }
      }
      className = className.replace(/^\s+|\s+$/g, "");
      if (className !== element.className) {
        element.className = className;
      }
    }
    return element;
  };
  /**
 * Remove a class from an element, if it has it.
 *
 * @returns The element, with its class removed.
 * @private
 */
  var _removeClass = function(element, value) {
    var c, cl, className, classNames = [];
    if (typeof value === "string" && value) {
      classNames = value.split(/\s+/);
    }
    if (element && element.nodeType === 1 && classNames.length > 0) {
      if (element.className) {
        className = (" " + element.className + " ").replace(/[\t\r\n\f]/g, " ");
        for (c = 0, cl = classNames.length; c < cl; c++) {
          className = className.replace(" " + classNames[c] + " ", " ");
        }
        className = className.replace(/^\s+|\s+$/g, "");
        if (className !== element.className) {
          element.className = className;
        }
      }
    }
    return element;
  };
  /**
 * Attempt to interpret the element's CSS styling. If `prop` is `"cursor"`,
 * then we assume that it should be a hand ("pointer") cursor if the element
 * is an anchor element ("a" tag).
 *
 * @returns The computed style property.
 * @private
 */
  var _getStyle = function(el, prop) {
    var value = _getComputedStyle(el, null).getPropertyValue(prop);
    if (prop === "cursor") {
      if (!value || value === "auto") {
        if (el.nodeName === "A") {
          return "pointer";
        }
      }
    }
    return value;
  };
  /**
 * Get the absolutely positioned coordinates of a DOM element.
 *
 * @returns Object containing the element's position, width, and height.
 * @private
 */
  var _getElementPosition = function(el) {
    var pos = {
      left: 0,
      top: 0,
      width: 0,
      height: 0
    };
    if (el.getBoundingClientRect) {
      var elRect = el.getBoundingClientRect();
      var pageXOffset = _window.pageXOffset;
      var pageYOffset = _window.pageYOffset;
      var leftBorderWidth = _document.documentElement.clientLeft || 0;
      var topBorderWidth = _document.documentElement.clientTop || 0;
      var leftBodyOffset = 0;
      var topBodyOffset = 0;
      if (_getStyle(_document.body, "position") === "relative") {
        var bodyRect = _document.body.getBoundingClientRect();
        var htmlRect = _document.documentElement.getBoundingClientRect();
        leftBodyOffset = bodyRect.left - htmlRect.left || 0;
        topBodyOffset = bodyRect.top - htmlRect.top || 0;
      }
      pos.left = elRect.left + pageXOffset - leftBorderWidth - leftBodyOffset;
      pos.top = elRect.top + pageYOffset - topBorderWidth - topBodyOffset;
      pos.width = "width" in elRect ? elRect.width : elRect.right - elRect.left;
      pos.height = "height" in elRect ? elRect.height : elRect.bottom - elRect.top;
    }
    return pos;
  };
  /**
 * Determine is an element is visible somewhere within the document (page).
 *
 * @returns Boolean
 * @private
 */
  var _isElementVisible = function(el) {
    if (!el) {
      return false;
    }
    var styles = _getComputedStyle(el, null);
    if (!styles) {
      return false;
    }
    var hasCssHeight = _parseFloat(styles.height) > 0;
    var hasCssWidth = _parseFloat(styles.width) > 0;
    var hasCssTop = _parseFloat(styles.top) >= 0;
    var hasCssLeft = _parseFloat(styles.left) >= 0;
    var cssKnows = hasCssHeight && hasCssWidth && hasCssTop && hasCssLeft;
    var rect = cssKnows ? null : _getElementPosition(el);
    var isVisible = styles.display !== "none" && styles.visibility !== "collapse" && (cssKnows || !!rect && (hasCssHeight || rect.height > 0) && (hasCssWidth || rect.width > 0) && (hasCssTop || rect.top >= 0) && (hasCssLeft || rect.left >= 0));
    return isVisible;
  };
  /**
 * Clear all existing timeouts and interval polling delegates.
 *
 * @returns `undefined`
 * @private
 */
  var _clearTimeoutsAndPolling = function() {
    _clearTimeout(_flashCheckTimeout);
    _flashCheckTimeout = 0;
    _clearInterval(_swfFallbackCheckInterval);
    _swfFallbackCheckInterval = 0;
  };
  /**
 * Reposition the Flash object to cover the currently activated element.
 *
 * @returns `undefined`
 * @private
 */
  var _reposition = function() {
    var htmlBridge;
    if (_currentElement && (htmlBridge = _getHtmlBridge(_flashState.bridge))) {
      var pos = _getElementPosition(_currentElement);
      _extend(htmlBridge.style, {
        width: pos.width + "px",
        height: pos.height + "px",
        top: pos.top + "px",
        left: pos.left + "px",
        zIndex: "" + _getSafeZIndex(_globalConfig.zIndex)
      });
    }
  };
  /**
 * Sends a signal to the Flash object to display the hand cursor if `true`.
 *
 * @returns `undefined`
 * @private
 */
  var _setHandCursor = function(enabled) {
    if (_flashState.ready === true) {
      if (_flashState.bridge && typeof _flashState.bridge.setHandCursor === "function") {
        _flashState.bridge.setHandCursor(enabled);
      } else {
        _flashState.ready = false;
      }
    }
  };
  /**
 * Get a safe value for `zIndex`
 *
 * @returns an integer, or "auto"
 * @private
 */
  var _getSafeZIndex = function(val) {
    if (/^(?:auto|inherit)$/.test(val)) {
      return val;
    }
    var zIndex;
    if (typeof val === "number" && !_isNaN(val)) {
      zIndex = val;
    } else if (typeof val === "string") {
      zIndex = _getSafeZIndex(_parseInt(val, 10));
    }
    return typeof zIndex === "number" ? zIndex : "auto";
  };
  /**
 * Ensure OS-compliant line endings, i.e. "\r\n" on Windows, "\n" elsewhere
 *
 * @returns string
 * @private
 */
  var _fixLineEndings = function(content) {
    var replaceRegex = /(\r\n|\r|\n)/g;
    if (typeof content === "string" && _globalConfig.fixLineEndings === true) {
      if (_isWindows()) {
        if (/((^|[^\r])\n|\r([^\n]|$))/.test(content)) {
          content = content.replace(replaceRegex, "\r\n");
        }
      } else if (/\r/.test(content)) {
        content = content.replace(replaceRegex, "\n");
      }
    }
    return content;
  };
  /**
 * Attempt to detect if ZeroClipboard is executing inside of a sandboxed iframe.
 * If it is, Flash Player cannot be used, so ZeroClipboard is dead in the water.
 *
 * @see {@link http://lists.w3.org/Archives/Public/public-whatwg-archive/2014Dec/0002.html}
 * @see {@link https://github.com/zeroclipboard/zeroclipboard/issues/511}
 * @see {@link http://zeroclipboard.org/test-iframes.html}
 *
 * @returns `true` (is sandboxed), `false` (is not sandboxed), or `null` (uncertain)
 * @private
 */
  var _detectSandbox = function(doNotReassessFlashSupport) {
    var effectiveScriptOrigin, frame, frameError, previousState = _flashState.sandboxed, isSandboxed = null;
    doNotReassessFlashSupport = doNotReassessFlashSupport === true;
    if (_pageIsFramed === false) {
      isSandboxed = false;
    } else {
      try {
        frame = window.frameElement || null;
      } catch (e) {
        frameError = {
          name: e.name,
          message: e.message
        };
      }
      if (frame && frame.nodeType === 1 && frame.nodeName === "IFRAME") {
        try {
          isSandboxed = frame.hasAttribute("sandbox");
        } catch (e) {
          isSandboxed = null;
        }
      } else {
        try {
          effectiveScriptOrigin = document.domain || null;
        } catch (e) {
          effectiveScriptOrigin = null;
        }
        if (effectiveScriptOrigin === null || frameError && frameError.name === "SecurityError" && /(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(frameError.message.toLowerCase())) {
          isSandboxed = true;
        }
      }
    }
    _flashState.sandboxed = isSandboxed;
    if (previousState !== isSandboxed && !doNotReassessFlashSupport) {
      _detectFlashSupport(_ActiveXObject);
    }
    return isSandboxed;
  };
  /**
 * Detect the Flash Player status, version, and plugin type.
 *
 * @see {@link https://code.google.com/p/doctype-mirror/wiki/ArticleDetectFlash#The_code}
 * @see {@link http://stackoverflow.com/questions/12866060/detecting-pepper-ppapi-flash-with-javascript}
 *
 * @returns `undefined`
 * @private
 */
  var _detectFlashSupport = function(ActiveXObject) {
    var plugin, ax, mimeType, hasFlash = false, isActiveX = false, isPPAPI = false, flashVersion = "";
    /**
   * Derived from Apple's suggested sniffer.
   * @param {String} desc e.g. "Shockwave Flash 7.0 r61"
   * @returns {String} "7.0.61"
   * @private
   */
    function parseFlashVersion(desc) {
      var matches = desc.match(/[\d]+/g);
      matches.length = 3;
      return matches.join(".");
    }
    function isPepperFlash(flashPlayerFileName) {
      return !!flashPlayerFileName && (flashPlayerFileName = flashPlayerFileName.toLowerCase()) && (/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(flashPlayerFileName) || flashPlayerFileName.slice(-13) === "chrome.plugin");
    }
    function inspectPlugin(plugin) {
      if (plugin) {
        hasFlash = true;
        if (plugin.version) {
          flashVersion = parseFlashVersion(plugin.version);
        }
        if (!flashVersion && plugin.description) {
          flashVersion = parseFlashVersion(plugin.description);
        }
        if (plugin.filename) {
          isPPAPI = isPepperFlash(plugin.filename);
        }
      }
    }
    if (_navigator.plugins && _navigator.plugins.length) {
      plugin = _navigator.plugins["Shockwave Flash"];
      inspectPlugin(plugin);
      if (_navigator.plugins["Shockwave Flash 2.0"]) {
        hasFlash = true;
        flashVersion = "2.0.0.11";
      }
    } else if (_navigator.mimeTypes && _navigator.mimeTypes.length) {
      mimeType = _navigator.mimeTypes["application/x-shockwave-flash"];
      plugin = mimeType && mimeType.enabledPlugin;
      inspectPlugin(plugin);
    } else if (typeof ActiveXObject !== "undefined") {
      isActiveX = true;
      try {
        ax = new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");
        hasFlash = true;
        flashVersion = parseFlashVersion(ax.GetVariable("$version"));
      } catch (e1) {
        try {
          ax = new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");
          hasFlash = true;
          flashVersion = "6.0.21";
        } catch (e2) {
          try {
            ax = new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
            hasFlash = true;
            flashVersion = parseFlashVersion(ax.GetVariable("$version"));
          } catch (e3) {
            isActiveX = false;
          }
        }
      }
    }
    _flashState.disabled = hasFlash !== true;
    _flashState.outdated = flashVersion && _parseFloat(flashVersion) < _parseFloat(_minimumFlashVersion);
    _flashState.version = flashVersion || "0.0.0";
    _flashState.pluginType = isPPAPI ? "pepper" : isActiveX ? "activex" : hasFlash ? "netscape" : "unknown";
  };
  /**
 * Invoke the Flash detection algorithms immediately upon inclusion so we're not waiting later.
 */
  _detectFlashSupport(_ActiveXObject);
  /**
 * Always assess the `sandboxed` state of the page at important Flash-related moments.
 */
  _detectSandbox(true);
  /**
 * A shell constructor for `ZeroClipboard` client instances.
 *
 * @constructor
 */
  var ZeroClipboard = function() {
    if (!(this instanceof ZeroClipboard)) {
      return new ZeroClipboard();
    }
    if (typeof ZeroClipboard._createClient === "function") {
      ZeroClipboard._createClient.apply(this, _args(arguments));
    }
  };
  /**
 * The ZeroClipboard library's version number.
 *
 * @static
 * @readonly
 * @property {string}
 */
  ZeroClipboard.version = "2.3.0";
  /**
 * Update or get a copy of the ZeroClipboard global configuration.
 * Returns a copy of the current/updated configuration.
 *
 * @returns Object
 * @static
 */
  ZeroClipboard.config = function() {
    return _config.apply(this, _args(arguments));
  };
  /**
 * Diagnostic method that describes the state of the browser, Flash Player, and ZeroClipboard.
 *
 * @returns Object
 * @static
 */
  ZeroClipboard.state = function() {
    return _state.apply(this, _args(arguments));
  };
  /**
 * Check if Flash is unusable for any reason: disabled, outdated, deactivated, etc.
 *
 * @returns Boolean
 * @static
 */
  ZeroClipboard.isFlashUnusable = function() {
    return _isFlashUnusable.apply(this, _args(arguments));
  };
  /**
 * Register an event listener.
 *
 * @returns `ZeroClipboard`
 * @static
 */
  ZeroClipboard.on = function() {
    return _on.apply(this, _args(arguments));
  };
  /**
 * Unregister an event listener.
 * If no `listener` function/object is provided, it will unregister all listeners for the provided `eventType`.
 * If no `eventType` is provided, it will unregister all listeners for every event type.
 *
 * @returns `ZeroClipboard`
 * @static
 */
  ZeroClipboard.off = function() {
    return _off.apply(this, _args(arguments));
  };
  /**
 * Retrieve event listeners for an `eventType`.
 * If no `eventType` is provided, it will retrieve all listeners for every event type.
 *
 * @returns array of listeners for the `eventType`; if no `eventType`, then a map/hash object of listeners for all event types; or `null`
 */
  ZeroClipboard.handlers = function() {
    return _listeners.apply(this, _args(arguments));
  };
  /**
 * Event emission receiver from the Flash object, forwarding to any registered JavaScript event listeners.
 *
 * @returns For the "copy" event, returns the Flash-friendly "clipData" object; otherwise `undefined`.
 * @static
 */
  ZeroClipboard.emit = function() {
    return _emit.apply(this, _args(arguments));
  };
  /**
 * Create and embed the Flash object.
 *
 * @returns The Flash object
 * @static
 */
  ZeroClipboard.create = function() {
    return _create.apply(this, _args(arguments));
  };
  /**
 * Self-destruct and clean up everything, including the embedded Flash object.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.destroy = function() {
    return _destroy.apply(this, _args(arguments));
  };
  /**
 * Set the pending data for clipboard injection.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.setData = function() {
    return _setData.apply(this, _args(arguments));
  };
  /**
 * Clear the pending data for clipboard injection.
 * If no `format` is provided, all pending data formats will be cleared.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.clearData = function() {
    return _clearData.apply(this, _args(arguments));
  };
  /**
 * Get a copy of the pending data for clipboard injection.
 * If no `format` is provided, a copy of ALL pending data formats will be returned.
 *
 * @returns `String` or `Object`
 * @static
 */
  ZeroClipboard.getData = function() {
    return _getData.apply(this, _args(arguments));
  };
  /**
 * Sets the current HTML object that the Flash object should overlay. This will put the global
 * Flash object on top of the current element; depending on the setup, this may also set the
 * pending clipboard text data as well as the Flash object's wrapping element's title attribute
 * based on the underlying HTML element and ZeroClipboard configuration.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.focus = ZeroClipboard.activate = function() {
    return _focus.apply(this, _args(arguments));
  };
  /**
 * Un-overlays the Flash object. This will put the global Flash object off-screen; depending on
 * the setup, this may also unset the Flash object's wrapping element's title attribute based on
 * the underlying HTML element and ZeroClipboard configuration.
 *
 * @returns `undefined`
 * @static
 */
  ZeroClipboard.blur = ZeroClipboard.deactivate = function() {
    return _blur.apply(this, _args(arguments));
  };
  /**
 * Returns the currently focused/"activated" HTML element that the Flash object is wrapping.
 *
 * @returns `HTMLElement` or `null`
 * @static
 */
  ZeroClipboard.activeElement = function() {
    return _activeElement.apply(this, _args(arguments));
  };
  /**
 * Keep track of the ZeroClipboard client instance counter.
 */
  var _clientIdCounter = 0;
  /**
 * Keep track of the state of the client instances.
 *
 * Entry structure:
 *   _clientMeta[client.id] = {
 *     instance: client,
 *     elements: [],
 *     handlers: {},
 *     coreWildcardHandler: function(event) { return client.emit(event); }
 *   };
 */
  var _clientMeta = {};
  /**
 * Keep track of the ZeroClipboard clipped elements counter.
 */
  var _elementIdCounter = 0;
  /**
 * Keep track of the state of the clipped element relationships to clients.
 *
 * Entry structure:
 *   _elementMeta[element.zcClippingId] = [client1.id, client2.id];
 */
  var _elementMeta = {};
  /**
 * Keep track of the state of the mouse event handlers for clipped elements.
 *
 * Entry structure:
 *   _mouseHandlers[element.zcClippingId] = {
 *     mouseover:  function(event) {},
 *     mouseout:   function(event) {},
 *     mouseenter: function(event) {},
 *     mouseleave: function(event) {},
 *     mousemove:  function(event) {}
 *   };
 */
  var _mouseHandlers = {};
  /**
 * Extending the ZeroClipboard configuration defaults for the Client module.
 */
  _extend(_globalConfig, {
    autoActivate: true
  });
  /**
 * The real constructor for `ZeroClipboard` client instances.
 * @private
 */
  var _clientConstructor = function(elements) {
    var meta, client = this;
    client.id = "" + _clientIdCounter++;
    meta = {
      instance: client,
      elements: [],
      handlers: {},
      coreWildcardHandler: function(event) {
        return client.emit(event);
      }
    };
    _clientMeta[client.id] = meta;
    if (elements) {
      client.clip(elements);
    }
    ZeroClipboard.on("*", meta.coreWildcardHandler);
    ZeroClipboard.on("destroy", function() {
      client.destroy();
    });
    ZeroClipboard.create();
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.on`.
 * @private
 */
  var _clientOn = function(eventType, listener) {
    var i, len, events, added = {}, client = this, meta = _clientMeta[client.id], handlers = meta && meta.handlers;
    if (!meta) {
      throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");
    }
    if (typeof eventType === "string" && eventType) {
      events = eventType.toLowerCase().split(/\s+/);
    } else if (typeof eventType === "object" && eventType && !("length" in eventType) && typeof listener === "undefined") {
      _keys(eventType).forEach(function(key) {
        var listener = eventType[key];
        if (typeof listener === "function") {
          client.on(key, listener);
        }
      });
    }
    if (events && events.length && listener) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].replace(/^on/, "");
        added[eventType] = true;
        if (!handlers[eventType]) {
          handlers[eventType] = [];
        }
        handlers[eventType].push(listener);
      }
      if (added.ready && _flashState.ready) {
        this.emit({
          type: "ready",
          client: this
        });
      }
      if (added.error) {
        for (i = 0, len = _flashStateErrorNames.length; i < len; i++) {
          if (_flashState[_flashStateErrorNames[i].replace(/^flash-/, "")]) {
            this.emit({
              type: "error",
              name: _flashStateErrorNames[i],
              client: this
            });
            break;
          }
        }
        if (_zcSwfVersion !== undefined && ZeroClipboard.version !== _zcSwfVersion) {
          this.emit({
            type: "error",
            name: "version-mismatch",
            jsVersion: ZeroClipboard.version,
            swfVersion: _zcSwfVersion
          });
        }
      }
    }
    return client;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.off`.
 * @private
 */
  var _clientOff = function(eventType, listener) {
    var i, len, foundIndex, events, perEventHandlers, client = this, meta = _clientMeta[client.id], handlers = meta && meta.handlers;
    if (!handlers) {
      return client;
    }
    if (arguments.length === 0) {
      events = _keys(handlers);
    } else if (typeof eventType === "string" && eventType) {
      events = eventType.split(/\s+/);
    } else if (typeof eventType === "object" && eventType && !("length" in eventType) && typeof listener === "undefined") {
      _keys(eventType).forEach(function(key) {
        var listener = eventType[key];
        if (typeof listener === "function") {
          client.off(key, listener);
        }
      });
    }
    if (events && events.length) {
      for (i = 0, len = events.length; i < len; i++) {
        eventType = events[i].toLowerCase().replace(/^on/, "");
        perEventHandlers = handlers[eventType];
        if (perEventHandlers && perEventHandlers.length) {
          if (listener) {
            foundIndex = perEventHandlers.indexOf(listener);
            while (foundIndex !== -1) {
              perEventHandlers.splice(foundIndex, 1);
              foundIndex = perEventHandlers.indexOf(listener, foundIndex);
            }
          } else {
            perEventHandlers.length = 0;
          }
        }
      }
    }
    return client;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.handlers`.
 * @private
 */
  var _clientListeners = function(eventType) {
    var copy = null, handlers = _clientMeta[this.id] && _clientMeta[this.id].handlers;
    if (handlers) {
      if (typeof eventType === "string" && eventType) {
        copy = handlers[eventType] ? handlers[eventType].slice(0) : [];
      } else {
        copy = _deepCopy(handlers);
      }
    }
    return copy;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.emit`.
 * @private
 */
  var _clientEmit = function(event) {
    var eventCopy, client = this;
    if (_clientShouldEmit.call(client, event)) {
      if (typeof event === "object" && event && typeof event.type === "string" && event.type) {
        event = _extend({}, event);
      }
      eventCopy = _extend({}, _createEvent(event), {
        client: client
      });
      _clientDispatchCallbacks.call(client, eventCopy);
    }
    return client;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.clip`.
 * @private
 */
  var _clientClip = function(elements) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");
    }
    elements = _prepClip(elements);
    for (var i = 0; i < elements.length; i++) {
      if (_hasOwn.call(elements, i) && elements[i] && elements[i].nodeType === 1) {
        if (!elements[i].zcClippingId) {
          elements[i].zcClippingId = "zcClippingId_" + _elementIdCounter++;
          _elementMeta[elements[i].zcClippingId] = [ this.id ];
          if (_globalConfig.autoActivate === true) {
            _addMouseHandlers(elements[i]);
          }
        } else if (_elementMeta[elements[i].zcClippingId].indexOf(this.id) === -1) {
          _elementMeta[elements[i].zcClippingId].push(this.id);
        }
        var clippedElements = _clientMeta[this.id] && _clientMeta[this.id].elements;
        if (clippedElements.indexOf(elements[i]) === -1) {
          clippedElements.push(elements[i]);
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.unclip`.
 * @private
 */
  var _clientUnclip = function(elements) {
    var meta = _clientMeta[this.id];
    if (!meta) {
      return this;
    }
    var clippedElements = meta.elements;
    var arrayIndex;
    if (typeof elements === "undefined") {
      elements = clippedElements.slice(0);
    } else {
      elements = _prepClip(elements);
    }
    for (var i = elements.length; i--; ) {
      if (_hasOwn.call(elements, i) && elements[i] && elements[i].nodeType === 1) {
        arrayIndex = 0;
        while ((arrayIndex = clippedElements.indexOf(elements[i], arrayIndex)) !== -1) {
          clippedElements.splice(arrayIndex, 1);
        }
        var clientIds = _elementMeta[elements[i].zcClippingId];
        if (clientIds) {
          arrayIndex = 0;
          while ((arrayIndex = clientIds.indexOf(this.id, arrayIndex)) !== -1) {
            clientIds.splice(arrayIndex, 1);
          }
          if (clientIds.length === 0) {
            if (_globalConfig.autoActivate === true) {
              _removeMouseHandlers(elements[i]);
            }
            delete elements[i].zcClippingId;
          }
        }
      }
    }
    return this;
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.elements`.
 * @private
 */
  var _clientElements = function() {
    var meta = _clientMeta[this.id];
    return meta && meta.elements ? meta.elements.slice(0) : [];
  };
  /**
 * The underlying implementation of `ZeroClipboard.Client.prototype.destroy`.
 * @private
 */
  var _clientDestroy = function() {
    var meta = _clientMeta[this.id];
    if (!meta) {
      return;
    }
    this.unclip();
    this.off();
    ZeroClipboard.off("*", meta.coreWildcardHandler);
    delete _clientMeta[this.id];
  };
  /**
 * Inspect an Event to see if the Client (`this`) should honor it for emission.
 * @private
 */
  var _clientShouldEmit = function(event) {
    if (!(event && event.type)) {
      return false;
    }
    if (event.client && event.client !== this) {
      return false;
    }
    var meta = _clientMeta[this.id];
    var clippedEls = meta && meta.elements;
    var hasClippedEls = !!clippedEls && clippedEls.length > 0;
    var goodTarget = !event.target || hasClippedEls && clippedEls.indexOf(event.target) !== -1;
    var goodRelTarget = event.relatedTarget && hasClippedEls && clippedEls.indexOf(event.relatedTarget) !== -1;
    var goodClient = event.client && event.client === this;
    if (!meta || !(goodTarget || goodRelTarget || goodClient)) {
      return false;
    }
    return true;
  };
  /**
 * Handle the actual dispatching of events to a client instance.
 *
 * @returns `undefined`
 * @private
 */
  var _clientDispatchCallbacks = function(event) {
    var meta = _clientMeta[this.id];
    if (!(typeof event === "object" && event && event.type && meta)) {
      return;
    }
    var async = _shouldPerformAsync(event);
    var wildcardTypeHandlers = meta && meta.handlers["*"] || [];
    var specificTypeHandlers = meta && meta.handlers[event.type] || [];
    var handlers = wildcardTypeHandlers.concat(specificTypeHandlers);
    if (handlers && handlers.length) {
      var i, len, func, context, eventCopy, originalContext = this;
      for (i = 0, len = handlers.length; i < len; i++) {
        func = handlers[i];
        context = originalContext;
        if (typeof func === "string" && typeof _window[func] === "function") {
          func = _window[func];
        }
        if (typeof func === "object" && func && typeof func.handleEvent === "function") {
          context = func;
          func = func.handleEvent;
        }
        if (typeof func === "function") {
          eventCopy = _extend({}, event);
          _dispatchCallback(func, context, [ eventCopy ], async);
        }
      }
    }
  };
  /**
 * Prepares the elements for clipping/unclipping.
 *
 * @returns An Array of elements.
 * @private
 */
  var _prepClip = function(elements) {
    if (typeof elements === "string") {
      elements = [];
    }
    return typeof elements.length !== "number" ? [ elements ] : elements;
  };
  /**
 * Add a `mouseover` handler function for a clipped element.
 *
 * @returns `undefined`
 * @private
 */
  var _addMouseHandlers = function(element) {
    if (!(element && element.nodeType === 1)) {
      return;
    }
    var _suppressMouseEvents = function(event) {
      if (!(event || (event = _window.event))) {
        return;
      }
      if (event._source !== "js") {
        event.stopImmediatePropagation();
        event.preventDefault();
      }
      delete event._source;
    };
    var _elementMouseOver = function(event) {
      if (!(event || (event = _window.event))) {
        return;
      }
      _suppressMouseEvents(event);
      ZeroClipboard.focus(element);
    };
    element.addEventListener("mouseover", _elementMouseOver, false);
    element.addEventListener("mouseout", _suppressMouseEvents, false);
    element.addEventListener("mouseenter", _suppressMouseEvents, false);
    element.addEventListener("mouseleave", _suppressMouseEvents, false);
    element.addEventListener("mousemove", _suppressMouseEvents, false);
    _mouseHandlers[element.zcClippingId] = {
      mouseover: _elementMouseOver,
      mouseout: _suppressMouseEvents,
      mouseenter: _suppressMouseEvents,
      mouseleave: _suppressMouseEvents,
      mousemove: _suppressMouseEvents
    };
  };
  /**
 * Remove a `mouseover` handler function for a clipped element.
 *
 * @returns `undefined`
 * @private
 */
  var _removeMouseHandlers = function(element) {
    if (!(element && element.nodeType === 1)) {
      return;
    }
    var mouseHandlers = _mouseHandlers[element.zcClippingId];
    if (!(typeof mouseHandlers === "object" && mouseHandlers)) {
      return;
    }
    var key, val, mouseEvents = [ "move", "leave", "enter", "out", "over" ];
    for (var i = 0, len = mouseEvents.length; i < len; i++) {
      key = "mouse" + mouseEvents[i];
      val = mouseHandlers[key];
      if (typeof val === "function") {
        element.removeEventListener(key, val, false);
      }
    }
    delete _mouseHandlers[element.zcClippingId];
  };
  /**
 * Creates a new ZeroClipboard client instance.
 * Optionally, auto-`clip` an element or collection of elements.
 *
 * @constructor
 */
  ZeroClipboard._createClient = function() {
    _clientConstructor.apply(this, _args(arguments));
  };
  /**
 * Register an event listener to the client.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.on = function() {
    return _clientOn.apply(this, _args(arguments));
  };
  /**
 * Unregister an event handler from the client.
 * If no `listener` function/object is provided, it will unregister all handlers for the provided `eventType`.
 * If no `eventType` is provided, it will unregister all handlers for every event type.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.off = function() {
    return _clientOff.apply(this, _args(arguments));
  };
  /**
 * Retrieve event listeners for an `eventType` from the client.
 * If no `eventType` is provided, it will retrieve all listeners for every event type.
 *
 * @returns array of listeners for the `eventType`; if no `eventType`, then a map/hash object of listeners for all event types; or `null`
 */
  ZeroClipboard.prototype.handlers = function() {
    return _clientListeners.apply(this, _args(arguments));
  };
  /**
 * Event emission receiver from the Flash object for this client's registered JavaScript event listeners.
 *
 * @returns For the "copy" event, returns the Flash-friendly "clipData" object; otherwise `undefined`.
 */
  ZeroClipboard.prototype.emit = function() {
    return _clientEmit.apply(this, _args(arguments));
  };
  /**
 * Register clipboard actions for new element(s) to the client.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.clip = function() {
    return _clientClip.apply(this, _args(arguments));
  };
  /**
 * Unregister the clipboard actions of previously registered element(s) on the page.
 * If no elements are provided, ALL registered elements will be unregistered.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.unclip = function() {
    return _clientUnclip.apply(this, _args(arguments));
  };
  /**
 * Get all of the elements to which this client is clipped.
 *
 * @returns array of clipped elements
 */
  ZeroClipboard.prototype.elements = function() {
    return _clientElements.apply(this, _args(arguments));
  };
  /**
 * Self-destruct and clean up everything for a single client.
 * This will NOT destroy the embedded Flash object.
 *
 * @returns `undefined`
 */
  ZeroClipboard.prototype.destroy = function() {
    return _clientDestroy.apply(this, _args(arguments));
  };
  /**
 * Stores the pending plain text to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setText = function(text) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData("text/plain", text);
    return this;
  };
  /**
 * Stores the pending HTML text to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setHtml = function(html) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData("text/html", html);
    return this;
  };
  /**
 * Stores the pending rich text (RTF) to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setRichText = function(richText) {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData("application/rtf", richText);
    return this;
  };
  /**
 * Stores the pending data to inject into the clipboard.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.setData = function() {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.setData.apply(this, _args(arguments));
    return this;
  };
  /**
 * Clears the pending data to inject into the clipboard.
 * If no `format` is provided, all pending data formats will be cleared.
 *
 * @returns `this`
 */
  ZeroClipboard.prototype.clearData = function() {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    ZeroClipboard.clearData.apply(this, _args(arguments));
    return this;
  };
  /**
 * Gets a copy of the pending data to inject into the clipboard.
 * If no `format` is provided, a copy of ALL pending data formats will be returned.
 *
 * @returns `String` or `Object`
 */
  ZeroClipboard.prototype.getData = function() {
    if (!_clientMeta[this.id]) {
      throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");
    }
    return ZeroClipboard.getData.apply(this, _args(arguments));
  };
  if (typeof define === "function" && define.amd) {
    define(function() {
      return ZeroClipboard;
    });
  } else if (typeof module === "object" && module && typeof module.exports === "object" && module.exports) {
    module.exports = ZeroClipboard;
  } else {
    window.ZeroClipboard = ZeroClipboard;
  }
})(function() {
  return this || window;
}());
},{}]},{},[24,63,65,66,64,67,110,111,112,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,99,100,101,102,103,105,106,107,108,109,113,114,115,116,133,134,135,136,119,120,121,122,123,124,32,36,33,34,41,35,37,38,39,40])(24)
});
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(11), __webpack_require__(6)))

/***/ }),

/***/ 703:
/***/ (function(module, exports, __webpack_require__) {


/* styles */
__webpack_require__(807)

var Component = __webpack_require__(2)(
  /* script */
  __webpack_require__(571),
  /* template */
  __webpack_require__(732),
  /* scopeId */
  null,
  /* cssModules */
  null
)
Component.options.__file = "/home/kimnh/Codes/WebShop/admin-template/laravel-vue-admin/node_modules/vue-handsontable/src/Handsontable.vue"
if (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== "default" && key !== "__esModule"})) {console.error("named exports are not supported in *.vue files.")}
if (Component.options.functional) {console.error("[vue-loader] Handsontable.vue: functional components are not supported with templates, they should use render functions.")}

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-39e2e092", Component.options)
  } else {
    hotAPI.reload("data-v-39e2e092", Component.options)
  }
})()}

module.exports = Component.exports


/***/ }),

/***/ 714:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('div', [_c('div', {
    staticClass: "tile is-ancestor"
  }, [_c('div', {
    staticClass: "tile is-parent"
  }, [_c('article', {
    staticClass: "tile is-child box"
  }, [_c('h1', [_vm._v("Data grid")]), _vm._v(" "), _c('handsontable', {
    attrs: {
      "data": _vm.rawData,
      "settings": {}
    }
  })], 1)])])])
},staticRenderFns: []}
module.exports.render._withStripped = true
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-0f701bf5", module.exports)
  }
}

/***/ }),

/***/ 732:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('div', {
    staticClass: "handsontable"
  })
},staticRenderFns: []}
module.exports.render._withStripped = true
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-39e2e092", module.exports)
  }
}

/***/ }),

/***/ 807:
/***/ (function(module, exports, __webpack_require__) {

// style-loader: Adds some css to the DOM by adding a <style> tag

// load the styles
var content = __webpack_require__(658);
if(typeof content === 'string') content = [[module.i, content, '']];
if(content.locals) module.exports = content.locals;
// add the styles to the DOM
var update = __webpack_require__(3)("4570e595", content, false);
// Hot Module Replacement
if(false) {
 // When the styles change, update the <style> tags
 if(!content.locals) {
   module.hot.accept("!!../../css-loader/index.js?sourceMap!../../vue-loader/lib/style-compiler/index.js?{\"id\":\"data-v-39e2e092\",\"scoped\":false,\"hasInlineConfig\":true}!../../vue-loader/lib/selector.js?type=styles&index=0!./Handsontable.vue", function() {
     var newContent = require("!!../../css-loader/index.js?sourceMap!../../vue-loader/lib/style-compiler/index.js?{\"id\":\"data-v-39e2e092\",\"scoped\":false,\"hasInlineConfig\":true}!../../vue-loader/lib/selector.js?type=styles&index=0!./Handsontable.vue");
     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];
     update(newContent);
   });
 }
 // When the module is disposed, remove the <style> tags
 module.hot.dispose(function() { update(); });
}

/***/ })

});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvYnVpbGRzL2pzL3ZpZXdzL3RhYmxlcy9IYW5kc29udGFibGUudnVlIiwid2VicGFjazovLy9IYW5kc29udGFibGUudnVlIiwid2VicGFjazovLy9IYW5kc29udGFibGUudnVlP2FmYTMiLCJ3ZWJwYWNrOi8vLy4vfi9oYW5kc29udGFibGUvZGlzdC9oYW5kc29udGFibGUuZnVsbC5jc3MiLCJ3ZWJwYWNrOi8vLy4vfi92dWUtaGFuZHNvbnRhYmxlL3NyYy9IYW5kc29udGFibGUudnVlPzY4ZTciLCJ3ZWJwYWNrOi8vLy4vfi9oYW5kc29udGFibGUvZGlzdC9oYW5kc29udGFibGUuZnVsbC5qcyIsIndlYnBhY2s6Ly8vLi9+L3Z1ZS1oYW5kc29udGFibGUvc3JjL0hhbmRzb250YWJsZS52dWUiLCJ3ZWJwYWNrOi8vLy4vcmVzb3VyY2VzL2J1aWxkcy9qcy92aWV3cy90YWJsZXMvSGFuZHNvbnRhYmxlLnZ1ZT9iMDIzIiwid2VicGFjazovLy8uL34vdnVlLWhhbmRzb250YWJsZS9zcmMvSGFuZHNvbnRhYmxlLnZ1ZT85NTg4Iiwid2VicGFjazovLy8uL34vdnVlLWhhbmRzb250YWJsZS9zcmMvSGFuZHNvbnRhYmxlLnZ1ZT9hY2Y4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBNEc7QUFDNUc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0VBQStFLGlEQUFpRCxJQUFJO0FBQ3BJLG1DQUFtQzs7QUFFbkM7QUFDQSxZQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLENBQUM7O0FBRUQ7Ozs7Ozs7Ozs7Ozs7OztBQ3BCQTs7Ozs7Ozs7OztZQUtBO2dCQUNBOztlQUVBOztBQUpBOztZQU1BOztlQUlBOztBQUxBO0FBTkE7OzhCQVlBOzhCQUNBOytEQUNBO0FBRUE7MENBQ0E7ZUFDQTtBQUVB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LE1BQU0sS0FBSyxZQUFZLE9BQU8sS0FBSyxZQUFZLGFBQWEsT0FBTyxLQUFLLFlBQVksV0FBVyxZQUFZLFdBQVcsTUFBTSxLQUFLLFlBQVksV0FBVyxZQUFZLFdBQVcsTUFBTSxhQUFhLE1BQU0sWUFBWSxXQUFXLEtBQUssS0FBSyxZQUFZLE9BQU8sS0FBSyxzQkFBc0IseUJBQXlCLHlCQUF5Qix5QkFBeUIsdUJBQXVCLHVCQUF1Qix1QkFBdUIsYUFBYSxPQUFPLGFBQWEsTUFBTSxVQUFVLFlBQVksT0FBTyxLQUFLLFlBQVksV0FBVyxVQUFVLE1BQU0sS0FBSyxVQUFVLFlBQVksV0FBVyxZQUFZLGFBQWEsYUFBYSxhQUFhLGFBQWEsV0FBVyxZQUFZLGFBQWEsV0FBVyxZQUFZLGFBQWEsYUFBYSxPQUFPLEtBQUssWUFBWSxXQUFXLFVBQVUsVUFBVSxNQUFNLEtBQUssWUFBWSxhQUFhLFdBQVcsTUFBTSxNQUFNLE1BQU0sS0FBSyxVQUFVLE1BQU0sS0FBSyxZQUFZLE9BQU8sS0FBSyxXQUFXLFVBQVUsWUFBWSxXQUFXLE9BQU8sTUFBTSxLQUFLLEtBQUssWUFBWSxNQUFNLEtBQUssWUFBWSxNQUFNLEtBQUssWUFBWSxNQUFNLEtBQUssWUFBWSxNQUFNLE1BQU0sS0FBSyxLQUFLLFlBQVksTUFBTSxLQUFLLFlBQVksTUFBTSxLQUFLLFlBQVksT0FBTyxNQUFNLE1BQU0sS0FBSyxVQUFVLE1BQU0sTUFBTSxNQUFNLEtBQUssVUFBVSxZQUFZLFdBQVcsWUFBWSxXQUFXLFlBQVksT0FBTyxLQUFLLFVBQVUsTUFBTSxLQUFLLFVBQVUsT0FBTyxNQUFNLEtBQUssS0FBSyxZQUFZLGFBQWEsTUFBTSxLQUFLLFVBQVUsS0FBSyxLQUFLLFlBQVksYUFBYSxXQUFXLE1BQU0sS0FBSyxLQUFLLFVBQVUsS0FBSyxLQUFLLFVBQVUsWUFBWSxNQUFNLEtBQUssS0FBSyxLQUFLLFlBQVksV0FBVyxLQUFLLEtBQUssVUFBVSxZQUFZLE1BQU0sTUFBTSxLQUFLLEtBQUssVUFBVSxZQUFZLE1BQU0sS0FBSyxVQUFVLFlBQVksTUFBTSxLQUFLLEtBQUssS0FBSyxVQUFVLFlBQVksTUFBTSxLQUFLLFVBQVUsWUFBWSxNQUFNLE1BQU0sTUFBTSxNQUFNLEtBQUssWUFBWSxPQUFPLE1BQU0sS0FBSyxLQUFLLFlBQVksTUFBTSxLQUFLLFlBQVksUUFBUSxNQUFNLE1BQU0sS0FBSyxVQUFVLE1BQU0sS0FBSyxZQUFZLGFBQWEsYUFBYSxPQUFPLFNBQVMsWUFBWSxPQUFPLE1BQU0sWUFBWSxhQUFhLE9BQU8sS0FBSyxZQUFZLFdBQVcsWUFBWSxPQUFPLEtBQUssWUFBWSxPQUFPLE1BQU0sWUFBWSxPQUFPLEtBQUssVUFBVSxNQUFNLEtBQUssVUFBVSxNQUFNLE1BQU0sVUFBVSxNQUFNLEtBQUssVUFBVSxNQUFNLEtBQUssWUFBWSxXQUFXLE9BQU8sTUFBTSxLQUFLLEtBQUssWUFBWSxhQUFhLE1BQU0sS0FBSyxZQUFZLGFBQWEsTUFBTSxLQUFLLFlBQVksYUFBYSxNQUFNLEtBQUssWUFBWSxhQUFhLE1BQU0sS0FBSyxZQUFZLGFBQWEsT0FBTyxLQUFLLFlBQVksT0FBTyxLQUFLLFlBQVksYUFBYSxRQUFRLEtBQUssWUFBWSxPQUFPLEtBQUssVUFBVSxVQUFVLFlBQVksYUFBYSxhQUFhLGFBQWEsYUFBYSxhQUFhLGFBQWEsYUFBYSxhQUFhLE9BQU8sS0FBSyxVQUFVLFVBQVUsVUFBVSxVQUFVLFlBQVksYUFBYSxhQUFhLFdBQVcsVUFBVSxPQUFPLEtBQUssVUFBVSxZQUFZLFdBQVcsWUFBWSxPQUFPLEtBQUssVUFBVSxVQUFVLFVBQVUsVUFBVSxNQUFNLEtBQUssWUFBWSxXQUFXLFVBQVUsWUFBWSxhQUFhLGFBQWEsYUFBYSxhQUFhLGFBQWEsYUFBYSxXQUFXLFVBQVUsTUFBTSxLQUFLLFVBQVUsVUFBVSxNQUFNLEtBQUssVUFBVSxPQUFPLEtBQUssWUFBWSxXQUFXLFlBQVksV0FBVyxZQUFZLGFBQWEsV0FBVyxZQUFZLGFBQWEsV0FBVyxVQUFVLFlBQVksYUFBYSxhQUFhLGFBQWEsYUFBYSxPQUFPLEtBQUssWUFBWSxPQUFPLEtBQUssWUFBWSxPQUFPLE9BQU8sVUFBVSxNQUFNLFFBQVEsWUFBWSxPQUFPLEtBQUssVUFBVSxPQUFPLEtBQUssWUFBWSxhQUFhLE9BQU8sTUFBTSxZQUFZLGFBQWEsUUFBUSxhQUFhLE1BQU0sVUFBVSxNQUFNLEtBQUssVUFBVSxZQUFZLGFBQWEsYUFBYSxhQUFhLE9BQU8sS0FBSyxLQUFLLFVBQVUsVUFBVSxNQUFNLEtBQUssVUFBVSxVQUFVLE1BQU0sS0FBSyxVQUFVLFVBQVUsS0FBSyxNQUFNLEtBQUssS0FBSyxVQUFVLFVBQVUsTUFBTSxLQUFLLFVBQVUsVUFBVSxNQUFNLEtBQUssVUFBVSxVQUFVLEtBQUssS0FBSyxRQUFRLE1BQU0sTUFBTSxZQUFZLGFBQWEsYUFBYSxhQUFhLGFBQWEsYUFBYSxhQUFhLGFBQWEsT0FBTyxLQUFLLFVBQVUsWUFBWSxXQUFXLFVBQVUsVUFBVSxZQUFZLGFBQWEsYUFBYSxXQUFXLFlBQVksYUFBYSxhQUFhLE9BQU8sTUFBTSxVQUFVLE1BQU0sWUFBWSxTQUFTLFVBQVUsVUFBVSxNQUFNLEtBQUssVUFBVSxPQUFPLEtBQUssWUFBWSxXQUFXLFVBQVUsVUFBVSxVQUFVLFVBQVUsTUFBTSxLQUFLLFlBQVksYUFBYSxhQUFhLGFBQWEsYUFBYSxhQUFhLGFBQWEsV0FBVyxVQUFVLFVBQVUsVUFBVSxVQUFVLE1BQU0sS0FBSyxZQUFZLFdBQVcsVUFBVSxVQUFVLFdBQVcsWUFBWSxhQUFhLGFBQWEsT0FBTyxLQUFLLFVBQVUsTUFBTSxLQUFLLFVBQVUsVUFBVSxZQUFZLFdBQVcsVUFBVSxVQUFVLFdBQVcsWUFBWSxhQUFhLGFBQWEsT0FBTyxLQUFLLFlBQVksV0FBVyxVQUFVLFVBQVUsVUFBVSxVQUFVLFVBQVUsTUFBTSxLQUFLLFlBQVksYUFBYSxhQUFhLGFBQWEsYUFBYSxhQUFhLFdBQVcsT0FBTyxLQUFLLFVBQVUsWUFBWSxXQUFXLFVBQVUsVUFBVSxNQUFNLEtBQUssVUFBVSxVQUFVLFVBQVUsTUFBTSxLQUFLLFVBQVUsVUFBVSxVQUFVLFVBQVUsWUFBWSxhQUFhLE9BQU8sUUFBUSxZQUFZLGFBQWEsYUFBYSxPQUFPLEtBQUssWUFBWSxhQUFhLGFBQWEsYUFBYSxhQUFhLE1BQU0sS0FBSyxZQUFZLE9BQU8sS0FBSyxZQUFZLGFBQWEsYUFBYSxhQUFhLGFBQWEsTUFBTSxLQUFLLFlBQVksT0FBTyxLQUFLLFlBQVksYUFBYSxhQUFhLGFBQWEsYUFBYSxhQUFhLE1BQU0sS0FBSyxZQUFZLE9BQU8sS0FBSyxZQUFZLGFBQWEsYUFBYSxhQUFhLGFBQWEsTUFBTSxLQUFLLFlBQVksT0FBTyxLQUFLLFlBQVksYUFBYSxhQUFhLGFBQWEsT0FBTyxLQUFLLFlBQVksYUFBYSxhQUFhLGFBQWEsTUFBTSxLQUFLLFlBQVksT0FBTyxLQUFLLFVBQVUsWUFBWSxXQUFXLFVBQVUsWUFBWSxhQUFhLE9BQU8sS0FBSyxVQUFVLFVBQVUsWUFBWSxPQUFPLEtBQUssWUFBWSxhQUFhLGFBQWEsYUFBYSxXQUFXLFlBQVksYUFBYSxXQUFXLFVBQVUsWUFBWSxXQUFXLFlBQVksYUFBYSxPQUFPLEtBQUssWUFBWSxhQUFhLE1BQU0sTUFBTSxNQUFNLEtBQUssVUFBVSxZQUFZLHVCQUF1QixPQUFPLFFBQVEsVUFBVSxNQUFNLEtBQUssWUFBWSxhQUFhLGFBQWEsT0FBTyxLQUFLLFlBQVksT0FBTyxLQUFLLFlBQVksYUFBYSxhQUFhLGFBQWEsYUFBYSxhQUFhLGFBQWEsT0FBTyxLQUFLLFVBQVUsTUFBTSxLQUFLLFlBQVksV0FBVyxPQUFPLE1BQU0sWUFBWSxPQUFPLEtBQUssWUFBWSxXQUFXLFVBQVUsWUFBWSxPQUFPLEtBQUssVUFBVSxZQUFZLE9BQU8sS0FBSyxZQUFZLFdBQVcsWUFBWSxPQUFPLEtBQUssVUFBVSxNQUFNLEtBQUssWUFBWSxhQUFhLE9BQU8sS0FBSyxZQUFZLGFBQWEsV0FBVyxNQUFNLEtBQUssWUFBWSxNQUFNLE1BQU0sWUFBWSxNQUFNLEtBQUssWUFBWSxNQUFNLEtBQUssVUFBVSxZQUFZLGFBQWEsV0FBVyxLQUFLLE1BQU0sVUFBVSxZQUFZLGFBQWEsYUFBYSxNQUFNLEtBQUssVUFBVSxLQUFLLE1BQU0sWUFBWSxXQUFXLFVBQVUsS0FBSyxLQUFLLFlBQVksV0FBVyxVQUFVLFlBQVksV0FBVyxLQUFLLEtBQUssWUFBWSxhQUFhLFdBQVcsVUFBVSxZQUFZLE1BQU0sTUFBTSxVQUFVLE1BQU0sS0FBSyxZQUFZLE1BQU0sS0FBSyxVQUFVLFlBQVksYUFBYSxXQUFXLEtBQUssTUFBTSxVQUFVLFlBQVksYUFBYSxhQUFhLE1BQU0sS0FBSyxVQUFVLEtBQUssTUFBTSxZQUFZLFdBQVcsVUFBVSxLQUFLLEtBQUssWUFBWSxXQUFXLFVBQVUsWUFBWSxXQUFXLEtBQUssS0FBSyxZQUFZLGFBQWEsV0FBVyxVQUFVLFlBQVksTUFBTSxNQUFNLFVBQVUsTUFBTSxhQUFhLFFBQVEsTUFBTSxLQUFLLFVBQVUsVUFBVSxZQUFZLFdBQVcsWUFBWSxhQUFhLGFBQWEsYUFBYSxPQUFPLE9BQU8sS0FBSyxNQUFNLFVBQVUsVUFBVSxNQUFNLHNCQUFzQix1QkFBdUIsTUFBTSxVQUFVLE9BQU8sS0FBSyxZQUFZLGFBQWEsT0FBTyxLQUFLLFVBQVUsVUFBVSxVQUFVLE1BQU0sS0FBSyxZQUFZLGFBQWEsT0FBTyxLQUFLLFlBQVksYUFBYSxhQUFhLFdBQVcsWUFBWSxXQUFXLFlBQVksYUFBYSxhQUFhLGFBQWEsYUFBYSxNQUFNLEtBQUssWUFBWSxhQUFhLFdBQVcsVUFBVSxVQUFVLFVBQVUsWUFBWSxXQUFXLE1BQU0sTUFBTSxVQUFVLFlBQVksYUFBYSxXQUFXLFVBQVUsVUFBVSxVQUFVLFVBQVUsWUFBWSxhQUFhLGFBQWEsYUFBYSxhQUFhLGFBQWEsYUFBYSxhQUFhLFdBQVcsWUFBWSxXQUFXLE1BQU0sTUFBTSxVQUFVLE1BQU0sTUFBTSxVQUFVLFlBQVksV0FBVyxNQUFNLE1BQU0sVUFBVSxZQUFZLFdBQVcsTUFBTSxNQUFNLFlBQVksV0FBVyxNQUFNLEtBQUssWUFBWSxhQUFhLE9BQU8sS0FBSyxVQUFVLFlBQVksYUFBYSxXQUFXLE1BQU0sTUFBTSxZQUFZLFdBQVcsTUFBTSxLQUFLLFVBQVUsWUFBWSxhQUFh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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsT0FBTztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLFVBQVU7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JB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O0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsc0JBQXNCO0FBQ25ELCtCQUErQixzQkFBc0I7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLHNCQUFzQjtBQUNuRCwrQkFBK0Isc0JBQXNCO0FBQ3JEO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsc0JBQXNCO0FBQ25ELCtCQUErQixzQkFBc0I7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLElBQUk7QUFDTDtBQUNBOztBQUVBO0FBQ0EsQ0FBQyxFQUFFLGdCQUFnQjtBQUNuQjtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0EsTUFBTTtBQUNOLGVBQWU7QUFDZixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtVQUErVSw0RUFBNEU7QUFDM1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnVEFBZ1Qsb0VBQW9FO0FBQ3BYLDBTQUEwUyxvRUFBb0U7QUFDOVc7QUFDQTtBQUNBLDZHQUE2RyxvQkFBb0I7QUFDakksK0hBQStILHVCQUF1QjtBQUN0SixtSEFBbUgscUJBQXFCO0FBQ3hJLCtIQUErSCx1QkFBdUI7QUFDdEosNkdBQTZHLG9CQUFvQjtBQUNqSSwrSEFBK0gsdUJBQXVCO0FBQ3RKLDBNQUEwTSx3Q0FBd0M7QUFDbFAsdUxBQXVMLG1DQUFtQztBQUMxTiw2TEFBNkwsb0NBQW9DO0FBQ2pPLG1NQUFtTSxxQ0FBcUM7QUFDeE8sbVBBQW1QLDZDQUE2QztBQUNoUztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtFQUFrRSxVQUFVO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsSUFBSTtBQUNMO0FBQ0E7O0FBRUE7QUFDQSxDQUFDLEVBQUUsK1BBQStQO0FBQ2xRO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxNQUFNO0FBQ04sZUFBZTtBQUNmLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtVQUErVSw0RUFBNEU7QUFDM1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1VEFBdVQsc0VBQXNFO0FBQzdYLDBUQUEwVCxxRUFBcUU7QUFDL1gsa1NBQWtTLCtEQUErRDtBQUNqVztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdB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RztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLDZCQUE2QjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxJQUFJO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0EsQ0FBQyxFQUFFLG9DQUFvQztBQUN2QztBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDO0FBQ0EsTUFBTTtBQUNOLGVBQWU7QUFDZixDQUFDO0FBQ0Q7QUFDQTtBQUNBLCtYQUErWCx3RkFBd0Y7QUFDdmQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSwySEFBMkgsdUJBQXVCO0FBQ2xKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsSUFBSTtBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLENBQUMsRUFBRSxvQ0FBb0M7QUFDdkM7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBLE1BQU07QUFDTixlQUFlO0FBQ2YsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrVUFBK1UsNEVBQTRFO0FBQzNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMFNBQTBTLG1FQUFtRTtBQUM3VyxnVEFBZ1QscUVBQXFFO0FBQ3JYLDBUQUEwVCxxRUFBcUU7QUFDL1gsNFJBQTRSLCtEQUErRDtBQUMzVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsVUFBVSxRQUFRO0FBQ2xCLGFBQWEsUUFBUTtBQUNyQixXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qiw4QkFBOEI7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsSUFBSTtBQUNMO0FBQ0E7O0FBRUE7QUFDQSxDQUFDLEVBQUUsbUVBQW1FO0FBQ3RFO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQSxNQUFNO0FBQ04sZUFBZTtBQUNmLENBQUM7QUFDRDtBQUNBLHdWQUF3Viw0RUFBNEU7QUFDcGE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxDQUFDLElBQUk7QUFDTDtBQUNBOztBQUVBO0FBQ0EsQ0FBQyxFQUFFLHlCQUF5QjtBQUM1QjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EsTUFBTTtBQUNOLGVBQWU7QUFDZixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrVUFBK1UsNEVBQTRFO0FBQzNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBUQUEwVCxzRUFBc0U7QUFDaFksNEpBQTRKLDZCQUE2QjtBQUN6TCxzSkFBc0osNEJBQTRCO0FBQ2xMLHdLQUF3SywrQkFBK0I7QUFDdk0sc0pBQXNKLDRCQUE0QjtBQUNsTCw2SkFBNkosNEJBQTRCO0FBQ3pMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixTQUFTO0FBQ3BDO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLFNBQVM7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixjQUFjO0FBQ3RDO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FB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Q0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLFNBQVM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxpQkFBaUI7QUFDekQ7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLE9BQU87QUFDUDtBQUNB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QTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsVUFBVTtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtIQUFrSDtBQUNsSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsc0JBQXNCO0FBQ2pELDZCQUE2QixzQkFBc0I7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLHNDQUFzQztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLFFBQVE7QUFDNUM7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxRQUFRO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsVUFBVTtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLFVBQVU7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsVUFBVTtBQUMzRDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsNkNBQTZDLFVBQVU7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixVQUFVO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsMEJBQTBCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLFVBQVU7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsVUFBVTtBQUMvQjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLG9CQUFvQjtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLGFBQWE7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsVUFBVTtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxjQUFjO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLGNBQWM7QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLENBQUMsRUFBRSxpZ0JBQWlnQjtBQUNwZ0I7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBLE1BQU07QUFDTixlQUFlO0FBQ2YsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1IQUFtSCxzQkFBc0I7QUFDekksMEhBQTBILHdCQUF3QjtBQUNsSixtS0FBbUssOEJBQThCO0FBQ2pNLHdLQUF3SyxpQ0FBaUM7QUFDek0sMEpBQTBKLGdDQUFnQztBQUMxTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxSkFBcUosK0JBQStCO0FBQ3BMO0FBQ0E7QUFDQSw4SkFBOEosZ0NBQWdDO0FBQzlMLCtKQUErSixnQ0FBZ0M7QUFDL0wsb0hBQW9ILHVCQUF1QjtBQUMzSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsZ0JBQWdCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLFVBQVU7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wscUJBQXFCLFVBQVU7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIseUJBQXlCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxVQUFVO0FBQ3pEO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxvREFBb0Qsb0JBQW9CO0FBQ3hFLDBCQUEwQiw4QkFBOEI7QUFDeEQ7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDhCQUE4QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLFVBQVU7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLFVBQVU7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHFDQUFxQztBQUN0RCxtQkFBbUIsK0JBQStCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsQ0FBQyxFQUFFLGlJQUFpSTtBQUNwSTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0EsTUFBTTtBQUNOLGNBQWM7QUFDZDtBQUNBLE1BQU07QUFDTixjQUFjO0FBQ2Q7QUFDQSxNQUFNO0FBQ04seUJBQXlCO0FBQ3pCO0FBQ0EsTUFBTTtBQUNOLGVBQWU7QUFDZixDQUFDO0FBQ0Q7QUFDQTtBQUNBLG1IQUFtSCxzQkFBc0I7QUFDekksc0tBQXNLLGdDQUFnQztBQUN0TTtBQUNBLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDLEVBQUUsaUNBQWlDO0FBQ3BDO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQSxNQUFNO0FBQ04sZUFBZTtBQUNmLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxtS0FBbUssa0NBQWtDO0FBQ3JNLDBNQUEwTSwyQ0FBMkM7QUFDclAsNldBQTZXLDJFQUEyRTtBQUN4YjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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SkFBaUosNkJBQTZCO0FBQzlLLGtNQUFrTSx1Q0FBdUM7QUFDek87QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFD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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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TDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLG1DQUFtQyxRQUFRO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBOztBQUVBO0FBQ0EsQ0FBQyxFQUFFLGlRQUFpUTtBQUNwUTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0EsTUFBTTtBQUNOLGVBQWU7QUFDZixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtS0FBbUssbUNBQW1DO0FBQ3RNLHFQQUFxUCx1REFBdUQ7QUFDNVM7QUFDQTtBQUNBLCtQQUErUCx5REFBeUQ7QUFDeFQ7QUFDQTtBQUNBLG9TQUFvUyxnRUFBZ0U7QUFDcFcsMFFBQTBRLDBEQUEwRDtBQUNwVSwwUEFBMFAsd0RBQXdEO0FBQ2xUO0FBQ0E7QUFDQSwwUEFBMFAsd0RBQXdEO0FBQ2xUO0FBQ0E7QUFDQSxxTkFBcU4sOENBQThDO0FBQ25RLDhTQUE4UyxnRUFBZ0U7QUFDOVcsb1FBQW9RLHdEQUF3RDtBQUM1VDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBOztBQUVBO0FBQ0EsQ0FBQyxFQUFFLHlNQUF5TTtBQUM1TTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsTUFBTTtBQUNOLGVBQWU7QUFDZixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1LQUFtSyxtQ0FBbUM7QUFDdE0sbU5BQW1OLDhDQUE4QztBQUNqUSw4UEFBOFAsdURBQXVEO0FBQ3JULCtSQUErUixnRUFBZ0U7QUFDL1Y7QUFDQTtBQUNBO0FBQ0Esa1BBQWtQLG1EQUFtRDtBQUNyUyxxTkFBcU4sOENBQThDO0FBQ25RLDZaQUE2Wix1RkFBdUY7QUFDcGYsaUdBQWlHLG9CQUFvQjtBQUNySDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNELDBCQUEwQjtBQUNoRix1REFBdUQsMENBQTBDO0FBQ2pHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FB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QUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxxQkFBcUI7QUFDckQsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdEO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLG1CQUFtQiwwQ0FBMEM7QUFDN0Q7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsbUJBQW1CLDBDQUEwQztBQUM3RDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsbUJBQW1CLDBDQUEwQztBQUM3RDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRkFBa0Y7QUFDbEY7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsa0JBQWtCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxxQ0FBcUMsd0JBQXdCO0FBQzdELHVDQUF1Qyx3QkFBd0I7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyx3QkFBd0I7QUFDN0QsdUNBQXVDLHdCQUF3QjtBQUMvRDtBQUNBLGdEQUFnRDtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUMsYUFBYTtBQUNkO0FBQ0E7O0FBRUE7QUFDQSxDQUFDLEVBQUUsNk1BQTZNO0FBQ2hOO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQSxNQUFNO0FBQ04sZUFBZTtBQUNmLENBQUM7QUFDRDtBQUNBLDBQQUEwUCx1REFBdUQ7QUFDalQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxpQkFBaUIseUJBQXlCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQyxJQUFJO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDLEVBQUUsbUJBQW1CO0FBQ3RCO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQSxNQUFNO0FBQ04sZUFBZTtBQUNmLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtTkFBbU4sOENBQThDO0FBQ2pRLG1LQUFtSyxtQ0FBbUM7QUFDdE0sMFBBQTBQLHVEQUF1RDtBQUNqVCw4SkFBOEosOEJBQThCO0FBQzVMLDRPQUE0TyxtREFBbUQ7QUFDL1IsbVNBQW1TLGdFQUFnRTtBQUNuVyw0SUFBNEksMkJBQTJCO0FBQ3ZLLDRGQUE0RixtQkFBbUI7QUFDL0cscU5BQXFOLDhDQUE4QztBQUNuUSxxUkFBcVIsOERBQThEO0FBQ25WO0FBQ0E7QUFDQTtBQUNBLGdTQUFnUyxnRUFBZ0U7QUFDaFc7QUFDQTtBQUNBLG9KQUFvSiw4QkFBOEI7QUFDbEw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLHNCQUFzQiwwQkFBMEI7QUFDaEQ7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxrQkFBa0IsMEJBQTBCO0FBQzVDO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsR0FBRztBQUNKO0FBQ0EsSUFBSTtBQUNKLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDLEVBQUUsZ01BQWdNO0FBQ25NO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxNQUFNO0FBQ04sZUFBZTtBQUNmLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxtTkFBbU4sOENBQThDO0FBQ2pRLCtSQUErUixnRUFBZ0U7QUFDL1Y7QUFDQTtBQUNBLHFSQUFxUiw4REFBOEQ7QUFDblY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUMsSUFBSTtBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLENBQUMsRUFBRSw2REFBNkQ7QUFDaEU7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLE1BQU07QUFDTixlQUFlO0FBQ2YsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLDBQQUEwUCx3REFBd0Q7QUFDbFQ7QUFDQTtBQUNBO0FBQ0EsMFBBQTBQLHVEQUF1RDtBQUNqVCxtSkFBbUosOEJBQThCO0FBQ2pMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsSUFBSTtBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDLEVBQUUsNERBQTREO0FBQy9EO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxNQUFNO0FBQ04sZUFBZTtBQUNmLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtTkFBbU4sOENBQThDO0FBQ2pRLCtSQUErUixnRUFBZ0U7QUFDL1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscVBBQXFQLHVEQUF1RDtBQUM1UztBQUNBO0FBQ0E7QUFDQSx3R0FBd0cscUJBQXFCO0FBQzdILDRPQUE0TyxtREFBbUQ7QUFDL1IsMlBBQTJQLHdEQUF3RDtBQUNuVCx3UUFBd1EsMERBQTBEO0FBQ2xVLGlHQUFpRyxvQkFBb0I7QUFDckg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvUUFBb1EseURBQXlEO0FBQzdULCtRQUErUSwyREFBMkQ7QUFDMVUsd0pBQXdKLDhCQUE4QjtBQUN0TCx5U0FBeVMsOERBQThEO0FBQ3ZXO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7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QUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsQ0FBQyxFQUFFLGdSQUFnUjtBQUNuUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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LFFBQVE7QUFDOUI7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsSUFBSTtBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDLEVBQUUsa0xBQWtMO0FBQ3JMO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxNQUFNO0FBQ04sZUFBZTtBQUNmLENBQUM7QUFDRDtBQUNBLCtTQUErUyxvRUFBb0U7QUFDblg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsSUFBSTtBQUNMOztBQUVBO0FBQ0EsQ0FBQyxFQUFFLG9CQUFvQjtBQUN2QjtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0EsTUFBTTtBQUNOLGVBQWU7QUFDZixDQUFDO0FBQ0Q7QUFDQTtBQUNBLCtHQUErRyx1QkFBdUI7QUFDdEksbVZBQW1WLDRFQUE0RTtBQUMvWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDO0FBQzVDO0FBQ0E7QUFDQSxJQUFJLElBQUk7QUFDUjs7QUFFQTtBQUNBLENBQUMsRUFBRSxvQ0FBb0M7QUFDdkM7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBLE1BQU07QUFDTixlQUFlO0FBQ2YsQ0FBQztBQUNEO0FBQ0E7QUFDQSwrR0FBK0csdUJBQXVCO0FBQ3RJLG1WQUFtViw0RUFBNEU7QUFDL1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QztBQUM1QztBQUNBO0FBQ0EsSUFBSSxJQUFJO0FBQ1I7O0FBRUE7QUFDQSxDQUFDLEVBQUUsb0NBQW9DO0FBQ3ZDO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQSxNQUFNO0FBQ04sZUFBZTtBQUNmLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbU5BQW1OLDhDQUE4QztBQUNqUSw4TEFBOEwseUNBQXlDO0FBQ3ZPLCtSQUErUixnRUFBZ0U7QUFDL1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrUEFBa1AsbURBQW1EO0FBQ3JTLHFSQUFxUiw4REFBOEQ7QUFDblY7QUFDQTtBQUNBLDBQQUEwUCx1REFBdUQ7QUFDalQsK1BBQStQLHdEQUF3RDtBQUN2VCxxTkFBcU4sOENBQThDO0FBQ25RO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNUO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxDQUFDLElBQUk7QUFDTDtBQUNBOztBQUVBO0FBQ0EsQ0FBQyxFQUFFLGlKQUFpSjtBQUNwSjtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0EsTUFBTTtBQUNOLGVBQWU7QUFDZixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4TEFBOEwseUNBQXlDO0FBQ3ZPLG1OQUFtTiw4Q0FBOEM7QUFDalEsMFBBQTBQLHVEQUF1RDtBQUNqVCwrUkFBK1IsZ0VBQWdFO0FBQy9WO0FBQ0E7QUFDQTtBQUNBLCtQQUErUCx3REFBd0Q7QUFDdlQsa1BBQWtQLG1EQUFtRDtBQUNyUyxxTkFBcU4sOENBQThDO0FBQ25RLGdJQUFnSSx5QkFBeUI7QUFDekosdUpBQXVKLDhCQUE4QjtBQUNyTCx1SkFBdUosOEJBQThCO0FBQ3JMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLHNCQUFzQixRQUFRO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FB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T0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxJQUFJO0FBQ0w7QUFDQTs7QUFFQTtBQUNBLENBQUMsRUFBRSxpSkFBaUo7QUFDcEo7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBLE1BQU07QUFDTixlQUFlO0FBQ2YsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1OQUFtTiw4Q0FBOEM7QUFDalEscU5BQXFOLDhDQUE4QztBQUNuUSx5U0FBeVMsOERBQThEO0FBQ3ZXLDZaQUE2Wix1RkFBdUY7QUFDcGYsdVpBQXVaLHNGQUFzRjtBQUM3ZSw4V0FBOFcsOEVBQThFO0FBQzViO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsVUFBVTtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixVQUFVO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixVQUFVO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxVQUFVO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RCxrQkFBa0I7QUFDOUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLDREQUE0RCxrQkFBa0I7QUFDOUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsMENBQTBDO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsVUFBVTtBQUN0RDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSxVQUFVO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLFVBQVU7QUFDM0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLGNBQWM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixjQUFjO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDLEVBQUUsc0tBQXNLO0FBQ3pLO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQSxNQUFNO0FBQ04sZUFBZTtBQUNmLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtTkFBbU4sOENBQThDO0FBQ2pRLCtSQUErUixnRUFBZ0U7QUFDL1Y7QUFDQTtBQUNBO0FBQ0EsMFFBQTBRLHlEQUF5RDtBQUNuVSxtS0FBbUssbUNBQW1DO0FBQ3RNLDRPQUE0TyxtREFBbUQ7QUFDL1IscU5BQXFOLDhDQUE4QztBQUNuUTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLENBQUMsSUFBSTtBQUNMO0FBQ0E7O0FBRUE7QUFDQSxDQUFDLEVBQUUscUdBQXFHO0FBQ3hHO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxNQUFNO0FBQ04sZUFBZTtBQUNmLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBIQUEwSCx3QkFBd0I7QUFDbEoscVJBQXFSLDJEQUEyRDtBQUNoVixpUUFBaVEsd0RBQXdEO0FBQ3pULHlHQUF5RyxvQkFBb0I7QUFDN0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLElBQUk7QUFDTDtBQUNBOztBQUVBO0FBQ0EsQ0FBQyxFQUFFLDJGQUEyRjtBQUM5RjtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0EsTUFBTTtBQUNOLGVBQWU7QUFDZixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbU5BQW1OLDhDQUE4QztBQUNqUSxtS0FBbUssbUNBQW1DO0FBQ3RNLDBIQUEwSCx3QkFBd0I7QUFDbEosNElBQTRJLDJCQUEyQjtBQUN2SywwUEFBMFAsdURBQXVEO0FBQ2pULHFOQUFxTiw4Q0FBOEM7QUFDblE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxJQUFJO0FBQ0w7QUFDQTs7QUFFQTtBQUNBLENBQUMsRUFBRSxtR0FBbUc7QUFDdEc7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLE1BQU07QUFDTixjQUFjO0FBQ2Q7QUFDQSxNQUFNO0FBQ04sZUFBZTtBQUNmLENBQUM7QUFDRDtBQUNBLDJQQUEyUCx1REFBdUQ7QUFDbFQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLENBQUMsRUFBRSx5QkFBeUI7QUFDNUI7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBLE1BQU07QUFDTixlQUFlO0FBQ2YsQ0FBQztBQUNEO0FBQ0E7QUFDQSxtTkFBbU4sOENBQThDO0FBQ2pRLHFOQUFxTiw4Q0FBOEM7QUFDblE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QiwwQkFBMEI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLENBQUMsRUFBRSwwQkFBMEI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtTkFBbU4sOENBQThDO0FBQ2pRLCtSQUErUixnRUFBZ0U7QUFDL1Y7QUFDQTtBQUNBLHFOQUFxTixnREFBZ0Q7QUFDclE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIscUJBQXFCO0FBQy9DLDRCQUE0QixxQkFBcUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLENBQUMsRUFBRSxzREFBc0Q7QUFDekQ7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBLE1BQU07QUFDTixlQUFlO0FBQ2YsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1OQUFtTiw4Q0FBOEM7QUFDalEsK1JBQStSLGdFQUFnRTtBQUMvVjtBQUNBO0FBQ0EsMFBBQTBQLHVEQUF1RDtBQUNqVCxtS0FBbUssbUNBQW1DO0FBQ3RNLHFOQUFxTiw4Q0FBOEM7QUFDblEsMlFBQTJRLHlEQUF5RDtBQUNwVTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxDQUFDLElBQUk7QUFDTDtBQUNBOztBQUVBO0FBQ0EsQ0FBQyxFQUFFLHNHQUFzRztBQUN6RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtTkFBbU4sOENBQThDO0FBQ2pRLHlQQUF5UCx1REFBdUQ7QUFDaFQsK1BBQStQLHdEQUF3RDtBQUN2VCwwUEFBMFAsd0RBQXdEO0FBQ2xUO0FBQ0E7QUFDQSx5U0FBeVMsOERBQThEO0FBQ3ZXO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixTQUFTO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsaUJBQWlCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLFNBQVM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQywwQkFBMEI7QUFDL0QsdUNBQXVDLDBCQUEwQjtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLGFBQWE7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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Q0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9EO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsQ0FBQzs7QUFFRCxDQUFDLEdBQUc7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLE9BQU87QUFDUDs7QUFFQSxPQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsT0FBTztBQUNQO0FBQ0E7O0FBRUEsT0FBTztBQUNQO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsQ0FBQyxHQUFHO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsaUVBQWlFO0FBQ2pFOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLE1BQU07QUFDakI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87O0FBRVAsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsV0FBVyxTQUFTO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsU0FBUztBQUNwQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFNBQVM7QUFDcEIsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQSw4Q0FBOEMsU0FBUztBQUN2RDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxTQUFTO0FBQ3REO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLFNBQVM7QUFDeEQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFNBQVM7QUFDcEI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxzREFBc0QsU0FBUztBQUMvRDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxTQUFTO0FBQ3BCLFdBQVcsT0FBTztBQUNsQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLHdEQUF3RCxTQUFTO0FBQ2pFO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBLENBQUMsR0FBRztBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7O0FBR0E7QUFDQTtBQUNBLGNBQWMsU0FBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0M7QUFDeEM7QUFDQSx5Q0FBeUM7QUFDekM7QUFDQTtBQUNBLEtBQUs7QUFDTDs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esc0RBQXNELDBCQUEwQixJQUFJO0FBQ3BGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsQ0FBQzs7QUFFRCxDQUFDLEdBQUc7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLHNCQUFzQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLGlCQUFpQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxPQUFPO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsYUFBYTtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFD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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0Q7QUFDeEQ7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLHFCQUFxQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyw4QkFBOEI7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxDQUFDLEdBQUc7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxDQUFDLHFCQUFxQjs7QUFFdEI7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBOztBQUVBLHVCQUF1QixTQUFTO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxtQkFBbUIsNkJBQTZCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixzQkFBc0I7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLElBQUk7QUFDM0I7O0FBRUE7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx3Q0FBd0MsSUFBSTs7QUFFNUM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixpQ0FBaUM7QUFDckQ7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHdCQUF3QjtBQUMvQztBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHdMQUF3TCxJQUFJOztBQUU1TCxpRUFBaUUsSUFBSTs7QUFFckU7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxzQ0FBc0MsWUFBWTtBQUNsRDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsbUJBQW1CLFlBQVk7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSwwQkFBMEI7QUFDMUIsNEJBQTRCO0FBQzVCLHlCQUF5QixFQUFFLEVBQUU7QUFDN0IseUJBQXlCLEVBQUUsRUFBRTtBQUM3Qiw4QkFBOEIsRUFBRSxFQUFFO0FBQ2xDLDZCQUE2QjtBQUM3QixpQ0FBaUM7QUFDakMscUNBQXFDO0FBQ3JDLHlCQUF5QixJQUFJLEVBQUU7QUFDL0IseUJBQXlCLElBQUksRUFBRTtBQUMvQiw4QkFBOEIsSUFBSSxFQUFFOztBQUVwQywyQkFBMkI7QUFDM0IsZ0NBQWdDOztBQUVoQywwQ0FBMEM7QUFDMUMsaURBQWlEOztBQUVqRCxvQ0FBb0MsSUFBSSxJQUFJOztBQUU1QztBQUNBO0FBQ0EsNEhBQTRILElBQUk7OztBQUdoSTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQSwwQ0FBMEM7QUFDMUM7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGtCQUFrQjtBQUNqQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsaUJBQWlCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxDQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixRQUFRO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxtQkFBbUIsT0FBTztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsZUFBZSxPQUFPO0FBQ3RCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7OztBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsWUFBWTtBQUNyQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSx1Q0FBdUMsRUFBRSxJQUFJLEVBQUU7QUFDL0Msb0NBQW9DLEVBQUUsSUFBSSxFQUFFOztBQUU1Qzs7QUFFQTtBQUNBLDZCQUE2QixFQUFFO0FBQy9CLHVCQUF1QixFQUFFO0FBQ3pCLHlCQUF5QixFQUFFO0FBQzNCLHVCQUF1QixFQUFFO0FBQ3pCLHFCQUFxQixFQUFFLElBQUksRUFBRTtBQUM3QixvQkFBb0IsRUFBRTtBQUN0QiwyQkFBMkIsR0FBRztBQUM5QixxQkFBcUIsRUFBRTtBQUN2QjtBQUNBLHVCQUF1QixFQUFFLElBQUksRUFBRTtBQUMvQixzQkFBc0IsRUFBRSxJQUFJLEVBQUU7QUFDOUIsb0JBQW9CLEVBQUU7QUFDdEI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLHdDQUF3QyxPQUFPO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsT0FBTztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDRNQUE0TSxFQUFFOztBQUU5TTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSwrQkFBK0I7QUFDOUM7QUFDQTs7QUFFQTtBQUNBLFVBQVUsT0FBTztBQUNqQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBLGVBQWUsbUJBQW1CO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsZUFBZSxzQkFBc0I7QUFDckM7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSw4QkFBOEIsZ0JBQWdCO0FBQzlDOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLG9CQUFvQjtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxtQkFBbUIscUJBQXFCO0FBQ3hDO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyw2QkFBNkI7QUFDbEM7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZUFBZTs7QUFFZjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsY0FBYztBQUNwQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IscUJBQXFCO0FBQ3BELEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLHFCQUFxQjtBQUNwRCxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvQkFBb0I7QUFDcEI7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOzs7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQSxDQUFDOztBQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsQ0FBQzs7O0FBR0Q7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0Esb0JBQW9CLG1CQUFtQjtBQUN2QztBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxpQkFBaUIsbUJBQW1CO0FBQ3BDO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGdDQUFnQyxJQUFJO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNB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O0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsaURBQWlELEVBQUU7QUFDbkQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxxREFBcUQsRUFBRTs7QUFFdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSwyQkFBMkIsZ0JBQWdCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBOztBQUVBLENBQUM7O0FBRUQsQ0FBQyxFQUFFLGNBQWM7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLDRCQUE0QixFQUFFO0FBQzNDO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsa0JBQWtCLEVBQUU7QUFDckM7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsd0NBQXdDO0FBQ3hDO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7OztBQUdMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixPQUFPO0FBQzFCO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSw2QkFBNkIsUUFBUTtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUEsc0JBQXNCLDRCQUE0QjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7O0FBR0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxnREFBZ0Q7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RDtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSx3REFBd0QsZ0JBQWdCO0FBQ3hFOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxvREFBb0QsZ0JBQWdCO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFNBQVM7O0FBRVQ7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBLDJCQUEyQiw0QkFBNEI7QUFDdkQ7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsMkJBQTJCLHlCQUF5QjtBQUNwRDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLFdBQVc7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRDtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUEsQ0FBQzs7QUFFRCxDQUFDLEVBQUUsa0JBQWtCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxTQUFTO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLHNDQUFzQyxTQUFTO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLFNBQVM7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsS0FBSztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLEtBQUs7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxzQ0FBc0MsU0FBUztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSx1REFBdUQsU0FBUztBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0Esc0NBQXNDLFNBQVM7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsU0FBUztBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCOztBQUV0QjtBQUNBLHFCQUFxQjs7QUFFckI7QUFDQSxzQkFBc0I7O0FBRXRCO0FBQ0Esb0JBQW9COztBQUVwQjtBQUNBLG9CQUFvQjs7QUFFcEI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3c0JBQXdzQjtBQUN4c0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0RBQXdELFNBQVM7QUFDakU7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCxLQUFLLGdCQUFnQixLQUFLO0FBQy9FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QyxTQUFTO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLFNBQVM7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxRQUFRO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLFFBQVE7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULFNBQVM7QUFDVCxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE9BQU87QUFDcEIsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIscUJBQXFCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLGlDQUFpQyxLQUFLO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsU0FBUztBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsU0FBUztBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsNEVBQTRFO0FBQy9IO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0VBQStFO0FBQy9FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLENBQUM7QUFDRCxDQUFDLEdBQUcsRUFBRSxHQUFHO0FBQ1QsQ0FBQyxFOzs7Ozs7Ozs7QUMxMGtDRDtBQUNBLHVCQUFpSzs7QUFFaks7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBc0Y7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0VBQStFLGlEQUFpRCxJQUFJO0FBQ3BJLG1DQUFtQzs7QUFFbkM7QUFDQSxZQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLENBQUM7O0FBRUQ7Ozs7Ozs7O0FDL0JBLGdCQUFnQixtQkFBbUIsYUFBYSwwQkFBMEI7QUFDMUU7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQzs7Ozs7OztBQ3BCQSxnQkFBZ0IsbUJBQW1CLGFBQWEsMEJBQTBCO0FBQzFFO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEM7Ozs7Ozs7QUNYQTs7QUFFQTtBQUNBLHFDQUFnTDtBQUNoTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEdBQTBHLHFFQUFxRTtBQUMvSyxtSEFBbUgscUVBQXFFO0FBQ3hMO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLGdDQUFnQyxVQUFVLEVBQUU7QUFDNUMsQyIsImZpbGUiOiJqcy8yMC5jYTZiMDBkYWM0ODg5MTEzNDY2YS5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBDb21wb25lbnQgPSByZXF1aXJlKFwiIS4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy92dWUtbG9hZGVyL2xpYi9jb21wb25lbnQtbm9ybWFsaXplclwiKShcbiAgLyogc2NyaXB0ICovXG4gIHJlcXVpcmUoXCIhIWJhYmVsLWxvYWRlcj9jYWNoZURpcmVjdG9yeSEuLi8uLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvdnVlLWxvYWRlci9saWIvc2VsZWN0b3I/dHlwZT1zY3JpcHQmaW5kZXg9MCEuL0hhbmRzb250YWJsZS52dWVcIiksXG4gIC8qIHRlbXBsYXRlICovXG4gIHJlcXVpcmUoXCIhIS4uLy4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy92dWUtbG9hZGVyL2xpYi90ZW1wbGF0ZS1jb21waWxlci9pbmRleD97XFxcImlkXFxcIjpcXFwiZGF0YS12LTBmNzAxYmY1XFxcIn0hLi4vLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3Z1ZS1sb2FkZXIvbGliL3NlbGVjdG9yP3R5cGU9dGVtcGxhdGUmaW5kZXg9MCEuL0hhbmRzb250YWJsZS52dWVcIiksXG4gIC8qIHNjb3BlSWQgKi9cbiAgbnVsbCxcbiAgLyogY3NzTW9kdWxlcyAqL1xuICBudWxsXG4pXG5Db21wb25lbnQub3B0aW9ucy5fX2ZpbGUgPSBcIi9ob21lL2tpbW5oL0NvZGVzL1dlYlNob3AvYWRtaW4tdGVtcGxhdGUvbGFyYXZlbC12dWUtYWRtaW4vcmVzb3VyY2VzL2J1aWxkcy9qcy92aWV3cy90YWJsZXMvSGFuZHNvbnRhYmxlLnZ1ZVwiXG5pZiAoQ29tcG9uZW50LmVzTW9kdWxlICYmIE9iamVjdC5rZXlzKENvbXBvbmVudC5lc01vZHVsZSkuc29tZShmdW5jdGlvbiAoa2V5KSB7cmV0dXJuIGtleSAhPT0gXCJkZWZhdWx0XCIgJiYga2V5ICE9PSBcIl9fZXNNb2R1bGVcIn0pKSB7Y29uc29sZS5lcnJvcihcIm5hbWVkIGV4cG9ydHMgYXJlIG5vdCBzdXBwb3J0ZWQgaW4gKi52dWUgZmlsZXMuXCIpfVxuaWYgKENvbXBvbmVudC5vcHRpb25zLmZ1bmN0aW9uYWwpIHtjb25zb2xlLmVycm9yKFwiW3Z1ZS1sb2FkZXJdIEhhbmRzb250YWJsZS52dWU6IGZ1bmN0aW9uYWwgY29tcG9uZW50cyBhcmUgbm90IHN1cHBvcnRlZCB3aXRoIHRlbXBsYXRlcywgdGhleSBzaG91bGQgdXNlIHJlbmRlciBmdW5jdGlvbnMuXCIpfVxuXG4vKiBob3QgcmVsb2FkICovXG5pZiAobW9kdWxlLmhvdCkgeyhmdW5jdGlvbiAoKSB7XG4gIHZhciBob3RBUEkgPSByZXF1aXJlKFwidnVlLWhvdC1yZWxvYWQtYXBpXCIpXG4gIGhvdEFQSS5pbnN0YWxsKHJlcXVpcmUoXCJ2dWVcIiksIGZhbHNlKVxuICBpZiAoIWhvdEFQSS5jb21wYXRpYmxlKSByZXR1cm5cbiAgbW9kdWxlLmhvdC5hY2NlcHQoKVxuICBpZiAoIW1vZHVsZS5ob3QuZGF0YSkge1xuICAgIGhvdEFQSS5jcmVhdGVSZWNvcmQoXCJkYXRhLXYtMGY3MDFiZjVcIiwgQ29tcG9uZW50Lm9wdGlvbnMpXG4gIH0gZWxzZSB7XG4gICAgaG90QVBJLnJlbG9hZChcImRhdGEtdi0wZjcwMWJmNVwiLCBDb21wb25lbnQub3B0aW9ucylcbiAgfVxufSkoKX1cblxubW9kdWxlLmV4cG9ydHMgPSBDb21wb25lbnQuZXhwb3J0c1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9yZXNvdXJjZXMvYnVpbGRzL2pzL3ZpZXdzL3RhYmxlcy9IYW5kc29udGFibGUudnVlXG4vLyBtb2R1bGUgaWQgPSAxNTRcbi8vIG1vZHVsZSBjaHVua3MgPSAyMCIsIjx0ZW1wbGF0ZT5cbiAgPGRpdiBjbGFzcz1cImhhbmRzb250YWJsZVwiPjwvZGl2PlxuPC90ZW1wbGF0ZT5cblxuPHNjcmlwdD5cbmltcG9ydCBIYW5kc29udGFibGUgZnJvbSAnaGFuZHNvbnRhYmxlL2Rpc3QvaGFuZHNvbnRhYmxlLmZ1bGwuanMnXG5cbmV4cG9ydCBkZWZhdWx0IHtcblxuICBwcm9wczoge1xuICAgIGRhdGE6IHtcbiAgICAgIHR5cGU6IEFycmF5LFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICBkZWZhdWx0OiAoKSA9PiAoW10pXG4gICAgfSxcbiAgICBzZXR0aW5nczoge1xuICAgICAgdHlwZTogT2JqZWN0LFxuICAgICAgZGVmYXVsdDogKCkgPT4gKHt9KVxuICAgIH1cbiAgfSxcblxuICBtb3VudGVkICgpIHtcbiAgICB0aGlzLnNldHRpbmdzLmRhdGEgPSB0aGlzLmRhdGFcbiAgICB0aGlzLnRhYmxlID0gbmV3IEhhbmRzb250YWJsZSh0aGlzLiRlbCwgdGhpcy5zZXR0aW5ncylcbiAgfSxcblxuICBiZWZvcmVEZXN0cm95ICgpIHtcbiAgICB0aGlzLnRhYmxlLmRlc3Ryb3koKVxuICB9XG5cbn1cbjwvc2NyaXB0PlxuXG48c3R5bGU+XG5AaW1wb3J0IFwifmhhbmRzb250YWJsZS9kaXN0L2hhbmRzb250YWJsZS5mdWxsLmNzc1wiO1xuPC9zdHlsZT5cblxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIEhhbmRzb250YWJsZS52dWU/NzE1MmQ0NzciLCI8dGVtcGxhdGU+XG4gIDxkaXY+XG4gICAgPGRpdiBjbGFzcz1cInRpbGUgaXMtYW5jZXN0b3JcIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJ0aWxlIGlzLXBhcmVudFwiPlxuICAgICAgICA8YXJ0aWNsZSBjbGFzcz1cInRpbGUgaXMtY2hpbGQgYm94XCI+XG4gICAgICAgICAgPGgxPkRhdGEgZ3JpZDwvaDE+XG4gICAgICAgICAgPGhhbmRzb250YWJsZSA6ZGF0YT1cInJhd0RhdGFcIiA6c2V0dGluZ3M9XCJ7IH1cIj48L2hhbmRzb250YWJsZT5cbiAgICAgICAgPC9hcnRpY2xlPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuPC90ZW1wbGF0ZT5cblxuPHNjcmlwdD5cbmltcG9ydCBIYW5kc29udGFibGUgZnJvbSAndnVlLWhhbmRzb250YWJsZSdcblxuZXhwb3J0IGRlZmF1bHQge1xuICBjb21wb25lbnRzOiB7XG4gICAgSGFuZHNvbnRhYmxlXG4gIH0sXG5cbiAgZGF0YSAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJhd0RhdGE6IFtcbiAgICAgICAgWycnLCAnS2lhJywgJ05pc3NhbicsICdUb3lvdGEnLCAnSG9uZGEnXSxcbiAgICAgICAgWycyMDA4JywgMTAsIDExLCAxMiwgMTNdLFxuICAgICAgICBbJzIwMDknLCAyMCwgMTEsIDE0LCAxM10sXG4gICAgICAgIFsnMjAxMCcsIDMwLCAxNSwgMTIsIDEzXVxuICAgICAgXVxuICAgIH1cbiAgfVxufVxuPC9zY3JpcHQ+XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gSGFuZHNvbnRhYmxlLnZ1ZT8yY2I2NmJjMSIsImV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCIuLi8uLi9jc3MtbG9hZGVyL2xpYi9jc3MtYmFzZS5qc1wiKSgpO1xuLy8gaW1wb3J0c1xuXG5cbi8vIG1vZHVsZVxuZXhwb3J0cy5wdXNoKFttb2R1bGUuaWQsIFwiLyohXFxuKFRoZSBNSVQgTGljZW5zZSlcXG5cXG5Db3B5cmlnaHQgKGMpIDIwMTItMjAxNCBNYXJjaW4gV2FycGVjaG93c2tpXFxuQ29weXJpZ2h0IChjKSAyMDE1IEhhbmRzb25jb2RlIHNwLiB6IG8uby4gPGhlbGxvQGhhbmRzb25jb2RlLm5ldD5cXG5cXG5QZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmdcXG5hIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcXG4nU29mdHdhcmUnKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nXFxud2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxcbmRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0b1xcbnBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0b1xcbnRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcXG5cXG5UaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZVxcbmluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxcblxcblRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAnQVMgSVMnLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELFxcbkVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxcbk1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC5cXG5JTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWVxcbkNMQUlNLCBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsXFxuVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEVcXG5TT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cXG5cXG4qL1xcbi5oYW5kc29udGFibGUge1xcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIC5oaWRle1xcbiAgZGlzcGxheTogbm9uZTtcXG59XFxuLmhhbmRzb250YWJsZSAucmVsYXRpdmUge1xcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlLmh0QXV0b1NpemUge1xcbiAgdmlzaWJpbGl0eTogaGlkZGVuO1xcbiAgbGVmdDogLTk5MDAwcHg7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB0b3A6IC05OTAwMHB4O1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIC53dEhpZGVyIHtcXG4gIHdpZHRoOiAwO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIC53dFNwcmVhZGVyIHtcXG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcXG4gIHdpZHRoOiAwOyAvKm11c3QgYmUgMCwgb3RoZXJ3aXNlIGJsYW5rIHNwYWNlIGFwcGVhcnMgaW4gc2Nyb2xsIGRlbW8gYWZ0ZXIgc2Nyb2xsaW5nIG1heCB0byB0aGUgcmlnaHQgKi9cXG4gIGhlaWdodDogYXV0bztcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0YWJsZSxcXG4uaGFuZHNvbnRhYmxlIHRib2R5LFxcbi5oYW5kc29udGFibGUgdGhlYWQsXFxuLmhhbmRzb250YWJsZSB0ZCxcXG4uaGFuZHNvbnRhYmxlIHRoLFxcbi5oYW5kc29udGFibGUgaW5wdXQsXFxuLmhhbmRzb250YWJsZSB0ZXh0YXJlYSxcXG4uaGFuZHNvbnRhYmxlIGRpdiB7XFxuICBib3gtc2l6aW5nOiBjb250ZW50LWJveDtcXG4gIC13ZWJraXQtYm94LXNpemluZzogY29udGVudC1ib3g7XFxuICAtbW96LWJveC1zaXppbmc6IGNvbnRlbnQtYm94O1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIGlucHV0LFxcbi5oYW5kc29udGFibGUgdGV4dGFyZWEge1xcbiAgbWluLWhlaWdodDogaW5pdGlhbDtcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0YWJsZS5odENvcmUge1xcbiAgYm9yZGVyLWNvbGxhcHNlOiBzZXBhcmF0ZTtcXG4gIC8qaXQgbXVzdCBiZSBzZXBhcmF0ZSwgb3RoZXJ3aXNlIHRoZXJlIGFyZSBvZmZzZXQgbWlzY2FsY3VsYXRpb25zIGluIFdlYktpdDogaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8yNjU1OTg3L2JvcmRlci1jb2xsYXBzZS1kaWZmZXJlbmNlcy1pbi1mZi1hbmQtd2Via2l0Ki9cXG4gIC8qdGhpcyBhY3R1YWxseSBvbmx5IGNoYW5nZXMgYXBwZWFyYW5jZSBvZiB1c2VyIHNlbGVjdGlvbiAtIGRvZXMgbm90IG1ha2UgdGV4dCB1bnNlbGVjdGFibGVcXG4gIC13ZWJraXQtdXNlci1zZWxlY3Q6IG5vbmU7XFxuICAta2h0bWwtdXNlci1zZWxlY3Q6IG5vbmU7XFxuICAtbW96LXVzZXItc2VsZWN0OiBub25lO1xcbiAgLW8tdXNlci1zZWxlY3Q6IG5vbmU7XFxuICAtbXMtdXNlci1zZWxlY3Q6IG5vbmU7XFxuICAvKnVzZXItc2VsZWN0OiBub25lOyAvKm5vIGJyb3dzZXIgc3VwcG9ydHMgdW5wcmVmaXhlZCB2ZXJzaW9uKi9cXG4gIGJvcmRlci1zcGFjaW5nOiAwO1xcbiAgbWFyZ2luOiAwO1xcbiAgYm9yZGVyLXdpZHRoOiAwO1xcbiAgdGFibGUtbGF5b3V0OiBmaXhlZDtcXG4gIHdpZHRoOiAwO1xcbiAgb3V0bGluZS13aWR0aDogMDtcXG4gIC8qIHJlc2V0IGJvb3RzdHJhcCB0YWJsZSBzdHlsZS4gZm9yIG1vcmUgaW5mbyBzZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9oYW5kc29udGFibGUvaGFuZHNvbnRhYmxlL2lzc3Vlcy8yMjQgKi9cXG4gIG1heC13aWR0aDogbm9uZTtcXG4gIG1heC1oZWlnaHQ6IG5vbmU7XFxufVxcblxcbi5oYW5kc29udGFibGUgY29sIHtcXG4gIHdpZHRoOiA1MHB4O1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIGNvbC5yb3dIZWFkZXIge1xcbiAgd2lkdGg6IDUwcHg7XFxufVxcblxcbi5oYW5kc29udGFibGUgdGgsXFxuLmhhbmRzb250YWJsZSB0ZCB7XFxuICBib3JkZXItdG9wLXdpZHRoOiAwO1xcbiAgYm9yZGVyLWxlZnQtd2lkdGg6IDA7XFxuICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCAjQ0NDO1xcbiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNDQ0M7XFxuICBoZWlnaHQ6IDIycHg7XFxuICBlbXB0eS1jZWxsczogc2hvdztcXG4gIGxpbmUtaGVpZ2h0OiAyMXB4O1xcbiAgcGFkZGluZzogMCA0cHggMCA0cHg7XFxuICAvKiB0b3AsIGJvdHRvbSBwYWRkaW5nIGRpZmZlcmVudCB0aGFuIDAgaXMgaGFuZGxlZCBwb29ybHkgYnkgRkYgd2l0aCBIVE1MNSBkb2N0eXBlICovXFxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjRkZGO1xcbiAgdmVydGljYWwtYWxpZ246IHRvcDtcXG4gIG92ZXJmbG93OiBoaWRkZW47XFxuICBvdXRsaW5lLXdpZHRoOiAwO1xcbiAgd2hpdGUtc3BhY2U6IHByZS1saW5lO1xcbiAgLyogcHJlc2VydmUgbmV3IGxpbmUgY2hhcmFjdGVyIGluIGNlbGwgKi9cXG4gIGJhY2tncm91bmQtY2xpcDogcGFkZGluZy1ib3g7XFxufVxcblxcbi5oYW5kc29udGFibGUgdGQuaHRJbnZhbGlkIHtcXG4gIGJhY2tncm91bmQtY29sb3I6ICNmZjRjNDIgIWltcG9ydGFudDsgLypnaXZlcyBwcmlvcml0eSBvdmVyIHRkLmFyZWEgc2VsZWN0aW9uIGJhY2tncm91bmQqL1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIHRkLmh0Tm9XcmFwIHtcXG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XFxufVxcblxcbi5oYW5kc29udGFibGUgdGg6bGFzdC1jaGlsZCB7XFxuICAvKkZvdW5kYXRpb24gZnJhbWV3b3JrIGZpeCovXFxuICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCAjQ0NDO1xcbiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNDQ0M7XFxufVxcblxcbi5oYW5kc29udGFibGUgdHI6Zmlyc3QtY2hpbGQgdGguaHROb0ZyYW1lLFxcbi5oYW5kc29udGFibGUgdGg6Zmlyc3QtY2hpbGQuaHROb0ZyYW1lLFxcbi5oYW5kc29udGFibGUgdGguaHROb0ZyYW1lIHtcXG4gIGJvcmRlci1sZWZ0LXdpZHRoOiAwO1xcbiAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7XFxuICBib3JkZXItY29sb3I6ICNGRkY7XFxufVxcblxcbi5oYW5kc29udGFibGUgdGg6Zmlyc3QtY2hpbGQsXFxuLmhhbmRzb250YWJsZSB0aDpudGgtY2hpbGQoMiksXFxuLmhhbmRzb250YWJsZSB0ZDpmaXJzdC1vZi10eXBlLFxcbi5oYW5kc29udGFibGUgLmh0Tm9GcmFtZSArIHRoLFxcbi5oYW5kc29udGFibGUgLmh0Tm9GcmFtZSArIHRkIHtcXG4gIGJvcmRlci1sZWZ0OiAxcHggc29saWQgI0NDQztcXG59XFxuXFxuLmhhbmRzb250YWJsZS5odFJvd0hlYWRlcnMgdGhlYWQgdHIgdGg6bnRoLWNoaWxkKDIpIHtcXG4gIGJvcmRlci1sZWZ0OiAxcHggc29saWQgI0NDQztcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0cjpmaXJzdC1jaGlsZCB0aCxcXG4uaGFuZHNvbnRhYmxlIHRyOmZpcnN0LWNoaWxkIHRkIHtcXG4gIGJvcmRlci10b3A6IDFweCBzb2xpZCAjQ0NDO1xcbn1cXG5cXG4uaHRfbWFzdGVyOm5vdCguaW5uZXJCb3JkZXJMZWZ0KTpub3QoLmVtcHR5Q29sdW1ucykgfiAuaGFuZHNvbnRhYmxlIHRib2R5IHRyIHRoLFxcbi5odF9tYXN0ZXI6bm90KC5pbm5lckJvcmRlckxlZnQpOm5vdCguZW1wdHlDb2x1bW5zKSB+IC5oYW5kc29udGFibGU6bm90KC5odF9jbG9uZV90b3ApIHRoZWFkIHRyIHRoOmZpcnN0LWNoaWxkIHtcXG4gIGJvcmRlci1yaWdodC13aWR0aDogMDtcXG59XFxuXFxuLmh0X21hc3Rlcjpub3QoLmlubmVyQm9yZGVyVG9wKSB0aGVhZCB0cjpsYXN0LWNoaWxkIHRoLFxcbi5odF9tYXN0ZXI6bm90KC5pbm5lckJvcmRlclRvcCkgfiAuaGFuZHNvbnRhYmxlIHRoZWFkIHRyOmxhc3QtY2hpbGQgdGgsXFxuLmh0X21hc3Rlcjpub3QoLmlubmVyQm9yZGVyVG9wKSB0aGVhZCB0ci5sYXN0Q2hpbGQgdGgsXFxuLmh0X21hc3Rlcjpub3QoLmlubmVyQm9yZGVyVG9wKSB+IC5oYW5kc29udGFibGUgdGhlYWQgdHIubGFzdENoaWxkIHRoIHtcXG4gIGJvcmRlci1ib3R0b20td2lkdGg6IDA7XFxufVxcblxcbi5oYW5kc29udGFibGUgdGgge1xcbiAgYmFja2dyb3VuZC1jb2xvcjogI2YzZjNmMztcXG4gIGNvbG9yOiAjMjIyO1xcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xcbiAgZm9udC13ZWlnaHQ6IG5vcm1hbDtcXG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XFxufVxcblxcbi5oYW5kc29udGFibGUgdGhlYWQgdGgge1xcbiAgcGFkZGluZzogMDtcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0aC5hY3RpdmUge1xcbiAgYmFja2dyb3VuZC1jb2xvcjogI0NDQztcXG59XFxuLmhhbmRzb250YWJsZSB0aGVhZCB0aCAucmVsYXRpdmUge1xcbiAgcGFkZGluZzogMnB4IDRweDtcXG59XFxuXFxuLyogc2VsZWN0aW9uICovXFxuLmhhbmRzb250YWJsZSB0Ym9keSB0aC5odF9faGlnaGxpZ2h0LFxcbi5oYW5kc29udGFibGUgdGhlYWQgdGguaHRfX2hpZ2hsaWdodCB7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZGNkY2RjO1xcbn1cXG4uaGFuZHNvbnRhYmxlLmh0X19zZWxlY3Rpb24tLWNvbHVtbnMgdGhlYWQgdGguaHRfX2hpZ2hsaWdodCxcXG4uaGFuZHNvbnRhYmxlLmh0X19zZWxlY3Rpb24tLXJvd3MgdGJvZHkgdGguaHRfX2hpZ2hsaWdodCB7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjOGViMGU3O1xcbiAgY29sb3I6ICMwMDA7XFxufVxcblxcbi8qIHBsdWdpbnMgKi9cXG5cXG4vKiByb3cgKyBjb2x1bW4gcmVzaXplciovXFxuLmhhbmRzb250YWJsZSAubWFudWFsQ29sdW1uUmVzaXplciB7XFxuICBwb3NpdGlvbjogZml4ZWQ7XFxuICB0b3A6IDA7XFxuICBjdXJzb3I6IGNvbC1yZXNpemU7XFxuICB6LWluZGV4OiAxMTA7XFxuICB3aWR0aDogNXB4O1xcbiAgaGVpZ2h0OiAyNXB4O1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIC5tYW51YWxSb3dSZXNpemVyIHtcXG4gIHBvc2l0aW9uOiBmaXhlZDtcXG4gIGxlZnQ6IDA7XFxuICBjdXJzb3I6IHJvdy1yZXNpemU7XFxuICB6LWluZGV4OiAxMTA7XFxuICBoZWlnaHQ6IDVweDtcXG4gIHdpZHRoOiA1MHB4O1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIC5tYW51YWxDb2x1bW5SZXNpemVyOmhvdmVyLFxcbi5oYW5kc29udGFibGUgLm1hbnVhbENvbHVtblJlc2l6ZXIuYWN0aXZlLFxcbi5oYW5kc29udGFibGUgLm1hbnVhbFJvd1Jlc2l6ZXI6aG92ZXIsXFxuLmhhbmRzb250YWJsZSAubWFudWFsUm93UmVzaXplci5hY3RpdmUge1xcbiAgYmFja2dyb3VuZC1jb2xvcjogI0FBQjtcXG59XFxuXFxuLmhhbmRzb250YWJsZSAubWFudWFsQ29sdW1uUmVzaXplckd1aWRlIHtcXG4gIHBvc2l0aW9uOiBmaXhlZDtcXG4gIHJpZ2h0OiAwO1xcbiAgdG9wOiAwO1xcbiAgYmFja2dyb3VuZC1jb2xvcjogI0FBQjtcXG4gIGRpc3BsYXk6IG5vbmU7XFxuICB3aWR0aDogMDtcXG4gIGJvcmRlci1yaWdodDogMXB4IGRhc2hlZCAjNzc3O1xcbiAgbWFyZ2luLWxlZnQ6IDVweDtcXG59XFxuXFxuLmhhbmRzb250YWJsZSAubWFudWFsUm93UmVzaXplckd1aWRlIHtcXG4gIHBvc2l0aW9uOiBmaXhlZDtcXG4gIGxlZnQ6IDA7XFxuICBib3R0b206IDA7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjQUFCO1xcbiAgZGlzcGxheTogbm9uZTtcXG4gIGhlaWdodDogMDtcXG4gIGJvcmRlci1ib3R0b206IDFweCBkYXNoZWQgIzc3NztcXG4gIG1hcmdpbi10b3A6IDVweDtcXG59XFxuXFxuLmhhbmRzb250YWJsZSAubWFudWFsQ29sdW1uUmVzaXplckd1aWRlLmFjdGl2ZSxcXG4uaGFuZHNvbnRhYmxlIC5tYW51YWxSb3dSZXNpemVyR3VpZGUuYWN0aXZlIHtcXG4gIGRpc3BsYXk6IGJsb2NrO1xcbiAgei1pbmRleDogMTk5O1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIC5jb2x1bW5Tb3J0aW5nIHtcXG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcXG59XFxuXFxuLmhhbmRzb250YWJsZSAuY29sdW1uU29ydGluZzpob3ZlciB7XFxuICB0ZXh0LWRlY29yYXRpb246IHVuZGVybGluZTtcXG4gIGN1cnNvcjogcG9pbnRlcjtcXG59XFxuXFxuLmhhbmRzb250YWJsZSAuY29sdW1uU29ydGluZy5hc2NlbmRpbmc6OmFmdGVyIHtcXG4gIGNvbnRlbnQ6ICdcXFxcMjVCMic7XFxuICBjb2xvcjogIzVmNWY1ZjtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHJpZ2h0OiAtMTVweDtcXG59XFxuXFxuLmhhbmRzb250YWJsZSAuY29sdW1uU29ydGluZy5kZXNjZW5kaW5nOjphZnRlciB7XFxuICBjb250ZW50OiAnXFxcXDI1QkMnO1xcbiAgY29sb3I6ICM1ZjVmNWY7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICByaWdodDogLTE1cHg7XFxufVxcblxcbi8qIGJvcmRlciBsaW5lICovXFxuXFxuLmhhbmRzb250YWJsZSAud3RCb3JkZXIge1xcbiAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgZm9udC1zaXplOiAwO1xcbn1cXG4uaGFuZHNvbnRhYmxlIC53dEJvcmRlci5oaWRkZW57XFxuICBkaXNwbGF5Om5vbmUgIWltcG9ydGFudDtcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0ZC5hcmVhIHtcXG4gIGJhY2tncm91bmQ6IC1tb3otbGluZWFyLWdyYWRpZW50KHRvcCwgIHJnYmEoMTgxLDIwOSwyNTUsMC4zNCkgMCUsIHJnYmEoMTgxLDIwOSwyNTUsMC4zNCkgMTAwJSk7IC8qIEZGMy42KyAqL1xcbiAgYmFja2dyb3VuZDogLXdlYmtpdC1ncmFkaWVudChsaW5lYXIsIGxlZnQgdG9wLCBsZWZ0IGJvdHRvbSwgY29sb3Itc3RvcCgwJSxyZ2JhKDE4MSwyMDksMjU1LDAuMzQpKSwgY29sb3Itc3RvcCgxMDAlLHJnYmEoMTgxLDIwOSwyNTUsMC4zNCkpKTsgLyogQ2hyb21lLFNhZmFyaTQrICovXFxuICBiYWNrZ3JvdW5kOiAtd2Via2l0LWxpbmVhci1ncmFkaWVudCh0b3AsICByZ2JhKDE4MSwyMDksMjU1LDAuMzQpIDAlLHJnYmEoMTgxLDIwOSwyNTUsMC4zNCkgMTAwJSk7IC8qIENocm9tZTEwKyxTYWZhcmk1LjErICovXFxuICBiYWNrZ3JvdW5kOiAtby1saW5lYXItZ3JhZGllbnQodG9wLCAgcmdiYSgxODEsMjA5LDI1NSwwLjM0KSAwJSxyZ2JhKDE4MSwyMDksMjU1LDAuMzQpIDEwMCUpOyAvKiBPcGVyYSAxMS4xMCsgKi9cXG4gIGJhY2tncm91bmQ6IC1tcy1saW5lYXItZ3JhZGllbnQodG9wLCAgcmdiYSgxODEsMjA5LDI1NSwwLjM0KSAwJSxyZ2JhKDE4MSwyMDksMjU1LDAuMzQpIDEwMCUpOyAvKiBJRTEwKyAqL1xcbiAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KHRvIGJvdHRvbSwgIHJnYmEoMTgxLDIwOSwyNTUsMC4zNCkgMCUscmdiYSgxODEsMjA5LDI1NSwwLjM0KSAxMDAlKTsgLyogVzNDICovXFxuICBmaWx0ZXI6IHByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5ncmFkaWVudCggc3RhcnRDb2xvcnN0cj0nIzU3YjVkMWZmJywgZW5kQ29sb3JzdHI9JyM1N2I1ZDFmZicsR3JhZGllbnRUeXBlPTAgKTsgLyogSUU2LTkgKi9cXG4gIGJhY2tncm91bmQtY29sb3I6ICNmZmY7XFxufVxcblxcbi8qIGZpbGwgaGFuZGxlICovXFxuXFxuLmhhbmRzb250YWJsZSAud3RCb3JkZXIuY29ybmVyIHtcXG4gIGZvbnQtc2l6ZTogMDtcXG4gIGN1cnNvcjogY3Jvc3NoYWlyO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIC5odEJvcmRlci5odEZpbGxCb3JkZXIge1xcbiAgYmFja2dyb3VuZDogcmVkO1xcbiAgd2lkdGg6IDFweDtcXG4gIGhlaWdodDogMXB4O1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlSW5wdXQge1xcbiAgYm9yZGVyOm5vbmU7XFxuICBvdXRsaW5lLXdpZHRoOiAwO1xcbiAgbWFyZ2luOiAwIDtcXG4gIHBhZGRpbmc6IDFweCA1cHggMCA1cHg7XFxuICBmb250LWZhbWlseTogaW5oZXJpdDtcXG4gIGxpbmUtaGVpZ2h0OiAyMXB4O1xcbiAgZm9udC1zaXplOiBpbmhlcml0O1xcbiAgYm94LXNoYWRvdzogMCAwIDAgMnB4ICM1MjkyRjcgaW5zZXQ7XFxuICByZXNpemU6IG5vbmU7XFxuICAvKmJlbG93IGFyZSBuZWVkZWQgdG8gb3ZlcndyaXRlIHN0dWZmIGFkZGVkIGJ5IGpRdWVyeSBVSSBCb290c3RyYXAgdGhlbWUqL1xcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xcbiAgY29sb3I6ICMwMDA7XFxuICBib3JkZXItcmFkaXVzOiAwO1xcbiAgYmFja2dyb3VuZC1jb2xvcjogI0ZGRjtcXG4gIC8qb3ZlcndyaXRlIHN0eWxlcyBwb3RlbnRpb25hbGx5IG1hZGUgYnkgYSBmcmFtZXdvcmsqL1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlSW5wdXRIb2xkZXIge1xcbiAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgdG9wOiAwO1xcbiAgbGVmdDogMDtcXG4gIHotaW5kZXg6IDEwMDtcXG59XFxuXFxuLmh0U2VsZWN0RWRpdG9yIHtcXG4gIC13ZWJraXQtYXBwZWFyYW5jZTogbWVudWxpc3QtYnV0dG9uICFpbXBvcnRhbnQ7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB3aWR0aDogYXV0bztcXG59XFxuXFxuLypcXG5UZXh0UmVuZGVyZXIgcmVhZE9ubHkgY2VsbFxcbiovXFxuXFxuLmhhbmRzb250YWJsZSAuaHREaW1tZWQge1xcbiAgY29sb3I6ICM3Nzc7XFxufVxcblxcbi5oYW5kc29udGFibGUgLmh0U3VibWVudSB7XFxuICBwb3NpdGlvbjogcmVsYXRpdmU7XFxufVxcblxcbi5oYW5kc29udGFibGUgLmh0U3VibWVudSA6YWZ0ZXJ7XFxuICBjb250ZW50OiAnXFxcXDI1QjYnO1xcbiAgY29sb3I6ICM3Nzc7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICByaWdodDogNXB4O1xcbn1cXG5cXG5cXG4vKlxcblRleHRSZW5kZXJlciBob3Jpem9udGFsIGFsaWdubWVudFxcbiovXFxuLmhhbmRzb250YWJsZSAuaHRMZWZ0e1xcbiAgdGV4dC1hbGlnbjogbGVmdDtcXG59XFxuLmhhbmRzb250YWJsZSAuaHRDZW50ZXJ7XFxuICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxufVxcbi5oYW5kc29udGFibGUgLmh0UmlnaHR7XFxuICB0ZXh0LWFsaWduOiByaWdodDtcXG59XFxuLmhhbmRzb250YWJsZSAuaHRKdXN0aWZ5e1xcbiAgdGV4dC1hbGlnbjoganVzdGlmeTtcXG59XFxuLypcXG5UZXh0UmVuZGVyZXIgdmVydGljYWwgYWxpZ25tZW50XFxuKi9cXG4uaGFuZHNvbnRhYmxlIC5odFRvcHtcXG4gIHZlcnRpY2FsLWFsaWduOiB0b3A7XFxufVxcbi5oYW5kc29udGFibGUgLmh0TWlkZGxle1xcbiAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcXG59XFxuLmhhbmRzb250YWJsZSAuaHRCb3R0b217XFxuICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tO1xcbn1cXG5cXG4vKlxcblRleHRSZW5kZXJlciBwbGFjZWhvbGRlciB2YWx1ZVxcbiovXFxuXFxuLmhhbmRzb250YWJsZSAuaHRQbGFjZWhvbGRlciB7XFxuICBjb2xvcjogIzk5OTtcXG59XFxuXFxuLypcXG5BdXRvY29tcGxldGVSZW5kZXJlciBkb3duIGFycm93XFxuKi9cXG5cXG4uaGFuZHNvbnRhYmxlIC5odEF1dG9jb21wbGV0ZUFycm93IHtcXG4gIGZsb2F0OiByaWdodDtcXG4gIGZvbnQtc2l6ZTogMTBweDtcXG4gIGNvbG9yOiAjRUVFO1xcbiAgY3Vyc29yOiBkZWZhdWx0O1xcbiAgd2lkdGg6IDE2cHg7XFxuICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxufVxcblxcbi5oYW5kc29udGFibGUgdGQgLmh0QXV0b2NvbXBsZXRlQXJyb3c6aG92ZXIge1xcbiAgY29sb3I6ICM3Nzc7XFxufVxcblxcbi5oYW5kc29udGFibGUgdGQuYXJlYSAuaHRBdXRvY29tcGxldGVBcnJvdyB7XFxuICBjb2xvcjogI2QzZDNkMztcXG59XFxuXFxuLypcXG5DaGVja2JveFJlbmRlcmVyXFxuKi9cXG4uaGFuZHNvbnRhYmxlIC5odENoZWNrYm94UmVuZGVyZXJJbnB1dCB7XFxuICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XFxuICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xcbn1cXG4uaGFuZHNvbnRhYmxlIC5odENoZWNrYm94UmVuZGVyZXJJbnB1dC5ub1ZhbHVlIHtcXG4gIG9wYWNpdHk6IDAuNTtcXG59XFxuLmhhbmRzb250YWJsZSAuaHRDaGVja2JveFJlbmRlcmVyTGFiZWwge1xcbiAgY3Vyc29yOiBwb2ludGVyO1xcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xcbiAgd2lkdGg6IDEwMCU7XFxufVxcblxcbkAtd2Via2l0LWtleWZyYW1lcyBvcGFjaXR5LWhpZGUge1xcbiAgZnJvbSB7XFxuICAgIG9wYWNpdHk6IDE7XFxuICB9XFxuICB0byB7XFxuICAgIG9wYWNpdHk6IDA7XFxuICAgIC8qZGlzcGxheTogbm9uZTsqL1xcbiAgfVxcbn1cXG5Aa2V5ZnJhbWVzIG9wYWNpdHktaGlkZSB7XFxuICBmcm9tIHtcXG4gICAgLypkaXNwbGF5OiBibG9jazsqL1xcbiAgICBvcGFjaXR5OiAxO1xcbiAgfVxcbiAgdG8ge1xcbiAgICBvcGFjaXR5OiAwO1xcbiAgICAvKmRpc3BsYXk6IG5vbmU7Ki9cXG4gIH1cXG59XFxuXFxuQC13ZWJraXQta2V5ZnJhbWVzIG9wYWNpdHktc2hvdyB7XFxuICBmcm9tIHtcXG4gICAgb3BhY2l0eTogMDtcXG4gICAgLypkaXNwbGF5OiBub25lOyovXFxuICB9XFxuICB0byB7XFxuICAgIG9wYWNpdHk6IDE7XFxuICAgIC8qZGlzcGxheTogYmxvY2s7Ki9cXG4gIH1cXG59XFxuQGtleWZyYW1lcyBvcGFjaXR5LXNob3cge1xcbiAgZnJvbSB7XFxuICAgIG9wYWNpdHk6IDA7XFxuICAgIC8qZGlzcGxheTogbm9uZTsqL1xcbiAgfVxcbiAgdG8ge1xcbiAgICBvcGFjaXR5OiAxO1xcbiAgICAvKmRpc3BsYXk6IGJsb2NrOyovXFxuICB9XFxufVxcblxcbi8qKlxcbiAqIEhhbmRzb250YWJsZSBpbiBIYW5kc29udGFibGVcXG4gKi9cXG5cXG4uaGFuZHNvbnRhYmxlIC5oYW5kc29udGFibGUuaHRfY2xvbmVfdG9wIC53dEhpZGVyIHtcXG4gIHBhZGRpbmc6IDAgMCA1cHggMDtcXG59XFxuXFxuLyoqXFxuKiBBdXRvY29tcGxldGUgRWRpdG9yXFxuKi9cXG4uaGFuZHNvbnRhYmxlIC5hdXRvY29tcGxldGVFZGl0b3IuaGFuZHNvbnRhYmxlIHtcXG4gIHBhZGRpbmctcmlnaHQ6IDE3cHg7XFxufVxcbi5oYW5kc29udGFibGUgLmF1dG9jb21wbGV0ZUVkaXRvci5oYW5kc29udGFibGUuaHRNYWNTY3JvbGwge1xcbiAgcGFkZGluZy1yaWdodDogMTVweDtcXG59XFxuXFxuXFxuLyoqXFxuICogSGFuZHNvbnRhYmxlIGxpc3Rib3ggdGhlbWVcXG4gKi9cXG5cXG4uaGFuZHNvbnRhYmxlLmxpc3Rib3gge1xcbiAgbWFyZ2luOiAwO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlLmxpc3Rib3ggLmh0X21hc3RlciB0YWJsZSB7XFxuICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xcbiAgYm9yZGVyLWNvbGxhcHNlOiBzZXBhcmF0ZTtcXG4gIGJhY2tncm91bmQ6IHdoaXRlO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlLmxpc3Rib3ggdGgsXFxuLmhhbmRzb250YWJsZS5saXN0Ym94IHRyOmZpcnN0LWNoaWxkIHRoLFxcbi5oYW5kc29udGFibGUubGlzdGJveCB0cjpsYXN0LWNoaWxkIHRoLFxcbi5oYW5kc29udGFibGUubGlzdGJveCB0cjpmaXJzdC1jaGlsZCB0ZCxcXG4uaGFuZHNvbnRhYmxlLmxpc3Rib3ggdGQge1xcbiAgYm9yZGVyLWNvbG9yOiB0cmFuc3BhcmVudDtcXG59XFxuXFxuLmhhbmRzb250YWJsZS5saXN0Ym94IHRoLFxcbi5oYW5kc29udGFibGUubGlzdGJveCB0ZCB7XFxuICB3aGl0ZS1zcGFjZTogbm93cmFwO1xcbiAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XFxufVxcblxcbi5oYW5kc29udGFibGUubGlzdGJveCB0ZC5odERpbW1lZCB7XFxuICBjdXJzb3I6IGRlZmF1bHQ7XFxuICBjb2xvcjogaW5oZXJpdDtcXG4gIGZvbnQtc3R5bGU6IGluaGVyaXQ7XFxufVxcblxcbi5oYW5kc29udGFibGUubGlzdGJveCAud3RCb3JkZXIge1xcbiAgdmlzaWJpbGl0eTogaGlkZGVuO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlLmxpc3Rib3ggdHIgdGQuY3VycmVudCxcXG4uaGFuZHNvbnRhYmxlLmxpc3Rib3ggdHI6aG92ZXIgdGQge1xcbiAgYmFja2dyb3VuZDogI2VlZTtcXG59XFxuXFxuLmh0X2Nsb25lX3RvcCB7XFxuICB6LWluZGV4OiAxMDE7XFxufVxcblxcbi5odF9jbG9uZV9sZWZ0IHtcXG4gIHotaW5kZXg6IDEwMjtcXG59XFxuXFxuLmh0X2Nsb25lX3RvcF9sZWZ0X2Nvcm5lcixcXG4uaHRfY2xvbmVfYm90dG9tX2xlZnRfY29ybmVyIHtcXG4gIHotaW5kZXg6IDEwMztcXG59XFxuXFxuLmh0X2Nsb25lX2RlYnVnIHtcXG4gIHotaW5kZXg6IDEwMztcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0ZC5odFNlYXJjaFJlc3VsdCB7XFxuICBiYWNrZ3JvdW5kOiAjZmNlZGQ5O1xcbiAgY29sb3I6ICM1ODM3MDc7XFxufVxcblxcbi8qXFxuQ2VsbCBib3JkZXJzXFxuKi9cXG4uaHRCb3JkZXJlZHtcXG4gIC8qYm94LXNpemluZzogYm9yZGVyLWJveCAhaW1wb3J0YW50OyovXFxuICBib3JkZXItd2lkdGg6IDFweDtcXG59XFxuLmh0Qm9yZGVyZWQuaHRUb3BCb3JkZXJTb2xpZCB7XFxuICBib3JkZXItdG9wLXN0eWxlOiBzb2xpZDtcXG4gIGJvcmRlci10b3AtY29sb3I6ICMwMDA7XFxufVxcbi5odEJvcmRlcmVkLmh0UmlnaHRCb3JkZXJTb2xpZCB7XFxuICBib3JkZXItcmlnaHQtc3R5bGU6IHNvbGlkO1xcbiAgYm9yZGVyLXJpZ2h0LWNvbG9yOiAjMDAwO1xcbn1cXG4uaHRCb3JkZXJlZC5odEJvdHRvbUJvcmRlclNvbGlkIHtcXG4gIGJvcmRlci1ib3R0b20tc3R5bGU6IHNvbGlkO1xcbiAgYm9yZGVyLWJvdHRvbS1jb2xvcjogIzAwMDtcXG59XFxuLmh0Qm9yZGVyZWQuaHRMZWZ0Qm9yZGVyU29saWQge1xcbiAgYm9yZGVyLWxlZnQtc3R5bGU6IHNvbGlkO1xcbiAgYm9yZGVyLWxlZnQtY29sb3I6ICMwMDA7XFxufVxcblxcbi5oYW5kc29udGFibGUgdGJvZHkgdHIgdGg6bnRoLWxhc3QtY2hpbGQoMikge1xcbiAgYm9yZGVyLXJpZ2h0OiAxcHggc29saWQgI0NDQztcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0aGVhZCB0cjpudGgtbGFzdC1jaGlsZCgyKSB0aC5odEdyb3VwSW5kaWNhdG9yQ29udGFpbmVyIHtcXG4gIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjQ0NDO1xcbiAgcGFkZGluZy1ib3R0b206IDVweDtcXG59XFxuXFxuXFxuLmh0X2Nsb25lX3RvcF9sZWZ0X2Nvcm5lciB0aGVhZCB0ciB0aDpudGgtbGFzdC1jaGlsZCgyKSB7XFxuICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCAjQ0NDO1xcbn1cXG5cXG4uaHRDb2xsYXBzZUJ1dHRvbiB7XFxuICB3aWR0aDogMTBweDtcXG4gIGhlaWdodDogMTBweDtcXG4gIGxpbmUtaGVpZ2h0OiAxMHB4O1xcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xcbiAgYm9yZGVyLXJhZGl1czogNXB4O1xcbiAgYm9yZGVyOiAxcHggc29saWQgI2YzZjNmMztcXG4gIC13ZWJraXQtYm94LXNoYWRvdzogMXB4IDFweCAzcHggcmdiYSgwLCAwLCAwLCAwLjQpO1xcbiAgYm94LXNoYWRvdzogMXB4IDFweCAzcHggcmdiYSgwLCAwLCAwLCAwLjQpO1xcbiAgY3Vyc29yOiBwb2ludGVyO1xcbiAgbWFyZ2luLWJvdHRvbTogM3B4O1xcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xcbn1cXG5cXG4uaHRDb2xsYXBzZUJ1dHRvbjphZnRlciB7XFxuICBjb250ZW50OiBcXFwiXFxcIjtcXG4gIGhlaWdodDogMzAwJTtcXG4gIHdpZHRoOiAxcHg7XFxuICBkaXNwbGF5OiBibG9jaztcXG4gIGJhY2tncm91bmQ6ICNjY2M7XFxuICBtYXJnaW4tbGVmdDogNHB4O1xcbiAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgLyp0b3A6IC0zMDAlOyovXFxuICBib3R0b206IDEwcHg7XFxufVxcblxcblxcbnRoZWFkIC5odENvbGxhcHNlQnV0dG9uIHtcXG4gIHJpZ2h0OiA1cHg7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB0b3A6IDVweDtcXG4gIGJhY2tncm91bmQ6ICNmZmY7XFxufVxcblxcbnRoZWFkIC5odENvbGxhcHNlQnV0dG9uOmFmdGVyIHtcXG4gIGhlaWdodDogMXB4O1xcbiAgd2lkdGg6IDcwMCU7XFxuICByaWdodDogMTBweDtcXG4gIHRvcDogNHB4O1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIHRyIHRoIC5odEV4cGFuZEJ1dHRvbiB7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB3aWR0aDogMTBweDtcXG4gIGhlaWdodDogMTBweDtcXG4gIGxpbmUtaGVpZ2h0OiAxMHB4O1xcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xcbiAgYm9yZGVyLXJhZGl1czogNXB4O1xcbiAgYm9yZGVyOiAxcHggc29saWQgI2YzZjNmMztcXG4gIC13ZWJraXQtYm94LXNoYWRvdzogMXB4IDFweCAzcHggcmdiYSgwLCAwLCAwLCAwLjQpO1xcbiAgYm94LXNoYWRvdzogMXB4IDFweCAzcHggcmdiYSgwLCAwLCAwLCAwLjQpO1xcbiAgY3Vyc29yOiBwb2ludGVyO1xcbiAgdG9wOiAwO1xcbiAgZGlzcGxheTogbm9uZTtcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0aGVhZCB0ciB0aCAuaHRFeHBhbmRCdXR0b24ge1xcbiAgLypsZWZ0OiA1cHg7Ki9cXG4gIHRvcDogNXB4O1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIHRyIHRoIC5odEV4cGFuZEJ1dHRvbi5jbGlja2FibGUge1xcbiAgZGlzcGxheTogYmxvY2s7XFxufVxcblxcbi5jb2xsYXBzaWJsZUluZGljYXRvciB7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB0b3A6IDUwJTtcXG4gIHRyYW5zZm9ybTogdHJhbnNsYXRlKDAlICwtNTAlKTtcXG4gIHJpZ2h0OiA1cHg7XFxuICBib3JkZXI6IDFweCBzb2xpZCAjQTZBNkE2O1xcbiAgbGluZS1oZWlnaHQ6IDEwcHg7XFxuICBjb2xvcjogIzIyMjtcXG4gIGJvcmRlci1yYWRpdXM6IDEwcHg7XFxuICBmb250LXNpemU6IDEwcHg7XFxuICB3aWR0aDogMTBweDtcXG4gIGhlaWdodDogMTBweDtcXG4gIGN1cnNvcjogcG9pbnRlcjtcXG4gIC13ZWJraXQtYm94LXNoYWRvdzogMCAwIDAgNnB4IHJnYmEoMjM4LDIzOCwyMzgsMSk7XFxuICAtbW96LWJveC1zaGFkb3c6IDAgMCAwIDZweCByZ2JhKDIzOCwyMzgsMjM4LDEpO1xcbiAgYm94LXNoYWRvdzogMCAwIDAgNnB4IHJnYmEoMjM4LDIzOCwyMzgsMSk7XFxuICBiYWNrZ3JvdW5kOiAjZWVlO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIGNvbC5oaWRkZW4ge1xcbiAgd2lkdGg6IDAgIWltcG9ydGFudDtcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0YWJsZSB0ciB0aC5saWdodFJpZ2h0Qm9yZGVyIHtcXG4gIGJvcmRlci1yaWdodDogMXB4IHNvbGlkICNFNkU2RTY7XFxufVxcblxcbi5oYW5kc29udGFibGUgdHIuaGlkZGVuLFxcbi5oYW5kc29udGFibGUgdHIuaGlkZGVuIHRkLFxcbi5oYW5kc29udGFibGUgdHIuaGlkZGVuIHRoIHtcXG4gIGRpc3BsYXk6IG5vbmU7XFxufVxcblxcbi5odF9tYXN0ZXIsXFxuLmh0X2Nsb25lX2xlZnQsXFxuLmh0X2Nsb25lX3RvcCxcXG4uaHRfY2xvbmVfYm90dG9tIHtcXG4gIG92ZXJmbG93OiBoaWRkZW47XFxufVxcblxcbi5odF9tYXN0ZXIgLnd0SG9sZGVyIHtcXG4gIG92ZXJmbG93OiBhdXRvO1xcbn1cXG5cXG4uaHRfY2xvbmVfbGVmdCAud3RIb2xkZXIge1xcbiAgb3ZlcmZsb3cteDogaGlkZGVuO1xcbiAgb3ZlcmZsb3cteTogYXV0bztcXG59XFxuXFxuLmh0X2Nsb25lX3RvcCAud3RIb2xkZXIsXFxuLmh0X2Nsb25lX2JvdHRvbSAud3RIb2xkZXIge1xcbiAgb3ZlcmZsb3cteDogYXV0bztcXG4gIG92ZXJmbG93LXk6IGhpZGRlbjtcXG59XFxuXFxuXFxuLypXYWxrb250YWJsZURlYnVnT3ZlcmxheSovXFxuXFxuLnd0RGVidWdIaWRkZW4ge1xcbiAgZGlzcGxheTogbm9uZTtcXG59XFxuXFxuLnd0RGVidWdWaXNpYmxlIHtcXG4gIGRpc3BsYXk6IGJsb2NrO1xcbiAgLXdlYmtpdC1hbmltYXRpb24tZHVyYXRpb246IDAuNXM7XFxuICAtd2Via2l0LWFuaW1hdGlvbi1uYW1lOiB3dEZhZGVJbkZyb21Ob25lO1xcbiAgYW5pbWF0aW9uLWR1cmF0aW9uOiAwLjVzO1xcbiAgYW5pbWF0aW9uLW5hbWU6IHd0RmFkZUluRnJvbU5vbmU7XFxufVxcblxcbkBrZXlmcmFtZXMgd3RGYWRlSW5Gcm9tTm9uZSB7XFxuICAwJSB7XFxuICAgIGRpc3BsYXk6IG5vbmU7XFxuICAgIG9wYWNpdHk6IDA7XFxuICB9XFxuXFxuICAxJSB7XFxuICAgIGRpc3BsYXk6IGJsb2NrO1xcbiAgICBvcGFjaXR5OiAwO1xcbiAgfVxcblxcbiAgMTAwJSB7XFxuICAgIGRpc3BsYXk6IGJsb2NrO1xcbiAgICBvcGFjaXR5OiAxO1xcbiAgfVxcbn1cXG5cXG5ALXdlYmtpdC1rZXlmcmFtZXMgd3RGYWRlSW5Gcm9tTm9uZSB7XFxuICAwJSB7XFxuICAgIGRpc3BsYXk6IG5vbmU7XFxuICAgIG9wYWNpdHk6IDA7XFxuICB9XFxuXFxuICAxJSB7XFxuICAgIGRpc3BsYXk6IGJsb2NrO1xcbiAgICBvcGFjaXR5OiAwO1xcbiAgfVxcblxcbiAgMTAwJSB7XFxuICAgIGRpc3BsYXk6IGJsb2NrO1xcbiAgICBvcGFjaXR5OiAxO1xcbiAgfVxcbn1cXG4vKlxcblxcbiBIYW5kc29udGFibGUgTW9iaWxlIFRleHQgRWRpdG9yIHN0eWxlc2hlZXRcXG5cXG4gKi9cXG5cXG4uaGFuZHNvbnRhYmxlLm1vYmlsZSxcXG4uaGFuZHNvbnRhYmxlLm1vYmlsZSAud3RIb2xkZXIge1xcbiAgLXdlYmtpdC10b3VjaC1jYWxsb3V0Om5vbmU7XFxuICAtd2Via2l0LXVzZXItc2VsZWN0Om5vbmU7XFxuICAta2h0bWwtdXNlci1zZWxlY3Q6bm9uZTtcXG4gIC1tb3otdXNlci1zZWxlY3Q6bm9uZTtcXG4gIC1tcy11c2VyLXNlbGVjdDpub25lO1xcbiAgdXNlci1zZWxlY3Q6bm9uZTtcXG4gIC13ZWJraXQtdGFwLWhpZ2hsaWdodC1jb2xvcjpyZ2JhKDAsMCwwLDApO1xcbiAgLXdlYmtpdC1vdmVyZmxvdy1zY3JvbGxpbmc6IHRvdWNoO1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIge1xcbiAgZGlzcGxheTogbm9uZTtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHRvcDogMDtcXG4gIHdpZHRoOiA3MCU7XFxuICBoZWlnaHQ6IDU0cHQ7XFxuICBiYWNrZ3JvdW5kOiAjZjhmOGY4O1xcbiAgYm9yZGVyLXJhZGl1czogMjBweDtcXG4gIGJvcmRlcjogMXB4IHNvbGlkICNlYmViZWI7XFxuICB6LWluZGV4OiA5OTk7XFxuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xcbiAgLXdlYmtpdC1ib3gtc2l6aW5nOiBib3JkZXItYm94O1xcbiAgLXdlYmtpdC10ZXh0LXNpemUtYWRqdXN0OiBub25lO1xcbn1cXG5cXG4udG9wTGVmdFNlbGVjdGlvbkhhbmRsZTpub3QoLmh0X21hc3RlciAudG9wTGVmdFNlbGVjdGlvbkhhbmRsZSksXFxuLnRvcExlZnRTZWxlY3Rpb25IYW5kbGUtSGl0QXJlYTpub3QoLmh0X21hc3RlciAudG9wTGVmdFNlbGVjdGlvbkhhbmRsZS1IaXRBcmVhKSB7XFxuICB6LWluZGV4OiA5OTk5O1xcbn1cXG5cXG4vKiBJbml0aWFsIGxlZnQvdG9wIGNvb3JkaW5hdGVzIC0gb3ZlcndyaXR0ZW4gd2hlbiBhY3R1YWwgcG9zaXRpb24gaXMgc2V0ICovXFxuLnRvcExlZnRTZWxlY3Rpb25IYW5kbGUsXFxuLnRvcExlZnRTZWxlY3Rpb25IYW5kbGUtSGl0QXJlYSxcXG4uYm90dG9tUmlnaHRTZWxlY3Rpb25IYW5kbGUsXFxuLmJvdHRvbVJpZ2h0U2VsZWN0aW9uSGFuZGxlLUhpdEFyZWEge1xcbiAgbGVmdDogLTEwMDAwcHg7XFxuICB0b3A6IC0xMDAwMHB4O1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIuYWN0aXZlIHtcXG4gIGRpc3BsYXk6IGJsb2NrO1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLmlucHV0cyB7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICByaWdodDogMjEwcHQ7XFxuICBib3R0b206IDEwcHQ7XFxuICB0b3A6IDEwcHQ7XFxuICBsZWZ0OiAxNHB4O1xcbiAgaGVpZ2h0OiAzNHB0O1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLmlucHV0cyB0ZXh0YXJlYSB7XFxuICBmb250LXNpemU6IDEzcHQ7XFxuICBib3JkZXI6IDFweCBzb2xpZCAjYTFhMWExO1xcbiAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lO1xcbiAgLXdlYmtpdC1ib3gtc2hhZG93OiBub25lO1xcbiAgLW1vei1ib3gtc2hhZG93OiBub25lO1xcbiAgYm94LXNoYWRvdzogbm9uZTtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIGxlZnQ6IDE0cHg7XFxuICByaWdodDogMTRweDtcXG4gIHRvcDogMDtcXG4gIGJvdHRvbTogMDtcXG4gIHBhZGRpbmc6IDdwdDtcXG59XFxuXFxuLmh0TW9iaWxlRWRpdG9yQ29udGFpbmVyIC5jZWxsUG9pbnRlciB7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB0b3A6IC0xM3B0O1xcbiAgaGVpZ2h0OiAwO1xcbiAgd2lkdGg6IDA7XFxuICBsZWZ0OiAzMHB4O1xcblxcbiAgYm9yZGVyLWxlZnQ6IDEzcHQgc29saWQgdHJhbnNwYXJlbnQ7XFxuICBib3JkZXItcmlnaHQ6IDEzcHQgc29saWQgdHJhbnNwYXJlbnQ7XFxuICBib3JkZXItYm90dG9tOiAxM3B0IHNvbGlkICNlYmViZWI7XFxufVxcblxcbi5odE1vYmlsZUVkaXRvckNvbnRhaW5lciAuY2VsbFBvaW50ZXIuaGlkZGVuIHtcXG4gIGRpc3BsYXk6IG5vbmU7XFxufVxcblxcbi5odE1vYmlsZUVkaXRvckNvbnRhaW5lciAuY2VsbFBvaW50ZXI6YmVmb3JlIHtcXG4gIGNvbnRlbnQ6ICcnO1xcbiAgZGlzcGxheTogYmxvY2s7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB0b3A6IDJweDtcXG4gIGhlaWdodDogMDtcXG4gIHdpZHRoOiAwO1xcbiAgbGVmdDogLTEzcHQ7XFxuXFxuICBib3JkZXItbGVmdDogMTNwdCBzb2xpZCB0cmFuc3BhcmVudDtcXG4gIGJvcmRlci1yaWdodDogMTNwdCBzb2xpZCB0cmFuc3BhcmVudDtcXG4gIGJvcmRlci1ib3R0b206IDEzcHQgc29saWQgI2Y4ZjhmODtcXG59XFxuXFxuLmh0TW9iaWxlRWRpdG9yQ29udGFpbmVyIC5tb3ZlSGFuZGxlIHtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHRvcDogMTBwdDtcXG4gIGxlZnQ6IDVweDtcXG4gIHdpZHRoOiAzMHB4O1xcbiAgYm90dG9tOiAwcHg7XFxuICBjdXJzb3I6IG1vdmU7XFxuICB6LWluZGV4OiA5OTk5O1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLm1vdmVIYW5kbGU6YWZ0ZXIge1xcbiAgY29udGVudDogXFxcIi4uXFxcXEEuLlxcXFxBLi5cXFxcQS4uXFxcIjtcXG4gIHdoaXRlLXNwYWNlOiBwcmU7XFxuICBsaW5lLWhlaWdodDogMTBweDtcXG4gIGZvbnQtc2l6ZTogMjBwdDtcXG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcXG4gIG1hcmdpbi10b3A6IC04cHg7XFxuICBjb2xvcjogI2ViZWJlYjtcXG59XFxuXFxuLmh0TW9iaWxlRWRpdG9yQ29udGFpbmVyIC5wb3NpdGlvbkNvbnRyb2xzIHtcXG4gIHdpZHRoOiAyMDVwdDtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHJpZ2h0OiA1cHQ7XFxuICB0b3A6IDA7XFxuICBib3R0b206IDA7XFxufVxcblxcbi5odE1vYmlsZUVkaXRvckNvbnRhaW5lciAucG9zaXRpb25Db250cm9scyA+IGRpdiB7XFxuICB3aWR0aDogNTBwdDtcXG4gIGhlaWdodDogMTAwJTtcXG4gIGZsb2F0OiBsZWZ0O1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLnBvc2l0aW9uQ29udHJvbHMgPiBkaXY6YWZ0ZXIge1xcbiAgY29udGVudDogXFxcIiBcXFwiO1xcbiAgZGlzcGxheTogYmxvY2s7XFxuICB3aWR0aDogMTVwdDtcXG4gIGhlaWdodDogMTVwdDtcXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcXG4gIGxpbmUtaGVpZ2h0OiA1MHB0O1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLmxlZnRCdXR0b246YWZ0ZXIsXFxuLmh0TW9iaWxlRWRpdG9yQ29udGFpbmVyIC5yaWdodEJ1dHRvbjphZnRlcixcXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLnVwQnV0dG9uOmFmdGVyLFxcbi5odE1vYmlsZUVkaXRvckNvbnRhaW5lciAuZG93bkJ1dHRvbjphZnRlciB7XFxuICB0cmFuc2Zvcm0tb3JpZ2luOiA1cHQgNXB0O1xcbiAgLXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOiA1cHQgNXB0O1xcbiAgbWFyZ2luOiAyMXB0IDAgMCAyMXB0O1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLmxlZnRCdXR0b246YWZ0ZXIge1xcbiAgYm9yZGVyLXRvcDogMnB4IHNvbGlkICMyODhmZmU7XFxuICBib3JkZXItbGVmdDogMnB4IHNvbGlkICMyODhmZmU7XFxuICAtd2Via2l0LXRyYW5zZm9ybTogcm90YXRlKC00NWRlZyk7XFxuICAvKm1hcmdpbi10b3A6IDE3cHQ7Ki9cXG4gIC8qbWFyZ2luLWxlZnQ6IDIwcHQ7Ki9cXG59XFxuLmh0TW9iaWxlRWRpdG9yQ29udGFpbmVyIC5sZWZ0QnV0dG9uOmFjdGl2ZTphZnRlciB7XFxuICBib3JkZXItY29sb3I6ICNjZmNmY2Y7XFxufVxcblxcbi5odE1vYmlsZUVkaXRvckNvbnRhaW5lciAucmlnaHRCdXR0b246YWZ0ZXIge1xcbiAgYm9yZGVyLXRvcDogMnB4IHNvbGlkICMyODhmZmU7XFxuICBib3JkZXItbGVmdDogMnB4IHNvbGlkICMyODhmZmU7XFxuICAtd2Via2l0LXRyYW5zZm9ybTogcm90YXRlKDEzNWRlZyk7XFxuICAvKm1hcmdpbi10b3A6IDE3cHQ7Ki9cXG4gIC8qbWFyZ2luLWxlZnQ6IDEwcHQ7Ki9cXG59XFxuLmh0TW9iaWxlRWRpdG9yQ29udGFpbmVyIC5yaWdodEJ1dHRvbjphY3RpdmU6YWZ0ZXIge1xcbiAgYm9yZGVyLWNvbG9yOiAjY2ZjZmNmO1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLnVwQnV0dG9uOmFmdGVyIHtcXG4gIC8qYm9yZGVyLXRvcDogMnB4IHNvbGlkICNjZmNmY2Y7Ki9cXG4gIGJvcmRlci10b3A6IDJweCBzb2xpZCAjMjg4ZmZlO1xcbiAgYm9yZGVyLWxlZnQ6IDJweCBzb2xpZCAjMjg4ZmZlO1xcbiAgLXdlYmtpdC10cmFuc2Zvcm06IHJvdGF0ZSg0NWRlZyk7XFxuICAvKm1hcmdpbi10b3A6IDIycHQ7Ki9cXG4gIC8qbWFyZ2luLWxlZnQ6IDE1cHQ7Ki9cXG59XFxuLmh0TW9iaWxlRWRpdG9yQ29udGFpbmVyIC51cEJ1dHRvbjphY3RpdmU6YWZ0ZXIge1xcbiAgYm9yZGVyLWNvbG9yOiAjY2ZjZmNmO1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLmRvd25CdXR0b246YWZ0ZXIge1xcbiAgYm9yZGVyLXRvcDogMnB4IHNvbGlkICMyODhmZmU7XFxuICBib3JkZXItbGVmdDogMnB4IHNvbGlkICMyODhmZmU7XFxuICAtd2Via2l0LXRyYW5zZm9ybTogcm90YXRlKDIyNWRlZyk7XFxuICAvKm1hcmdpbi10b3A6IDE1cHQ7Ki9cXG4gIC8qbWFyZ2luLWxlZnQ6IDE1cHQ7Ki9cXG59XFxuLmh0TW9iaWxlRWRpdG9yQ29udGFpbmVyIC5kb3duQnV0dG9uOmFjdGl2ZTphZnRlciB7XFxuICBib3JkZXItY29sb3I6ICNjZmNmY2Y7XFxufVxcblxcbi5oYW5kc29udGFibGUuaGlkZS10d2VlbiB7XFxuICAtd2Via2l0LWFuaW1hdGlvbjogb3BhY2l0eS1oaWRlIDAuM3M7XFxuICBhbmltYXRpb246IG9wYWNpdHktaGlkZSAwLjNzO1xcbiAgYW5pbWF0aW9uLWZpbGwtbW9kZTogZm9yd2FyZHM7XFxuICAtd2Via2l0LWFuaW1hdGlvbi1maWxsLW1vZGU6IGZvcndhcmRzO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlLnNob3ctdHdlZW4ge1xcbiAgLXdlYmtpdC1hbmltYXRpb246IG9wYWNpdHktc2hvdyAwLjNzO1xcbiAgYW5pbWF0aW9uOiBvcGFjaXR5LXNob3cgMC4zcztcXG4gIGFuaW1hdGlvbi1maWxsLW1vZGU6IGZvcndhcmRzO1xcbiAgLXdlYmtpdC1hbmltYXRpb24tZmlsbC1tb2RlOiBmb3J3YXJkcztcXG59XFxuLmh0Q29tbWVudENlbGwge1xcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XFxufVxcblxcbi5odENvbW1lbnRDZWxsOmFmdGVyIHtcXG4gICAgY29udGVudDogJyc7XFxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gICAgdG9wOiAwO1xcbiAgICByaWdodDogMDtcXG4gICAgYm9yZGVyLWxlZnQ6IDZweCBzb2xpZCB0cmFuc3BhcmVudDtcXG4gICAgYm9yZGVyLXRvcDogNnB4IHNvbGlkIGJsYWNrO1xcbn1cXG5cXG4uaHRDb21tZW50cyB7XFxuICAgIGRpc3BsYXk6IG5vbmU7XFxuICAgIHotaW5kZXg6IDEwNTk7XFxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG59XFxuXFxuLmh0Q29tbWVudFRleHRBcmVhIHtcXG4gICAgYm94LXNoYWRvdzogcmdiYSgwLCAwLCAwLCAwLjExNzY0NykgMCAxcHggM3B4LCByZ2JhKDAsIDAsIDAsIDAuMjM5MjE2KSAwIDFweCAycHg7XFxuICAgIC13ZWJraXQtYm94LXNpemluZzogYm9yZGVyLWJveDtcXG4gICAgLW1vei1ib3gtc2l6aW5nOiBib3JkZXItYm94O1xcbiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xcbiAgICBib3JkZXI6IG5vbmU7XFxuICAgIGJvcmRlci1sZWZ0OiAzcHggc29saWQgI2NjYztcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjtcXG4gICAgd2lkdGg6IDIxNXB4O1xcbiAgICBoZWlnaHQ6IDkwcHg7XFxuICAgIGZvbnQtc2l6ZTogMTJweDtcXG4gICAgcGFkZGluZzogNXB4O1xcbiAgICBvdXRsaW5lOiAwcHggIWltcG9ydGFudDtcXG4gICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lO1xcbn1cXG5cXG4uaHRDb21tZW50VGV4dEFyZWE6Zm9jdXMge1xcbiAgICBib3gtc2hhZG93OiByZ2JhKDAsIDAsIDAsIDAuMTE3NjQ3KSAwIDFweCAzcHgsIHJnYmEoMCwgMCwgMCwgMC4yMzkyMTYpIDAgMXB4IDJweCwgaW5zZXQgMCAwIDAgMXB4ICM1MjkyZjc7XFxuICAgIGJvcmRlci1sZWZ0OiAzcHggc29saWQgIzUyOTJmNztcXG59XFxuLyohXFxuICogSGFuZHNvbnRhYmxlIENvbnRleHRNZW51XFxuICovXFxuXFxuLmh0Q29udGV4dE1lbnUge1xcbiAgZGlzcGxheTogbm9uZTtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHotaW5kZXg6IDEwNjA7IC8qIG5lZWRzIHRvIGJlIGhpZ2hlciB0aGFuIDEwNTAgLSB6LWluZGV4IGZvciBUd2l0dGVyIEJvb3RzdHJhcCBtb2RhbCAoIzE1NjkpICovXFxufVxcblxcbi5odENvbnRleHRNZW51IC5odF9jbG9uZV90b3AsXFxuLmh0Q29udGV4dE1lbnUgLmh0X2Nsb25lX2xlZnQsXFxuLmh0Q29udGV4dE1lbnUgLmh0X2Nsb25lX2Nvcm5lcixcXG4uaHRDb250ZXh0TWVudSAuaHRfY2xvbmVfZGVidWcge1xcbiAgZGlzcGxheTogbm9uZTtcXG59XFxuXFxuLmh0Q29udGV4dE1lbnUgdGFibGUuaHRDb3JlIHtcXG4gIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7XFxuICBib3JkZXItYm90dG9tLXdpZHRoOiAycHg7XFxuICBib3JkZXItcmlnaHQtd2lkdGg6IDJweDtcXG59XFxuXFxuLmh0Q29udGV4dE1lbnUgLnd0Qm9yZGVyIHtcXG4gIHZpc2liaWxpdHk6IGhpZGRlbjtcXG59XFxuXFxuLmh0Q29udGV4dE1lbnUgdGFibGUgdGJvZHkgdHIgdGQge1xcbiAgYmFja2dyb3VuZDogd2hpdGU7XFxuICBib3JkZXItd2lkdGg6IDA7XFxuICBwYWRkaW5nOiA0cHggNnB4IDAgNnB4O1xcbiAgY3Vyc29yOiBwb2ludGVyO1xcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcXG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XFxuICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcXG59XFxuXFxuLmh0Q29udGV4dE1lbnUgdGFibGUgdGJvZHkgdHIgdGQ6Zmlyc3QtY2hpbGQge1xcbiAgYm9yZGVyOiAwO1xcbn1cXG5cXG4uaHRDb250ZXh0TWVudSB0YWJsZSB0Ym9keSB0ciB0ZC5odERpbW1lZCB7XFxuICBmb250LXN0eWxlOiBub3JtYWw7XFxuICBjb2xvcjogIzMyMzIzMjtcXG59XFxuXFxuLmh0Q29udGV4dE1lbnUgdGFibGUgdGJvZHkgdHIgdGQuY3VycmVudCxcXG4uaHRDb250ZXh0TWVudSB0YWJsZSB0Ym9keSB0ciB0ZC56ZXJvY2xpcGJvYXJkLWlzLWhvdmVyIHtcXG4gIGJhY2tncm91bmQ6ICNmM2YzZjM7XFxufVxcblxcbi5odENvbnRleHRNZW51IHRhYmxlIHRib2R5IHRyIHRkLmh0U2VwYXJhdG9yIHtcXG4gIGJvcmRlci10b3A6IDFweCBzb2xpZCAjYmJiO1xcbiAgaGVpZ2h0OiAwO1xcbiAgcGFkZGluZzogMDtcXG4gIGN1cnNvcjogZGVmYXVsdDtcXG59XFxuXFxuLmh0Q29udGV4dE1lbnUgdGFibGUgdGJvZHkgdHIgdGQuaHREaXNhYmxlZCB7XFxuICBjb2xvcjogIzk5OTtcXG4gIGN1cnNvcjogZGVmYXVsdDtcXG59XFxuXFxuLmh0Q29udGV4dE1lbnUgdGFibGUgdGJvZHkgdHIgdGQuaHREaXNhYmxlZDpob3ZlciB7XFxuICBiYWNrZ3JvdW5kOiAjZmZmO1xcbiAgY29sb3I6ICM5OTk7XFxuICBjdXJzb3I6IGRlZmF1bHQ7XFxufVxcblxcbi5odENvbnRleHRNZW51IHRhYmxlIHRib2R5IHRyLmh0SGlkZGVuIHtcXG4gIGRpc3BsYXk6IG5vbmU7XFxufVxcblxcbi5odENvbnRleHRNZW51IHRhYmxlIHRib2R5IHRyIHRkIC5odEl0ZW1XcmFwcGVyIHtcXG4gIG1hcmdpbi1sZWZ0OiAxMHB4O1xcbiAgbWFyZ2luLXJpZ2h0OiA2cHg7XFxufVxcblxcbi5odENvbnRleHRNZW51IHRhYmxlIHRib2R5IHRyIHRkIGRpdiBzcGFuLnNlbGVjdGVkIHtcXG4gIG1hcmdpbi10b3A6IC0ycHg7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICBsZWZ0OiA0cHg7XFxufVxcblxcbi5odENvbnRleHRNZW51IC5odF9tYXN0ZXIgLnd0SG9sZGVyIHtcXG4gIG92ZXJmbG93OiBoaWRkZW47XFxufVxcbi5odFJvd0hlYWRlcnMgLmh0X21hc3Rlci5pbm5lckJvcmRlckxlZnQgfiAuaHRfY2xvbmVfdG9wX2xlZnRfY29ybmVyIHRoOm50aC1jaGlsZCgyKSxcXG4uaHRSb3dIZWFkZXJzIC5odF9tYXN0ZXIuaW5uZXJCb3JkZXJMZWZ0IH4gLmh0X2Nsb25lX2xlZnQgdGQ6Zmlyc3Qtb2YtdHlwZSB7XFxuICBib3JkZXItbGVmdDogMCBub25lO1xcbn1cXG4uaGFuZHNvbnRhYmxlIC53dEhpZGVyIHtcXG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcXG59XFxuLmhhbmRzb250YWJsZS5odF9fbWFudWFsQ29sdW1uTW92ZS5hZnRlci1zZWxlY3Rpb24tLWNvbHVtbnMgdGhlYWQgdGguaHRfX2hpZ2hsaWdodCB7XFxuICBjdXJzb3I6IG1vdmU7XFxuICBjdXJzb3I6IC1tb3otZ3JhYjtcXG4gIGN1cnNvcjogLXdlYmtpdC1ncmFiO1xcbiAgY3Vyc29yOiBncmFiO1xcbn1cXG4uaGFuZHNvbnRhYmxlLmh0X19tYW51YWxDb2x1bW5Nb3ZlLm9uLW1vdmluZy0tY29sdW1ucyxcXG4uaGFuZHNvbnRhYmxlLmh0X19tYW51YWxDb2x1bW5Nb3ZlLm9uLW1vdmluZy0tY29sdW1ucyB0aGVhZCB0aC5odF9faGlnaGxpZ2h0IHtcXG4gIGN1cnNvcjogbW92ZTtcXG4gIGN1cnNvcjogLW1vei1ncmFiYmluZztcXG4gIGN1cnNvcjogLXdlYmtpdC1ncmFiYmluZztcXG4gIGN1cnNvcjogZ3JhYmJpbmc7XFxufVxcbi5oYW5kc29udGFibGUuaHRfX21hbnVhbENvbHVtbk1vdmUub24tbW92aW5nLS1jb2x1bW5zIC5tYW51YWxDb2x1bW5SZXNpemVyIHtcXG4gIGRpc3BsYXk6IG5vbmU7XFxufVxcbi5oYW5kc29udGFibGUgLmh0X19tYW51YWxDb2x1bW5Nb3ZlLS1ndWlkZWxpbmUsXFxuLmhhbmRzb250YWJsZSAuaHRfX21hbnVhbENvbHVtbk1vdmUtLWJhY2tsaWdodCB7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICBoZWlnaHQ6IDEwMCU7XFxuICBkaXNwbGF5OiBub25lO1xcbn1cXG4uaGFuZHNvbnRhYmxlIC5odF9fbWFudWFsQ29sdW1uTW92ZS0tZ3VpZGVsaW5lIHtcXG4gIGJhY2tncm91bmQ6ICM3NTc1NzU7XFxuICB3aWR0aDogMnB4O1xcbiAgdG9wOiAwO1xcbiAgbWFyZ2luLWxlZnQ6IC0xcHg7XFxuICB6LWluZGV4OiAxMDU7XFxufVxcbi5oYW5kc29udGFibGUgLmh0X19tYW51YWxDb2x1bW5Nb3ZlLS1iYWNrbGlnaHQge1xcbiAgYmFja2dyb3VuZDogIzM0MzQzNDtcXG4gIGJhY2tncm91bmQ6IHJnYmEoNTIsIDUyLCA1MiwgMC4yNSk7XFxuICBkaXNwbGF5OiBub25lO1xcbiAgei1pbmRleDogMTA1O1xcbiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XFxufVxcbi5oYW5kc29udGFibGUub24tbW92aW5nLS1jb2x1bW5zLnNob3ctdWkgLmh0X19tYW51YWxDb2x1bW5Nb3ZlLS1ndWlkZWxpbmUsXFxuLmhhbmRzb250YWJsZS5vbi1tb3ZpbmctLWNvbHVtbnMgLmh0X19tYW51YWxDb2x1bW5Nb3ZlLS1iYWNrbGlnaHQge1xcbiAgZGlzcGxheTogYmxvY2s7XFxufVxcbi5oYW5kc29udGFibGUgLnd0SGlkZXIge1xcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xcbn1cXG4uaGFuZHNvbnRhYmxlLmh0X19tYW51YWxSb3dNb3ZlLmFmdGVyLXNlbGVjdGlvbi0tcm93cyB0Ym9keSB0aC5odF9faGlnaGxpZ2h0IHtcXG4gIGN1cnNvcjogbW92ZTtcXG4gIGN1cnNvcjogLW1vei1ncmFiO1xcbiAgY3Vyc29yOiAtd2Via2l0LWdyYWI7XFxuICBjdXJzb3I6IGdyYWI7XFxufVxcbi5oYW5kc29udGFibGUuaHRfX21hbnVhbFJvd01vdmUub24tbW92aW5nLS1yb3dzLFxcbi5oYW5kc29udGFibGUuaHRfX21hbnVhbFJvd01vdmUub24tbW92aW5nLS1yb3dzIHRib2R5IHRoLmh0X19oaWdobGlnaHQge1xcbiAgY3Vyc29yOiBtb3ZlO1xcbiAgY3Vyc29yOiAtbW96LWdyYWJiaW5nO1xcbiAgY3Vyc29yOiAtd2Via2l0LWdyYWJiaW5nO1xcbiAgY3Vyc29yOiBncmFiYmluZztcXG59XFxuLmhhbmRzb250YWJsZS5odF9fbWFudWFsUm93TW92ZS5vbi1tb3ZpbmctLXJvd3MgLm1hbnVhbFJvd1Jlc2l6ZXIge1xcbiAgZGlzcGxheTogbm9uZTtcXG59XFxuLmhhbmRzb250YWJsZSAuaHRfX21hbnVhbFJvd01vdmUtLWd1aWRlbGluZSxcXG4uaGFuZHNvbnRhYmxlIC5odF9fbWFudWFsUm93TW92ZS0tYmFja2xpZ2h0IHtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHdpZHRoOiAxMDAlO1xcbiAgZGlzcGxheTogbm9uZTtcXG59XFxuLmhhbmRzb250YWJsZSAuaHRfX21hbnVhbFJvd01vdmUtLWd1aWRlbGluZSB7XFxuICBiYWNrZ3JvdW5kOiAjNzU3NTc1O1xcbiAgaGVpZ2h0OiAycHg7XFxuICBsZWZ0OiAwO1xcbiAgbWFyZ2luLXRvcDogLTFweDtcXG4gIHotaW5kZXg6IDEwNTtcXG59XFxuLmhhbmRzb250YWJsZSAuaHRfX21hbnVhbFJvd01vdmUtLWJhY2tsaWdodCB7XFxuICBiYWNrZ3JvdW5kOiAjMzQzNDM0O1xcbiAgYmFja2dyb3VuZDogcmdiYSg1MiwgNTIsIDUyLCAwLjI1KTtcXG4gIGRpc3BsYXk6IG5vbmU7XFxuICB6LWluZGV4OiAxMDU7XFxuICBwb2ludGVyLWV2ZW50czogbm9uZTtcXG59XFxuLmhhbmRzb250YWJsZS5vbi1tb3ZpbmctLXJvd3Muc2hvdy11aSAuaHRfX21hbnVhbFJvd01vdmUtLWd1aWRlbGluZSxcXG4uaGFuZHNvbnRhYmxlLm9uLW1vdmluZy0tcm93cyAuaHRfX21hbnVhbFJvd01vdmUtLWJhY2tsaWdodCB7XFxuICBkaXNwbGF5OiBibG9jaztcXG59XFxuQGNoYXJzZXQgXFxcIlVURi04XFxcIjtcXG5cXG4vKiFcXG4gKiBQaWthZGF5XFxuICogQ29weXJpZ2h0IMKpIDIwMTQgRGF2aWQgQnVzaGVsbCB8IEJTRCAmIE1JVCBsaWNlbnNlIHwgaHR0cDovL2RidXNoZWxsLmNvbS9cXG4gKi9cXG5cXG4ucGlrYS1zaW5nbGUge1xcbiAgICB6LWluZGV4OiA5OTk5O1xcbiAgICBkaXNwbGF5OiBibG9jaztcXG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xcbiAgICBjb2xvcjogIzMzMztcXG4gICAgYmFja2dyb3VuZDogI2ZmZjtcXG4gICAgYm9yZGVyOiAxcHggc29saWQgI2NjYztcXG4gICAgYm9yZGVyLWJvdHRvbS1jb2xvcjogI2JiYjtcXG4gICAgZm9udC1mYW1pbHk6IFxcXCJIZWx2ZXRpY2EgTmV1ZVxcXCIsIEhlbHZldGljYSwgQXJpYWwsIHNhbnMtc2VyaWY7XFxufVxcblxcbi8qXFxuY2xlYXIgY2hpbGQgZmxvYXQgKHBpa2EtbGVuZGFyKSwgdXNpbmcgdGhlIGZhbW91cyBtaWNybyBjbGVhcmZpeCBoYWNrXFxuaHR0cDovL25pY29sYXNnYWxsYWdoZXIuY29tL21pY3JvLWNsZWFyZml4LWhhY2svXFxuKi9cXG4ucGlrYS1zaW5nbGU6YmVmb3JlLFxcbi5waWthLXNpbmdsZTphZnRlciB7XFxuICAgIGNvbnRlbnQ6IFxcXCIgXFxcIjtcXG4gICAgZGlzcGxheTogdGFibGU7XFxufVxcbi5waWthLXNpbmdsZTphZnRlciB7IGNsZWFyOiBib3RoIH1cXG4ucGlrYS1zaW5nbGUgeyAqem9vbTogMSB9XFxuXFxuLnBpa2Etc2luZ2xlLmlzLWhpZGRlbiB7XFxuICAgIGRpc3BsYXk6IG5vbmU7XFxufVxcblxcbi5waWthLXNpbmdsZS5pcy1ib3VuZCB7XFxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gICAgYm94LXNoYWRvdzogMCA1cHggMTVweCAtNXB4IHJnYmEoMCwwLDAsLjUpO1xcbn1cXG5cXG4ucGlrYS1sZW5kYXIge1xcbiAgICBmbG9hdDogbGVmdDtcXG4gICAgd2lkdGg6IDI0MHB4O1xcbiAgICBtYXJnaW46IDhweDtcXG59XFxuXFxuLnBpa2EtdGl0bGUge1xcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XFxuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcXG59XFxuXFxuLnBpa2EtbGFiZWwge1xcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XFxuICAgICpkaXNwbGF5OiBpbmxpbmU7XFxuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcXG4gICAgei1pbmRleDogOTk5OTtcXG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcXG4gICAgbWFyZ2luOiAwO1xcbiAgICBwYWRkaW5nOiA1cHggM3B4O1xcbiAgICBmb250LXNpemU6IDE0cHg7XFxuICAgIGxpbmUtaGVpZ2h0OiAyMHB4O1xcbiAgICBmb250LXdlaWdodDogYm9sZDtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjtcXG59XFxuLnBpa2EtdGl0bGUgc2VsZWN0IHtcXG4gICAgY3Vyc29yOiBwb2ludGVyO1xcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICAgIHotaW5kZXg6IDk5OTg7XFxuICAgIG1hcmdpbjogMDtcXG4gICAgbGVmdDogMDtcXG4gICAgdG9wOiA1cHg7XFxuICAgIGZpbHRlcjogYWxwaGEob3BhY2l0eT0wKTtcXG4gICAgb3BhY2l0eTogMDtcXG59XFxuXFxuLnBpa2EtcHJldixcXG4ucGlrYS1uZXh0IHtcXG4gICAgZGlzcGxheTogYmxvY2s7XFxuICAgIGN1cnNvcjogcG9pbnRlcjtcXG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xcbiAgICBvdXRsaW5lOiBub25lO1xcbiAgICBib3JkZXI6IDA7XFxuICAgIHBhZGRpbmc6IDA7XFxuICAgIHdpZHRoOiAyMHB4O1xcbiAgICBoZWlnaHQ6IDMwcHg7XFxuICAgIC8qIGhpZGUgdGV4dCB1c2luZyB0ZXh0LWluZGVudCB0cmljaywgdXNpbmcgd2lkdGggdmFsdWUgKGl0J3MgZW5vdWdoKSAqL1xcbiAgICB0ZXh0LWluZGVudDogMjBweDtcXG4gICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcXG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XFxuICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlciBjZW50ZXI7XFxuICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7XFxuICAgIGJhY2tncm91bmQtc2l6ZTogNzUlIDc1JTtcXG4gICAgb3BhY2l0eTogLjU7XFxuICAgICpwb3NpdGlvbjogYWJzb2x1dGU7XFxuICAgICp0b3A6IDA7XFxufVxcblxcbi5waWthLXByZXY6aG92ZXIsXFxuLnBpa2EtbmV4dDpob3ZlciB7XFxuICAgIG9wYWNpdHk6IDE7XFxufVxcblxcbi5waWthLXByZXYsXFxuLmlzLXJ0bCAucGlrYS1uZXh0IHtcXG4gICAgZmxvYXQ6IGxlZnQ7XFxuICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgnZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFCUUFBQUFlQ0FZQUFBQXNFajVyQUFBQVVrbEVRVlI0MnUzVk1Rb0FJQkFEUWY4UGdqK09EOWhHMkN0T05KQjJ5bVFrS2UwSGJ3QVAweHVjRGlRV0FSSVRJREVCRW5NZ01ROFM4K0FxQklsNmtLZ0hpWHFRcUFlSmVwQm8vejM4Si9VMHVBSGxhQmtCbDlJNEd3QUFBQUJKUlU1RXJrSmdnZz09Jyk7XFxuICAgICpsZWZ0OiAwO1xcbn1cXG5cXG4ucGlrYS1uZXh0LFxcbi5pcy1ydGwgLnBpa2EtcHJldiB7XFxuICAgIGZsb2F0OiByaWdodDtcXG4gICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCdkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJRQUFBQWVDQVlBQUFBc0VqNXJBQUFBVTBsRVFWUjQydTNWT3dvQU1BZ0UwZHdmQW5OalUyNmJZa0JDRkd3ZmlMOVZWV29PK0JKNEdmM2d0c0VLS29GQk5UQ29DQVlWd2FBaUdOUUdNVUhNa2pHYmdqazJtSU9OdVhvMG5DOFhuQ2YxSlhnQXJWSVpBUWg1VEtZQUFBQUFTVVZPUks1Q1lJST0nKTtcXG4gICAgKnJpZ2h0OiAwO1xcbn1cXG5cXG4ucGlrYS1wcmV2LmlzLWRpc2FibGVkLFxcbi5waWthLW5leHQuaXMtZGlzYWJsZWQge1xcbiAgICBjdXJzb3I6IGRlZmF1bHQ7XFxuICAgIG9wYWNpdHk6IC4yO1xcbn1cXG5cXG4ucGlrYS1zZWxlY3Qge1xcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XFxuICAgICpkaXNwbGF5OiBpbmxpbmU7XFxufVxcblxcbi5waWthLXRhYmxlIHtcXG4gICAgd2lkdGg6IDEwMCU7XFxuICAgIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7XFxuICAgIGJvcmRlci1zcGFjaW5nOiAwO1xcbiAgICBib3JkZXI6IDA7XFxufVxcblxcbi5waWthLXRhYmxlIHRoLFxcbi5waWthLXRhYmxlIHRkIHtcXG4gICAgd2lkdGg6IDE0LjI4NTcxNDI4NTcxNDI4NiU7XFxuICAgIHBhZGRpbmc6IDA7XFxufVxcblxcbi5waWthLXRhYmxlIHRoIHtcXG4gICAgY29sb3I6ICM5OTk7XFxuICAgIGZvbnQtc2l6ZTogMTJweDtcXG4gICAgbGluZS1oZWlnaHQ6IDI1cHg7XFxuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxufVxcblxcbi5waWthLWJ1dHRvbiB7XFxuICAgIGN1cnNvcjogcG9pbnRlcjtcXG4gICAgZGlzcGxheTogYmxvY2s7XFxuICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XFxuICAgIC1tb3otYm94LXNpemluZzogYm9yZGVyLWJveDtcXG4gICAgb3V0bGluZTogbm9uZTtcXG4gICAgYm9yZGVyOiAwO1xcbiAgICBtYXJnaW46IDA7XFxuICAgIHdpZHRoOiAxMDAlO1xcbiAgICBwYWRkaW5nOiA1cHg7XFxuICAgIGNvbG9yOiAjNjY2O1xcbiAgICBmb250LXNpemU6IDEycHg7XFxuICAgIGxpbmUtaGVpZ2h0OiAxNXB4O1xcbiAgICB0ZXh0LWFsaWduOiByaWdodDtcXG4gICAgYmFja2dyb3VuZDogI2Y1ZjVmNTtcXG59XFxuXFxuLnBpa2Etd2VlayB7XFxuICAgIGZvbnQtc2l6ZTogMTFweDtcXG4gICAgY29sb3I6ICM5OTk7XFxufVxcblxcbi5pcy10b2RheSAucGlrYS1idXR0b24ge1xcbiAgICBjb2xvcjogIzMzYWFmZjtcXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XFxufVxcblxcbi5pcy1zZWxlY3RlZCAucGlrYS1idXR0b24ge1xcbiAgICBjb2xvcjogI2ZmZjtcXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XFxuICAgIGJhY2tncm91bmQ6ICMzM2FhZmY7XFxuICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMXB4IDNweCAjMTc4ZmU1O1xcbiAgICBib3JkZXItcmFkaXVzOiAzcHg7XFxufVxcblxcbi5pcy1pbnJhbmdlIC5waWthLWJ1dHRvbiB7XFxuICAgIGJhY2tncm91bmQ6ICNENUU5Rjc7XFxufVxcblxcbi5pcy1zdGFydHJhbmdlIC5waWthLWJ1dHRvbiB7XFxuICAgIGNvbG9yOiAjZmZmO1xcbiAgICBiYWNrZ3JvdW5kOiAjNkNCMzFEO1xcbiAgICBib3gtc2hhZG93OiBub25lO1xcbiAgICBib3JkZXItcmFkaXVzOiAzcHg7XFxufVxcblxcbi5pcy1lbmRyYW5nZSAucGlrYS1idXR0b24ge1xcbiAgICBjb2xvcjogI2ZmZjtcXG4gICAgYmFja2dyb3VuZDogIzMzYWFmZjtcXG4gICAgYm94LXNoYWRvdzogbm9uZTtcXG4gICAgYm9yZGVyLXJhZGl1czogM3B4O1xcbn1cXG5cXG4uaXMtZGlzYWJsZWQgLnBpa2EtYnV0dG9uLFxcbi5pcy1vdXRzaWRlLWN1cnJlbnQtbW9udGggLnBpa2EtYnV0dG9uIHtcXG4gICAgcG9pbnRlci1ldmVudHM6IG5vbmU7XFxuICAgIGN1cnNvcjogZGVmYXVsdDtcXG4gICAgY29sb3I6ICM5OTk7XFxuICAgIG9wYWNpdHk6IC4zO1xcbn1cXG5cXG4ucGlrYS1idXR0b246aG92ZXIge1xcbiAgICBjb2xvcjogI2ZmZjtcXG4gICAgYmFja2dyb3VuZDogI2ZmODAwMDtcXG4gICAgYm94LXNoYWRvdzogbm9uZTtcXG4gICAgYm9yZGVyLXJhZGl1czogM3B4O1xcbn1cXG5cXG4vKiBzdHlsaW5nIGZvciBhYmJyICovXFxuLnBpa2EtdGFibGUgYWJiciB7XFxuICAgIGJvcmRlci1ib3R0b206IG5vbmU7XFxuICAgIGN1cnNvcjogaGVscDtcXG59XFxuXFxuXCIsIFwiXCIsIHtcInZlcnNpb25cIjozLFwic291cmNlc1wiOltcIi9ob21lL2tpbW5oL0NvZGVzL1dlYlNob3AvYWRtaW4tdGVtcGxhdGUvbGFyYXZlbC12dWUtYWRtaW4vbm9kZV9tb2R1bGVzL2hhbmRzb250YWJsZS9kaXN0L2hhbmRzb250YWJsZS5mdWxsLmNzc1wiXSxcIm5hbWVzXCI6W10sXCJtYXBwaW5nc1wiOlwiQUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztFQXlCRTtBQUNGO0VBQ0UsbUJBQW1CO0NBQ3BCOztBQUVEO0VBQ0UsY0FBYztDQUNmO0FBQ0Q7RUFDRSxtQkFBbUI7Q0FDcEI7O0FBRUQ7RUFDRSxtQkFBbUI7RUFDbkIsZUFBZTtFQUNmLG1CQUFtQjtFQUNuQixjQUFjO0NBQ2Y7O0FBRUQ7RUFDRSxTQUFTO0NBQ1Y7O0FBRUQ7RUFDRSxtQkFBbUI7RUFDbkIsU0FBUyxDQUFDLDZGQUE2RjtFQUN2RyxhQUFhO0NBQ2Q7O0FBRUQ7Ozs7Ozs7O0VBUUUsd0JBQXdCO0VBQ3hCLGdDQUFnQztFQUNoQyw2QkFBNkI7Q0FDOUI7O0FBRUQ7O0VBRUUsb0JBQW9C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WixhQUFhO0lBQ2IsWUFBWTtJQUNaLGdCQUFnQjtJQUNoQixrQkFBa0I7SUFDbEIsa0JBQWtCO0lBQ2xCLG9CQUFvQjtDQUN2Qjs7QUFFRDtJQUNJLGdCQUFnQjtJQUNoQixZQUFZO0NBQ2Y7O0FBRUQ7SUFDSSxlQUFlO0lBQ2Ysa0JBQWtCO0NBQ3JCOztBQUVEO0lBQ0ksWUFBWTtJQUNaLGtCQUFrQjtJQUNsQixvQkFBb0I7SUFDcEIsb0NBQW9DO0lBQ3BDLG1CQUFtQjtDQUN0Qjs7QUFFRDtJQUNJLG9CQUFvQjtDQUN2Qjs7QUFFRDtJQUNJLFlBQVk7SUFDWixvQkFBb0I7SUFDcEIsaUJBQWlCO0lBQ2pCLG1CQUFtQjtDQUN0Qjs7QUFFRDtJQUNJLFlBQVk7SUFDWixvQkFBb0I7SUFDcEIsaUJBQWlCO0lBQ2pCLG1CQUFtQjtDQUN0Qjs7QUFFRDs7SUFFSSxxQkFBcUI7SUFDckIsZ0JBQWdCO0lBQ2hCLFlBQVk7SUFDWixZQUFZO0NBQ2Y7O0FBRUQ7SUFDSSxZQUFZO0lBQ1osb0JBQW9CO0lBQ3BCLGlCQUFpQjtJQUNqQixtQkFBbUI7Q0FDdEI7O0FBRUQsc0JBQXNCO0FBQ3RCO0lBQ0ksb0JBQW9CO0lBQ3BCLGFBQWE7Q0FDaEJcIixcImZpbGVcIjpcImhhbmRzb250YWJsZS5mdWxsLmNzc1wiLFwic291cmNlc0NvbnRlbnRcIjpbXCIvKiFcXG4oVGhlIE1JVCBMaWNlbnNlKVxcblxcbkNvcHlyaWdodCAoYykgMjAxMi0yMDE0IE1hcmNpbiBXYXJwZWNob3dza2lcXG5Db3B5cmlnaHQgKGMpIDIwMTUgSGFuZHNvbmNvZGUgc3AuIHogby5vLiA8aGVsbG9AaGFuZHNvbmNvZGUubmV0PlxcblxcblBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZ1xcbmEgY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZVxcbidTb2Z0d2FyZScpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmdcXG53aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsXFxuZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvXFxucGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvXFxudGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxcblxcblRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlXFxuaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXFxuXFxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICdBUyBJUycsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsXFxuRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GXFxuTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULlxcbklOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZXFxuQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCxcXG5UT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRVxcblNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxcblxcbiovXFxuLmhhbmRzb250YWJsZSB7XFxuICBwb3NpdGlvbjogcmVsYXRpdmU7XFxufVxcblxcbi5oYW5kc29udGFibGUgLmhpZGV7XFxuICBkaXNwbGF5OiBub25lO1xcbn1cXG4uaGFuZHNvbnRhYmxlIC5yZWxhdGl2ZSB7XFxuICBwb3NpdGlvbjogcmVsYXRpdmU7XFxufVxcblxcbi5oYW5kc29udGFibGUuaHRBdXRvU2l6ZSB7XFxuICB2aXNpYmlsaXR5OiBoaWRkZW47XFxuICBsZWZ0OiAtOTkwMDBweDtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHRvcDogLTk5MDAwcHg7XFxufVxcblxcbi5oYW5kc29udGFibGUgLnd0SGlkZXIge1xcbiAgd2lkdGg6IDA7XFxufVxcblxcbi5oYW5kc29udGFibGUgLnd0U3ByZWFkZXIge1xcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xcbiAgd2lkdGg6IDA7IC8qbXVzdCBiZSAwLCBvdGhlcndpc2UgYmxhbmsgc3BhY2UgYXBwZWFycyBpbiBzY3JvbGwgZGVtbyBhZnRlciBzY3JvbGxpbmcgbWF4IHRvIHRoZSByaWdodCAqL1xcbiAgaGVpZ2h0OiBhdXRvO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIHRhYmxlLFxcbi5oYW5kc29udGFibGUgdGJvZHksXFxuLmhhbmRzb250YWJsZSB0aGVhZCxcXG4uaGFuZHNvbnRhYmxlIHRkLFxcbi5oYW5kc29udGFibGUgdGgsXFxuLmhhbmRzb250YWJsZSBpbnB1dCxcXG4uaGFuZHNvbnRhYmxlIHRleHRhcmVhLFxcbi5oYW5kc29udGFibGUgZGl2IHtcXG4gIGJveC1zaXppbmc6IGNvbnRlbnQtYm94O1xcbiAgLXdlYmtpdC1ib3gtc2l6aW5nOiBjb250ZW50LWJveDtcXG4gIC1tb3otYm94LXNpemluZzogY29udGVudC1ib3g7XFxufVxcblxcbi5oYW5kc29udGFibGUgaW5wdXQsXFxuLmhhbmRzb250YWJsZSB0ZXh0YXJlYSB7XFxuICBtaW4taGVpZ2h0OiBpbml0aWFsO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIHRhYmxlLmh0Q29yZSB7XFxuICBib3JkZXItY29sbGFwc2U6IHNlcGFyYXRlO1xcbiAgLyppdCBtdXN0IGJlIHNlcGFyYXRlLCBvdGhlcndpc2UgdGhlcmUgYXJlIG9mZnNldCBtaXNjYWxjdWxhdGlvbnMgaW4gV2ViS2l0OiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzI2NTU5ODcvYm9yZGVyLWNvbGxhcHNlLWRpZmZlcmVuY2VzLWluLWZmLWFuZC13ZWJraXQqL1xcbiAgLyp0aGlzIGFjdHVhbGx5IG9ubHkgY2hhbmdlcyBhcHBlYXJhbmNlIG9mIHVzZXIgc2VsZWN0aW9uIC0gZG9lcyBub3QgbWFrZSB0ZXh0IHVuc2VsZWN0YWJsZVxcbiAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTtcXG4gIC1raHRtbC11c2VyLXNlbGVjdDogbm9uZTtcXG4gIC1tb3otdXNlci1zZWxlY3Q6IG5vbmU7XFxuICAtby11c2VyLXNlbGVjdDogbm9uZTtcXG4gIC1tcy11c2VyLXNlbGVjdDogbm9uZTtcXG4gIC8qdXNlci1zZWxlY3Q6IG5vbmU7IC8qbm8gYnJvd3NlciBzdXBwb3J0cyB1bnByZWZpeGVkIHZlcnNpb24qL1xcbiAgYm9yZGVyLXNwYWNpbmc6IDA7XFxuICBtYXJnaW46IDA7XFxuICBib3JkZXItd2lkdGg6IDA7XFxuICB0YWJsZS1sYXlvdXQ6IGZpeGVkO1xcbiAgd2lkdGg6IDA7XFxuICBvdXRsaW5lLXdpZHRoOiAwO1xcbiAgLyogcmVzZXQgYm9vdHN0cmFwIHRhYmxlIHN0eWxlLiBmb3IgbW9yZSBpbmZvIHNlZTogaHR0cHM6Ly9naXRodWIuY29tL2hhbmRzb250YWJsZS9oYW5kc29udGFibGUvaXNzdWVzLzIyNCAqL1xcbiAgbWF4LXdpZHRoOiBub25lO1xcbiAgbWF4LWhlaWdodDogbm9uZTtcXG59XFxuXFxuLmhhbmRzb250YWJsZSBjb2wge1xcbiAgd2lkdGg6IDUwcHg7XFxufVxcblxcbi5oYW5kc29udGFibGUgY29sLnJvd0hlYWRlciB7XFxuICB3aWR0aDogNTBweDtcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0aCxcXG4uaGFuZHNvbnRhYmxlIHRkIHtcXG4gIGJvcmRlci10b3Atd2lkdGg6IDA7XFxuICBib3JkZXItbGVmdC13aWR0aDogMDtcXG4gIGJvcmRlci1yaWdodDogMXB4IHNvbGlkICNDQ0M7XFxuICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI0NDQztcXG4gIGhlaWdodDogMjJweDtcXG4gIGVtcHR5LWNlbGxzOiBzaG93O1xcbiAgbGluZS1oZWlnaHQ6IDIxcHg7XFxuICBwYWRkaW5nOiAwIDRweCAwIDRweDtcXG4gIC8qIHRvcCwgYm90dG9tIHBhZGRpbmcgZGlmZmVyZW50IHRoYW4gMCBpcyBoYW5kbGVkIHBvb3JseSBieSBGRiB3aXRoIEhUTUw1IGRvY3R5cGUgKi9cXG4gIGJhY2tncm91bmQtY29sb3I6ICNGRkY7XFxuICB2ZXJ0aWNhbC1hbGlnbjogdG9wO1xcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcXG4gIG91dGxpbmUtd2lkdGg6IDA7XFxuICB3aGl0ZS1zcGFjZTogcHJlLWxpbmU7XFxuICAvKiBwcmVzZXJ2ZSBuZXcgbGluZSBjaGFyYWN0ZXIgaW4gY2VsbCAqL1xcbiAgYmFja2dyb3VuZC1jbGlwOiBwYWRkaW5nLWJveDtcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0ZC5odEludmFsaWQge1xcbiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmNGM0MiAhaW1wb3J0YW50OyAvKmdpdmVzIHByaW9yaXR5IG92ZXIgdGQuYXJlYSBzZWxlY3Rpb24gYmFja2dyb3VuZCovXFxufVxcblxcbi5oYW5kc29udGFibGUgdGQuaHROb1dyYXAge1xcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0aDpsYXN0LWNoaWxkIHtcXG4gIC8qRm91bmRhdGlvbiBmcmFtZXdvcmsgZml4Ki9cXG4gIGJvcmRlci1yaWdodDogMXB4IHNvbGlkICNDQ0M7XFxuICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI0NDQztcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0cjpmaXJzdC1jaGlsZCB0aC5odE5vRnJhbWUsXFxuLmhhbmRzb250YWJsZSB0aDpmaXJzdC1jaGlsZC5odE5vRnJhbWUsXFxuLmhhbmRzb250YWJsZSB0aC5odE5vRnJhbWUge1xcbiAgYm9yZGVyLWxlZnQtd2lkdGg6IDA7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcXG4gIGJvcmRlci1jb2xvcjogI0ZGRjtcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0aDpmaXJzdC1jaGlsZCxcXG4uaGFuZHNvbnRhYmxlIHRoOm50aC1jaGlsZCgyKSxcXG4uaGFuZHNvbnRhYmxlIHRkOmZpcnN0LW9mLXR5cGUsXFxuLmhhbmRzb250YWJsZSAuaHROb0ZyYW1lICsgdGgsXFxuLmhhbmRzb250YWJsZSAuaHROb0ZyYW1lICsgdGQge1xcbiAgYm9yZGVyLWxlZnQ6IDFweCBzb2xpZCAjQ0NDO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlLmh0Um93SGVhZGVycyB0aGVhZCB0ciB0aDpudGgtY2hpbGQoMikge1xcbiAgYm9yZGVyLWxlZnQ6IDFweCBzb2xpZCAjQ0NDO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIHRyOmZpcnN0LWNoaWxkIHRoLFxcbi5oYW5kc29udGFibGUgdHI6Zmlyc3QtY2hpbGQgdGQge1xcbiAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNDQ0M7XFxufVxcblxcbi5odF9tYXN0ZXI6bm90KC5pbm5lckJvcmRlckxlZnQpOm5vdCguZW1wdHlDb2x1bW5zKSB+IC5oYW5kc29udGFibGUgdGJvZHkgdHIgdGgsXFxuLmh0X21hc3Rlcjpub3QoLmlubmVyQm9yZGVyTGVmdCk6bm90KC5lbXB0eUNvbHVtbnMpIH4gLmhhbmRzb250YWJsZTpub3QoLmh0X2Nsb25lX3RvcCkgdGhlYWQgdHIgdGg6Zmlyc3QtY2hpbGQge1xcbiAgYm9yZGVyLXJpZ2h0LXdpZHRoOiAwO1xcbn1cXG5cXG4uaHRfbWFzdGVyOm5vdCguaW5uZXJCb3JkZXJUb3ApIHRoZWFkIHRyOmxhc3QtY2hpbGQgdGgsXFxuLmh0X21hc3Rlcjpub3QoLmlubmVyQm9yZGVyVG9wKSB+IC5oYW5kc29udGFibGUgdGhlYWQgdHI6bGFzdC1jaGlsZCB0aCxcXG4uaHRfbWFzdGVyOm5vdCguaW5uZXJCb3JkZXJUb3ApIHRoZWFkIHRyLmxhc3RDaGlsZCB0aCxcXG4uaHRfbWFzdGVyOm5vdCguaW5uZXJCb3JkZXJUb3ApIH4gLmhhbmRzb250YWJsZSB0aGVhZCB0ci5sYXN0Q2hpbGQgdGgge1xcbiAgYm9yZGVyLWJvdHRvbS13aWR0aDogMDtcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0aCB7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjNmM2YzO1xcbiAgY29sb3I6ICMyMjI7XFxuICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxuICBmb250LXdlaWdodDogbm9ybWFsO1xcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0aGVhZCB0aCB7XFxuICBwYWRkaW5nOiAwO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIHRoLmFjdGl2ZSB7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjQ0NDO1xcbn1cXG4uaGFuZHNvbnRhYmxlIHRoZWFkIHRoIC5yZWxhdGl2ZSB7XFxuICBwYWRkaW5nOiAycHggNHB4O1xcbn1cXG5cXG4vKiBzZWxlY3Rpb24gKi9cXG4uaGFuZHNvbnRhYmxlIHRib2R5IHRoLmh0X19oaWdobGlnaHQsXFxuLmhhbmRzb250YWJsZSB0aGVhZCB0aC5odF9faGlnaGxpZ2h0IHtcXG4gIGJhY2tncm91bmQtY29sb3I6ICNkY2RjZGM7XFxufVxcbi5oYW5kc29udGFibGUuaHRfX3NlbGVjdGlvbi0tY29sdW1ucyB0aGVhZCB0aC5odF9faGlnaGxpZ2h0LFxcbi5oYW5kc29udGFibGUuaHRfX3NlbGVjdGlvbi0tcm93cyB0Ym9keSB0aC5odF9faGlnaGxpZ2h0IHtcXG4gIGJhY2tncm91bmQtY29sb3I6ICM4ZWIwZTc7XFxuICBjb2xvcjogIzAwMDtcXG59XFxuXFxuLyogcGx1Z2lucyAqL1xcblxcbi8qIHJvdyArIGNvbHVtbiByZXNpemVyKi9cXG4uaGFuZHNvbnRhYmxlIC5tYW51YWxDb2x1bW5SZXNpemVyIHtcXG4gIHBvc2l0aW9uOiBmaXhlZDtcXG4gIHRvcDogMDtcXG4gIGN1cnNvcjogY29sLXJlc2l6ZTtcXG4gIHotaW5kZXg6IDExMDtcXG4gIHdpZHRoOiA1cHg7XFxuICBoZWlnaHQ6IDI1cHg7XFxufVxcblxcbi5oYW5kc29udGFibGUgLm1hbnVhbFJvd1Jlc2l6ZXIge1xcbiAgcG9zaXRpb246IGZpeGVkO1xcbiAgbGVmdDogMDtcXG4gIGN1cnNvcjogcm93LXJlc2l6ZTtcXG4gIHotaW5kZXg6IDExMDtcXG4gIGhlaWdodDogNXB4O1xcbiAgd2lkdGg6IDUwcHg7XFxufVxcblxcbi5oYW5kc29udGFibGUgLm1hbnVhbENvbHVtblJlc2l6ZXI6aG92ZXIsXFxuLmhhbmRzb250YWJsZSAubWFudWFsQ29sdW1uUmVzaXplci5hY3RpdmUsXFxuLmhhbmRzb250YWJsZSAubWFudWFsUm93UmVzaXplcjpob3ZlcixcXG4uaGFuZHNvbnRhYmxlIC5tYW51YWxSb3dSZXNpemVyLmFjdGl2ZSB7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjQUFCO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIC5tYW51YWxDb2x1bW5SZXNpemVyR3VpZGUge1xcbiAgcG9zaXRpb246IGZpeGVkO1xcbiAgcmlnaHQ6IDA7XFxuICB0b3A6IDA7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjQUFCO1xcbiAgZGlzcGxheTogbm9uZTtcXG4gIHdpZHRoOiAwO1xcbiAgYm9yZGVyLXJpZ2h0OiAxcHggZGFzaGVkICM3Nzc7XFxuICBtYXJnaW4tbGVmdDogNXB4O1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIC5tYW51YWxSb3dSZXNpemVyR3VpZGUge1xcbiAgcG9zaXRpb246IGZpeGVkO1xcbiAgbGVmdDogMDtcXG4gIGJvdHRvbTogMDtcXG4gIGJhY2tncm91bmQtY29sb3I6ICNBQUI7XFxuICBkaXNwbGF5OiBub25lO1xcbiAgaGVpZ2h0OiAwO1xcbiAgYm9yZGVyLWJvdHRvbTogMXB4IGRhc2hlZCAjNzc3O1xcbiAgbWFyZ2luLXRvcDogNXB4O1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIC5tYW51YWxDb2x1bW5SZXNpemVyR3VpZGUuYWN0aXZlLFxcbi5oYW5kc29udGFibGUgLm1hbnVhbFJvd1Jlc2l6ZXJHdWlkZS5hY3RpdmUge1xcbiAgZGlzcGxheTogYmxvY2s7XFxuICB6LWluZGV4OiAxOTk7XFxufVxcblxcbi5oYW5kc29udGFibGUgLmNvbHVtblNvcnRpbmcge1xcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIC5jb2x1bW5Tb3J0aW5nOmhvdmVyIHtcXG4gIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lO1xcbiAgY3Vyc29yOiBwb2ludGVyO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIC5jb2x1bW5Tb3J0aW5nLmFzY2VuZGluZzo6YWZ0ZXIge1xcbiAgY29udGVudDogJ1xcXFwyNUIyJztcXG4gIGNvbG9yOiAjNWY1ZjVmO1xcbiAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgcmlnaHQ6IC0xNXB4O1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIC5jb2x1bW5Tb3J0aW5nLmRlc2NlbmRpbmc6OmFmdGVyIHtcXG4gIGNvbnRlbnQ6ICdcXFxcMjVCQyc7XFxuICBjb2xvcjogIzVmNWY1ZjtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHJpZ2h0OiAtMTVweDtcXG59XFxuXFxuLyogYm9yZGVyIGxpbmUgKi9cXG5cXG4uaGFuZHNvbnRhYmxlIC53dEJvcmRlciB7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICBmb250LXNpemU6IDA7XFxufVxcbi5oYW5kc29udGFibGUgLnd0Qm9yZGVyLmhpZGRlbntcXG4gIGRpc3BsYXk6bm9uZSAhaW1wb3J0YW50O1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIHRkLmFyZWEge1xcbiAgYmFja2dyb3VuZDogLW1vei1saW5lYXItZ3JhZGllbnQodG9wLCAgcmdiYSgxODEsMjA5LDI1NSwwLjM0KSAwJSwgcmdiYSgxODEsMjA5LDI1NSwwLjM0KSAxMDAlKTsgLyogRkYzLjYrICovXFxuICBiYWNrZ3JvdW5kOiAtd2Via2l0LWdyYWRpZW50KGxpbmVhciwgbGVmdCB0b3AsIGxlZnQgYm90dG9tLCBjb2xvci1zdG9wKDAlLHJnYmEoMTgxLDIwOSwyNTUsMC4zNCkpLCBjb2xvci1zdG9wKDEwMCUscmdiYSgxODEsMjA5LDI1NSwwLjM0KSkpOyAvKiBDaHJvbWUsU2FmYXJpNCsgKi9cXG4gIGJhY2tncm91bmQ6IC13ZWJraXQtbGluZWFyLWdyYWRpZW50KHRvcCwgIHJnYmEoMTgxLDIwOSwyNTUsMC4zNCkgMCUscmdiYSgxODEsMjA5LDI1NSwwLjM0KSAxMDAlKTsgLyogQ2hyb21lMTArLFNhZmFyaTUuMSsgKi9cXG4gIGJhY2tncm91bmQ6IC1vLWxpbmVhci1ncmFkaWVudCh0b3AsICByZ2JhKDE4MSwyMDksMjU1LDAuMzQpIDAlLHJnYmEoMTgxLDIwOSwyNTUsMC4zNCkgMTAwJSk7IC8qIE9wZXJhIDExLjEwKyAqL1xcbiAgYmFja2dyb3VuZDogLW1zLWxpbmVhci1ncmFkaWVudCh0b3AsICByZ2JhKDE4MSwyMDksMjU1LDAuMzQpIDAlLHJnYmEoMTgxLDIwOSwyNTUsMC4zNCkgMTAwJSk7IC8qIElFMTArICovXFxuICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQodG8gYm90dG9tLCAgcmdiYSgxODEsMjA5LDI1NSwwLjM0KSAwJSxyZ2JhKDE4MSwyMDksMjU1LDAuMzQpIDEwMCUpOyAvKiBXM0MgKi9cXG4gIGZpbHRlcjogcHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0LmdyYWRpZW50KCBzdGFydENvbG9yc3RyPScjNTdiNWQxZmYnLCBlbmRDb2xvcnN0cj0nIzU3YjVkMWZmJyxHcmFkaWVudFR5cGU9MCApOyAvKiBJRTYtOSAqL1xcbiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjtcXG59XFxuXFxuLyogZmlsbCBoYW5kbGUgKi9cXG5cXG4uaGFuZHNvbnRhYmxlIC53dEJvcmRlci5jb3JuZXIge1xcbiAgZm9udC1zaXplOiAwO1xcbiAgY3Vyc29yOiBjcm9zc2hhaXI7XFxufVxcblxcbi5oYW5kc29udGFibGUgLmh0Qm9yZGVyLmh0RmlsbEJvcmRlciB7XFxuICBiYWNrZ3JvdW5kOiByZWQ7XFxuICB3aWR0aDogMXB4O1xcbiAgaGVpZ2h0OiAxcHg7XFxufVxcblxcbi5oYW5kc29udGFibGVJbnB1dCB7XFxuICBib3JkZXI6bm9uZTtcXG4gIG91dGxpbmUtd2lkdGg6IDA7XFxuICBtYXJnaW46IDAgO1xcbiAgcGFkZGluZzogMXB4IDVweCAwIDVweDtcXG4gIGZvbnQtZmFtaWx5OiBpbmhlcml0O1xcbiAgbGluZS1oZWlnaHQ6IDIxcHg7XFxuICBmb250LXNpemU6IGluaGVyaXQ7XFxuICBib3gtc2hhZG93OiAwIDAgMCAycHggIzUyOTJGNyBpbnNldDtcXG4gIHJlc2l6ZTogbm9uZTtcXG4gIC8qYmVsb3cgYXJlIG5lZWRlZCB0byBvdmVyd3JpdGUgc3R1ZmYgYWRkZWQgYnkgalF1ZXJ5IFVJIEJvb3RzdHJhcCB0aGVtZSovXFxuICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XFxuICBjb2xvcjogIzAwMDtcXG4gIGJvcmRlci1yYWRpdXM6IDA7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjRkZGO1xcbiAgLypvdmVyd3JpdGUgc3R5bGVzIHBvdGVudGlvbmFsbHkgbWFkZSBieSBhIGZyYW1ld29yayovXFxufVxcblxcbi5oYW5kc29udGFibGVJbnB1dEhvbGRlciB7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB0b3A6IDA7XFxuICBsZWZ0OiAwO1xcbiAgei1pbmRleDogMTAwO1xcbn1cXG5cXG4uaHRTZWxlY3RFZGl0b3Ige1xcbiAgLXdlYmtpdC1hcHBlYXJhbmNlOiBtZW51bGlzdC1idXR0b24gIWltcG9ydGFudDtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHdpZHRoOiBhdXRvO1xcbn1cXG5cXG4vKlxcblRleHRSZW5kZXJlciByZWFkT25seSBjZWxsXFxuKi9cXG5cXG4uaGFuZHNvbnRhYmxlIC5odERpbW1lZCB7XFxuICBjb2xvcjogIzc3NztcXG59XFxuXFxuLmhhbmRzb250YWJsZSAuaHRTdWJtZW51IHtcXG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcXG59XFxuXFxuLmhhbmRzb250YWJsZSAuaHRTdWJtZW51IDphZnRlcntcXG4gIGNvbnRlbnQ6ICfilrYnO1xcbiAgY29sb3I6ICM3Nzc7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICByaWdodDogNXB4O1xcbn1cXG5cXG5cXG4vKlxcblRleHRSZW5kZXJlciBob3Jpem9udGFsIGFsaWdubWVudFxcbiovXFxuLmhhbmRzb250YWJsZSAuaHRMZWZ0e1xcbiAgdGV4dC1hbGlnbjogbGVmdDtcXG59XFxuLmhhbmRzb250YWJsZSAuaHRDZW50ZXJ7XFxuICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxufVxcbi5oYW5kc29udGFibGUgLmh0UmlnaHR7XFxuICB0ZXh0LWFsaWduOiByaWdodDtcXG59XFxuLmhhbmRzb250YWJsZSAuaHRKdXN0aWZ5e1xcbiAgdGV4dC1hbGlnbjoganVzdGlmeTtcXG59XFxuLypcXG5UZXh0UmVuZGVyZXIgdmVydGljYWwgYWxpZ25tZW50XFxuKi9cXG4uaGFuZHNvbnRhYmxlIC5odFRvcHtcXG4gIHZlcnRpY2FsLWFsaWduOiB0b3A7XFxufVxcbi5oYW5kc29udGFibGUgLmh0TWlkZGxle1xcbiAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcXG59XFxuLmhhbmRzb250YWJsZSAuaHRCb3R0b217XFxuICB2ZXJ0aWNhbC1hbGlnbjogYm90dG9tO1xcbn1cXG5cXG4vKlxcblRleHRSZW5kZXJlciBwbGFjZWhvbGRlciB2YWx1ZVxcbiovXFxuXFxuLmhhbmRzb250YWJsZSAuaHRQbGFjZWhvbGRlciB7XFxuICBjb2xvcjogIzk5OTtcXG59XFxuXFxuLypcXG5BdXRvY29tcGxldGVSZW5kZXJlciBkb3duIGFycm93XFxuKi9cXG5cXG4uaGFuZHNvbnRhYmxlIC5odEF1dG9jb21wbGV0ZUFycm93IHtcXG4gIGZsb2F0OiByaWdodDtcXG4gIGZvbnQtc2l6ZTogMTBweDtcXG4gIGNvbG9yOiAjRUVFO1xcbiAgY3Vyc29yOiBkZWZhdWx0O1xcbiAgd2lkdGg6IDE2cHg7XFxuICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxufVxcblxcbi5oYW5kc29udGFibGUgdGQgLmh0QXV0b2NvbXBsZXRlQXJyb3c6aG92ZXIge1xcbiAgY29sb3I6ICM3Nzc7XFxufVxcblxcbi5oYW5kc29udGFibGUgdGQuYXJlYSAuaHRBdXRvY29tcGxldGVBcnJvdyB7XFxuICBjb2xvcjogI2QzZDNkMztcXG59XFxuXFxuLypcXG5DaGVja2JveFJlbmRlcmVyXFxuKi9cXG4uaGFuZHNvbnRhYmxlIC5odENoZWNrYm94UmVuZGVyZXJJbnB1dCB7XFxuICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XFxuICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xcbn1cXG4uaGFuZHNvbnRhYmxlIC5odENoZWNrYm94UmVuZGVyZXJJbnB1dC5ub1ZhbHVlIHtcXG4gIG9wYWNpdHk6IDAuNTtcXG59XFxuLmhhbmRzb250YWJsZSAuaHRDaGVja2JveFJlbmRlcmVyTGFiZWwge1xcbiAgY3Vyc29yOiBwb2ludGVyO1xcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xcbiAgd2lkdGg6IDEwMCU7XFxufVxcblxcbkAtd2Via2l0LWtleWZyYW1lcyBvcGFjaXR5LWhpZGUge1xcbiAgZnJvbSB7XFxuICAgIG9wYWNpdHk6IDE7XFxuICB9XFxuICB0byB7XFxuICAgIG9wYWNpdHk6IDA7XFxuICAgIC8qZGlzcGxheTogbm9uZTsqL1xcbiAgfVxcbn1cXG5Aa2V5ZnJhbWVzIG9wYWNpdHktaGlkZSB7XFxuICBmcm9tIHtcXG4gICAgLypkaXNwbGF5OiBibG9jazsqL1xcbiAgICBvcGFjaXR5OiAxO1xcbiAgfVxcbiAgdG8ge1xcbiAgICBvcGFjaXR5OiAwO1xcbiAgICAvKmRpc3BsYXk6IG5vbmU7Ki9cXG4gIH1cXG59XFxuXFxuQC13ZWJraXQta2V5ZnJhbWVzIG9wYWNpdHktc2hvdyB7XFxuICBmcm9tIHtcXG4gICAgb3BhY2l0eTogMDtcXG4gICAgLypkaXNwbGF5OiBub25lOyovXFxuICB9XFxuICB0byB7XFxuICAgIG9wYWNpdHk6IDE7XFxuICAgIC8qZGlzcGxheTogYmxvY2s7Ki9cXG4gIH1cXG59XFxuQGtleWZyYW1lcyBvcGFjaXR5LXNob3cge1xcbiAgZnJvbSB7XFxuICAgIG9wYWNpdHk6IDA7XFxuICAgIC8qZGlzcGxheTogbm9uZTsqL1xcbiAgfVxcbiAgdG8ge1xcbiAgICBvcGFjaXR5OiAxO1xcbiAgICAvKmRpc3BsYXk6IGJsb2NrOyovXFxuICB9XFxufVxcblxcbi8qKlxcbiAqIEhhbmRzb250YWJsZSBpbiBIYW5kc29udGFibGVcXG4gKi9cXG5cXG4uaGFuZHNvbnRhYmxlIC5oYW5kc29udGFibGUuaHRfY2xvbmVfdG9wIC53dEhpZGVyIHtcXG4gIHBhZGRpbmc6IDAgMCA1cHggMDtcXG59XFxuXFxuLyoqXFxuKiBBdXRvY29tcGxldGUgRWRpdG9yXFxuKi9cXG4uaGFuZHNvbnRhYmxlIC5hdXRvY29tcGxldGVFZGl0b3IuaGFuZHNvbnRhYmxlIHtcXG4gIHBhZGRpbmctcmlnaHQ6IDE3cHg7XFxufVxcbi5oYW5kc29udGFibGUgLmF1dG9jb21wbGV0ZUVkaXRvci5oYW5kc29udGFibGUuaHRNYWNTY3JvbGwge1xcbiAgcGFkZGluZy1yaWdodDogMTVweDtcXG59XFxuXFxuXFxuLyoqXFxuICogSGFuZHNvbnRhYmxlIGxpc3Rib3ggdGhlbWVcXG4gKi9cXG5cXG4uaGFuZHNvbnRhYmxlLmxpc3Rib3gge1xcbiAgbWFyZ2luOiAwO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlLmxpc3Rib3ggLmh0X21hc3RlciB0YWJsZSB7XFxuICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xcbiAgYm9yZGVyLWNvbGxhcHNlOiBzZXBhcmF0ZTtcXG4gIGJhY2tncm91bmQ6IHdoaXRlO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlLmxpc3Rib3ggdGgsXFxuLmhhbmRzb250YWJsZS5saXN0Ym94IHRyOmZpcnN0LWNoaWxkIHRoLFxcbi5oYW5kc29udGFibGUubGlzdGJveCB0cjpsYXN0LWNoaWxkIHRoLFxcbi5oYW5kc29udGFibGUubGlzdGJveCB0cjpmaXJzdC1jaGlsZCB0ZCxcXG4uaGFuZHNvbnRhYmxlLmxpc3Rib3ggdGQge1xcbiAgYm9yZGVyLWNvbG9yOiB0cmFuc3BhcmVudDtcXG59XFxuXFxuLmhhbmRzb250YWJsZS5saXN0Ym94IHRoLFxcbi5oYW5kc29udGFibGUubGlzdGJveCB0ZCB7XFxuICB3aGl0ZS1zcGFjZTogbm93cmFwO1xcbiAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XFxufVxcblxcbi5oYW5kc29udGFibGUubGlzdGJveCB0ZC5odERpbW1lZCB7XFxuICBjdXJzb3I6IGRlZmF1bHQ7XFxuICBjb2xvcjogaW5oZXJpdDtcXG4gIGZvbnQtc3R5bGU6IGluaGVyaXQ7XFxufVxcblxcbi5oYW5kc29udGFibGUubGlzdGJveCAud3RCb3JkZXIge1xcbiAgdmlzaWJpbGl0eTogaGlkZGVuO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlLmxpc3Rib3ggdHIgdGQuY3VycmVudCxcXG4uaGFuZHNvbnRhYmxlLmxpc3Rib3ggdHI6aG92ZXIgdGQge1xcbiAgYmFja2dyb3VuZDogI2VlZTtcXG59XFxuXFxuLmh0X2Nsb25lX3RvcCB7XFxuICB6LWluZGV4OiAxMDE7XFxufVxcblxcbi5odF9jbG9uZV9sZWZ0IHtcXG4gIHotaW5kZXg6IDEwMjtcXG59XFxuXFxuLmh0X2Nsb25lX3RvcF9sZWZ0X2Nvcm5lcixcXG4uaHRfY2xvbmVfYm90dG9tX2xlZnRfY29ybmVyIHtcXG4gIHotaW5kZXg6IDEwMztcXG59XFxuXFxuLmh0X2Nsb25lX2RlYnVnIHtcXG4gIHotaW5kZXg6IDEwMztcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0ZC5odFNlYXJjaFJlc3VsdCB7XFxuICBiYWNrZ3JvdW5kOiAjZmNlZGQ5O1xcbiAgY29sb3I6ICM1ODM3MDc7XFxufVxcblxcbi8qXFxuQ2VsbCBib3JkZXJzXFxuKi9cXG4uaHRCb3JkZXJlZHtcXG4gIC8qYm94LXNpemluZzogYm9yZGVyLWJveCAhaW1wb3J0YW50OyovXFxuICBib3JkZXItd2lkdGg6IDFweDtcXG59XFxuLmh0Qm9yZGVyZWQuaHRUb3BCb3JkZXJTb2xpZCB7XFxuICBib3JkZXItdG9wLXN0eWxlOiBzb2xpZDtcXG4gIGJvcmRlci10b3AtY29sb3I6ICMwMDA7XFxufVxcbi5odEJvcmRlcmVkLmh0UmlnaHRCb3JkZXJTb2xpZCB7XFxuICBib3JkZXItcmlnaHQtc3R5bGU6IHNvbGlkO1xcbiAgYm9yZGVyLXJpZ2h0LWNvbG9yOiAjMDAwO1xcbn1cXG4uaHRCb3JkZXJlZC5odEJvdHRvbUJvcmRlclNvbGlkIHtcXG4gIGJvcmRlci1ib3R0b20tc3R5bGU6IHNvbGlkO1xcbiAgYm9yZGVyLWJvdHRvbS1jb2xvcjogIzAwMDtcXG59XFxuLmh0Qm9yZGVyZWQuaHRMZWZ0Qm9yZGVyU29saWQge1xcbiAgYm9yZGVyLWxlZnQtc3R5bGU6IHNvbGlkO1xcbiAgYm9yZGVyLWxlZnQtY29sb3I6ICMwMDA7XFxufVxcblxcbi5oYW5kc29udGFibGUgdGJvZHkgdHIgdGg6bnRoLWxhc3QtY2hpbGQoMikge1xcbiAgYm9yZGVyLXJpZ2h0OiAxcHggc29saWQgI0NDQztcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0aGVhZCB0cjpudGgtbGFzdC1jaGlsZCgyKSB0aC5odEdyb3VwSW5kaWNhdG9yQ29udGFpbmVyIHtcXG4gIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjQ0NDO1xcbiAgcGFkZGluZy1ib3R0b206IDVweDtcXG59XFxuXFxuXFxuLmh0X2Nsb25lX3RvcF9sZWZ0X2Nvcm5lciB0aGVhZCB0ciB0aDpudGgtbGFzdC1jaGlsZCgyKSB7XFxuICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCAjQ0NDO1xcbn1cXG5cXG4uaHRDb2xsYXBzZUJ1dHRvbiB7XFxuICB3aWR0aDogMTBweDtcXG4gIGhlaWdodDogMTBweDtcXG4gIGxpbmUtaGVpZ2h0OiAxMHB4O1xcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xcbiAgYm9yZGVyLXJhZGl1czogNXB4O1xcbiAgYm9yZGVyOiAxcHggc29saWQgI2YzZjNmMztcXG4gIC13ZWJraXQtYm94LXNoYWRvdzogMXB4IDFweCAzcHggcmdiYSgwLCAwLCAwLCAwLjQpO1xcbiAgYm94LXNoYWRvdzogMXB4IDFweCAzcHggcmdiYSgwLCAwLCAwLCAwLjQpO1xcbiAgY3Vyc29yOiBwb2ludGVyO1xcbiAgbWFyZ2luLWJvdHRvbTogM3B4O1xcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xcbn1cXG5cXG4uaHRDb2xsYXBzZUJ1dHRvbjphZnRlciB7XFxuICBjb250ZW50OiBcXFwiXFxcIjtcXG4gIGhlaWdodDogMzAwJTtcXG4gIHdpZHRoOiAxcHg7XFxuICBkaXNwbGF5OiBibG9jaztcXG4gIGJhY2tncm91bmQ6ICNjY2M7XFxuICBtYXJnaW4tbGVmdDogNHB4O1xcbiAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgLyp0b3A6IC0zMDAlOyovXFxuICBib3R0b206IDEwcHg7XFxufVxcblxcblxcbnRoZWFkIC5odENvbGxhcHNlQnV0dG9uIHtcXG4gIHJpZ2h0OiA1cHg7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB0b3A6IDVweDtcXG4gIGJhY2tncm91bmQ6ICNmZmY7XFxufVxcblxcbnRoZWFkIC5odENvbGxhcHNlQnV0dG9uOmFmdGVyIHtcXG4gIGhlaWdodDogMXB4O1xcbiAgd2lkdGg6IDcwMCU7XFxuICByaWdodDogMTBweDtcXG4gIHRvcDogNHB4O1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIHRyIHRoIC5odEV4cGFuZEJ1dHRvbiB7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB3aWR0aDogMTBweDtcXG4gIGhlaWdodDogMTBweDtcXG4gIGxpbmUtaGVpZ2h0OiAxMHB4O1xcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xcbiAgYm9yZGVyLXJhZGl1czogNXB4O1xcbiAgYm9yZGVyOiAxcHggc29saWQgI2YzZjNmMztcXG4gIC13ZWJraXQtYm94LXNoYWRvdzogMXB4IDFweCAzcHggcmdiYSgwLCAwLCAwLCAwLjQpO1xcbiAgYm94LXNoYWRvdzogMXB4IDFweCAzcHggcmdiYSgwLCAwLCAwLCAwLjQpO1xcbiAgY3Vyc29yOiBwb2ludGVyO1xcbiAgdG9wOiAwO1xcbiAgZGlzcGxheTogbm9uZTtcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0aGVhZCB0ciB0aCAuaHRFeHBhbmRCdXR0b24ge1xcbiAgLypsZWZ0OiA1cHg7Ki9cXG4gIHRvcDogNXB4O1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIHRyIHRoIC5odEV4cGFuZEJ1dHRvbi5jbGlja2FibGUge1xcbiAgZGlzcGxheTogYmxvY2s7XFxufVxcblxcbi5jb2xsYXBzaWJsZUluZGljYXRvciB7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB0b3A6IDUwJTtcXG4gIHRyYW5zZm9ybTogdHJhbnNsYXRlKDAlICwtNTAlKTtcXG4gIHJpZ2h0OiA1cHg7XFxuICBib3JkZXI6IDFweCBzb2xpZCAjQTZBNkE2O1xcbiAgbGluZS1oZWlnaHQ6IDEwcHg7XFxuICBjb2xvcjogIzIyMjtcXG4gIGJvcmRlci1yYWRpdXM6IDEwcHg7XFxuICBmb250LXNpemU6IDEwcHg7XFxuICB3aWR0aDogMTBweDtcXG4gIGhlaWdodDogMTBweDtcXG4gIGN1cnNvcjogcG9pbnRlcjtcXG4gIC13ZWJraXQtYm94LXNoYWRvdzogMCAwIDAgNnB4IHJnYmEoMjM4LDIzOCwyMzgsMSk7XFxuICAtbW96LWJveC1zaGFkb3c6IDAgMCAwIDZweCByZ2JhKDIzOCwyMzgsMjM4LDEpO1xcbiAgYm94LXNoYWRvdzogMCAwIDAgNnB4IHJnYmEoMjM4LDIzOCwyMzgsMSk7XFxuICBiYWNrZ3JvdW5kOiAjZWVlO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlIGNvbC5oaWRkZW4ge1xcbiAgd2lkdGg6IDAgIWltcG9ydGFudDtcXG59XFxuXFxuLmhhbmRzb250YWJsZSB0YWJsZSB0ciB0aC5saWdodFJpZ2h0Qm9yZGVyIHtcXG4gIGJvcmRlci1yaWdodDogMXB4IHNvbGlkICNFNkU2RTY7XFxufVxcblxcbi5oYW5kc29udGFibGUgdHIuaGlkZGVuLFxcbi5oYW5kc29udGFibGUgdHIuaGlkZGVuIHRkLFxcbi5oYW5kc29udGFibGUgdHIuaGlkZGVuIHRoIHtcXG4gIGRpc3BsYXk6IG5vbmU7XFxufVxcblxcbi5odF9tYXN0ZXIsXFxuLmh0X2Nsb25lX2xlZnQsXFxuLmh0X2Nsb25lX3RvcCxcXG4uaHRfY2xvbmVfYm90dG9tIHtcXG4gIG92ZXJmbG93OiBoaWRkZW47XFxufVxcblxcbi5odF9tYXN0ZXIgLnd0SG9sZGVyIHtcXG4gIG92ZXJmbG93OiBhdXRvO1xcbn1cXG5cXG4uaHRfY2xvbmVfbGVmdCAud3RIb2xkZXIge1xcbiAgb3ZlcmZsb3cteDogaGlkZGVuO1xcbiAgb3ZlcmZsb3cteTogYXV0bztcXG59XFxuXFxuLmh0X2Nsb25lX3RvcCAud3RIb2xkZXIsXFxuLmh0X2Nsb25lX2JvdHRvbSAud3RIb2xkZXIge1xcbiAgb3ZlcmZsb3cteDogYXV0bztcXG4gIG92ZXJmbG93LXk6IGhpZGRlbjtcXG59XFxuXFxuXFxuLypXYWxrb250YWJsZURlYnVnT3ZlcmxheSovXFxuXFxuLnd0RGVidWdIaWRkZW4ge1xcbiAgZGlzcGxheTogbm9uZTtcXG59XFxuXFxuLnd0RGVidWdWaXNpYmxlIHtcXG4gIGRpc3BsYXk6IGJsb2NrO1xcbiAgLXdlYmtpdC1hbmltYXRpb24tZHVyYXRpb246IDAuNXM7XFxuICAtd2Via2l0LWFuaW1hdGlvbi1uYW1lOiB3dEZhZGVJbkZyb21Ob25lO1xcbiAgYW5pbWF0aW9uLWR1cmF0aW9uOiAwLjVzO1xcbiAgYW5pbWF0aW9uLW5hbWU6IHd0RmFkZUluRnJvbU5vbmU7XFxufVxcblxcbkBrZXlmcmFtZXMgd3RGYWRlSW5Gcm9tTm9uZSB7XFxuICAwJSB7XFxuICAgIGRpc3BsYXk6IG5vbmU7XFxuICAgIG9wYWNpdHk6IDA7XFxuICB9XFxuXFxuICAxJSB7XFxuICAgIGRpc3BsYXk6IGJsb2NrO1xcbiAgICBvcGFjaXR5OiAwO1xcbiAgfVxcblxcbiAgMTAwJSB7XFxuICAgIGRpc3BsYXk6IGJsb2NrO1xcbiAgICBvcGFjaXR5OiAxO1xcbiAgfVxcbn1cXG5cXG5ALXdlYmtpdC1rZXlmcmFtZXMgd3RGYWRlSW5Gcm9tTm9uZSB7XFxuICAwJSB7XFxuICAgIGRpc3BsYXk6IG5vbmU7XFxuICAgIG9wYWNpdHk6IDA7XFxuICB9XFxuXFxuICAxJSB7XFxuICAgIGRpc3BsYXk6IGJsb2NrO1xcbiAgICBvcGFjaXR5OiAwO1xcbiAgfVxcblxcbiAgMTAwJSB7XFxuICAgIGRpc3BsYXk6IGJsb2NrO1xcbiAgICBvcGFjaXR5OiAxO1xcbiAgfVxcbn1cXG4vKlxcblxcbiBIYW5kc29udGFibGUgTW9iaWxlIFRleHQgRWRpdG9yIHN0eWxlc2hlZXRcXG5cXG4gKi9cXG5cXG4uaGFuZHNvbnRhYmxlLm1vYmlsZSxcXG4uaGFuZHNvbnRhYmxlLm1vYmlsZSAud3RIb2xkZXIge1xcbiAgLXdlYmtpdC10b3VjaC1jYWxsb3V0Om5vbmU7XFxuICAtd2Via2l0LXVzZXItc2VsZWN0Om5vbmU7XFxuICAta2h0bWwtdXNlci1zZWxlY3Q6bm9uZTtcXG4gIC1tb3otdXNlci1zZWxlY3Q6bm9uZTtcXG4gIC1tcy11c2VyLXNlbGVjdDpub25lO1xcbiAgdXNlci1zZWxlY3Q6bm9uZTtcXG4gIC13ZWJraXQtdGFwLWhpZ2hsaWdodC1jb2xvcjpyZ2JhKDAsMCwwLDApO1xcbiAgLXdlYmtpdC1vdmVyZmxvdy1zY3JvbGxpbmc6IHRvdWNoO1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIge1xcbiAgZGlzcGxheTogbm9uZTtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHRvcDogMDtcXG4gIHdpZHRoOiA3MCU7XFxuICBoZWlnaHQ6IDU0cHQ7XFxuICBiYWNrZ3JvdW5kOiAjZjhmOGY4O1xcbiAgYm9yZGVyLXJhZGl1czogMjBweDtcXG4gIGJvcmRlcjogMXB4IHNvbGlkICNlYmViZWI7XFxuICB6LWluZGV4OiA5OTk7XFxuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xcbiAgLXdlYmtpdC1ib3gtc2l6aW5nOiBib3JkZXItYm94O1xcbiAgLXdlYmtpdC10ZXh0LXNpemUtYWRqdXN0OiBub25lO1xcbn1cXG5cXG4udG9wTGVmdFNlbGVjdGlvbkhhbmRsZTpub3QoLmh0X21hc3RlciAudG9wTGVmdFNlbGVjdGlvbkhhbmRsZSksXFxuLnRvcExlZnRTZWxlY3Rpb25IYW5kbGUtSGl0QXJlYTpub3QoLmh0X21hc3RlciAudG9wTGVmdFNlbGVjdGlvbkhhbmRsZS1IaXRBcmVhKSB7XFxuICB6LWluZGV4OiA5OTk5O1xcbn1cXG5cXG4vKiBJbml0aWFsIGxlZnQvdG9wIGNvb3JkaW5hdGVzIC0gb3ZlcndyaXR0ZW4gd2hlbiBhY3R1YWwgcG9zaXRpb24gaXMgc2V0ICovXFxuLnRvcExlZnRTZWxlY3Rpb25IYW5kbGUsXFxuLnRvcExlZnRTZWxlY3Rpb25IYW5kbGUtSGl0QXJlYSxcXG4uYm90dG9tUmlnaHRTZWxlY3Rpb25IYW5kbGUsXFxuLmJvdHRvbVJpZ2h0U2VsZWN0aW9uSGFuZGxlLUhpdEFyZWEge1xcbiAgbGVmdDogLTEwMDAwcHg7XFxuICB0b3A6IC0xMDAwMHB4O1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIuYWN0aXZlIHtcXG4gIGRpc3BsYXk6IGJsb2NrO1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLmlucHV0cyB7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICByaWdodDogMjEwcHQ7XFxuICBib3R0b206IDEwcHQ7XFxuICB0b3A6IDEwcHQ7XFxuICBsZWZ0OiAxNHB4O1xcbiAgaGVpZ2h0OiAzNHB0O1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLmlucHV0cyB0ZXh0YXJlYSB7XFxuICBmb250LXNpemU6IDEzcHQ7XFxuICBib3JkZXI6IDFweCBzb2xpZCAjYTFhMWExO1xcbiAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lO1xcbiAgLXdlYmtpdC1ib3gtc2hhZG93OiBub25lO1xcbiAgLW1vei1ib3gtc2hhZG93OiBub25lO1xcbiAgYm94LXNoYWRvdzogbm9uZTtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIGxlZnQ6IDE0cHg7XFxuICByaWdodDogMTRweDtcXG4gIHRvcDogMDtcXG4gIGJvdHRvbTogMDtcXG4gIHBhZGRpbmc6IDdwdDtcXG59XFxuXFxuLmh0TW9iaWxlRWRpdG9yQ29udGFpbmVyIC5jZWxsUG9pbnRlciB7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB0b3A6IC0xM3B0O1xcbiAgaGVpZ2h0OiAwO1xcbiAgd2lkdGg6IDA7XFxuICBsZWZ0OiAzMHB4O1xcblxcbiAgYm9yZGVyLWxlZnQ6IDEzcHQgc29saWQgdHJhbnNwYXJlbnQ7XFxuICBib3JkZXItcmlnaHQ6IDEzcHQgc29saWQgdHJhbnNwYXJlbnQ7XFxuICBib3JkZXItYm90dG9tOiAxM3B0IHNvbGlkICNlYmViZWI7XFxufVxcblxcbi5odE1vYmlsZUVkaXRvckNvbnRhaW5lciAuY2VsbFBvaW50ZXIuaGlkZGVuIHtcXG4gIGRpc3BsYXk6IG5vbmU7XFxufVxcblxcbi5odE1vYmlsZUVkaXRvckNvbnRhaW5lciAuY2VsbFBvaW50ZXI6YmVmb3JlIHtcXG4gIGNvbnRlbnQ6ICcnO1xcbiAgZGlzcGxheTogYmxvY2s7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB0b3A6IDJweDtcXG4gIGhlaWdodDogMDtcXG4gIHdpZHRoOiAwO1xcbiAgbGVmdDogLTEzcHQ7XFxuXFxuICBib3JkZXItbGVmdDogMTNwdCBzb2xpZCB0cmFuc3BhcmVudDtcXG4gIGJvcmRlci1yaWdodDogMTNwdCBzb2xpZCB0cmFuc3BhcmVudDtcXG4gIGJvcmRlci1ib3R0b206IDEzcHQgc29saWQgI2Y4ZjhmODtcXG59XFxuXFxuLmh0TW9iaWxlRWRpdG9yQ29udGFpbmVyIC5tb3ZlSGFuZGxlIHtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHRvcDogMTBwdDtcXG4gIGxlZnQ6IDVweDtcXG4gIHdpZHRoOiAzMHB4O1xcbiAgYm90dG9tOiAwcHg7XFxuICBjdXJzb3I6IG1vdmU7XFxuICB6LWluZGV4OiA5OTk5O1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLm1vdmVIYW5kbGU6YWZ0ZXIge1xcbiAgY29udGVudDogXFxcIi4uXFxcXGEuLlxcXFxhLi5cXFxcYS4uXFxcIjtcXG4gIHdoaXRlLXNwYWNlOiBwcmU7XFxuICBsaW5lLWhlaWdodDogMTBweDtcXG4gIGZvbnQtc2l6ZTogMjBwdDtcXG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcXG4gIG1hcmdpbi10b3A6IC04cHg7XFxuICBjb2xvcjogI2ViZWJlYjtcXG59XFxuXFxuLmh0TW9iaWxlRWRpdG9yQ29udGFpbmVyIC5wb3NpdGlvbkNvbnRyb2xzIHtcXG4gIHdpZHRoOiAyMDVwdDtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHJpZ2h0OiA1cHQ7XFxuICB0b3A6IDA7XFxuICBib3R0b206IDA7XFxufVxcblxcbi5odE1vYmlsZUVkaXRvckNvbnRhaW5lciAucG9zaXRpb25Db250cm9scyA+IGRpdiB7XFxuICB3aWR0aDogNTBwdDtcXG4gIGhlaWdodDogMTAwJTtcXG4gIGZsb2F0OiBsZWZ0O1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLnBvc2l0aW9uQ29udHJvbHMgPiBkaXY6YWZ0ZXIge1xcbiAgY29udGVudDogXFxcIiBcXFwiO1xcbiAgZGlzcGxheTogYmxvY2s7XFxuICB3aWR0aDogMTVwdDtcXG4gIGhlaWdodDogMTVwdDtcXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcXG4gIGxpbmUtaGVpZ2h0OiA1MHB0O1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLmxlZnRCdXR0b246YWZ0ZXIsXFxuLmh0TW9iaWxlRWRpdG9yQ29udGFpbmVyIC5yaWdodEJ1dHRvbjphZnRlcixcXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLnVwQnV0dG9uOmFmdGVyLFxcbi5odE1vYmlsZUVkaXRvckNvbnRhaW5lciAuZG93bkJ1dHRvbjphZnRlciB7XFxuICB0cmFuc2Zvcm0tb3JpZ2luOiA1cHQgNXB0O1xcbiAgLXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luOiA1cHQgNXB0O1xcbiAgbWFyZ2luOiAyMXB0IDAgMCAyMXB0O1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLmxlZnRCdXR0b246YWZ0ZXIge1xcbiAgYm9yZGVyLXRvcDogMnB4IHNvbGlkICMyODhmZmU7XFxuICBib3JkZXItbGVmdDogMnB4IHNvbGlkICMyODhmZmU7XFxuICAtd2Via2l0LXRyYW5zZm9ybTogcm90YXRlKC00NWRlZyk7XFxuICAvKm1hcmdpbi10b3A6IDE3cHQ7Ki9cXG4gIC8qbWFyZ2luLWxlZnQ6IDIwcHQ7Ki9cXG59XFxuLmh0TW9iaWxlRWRpdG9yQ29udGFpbmVyIC5sZWZ0QnV0dG9uOmFjdGl2ZTphZnRlciB7XFxuICBib3JkZXItY29sb3I6ICNjZmNmY2Y7XFxufVxcblxcbi5odE1vYmlsZUVkaXRvckNvbnRhaW5lciAucmlnaHRCdXR0b246YWZ0ZXIge1xcbiAgYm9yZGVyLXRvcDogMnB4IHNvbGlkICMyODhmZmU7XFxuICBib3JkZXItbGVmdDogMnB4IHNvbGlkICMyODhmZmU7XFxuICAtd2Via2l0LXRyYW5zZm9ybTogcm90YXRlKDEzNWRlZyk7XFxuICAvKm1hcmdpbi10b3A6IDE3cHQ7Ki9cXG4gIC8qbWFyZ2luLWxlZnQ6IDEwcHQ7Ki9cXG59XFxuLmh0TW9iaWxlRWRpdG9yQ29udGFpbmVyIC5yaWdodEJ1dHRvbjphY3RpdmU6YWZ0ZXIge1xcbiAgYm9yZGVyLWNvbG9yOiAjY2ZjZmNmO1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLnVwQnV0dG9uOmFmdGVyIHtcXG4gIC8qYm9yZGVyLXRvcDogMnB4IHNvbGlkICNjZmNmY2Y7Ki9cXG4gIGJvcmRlci10b3A6IDJweCBzb2xpZCAjMjg4ZmZlO1xcbiAgYm9yZGVyLWxlZnQ6IDJweCBzb2xpZCAjMjg4ZmZlO1xcbiAgLXdlYmtpdC10cmFuc2Zvcm06IHJvdGF0ZSg0NWRlZyk7XFxuICAvKm1hcmdpbi10b3A6IDIycHQ7Ki9cXG4gIC8qbWFyZ2luLWxlZnQ6IDE1cHQ7Ki9cXG59XFxuLmh0TW9iaWxlRWRpdG9yQ29udGFpbmVyIC51cEJ1dHRvbjphY3RpdmU6YWZ0ZXIge1xcbiAgYm9yZGVyLWNvbG9yOiAjY2ZjZmNmO1xcbn1cXG5cXG4uaHRNb2JpbGVFZGl0b3JDb250YWluZXIgLmRvd25CdXR0b246YWZ0ZXIge1xcbiAgYm9yZGVyLXRvcDogMnB4IHNvbGlkICMyODhmZmU7XFxuICBib3JkZXItbGVmdDogMnB4IHNvbGlkICMyODhmZmU7XFxuICAtd2Via2l0LXRyYW5zZm9ybTogcm90YXRlKDIyNWRlZyk7XFxuICAvKm1hcmdpbi10b3A6IDE1cHQ7Ki9cXG4gIC8qbWFyZ2luLWxlZnQ6IDE1cHQ7Ki9cXG59XFxuLmh0TW9iaWxlRWRpdG9yQ29udGFpbmVyIC5kb3duQnV0dG9uOmFjdGl2ZTphZnRlciB7XFxuICBib3JkZXItY29sb3I6ICNjZmNmY2Y7XFxufVxcblxcbi5oYW5kc29udGFibGUuaGlkZS10d2VlbiB7XFxuICAtd2Via2l0LWFuaW1hdGlvbjogb3BhY2l0eS1oaWRlIDAuM3M7XFxuICBhbmltYXRpb246IG9wYWNpdHktaGlkZSAwLjNzO1xcbiAgYW5pbWF0aW9uLWZpbGwtbW9kZTogZm9yd2FyZHM7XFxuICAtd2Via2l0LWFuaW1hdGlvbi1maWxsLW1vZGU6IGZvcndhcmRzO1xcbn1cXG5cXG4uaGFuZHNvbnRhYmxlLnNob3ctdHdlZW4ge1xcbiAgLXdlYmtpdC1hbmltYXRpb246IG9wYWNpdHktc2hvdyAwLjNzO1xcbiAgYW5pbWF0aW9uOiBvcGFjaXR5LXNob3cgMC4zcztcXG4gIGFuaW1hdGlvbi1maWxsLW1vZGU6IGZvcndhcmRzO1xcbiAgLXdlYmtpdC1hbmltYXRpb24tZmlsbC1tb2RlOiBmb3J3YXJkcztcXG59XFxuLmh0Q29tbWVudENlbGwge1xcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XFxufVxcblxcbi5odENvbW1lbnRDZWxsOmFmdGVyIHtcXG4gICAgY29udGVudDogJyc7XFxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gICAgdG9wOiAwO1xcbiAgICByaWdodDogMDtcXG4gICAgYm9yZGVyLWxlZnQ6IDZweCBzb2xpZCB0cmFuc3BhcmVudDtcXG4gICAgYm9yZGVyLXRvcDogNnB4IHNvbGlkIGJsYWNrO1xcbn1cXG5cXG4uaHRDb21tZW50cyB7XFxuICAgIGRpc3BsYXk6IG5vbmU7XFxuICAgIHotaW5kZXg6IDEwNTk7XFxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG59XFxuXFxuLmh0Q29tbWVudFRleHRBcmVhIHtcXG4gICAgYm94LXNoYWRvdzogcmdiYSgwLCAwLCAwLCAwLjExNzY0NykgMCAxcHggM3B4LCByZ2JhKDAsIDAsIDAsIDAuMjM5MjE2KSAwIDFweCAycHg7XFxuICAgIC13ZWJraXQtYm94LXNpemluZzogYm9yZGVyLWJveDtcXG4gICAgLW1vei1ib3gtc2l6aW5nOiBib3JkZXItYm94O1xcbiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xcbiAgICBib3JkZXI6IG5vbmU7XFxuICAgIGJvcmRlci1sZWZ0OiAzcHggc29saWQgI2NjYztcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjtcXG4gICAgd2lkdGg6IDIxNXB4O1xcbiAgICBoZWlnaHQ6IDkwcHg7XFxuICAgIGZvbnQtc2l6ZTogMTJweDtcXG4gICAgcGFkZGluZzogNXB4O1xcbiAgICBvdXRsaW5lOiAwcHggIWltcG9ydGFudDtcXG4gICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lO1xcbn1cXG5cXG4uaHRDb21tZW50VGV4dEFyZWE6Zm9jdXMge1xcbiAgICBib3gtc2hhZG93OiByZ2JhKDAsIDAsIDAsIDAuMTE3NjQ3KSAwIDFweCAzcHgsIHJnYmEoMCwgMCwgMCwgMC4yMzkyMTYpIDAgMXB4IDJweCwgaW5zZXQgMCAwIDAgMXB4ICM1MjkyZjc7XFxuICAgIGJvcmRlci1sZWZ0OiAzcHggc29saWQgIzUyOTJmNztcXG59XFxuLyohXFxuICogSGFuZHNvbnRhYmxlIENvbnRleHRNZW51XFxuICovXFxuXFxuLmh0Q29udGV4dE1lbnUge1xcbiAgZGlzcGxheTogbm9uZTtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHotaW5kZXg6IDEwNjA7IC8qIG5lZWRzIHRvIGJlIGhpZ2hlciB0aGFuIDEwNTAgLSB6LWluZGV4IGZvciBUd2l0dGVyIEJvb3RzdHJhcCBtb2RhbCAoIzE1NjkpICovXFxufVxcblxcbi5odENvbnRleHRNZW51IC5odF9jbG9uZV90b3AsXFxuLmh0Q29udGV4dE1lbnUgLmh0X2Nsb25lX2xlZnQsXFxuLmh0Q29udGV4dE1lbnUgLmh0X2Nsb25lX2Nvcm5lcixcXG4uaHRDb250ZXh0TWVudSAuaHRfY2xvbmVfZGVidWcge1xcbiAgZGlzcGxheTogbm9uZTtcXG59XFxuXFxuLmh0Q29udGV4dE1lbnUgdGFibGUuaHRDb3JlIHtcXG4gIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7XFxuICBib3JkZXItYm90dG9tLXdpZHRoOiAycHg7XFxuICBib3JkZXItcmlnaHQtd2lkdGg6IDJweDtcXG59XFxuXFxuLmh0Q29udGV4dE1lbnUgLnd0Qm9yZGVyIHtcXG4gIHZpc2liaWxpdHk6IGhpZGRlbjtcXG59XFxuXFxuLmh0Q29udGV4dE1lbnUgdGFibGUgdGJvZHkgdHIgdGQge1xcbiAgYmFja2dyb3VuZDogd2hpdGU7XFxuICBib3JkZXItd2lkdGg6IDA7XFxuICBwYWRkaW5nOiA0cHggNnB4IDAgNnB4O1xcbiAgY3Vyc29yOiBwb2ludGVyO1xcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcXG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XFxuICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcXG59XFxuXFxuLmh0Q29udGV4dE1lbnUgdGFibGUgdGJvZHkgdHIgdGQ6Zmlyc3QtY2hpbGQge1xcbiAgYm9yZGVyOiAwO1xcbn1cXG5cXG4uaHRDb250ZXh0TWVudSB0YWJsZSB0Ym9keSB0ciB0ZC5odERpbW1lZCB7XFxuICBmb250LXN0eWxlOiBub3JtYWw7XFxuICBjb2xvcjogIzMyMzIzMjtcXG59XFxuXFxuLmh0Q29udGV4dE1lbnUgdGFibGUgdGJvZHkgdHIgdGQuY3VycmVudCxcXG4uaHRDb250ZXh0TWVudSB0YWJsZSB0Ym9keSB0ciB0ZC56ZXJvY2xpcGJvYXJkLWlzLWhvdmVyIHtcXG4gIGJhY2tncm91bmQ6ICNmM2YzZjM7XFxufVxcblxcbi5odENvbnRleHRNZW51IHRhYmxlIHRib2R5IHRyIHRkLmh0U2VwYXJhdG9yIHtcXG4gIGJvcmRlci10b3A6IDFweCBzb2xpZCAjYmJiO1xcbiAgaGVpZ2h0OiAwO1xcbiAgcGFkZGluZzogMDtcXG4gIGN1cnNvcjogZGVmYXVsdDtcXG59XFxuXFxuLmh0Q29udGV4dE1lbnUgdGFibGUgdGJvZHkgdHIgdGQuaHREaXNhYmxlZCB7XFxuICBjb2xvcjogIzk5OTtcXG4gIGN1cnNvcjogZGVmYXVsdDtcXG59XFxuXFxuLmh0Q29udGV4dE1lbnUgdGFibGUgdGJvZHkgdHIgdGQuaHREaXNhYmxlZDpob3ZlciB7XFxuICBiYWNrZ3JvdW5kOiAjZmZmO1xcbiAgY29sb3I6ICM5OTk7XFxuICBjdXJzb3I6IGRlZmF1bHQ7XFxufVxcblxcbi5odENvbnRleHRNZW51IHRhYmxlIHRib2R5IHRyLmh0SGlkZGVuIHtcXG4gIGRpc3BsYXk6IG5vbmU7XFxufVxcblxcbi5odENvbnRleHRNZW51IHRhYmxlIHRib2R5IHRyIHRkIC5odEl0ZW1XcmFwcGVyIHtcXG4gIG1hcmdpbi1sZWZ0OiAxMHB4O1xcbiAgbWFyZ2luLXJpZ2h0OiA2cHg7XFxufVxcblxcbi5odENvbnRleHRNZW51IHRhYmxlIHRib2R5IHRyIHRkIGRpdiBzcGFuLnNlbGVjdGVkIHtcXG4gIG1hcmdpbi10b3A6IC0ycHg7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICBsZWZ0OiA0cHg7XFxufVxcblxcbi5odENvbnRleHRNZW51IC5odF9tYXN0ZXIgLnd0SG9sZGVyIHtcXG4gIG92ZXJmbG93OiBoaWRkZW47XFxufVxcbi5odFJvd0hlYWRlcnMgLmh0X21hc3Rlci5pbm5lckJvcmRlckxlZnQgfiAuaHRfY2xvbmVfdG9wX2xlZnRfY29ybmVyIHRoOm50aC1jaGlsZCgyKSxcXG4uaHRSb3dIZWFkZXJzIC5odF9tYXN0ZXIuaW5uZXJCb3JkZXJMZWZ0IH4gLmh0X2Nsb25lX2xlZnQgdGQ6Zmlyc3Qtb2YtdHlwZSB7XFxuICBib3JkZXItbGVmdDogMCBub25lO1xcbn1cXG4uaGFuZHNvbnRhYmxlIC53dEhpZGVyIHtcXG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcXG59XFxuLmhhbmRzb250YWJsZS5odF9fbWFudWFsQ29sdW1uTW92ZS5hZnRlci1zZWxlY3Rpb24tLWNvbHVtbnMgdGhlYWQgdGguaHRfX2hpZ2hsaWdodCB7XFxuICBjdXJzb3I6IG1vdmU7XFxuICBjdXJzb3I6IC1tb3otZ3JhYjtcXG4gIGN1cnNvcjogLXdlYmtpdC1ncmFiO1xcbiAgY3Vyc29yOiBncmFiO1xcbn1cXG4uaGFuZHNvbnRhYmxlLmh0X19tYW51YWxDb2x1bW5Nb3ZlLm9uLW1vdmluZy0tY29sdW1ucyxcXG4uaGFuZHNvbnRhYmxlLmh0X19tYW51YWxDb2x1bW5Nb3ZlLm9uLW1vdmluZy0tY29sdW1ucyB0aGVhZCB0aC5odF9faGlnaGxpZ2h0IHtcXG4gIGN1cnNvcjogbW92ZTtcXG4gIGN1cnNvcjogLW1vei1ncmFiYmluZztcXG4gIGN1cnNvcjogLXdlYmtpdC1ncmFiYmluZztcXG4gIGN1cnNvcjogZ3JhYmJpbmc7XFxufVxcbi5oYW5kc29udGFibGUuaHRfX21hbnVhbENvbHVtbk1vdmUub24tbW92aW5nLS1jb2x1bW5zIC5tYW51YWxDb2x1bW5SZXNpemVyIHtcXG4gIGRpc3BsYXk6IG5vbmU7XFxufVxcbi5oYW5kc29udGFibGUgLmh0X19tYW51YWxDb2x1bW5Nb3ZlLS1ndWlkZWxpbmUsXFxuLmhhbmRzb250YWJsZSAuaHRfX21hbnVhbENvbHVtbk1vdmUtLWJhY2tsaWdodCB7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICBoZWlnaHQ6IDEwMCU7XFxuICBkaXNwbGF5OiBub25lO1xcbn1cXG4uaGFuZHNvbnRhYmxlIC5odF9fbWFudWFsQ29sdW1uTW92ZS0tZ3VpZGVsaW5lIHtcXG4gIGJhY2tncm91bmQ6ICM3NTc1NzU7XFxuICB3aWR0aDogMnB4O1xcbiAgdG9wOiAwO1xcbiAgbWFyZ2luLWxlZnQ6IC0xcHg7XFxuICB6LWluZGV4OiAxMDU7XFxufVxcbi5oYW5kc29udGFibGUgLmh0X19tYW51YWxDb2x1bW5Nb3ZlLS1iYWNrbGlnaHQge1xcbiAgYmFja2dyb3VuZDogIzM0MzQzNDtcXG4gIGJhY2tncm91bmQ6IHJnYmEoNTIsIDUyLCA1MiwgMC4yNSk7XFxuICBkaXNwbGF5OiBub25lO1xcbiAgei1pbmRleDogMTA1O1xcbiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XFxufVxcbi5oYW5kc29udGFibGUub24tbW92aW5nLS1jb2x1bW5zLnNob3ctdWkgLmh0X19tYW51YWxDb2x1bW5Nb3ZlLS1ndWlkZWxpbmUsXFxuLmhhbmRzb250YWJsZS5vbi1tb3ZpbmctLWNvbHVtbnMgLmh0X19tYW51YWxDb2x1bW5Nb3ZlLS1iYWNrbGlnaHQge1xcbiAgZGlzcGxheTogYmxvY2s7XFxufVxcbi5oYW5kc29udGFibGUgLnd0SGlkZXIge1xcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xcbn1cXG4uaGFuZHNvbnRhYmxlLmh0X19tYW51YWxSb3dNb3ZlLmFmdGVyLXNlbGVjdGlvbi0tcm93cyB0Ym9keSB0aC5odF9faGlnaGxpZ2h0IHtcXG4gIGN1cnNvcjogbW92ZTtcXG4gIGN1cnNvcjogLW1vei1ncmFiO1xcbiAgY3Vyc29yOiAtd2Via2l0LWdyYWI7XFxuICBjdXJzb3I6IGdyYWI7XFxufVxcbi5oYW5kc29udGFibGUuaHRfX21hbnVhbFJvd01vdmUub24tbW92aW5nLS1yb3dzLFxcbi5oYW5kc29udGFibGUuaHRfX21hbnVhbFJvd01vdmUub24tbW92aW5nLS1yb3dzIHRib2R5IHRoLmh0X19oaWdobGlnaHQge1xcbiAgY3Vyc29yOiBtb3ZlO1xcbiAgY3Vyc29yOiAtbW96LWdyYWJiaW5nO1xcbiAgY3Vyc29yOiAtd2Via2l0LWdyYWJiaW5nO1xcbiAgY3Vyc29yOiBncmFiYmluZztcXG59XFxuLmhhbmRzb250YWJsZS5odF9fbWFudWFsUm93TW92ZS5vbi1tb3ZpbmctLXJvd3MgLm1hbnVhbFJvd1Jlc2l6ZXIge1xcbiAgZGlzcGxheTogbm9uZTtcXG59XFxuLmhhbmRzb250YWJsZSAuaHRfX21hbnVhbFJvd01vdmUtLWd1aWRlbGluZSxcXG4uaGFuZHNvbnRhYmxlIC5odF9fbWFudWFsUm93TW92ZS0tYmFja2xpZ2h0IHtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHdpZHRoOiAxMDAlO1xcbiAgZGlzcGxheTogbm9uZTtcXG59XFxuLmhhbmRzb250YWJsZSAuaHRfX21hbnVhbFJvd01vdmUtLWd1aWRlbGluZSB7XFxuICBiYWNrZ3JvdW5kOiAjNzU3NTc1O1xcbiAgaGVpZ2h0OiAycHg7XFxuICBsZWZ0OiAwO1xcbiAgbWFyZ2luLXRvcDogLTFweDtcXG4gIHotaW5kZXg6IDEwNTtcXG59XFxuLmhhbmRzb250YWJsZSAuaHRfX21hbnVhbFJvd01vdmUtLWJhY2tsaWdodCB7XFxuICBiYWNrZ3JvdW5kOiAjMzQzNDM0O1xcbiAgYmFja2dyb3VuZDogcmdiYSg1MiwgNTIsIDUyLCAwLjI1KTtcXG4gIGRpc3BsYXk6IG5vbmU7XFxuICB6LWluZGV4OiAxMDU7XFxuICBwb2ludGVyLWV2ZW50czogbm9uZTtcXG59XFxuLmhhbmRzb250YWJsZS5vbi1tb3ZpbmctLXJvd3Muc2hvdy11aSAuaHRfX21hbnVhbFJvd01vdmUtLWd1aWRlbGluZSxcXG4uaGFuZHNvbnRhYmxlLm9uLW1vdmluZy0tcm93cyAuaHRfX21hbnVhbFJvd01vdmUtLWJhY2tsaWdodCB7XFxuICBkaXNwbGF5OiBibG9jaztcXG59XFxuQGNoYXJzZXQgXFxcIlVURi04XFxcIjtcXG5cXG4vKiFcXG4gKiBQaWthZGF5XFxuICogQ29weXJpZ2h0IMKpIDIwMTQgRGF2aWQgQnVzaGVsbCB8IEJTRCAmIE1JVCBsaWNlbnNlIHwgaHR0cDovL2RidXNoZWxsLmNvbS9cXG4gKi9cXG5cXG4ucGlrYS1zaW5nbGUge1xcbiAgICB6LWluZGV4OiA5OTk5O1xcbiAgICBkaXNwbGF5OiBibG9jaztcXG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xcbiAgICBjb2xvcjogIzMzMztcXG4gICAgYmFja2dyb3VuZDogI2ZmZjtcXG4gICAgYm9yZGVyOiAxcHggc29saWQgI2NjYztcXG4gICAgYm9yZGVyLWJvdHRvbS1jb2xvcjogI2JiYjtcXG4gICAgZm9udC1mYW1pbHk6IFxcXCJIZWx2ZXRpY2EgTmV1ZVxcXCIsIEhlbHZldGljYSwgQXJpYWwsIHNhbnMtc2VyaWY7XFxufVxcblxcbi8qXFxuY2xlYXIgY2hpbGQgZmxvYXQgKHBpa2EtbGVuZGFyKSwgdXNpbmcgdGhlIGZhbW91cyBtaWNybyBjbGVhcmZpeCBoYWNrXFxuaHR0cDovL25pY29sYXNnYWxsYWdoZXIuY29tL21pY3JvLWNsZWFyZml4LWhhY2svXFxuKi9cXG4ucGlrYS1zaW5nbGU6YmVmb3JlLFxcbi5waWthLXNpbmdsZTphZnRlciB7XFxuICAgIGNvbnRlbnQ6IFxcXCIgXFxcIjtcXG4gICAgZGlzcGxheTogdGFibGU7XFxufVxcbi5waWthLXNpbmdsZTphZnRlciB7IGNsZWFyOiBib3RoIH1cXG4ucGlrYS1zaW5nbGUgeyAqem9vbTogMSB9XFxuXFxuLnBpa2Etc2luZ2xlLmlzLWhpZGRlbiB7XFxuICAgIGRpc3BsYXk6IG5vbmU7XFxufVxcblxcbi5waWthLXNpbmdsZS5pcy1ib3VuZCB7XFxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gICAgYm94LXNoYWRvdzogMCA1cHggMTVweCAtNXB4IHJnYmEoMCwwLDAsLjUpO1xcbn1cXG5cXG4ucGlrYS1sZW5kYXIge1xcbiAgICBmbG9hdDogbGVmdDtcXG4gICAgd2lkdGg6IDI0MHB4O1xcbiAgICBtYXJnaW46IDhweDtcXG59XFxuXFxuLnBpa2EtdGl0bGUge1xcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XFxuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcXG59XFxuXFxuLnBpa2EtbGFiZWwge1xcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XFxuICAgICpkaXNwbGF5OiBpbmxpbmU7XFxuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcXG4gICAgei1pbmRleDogOTk5OTtcXG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcXG4gICAgbWFyZ2luOiAwO1xcbiAgICBwYWRkaW5nOiA1cHggM3B4O1xcbiAgICBmb250LXNpemU6IDE0cHg7XFxuICAgIGxpbmUtaGVpZ2h0OiAyMHB4O1xcbiAgICBmb250LXdlaWdodDogYm9sZDtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjtcXG59XFxuLnBpa2EtdGl0bGUgc2VsZWN0IHtcXG4gICAgY3Vyc29yOiBwb2ludGVyO1xcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICAgIHotaW5kZXg6IDk5OTg7XFxuICAgIG1hcmdpbjogMDtcXG4gICAgbGVmdDogMDtcXG4gICAgdG9wOiA1cHg7XFxuICAgIGZpbHRlcjogYWxwaGEob3BhY2l0eT0wKTtcXG4gICAgb3BhY2l0eTogMDtcXG59XFxuXFxuLnBpa2EtcHJldixcXG4ucGlrYS1uZXh0IHtcXG4gICAgZGlzcGxheTogYmxvY2s7XFxuICAgIGN1cnNvcjogcG9pbnRlcjtcXG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xcbiAgICBvdXRsaW5lOiBub25lO1xcbiAgICBib3JkZXI6IDA7XFxuICAgIHBhZGRpbmc6IDA7XFxuICAgIHdpZHRoOiAyMHB4O1xcbiAgICBoZWlnaHQ6IDMwcHg7XFxuICAgIC8qIGhpZGUgdGV4dCB1c2luZyB0ZXh0LWluZGVudCB0cmljaywgdXNpbmcgd2lkdGggdmFsdWUgKGl0J3MgZW5vdWdoKSAqL1xcbiAgICB0ZXh0LWluZGVudDogMjBweDtcXG4gICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcXG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XFxuICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlciBjZW50ZXI7XFxuICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7XFxuICAgIGJhY2tncm91bmQtc2l6ZTogNzUlIDc1JTtcXG4gICAgb3BhY2l0eTogLjU7XFxuICAgICpwb3NpdGlvbjogYWJzb2x1dGU7XFxuICAgICp0b3A6IDA7XFxufVxcblxcbi5waWthLXByZXY6aG92ZXIsXFxuLnBpa2EtbmV4dDpob3ZlciB7XFxuICAgIG9wYWNpdHk6IDE7XFxufVxcblxcbi5waWthLXByZXYsXFxuLmlzLXJ0bCAucGlrYS1uZXh0IHtcXG4gICAgZmxvYXQ6IGxlZnQ7XFxuICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgnZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFCUUFBQUFlQ0FZQUFBQXNFajVyQUFBQVVrbEVRVlI0MnUzVk1Rb0FJQkFEUWY4UGdqK09EOWhHMkN0T05KQjJ5bVFrS2UwSGJ3QVAweHVjRGlRV0FSSVRJREVCRW5NZ01ROFM4K0FxQklsNmtLZ0hpWHFRcUFlSmVwQm8vejM4Si9VMHVBSGxhQmtCbDlJNEd3QUFBQUJKUlU1RXJrSmdnZz09Jyk7XFxuICAgICpsZWZ0OiAwO1xcbn1cXG5cXG4ucGlrYS1uZXh0LFxcbi5pcy1ydGwgLnBpa2EtcHJldiB7XFxuICAgIGZsb2F0OiByaWdodDtcXG4gICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCdkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJRQUFBQWVDQVlBQUFBc0VqNXJBQUFBVTBsRVFWUjQydTNWT3dvQU1BZ0UwZHdmQW5OalUyNmJZa0JDRkd3ZmlMOVZWV29PK0JKNEdmM2d0c0VLS29GQk5UQ29DQVlWd2FBaUdOUUdNVUhNa2pHYmdqazJtSU9OdVhvMG5DOFhuQ2YxSlhnQXJWSVpBUWg1VEtZQUFBQUFTVVZPUks1Q1lJST0nKTtcXG4gICAgKnJpZ2h0OiAwO1xcbn1cXG5cXG4ucGlrYS1wcmV2LmlzLWRpc2FibGVkLFxcbi5waWthLW5leHQuaXMtZGlzYWJsZWQge1xcbiAgICBjdXJzb3I6IGRlZmF1bHQ7XFxuICAgIG9wYWNpdHk6IC4yO1xcbn1cXG5cXG4ucGlrYS1zZWxlY3Qge1xcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XFxuICAgICpkaXNwbGF5OiBpbmxpbmU7XFxufVxcblxcbi5waWthLXRhYmxlIHtcXG4gICAgd2lkdGg6IDEwMCU7XFxuICAgIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7XFxuICAgIGJvcmRlci1zcGFjaW5nOiAwO1xcbiAgICBib3JkZXI6IDA7XFxufVxcblxcbi5waWthLXRhYmxlIHRoLFxcbi5waWthLXRhYmxlIHRkIHtcXG4gICAgd2lkdGg6IDE0LjI4NTcxNDI4NTcxNDI4NiU7XFxuICAgIHBhZGRpbmc6IDA7XFxufVxcblxcbi5waWthLXRhYmxlIHRoIHtcXG4gICAgY29sb3I6ICM5OTk7XFxuICAgIGZvbnQtc2l6ZTogMTJweDtcXG4gICAgbGluZS1oZWlnaHQ6IDI1cHg7XFxuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxufVxcblxcbi5waWthLWJ1dHRvbiB7XFxuICAgIGN1cnNvcjogcG9pbnRlcjtcXG4gICAgZGlzcGxheTogYmxvY2s7XFxuICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XFxuICAgIC1tb3otYm94LXNpemluZzogYm9yZGVyLWJveDtcXG4gICAgb3V0bGluZTogbm9uZTtcXG4gICAgYm9yZGVyOiAwO1xcbiAgICBtYXJnaW46IDA7XFxuICAgIHdpZHRoOiAxMDAlO1xcbiAgICBwYWRkaW5nOiA1cHg7XFxuICAgIGNvbG9yOiAjNjY2O1xcbiAgICBmb250LXNpemU6IDEycHg7XFxuICAgIGxpbmUtaGVpZ2h0OiAxNXB4O1xcbiAgICB0ZXh0LWFsaWduOiByaWdodDtcXG4gICAgYmFja2dyb3VuZDogI2Y1ZjVmNTtcXG59XFxuXFxuLnBpa2Etd2VlayB7XFxuICAgIGZvbnQtc2l6ZTogMTFweDtcXG4gICAgY29sb3I6ICM5OTk7XFxufVxcblxcbi5pcy10b2RheSAucGlrYS1idXR0b24ge1xcbiAgICBjb2xvcjogIzMzYWFmZjtcXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XFxufVxcblxcbi5pcy1zZWxlY3RlZCAucGlrYS1idXR0b24ge1xcbiAgICBjb2xvcjogI2ZmZjtcXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XFxuICAgIGJhY2tncm91bmQ6ICMzM2FhZmY7XFxuICAgIGJveC1zaGFkb3c6IGluc2V0IDAgMXB4IDNweCAjMTc4ZmU1O1xcbiAgICBib3JkZXItcmFkaXVzOiAzcHg7XFxufVxcblxcbi5pcy1pbnJhbmdlIC5waWthLWJ1dHRvbiB7XFxuICAgIGJhY2tncm91bmQ6ICNENUU5Rjc7XFxufVxcblxcbi5pcy1zdGFydHJhbmdlIC5waWthLWJ1dHRvbiB7XFxuICAgIGNvbG9yOiAjZmZmO1xcbiAgICBiYWNrZ3JvdW5kOiAjNkNCMzFEO1xcbiAgICBib3gtc2hhZG93OiBub25lO1xcbiAgICBib3JkZXItcmFkaXVzOiAzcHg7XFxufVxcblxcbi5pcy1lbmRyYW5nZSAucGlrYS1idXR0b24ge1xcbiAgICBjb2xvcjogI2ZmZjtcXG4gICAgYmFja2dyb3VuZDogIzMzYWFmZjtcXG4gICAgYm94LXNoYWRvdzogbm9uZTtcXG4gICAgYm9yZGVyLXJhZGl1czogM3B4O1xcbn1cXG5cXG4uaXMtZGlzYWJsZWQgLnBpa2EtYnV0dG9uLFxcbi5pcy1vdXRzaWRlLWN1cnJlbnQtbW9udGggLnBpa2EtYnV0dG9uIHtcXG4gICAgcG9pbnRlci1ldmVudHM6IG5vbmU7XFxuICAgIGN1cnNvcjogZGVmYXVsdDtcXG4gICAgY29sb3I6ICM5OTk7XFxuICAgIG9wYWNpdHk6IC4zO1xcbn1cXG5cXG4ucGlrYS1idXR0b246aG92ZXIge1xcbiAgICBjb2xvcjogI2ZmZjtcXG4gICAgYmFja2dyb3VuZDogI2ZmODAwMDtcXG4gICAgYm94LXNoYWRvdzogbm9uZTtcXG4gICAgYm9yZGVyLXJhZGl1czogM3B4O1xcbn1cXG5cXG4vKiBzdHlsaW5nIGZvciBhYmJyICovXFxuLnBpa2EtdGFibGUgYWJiciB7XFxuICAgIGJvcmRlci1ib3R0b206IG5vbmU7XFxuICAgIGN1cnNvcjogaGVscDtcXG59XFxuXFxuXCJdLFwic291cmNlUm9vdFwiOlwiXCJ9XSk7XG5cbi8vIGV4cG9ydHNcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9jc3MtbG9hZGVyP3NvdXJjZU1hcCEuL34vaGFuZHNvbnRhYmxlL2Rpc3QvaGFuZHNvbnRhYmxlLmZ1bGwuY3NzXG4vLyBtb2R1bGUgaWQgPSA2NTVcbi8vIG1vZHVsZSBjaHVua3MgPSAyMCIsImV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCIuLi8uLi9jc3MtbG9hZGVyL2xpYi9jc3MtYmFzZS5qc1wiKSgpO1xuLy8gaW1wb3J0c1xuZXhwb3J0cy5pKHJlcXVpcmUoXCItIS4uLy4uL2Nzcy1sb2FkZXIvaW5kZXguanM/c291cmNlTWFwIWhhbmRzb250YWJsZS9kaXN0L2hhbmRzb250YWJsZS5mdWxsLmNzc1wiKSwgXCJcIik7XG5cbi8vIG1vZHVsZVxuZXhwb3J0cy5wdXNoKFttb2R1bGUuaWQsIFwiXFxuXCIsIFwiXCIsIHtcInZlcnNpb25cIjozLFwic291cmNlc1wiOltdLFwibmFtZXNcIjpbXSxcIm1hcHBpbmdzXCI6XCJcIixcImZpbGVcIjpcIkhhbmRzb250YWJsZS52dWVcIixcInNvdXJjZVJvb3RcIjpcIlwifV0pO1xuXG4vLyBleHBvcnRzXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vY3NzLWxvYWRlcj9zb3VyY2VNYXAhLi9+L3Z1ZS1sb2FkZXIvbGliL3N0eWxlLWNvbXBpbGVyP3tcImlkXCI6XCJkYXRhLXYtMzllMmUwOTJcIixcInNjb3BlZFwiOmZhbHNlLFwiaGFzSW5saW5lQ29uZmlnXCI6dHJ1ZX0hLi9+L3Z1ZS1sb2FkZXIvbGliL3NlbGVjdG9yLmpzP3R5cGU9c3R5bGVzJmluZGV4PTAhLi9+L3Z1ZS1oYW5kc29udGFibGUvc3JjL0hhbmRzb250YWJsZS52dWVcbi8vIG1vZHVsZSBpZCA9IDY1OFxuLy8gbW9kdWxlIGNodW5rcyA9IDIwIiwiLyohXG4oVGhlIE1JVCBMaWNlbnNlKVxuXG5Db3B5cmlnaHQgKGMpIDIwMTItMjAxNCBNYXJjaW4gV2FycGVjaG93c2tpXG5Db3B5cmlnaHQgKGMpIDIwMTUgSGFuZHNvbmNvZGUgc3AuIHogby5vLiA8aGVsbG9AaGFuZHNvbmNvZGUubmV0PlxuXG5QZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmdcbmEgY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZVxuJ1NvZnR3YXJlJyksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xud2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvXG5wZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG9cbnRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcblxuVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmVcbmluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgJ0FTIElTJywgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCxcbkVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULlxuSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTllcbkNMQUlNLCBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsXG5UT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRVxuU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbiovXG4oZnVuY3Rpb24oZil7aWYodHlwZW9mIGV4cG9ydHM9PT1cIm9iamVjdFwiJiZ0eXBlb2YgbW9kdWxlIT09XCJ1bmRlZmluZWRcIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PVwiZnVuY3Rpb25cIiYmZGVmaW5lLmFtZCl7ZGVmaW5lKFtdLGYpfWVsc2V7dmFyIGc7aWYodHlwZW9mIHdpbmRvdyE9PVwidW5kZWZpbmVkXCIpe2c9d2luZG93fWVsc2UgaWYodHlwZW9mIGdsb2JhbCE9PVwidW5kZWZpbmVkXCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT1cInVuZGVmaW5lZFwiKXtnPXNlbGZ9ZWxzZXtnPXRoaXN9Zy5IYW5kc29udGFibGUgPSBmKCl9fSkoZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiAoZnVuY3Rpb24gb3V0ZXIgKG1vZHVsZXMsIGNhY2hlLCBlbnRyeSkge1xuICAvLyBTYXZlIHRoZSByZXF1aXJlIGZyb20gcHJldmlvdXMgYnVuZGxlIHRvIHRoaXMgY2xvc3VyZSBpZiBhbnlcbiAgdmFyIHByZXZpb3VzUmVxdWlyZSA9IHR5cGVvZiByZXF1aXJlID09IFwiZnVuY3Rpb25cIiAmJiByZXF1aXJlO1xuICB2YXIgZ2xvYmFsTlMgPSBKU09OLnBhcnNlKCd7XCJ6ZXJvY2xpcGJvYXJkXCI6XCJaZXJvQ2xpcGJvYXJkXCIsXCJtb21lbnRcIjpcIm1vbWVudFwiLFwibnVtYnJvXCI6XCJudW1icm9cIixcInBpa2FkYXlcIjpcIlBpa2FkYXlcIn0nKSB8fCB7fTtcblxuICBmdW5jdGlvbiBuZXdSZXF1aXJlKG5hbWUsIGp1bXBlZCl7XG4gICAgaWYoIWNhY2hlW25hbWVdKSB7XG5cbiAgICAgIGlmKCFtb2R1bGVzW25hbWVdKSB7XG4gICAgICAgIC8vIGlmIHdlIGNhbm5vdCBmaW5kIHRoZSB0aGUgbW9kdWxlIHdpdGhpbiBvdXIgaW50ZXJuYWwgbWFwIG9yXG4gICAgICAgIC8vIGNhY2hlIGp1bXAgdG8gdGhlIGN1cnJlbnQgZ2xvYmFsIHJlcXVpcmUgaWUuIHRoZSBsYXN0IGJ1bmRsZVxuICAgICAgICAvLyB0aGF0IHdhcyBhZGRlZCB0byB0aGUgcGFnZS5cbiAgICAgICAgdmFyIGN1cnJlbnRSZXF1aXJlID0gdHlwZW9mIHJlcXVpcmUgPT0gXCJmdW5jdGlvblwiICYmIHJlcXVpcmU7XG4gICAgICAgIGlmICghanVtcGVkICYmIGN1cnJlbnRSZXF1aXJlKSByZXR1cm4gY3VycmVudFJlcXVpcmUobmFtZSwgdHJ1ZSk7XG5cbiAgICAgICAgLy8gSWYgdGhlcmUgYXJlIG90aGVyIGJ1bmRsZXMgb24gdGhpcyBwYWdlIHRoZSByZXF1aXJlIGZyb20gdGhlXG4gICAgICAgIC8vIHByZXZpb3VzIG9uZSBpcyBzYXZlZCB0byAncHJldmlvdXNSZXF1aXJlJy4gUmVwZWF0IHRoaXMgYXNcbiAgICAgICAgLy8gbWFueSB0aW1lcyBhcyB0aGVyZSBhcmUgYnVuZGxlcyB1bnRpbCB0aGUgbW9kdWxlIGlzIGZvdW5kIG9yXG4gICAgICAgIC8vIHdlIGV4aGF1c3QgdGhlIHJlcXVpcmUgY2hhaW4uXG4gICAgICAgIGlmIChwcmV2aW91c1JlcXVpcmUpIHJldHVybiBwcmV2aW91c1JlcXVpcmUobmFtZSwgdHJ1ZSk7XG5cbiAgICAgICAgLy8gVHJ5IHRvIGZpbmQgbW9kdWxlIGZyb20gZ2xvYmFsIHNjb3BlXG4gICAgICAgIGlmIChnbG9iYWxOU1tuYW1lXSAmJiB0eXBlb2Ygd2luZG93W2dsb2JhbE5TW25hbWVdXSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICByZXR1cm4gd2luZG93W2dsb2JhbE5TW25hbWVdXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBlcnIgPSBuZXcgRXJyb3IoJ0Nhbm5vdCBmaW5kIG1vZHVsZSBcXCcnICsgbmFtZSArICdcXCcnKTtcbiAgICAgICAgZXJyLmNvZGUgPSAnTU9EVUxFX05PVF9GT1VORCc7XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH1cbiAgICAgIHZhciBtID0gY2FjaGVbbmFtZV0gPSB7ZXhwb3J0czp7fX07XG4gICAgICBtb2R1bGVzW25hbWVdWzBdLmNhbGwobS5leHBvcnRzLCBmdW5jdGlvbih4KXtcbiAgICAgICAgdmFyIGlkID0gbW9kdWxlc1tuYW1lXVsxXVt4XTtcbiAgICAgICAgcmV0dXJuIG5ld1JlcXVpcmUoaWQgPyBpZCA6IHgpO1xuICAgICAgfSxtLG0uZXhwb3J0cyxvdXRlcixtb2R1bGVzLGNhY2hlLGVudHJ5KTtcbiAgICB9XG5cbiAgICByZXR1cm4gY2FjaGVbbmFtZV0uZXhwb3J0cztcbiAgfVxuICBmb3IodmFyIGk9MDtpPGVudHJ5Lmxlbmd0aDtpKyspIG5ld1JlcXVpcmUoZW50cnlbaV0pO1xuXG4gIC8vIE92ZXJyaWRlIHRoZSBjdXJyZW50IHJlcXVpcmUgd2l0aCB0aGlzIG5ldyBvbmVcbiAgcmV0dXJuIG5ld1JlcXVpcmU7XG59KVxuKHsxOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblxufSx7fV0sMjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5pZiAod2luZG93LmpRdWVyeSkge1xuICAoZnVuY3Rpb24gKCQpIHtcbiAgICAkLmZuLmhhbmRzb250YWJsZSA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgIHZhciBpLFxuICAgICAgICBpbGVuLFxuICAgICAgICBhcmdzLFxuICAgICAgICBvdXRwdXQsXG4gICAgICAgIHVzZXJTZXR0aW5ncyxcbiAgICAgICAgJHRoaXMgPSB0aGlzLmZpcnN0KCksIC8vIFVzZSBvbmx5IGZpcnN0IGVsZW1lbnQgZnJvbSBsaXN0XG4gICAgICAgIGluc3RhbmNlID0gJHRoaXMuZGF0YSgnaGFuZHNvbnRhYmxlJyk7XG5cbiAgICAgIC8vIEluaXQgY2FzZVxuICAgICAgaWYgKHR5cGVvZiBhY3Rpb24gIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHVzZXJTZXR0aW5ncyA9IGFjdGlvbiB8fCB7fTtcblxuICAgICAgICBpZiAoaW5zdGFuY2UpIHtcbiAgICAgICAgICBpbnN0YW5jZS51cGRhdGVTZXR0aW5ncyh1c2VyU2V0dGluZ3MpO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaW5zdGFuY2UgPSBuZXcgSGFuZHNvbnRhYmxlLkNvcmUoJHRoaXNbMF0sIHVzZXJTZXR0aW5ncyk7XG4gICAgICAgICAgJHRoaXMuZGF0YSgnaGFuZHNvbnRhYmxlJywgaW5zdGFuY2UpO1xuICAgICAgICAgIGluc3RhbmNlLmluaXQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAkdGhpcztcblxuICAgICAgfSBlbHNlIHsgLy8gQWN0aW9uIGNhc2VcbiAgICAgICAgYXJncyA9IFtdO1xuXG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICAgIGZvciAoaSA9IDEsIGlsZW4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWxlbjsgaSsrKSB7XG4gICAgICAgICAgICBhcmdzLnB1c2goYXJndW1lbnRzW2ldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaW5zdGFuY2UpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIGluc3RhbmNlW2FjdGlvbl0gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBvdXRwdXQgPSBpbnN0YW5jZVthY3Rpb25dLmFwcGx5KGluc3RhbmNlLCBhcmdzKTtcblxuICAgICAgICAgICAgaWYgKGFjdGlvbiA9PT0gJ2Rlc3Ryb3knKSB7XG4gICAgICAgICAgICAgICR0aGlzLnJlbW92ZURhdGEoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0hhbmRzb250YWJsZSBkbyBub3QgcHJvdmlkZSBhY3Rpb246ICcgKyBhY3Rpb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICB9XG4gICAgfTtcbiAgfSkod2luZG93LmpRdWVyeSk7XG59XG5cblxuXG59LHt9XSwzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBXYWxrb250YWJsZUJvcmRlcjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gV2Fsa29udGFibGVCb3JkZXI7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYnJvd3Nlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fLFxuICAgICRfX2NlbGxfNDdfY29vcmRzX18sXG4gICAgJF9fb3ZlcmxheV80N19fOTVfYmFzZV80Nl9qc19fO1xudmFyICRfXzAgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLFxuICAgIGdldENvbXB1dGVkU3R5bGUgPSAkX18wLmdldENvbXB1dGVkU3R5bGUsXG4gICAgZ2V0VHJpbW1pbmdDb250YWluZXIgPSAkX18wLmdldFRyaW1taW5nQ29udGFpbmVyLFxuICAgIGlubmVyV2lkdGggPSAkX18wLmlubmVyV2lkdGgsXG4gICAgaW5uZXJIZWlnaHQgPSAkX18wLmlubmVySGVpZ2h0LFxuICAgIG9mZnNldCA9ICRfXzAub2Zmc2V0LFxuICAgIG91dGVySGVpZ2h0ID0gJF9fMC5vdXRlckhlaWdodCxcbiAgICBvdXRlcldpZHRoID0gJF9fMC5vdXRlcldpZHRoO1xudmFyIHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2V2ZW50XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9ffSkuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uO1xudmFyIGlzTW9iaWxlQnJvd3NlciA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2Jyb3dzZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYnJvd3Nlcl9ffSkuaXNNb2JpbGVCcm93c2VyO1xudmFyIEV2ZW50TWFuYWdlciA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyA9IF9kZXJlcV8oXCJldmVudE1hbmFnZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9ffSkuRXZlbnRNYW5hZ2VyO1xudmFyIFdhbGtvbnRhYmxlQ2VsbENvb3JkcyA9ICgkX19jZWxsXzQ3X2Nvb3Jkc19fID0gX2RlcmVxXyhcImNlbGwvY29vcmRzXCIpLCAkX19jZWxsXzQ3X2Nvb3Jkc19fICYmICRfX2NlbGxfNDdfY29vcmRzX18uX19lc01vZHVsZSAmJiAkX19jZWxsXzQ3X2Nvb3Jkc19fIHx8IHtkZWZhdWx0OiAkX19jZWxsXzQ3X2Nvb3Jkc19ffSkuV2Fsa29udGFibGVDZWxsQ29vcmRzO1xudmFyIFdhbGtvbnRhYmxlT3ZlcmxheSA9ICgkX19vdmVybGF5XzQ3X185NV9iYXNlXzQ2X2pzX18gPSBfZGVyZXFfKFwib3ZlcmxheS9fYmFzZS5qc1wiKSwgJF9fb3ZlcmxheV80N19fOTVfYmFzZV80Nl9qc19fICYmICRfX292ZXJsYXlfNDdfXzk1X2Jhc2VfNDZfanNfXy5fX2VzTW9kdWxlICYmICRfX292ZXJsYXlfNDdfXzk1X2Jhc2VfNDZfanNfXyB8fCB7ZGVmYXVsdDogJF9fb3ZlcmxheV80N19fOTVfYmFzZV80Nl9qc19ffSkuV2Fsa29udGFibGVPdmVybGF5O1xudmFyIFdhbGtvbnRhYmxlQm9yZGVyID0gZnVuY3Rpb24gV2Fsa29udGFibGVCb3JkZXIod290SW5zdGFuY2UsIHNldHRpbmdzKSB7XG4gIGlmICghc2V0dGluZ3MpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdGhpcy5ldmVudE1hbmFnZXIgPSBuZXcgRXZlbnRNYW5hZ2VyKHdvdEluc3RhbmNlKTtcbiAgdGhpcy5pbnN0YW5jZSA9IHdvdEluc3RhbmNlO1xuICB0aGlzLndvdCA9IHdvdEluc3RhbmNlO1xuICB0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG4gIHRoaXMubW91c2VEb3duID0gZmFsc2U7XG4gIHRoaXMubWFpbiA9IG51bGw7XG4gIHRoaXMudG9wID0gbnVsbDtcbiAgdGhpcy5sZWZ0ID0gbnVsbDtcbiAgdGhpcy5ib3R0b20gPSBudWxsO1xuICB0aGlzLnJpZ2h0ID0gbnVsbDtcbiAgdGhpcy50b3BTdHlsZSA9IG51bGw7XG4gIHRoaXMubGVmdFN0eWxlID0gbnVsbDtcbiAgdGhpcy5ib3R0b21TdHlsZSA9IG51bGw7XG4gIHRoaXMucmlnaHRTdHlsZSA9IG51bGw7XG4gIHRoaXMuY29ybmVyRGVmYXVsdFN0eWxlID0ge1xuICAgIHdpZHRoOiAnNXB4JyxcbiAgICBoZWlnaHQ6ICc1cHgnLFxuICAgIGJvcmRlcldpZHRoOiAnMnB4JyxcbiAgICBib3JkZXJTdHlsZTogJ3NvbGlkJyxcbiAgICBib3JkZXJDb2xvcjogJyNGRkYnXG4gIH07XG4gIHRoaXMuY29ybmVyID0gbnVsbDtcbiAgdGhpcy5jb3JuZXJTdHlsZSA9IG51bGw7XG4gIHRoaXMuY3JlYXRlQm9yZGVycyhzZXR0aW5ncyk7XG4gIHRoaXMucmVnaXN0ZXJMaXN0ZW5lcnMoKTtcbn07XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShXYWxrb250YWJsZUJvcmRlciwge1xuICByZWdpc3Rlckxpc3RlbmVyczogZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzYgPSB0aGlzO1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQuYm9keSwgJ21vdXNlZG93bicsIChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX182Lm9uTW91c2VEb3duKCk7XG4gICAgfSkpO1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQuYm9keSwgJ21vdXNldXAnLCAoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fNi5vbk1vdXNlVXAoKTtcbiAgICB9KSk7XG4gICAgdmFyICRfXzggPSB0aGlzLFxuICAgICAgICAkX185ID0gZnVuY3Rpb24oYywgbGVuKSB7XG4gICAgICAgICAgJF9fOC5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcigkX184Lm1haW4uY2hpbGROb2Rlc1tjXSwgJ21vdXNlZW50ZXInLCAoZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgIHJldHVybiAkX182Lm9uTW91c2VFbnRlcihldmVudCwgJF9fNi5tYWluLmNoaWxkTm9kZXNbY10pO1xuICAgICAgICAgIH0pKTtcbiAgICAgICAgfTtcbiAgICBmb3IgKHZhciBjID0gMCxcbiAgICAgICAgbGVuID0gdGhpcy5tYWluLmNoaWxkTm9kZXMubGVuZ3RoOyBjIDwgbGVuOyBjKyspIHtcbiAgICAgICRfXzkoYywgbGVuKTtcbiAgICB9XG4gIH0sXG4gIG9uTW91c2VEb3duOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLm1vdXNlRG93biA9IHRydWU7XG4gIH0sXG4gIG9uTW91c2VVcDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5tb3VzZURvd24gPSBmYWxzZTtcbiAgfSxcbiAgb25Nb3VzZUVudGVyOiBmdW5jdGlvbihldmVudCwgcGFyZW50RWxlbWVudCkge1xuICAgIGlmICghdGhpcy5tb3VzZURvd24gfHwgIXRoaXMud290LmdldFNldHRpbmcoJ2hpZGVCb3JkZXJPbk1vdXNlRG93bk92ZXInKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbihldmVudCk7XG4gICAgdmFyIF90aGlzID0gdGhpcztcbiAgICB2YXIgYm91bmRzID0gcGFyZW50RWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBwYXJlbnRFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgZnVuY3Rpb24gaXNPdXRzaWRlKGV2ZW50KSB7XG4gICAgICBpZiAoZXZlbnQuY2xpZW50WSA8IE1hdGguZmxvb3IoYm91bmRzLnRvcCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICBpZiAoZXZlbnQuY2xpZW50WSA+IE1hdGguY2VpbChib3VuZHMudG9wICsgYm91bmRzLmhlaWdodCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICBpZiAoZXZlbnQuY2xpZW50WCA8IE1hdGguZmxvb3IoYm91bmRzLmxlZnQpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgICAgaWYgKGV2ZW50LmNsaWVudFggPiBNYXRoLmNlaWwoYm91bmRzLmxlZnQgKyBib3VuZHMud2lkdGgpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBoYW5kbGVyKGV2ZW50KSB7XG4gICAgICBpZiAoaXNPdXRzaWRlKGV2ZW50KSkge1xuICAgICAgICBfdGhpcy5ldmVudE1hbmFnZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcihkb2N1bWVudC5ib2R5LCAnbW91c2Vtb3ZlJywgaGFuZGxlcik7XG4gICAgICAgIHBhcmVudEVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQuYm9keSwgJ21vdXNlbW92ZScsIGhhbmRsZXIpO1xuICB9LFxuICBjcmVhdGVCb3JkZXJzOiBmdW5jdGlvbihzZXR0aW5ncykge1xuICAgIHRoaXMubWFpbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHZhciBib3JkZXJEaXZzID0gWyd0b3AnLCAnbGVmdCcsICdib3R0b20nLCAncmlnaHQnLCAnY29ybmVyJ107XG4gICAgdmFyIHN0eWxlID0gdGhpcy5tYWluLnN0eWxlO1xuICAgIHN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICBzdHlsZS50b3AgPSAwO1xuICAgIHN0eWxlLmxlZnQgPSAwO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTsgaSsrKSB7XG4gICAgICB2YXIgcG9zaXRpb24gPSBib3JkZXJEaXZzW2ldO1xuICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgZGl2LmNsYXNzTmFtZSA9ICd3dEJvcmRlciAnICsgKHRoaXMuc2V0dGluZ3MuY2xhc3NOYW1lIHx8ICcnKTtcbiAgICAgIGlmICh0aGlzLnNldHRpbmdzW3Bvc2l0aW9uXSAmJiB0aGlzLnNldHRpbmdzW3Bvc2l0aW9uXS5oaWRlKSB7XG4gICAgICAgIGRpdi5jbGFzc05hbWUgKz0gJyBoaWRkZW4nO1xuICAgICAgfVxuICAgICAgc3R5bGUgPSBkaXYuc3R5bGU7XG4gICAgICBzdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAodGhpcy5zZXR0aW5nc1twb3NpdGlvbl0gJiYgdGhpcy5zZXR0aW5nc1twb3NpdGlvbl0uY29sb3IpID8gdGhpcy5zZXR0aW5nc1twb3NpdGlvbl0uY29sb3IgOiBzZXR0aW5ncy5ib3JkZXIuY29sb3I7XG4gICAgICBzdHlsZS5oZWlnaHQgPSAodGhpcy5zZXR0aW5nc1twb3NpdGlvbl0gJiYgdGhpcy5zZXR0aW5nc1twb3NpdGlvbl0ud2lkdGgpID8gdGhpcy5zZXR0aW5nc1twb3NpdGlvbl0ud2lkdGggKyAncHgnIDogc2V0dGluZ3MuYm9yZGVyLndpZHRoICsgJ3B4JztcbiAgICAgIHN0eWxlLndpZHRoID0gKHRoaXMuc2V0dGluZ3NbcG9zaXRpb25dICYmIHRoaXMuc2V0dGluZ3NbcG9zaXRpb25dLndpZHRoKSA/IHRoaXMuc2V0dGluZ3NbcG9zaXRpb25dLndpZHRoICsgJ3B4JyA6IHNldHRpbmdzLmJvcmRlci53aWR0aCArICdweCc7XG4gICAgICB0aGlzLm1haW4uYXBwZW5kQ2hpbGQoZGl2KTtcbiAgICB9XG4gICAgdGhpcy50b3AgPSB0aGlzLm1haW4uY2hpbGROb2Rlc1swXTtcbiAgICB0aGlzLmxlZnQgPSB0aGlzLm1haW4uY2hpbGROb2Rlc1sxXTtcbiAgICB0aGlzLmJvdHRvbSA9IHRoaXMubWFpbi5jaGlsZE5vZGVzWzJdO1xuICAgIHRoaXMucmlnaHQgPSB0aGlzLm1haW4uY2hpbGROb2Rlc1szXTtcbiAgICB0aGlzLnRvcFN0eWxlID0gdGhpcy50b3Auc3R5bGU7XG4gICAgdGhpcy5sZWZ0U3R5bGUgPSB0aGlzLmxlZnQuc3R5bGU7XG4gICAgdGhpcy5ib3R0b21TdHlsZSA9IHRoaXMuYm90dG9tLnN0eWxlO1xuICAgIHRoaXMucmlnaHRTdHlsZSA9IHRoaXMucmlnaHQuc3R5bGU7XG4gICAgdGhpcy5jb3JuZXIgPSB0aGlzLm1haW4uY2hpbGROb2Rlc1s0XTtcbiAgICB0aGlzLmNvcm5lci5jbGFzc05hbWUgKz0gJyBjb3JuZXInO1xuICAgIHRoaXMuY29ybmVyU3R5bGUgPSB0aGlzLmNvcm5lci5zdHlsZTtcbiAgICB0aGlzLmNvcm5lclN0eWxlLndpZHRoID0gdGhpcy5jb3JuZXJEZWZhdWx0U3R5bGUud2lkdGg7XG4gICAgdGhpcy5jb3JuZXJTdHlsZS5oZWlnaHQgPSB0aGlzLmNvcm5lckRlZmF1bHRTdHlsZS5oZWlnaHQ7XG4gICAgdGhpcy5jb3JuZXJTdHlsZS5ib3JkZXIgPSBbdGhpcy5jb3JuZXJEZWZhdWx0U3R5bGUuYm9yZGVyV2lkdGgsIHRoaXMuY29ybmVyRGVmYXVsdFN0eWxlLmJvcmRlclN0eWxlLCB0aGlzLmNvcm5lckRlZmF1bHRTdHlsZS5ib3JkZXJDb2xvcl0uam9pbignICcpO1xuICAgIGlmIChpc01vYmlsZUJyb3dzZXIoKSkge1xuICAgICAgdGhpcy5jcmVhdGVNdWx0aXBsZVNlbGVjdG9ySGFuZGxlcygpO1xuICAgIH1cbiAgICB0aGlzLmRpc2FwcGVhcigpO1xuICAgIGlmICghdGhpcy53b3Qud3RUYWJsZS5ib3JkZXJzSG9sZGVyKSB7XG4gICAgICB0aGlzLndvdC53dFRhYmxlLmJvcmRlcnNIb2xkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIHRoaXMud290Lnd0VGFibGUuYm9yZGVyc0hvbGRlci5jbGFzc05hbWUgPSAnaHRCb3JkZXJzJztcbiAgICAgIHRoaXMud290Lnd0VGFibGUuc3ByZWFkZXIuYXBwZW5kQ2hpbGQodGhpcy53b3Qud3RUYWJsZS5ib3JkZXJzSG9sZGVyKTtcbiAgICB9XG4gICAgdGhpcy53b3Qud3RUYWJsZS5ib3JkZXJzSG9sZGVyLmluc2VydEJlZm9yZSh0aGlzLm1haW4sIHRoaXMud290Lnd0VGFibGUuYm9yZGVyc0hvbGRlci5maXJzdENoaWxkKTtcbiAgfSxcbiAgY3JlYXRlTXVsdGlwbGVTZWxlY3RvckhhbmRsZXM6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc2VsZWN0aW9uSGFuZGxlcyA9IHtcbiAgICAgIHRvcExlZnQ6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0RJVicpLFxuICAgICAgdG9wTGVmdEhpdEFyZWE6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0RJVicpLFxuICAgICAgYm90dG9tUmlnaHQ6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0RJVicpLFxuICAgICAgYm90dG9tUmlnaHRIaXRBcmVhOiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKVxuICAgIH07XG4gICAgdmFyIHdpZHRoID0gMTA7XG4gICAgdmFyIGhpdEFyZWFXaWR0aCA9IDQwO1xuICAgIHRoaXMuc2VsZWN0aW9uSGFuZGxlcy50b3BMZWZ0LmNsYXNzTmFtZSA9ICd0b3BMZWZ0U2VsZWN0aW9uSGFuZGxlJztcbiAgICB0aGlzLnNlbGVjdGlvbkhhbmRsZXMudG9wTGVmdEhpdEFyZWEuY2xhc3NOYW1lID0gJ3RvcExlZnRTZWxlY3Rpb25IYW5kbGUtSGl0QXJlYSc7XG4gICAgdGhpcy5zZWxlY3Rpb25IYW5kbGVzLmJvdHRvbVJpZ2h0LmNsYXNzTmFtZSA9ICdib3R0b21SaWdodFNlbGVjdGlvbkhhbmRsZSc7XG4gICAgdGhpcy5zZWxlY3Rpb25IYW5kbGVzLmJvdHRvbVJpZ2h0SGl0QXJlYS5jbGFzc05hbWUgPSAnYm90dG9tUmlnaHRTZWxlY3Rpb25IYW5kbGUtSGl0QXJlYSc7XG4gICAgdGhpcy5zZWxlY3Rpb25IYW5kbGVzLnN0eWxlcyA9IHtcbiAgICAgIHRvcExlZnQ6IHRoaXMuc2VsZWN0aW9uSGFuZGxlcy50b3BMZWZ0LnN0eWxlLFxuICAgICAgdG9wTGVmdEhpdEFyZWE6IHRoaXMuc2VsZWN0aW9uSGFuZGxlcy50b3BMZWZ0SGl0QXJlYS5zdHlsZSxcbiAgICAgIGJvdHRvbVJpZ2h0OiB0aGlzLnNlbGVjdGlvbkhhbmRsZXMuYm90dG9tUmlnaHQuc3R5bGUsXG4gICAgICBib3R0b21SaWdodEhpdEFyZWE6IHRoaXMuc2VsZWN0aW9uSGFuZGxlcy5ib3R0b21SaWdodEhpdEFyZWEuc3R5bGVcbiAgICB9O1xuICAgIHZhciBoaXRBcmVhU3R5bGUgPSB7XG4gICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgIGhlaWdodDogaGl0QXJlYVdpZHRoICsgJ3B4JyxcbiAgICAgIHdpZHRoOiBoaXRBcmVhV2lkdGggKyAncHgnLFxuICAgICAgJ2JvcmRlci1yYWRpdXMnOiBwYXJzZUludChoaXRBcmVhV2lkdGggLyAxLjUsIDEwKSArICdweCdcbiAgICB9O1xuICAgIGZvciAodmFyIHByb3AgaW4gaGl0QXJlYVN0eWxlKSB7XG4gICAgICBpZiAoaGl0QXJlYVN0eWxlLmhhc093blByb3BlcnR5KHByb3ApKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uSGFuZGxlcy5zdHlsZXMuYm90dG9tUmlnaHRIaXRBcmVhW3Byb3BdID0gaGl0QXJlYVN0eWxlW3Byb3BdO1xuICAgICAgICB0aGlzLnNlbGVjdGlvbkhhbmRsZXMuc3R5bGVzLnRvcExlZnRIaXRBcmVhW3Byb3BdID0gaGl0QXJlYVN0eWxlW3Byb3BdO1xuICAgICAgfVxuICAgIH1cbiAgICB2YXIgaGFuZGxlU3R5bGUgPSB7XG4gICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgIGhlaWdodDogd2lkdGggKyAncHgnLFxuICAgICAgd2lkdGg6IHdpZHRoICsgJ3B4JyxcbiAgICAgICdib3JkZXItcmFkaXVzJzogcGFyc2VJbnQod2lkdGggLyAxLjUsIDEwKSArICdweCcsXG4gICAgICBiYWNrZ3JvdW5kOiAnI0Y1RjVGRicsXG4gICAgICBib3JkZXI6ICcxcHggc29saWQgIzQyODVjOCdcbiAgICB9O1xuICAgIGZvciAodmFyIHByb3AkX18xMCBpbiBoYW5kbGVTdHlsZSkge1xuICAgICAgaWYgKGhhbmRsZVN0eWxlLmhhc093blByb3BlcnR5KHByb3AkX18xMCkpIHtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25IYW5kbGVzLnN0eWxlcy5ib3R0b21SaWdodFtwcm9wJF9fMTBdID0gaGFuZGxlU3R5bGVbcHJvcCRfXzEwXTtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25IYW5kbGVzLnN0eWxlcy50b3BMZWZ0W3Byb3AkX18xMF0gPSBoYW5kbGVTdHlsZVtwcm9wJF9fMTBdO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLm1haW4uYXBwZW5kQ2hpbGQodGhpcy5zZWxlY3Rpb25IYW5kbGVzLnRvcExlZnQpO1xuICAgIHRoaXMubWFpbi5hcHBlbmRDaGlsZCh0aGlzLnNlbGVjdGlvbkhhbmRsZXMuYm90dG9tUmlnaHQpO1xuICAgIHRoaXMubWFpbi5hcHBlbmRDaGlsZCh0aGlzLnNlbGVjdGlvbkhhbmRsZXMudG9wTGVmdEhpdEFyZWEpO1xuICAgIHRoaXMubWFpbi5hcHBlbmRDaGlsZCh0aGlzLnNlbGVjdGlvbkhhbmRsZXMuYm90dG9tUmlnaHRIaXRBcmVhKTtcbiAgfSxcbiAgaXNQYXJ0UmFuZ2U6IGZ1bmN0aW9uKHJvdywgY29sKSB7XG4gICAgaWYgKHRoaXMud290LnNlbGVjdGlvbnMuYXJlYS5jZWxsUmFuZ2UpIHtcbiAgICAgIGlmIChyb3cgIT0gdGhpcy53b3Quc2VsZWN0aW9ucy5hcmVhLmNlbGxSYW5nZS50by5yb3cgfHwgY29sICE9IHRoaXMud290LnNlbGVjdGlvbnMuYXJlYS5jZWxsUmFuZ2UudG8uY29sKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG4gIHVwZGF0ZU11bHRpcGxlU2VsZWN0aW9uSGFuZGxlc1Bvc2l0aW9uOiBmdW5jdGlvbihyb3csIGNvbCwgdG9wLCBsZWZ0LCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgdmFyIGhhbmRsZVdpZHRoID0gcGFyc2VJbnQodGhpcy5zZWxlY3Rpb25IYW5kbGVzLnN0eWxlcy50b3BMZWZ0LndpZHRoLCAxMCk7XG4gICAgdmFyIGhpdEFyZWFXaWR0aCA9IHBhcnNlSW50KHRoaXMuc2VsZWN0aW9uSGFuZGxlcy5zdHlsZXMudG9wTGVmdEhpdEFyZWEud2lkdGgsIDEwKTtcbiAgICB0aGlzLnNlbGVjdGlvbkhhbmRsZXMuc3R5bGVzLnRvcExlZnQudG9wID0gcGFyc2VJbnQodG9wIC0gaGFuZGxlV2lkdGgsIDEwKSArICdweCc7XG4gICAgdGhpcy5zZWxlY3Rpb25IYW5kbGVzLnN0eWxlcy50b3BMZWZ0LmxlZnQgPSBwYXJzZUludChsZWZ0IC0gaGFuZGxlV2lkdGgsIDEwKSArICdweCc7XG4gICAgdGhpcy5zZWxlY3Rpb25IYW5kbGVzLnN0eWxlcy50b3BMZWZ0SGl0QXJlYS50b3AgPSBwYXJzZUludCh0b3AgLSAoaGl0QXJlYVdpZHRoIC8gNCkgKiAzLCAxMCkgKyAncHgnO1xuICAgIHRoaXMuc2VsZWN0aW9uSGFuZGxlcy5zdHlsZXMudG9wTGVmdEhpdEFyZWEubGVmdCA9IHBhcnNlSW50KGxlZnQgLSAoaGl0QXJlYVdpZHRoIC8gNCkgKiAzLCAxMCkgKyAncHgnO1xuICAgIHRoaXMuc2VsZWN0aW9uSGFuZGxlcy5zdHlsZXMuYm90dG9tUmlnaHQudG9wID0gcGFyc2VJbnQodG9wICsgaGVpZ2h0LCAxMCkgKyAncHgnO1xuICAgIHRoaXMuc2VsZWN0aW9uSGFuZGxlcy5zdHlsZXMuYm90dG9tUmlnaHQubGVmdCA9IHBhcnNlSW50KGxlZnQgKyB3aWR0aCwgMTApICsgJ3B4JztcbiAgICB0aGlzLnNlbGVjdGlvbkhhbmRsZXMuc3R5bGVzLmJvdHRvbVJpZ2h0SGl0QXJlYS50b3AgPSBwYXJzZUludCh0b3AgKyBoZWlnaHQgLSBoaXRBcmVhV2lkdGggLyA0LCAxMCkgKyAncHgnO1xuICAgIHRoaXMuc2VsZWN0aW9uSGFuZGxlcy5zdHlsZXMuYm90dG9tUmlnaHRIaXRBcmVhLmxlZnQgPSBwYXJzZUludChsZWZ0ICsgd2lkdGggLSBoaXRBcmVhV2lkdGggLyA0LCAxMCkgKyAncHgnO1xuICAgIGlmICh0aGlzLnNldHRpbmdzLmJvcmRlci5tdWx0aXBsZVNlbGVjdGlvbkhhbmRsZXNWaXNpYmxlICYmIHRoaXMuc2V0dGluZ3MuYm9yZGVyLm11bHRpcGxlU2VsZWN0aW9uSGFuZGxlc1Zpc2libGUoKSkge1xuICAgICAgdGhpcy5zZWxlY3Rpb25IYW5kbGVzLnN0eWxlcy50b3BMZWZ0LmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgdGhpcy5zZWxlY3Rpb25IYW5kbGVzLnN0eWxlcy50b3BMZWZ0SGl0QXJlYS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgIGlmICh0aGlzLmlzUGFydFJhbmdlKHJvdywgY29sKSkge1xuICAgICAgICB0aGlzLnNlbGVjdGlvbkhhbmRsZXMuc3R5bGVzLmJvdHRvbVJpZ2h0LmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uSGFuZGxlcy5zdHlsZXMuYm90dG9tUmlnaHRIaXRBcmVhLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnNlbGVjdGlvbkhhbmRsZXMuc3R5bGVzLmJvdHRvbVJpZ2h0LmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICB0aGlzLnNlbGVjdGlvbkhhbmRsZXMuc3R5bGVzLmJvdHRvbVJpZ2h0SGl0QXJlYS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zZWxlY3Rpb25IYW5kbGVzLnN0eWxlcy50b3BMZWZ0LmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICB0aGlzLnNlbGVjdGlvbkhhbmRsZXMuc3R5bGVzLmJvdHRvbVJpZ2h0LmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICB0aGlzLnNlbGVjdGlvbkhhbmRsZXMuc3R5bGVzLnRvcExlZnRIaXRBcmVhLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICB0aGlzLnNlbGVjdGlvbkhhbmRsZXMuc3R5bGVzLmJvdHRvbVJpZ2h0SGl0QXJlYS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIH1cbiAgICBpZiAocm93ID09IHRoaXMud290Lnd0U2V0dGluZ3MuZ2V0U2V0dGluZygnZml4ZWRSb3dzVG9wJykgfHwgY29sID09IHRoaXMud290Lnd0U2V0dGluZ3MuZ2V0U2V0dGluZygnZml4ZWRDb2x1bW5zTGVmdCcpKSB7XG4gICAgICB0aGlzLnNlbGVjdGlvbkhhbmRsZXMuc3R5bGVzLnRvcExlZnQuekluZGV4ID0gJzk5OTknO1xuICAgICAgdGhpcy5zZWxlY3Rpb25IYW5kbGVzLnN0eWxlcy50b3BMZWZ0SGl0QXJlYS56SW5kZXggPSAnOTk5OSc7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2VsZWN0aW9uSGFuZGxlcy5zdHlsZXMudG9wTGVmdC56SW5kZXggPSAnJztcbiAgICAgIHRoaXMuc2VsZWN0aW9uSGFuZGxlcy5zdHlsZXMudG9wTGVmdEhpdEFyZWEuekluZGV4ID0gJyc7XG4gICAgfVxuICB9LFxuICBhcHBlYXI6IGZ1bmN0aW9uKGNvcm5lcnMpIHtcbiAgICBpZiAodGhpcy5kaXNhYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgaXNNdWx0aXBsZSxcbiAgICAgICAgZnJvbVRELFxuICAgICAgICB0b1RELFxuICAgICAgICBmcm9tT2Zmc2V0LFxuICAgICAgICB0b09mZnNldCxcbiAgICAgICAgY29udGFpbmVyT2Zmc2V0LFxuICAgICAgICB0b3AsXG4gICAgICAgIG1pblRvcCxcbiAgICAgICAgbGVmdCxcbiAgICAgICAgbWluTGVmdCxcbiAgICAgICAgaGVpZ2h0LFxuICAgICAgICB3aWR0aCxcbiAgICAgICAgZnJvbVJvdyxcbiAgICAgICAgZnJvbUNvbHVtbixcbiAgICAgICAgdG9Sb3csXG4gICAgICAgIHRvQ29sdW1uLFxuICAgICAgICB0cmltbWluZ0NvbnRhaW5lcixcbiAgICAgICAgY29ybmVyT3ZlcmxhcHBpbmdDb250YWluZXIsXG4gICAgICAgIGlsZW47XG4gICAgaWxlbiA9IHRoaXMud290Lnd0VGFibGUuZ2V0UmVuZGVyZWRSb3dzQ291bnQoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGlsZW47IGkrKykge1xuICAgICAgdmFyIHMgPSB0aGlzLndvdC53dFRhYmxlLnJvd0ZpbHRlci5yZW5kZXJlZFRvU291cmNlKGkpO1xuICAgICAgaWYgKHMgPj0gY29ybmVyc1swXSAmJiBzIDw9IGNvcm5lcnNbMl0pIHtcbiAgICAgICAgZnJvbVJvdyA9IHM7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICBmb3IgKHZhciBpJF9fMTEgPSBpbGVuIC0gMTsgaSRfXzExID49IDA7IGkkX18xMS0tKSB7XG4gICAgICB2YXIgcyRfXzEyID0gdGhpcy53b3Qud3RUYWJsZS5yb3dGaWx0ZXIucmVuZGVyZWRUb1NvdXJjZShpJF9fMTEpO1xuICAgICAgaWYgKHMkX18xMiA+PSBjb3JuZXJzWzBdICYmIHMkX18xMiA8PSBjb3JuZXJzWzJdKSB7XG4gICAgICAgIHRvUm93ID0gcyRfXzEyO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgaWxlbiA9IHRoaXMud290Lnd0VGFibGUuZ2V0UmVuZGVyZWRDb2x1bW5zQ291bnQoKTtcbiAgICBmb3IgKHZhciBpJF9fMTMgPSAwOyBpJF9fMTMgPCBpbGVuOyBpJF9fMTMrKykge1xuICAgICAgdmFyIHMkX18xNCA9IHRoaXMud290Lnd0VGFibGUuY29sdW1uRmlsdGVyLnJlbmRlcmVkVG9Tb3VyY2UoaSRfXzEzKTtcbiAgICAgIGlmIChzJF9fMTQgPj0gY29ybmVyc1sxXSAmJiBzJF9fMTQgPD0gY29ybmVyc1szXSkge1xuICAgICAgICBmcm9tQ29sdW1uID0gcyRfXzE0O1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgZm9yICh2YXIgaSRfXzE1ID0gaWxlbiAtIDE7IGkkX18xNSA+PSAwOyBpJF9fMTUtLSkge1xuICAgICAgdmFyIHMkX18xNiA9IHRoaXMud290Lnd0VGFibGUuY29sdW1uRmlsdGVyLnJlbmRlcmVkVG9Tb3VyY2UoaSRfXzE1KTtcbiAgICAgIGlmIChzJF9fMTYgPj0gY29ybmVyc1sxXSAmJiBzJF9fMTYgPD0gY29ybmVyc1szXSkge1xuICAgICAgICB0b0NvbHVtbiA9IHMkX18xNjtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChmcm9tUm93ID09PSB2b2lkIDAgfHwgZnJvbUNvbHVtbiA9PT0gdm9pZCAwKSB7XG4gICAgICB0aGlzLmRpc2FwcGVhcigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpc011bHRpcGxlID0gKGZyb21Sb3cgIT09IHRvUm93IHx8IGZyb21Db2x1bW4gIT09IHRvQ29sdW1uKTtcbiAgICBmcm9tVEQgPSB0aGlzLndvdC53dFRhYmxlLmdldENlbGwobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3Jkcyhmcm9tUm93LCBmcm9tQ29sdW1uKSk7XG4gICAgdG9URCA9IGlzTXVsdGlwbGUgPyB0aGlzLndvdC53dFRhYmxlLmdldENlbGwobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3Jkcyh0b1JvdywgdG9Db2x1bW4pKSA6IGZyb21URDtcbiAgICBmcm9tT2Zmc2V0ID0gb2Zmc2V0KGZyb21URCk7XG4gICAgdG9PZmZzZXQgPSBpc011bHRpcGxlID8gb2Zmc2V0KHRvVEQpIDogZnJvbU9mZnNldDtcbiAgICBjb250YWluZXJPZmZzZXQgPSBvZmZzZXQodGhpcy53b3Qud3RUYWJsZS5UQUJMRSk7XG4gICAgbWluVG9wID0gZnJvbU9mZnNldC50b3A7XG4gICAgaGVpZ2h0ID0gdG9PZmZzZXQudG9wICsgb3V0ZXJIZWlnaHQodG9URCkgLSBtaW5Ub3A7XG4gICAgbWluTGVmdCA9IGZyb21PZmZzZXQubGVmdDtcbiAgICB3aWR0aCA9IHRvT2Zmc2V0LmxlZnQgKyBvdXRlcldpZHRoKHRvVEQpIC0gbWluTGVmdDtcbiAgICB0b3AgPSBtaW5Ub3AgLSBjb250YWluZXJPZmZzZXQudG9wIC0gMTtcbiAgICBsZWZ0ID0gbWluTGVmdCAtIGNvbnRhaW5lck9mZnNldC5sZWZ0IC0gMTtcbiAgICB2YXIgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKGZyb21URCk7XG4gICAgaWYgKHBhcnNlSW50KHN0eWxlLmJvcmRlclRvcFdpZHRoLCAxMCkgPiAwKSB7XG4gICAgICB0b3AgKz0gMTtcbiAgICAgIGhlaWdodCA9IGhlaWdodCA+IDAgPyBoZWlnaHQgLSAxIDogMDtcbiAgICB9XG4gICAgaWYgKHBhcnNlSW50KHN0eWxlLmJvcmRlckxlZnRXaWR0aCwgMTApID4gMCkge1xuICAgICAgbGVmdCArPSAxO1xuICAgICAgd2lkdGggPSB3aWR0aCA+IDAgPyB3aWR0aCAtIDEgOiAwO1xuICAgIH1cbiAgICB0aGlzLnRvcFN0eWxlLnRvcCA9IHRvcCArICdweCc7XG4gICAgdGhpcy50b3BTdHlsZS5sZWZ0ID0gbGVmdCArICdweCc7XG4gICAgdGhpcy50b3BTdHlsZS53aWR0aCA9IHdpZHRoICsgJ3B4JztcbiAgICB0aGlzLnRvcFN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgIHRoaXMubGVmdFN0eWxlLnRvcCA9IHRvcCArICdweCc7XG4gICAgdGhpcy5sZWZ0U3R5bGUubGVmdCA9IGxlZnQgKyAncHgnO1xuICAgIHRoaXMubGVmdFN0eWxlLmhlaWdodCA9IGhlaWdodCArICdweCc7XG4gICAgdGhpcy5sZWZ0U3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgdmFyIGRlbHRhID0gTWF0aC5mbG9vcih0aGlzLnNldHRpbmdzLmJvcmRlci53aWR0aCAvIDIpO1xuICAgIHRoaXMuYm90dG9tU3R5bGUudG9wID0gdG9wICsgaGVpZ2h0IC0gZGVsdGEgKyAncHgnO1xuICAgIHRoaXMuYm90dG9tU3R5bGUubGVmdCA9IGxlZnQgKyAncHgnO1xuICAgIHRoaXMuYm90dG9tU3R5bGUud2lkdGggPSB3aWR0aCArICdweCc7XG4gICAgdGhpcy5ib3R0b21TdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICB0aGlzLnJpZ2h0U3R5bGUudG9wID0gdG9wICsgJ3B4JztcbiAgICB0aGlzLnJpZ2h0U3R5bGUubGVmdCA9IGxlZnQgKyB3aWR0aCAtIGRlbHRhICsgJ3B4JztcbiAgICB0aGlzLnJpZ2h0U3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgMSArICdweCc7XG4gICAgdGhpcy5yaWdodFN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgIGlmIChpc01vYmlsZUJyb3dzZXIoKSB8fCAoIXRoaXMuaGFzU2V0dGluZyh0aGlzLnNldHRpbmdzLmJvcmRlci5jb3JuZXJWaXNpYmxlKSB8fCB0aGlzLmlzUGFydFJhbmdlKHRvUm93LCB0b0NvbHVtbikpKSB7XG4gICAgICB0aGlzLmNvcm5lclN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY29ybmVyU3R5bGUudG9wID0gdG9wICsgaGVpZ2h0IC0gNCArICdweCc7XG4gICAgICB0aGlzLmNvcm5lclN0eWxlLmxlZnQgPSBsZWZ0ICsgd2lkdGggLSA0ICsgJ3B4JztcbiAgICAgIHRoaXMuY29ybmVyU3R5bGUuYm9yZGVyUmlnaHRXaWR0aCA9IHRoaXMuY29ybmVyRGVmYXVsdFN0eWxlLmJvcmRlcldpZHRoO1xuICAgICAgdGhpcy5jb3JuZXJTdHlsZS53aWR0aCA9IHRoaXMuY29ybmVyRGVmYXVsdFN0eWxlLndpZHRoO1xuICAgICAgdGhpcy5jb3JuZXJTdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgdHJpbW1pbmdDb250YWluZXIgPSBnZXRUcmltbWluZ0NvbnRhaW5lcih0aGlzLndvdC53dFRhYmxlLlRBQkxFKTtcbiAgICAgIGlmICh0b0NvbHVtbiA9PT0gdGhpcy53b3QuZ2V0U2V0dGluZygndG90YWxDb2x1bW5zJykgLSAxKSB7XG4gICAgICAgIGNvcm5lck92ZXJsYXBwaW5nQ29udGFpbmVyID0gdG9URC5vZmZzZXRMZWZ0ICsgb3V0ZXJXaWR0aCh0b1REKSArIChwYXJzZUludCh0aGlzLmNvcm5lckRlZmF1bHRTdHlsZS53aWR0aCkgLyAyKSA+PSBpbm5lcldpZHRoKHRyaW1taW5nQ29udGFpbmVyKTtcbiAgICAgICAgaWYgKGNvcm5lck92ZXJsYXBwaW5nQ29udGFpbmVyKSB7XG4gICAgICAgICAgdGhpcy5jb3JuZXJTdHlsZS5sZWZ0ID0gTWF0aC5mbG9vcihsZWZ0ICsgd2lkdGggLSAzIC0gcGFyc2VJbnQodGhpcy5jb3JuZXJEZWZhdWx0U3R5bGUud2lkdGgpIC8gMikgKyAncHgnO1xuICAgICAgICAgIHRoaXMuY29ybmVyU3R5bGUuYm9yZGVyUmlnaHRXaWR0aCA9IDA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICh0b1JvdyA9PT0gdGhpcy53b3QuZ2V0U2V0dGluZygndG90YWxSb3dzJykgLSAxKSB7XG4gICAgICAgIGNvcm5lck92ZXJsYXBwaW5nQ29udGFpbmVyID0gdG9URC5vZmZzZXRUb3AgKyBvdXRlckhlaWdodCh0b1REKSArIChwYXJzZUludCh0aGlzLmNvcm5lckRlZmF1bHRTdHlsZS5oZWlnaHQpIC8gMikgPj0gaW5uZXJIZWlnaHQodHJpbW1pbmdDb250YWluZXIpO1xuICAgICAgICBpZiAoY29ybmVyT3ZlcmxhcHBpbmdDb250YWluZXIpIHtcbiAgICAgICAgICB0aGlzLmNvcm5lclN0eWxlLnRvcCA9IE1hdGguZmxvb3IodG9wICsgaGVpZ2h0IC0gMyAtIHBhcnNlSW50KHRoaXMuY29ybmVyRGVmYXVsdFN0eWxlLmhlaWdodCkgLyAyKSArICdweCc7XG4gICAgICAgICAgdGhpcy5jb3JuZXJTdHlsZS5ib3JkZXJCb3R0b21XaWR0aCA9IDA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMuY29ybmVyU3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgfVxuICAgIGlmIChpc01vYmlsZUJyb3dzZXIoKSkge1xuICAgICAgdGhpcy51cGRhdGVNdWx0aXBsZVNlbGVjdGlvbkhhbmRsZXNQb3NpdGlvbihmcm9tUm93LCBmcm9tQ29sdW1uLCB0b3AsIGxlZnQsIHdpZHRoLCBoZWlnaHQpO1xuICAgIH1cbiAgfSxcbiAgZGlzYXBwZWFyOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnRvcFN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgdGhpcy5sZWZ0U3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICB0aGlzLmJvdHRvbVN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgdGhpcy5yaWdodFN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgdGhpcy5jb3JuZXJTdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIGlmIChpc01vYmlsZUJyb3dzZXIoKSkge1xuICAgICAgdGhpcy5zZWxlY3Rpb25IYW5kbGVzLnN0eWxlcy50b3BMZWZ0LmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICB0aGlzLnNlbGVjdGlvbkhhbmRsZXMuc3R5bGVzLmJvdHRvbVJpZ2h0LmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgfVxuICB9LFxuICBoYXNTZXR0aW5nOiBmdW5jdGlvbihzZXR0aW5nKSB7XG4gICAgaWYgKHR5cGVvZiBzZXR0aW5nID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICByZXR1cm4gc2V0dGluZygpO1xuICAgIH1cbiAgICByZXR1cm4gISFzZXR0aW5nO1xuICB9XG59LCB7fSk7XG47XG53aW5kb3cuV2Fsa29udGFibGVCb3JkZXIgPSBXYWxrb250YWJsZUJvcmRlcjtcblxuLy8jIFxufSx7XCJjZWxsL2Nvb3Jkc1wiOjYsXCJldmVudE1hbmFnZXJcIjo0MixcImhlbHBlcnMvYnJvd3NlclwiOjQ0LFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwiaGVscGVycy9kb20vZXZlbnRcIjo0OCxcIm92ZXJsYXkvX2Jhc2UuanNcIjoxMn1dLDQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIFdhbGtvbnRhYmxlVmlld3BvcnRDb2x1bW5zQ2FsY3VsYXRvcjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gV2Fsa29udGFibGVWaWV3cG9ydENvbHVtbnNDYWxjdWxhdG9yO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciBwcml2YXRlUG9vbCA9IG5ldyBXZWFrTWFwKCk7XG52YXIgV2Fsa29udGFibGVWaWV3cG9ydENvbHVtbnNDYWxjdWxhdG9yID0gZnVuY3Rpb24gV2Fsa29udGFibGVWaWV3cG9ydENvbHVtbnNDYWxjdWxhdG9yKHZpZXdwb3J0V2lkdGgsIHNjcm9sbE9mZnNldCwgdG90YWxDb2x1bW5zLCBjb2x1bW5XaWR0aEZuLCBvdmVycmlkZUZuLCBvbmx5RnVsbHlWaXNpYmxlLCBzdHJldGNoSCkge1xuICB2YXIgc3RyZXRjaGluZ0NvbHVtbldpZHRoRm4gPSBhcmd1bWVudHNbN10gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzddIDogKGZ1bmN0aW9uKHdpZHRoKSB7XG4gICAgcmV0dXJuIHdpZHRoO1xuICB9KTtcbiAgcHJpdmF0ZVBvb2wuc2V0KHRoaXMsIHtcbiAgICB2aWV3cG9ydFdpZHRoOiB2aWV3cG9ydFdpZHRoLFxuICAgIHNjcm9sbE9mZnNldDogc2Nyb2xsT2Zmc2V0LFxuICAgIHRvdGFsQ29sdW1uczogdG90YWxDb2x1bW5zLFxuICAgIGNvbHVtbldpZHRoRm46IGNvbHVtbldpZHRoRm4sXG4gICAgb3ZlcnJpZGVGbjogb3ZlcnJpZGVGbixcbiAgICBvbmx5RnVsbHlWaXNpYmxlOiBvbmx5RnVsbHlWaXNpYmxlLFxuICAgIHN0cmV0Y2hpbmdDb2x1bW5XaWR0aEZuOiBzdHJldGNoaW5nQ29sdW1uV2lkdGhGblxuICB9KTtcbiAgdGhpcy5jb3VudCA9IDA7XG4gIHRoaXMuc3RhcnRDb2x1bW4gPSBudWxsO1xuICB0aGlzLmVuZENvbHVtbiA9IG51bGw7XG4gIHRoaXMuc3RhcnRQb3NpdGlvbiA9IG51bGw7XG4gIHRoaXMuc3RyZXRjaEFsbFJhdGlvID0gMDtcbiAgdGhpcy5zdHJldGNoTGFzdFdpZHRoID0gMDtcbiAgdGhpcy5zdHJldGNoID0gc3RyZXRjaEg7XG4gIHRoaXMudG90YWxUYXJnZXRXaWR0aCA9IDA7XG4gIHRoaXMubmVlZFZlcmlmeUxhc3RDb2x1bW5XaWR0aCA9IHRydWU7XG4gIHRoaXMuc3RyZXRjaEFsbENvbHVtbnNXaWR0aCA9IFtdO1xuICB0aGlzLmNhbGN1bGF0ZSgpO1xufTtcbnZhciAkV2Fsa29udGFibGVWaWV3cG9ydENvbHVtbnNDYWxjdWxhdG9yID0gV2Fsa29udGFibGVWaWV3cG9ydENvbHVtbnNDYWxjdWxhdG9yO1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoV2Fsa29udGFibGVWaWV3cG9ydENvbHVtbnNDYWxjdWxhdG9yLCB7XG4gIGNhbGN1bGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHN1bSA9IDA7XG4gICAgdmFyIG5lZWRSZXZlcnNlID0gdHJ1ZTtcbiAgICB2YXIgc3RhcnRQb3NpdGlvbnMgPSBbXTtcbiAgICB2YXIgY29sdW1uV2lkdGg7XG4gICAgdmFyIHByaXYgPSBwcml2YXRlUG9vbC5nZXQodGhpcyk7XG4gICAgdmFyIG9ubHlGdWxseVZpc2libGUgPSBwcml2Lm9ubHlGdWxseVZpc2libGU7XG4gICAgdmFyIG92ZXJyaWRlRm4gPSBwcml2Lm92ZXJyaWRlRm47XG4gICAgdmFyIHNjcm9sbE9mZnNldCA9IHByaXYuc2Nyb2xsT2Zmc2V0O1xuICAgIHZhciB0b3RhbENvbHVtbnMgPSBwcml2LnRvdGFsQ29sdW1ucztcbiAgICB2YXIgdmlld3BvcnRXaWR0aCA9IHByaXYudmlld3BvcnRXaWR0aDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRvdGFsQ29sdW1uczsgaSsrKSB7XG4gICAgICBjb2x1bW5XaWR0aCA9IHRoaXMuX2dldENvbHVtbldpZHRoKGkpO1xuICAgICAgaWYgKHN1bSA8PSBzY3JvbGxPZmZzZXQgJiYgIW9ubHlGdWxseVZpc2libGUpIHtcbiAgICAgICAgdGhpcy5zdGFydENvbHVtbiA9IGk7XG4gICAgICB9XG4gICAgICB2YXIgY29tcGVuc2F0ZWRWaWV3cG9ydFdpZHRoID0gc2Nyb2xsT2Zmc2V0ID4gMCA/IHZpZXdwb3J0V2lkdGggKyAxIDogdmlld3BvcnRXaWR0aDtcbiAgICAgIGlmIChzdW0gPj0gc2Nyb2xsT2Zmc2V0ICYmIHN1bSArIGNvbHVtbldpZHRoIDw9IHNjcm9sbE9mZnNldCArIGNvbXBlbnNhdGVkVmlld3BvcnRXaWR0aCkge1xuICAgICAgICBpZiAodGhpcy5zdGFydENvbHVtbiA9PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5zdGFydENvbHVtbiA9IGk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5lbmRDb2x1bW4gPSBpO1xuICAgICAgfVxuICAgICAgc3RhcnRQb3NpdGlvbnMucHVzaChzdW0pO1xuICAgICAgc3VtICs9IGNvbHVtbldpZHRoO1xuICAgICAgaWYgKCFvbmx5RnVsbHlWaXNpYmxlKSB7XG4gICAgICAgIHRoaXMuZW5kQ29sdW1uID0gaTtcbiAgICAgIH1cbiAgICAgIGlmIChzdW0gPj0gc2Nyb2xsT2Zmc2V0ICsgdmlld3BvcnRXaWR0aCkge1xuICAgICAgICBuZWVkUmV2ZXJzZSA9IGZhbHNlO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHRoaXMuZW5kQ29sdW1uID09PSB0b3RhbENvbHVtbnMgLSAxICYmIG5lZWRSZXZlcnNlKSB7XG4gICAgICB0aGlzLnN0YXJ0Q29sdW1uID0gdGhpcy5lbmRDb2x1bW47XG4gICAgICB3aGlsZSAodGhpcy5zdGFydENvbHVtbiA+IDApIHtcbiAgICAgICAgdmFyIHZpZXdwb3J0U3VtID0gc3RhcnRQb3NpdGlvbnNbdGhpcy5lbmRDb2x1bW5dICsgY29sdW1uV2lkdGggLSBzdGFydFBvc2l0aW9uc1t0aGlzLnN0YXJ0Q29sdW1uIC0gMV07XG4gICAgICAgIGlmICh2aWV3cG9ydFN1bSA8PSB2aWV3cG9ydFdpZHRoIHx8ICFvbmx5RnVsbHlWaXNpYmxlKSB7XG4gICAgICAgICAgdGhpcy5zdGFydENvbHVtbi0tO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2aWV3cG9ydFN1bSA+IHZpZXdwb3J0V2lkdGgpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAodGhpcy5zdGFydENvbHVtbiAhPT0gbnVsbCAmJiBvdmVycmlkZUZuKSB7XG4gICAgICBvdmVycmlkZUZuKHRoaXMpO1xuICAgIH1cbiAgICB0aGlzLnN0YXJ0UG9zaXRpb24gPSBzdGFydFBvc2l0aW9uc1t0aGlzLnN0YXJ0Q29sdW1uXTtcbiAgICBpZiAodGhpcy5zdGFydFBvc2l0aW9uID09IHZvaWQgMCkge1xuICAgICAgdGhpcy5zdGFydFBvc2l0aW9uID0gbnVsbDtcbiAgICB9XG4gICAgaWYgKHRoaXMuc3RhcnRDb2x1bW4gIT09IG51bGwpIHtcbiAgICAgIHRoaXMuY291bnQgPSB0aGlzLmVuZENvbHVtbiAtIHRoaXMuc3RhcnRDb2x1bW4gKyAxO1xuICAgIH1cbiAgfSxcbiAgcmVmcmVzaFN0cmV0Y2hpbmc6IGZ1bmN0aW9uKHRvdGFsV2lkdGgpIHtcbiAgICBpZiAodGhpcy5zdHJldGNoID09PSAnbm9uZScpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy50b3RhbFRhcmdldFdpZHRoID0gdG90YWxXaWR0aDtcbiAgICB2YXIgcHJpdiA9IHByaXZhdGVQb29sLmdldCh0aGlzKTtcbiAgICB2YXIgdG90YWxDb2x1bW5zID0gcHJpdi50b3RhbENvbHVtbnM7XG4gICAgdmFyIHN1bUFsbCA9IDA7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b3RhbENvbHVtbnM7IGkrKykge1xuICAgICAgdmFyIGNvbHVtbldpZHRoID0gdGhpcy5fZ2V0Q29sdW1uV2lkdGgoaSk7XG4gICAgICB2YXIgcGVybWFuZW50Q29sdW1uV2lkdGggPSBwcml2LnN0cmV0Y2hpbmdDb2x1bW5XaWR0aEZuKHZvaWQgMCwgaSk7XG4gICAgICBpZiAodHlwZW9mIHBlcm1hbmVudENvbHVtbldpZHRoID09PSAnbnVtYmVyJykge1xuICAgICAgICB0b3RhbFdpZHRoIC09IHBlcm1hbmVudENvbHVtbldpZHRoO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3VtQWxsICs9IGNvbHVtbldpZHRoO1xuICAgICAgfVxuICAgIH1cbiAgICB2YXIgcmVtYWluaW5nU2l6ZSA9IHRvdGFsV2lkdGggLSBzdW1BbGw7XG4gICAgaWYgKHRoaXMuc3RyZXRjaCA9PT0gJ2FsbCcgJiYgcmVtYWluaW5nU2l6ZSA+IDApIHtcbiAgICAgIHRoaXMuc3RyZXRjaEFsbFJhdGlvID0gdG90YWxXaWR0aCAvIHN1bUFsbDtcbiAgICAgIHRoaXMuc3RyZXRjaEFsbENvbHVtbnNXaWR0aCA9IFtdO1xuICAgICAgdGhpcy5uZWVkVmVyaWZ5TGFzdENvbHVtbldpZHRoID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuc3RyZXRjaCA9PT0gJ2xhc3QnICYmIHRvdGFsV2lkdGggIT09IEluZmluaXR5KSB7XG4gICAgICB2YXIgY29sdW1uV2lkdGgkX18xID0gdGhpcy5fZ2V0Q29sdW1uV2lkdGgodG90YWxDb2x1bW5zIC0gMSk7XG4gICAgICB2YXIgbGFzdENvbHVtbldpZHRoID0gcmVtYWluaW5nU2l6ZSArIGNvbHVtbldpZHRoJF9fMTtcbiAgICAgIHRoaXMuc3RyZXRjaExhc3RXaWR0aCA9IGxhc3RDb2x1bW5XaWR0aCA+PSAwID8gbGFzdENvbHVtbldpZHRoIDogY29sdW1uV2lkdGgkX18xO1xuICAgIH1cbiAgfSxcbiAgZ2V0U3RyZXRjaGVkQ29sdW1uV2lkdGg6IGZ1bmN0aW9uKGNvbHVtbiwgYmFzZVdpZHRoKSB7XG4gICAgdmFyIHJlc3VsdCA9IG51bGw7XG4gICAgaWYgKHRoaXMuc3RyZXRjaCA9PT0gJ2FsbCcgJiYgdGhpcy5zdHJldGNoQWxsUmF0aW8gIT09IDApIHtcbiAgICAgIHJlc3VsdCA9IHRoaXMuX2dldFN0cmV0Y2hlZEFsbENvbHVtbldpZHRoKGNvbHVtbiwgYmFzZVdpZHRoKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuc3RyZXRjaCA9PT0gJ2xhc3QnICYmIHRoaXMuc3RyZXRjaExhc3RXaWR0aCAhPT0gMCkge1xuICAgICAgcmVzdWx0ID0gdGhpcy5fZ2V0U3RyZXRjaGVkTGFzdENvbHVtbldpZHRoKGNvbHVtbik7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH0sXG4gIF9nZXRTdHJldGNoZWRBbGxDb2x1bW5XaWR0aDogZnVuY3Rpb24oY29sdW1uLCBiYXNlV2lkdGgpIHtcbiAgICB2YXIgc3VtUmF0aW9XaWR0aCA9IDA7XG4gICAgdmFyIHByaXYgPSBwcml2YXRlUG9vbC5nZXQodGhpcyk7XG4gICAgdmFyIHRvdGFsQ29sdW1ucyA9IHByaXYudG90YWxDb2x1bW5zO1xuICAgIGlmICghdGhpcy5zdHJldGNoQWxsQ29sdW1uc1dpZHRoW2NvbHVtbl0pIHtcbiAgICAgIHZhciBzdHJldGNoZWRXaWR0aCA9IE1hdGgucm91bmQoYmFzZVdpZHRoICogdGhpcy5zdHJldGNoQWxsUmF0aW8pO1xuICAgICAgdmFyIG5ld1N0cmV0Y2hlZFdpZHRoID0gcHJpdi5zdHJldGNoaW5nQ29sdW1uV2lkdGhGbihzdHJldGNoZWRXaWR0aCwgY29sdW1uKTtcbiAgICAgIGlmIChuZXdTdHJldGNoZWRXaWR0aCA9PT0gdm9pZCAwKSB7XG4gICAgICAgIHRoaXMuc3RyZXRjaEFsbENvbHVtbnNXaWR0aFtjb2x1bW5dID0gc3RyZXRjaGVkV2lkdGg7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnN0cmV0Y2hBbGxDb2x1bW5zV2lkdGhbY29sdW1uXSA9IGlzTmFOKG5ld1N0cmV0Y2hlZFdpZHRoKSA/IHRoaXMuX2dldENvbHVtbldpZHRoKGNvbHVtbikgOiBuZXdTdHJldGNoZWRXaWR0aDtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHRoaXMuc3RyZXRjaEFsbENvbHVtbnNXaWR0aC5sZW5ndGggPT09IHRvdGFsQ29sdW1ucyAmJiB0aGlzLm5lZWRWZXJpZnlMYXN0Q29sdW1uV2lkdGgpIHtcbiAgICAgIHRoaXMubmVlZFZlcmlmeUxhc3RDb2x1bW5XaWR0aCA9IGZhbHNlO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnN0cmV0Y2hBbGxDb2x1bW5zV2lkdGgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgc3VtUmF0aW9XaWR0aCArPSB0aGlzLnN0cmV0Y2hBbGxDb2x1bW5zV2lkdGhbaV07XG4gICAgICB9XG4gICAgICBpZiAoc3VtUmF0aW9XaWR0aCAhPT0gdGhpcy50b3RhbFRhcmdldFdpZHRoKSB7XG4gICAgICAgIHRoaXMuc3RyZXRjaEFsbENvbHVtbnNXaWR0aFt0aGlzLnN0cmV0Y2hBbGxDb2x1bW5zV2lkdGgubGVuZ3RoIC0gMV0gKz0gdGhpcy50b3RhbFRhcmdldFdpZHRoIC0gc3VtUmF0aW9XaWR0aDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuc3RyZXRjaEFsbENvbHVtbnNXaWR0aFtjb2x1bW5dO1xuICB9LFxuICBfZ2V0U3RyZXRjaGVkTGFzdENvbHVtbldpZHRoOiBmdW5jdGlvbihjb2x1bW4pIHtcbiAgICB2YXIgcHJpdiA9IHByaXZhdGVQb29sLmdldCh0aGlzKTtcbiAgICB2YXIgdG90YWxDb2x1bW5zID0gcHJpdi50b3RhbENvbHVtbnM7XG4gICAgaWYgKGNvbHVtbiA9PT0gdG90YWxDb2x1bW5zIC0gMSkge1xuICAgICAgcmV0dXJuIHRoaXMuc3RyZXRjaExhc3RXaWR0aDtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH0sXG4gIF9nZXRDb2x1bW5XaWR0aDogZnVuY3Rpb24oY29sdW1uKSB7XG4gICAgdmFyIHdpZHRoID0gcHJpdmF0ZVBvb2wuZ2V0KHRoaXMpLmNvbHVtbldpZHRoRm4oY29sdW1uKTtcbiAgICBpZiAod2lkdGggPT09IHZvaWQgMCkge1xuICAgICAgd2lkdGggPSAkV2Fsa29udGFibGVWaWV3cG9ydENvbHVtbnNDYWxjdWxhdG9yLkRFRkFVTFRfV0lEVEg7XG4gICAgfVxuICAgIHJldHVybiB3aWR0aDtcbiAgfVxufSwge2dldCBERUZBVUxUX1dJRFRIKCkge1xuICAgIHJldHVybiA1MDtcbiAgfX0pO1xuO1xud2luZG93LldhbGtvbnRhYmxlVmlld3BvcnRDb2x1bW5zQ2FsY3VsYXRvciA9IFdhbGtvbnRhYmxlVmlld3BvcnRDb2x1bW5zQ2FsY3VsYXRvcjtcblxuLy8jIFxufSx7fV0sNTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgV2Fsa29udGFibGVWaWV3cG9ydFJvd3NDYWxjdWxhdG9yOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBXYWxrb250YWJsZVZpZXdwb3J0Um93c0NhbGN1bGF0b3I7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyIHByaXZhdGVQb29sID0gbmV3IFdlYWtNYXAoKTtcbnZhciBXYWxrb250YWJsZVZpZXdwb3J0Um93c0NhbGN1bGF0b3IgPSBmdW5jdGlvbiBXYWxrb250YWJsZVZpZXdwb3J0Um93c0NhbGN1bGF0b3Iodmlld3BvcnRIZWlnaHQsIHNjcm9sbE9mZnNldCwgdG90YWxSb3dzLCByb3dIZWlnaHRGbiwgb3ZlcnJpZGVGbiwgb25seUZ1bGx5VmlzaWJsZSwgaG9yaXpvbnRhbFNjcm9sbGJhckhlaWdodCkge1xuICBwcml2YXRlUG9vbC5zZXQodGhpcywge1xuICAgIHZpZXdwb3J0SGVpZ2h0OiB2aWV3cG9ydEhlaWdodCxcbiAgICBzY3JvbGxPZmZzZXQ6IHNjcm9sbE9mZnNldCxcbiAgICB0b3RhbFJvd3M6IHRvdGFsUm93cyxcbiAgICByb3dIZWlnaHRGbjogcm93SGVpZ2h0Rm4sXG4gICAgb3ZlcnJpZGVGbjogb3ZlcnJpZGVGbixcbiAgICBvbmx5RnVsbHlWaXNpYmxlOiBvbmx5RnVsbHlWaXNpYmxlLFxuICAgIGhvcml6b250YWxTY3JvbGxiYXJIZWlnaHQ6IGhvcml6b250YWxTY3JvbGxiYXJIZWlnaHRcbiAgfSk7XG4gIHRoaXMuY291bnQgPSAwO1xuICB0aGlzLnN0YXJ0Um93ID0gbnVsbDtcbiAgdGhpcy5lbmRSb3cgPSBudWxsO1xuICB0aGlzLnN0YXJ0UG9zaXRpb24gPSBudWxsO1xuICB0aGlzLmNhbGN1bGF0ZSgpO1xufTtcbnZhciAkV2Fsa29udGFibGVWaWV3cG9ydFJvd3NDYWxjdWxhdG9yID0gV2Fsa29udGFibGVWaWV3cG9ydFJvd3NDYWxjdWxhdG9yO1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoV2Fsa29udGFibGVWaWV3cG9ydFJvd3NDYWxjdWxhdG9yLCB7Y2FsY3VsYXRlOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc3VtID0gMDtcbiAgICB2YXIgbmVlZFJldmVyc2UgPSB0cnVlO1xuICAgIHZhciBzdGFydFBvc2l0aW9ucyA9IFtdO1xuICAgIHZhciBwcml2ID0gcHJpdmF0ZVBvb2wuZ2V0KHRoaXMpO1xuICAgIHZhciBvbmx5RnVsbHlWaXNpYmxlID0gcHJpdi5vbmx5RnVsbHlWaXNpYmxlO1xuICAgIHZhciBvdmVycmlkZUZuID0gcHJpdi5vdmVycmlkZUZuO1xuICAgIHZhciByb3dIZWlnaHRGbiA9IHByaXYucm93SGVpZ2h0Rm47XG4gICAgdmFyIHNjcm9sbE9mZnNldCA9IHByaXYuc2Nyb2xsT2Zmc2V0O1xuICAgIHZhciB0b3RhbFJvd3MgPSBwcml2LnRvdGFsUm93cztcbiAgICB2YXIgdmlld3BvcnRIZWlnaHQgPSBwcml2LnZpZXdwb3J0SGVpZ2h0O1xuICAgIHZhciBob3Jpem9udGFsU2Nyb2xsYmFySGVpZ2h0ID0gcHJpdi5ob3Jpem9udGFsU2Nyb2xsYmFySGVpZ2h0IHx8IDA7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0b3RhbFJvd3M7IGkrKykge1xuICAgICAgdmFyIHJvd0hlaWdodCA9IHJvd0hlaWdodEZuKGkpO1xuICAgICAgaWYgKHJvd0hlaWdodCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJvd0hlaWdodCA9ICRXYWxrb250YWJsZVZpZXdwb3J0Um93c0NhbGN1bGF0b3IuREVGQVVMVF9IRUlHSFQ7XG4gICAgICB9XG4gICAgICBpZiAoc3VtIDw9IHNjcm9sbE9mZnNldCAmJiAhb25seUZ1bGx5VmlzaWJsZSkge1xuICAgICAgICB0aGlzLnN0YXJ0Um93ID0gaTtcbiAgICAgIH1cbiAgICAgIGlmIChzdW0gPj0gc2Nyb2xsT2Zmc2V0ICYmIHN1bSArIHJvd0hlaWdodCA8PSBzY3JvbGxPZmZzZXQgKyB2aWV3cG9ydEhlaWdodCAtIGhvcml6b250YWxTY3JvbGxiYXJIZWlnaHQpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhcnRSb3cgPT09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLnN0YXJ0Um93ID0gaTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmVuZFJvdyA9IGk7XG4gICAgICB9XG4gICAgICBzdGFydFBvc2l0aW9ucy5wdXNoKHN1bSk7XG4gICAgICBzdW0gKz0gcm93SGVpZ2h0O1xuICAgICAgaWYgKCFvbmx5RnVsbHlWaXNpYmxlKSB7XG4gICAgICAgIHRoaXMuZW5kUm93ID0gaTtcbiAgICAgIH1cbiAgICAgIGlmIChzdW0gPj0gc2Nyb2xsT2Zmc2V0ICsgdmlld3BvcnRIZWlnaHQgLSBob3Jpem9udGFsU2Nyb2xsYmFySGVpZ2h0KSB7XG4gICAgICAgIG5lZWRSZXZlcnNlID0gZmFsc2U7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAodGhpcy5lbmRSb3cgPT09IHRvdGFsUm93cyAtIDEgJiYgbmVlZFJldmVyc2UpIHtcbiAgICAgIHRoaXMuc3RhcnRSb3cgPSB0aGlzLmVuZFJvdztcbiAgICAgIHdoaWxlICh0aGlzLnN0YXJ0Um93ID4gMCkge1xuICAgICAgICB2YXIgdmlld3BvcnRTdW0gPSBzdGFydFBvc2l0aW9uc1t0aGlzLmVuZFJvd10gKyByb3dIZWlnaHQgLSBzdGFydFBvc2l0aW9uc1t0aGlzLnN0YXJ0Um93IC0gMV07XG4gICAgICAgIGlmICh2aWV3cG9ydFN1bSA8PSB2aWV3cG9ydEhlaWdodCAtIGhvcml6b250YWxTY3JvbGxiYXJIZWlnaHQgfHwgIW9ubHlGdWxseVZpc2libGUpIHtcbiAgICAgICAgICB0aGlzLnN0YXJ0Um93LS07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZpZXdwb3J0U3VtID49IHZpZXdwb3J0SGVpZ2h0IC0gaG9yaXpvbnRhbFNjcm9sbGJhckhlaWdodCkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0aGlzLnN0YXJ0Um93ICE9PSBudWxsICYmIG92ZXJyaWRlRm4pIHtcbiAgICAgIG92ZXJyaWRlRm4odGhpcyk7XG4gICAgfVxuICAgIHRoaXMuc3RhcnRQb3NpdGlvbiA9IHN0YXJ0UG9zaXRpb25zW3RoaXMuc3RhcnRSb3ddO1xuICAgIGlmICh0aGlzLnN0YXJ0UG9zaXRpb24gPT0gdm9pZCAwKSB7XG4gICAgICB0aGlzLnN0YXJ0UG9zaXRpb24gPSBudWxsO1xuICAgIH1cbiAgICBpZiAodGhpcy5zdGFydFJvdyAhPT0gbnVsbCkge1xuICAgICAgdGhpcy5jb3VudCA9IHRoaXMuZW5kUm93IC0gdGhpcy5zdGFydFJvdyArIDE7XG4gICAgfVxuICB9fSwge2dldCBERUZBVUxUX0hFSUdIVCgpIHtcbiAgICByZXR1cm4gMjM7XG4gIH19KTtcbjtcbndpbmRvdy5XYWxrb250YWJsZVZpZXdwb3J0Um93c0NhbGN1bGF0b3IgPSBXYWxrb250YWJsZVZpZXdwb3J0Um93c0NhbGN1bGF0b3I7XG5cbi8vIyBcbn0se31dLDY6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIFdhbGtvbnRhYmxlQ2VsbENvb3Jkczoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gV2Fsa29udGFibGVDZWxsQ29vcmRzO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciBXYWxrb250YWJsZUNlbGxDb29yZHMgPSBmdW5jdGlvbiBXYWxrb250YWJsZUNlbGxDb29yZHMocm93LCBjb2wpIHtcbiAgaWYgKHR5cGVvZiByb3cgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBjb2wgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgdGhpcy5yb3cgPSByb3c7XG4gICAgdGhpcy5jb2wgPSBjb2w7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5yb3cgPSBudWxsO1xuICAgIHRoaXMuY29sID0gbnVsbDtcbiAgfVxufTtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKFdhbGtvbnRhYmxlQ2VsbENvb3Jkcywge1xuICBpc1ZhbGlkOiBmdW5jdGlvbih3b3RJbnN0YW5jZSkge1xuICAgIGlmICh0aGlzLnJvdyA8IDAgfHwgdGhpcy5jb2wgPCAwKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmICh0aGlzLnJvdyA+PSB3b3RJbnN0YW5jZS5nZXRTZXR0aW5nKCd0b3RhbFJvd3MnKSB8fCB0aGlzLmNvbCA+PSB3b3RJbnN0YW5jZS5nZXRTZXR0aW5nKCd0b3RhbENvbHVtbnMnKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSxcbiAgaXNFcXVhbDogZnVuY3Rpb24oY2VsbENvb3Jkcykge1xuICAgIGlmIChjZWxsQ29vcmRzID09PSB0aGlzKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMucm93ID09PSBjZWxsQ29vcmRzLnJvdyAmJiB0aGlzLmNvbCA9PT0gY2VsbENvb3Jkcy5jb2w7XG4gIH0sXG4gIGlzU291dGhFYXN0T2Y6IGZ1bmN0aW9uKHRlc3RlZENvb3Jkcykge1xuICAgIHJldHVybiB0aGlzLnJvdyA+PSB0ZXN0ZWRDb29yZHMucm93ICYmIHRoaXMuY29sID49IHRlc3RlZENvb3Jkcy5jb2w7XG4gIH0sXG4gIGlzTm9ydGhXZXN0T2Y6IGZ1bmN0aW9uKHRlc3RlZENvb3Jkcykge1xuICAgIHJldHVybiB0aGlzLnJvdyA8PSB0ZXN0ZWRDb29yZHMucm93ICYmIHRoaXMuY29sIDw9IHRlc3RlZENvb3Jkcy5jb2w7XG4gIH0sXG4gIGlzU291dGhXZXN0T2Y6IGZ1bmN0aW9uKHRlc3RlZENvb3Jkcykge1xuICAgIHJldHVybiB0aGlzLnJvdyA+PSB0ZXN0ZWRDb29yZHMucm93ICYmIHRoaXMuY29sIDw9IHRlc3RlZENvb3Jkcy5jb2w7XG4gIH0sXG4gIGlzTm9ydGhFYXN0T2Y6IGZ1bmN0aW9uKHRlc3RlZENvb3Jkcykge1xuICAgIHJldHVybiB0aGlzLnJvdyA8PSB0ZXN0ZWRDb29yZHMucm93ICYmIHRoaXMuY29sID49IHRlc3RlZENvb3Jkcy5jb2w7XG4gIH1cbn0sIHt9KTtcbjtcbndpbmRvdy5XYWxrb250YWJsZUNlbGxDb29yZHMgPSBXYWxrb250YWJsZUNlbGxDb29yZHM7XG5cbi8vIyBcbn0se31dLDc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIFdhbGtvbnRhYmxlQ2VsbFJhbmdlOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBXYWxrb250YWJsZUNlbGxSYW5nZTtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfY2VsbF80N19jb29yZHNfXztcbnZhciBXYWxrb250YWJsZUNlbGxDb29yZHMgPSAoJF9fXzQ2X180Nl9fNDdfY2VsbF80N19jb29yZHNfXyA9IF9kZXJlcV8oXCJjZWxsL2Nvb3Jkc1wiKSwgJF9fXzQ2X180Nl9fNDdfY2VsbF80N19jb29yZHNfXyAmJiAkX19fNDZfXzQ2X180N19jZWxsXzQ3X2Nvb3Jkc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfY2VsbF80N19jb29yZHNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfY2VsbF80N19jb29yZHNfX30pLldhbGtvbnRhYmxlQ2VsbENvb3JkcztcbnZhciBXYWxrb250YWJsZUNlbGxSYW5nZSA9IGZ1bmN0aW9uIFdhbGtvbnRhYmxlQ2VsbFJhbmdlKGhpZ2hsaWdodCwgZnJvbSwgdG8pIHtcbiAgdGhpcy5oaWdobGlnaHQgPSBoaWdobGlnaHQ7XG4gIHRoaXMuZnJvbSA9IGZyb207XG4gIHRoaXMudG8gPSB0bztcbn07XG52YXIgJFdhbGtvbnRhYmxlQ2VsbFJhbmdlID0gV2Fsa29udGFibGVDZWxsUmFuZ2U7XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShXYWxrb250YWJsZUNlbGxSYW5nZSwge1xuICBpc1ZhbGlkOiBmdW5jdGlvbih3b3RJbnN0YW5jZSkge1xuICAgIHJldHVybiB0aGlzLmZyb20uaXNWYWxpZCh3b3RJbnN0YW5jZSkgJiYgdGhpcy50by5pc1ZhbGlkKHdvdEluc3RhbmNlKTtcbiAgfSxcbiAgaXNTaW5nbGU6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmZyb20ucm93ID09PSB0aGlzLnRvLnJvdyAmJiB0aGlzLmZyb20uY29sID09PSB0aGlzLnRvLmNvbDtcbiAgfSxcbiAgZ2V0SGVpZ2h0OiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gTWF0aC5tYXgodGhpcy5mcm9tLnJvdywgdGhpcy50by5yb3cpIC0gTWF0aC5taW4odGhpcy5mcm9tLnJvdywgdGhpcy50by5yb3cpICsgMTtcbiAgfSxcbiAgZ2V0V2lkdGg6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBNYXRoLm1heCh0aGlzLmZyb20uY29sLCB0aGlzLnRvLmNvbCkgLSBNYXRoLm1pbih0aGlzLmZyb20uY29sLCB0aGlzLnRvLmNvbCkgKyAxO1xuICB9LFxuICBpbmNsdWRlczogZnVuY3Rpb24oY2VsbENvb3Jkcykge1xuICAgIHZhciAkX18yID0gY2VsbENvb3JkcyxcbiAgICAgICAgcm93ID0gJF9fMi5yb3csXG4gICAgICAgIGNvbCA9ICRfXzIuY29sO1xuICAgIHZhciB0b3BMZWZ0ID0gdGhpcy5nZXRUb3BMZWZ0Q29ybmVyKCk7XG4gICAgdmFyIGJvdHRvbVJpZ2h0ID0gdGhpcy5nZXRCb3R0b21SaWdodENvcm5lcigpO1xuICAgIHJldHVybiB0b3BMZWZ0LnJvdyA8PSByb3cgJiYgYm90dG9tUmlnaHQucm93ID49IHJvdyAmJiB0b3BMZWZ0LmNvbCA8PSBjb2wgJiYgYm90dG9tUmlnaHQuY29sID49IGNvbDtcbiAgfSxcbiAgaW5jbHVkZXNSYW5nZTogZnVuY3Rpb24odGVzdGVkUmFuZ2UpIHtcbiAgICByZXR1cm4gdGhpcy5pbmNsdWRlcyh0ZXN0ZWRSYW5nZS5nZXRUb3BMZWZ0Q29ybmVyKCkpICYmIHRoaXMuaW5jbHVkZXModGVzdGVkUmFuZ2UuZ2V0Qm90dG9tUmlnaHRDb3JuZXIoKSk7XG4gIH0sXG4gIGlzRXF1YWw6IGZ1bmN0aW9uKHRlc3RlZFJhbmdlKSB7XG4gICAgcmV0dXJuIChNYXRoLm1pbih0aGlzLmZyb20ucm93LCB0aGlzLnRvLnJvdykgPT0gTWF0aC5taW4odGVzdGVkUmFuZ2UuZnJvbS5yb3csIHRlc3RlZFJhbmdlLnRvLnJvdykpICYmIChNYXRoLm1heCh0aGlzLmZyb20ucm93LCB0aGlzLnRvLnJvdykgPT0gTWF0aC5tYXgodGVzdGVkUmFuZ2UuZnJvbS5yb3csIHRlc3RlZFJhbmdlLnRvLnJvdykpICYmIChNYXRoLm1pbih0aGlzLmZyb20uY29sLCB0aGlzLnRvLmNvbCkgPT0gTWF0aC5taW4odGVzdGVkUmFuZ2UuZnJvbS5jb2wsIHRlc3RlZFJhbmdlLnRvLmNvbCkpICYmIChNYXRoLm1heCh0aGlzLmZyb20uY29sLCB0aGlzLnRvLmNvbCkgPT0gTWF0aC5tYXgodGVzdGVkUmFuZ2UuZnJvbS5jb2wsIHRlc3RlZFJhbmdlLnRvLmNvbCkpO1xuICB9LFxuICBvdmVybGFwczogZnVuY3Rpb24odGVzdGVkUmFuZ2UpIHtcbiAgICByZXR1cm4gdGVzdGVkUmFuZ2UuaXNTb3V0aEVhc3RPZih0aGlzLmdldFRvcExlZnRDb3JuZXIoKSkgJiYgdGVzdGVkUmFuZ2UuaXNOb3J0aFdlc3RPZih0aGlzLmdldEJvdHRvbVJpZ2h0Q29ybmVyKCkpO1xuICB9LFxuICBpc1NvdXRoRWFzdE9mOiBmdW5jdGlvbih0ZXN0ZWRDb29yZHMpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRUb3BMZWZ0Q29ybmVyKCkuaXNTb3V0aEVhc3RPZih0ZXN0ZWRDb29yZHMpIHx8IHRoaXMuZ2V0Qm90dG9tUmlnaHRDb3JuZXIoKS5pc1NvdXRoRWFzdE9mKHRlc3RlZENvb3Jkcyk7XG4gIH0sXG4gIGlzTm9ydGhXZXN0T2Y6IGZ1bmN0aW9uKHRlc3RlZENvb3Jkcykge1xuICAgIHJldHVybiB0aGlzLmdldFRvcExlZnRDb3JuZXIoKS5pc05vcnRoV2VzdE9mKHRlc3RlZENvb3JkcykgfHwgdGhpcy5nZXRCb3R0b21SaWdodENvcm5lcigpLmlzTm9ydGhXZXN0T2YodGVzdGVkQ29vcmRzKTtcbiAgfSxcbiAgZXhwYW5kOiBmdW5jdGlvbihjZWxsQ29vcmRzKSB7XG4gICAgdmFyIHRvcExlZnQgPSB0aGlzLmdldFRvcExlZnRDb3JuZXIoKTtcbiAgICB2YXIgYm90dG9tUmlnaHQgPSB0aGlzLmdldEJvdHRvbVJpZ2h0Q29ybmVyKCk7XG4gICAgaWYgKGNlbGxDb29yZHMucm93IDwgdG9wTGVmdC5yb3cgfHwgY2VsbENvb3Jkcy5jb2wgPCB0b3BMZWZ0LmNvbCB8fCBjZWxsQ29vcmRzLnJvdyA+IGJvdHRvbVJpZ2h0LnJvdyB8fCBjZWxsQ29vcmRzLmNvbCA+IGJvdHRvbVJpZ2h0LmNvbCkge1xuICAgICAgdGhpcy5mcm9tID0gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhNYXRoLm1pbih0b3BMZWZ0LnJvdywgY2VsbENvb3Jkcy5yb3cpLCBNYXRoLm1pbih0b3BMZWZ0LmNvbCwgY2VsbENvb3Jkcy5jb2wpKTtcbiAgICAgIHRoaXMudG8gPSBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKE1hdGgubWF4KGJvdHRvbVJpZ2h0LnJvdywgY2VsbENvb3Jkcy5yb3cpLCBNYXRoLm1heChib3R0b21SaWdodC5jb2wsIGNlbGxDb29yZHMuY29sKSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuICBleHBhbmRCeVJhbmdlOiBmdW5jdGlvbihleHBhbmRpbmdSYW5nZSkge1xuICAgIGlmICh0aGlzLmluY2x1ZGVzUmFuZ2UoZXhwYW5kaW5nUmFuZ2UpIHx8ICF0aGlzLm92ZXJsYXBzKGV4cGFuZGluZ1JhbmdlKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgdG9wTGVmdCA9IHRoaXMuZ2V0VG9wTGVmdENvcm5lcigpO1xuICAgIHZhciBib3R0b21SaWdodCA9IHRoaXMuZ2V0Qm90dG9tUmlnaHRDb3JuZXIoKTtcbiAgICB2YXIgdG9wUmlnaHQgPSB0aGlzLmdldFRvcFJpZ2h0Q29ybmVyKCk7XG4gICAgdmFyIGJvdHRvbUxlZnQgPSB0aGlzLmdldEJvdHRvbUxlZnRDb3JuZXIoKTtcbiAgICB2YXIgZXhwYW5kaW5nVG9wTGVmdCA9IGV4cGFuZGluZ1JhbmdlLmdldFRvcExlZnRDb3JuZXIoKTtcbiAgICB2YXIgZXhwYW5kaW5nQm90dG9tUmlnaHQgPSBleHBhbmRpbmdSYW5nZS5nZXRCb3R0b21SaWdodENvcm5lcigpO1xuICAgIHZhciByZXN1bHRUb3BSb3cgPSBNYXRoLm1pbih0b3BMZWZ0LnJvdywgZXhwYW5kaW5nVG9wTGVmdC5yb3cpO1xuICAgIHZhciByZXN1bHRUb3BDb2wgPSBNYXRoLm1pbih0b3BMZWZ0LmNvbCwgZXhwYW5kaW5nVG9wTGVmdC5jb2wpO1xuICAgIHZhciByZXN1bHRCb3R0b21Sb3cgPSBNYXRoLm1heChib3R0b21SaWdodC5yb3csIGV4cGFuZGluZ0JvdHRvbVJpZ2h0LnJvdyk7XG4gICAgdmFyIHJlc3VsdEJvdHRvbUNvbCA9IE1hdGgubWF4KGJvdHRvbVJpZ2h0LmNvbCwgZXhwYW5kaW5nQm90dG9tUmlnaHQuY29sKTtcbiAgICB2YXIgZmluYWxGcm9tID0gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhyZXN1bHRUb3BSb3csIHJlc3VsdFRvcENvbCksXG4gICAgICAgIGZpbmFsVG8gPSBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHJlc3VsdEJvdHRvbVJvdywgcmVzdWx0Qm90dG9tQ29sKTtcbiAgICB2YXIgaXNDb3JuZXIgPSBuZXcgJFdhbGtvbnRhYmxlQ2VsbFJhbmdlKGZpbmFsRnJvbSwgZmluYWxGcm9tLCBmaW5hbFRvKS5pc0Nvcm5lcih0aGlzLmZyb20sIGV4cGFuZGluZ1JhbmdlKSxcbiAgICAgICAgb25seU1lcmdlID0gZXhwYW5kaW5nUmFuZ2UuaXNFcXVhbChuZXcgJFdhbGtvbnRhYmxlQ2VsbFJhbmdlKGZpbmFsRnJvbSwgZmluYWxGcm9tLCBmaW5hbFRvKSk7XG4gICAgaWYgKGlzQ29ybmVyICYmICFvbmx5TWVyZ2UpIHtcbiAgICAgIGlmICh0aGlzLmZyb20uY29sID4gZmluYWxGcm9tLmNvbCkge1xuICAgICAgICBmaW5hbEZyb20uY29sID0gcmVzdWx0Qm90dG9tQ29sO1xuICAgICAgICBmaW5hbFRvLmNvbCA9IHJlc3VsdFRvcENvbDtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLmZyb20ucm93ID4gZmluYWxGcm9tLnJvdykge1xuICAgICAgICBmaW5hbEZyb20ucm93ID0gcmVzdWx0Qm90dG9tUm93O1xuICAgICAgICBmaW5hbFRvLnJvdyA9IHJlc3VsdFRvcFJvdztcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5mcm9tID0gZmluYWxGcm9tO1xuICAgIHRoaXMudG8gPSBmaW5hbFRvO1xuICAgIHJldHVybiB0cnVlO1xuICB9LFxuICBnZXREaXJlY3Rpb246IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLmZyb20uaXNOb3J0aFdlc3RPZih0aGlzLnRvKSkge1xuICAgICAgcmV0dXJuICdOVy1TRSc7XG4gICAgfSBlbHNlIGlmICh0aGlzLmZyb20uaXNOb3J0aEVhc3RPZih0aGlzLnRvKSkge1xuICAgICAgcmV0dXJuICdORS1TVyc7XG4gICAgfSBlbHNlIGlmICh0aGlzLmZyb20uaXNTb3V0aEVhc3RPZih0aGlzLnRvKSkge1xuICAgICAgcmV0dXJuICdTRS1OVyc7XG4gICAgfSBlbHNlIGlmICh0aGlzLmZyb20uaXNTb3V0aFdlc3RPZih0aGlzLnRvKSkge1xuICAgICAgcmV0dXJuICdTVy1ORSc7XG4gICAgfVxuICB9LFxuICBzZXREaXJlY3Rpb246IGZ1bmN0aW9uKGRpcmVjdGlvbikge1xuICAgIHZhciAkX18yLFxuICAgICAgICAkX18zLFxuICAgICAgICAkX180LFxuICAgICAgICAkX181O1xuICAgIHN3aXRjaCAoZGlyZWN0aW9uKSB7XG4gICAgICBjYXNlICdOVy1TRSc6XG4gICAgICAgICgkX18yID0gW3RoaXMuZ2V0VG9wTGVmdENvcm5lcigpLCB0aGlzLmdldEJvdHRvbVJpZ2h0Q29ybmVyKCldLCB0aGlzLmZyb20gPSAkX18yWzBdLCB0aGlzLnRvID0gJF9fMlsxXSwgJF9fMik7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnTkUtU1cnOlxuICAgICAgICAoJF9fMyA9IFt0aGlzLmdldFRvcFJpZ2h0Q29ybmVyKCksIHRoaXMuZ2V0Qm90dG9tTGVmdENvcm5lcigpXSwgdGhpcy5mcm9tID0gJF9fM1swXSwgdGhpcy50byA9ICRfXzNbMV0sICRfXzMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ1NFLU5XJzpcbiAgICAgICAgKCRfXzQgPSBbdGhpcy5nZXRCb3R0b21SaWdodENvcm5lcigpLCB0aGlzLmdldFRvcExlZnRDb3JuZXIoKV0sIHRoaXMuZnJvbSA9ICRfXzRbMF0sIHRoaXMudG8gPSAkX180WzFdLCAkX180KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdTVy1ORSc6XG4gICAgICAgICgkX181ID0gW3RoaXMuZ2V0Qm90dG9tTGVmdENvcm5lcigpLCB0aGlzLmdldFRvcFJpZ2h0Q29ybmVyKCldLCB0aGlzLmZyb20gPSAkX181WzBdLCB0aGlzLnRvID0gJF9fNVsxXSwgJF9fNSk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfSxcbiAgZ2V0VG9wTGVmdENvcm5lcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoTWF0aC5taW4odGhpcy5mcm9tLnJvdywgdGhpcy50by5yb3cpLCBNYXRoLm1pbih0aGlzLmZyb20uY29sLCB0aGlzLnRvLmNvbCkpO1xuICB9LFxuICBnZXRCb3R0b21SaWdodENvcm5lcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoTWF0aC5tYXgodGhpcy5mcm9tLnJvdywgdGhpcy50by5yb3cpLCBNYXRoLm1heCh0aGlzLmZyb20uY29sLCB0aGlzLnRvLmNvbCkpO1xuICB9LFxuICBnZXRUb3BSaWdodENvcm5lcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoTWF0aC5taW4odGhpcy5mcm9tLnJvdywgdGhpcy50by5yb3cpLCBNYXRoLm1heCh0aGlzLmZyb20uY29sLCB0aGlzLnRvLmNvbCkpO1xuICB9LFxuICBnZXRCb3R0b21MZWZ0Q29ybmVyOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhNYXRoLm1heCh0aGlzLmZyb20ucm93LCB0aGlzLnRvLnJvdyksIE1hdGgubWluKHRoaXMuZnJvbS5jb2wsIHRoaXMudG8uY29sKSk7XG4gIH0sXG4gIGlzQ29ybmVyOiBmdW5jdGlvbihjb29yZHMsIGV4cGFuZGVkUmFuZ2UpIHtcbiAgICBpZiAoZXhwYW5kZWRSYW5nZSkge1xuICAgICAgaWYgKGV4cGFuZGVkUmFuZ2UuaW5jbHVkZXMoY29vcmRzKSkge1xuICAgICAgICBpZiAodGhpcy5nZXRUb3BMZWZ0Q29ybmVyKCkuaXNFcXVhbChuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKGV4cGFuZGVkUmFuZ2UuZnJvbS5yb3csIGV4cGFuZGVkUmFuZ2UuZnJvbS5jb2wpKSB8fCB0aGlzLmdldFRvcFJpZ2h0Q29ybmVyKCkuaXNFcXVhbChuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKGV4cGFuZGVkUmFuZ2UuZnJvbS5yb3csIGV4cGFuZGVkUmFuZ2UudG8uY29sKSkgfHwgdGhpcy5nZXRCb3R0b21MZWZ0Q29ybmVyKCkuaXNFcXVhbChuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKGV4cGFuZGVkUmFuZ2UudG8ucm93LCBleHBhbmRlZFJhbmdlLmZyb20uY29sKSkgfHwgdGhpcy5nZXRCb3R0b21SaWdodENvcm5lcigpLmlzRXF1YWwobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhleHBhbmRlZFJhbmdlLnRvLnJvdywgZXhwYW5kZWRSYW5nZS50by5jb2wpKSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjb29yZHMuaXNFcXVhbCh0aGlzLmdldFRvcExlZnRDb3JuZXIoKSkgfHwgY29vcmRzLmlzRXF1YWwodGhpcy5nZXRUb3BSaWdodENvcm5lcigpKSB8fCBjb29yZHMuaXNFcXVhbCh0aGlzLmdldEJvdHRvbUxlZnRDb3JuZXIoKSkgfHwgY29vcmRzLmlzRXF1YWwodGhpcy5nZXRCb3R0b21SaWdodENvcm5lcigpKTtcbiAgfSxcbiAgZ2V0T3Bwb3NpdGVDb3JuZXI6IGZ1bmN0aW9uKGNvb3JkcywgZXhwYW5kZWRSYW5nZSkge1xuICAgIGlmICghKGNvb3JkcyBpbnN0YW5jZW9mIFdhbGtvbnRhYmxlQ2VsbENvb3JkcykpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGV4cGFuZGVkUmFuZ2UpIHtcbiAgICAgIGlmIChleHBhbmRlZFJhbmdlLmluY2x1ZGVzKGNvb3JkcykpIHtcbiAgICAgICAgaWYgKHRoaXMuZ2V0VG9wTGVmdENvcm5lcigpLmlzRXF1YWwobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhleHBhbmRlZFJhbmdlLmZyb20ucm93LCBleHBhbmRlZFJhbmdlLmZyb20uY29sKSkpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5nZXRCb3R0b21SaWdodENvcm5lcigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmdldFRvcFJpZ2h0Q29ybmVyKCkuaXNFcXVhbChuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKGV4cGFuZGVkUmFuZ2UuZnJvbS5yb3csIGV4cGFuZGVkUmFuZ2UudG8uY29sKSkpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5nZXRCb3R0b21MZWZ0Q29ybmVyKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZ2V0Qm90dG9tTGVmdENvcm5lcigpLmlzRXF1YWwobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhleHBhbmRlZFJhbmdlLnRvLnJvdywgZXhwYW5kZWRSYW5nZS5mcm9tLmNvbCkpKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VG9wUmlnaHRDb3JuZXIoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5nZXRCb3R0b21SaWdodENvcm5lcigpLmlzRXF1YWwobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhleHBhbmRlZFJhbmdlLnRvLnJvdywgZXhwYW5kZWRSYW5nZS50by5jb2wpKSkge1xuICAgICAgICAgIHJldHVybiB0aGlzLmdldFRvcExlZnRDb3JuZXIoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoY29vcmRzLmlzRXF1YWwodGhpcy5nZXRCb3R0b21SaWdodENvcm5lcigpKSkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0VG9wTGVmdENvcm5lcigpO1xuICAgIH0gZWxzZSBpZiAoY29vcmRzLmlzRXF1YWwodGhpcy5nZXRUb3BMZWZ0Q29ybmVyKCkpKSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXRCb3R0b21SaWdodENvcm5lcigpO1xuICAgIH0gZWxzZSBpZiAoY29vcmRzLmlzRXF1YWwodGhpcy5nZXRUb3BSaWdodENvcm5lcigpKSkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0Qm90dG9tTGVmdENvcm5lcigpO1xuICAgIH0gZWxzZSBpZiAoY29vcmRzLmlzRXF1YWwodGhpcy5nZXRCb3R0b21MZWZ0Q29ybmVyKCkpKSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXRUb3BSaWdodENvcm5lcigpO1xuICAgIH1cbiAgfSxcbiAgZ2V0Qm9yZGVyc1NoYXJlZFdpdGg6IGZ1bmN0aW9uKHJhbmdlKSB7XG4gICAgaWYgKCF0aGlzLmluY2x1ZGVzUmFuZ2UocmFuZ2UpKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIHZhciB0aGlzQm9yZGVycyA9IHtcbiAgICAgIHRvcDogTWF0aC5taW4odGhpcy5mcm9tLnJvdywgdGhpcy50by5yb3cpLFxuICAgICAgYm90dG9tOiBNYXRoLm1heCh0aGlzLmZyb20ucm93LCB0aGlzLnRvLnJvdyksXG4gICAgICBsZWZ0OiBNYXRoLm1pbih0aGlzLmZyb20uY29sLCB0aGlzLnRvLmNvbCksXG4gICAgICByaWdodDogTWF0aC5tYXgodGhpcy5mcm9tLmNvbCwgdGhpcy50by5jb2wpXG4gICAgfTtcbiAgICB2YXIgcmFuZ2VCb3JkZXJzID0ge1xuICAgICAgdG9wOiBNYXRoLm1pbihyYW5nZS5mcm9tLnJvdywgcmFuZ2UudG8ucm93KSxcbiAgICAgIGJvdHRvbTogTWF0aC5tYXgocmFuZ2UuZnJvbS5yb3csIHJhbmdlLnRvLnJvdyksXG4gICAgICBsZWZ0OiBNYXRoLm1pbihyYW5nZS5mcm9tLmNvbCwgcmFuZ2UudG8uY29sKSxcbiAgICAgIHJpZ2h0OiBNYXRoLm1heChyYW5nZS5mcm9tLmNvbCwgcmFuZ2UudG8uY29sKVxuICAgIH07XG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgIGlmICh0aGlzQm9yZGVycy50b3AgPT0gcmFuZ2VCb3JkZXJzLnRvcCkge1xuICAgICAgcmVzdWx0LnB1c2goJ3RvcCcpO1xuICAgIH1cbiAgICBpZiAodGhpc0JvcmRlcnMucmlnaHQgPT0gcmFuZ2VCb3JkZXJzLnJpZ2h0KSB7XG4gICAgICByZXN1bHQucHVzaCgncmlnaHQnKTtcbiAgICB9XG4gICAgaWYgKHRoaXNCb3JkZXJzLmJvdHRvbSA9PSByYW5nZUJvcmRlcnMuYm90dG9tKSB7XG4gICAgICByZXN1bHQucHVzaCgnYm90dG9tJyk7XG4gICAgfVxuICAgIGlmICh0aGlzQm9yZGVycy5sZWZ0ID09IHJhbmdlQm9yZGVycy5sZWZ0KSB7XG4gICAgICByZXN1bHQucHVzaCgnbGVmdCcpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9LFxuICBnZXRJbm5lcjogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHRvcExlZnQgPSB0aGlzLmdldFRvcExlZnRDb3JuZXIoKTtcbiAgICB2YXIgYm90dG9tUmlnaHQgPSB0aGlzLmdldEJvdHRvbVJpZ2h0Q29ybmVyKCk7XG4gICAgdmFyIG91dCA9IFtdO1xuICAgIGZvciAodmFyIHIgPSB0b3BMZWZ0LnJvdzsgciA8PSBib3R0b21SaWdodC5yb3c7IHIrKykge1xuICAgICAgZm9yICh2YXIgYyA9IHRvcExlZnQuY29sOyBjIDw9IGJvdHRvbVJpZ2h0LmNvbDsgYysrKSB7XG4gICAgICAgIGlmICghKHRoaXMuZnJvbS5yb3cgPT09IHIgJiYgdGhpcy5mcm9tLmNvbCA9PT0gYykgJiYgISh0aGlzLnRvLnJvdyA9PT0gciAmJiB0aGlzLnRvLmNvbCA9PT0gYykpIHtcbiAgICAgICAgICBvdXQucHVzaChuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHIsIGMpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb3V0O1xuICB9LFxuICBnZXRBbGw6IGZ1bmN0aW9uKCkge1xuICAgIHZhciB0b3BMZWZ0ID0gdGhpcy5nZXRUb3BMZWZ0Q29ybmVyKCk7XG4gICAgdmFyIGJvdHRvbVJpZ2h0ID0gdGhpcy5nZXRCb3R0b21SaWdodENvcm5lcigpO1xuICAgIHZhciBvdXQgPSBbXTtcbiAgICBmb3IgKHZhciByID0gdG9wTGVmdC5yb3c7IHIgPD0gYm90dG9tUmlnaHQucm93OyByKyspIHtcbiAgICAgIGZvciAodmFyIGMgPSB0b3BMZWZ0LmNvbDsgYyA8PSBib3R0b21SaWdodC5jb2w7IGMrKykge1xuICAgICAgICBpZiAodG9wTGVmdC5yb3cgPT09IHIgJiYgdG9wTGVmdC5jb2wgPT09IGMpIHtcbiAgICAgICAgICBvdXQucHVzaCh0b3BMZWZ0KTtcbiAgICAgICAgfSBlbHNlIGlmIChib3R0b21SaWdodC5yb3cgPT09IHIgJiYgYm90dG9tUmlnaHQuY29sID09PSBjKSB7XG4gICAgICAgICAgb3V0LnB1c2goYm90dG9tUmlnaHQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG91dC5wdXNoKG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMociwgYykpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG4gIH0sXG4gIGZvckFsbDogZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICB2YXIgdG9wTGVmdCA9IHRoaXMuZ2V0VG9wTGVmdENvcm5lcigpO1xuICAgIHZhciBib3R0b21SaWdodCA9IHRoaXMuZ2V0Qm90dG9tUmlnaHRDb3JuZXIoKTtcbiAgICBmb3IgKHZhciByID0gdG9wTGVmdC5yb3c7IHIgPD0gYm90dG9tUmlnaHQucm93OyByKyspIHtcbiAgICAgIGZvciAodmFyIGMgPSB0b3BMZWZ0LmNvbDsgYyA8PSBib3R0b21SaWdodC5jb2w7IGMrKykge1xuICAgICAgICB2YXIgYnJlYWtJdGVyYXRpb24gPSBjYWxsYmFjayhyLCBjKTtcbiAgICAgICAgaWYgKGJyZWFrSXRlcmF0aW9uID09PSBmYWxzZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufSwge30pO1xuO1xud2luZG93LldhbGtvbnRhYmxlQ2VsbFJhbmdlID0gV2Fsa29udGFibGVDZWxsUmFuZ2U7XG5cbi8vIyBcbn0se1wiY2VsbC9jb29yZHNcIjo2fV0sODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgV2Fsa29udGFibGU6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFdhbGtvbnRhYmxlO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3N0cmluZ19fLFxuICAgICRfX2V2ZW50X18sXG4gICAgJF9fb3ZlcmxheXNfXyxcbiAgICAkX19zY3JvbGxfXyxcbiAgICAkX19zZXR0aW5nc19fLFxuICAgICRfX3RhYmxlX18sXG4gICAgJF9fdmlld3BvcnRfXyxcbiAgICAkX19vdmVybGF5XzQ3X185NV9iYXNlXzQ2X2pzX18sXG4gICAgJF9fb3ZlcmxheV80N190b3BfNDZfanNfXyxcbiAgICAkX19vdmVybGF5XzQ3X2xlZnRfNDZfanNfXyxcbiAgICAkX19vdmVybGF5XzQ3X2RlYnVnXzQ2X2pzX18sXG4gICAgJF9fb3ZlcmxheV80N190b3BMZWZ0Q29ybmVyXzQ2X2pzX187XG52YXIgJF9fMCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSksXG4gICAgYWRkQ2xhc3MgPSAkX18wLmFkZENsYXNzLFxuICAgIGZhc3RJbm5lclRleHQgPSAkX18wLmZhc3RJbm5lclRleHQsXG4gICAgaXNWaXNpYmxlID0gJF9fMC5pc1Zpc2libGUsXG4gICAgcmVtb3ZlQ2xhc3MgPSAkX18wLnJlbW92ZUNsYXNzO1xudmFyIG9iamVjdEVhY2ggPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL29iamVjdFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfX30pLm9iamVjdEVhY2g7XG52YXIgJF9fMiA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3N0cmluZ19fID0gX2RlcmVxXyhcImhlbHBlcnMvc3RyaW5nXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3N0cmluZ19fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfc3RyaW5nX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3N0cmluZ19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3N0cmluZ19ffSksXG4gICAgdG9VcHBlckNhc2VGaXJzdCA9ICRfXzIudG9VcHBlckNhc2VGaXJzdCxcbiAgICByYW5kb21TdHJpbmcgPSAkX18yLnJhbmRvbVN0cmluZztcbnZhciBXYWxrb250YWJsZUV2ZW50ID0gKCRfX2V2ZW50X18gPSBfZGVyZXFfKFwiZXZlbnRcIiksICRfX2V2ZW50X18gJiYgJF9fZXZlbnRfXy5fX2VzTW9kdWxlICYmICRfX2V2ZW50X18gfHwge2RlZmF1bHQ6ICRfX2V2ZW50X199KS5XYWxrb250YWJsZUV2ZW50O1xudmFyIFdhbGtvbnRhYmxlT3ZlcmxheXMgPSAoJF9fb3ZlcmxheXNfXyA9IF9kZXJlcV8oXCJvdmVybGF5c1wiKSwgJF9fb3ZlcmxheXNfXyAmJiAkX19vdmVybGF5c19fLl9fZXNNb2R1bGUgJiYgJF9fb3ZlcmxheXNfXyB8fCB7ZGVmYXVsdDogJF9fb3ZlcmxheXNfX30pLldhbGtvbnRhYmxlT3ZlcmxheXM7XG52YXIgV2Fsa29udGFibGVTY3JvbGwgPSAoJF9fc2Nyb2xsX18gPSBfZGVyZXFfKFwic2Nyb2xsXCIpLCAkX19zY3JvbGxfXyAmJiAkX19zY3JvbGxfXy5fX2VzTW9kdWxlICYmICRfX3Njcm9sbF9fIHx8IHtkZWZhdWx0OiAkX19zY3JvbGxfX30pLldhbGtvbnRhYmxlU2Nyb2xsO1xudmFyIFdhbGtvbnRhYmxlU2V0dGluZ3MgPSAoJF9fc2V0dGluZ3NfXyA9IF9kZXJlcV8oXCJzZXR0aW5nc1wiKSwgJF9fc2V0dGluZ3NfXyAmJiAkX19zZXR0aW5nc19fLl9fZXNNb2R1bGUgJiYgJF9fc2V0dGluZ3NfXyB8fCB7ZGVmYXVsdDogJF9fc2V0dGluZ3NfX30pLldhbGtvbnRhYmxlU2V0dGluZ3M7XG52YXIgV2Fsa29udGFibGVUYWJsZSA9ICgkX190YWJsZV9fID0gX2RlcmVxXyhcInRhYmxlXCIpLCAkX190YWJsZV9fICYmICRfX3RhYmxlX18uX19lc01vZHVsZSAmJiAkX190YWJsZV9fIHx8IHtkZWZhdWx0OiAkX190YWJsZV9ffSkuV2Fsa29udGFibGVUYWJsZTtcbnZhciBXYWxrb250YWJsZVZpZXdwb3J0ID0gKCRfX3ZpZXdwb3J0X18gPSBfZGVyZXFfKFwidmlld3BvcnRcIiksICRfX3ZpZXdwb3J0X18gJiYgJF9fdmlld3BvcnRfXy5fX2VzTW9kdWxlICYmICRfX3ZpZXdwb3J0X18gfHwge2RlZmF1bHQ6ICRfX3ZpZXdwb3J0X199KS5XYWxrb250YWJsZVZpZXdwb3J0O1xudmFyIFdhbGtvbnRhYmxlT3ZlcmxheSA9ICgkX19vdmVybGF5XzQ3X185NV9iYXNlXzQ2X2pzX18gPSBfZGVyZXFfKFwib3ZlcmxheS9fYmFzZS5qc1wiKSwgJF9fb3ZlcmxheV80N19fOTVfYmFzZV80Nl9qc19fICYmICRfX292ZXJsYXlfNDdfXzk1X2Jhc2VfNDZfanNfXy5fX2VzTW9kdWxlICYmICRfX292ZXJsYXlfNDdfXzk1X2Jhc2VfNDZfanNfXyB8fCB7ZGVmYXVsdDogJF9fb3ZlcmxheV80N19fOTVfYmFzZV80Nl9qc19ffSkuV2Fsa29udGFibGVPdmVybGF5O1xudmFyIFdhbGtvbnRhYmxlVG9wT3ZlcmxheSA9ICgkX19vdmVybGF5XzQ3X3RvcF80Nl9qc19fID0gX2RlcmVxXyhcIm92ZXJsYXkvdG9wLmpzXCIpLCAkX19vdmVybGF5XzQ3X3RvcF80Nl9qc19fICYmICRfX292ZXJsYXlfNDdfdG9wXzQ2X2pzX18uX19lc01vZHVsZSAmJiAkX19vdmVybGF5XzQ3X3RvcF80Nl9qc19fIHx8IHtkZWZhdWx0OiAkX19vdmVybGF5XzQ3X3RvcF80Nl9qc19ffSkuV2Fsa29udGFibGVUb3BPdmVybGF5O1xudmFyIFdhbGtvbnRhYmxlTGVmdE92ZXJsYXkgPSAoJF9fb3ZlcmxheV80N19sZWZ0XzQ2X2pzX18gPSBfZGVyZXFfKFwib3ZlcmxheS9sZWZ0LmpzXCIpLCAkX19vdmVybGF5XzQ3X2xlZnRfNDZfanNfXyAmJiAkX19vdmVybGF5XzQ3X2xlZnRfNDZfanNfXy5fX2VzTW9kdWxlICYmICRfX292ZXJsYXlfNDdfbGVmdF80Nl9qc19fIHx8IHtkZWZhdWx0OiAkX19vdmVybGF5XzQ3X2xlZnRfNDZfanNfX30pLldhbGtvbnRhYmxlTGVmdE92ZXJsYXk7XG52YXIgV2Fsa29udGFibGVEZWJ1Z092ZXJsYXkgPSAoJF9fb3ZlcmxheV80N19kZWJ1Z180Nl9qc19fID0gX2RlcmVxXyhcIm92ZXJsYXkvZGVidWcuanNcIiksICRfX292ZXJsYXlfNDdfZGVidWdfNDZfanNfXyAmJiAkX19vdmVybGF5XzQ3X2RlYnVnXzQ2X2pzX18uX19lc01vZHVsZSAmJiAkX19vdmVybGF5XzQ3X2RlYnVnXzQ2X2pzX18gfHwge2RlZmF1bHQ6ICRfX292ZXJsYXlfNDdfZGVidWdfNDZfanNfX30pLldhbGtvbnRhYmxlRGVidWdPdmVybGF5O1xudmFyIFdhbGtvbnRhYmxlVG9wTGVmdENvcm5lck92ZXJsYXkgPSAoJF9fb3ZlcmxheV80N190b3BMZWZ0Q29ybmVyXzQ2X2pzX18gPSBfZGVyZXFfKFwib3ZlcmxheS90b3BMZWZ0Q29ybmVyLmpzXCIpLCAkX19vdmVybGF5XzQ3X3RvcExlZnRDb3JuZXJfNDZfanNfXyAmJiAkX19vdmVybGF5XzQ3X3RvcExlZnRDb3JuZXJfNDZfanNfXy5fX2VzTW9kdWxlICYmICRfX292ZXJsYXlfNDdfdG9wTGVmdENvcm5lcl80Nl9qc19fIHx8IHtkZWZhdWx0OiAkX19vdmVybGF5XzQ3X3RvcExlZnRDb3JuZXJfNDZfanNfX30pLldhbGtvbnRhYmxlVG9wTGVmdENvcm5lck92ZXJsYXk7XG52YXIgV2Fsa29udGFibGUgPSBmdW5jdGlvbiBXYWxrb250YWJsZShzZXR0aW5ncykge1xuICB2YXIgb3JpZ2luYWxIZWFkZXJzID0gW107XG4gIHRoaXMuZ3VpZCA9ICd3dF8nICsgcmFuZG9tU3RyaW5nKCk7XG4gIGlmIChzZXR0aW5ncy5jbG9uZVNvdXJjZSkge1xuICAgIHRoaXMuY2xvbmVTb3VyY2UgPSBzZXR0aW5ncy5jbG9uZVNvdXJjZTtcbiAgICB0aGlzLmNsb25lT3ZlcmxheSA9IHNldHRpbmdzLmNsb25lT3ZlcmxheTtcbiAgICB0aGlzLnd0U2V0dGluZ3MgPSBzZXR0aW5ncy5jbG9uZVNvdXJjZS53dFNldHRpbmdzO1xuICAgIHRoaXMud3RUYWJsZSA9IG5ldyBXYWxrb250YWJsZVRhYmxlKHRoaXMsIHNldHRpbmdzLnRhYmxlLCBzZXR0aW5ncy53dFJvb3RFbGVtZW50KTtcbiAgICB0aGlzLnd0U2Nyb2xsID0gbmV3IFdhbGtvbnRhYmxlU2Nyb2xsKHRoaXMpO1xuICAgIHRoaXMud3RWaWV3cG9ydCA9IHNldHRpbmdzLmNsb25lU291cmNlLnd0Vmlld3BvcnQ7XG4gICAgdGhpcy53dEV2ZW50ID0gbmV3IFdhbGtvbnRhYmxlRXZlbnQodGhpcyk7XG4gICAgdGhpcy5zZWxlY3Rpb25zID0gdGhpcy5jbG9uZVNvdXJjZS5zZWxlY3Rpb25zO1xuICB9IGVsc2Uge1xuICAgIHRoaXMud3RTZXR0aW5ncyA9IG5ldyBXYWxrb250YWJsZVNldHRpbmdzKHRoaXMsIHNldHRpbmdzKTtcbiAgICB0aGlzLnd0VGFibGUgPSBuZXcgV2Fsa29udGFibGVUYWJsZSh0aGlzLCBzZXR0aW5ncy50YWJsZSk7XG4gICAgdGhpcy53dFNjcm9sbCA9IG5ldyBXYWxrb250YWJsZVNjcm9sbCh0aGlzKTtcbiAgICB0aGlzLnd0Vmlld3BvcnQgPSBuZXcgV2Fsa29udGFibGVWaWV3cG9ydCh0aGlzKTtcbiAgICB0aGlzLnd0RXZlbnQgPSBuZXcgV2Fsa29udGFibGVFdmVudCh0aGlzKTtcbiAgICB0aGlzLnNlbGVjdGlvbnMgPSB0aGlzLmdldFNldHRpbmcoJ3NlbGVjdGlvbnMnKTtcbiAgICB0aGlzLnd0T3ZlcmxheXMgPSBuZXcgV2Fsa29udGFibGVPdmVybGF5cyh0aGlzKTtcbiAgICB0aGlzLmV4cG9ydFNldHRpbmdzQXNDbGFzc05hbWVzKCk7XG4gIH1cbiAgaWYgKHRoaXMud3RUYWJsZS5USEVBRC5jaGlsZE5vZGVzLmxlbmd0aCAmJiB0aGlzLnd0VGFibGUuVEhFQUQuY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzLmxlbmd0aCkge1xuICAgIGZvciAodmFyIGMgPSAwLFxuICAgICAgICBjbGVuID0gdGhpcy53dFRhYmxlLlRIRUFELmNoaWxkTm9kZXNbMF0uY2hpbGROb2Rlcy5sZW5ndGg7IGMgPCBjbGVuOyBjKyspIHtcbiAgICAgIG9yaWdpbmFsSGVhZGVycy5wdXNoKHRoaXMud3RUYWJsZS5USEVBRC5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbY10uaW5uZXJIVE1MKTtcbiAgICB9XG4gICAgaWYgKCF0aGlzLmdldFNldHRpbmcoJ2NvbHVtbkhlYWRlcnMnKS5sZW5ndGgpIHtcbiAgICAgIHRoaXMudXBkYXRlKCdjb2x1bW5IZWFkZXJzJywgW2Z1bmN0aW9uKGNvbHVtbiwgVEgpIHtcbiAgICAgICAgZmFzdElubmVyVGV4dChUSCwgb3JpZ2luYWxIZWFkZXJzW2NvbHVtbl0pO1xuICAgICAgfV0pO1xuICAgIH1cbiAgfVxuICB0aGlzLmRyYXduID0gZmFsc2U7XG4gIHRoaXMuZHJhd0ludGVycnVwdGVkID0gZmFsc2U7XG59O1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoV2Fsa29udGFibGUsIHtcbiAgZHJhdzogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGZhc3REcmF3ID0gYXJndW1lbnRzWzBdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1swXSA6IGZhbHNlO1xuICAgIHRoaXMuZHJhd0ludGVycnVwdGVkID0gZmFsc2U7XG4gICAgaWYgKCFmYXN0RHJhdyAmJiAhaXNWaXNpYmxlKHRoaXMud3RUYWJsZS5UQUJMRSkpIHtcbiAgICAgIHRoaXMuZHJhd0ludGVycnVwdGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy53dFRhYmxlLmRyYXcoZmFzdERyYXcpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbiAgZ2V0Q2VsbDogZnVuY3Rpb24oY29vcmRzKSB7XG4gICAgdmFyIHRvcG1vc3QgPSBhcmd1bWVudHNbMV0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzFdIDogZmFsc2U7XG4gICAgaWYgKCF0b3Btb3N0KSB7XG4gICAgICByZXR1cm4gdGhpcy53dFRhYmxlLmdldENlbGwoY29vcmRzKTtcbiAgICB9XG4gICAgdmFyIHRvdGFsUm93cyA9IHRoaXMud3RTZXR0aW5ncy5nZXRTZXR0aW5nKCd0b3RhbFJvd3MnKTtcbiAgICB2YXIgZml4ZWRSb3dzVG9wID0gdGhpcy53dFNldHRpbmdzLmdldFNldHRpbmcoJ2ZpeGVkUm93c1RvcCcpO1xuICAgIHZhciBmaXhlZFJvd3NCb3R0b20gPSB0aGlzLnd0U2V0dGluZ3MuZ2V0U2V0dGluZygnZml4ZWRSb3dzQm90dG9tJyk7XG4gICAgdmFyIGZpeGVkQ29sdW1ucyA9IHRoaXMud3RTZXR0aW5ncy5nZXRTZXR0aW5nKCdmaXhlZENvbHVtbnNMZWZ0Jyk7XG4gICAgaWYgKGNvb3Jkcy5yb3cgPCBmaXhlZFJvd3NUb3AgJiYgY29vcmRzLmNvbCA8IGZpeGVkQ29sdW1ucykge1xuICAgICAgcmV0dXJuIHRoaXMud3RPdmVybGF5cy50b3BMZWZ0Q29ybmVyT3ZlcmxheS5jbG9uZS53dFRhYmxlLmdldENlbGwoY29vcmRzKTtcbiAgICB9IGVsc2UgaWYgKGNvb3Jkcy5yb3cgPCBmaXhlZFJvd3NUb3ApIHtcbiAgICAgIHJldHVybiB0aGlzLnd0T3ZlcmxheXMudG9wT3ZlcmxheS5jbG9uZS53dFRhYmxlLmdldENlbGwoY29vcmRzKTtcbiAgICB9IGVsc2UgaWYgKGNvb3Jkcy5jb2wgPCBmaXhlZENvbHVtbnMgJiYgY29vcmRzLnJvdyA+PSB0b3RhbFJvd3MgLSBmaXhlZFJvd3NCb3R0b20pIHtcbiAgICAgIGlmICh0aGlzLnd0T3ZlcmxheXMuYm90dG9tTGVmdENvcm5lck92ZXJsYXkgJiYgdGhpcy53dE92ZXJsYXlzLmJvdHRvbUxlZnRDb3JuZXJPdmVybGF5LmNsb25lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnd0T3ZlcmxheXMuYm90dG9tTGVmdENvcm5lck92ZXJsYXkuY2xvbmUud3RUYWJsZS5nZXRDZWxsKGNvb3Jkcyk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChjb29yZHMuY29sIDwgZml4ZWRDb2x1bW5zKSB7XG4gICAgICByZXR1cm4gdGhpcy53dE92ZXJsYXlzLmxlZnRPdmVybGF5LmNsb25lLnd0VGFibGUuZ2V0Q2VsbChjb29yZHMpO1xuICAgIH0gZWxzZSBpZiAoY29vcmRzLnJvdyA8IHRvdGFsUm93cyAmJiBjb29yZHMucm93ID4gdG90YWxSb3dzIC0gZml4ZWRSb3dzQm90dG9tKSB7XG4gICAgICBpZiAodGhpcy53dE92ZXJsYXlzLmJvdHRvbU92ZXJsYXkgJiYgdGhpcy53dE92ZXJsYXlzLmJvdHRvbU92ZXJsYXkuY2xvbmUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMud3RPdmVybGF5cy5ib3R0b21PdmVybGF5LmNsb25lLnd0VGFibGUuZ2V0Q2VsbChjb29yZHMpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy53dFRhYmxlLmdldENlbGwoY29vcmRzKTtcbiAgfSxcbiAgdXBkYXRlOiBmdW5jdGlvbihzZXR0aW5ncywgdmFsdWUpIHtcbiAgICByZXR1cm4gdGhpcy53dFNldHRpbmdzLnVwZGF0ZShzZXR0aW5ncywgdmFsdWUpO1xuICB9LFxuICBzY3JvbGxWZXJ0aWNhbDogZnVuY3Rpb24ocm93KSB7XG4gICAgdGhpcy53dE92ZXJsYXlzLnRvcE92ZXJsYXkuc2Nyb2xsVG8ocm93KTtcbiAgICB0aGlzLmdldFNldHRpbmcoJ29uU2Nyb2xsVmVydGljYWxseScpO1xuICAgIHJldHVybiB0aGlzO1xuICB9LFxuICBzY3JvbGxIb3Jpem9udGFsOiBmdW5jdGlvbihjb2x1bW4pIHtcbiAgICB0aGlzLnd0T3ZlcmxheXMubGVmdE92ZXJsYXkuc2Nyb2xsVG8oY29sdW1uKTtcbiAgICB0aGlzLmdldFNldHRpbmcoJ29uU2Nyb2xsSG9yaXpvbnRhbGx5Jyk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIHNjcm9sbFZpZXdwb3J0OiBmdW5jdGlvbihjb29yZHMpIHtcbiAgICB0aGlzLnd0U2Nyb2xsLnNjcm9sbFZpZXdwb3J0KGNvb3Jkcyk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIGdldFZpZXdwb3J0OiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gW3RoaXMud3RUYWJsZS5nZXRGaXJzdFZpc2libGVSb3coKSwgdGhpcy53dFRhYmxlLmdldEZpcnN0VmlzaWJsZUNvbHVtbigpLCB0aGlzLnd0VGFibGUuZ2V0TGFzdFZpc2libGVSb3coKSwgdGhpcy53dFRhYmxlLmdldExhc3RWaXNpYmxlQ29sdW1uKCldO1xuICB9LFxuICBnZXRPdmVybGF5TmFtZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuY2xvbmVPdmVybGF5ID8gdGhpcy5jbG9uZU92ZXJsYXkudHlwZSA6ICdtYXN0ZXInO1xuICB9LFxuICBpc092ZXJsYXlOYW1lOiBmdW5jdGlvbihuYW1lKSB7XG4gICAgaWYgKHRoaXMuY2xvbmVPdmVybGF5KSB7XG4gICAgICByZXR1cm4gdGhpcy5jbG9uZU92ZXJsYXkudHlwZSA9PT0gbmFtZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuICBleHBvcnRTZXR0aW5nc0FzQ2xhc3NOYW1lczogZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzE0ID0gdGhpcztcbiAgICB2YXIgdG9FeHBvcnQgPSB7XG4gICAgICByb3dIZWFkZXJzOiBbJ2FycmF5J10sXG4gICAgICBjb2x1bW5IZWFkZXJzOiBbJ2FycmF5J11cbiAgICB9O1xuICAgIHZhciBhbGxDbGFzc05hbWVzID0gW107XG4gICAgdmFyIG5ld0NsYXNzTmFtZXMgPSBbXTtcbiAgICBvYmplY3RFYWNoKHRvRXhwb3J0LCAoZnVuY3Rpb24ob3B0aW9uVHlwZSwga2V5KSB7XG4gICAgICBpZiAob3B0aW9uVHlwZS5pbmRleE9mKCdhcnJheScpID4gLTEgJiYgJF9fMTQuZ2V0U2V0dGluZyhrZXkpLmxlbmd0aCkge1xuICAgICAgICBuZXdDbGFzc05hbWVzLnB1c2goJ2h0JyArIHRvVXBwZXJDYXNlRmlyc3Qoa2V5KSk7XG4gICAgICB9XG4gICAgICBhbGxDbGFzc05hbWVzLnB1c2goJ2h0JyArIHRvVXBwZXJDYXNlRmlyc3Qoa2V5KSk7XG4gICAgfSkpO1xuICAgIHJlbW92ZUNsYXNzKHRoaXMud3RUYWJsZS53dFJvb3RFbGVtZW50LnBhcmVudE5vZGUsIGFsbENsYXNzTmFtZXMpO1xuICAgIGFkZENsYXNzKHRoaXMud3RUYWJsZS53dFJvb3RFbGVtZW50LnBhcmVudE5vZGUsIG5ld0NsYXNzTmFtZXMpO1xuICB9LFxuICBnZXRTZXR0aW5nOiBmdW5jdGlvbihrZXksIHBhcmFtMSwgcGFyYW0yLCBwYXJhbTMsIHBhcmFtNCkge1xuICAgIHJldHVybiB0aGlzLnd0U2V0dGluZ3MuZ2V0U2V0dGluZyhrZXksIHBhcmFtMSwgcGFyYW0yLCBwYXJhbTMsIHBhcmFtNCk7XG4gIH0sXG4gIGhhc1NldHRpbmc6IGZ1bmN0aW9uKGtleSkge1xuICAgIHJldHVybiB0aGlzLnd0U2V0dGluZ3MuaGFzKGtleSk7XG4gIH0sXG4gIGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMud3RPdmVybGF5cy5kZXN0cm95KCk7XG4gICAgdGhpcy53dEV2ZW50LmRlc3Ryb3koKTtcbiAgfVxufSwge30pO1xuO1xud2luZG93LldhbGtvbnRhYmxlID0gV2Fsa29udGFibGU7XG5cbi8vIyBcbn0se1wiZXZlbnRcIjo5LFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwiaGVscGVycy9vYmplY3RcIjo1MyxcImhlbHBlcnMvc3RyaW5nXCI6NTUsXCJvdmVybGF5L19iYXNlLmpzXCI6MTIsXCJvdmVybGF5L2RlYnVnLmpzXCI6MTMsXCJvdmVybGF5L2xlZnQuanNcIjoxNCxcIm92ZXJsYXkvdG9wLmpzXCI6MTUsXCJvdmVybGF5L3RvcExlZnRDb3JuZXIuanNcIjoxNixcIm92ZXJsYXlzXCI6MTcsXCJzY3JvbGxcIjoxOCxcInNldHRpbmdzXCI6MjAsXCJ0YWJsZVwiOjIxLFwidmlld3BvcnRcIjoyM31dLDk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIFdhbGtvbnRhYmxlRXZlbnQ6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFdhbGtvbnRhYmxlRXZlbnQ7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Z1bmN0aW9uX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19icm93c2VyX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX187XG52YXIgJF9fMCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSksXG4gICAgY2xvc2VzdERvd24gPSAkX18wLmNsb3Nlc3REb3duLFxuICAgIGhhc0NsYXNzID0gJF9fMC5oYXNDbGFzcyxcbiAgICBpc0NoaWxkT2YgPSAkX18wLmlzQ2hpbGRPZixcbiAgICBnZXRQYXJlbnQgPSAkX18wLmdldFBhcmVudDtcbnZhciBwYXJ0aWFsID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZnVuY3Rpb25fXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2Z1bmN0aW9uXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Z1bmN0aW9uX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19mdW5jdGlvbl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19mdW5jdGlvbl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Z1bmN0aW9uX199KS5wYXJ0aWFsO1xudmFyIGlzTW9iaWxlQnJvd3NlciA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2Jyb3dzZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYnJvd3Nlcl9ffSkuaXNNb2JpbGVCcm93c2VyO1xudmFyIGV2ZW50TWFuYWdlck9iamVjdCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyA9IF9kZXJlcV8oXCJldmVudE1hbmFnZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9ffSkuZXZlbnRNYW5hZ2VyO1xuZnVuY3Rpb24gV2Fsa29udGFibGVFdmVudChpbnN0YW5jZSkge1xuICB2YXIgdGhhdCA9IHRoaXM7XG4gIHZhciBldmVudE1hbmFnZXIgPSBldmVudE1hbmFnZXJPYmplY3QoaW5zdGFuY2UpO1xuICB0aGlzLmluc3RhbmNlID0gaW5zdGFuY2U7XG4gIHZhciBkYmxDbGlja09yaWdpbiA9IFtudWxsLCBudWxsXTtcbiAgdGhpcy5kYmxDbGlja1RpbWVvdXQgPSBbbnVsbCwgbnVsbF07XG4gIHZhciBvbk1vdXNlRG93biA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIGFjdGl2ZUVsZW1lbnQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICAgIHZhciBnZXRQYXJlbnROb2RlID0gcGFydGlhbChnZXRQYXJlbnQsIGV2ZW50LnJlYWxUYXJnZXQpO1xuICAgIHZhciByZWFsVGFyZ2V0ID0gZXZlbnQucmVhbFRhcmdldDtcbiAgICBpZiAocmVhbFRhcmdldCA9PT0gYWN0aXZlRWxlbWVudCB8fCBnZXRQYXJlbnROb2RlKDApID09PSBhY3RpdmVFbGVtZW50IHx8IGdldFBhcmVudE5vZGUoMSkgPT09IGFjdGl2ZUVsZW1lbnQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGNlbGwgPSB0aGF0LnBhcmVudENlbGwocmVhbFRhcmdldCk7XG4gICAgaWYgKGhhc0NsYXNzKHJlYWxUYXJnZXQsICdjb3JuZXInKSkge1xuICAgICAgdGhhdC5pbnN0YW5jZS5nZXRTZXR0aW5nKCdvbkNlbGxDb3JuZXJNb3VzZURvd24nLCBldmVudCwgcmVhbFRhcmdldCk7XG4gICAgfSBlbHNlIGlmIChjZWxsLlREKSB7XG4gICAgICBpZiAodGhhdC5pbnN0YW5jZS5oYXNTZXR0aW5nKCdvbkNlbGxNb3VzZURvd24nKSkge1xuICAgICAgICB0aGF0Lmluc3RhbmNlLmdldFNldHRpbmcoJ29uQ2VsbE1vdXNlRG93bicsIGV2ZW50LCBjZWxsLmNvb3JkcywgY2VsbC5URCwgdGhhdC5pbnN0YW5jZSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChldmVudC5idXR0b24gIT09IDIpIHtcbiAgICAgIGlmIChjZWxsLlREKSB7XG4gICAgICAgIGRibENsaWNrT3JpZ2luWzBdID0gY2VsbC5URDtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoYXQuZGJsQ2xpY2tUaW1lb3V0WzBdKTtcbiAgICAgICAgdGhhdC5kYmxDbGlja1RpbWVvdXRbMF0gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGRibENsaWNrT3JpZ2luWzBdID0gbnVsbDtcbiAgICAgICAgfSwgMTAwMCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuICB2YXIgb25Ub3VjaE1vdmUgPSBmdW5jdGlvbihldmVudCkge1xuICAgIHRoYXQuaW5zdGFuY2UudG91Y2hNb3ZpbmcgPSB0cnVlO1xuICB9O1xuICB2YXIgbG9uZ1RvdWNoVGltZW91dDtcbiAgdmFyIG9uVG91Y2hTdGFydCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIGNvbnRhaW5lciA9IHRoaXM7XG4gICAgZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGhpcywgJ3RvdWNobW92ZScsIG9uVG91Y2hNb3ZlKTtcbiAgICB0aGF0LmNoZWNrSWZUb3VjaE1vdmUgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoYXQuaW5zdGFuY2UudG91Y2hNb3ZpbmcgPT09IHRydWUpIHtcbiAgICAgICAgdGhhdC5pbnN0YW5jZS50b3VjaE1vdmluZyA9IHZvaWQgMDtcbiAgICAgICAgZXZlbnRNYW5hZ2VyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIG9uVG91Y2hNb3ZlLCBmYWxzZSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9uTW91c2VEb3duKGV2ZW50KTtcbiAgICAgIH1cbiAgICB9LCAzMCk7XG4gIH07XG4gIHZhciBvbk1vdXNlT3ZlciA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIHRhYmxlLFxuICAgICAgICB0ZCxcbiAgICAgICAgbWFpbldPVDtcbiAgICBpZiAodGhhdC5pbnN0YW5jZS5oYXNTZXR0aW5nKCdvbkNlbGxNb3VzZU92ZXInKSkge1xuICAgICAgdGFibGUgPSB0aGF0Lmluc3RhbmNlLnd0VGFibGUuVEFCTEU7XG4gICAgICB0ZCA9IGNsb3Nlc3REb3duKGV2ZW50LnJlYWxUYXJnZXQsIFsnVEQnLCAnVEgnXSwgdGFibGUpO1xuICAgICAgbWFpbldPVCA9IHRoYXQuaW5zdGFuY2UuY2xvbmVTb3VyY2UgfHwgdGhhdC5pbnN0YW5jZTtcbiAgICAgIGlmICh0ZCAmJiB0ZCAhPT0gbWFpbldPVC5sYXN0TW91c2VPdmVyICYmIGlzQ2hpbGRPZih0ZCwgdGFibGUpKSB7XG4gICAgICAgIG1haW5XT1QubGFzdE1vdXNlT3ZlciA9IHRkO1xuICAgICAgICB0aGF0Lmluc3RhbmNlLmdldFNldHRpbmcoJ29uQ2VsbE1vdXNlT3ZlcicsIGV2ZW50LCB0aGF0Lmluc3RhbmNlLnd0VGFibGUuZ2V0Q29vcmRzKHRkKSwgdGQsIHRoYXQuaW5zdGFuY2UpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgdmFyIG9uTW91c2VPdXQgPSBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciB0YWJsZSxcbiAgICAgICAgbGFzdFRELFxuICAgICAgICBuZXh0VEQ7XG4gICAgaWYgKHRoYXQuaW5zdGFuY2UuaGFzU2V0dGluZygnb25DZWxsTW91c2VPdXQnKSkge1xuICAgICAgdGFibGUgPSB0aGF0Lmluc3RhbmNlLnd0VGFibGUuVEFCTEU7XG4gICAgICBsYXN0VEQgPSBjbG9zZXN0RG93bihldmVudC5yZWFsVGFyZ2V0LCBbJ1REJywgJ1RIJ10sIHRhYmxlKTtcbiAgICAgIG5leHRURCA9IGNsb3Nlc3REb3duKGV2ZW50LnJlbGF0ZWRUYXJnZXQsIFsnVEQnLCAnVEgnXSwgdGFibGUpO1xuICAgICAgaWYgKGxhc3RURCAmJiBsYXN0VEQgIT09IG5leHRURCAmJiBpc0NoaWxkT2YobGFzdFRELCB0YWJsZSkpIHtcbiAgICAgICAgdGhhdC5pbnN0YW5jZS5nZXRTZXR0aW5nKCdvbkNlbGxNb3VzZU91dCcsIGV2ZW50LCB0aGF0Lmluc3RhbmNlLnd0VGFibGUuZ2V0Q29vcmRzKGxhc3RURCksIGxhc3RURCwgdGhhdC5pbnN0YW5jZSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuICB2YXIgb25Nb3VzZVVwID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQuYnV0dG9uICE9PSAyKSB7XG4gICAgICB2YXIgY2VsbCA9IHRoYXQucGFyZW50Q2VsbChldmVudC5yZWFsVGFyZ2V0KTtcbiAgICAgIGlmIChjZWxsLlREID09PSBkYmxDbGlja09yaWdpblswXSAmJiBjZWxsLlREID09PSBkYmxDbGlja09yaWdpblsxXSkge1xuICAgICAgICBpZiAoaGFzQ2xhc3MoZXZlbnQucmVhbFRhcmdldCwgJ2Nvcm5lcicpKSB7XG4gICAgICAgICAgdGhhdC5pbnN0YW5jZS5nZXRTZXR0aW5nKCdvbkNlbGxDb3JuZXJEYmxDbGljaycsIGV2ZW50LCBjZWxsLmNvb3JkcywgY2VsbC5URCwgdGhhdC5pbnN0YW5jZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhhdC5pbnN0YW5jZS5nZXRTZXR0aW5nKCdvbkNlbGxEYmxDbGljaycsIGV2ZW50LCBjZWxsLmNvb3JkcywgY2VsbC5URCwgdGhhdC5pbnN0YW5jZSk7XG4gICAgICAgIH1cbiAgICAgICAgZGJsQ2xpY2tPcmlnaW5bMF0gPSBudWxsO1xuICAgICAgICBkYmxDbGlja09yaWdpblsxXSA9IG51bGw7XG4gICAgICB9IGVsc2UgaWYgKGNlbGwuVEQgPT09IGRibENsaWNrT3JpZ2luWzBdKSB7XG4gICAgICAgIHRoYXQuaW5zdGFuY2UuZ2V0U2V0dGluZygnb25DZWxsTW91c2VVcCcsIGV2ZW50LCBjZWxsLmNvb3JkcywgY2VsbC5URCwgdGhhdC5pbnN0YW5jZSk7XG4gICAgICAgIGRibENsaWNrT3JpZ2luWzFdID0gY2VsbC5URDtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoYXQuZGJsQ2xpY2tUaW1lb3V0WzFdKTtcbiAgICAgICAgdGhhdC5kYmxDbGlja1RpbWVvdXRbMV0gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGRibENsaWNrT3JpZ2luWzFdID0gbnVsbDtcbiAgICAgICAgfSwgNTAwKTtcbiAgICAgIH0gZWxzZSBpZiAoY2VsbC5URCAmJiB0aGF0Lmluc3RhbmNlLmhhc1NldHRpbmcoJ29uQ2VsbE1vdXNlVXAnKSkge1xuICAgICAgICB0aGF0Lmluc3RhbmNlLmdldFNldHRpbmcoJ29uQ2VsbE1vdXNlVXAnLCBldmVudCwgY2VsbC5jb29yZHMsIGNlbGwuVEQsIHRoYXQuaW5zdGFuY2UpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgdmFyIG9uVG91Y2hFbmQgPSBmdW5jdGlvbihldmVudCkge1xuICAgIGNsZWFyVGltZW91dChsb25nVG91Y2hUaW1lb3V0KTtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIG9uTW91c2VVcChldmVudCk7XG4gIH07XG4gIGV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKHRoaXMuaW5zdGFuY2Uud3RUYWJsZS5ob2xkZXIsICdtb3VzZWRvd24nLCBvbk1vdXNlRG93bik7XG4gIGV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKHRoaXMuaW5zdGFuY2Uud3RUYWJsZS5UQUJMRSwgJ21vdXNlb3ZlcicsIG9uTW91c2VPdmVyKTtcbiAgZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5pbnN0YW5jZS53dFRhYmxlLlRBQkxFLCAnbW91c2VvdXQnLCBvbk1vdXNlT3V0KTtcbiAgZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5pbnN0YW5jZS53dFRhYmxlLmhvbGRlciwgJ21vdXNldXAnLCBvbk1vdXNlVXApO1xuICBpZiAodGhpcy5pbnN0YW5jZS53dFRhYmxlLmhvbGRlci5wYXJlbnROb2RlLnBhcmVudE5vZGUgJiYgaXNNb2JpbGVCcm93c2VyKCkgJiYgIXRoYXQuaW5zdGFuY2Uud3RUYWJsZS5pc1dvcmtpbmdPbkNsb25lKCkpIHtcbiAgICB2YXIgY2xhc3NTZWxlY3RvciA9ICcuJyArIHRoaXMuaW5zdGFuY2Uud3RUYWJsZS5ob2xkZXIucGFyZW50Tm9kZS5jbGFzc05hbWUuc3BsaXQoJyAnKS5qb2luKCcuJyk7XG4gICAgZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5pbnN0YW5jZS53dFRhYmxlLmhvbGRlciwgJ3RvdWNoc3RhcnQnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgdGhhdC5pbnN0YW5jZS50b3VjaEFwcGxpZWQgPSB0cnVlO1xuICAgICAgaWYgKGlzQ2hpbGRPZihldmVudC50YXJnZXQsIGNsYXNzU2VsZWN0b3IpKSB7XG4gICAgICAgIG9uVG91Y2hTdGFydC5jYWxsKGV2ZW50LnRhcmdldCwgZXZlbnQpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKHRoaXMuaW5zdGFuY2Uud3RUYWJsZS5ob2xkZXIsICd0b3VjaGVuZCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICB0aGF0Lmluc3RhbmNlLnRvdWNoQXBwbGllZCA9IGZhbHNlO1xuICAgICAgaWYgKGlzQ2hpbGRPZihldmVudC50YXJnZXQsIGNsYXNzU2VsZWN0b3IpKSB7XG4gICAgICAgIG9uVG91Y2hFbmQuY2FsbChldmVudC50YXJnZXQsIGV2ZW50KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoIXRoYXQuaW5zdGFuY2UubW9tZW50dW1TY3JvbGxpbmcpIHtcbiAgICAgIHRoYXQuaW5zdGFuY2UubW9tZW50dW1TY3JvbGxpbmcgPSB7fTtcbiAgICB9XG4gICAgZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5pbnN0YW5jZS53dFRhYmxlLmhvbGRlciwgJ3Njcm9sbCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhhdC5pbnN0YW5jZS5tb21lbnR1bVNjcm9sbGluZy5fdGltZW91dCk7XG4gICAgICBpZiAoIXRoYXQuaW5zdGFuY2UubW9tZW50dW1TY3JvbGxpbmcub25nb2luZykge1xuICAgICAgICB0aGF0Lmluc3RhbmNlLmdldFNldHRpbmcoJ29uQmVmb3JlVG91Y2hTY3JvbGwnKTtcbiAgICAgIH1cbiAgICAgIHRoYXQuaW5zdGFuY2UubW9tZW50dW1TY3JvbGxpbmcub25nb2luZyA9IHRydWU7XG4gICAgICB0aGF0Lmluc3RhbmNlLm1vbWVudHVtU2Nyb2xsaW5nLl90aW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCF0aGF0Lmluc3RhbmNlLnRvdWNoQXBwbGllZCkge1xuICAgICAgICAgIHRoYXQuaW5zdGFuY2UubW9tZW50dW1TY3JvbGxpbmcub25nb2luZyA9IGZhbHNlO1xuICAgICAgICAgIHRoYXQuaW5zdGFuY2UuZ2V0U2V0dGluZygnb25BZnRlck1vbWVudHVtU2Nyb2xsJyk7XG4gICAgICAgIH1cbiAgICAgIH0sIDIwMCk7XG4gICAgfSk7XG4gIH1cbiAgZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIod2luZG93LCAncmVzaXplJywgZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoYXQuaW5zdGFuY2UuZ2V0U2V0dGluZygnc3RyZXRjaEgnKSAhPT0gJ25vbmUnKSB7XG4gICAgICB0aGF0Lmluc3RhbmNlLmRyYXcoKTtcbiAgICB9XG4gIH0pO1xuICB0aGlzLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICBjbGVhclRpbWVvdXQodGhpcy5kYmxDbGlja1RpbWVvdXRbMF0pO1xuICAgIGNsZWFyVGltZW91dCh0aGlzLmRibENsaWNrVGltZW91dFsxXSk7XG4gICAgZXZlbnRNYW5hZ2VyLmRlc3Ryb3koKTtcbiAgfTtcbn1cbldhbGtvbnRhYmxlRXZlbnQucHJvdG90eXBlLnBhcmVudENlbGwgPSBmdW5jdGlvbihlbGVtKSB7XG4gIHZhciBjZWxsID0ge307XG4gIHZhciBUQUJMRSA9IHRoaXMuaW5zdGFuY2Uud3RUYWJsZS5UQUJMRTtcbiAgdmFyIFREID0gY2xvc2VzdERvd24oZWxlbSwgWydURCcsICdUSCddLCBUQUJMRSk7XG4gIGlmIChURCkge1xuICAgIGNlbGwuY29vcmRzID0gdGhpcy5pbnN0YW5jZS53dFRhYmxlLmdldENvb3JkcyhURCk7XG4gICAgY2VsbC5URCA9IFREO1xuICB9IGVsc2UgaWYgKGhhc0NsYXNzKGVsZW0sICd3dEJvcmRlcicpICYmIGhhc0NsYXNzKGVsZW0sICdjdXJyZW50JykpIHtcbiAgICBjZWxsLmNvb3JkcyA9IHRoaXMuaW5zdGFuY2Uuc2VsZWN0aW9ucy5jdXJyZW50LmNlbGxSYW5nZS5oaWdobGlnaHQ7XG4gICAgY2VsbC5URCA9IHRoaXMuaW5zdGFuY2Uud3RUYWJsZS5nZXRDZWxsKGNlbGwuY29vcmRzKTtcbiAgfSBlbHNlIGlmIChoYXNDbGFzcyhlbGVtLCAnd3RCb3JkZXInKSAmJiBoYXNDbGFzcyhlbGVtLCAnYXJlYScpKSB7XG4gICAgaWYgKHRoaXMuaW5zdGFuY2Uuc2VsZWN0aW9ucy5hcmVhLmNlbGxSYW5nZSkge1xuICAgICAgY2VsbC5jb29yZHMgPSB0aGlzLmluc3RhbmNlLnNlbGVjdGlvbnMuYXJlYS5jZWxsUmFuZ2UudG87XG4gICAgICBjZWxsLlREID0gdGhpcy5pbnN0YW5jZS53dFRhYmxlLmdldENlbGwoY2VsbC5jb29yZHMpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gY2VsbDtcbn07XG47XG53aW5kb3cuV2Fsa29udGFibGVFdmVudCA9IFdhbGtvbnRhYmxlRXZlbnQ7XG5cbi8vIyBcbn0se1wiZXZlbnRNYW5hZ2VyXCI6NDIsXCJoZWxwZXJzL2Jyb3dzZXJcIjo0NCxcImhlbHBlcnMvZG9tL2VsZW1lbnRcIjo0NyxcImhlbHBlcnMvZnVuY3Rpb25cIjo1MH1dLDEwOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBXYWxrb250YWJsZUNvbHVtbkZpbHRlcjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gV2Fsa29udGFibGVDb2x1bW5GaWx0ZXI7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyIFdhbGtvbnRhYmxlQ29sdW1uRmlsdGVyID0gZnVuY3Rpb24gV2Fsa29udGFibGVDb2x1bW5GaWx0ZXIob2Zmc2V0LCB0b3RhbCwgY291bnRUSCkge1xuICB0aGlzLm9mZnNldCA9IG9mZnNldDtcbiAgdGhpcy50b3RhbCA9IHRvdGFsO1xuICB0aGlzLmNvdW50VEggPSBjb3VudFRIO1xufTtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKFdhbGtvbnRhYmxlQ29sdW1uRmlsdGVyLCB7XG4gIG9mZnNldHRlZDogZnVuY3Rpb24oaW5kZXgpIHtcbiAgICByZXR1cm4gaW5kZXggKyB0aGlzLm9mZnNldDtcbiAgfSxcbiAgdW5PZmZzZXR0ZWQ6IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgcmV0dXJuIGluZGV4IC0gdGhpcy5vZmZzZXQ7XG4gIH0sXG4gIHJlbmRlcmVkVG9Tb3VyY2U6IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgcmV0dXJuIHRoaXMub2Zmc2V0dGVkKGluZGV4KTtcbiAgfSxcbiAgc291cmNlVG9SZW5kZXJlZDogZnVuY3Rpb24oaW5kZXgpIHtcbiAgICByZXR1cm4gdGhpcy51bk9mZnNldHRlZChpbmRleCk7XG4gIH0sXG4gIG9mZnNldHRlZFRIOiBmdW5jdGlvbihpbmRleCkge1xuICAgIHJldHVybiBpbmRleCAtIHRoaXMuY291bnRUSDtcbiAgfSxcbiAgdW5PZmZzZXR0ZWRUSDogZnVuY3Rpb24oaW5kZXgpIHtcbiAgICByZXR1cm4gaW5kZXggKyB0aGlzLmNvdW50VEg7XG4gIH0sXG4gIHZpc2libGVSb3dIZWFkZWRDb2x1bW5Ub1NvdXJjZUNvbHVtbjogZnVuY3Rpb24oaW5kZXgpIHtcbiAgICByZXR1cm4gdGhpcy5yZW5kZXJlZFRvU291cmNlKHRoaXMub2Zmc2V0dGVkVEgoaW5kZXgpKTtcbiAgfSxcbiAgc291cmNlQ29sdW1uVG9WaXNpYmxlUm93SGVhZGVkQ29sdW1uOiBmdW5jdGlvbihpbmRleCkge1xuICAgIHJldHVybiB0aGlzLnVuT2Zmc2V0dGVkVEgodGhpcy5zb3VyY2VUb1JlbmRlcmVkKGluZGV4KSk7XG4gIH1cbn0sIHt9KTtcbjtcbndpbmRvdy5XYWxrb250YWJsZUNvbHVtbkZpbHRlciA9IFdhbGtvbnRhYmxlQ29sdW1uRmlsdGVyO1xuXG4vLyMgXG59LHt9XSwxMTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgV2Fsa29udGFibGVSb3dGaWx0ZXI6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFdhbGtvbnRhYmxlUm93RmlsdGVyO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciBXYWxrb250YWJsZVJvd0ZpbHRlciA9IGZ1bmN0aW9uIFdhbGtvbnRhYmxlUm93RmlsdGVyKG9mZnNldCwgdG90YWwsIGNvdW50VEgpIHtcbiAgdGhpcy5vZmZzZXQgPSBvZmZzZXQ7XG4gIHRoaXMudG90YWwgPSB0b3RhbDtcbiAgdGhpcy5jb3VudFRIID0gY291bnRUSDtcbn07XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShXYWxrb250YWJsZVJvd0ZpbHRlciwge1xuICBvZmZzZXR0ZWQ6IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgcmV0dXJuIGluZGV4ICsgdGhpcy5vZmZzZXQ7XG4gIH0sXG4gIHVuT2Zmc2V0dGVkOiBmdW5jdGlvbihpbmRleCkge1xuICAgIHJldHVybiBpbmRleCAtIHRoaXMub2Zmc2V0O1xuICB9LFxuICByZW5kZXJlZFRvU291cmNlOiBmdW5jdGlvbihpbmRleCkge1xuICAgIHJldHVybiB0aGlzLm9mZnNldHRlZChpbmRleCk7XG4gIH0sXG4gIHNvdXJjZVRvUmVuZGVyZWQ6IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgcmV0dXJuIHRoaXMudW5PZmZzZXR0ZWQoaW5kZXgpO1xuICB9LFxuICBvZmZzZXR0ZWRUSDogZnVuY3Rpb24oaW5kZXgpIHtcbiAgICByZXR1cm4gaW5kZXggLSB0aGlzLmNvdW50VEg7XG4gIH0sXG4gIHVuT2Zmc2V0dGVkVEg6IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgcmV0dXJuIGluZGV4ICsgdGhpcy5jb3VudFRIO1xuICB9LFxuICB2aXNpYmxlQ29sSGVhZGVkUm93VG9Tb3VyY2VSb3c6IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgcmV0dXJuIHRoaXMucmVuZGVyZWRUb1NvdXJjZSh0aGlzLm9mZnNldHRlZFRIKGluZGV4KSk7XG4gIH0sXG4gIHNvdXJjZVJvd1RvVmlzaWJsZUNvbEhlYWRlZFJvdzogZnVuY3Rpb24oaW5kZXgpIHtcbiAgICByZXR1cm4gdGhpcy51bk9mZnNldHRlZFRIKHRoaXMuc291cmNlVG9SZW5kZXJlZChpbmRleCkpO1xuICB9XG59LCB7fSk7XG47XG53aW5kb3cuV2Fsa29udGFibGVSb3dGaWx0ZXIgPSBXYWxrb250YWJsZVJvd0ZpbHRlcjtcblxuLy8jIFxufSx7fV0sMTI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIFdhbGtvbnRhYmxlT3ZlcmxheToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gV2Fsa29udGFibGVPdmVybGF5O1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX187XG52YXIgJF9fMCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSksXG4gICAgZ2V0U2Nyb2xsYWJsZUVsZW1lbnQgPSAkX18wLmdldFNjcm9sbGFibGVFbGVtZW50LFxuICAgIGdldFRyaW1taW5nQ29udGFpbmVyID0gJF9fMC5nZXRUcmltbWluZ0NvbnRhaW5lcjtcbnZhciBkZWZpbmVHZXR0ZXIgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL29iamVjdFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfX30pLmRlZmluZUdldHRlcjtcbnZhciBhcnJheUVhY2ggPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fID0gX2RlcmVxXyhcImhlbHBlcnMvYXJyYXlcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfX30pLmFycmF5RWFjaDtcbnZhciBldmVudE1hbmFnZXJPYmplY3QgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gPSBfZGVyZXFfKFwiZXZlbnRNYW5hZ2VyXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfX30pLmV2ZW50TWFuYWdlcjtcbnZhciByZWdpc3RlcmVkT3ZlcmxheXMgPSB7fTtcbnZhciBXYWxrb250YWJsZU92ZXJsYXkgPSBmdW5jdGlvbiBXYWxrb250YWJsZU92ZXJsYXkod290SW5zdGFuY2UpIHtcbiAgZGVmaW5lR2V0dGVyKHRoaXMsICd3b3QnLCB3b3RJbnN0YW5jZSwge3dyaXRhYmxlOiBmYWxzZX0pO1xuICB0aGlzLmluc3RhbmNlID0gdGhpcy53b3Q7XG4gIHRoaXMudHlwZSA9ICcnO1xuICB0aGlzLm1haW5UYWJsZVNjcm9sbGFibGVFbGVtZW50ID0gbnVsbDtcbiAgdGhpcy5UQUJMRSA9IHRoaXMud290Lnd0VGFibGUuVEFCTEU7XG4gIHRoaXMuaGlkZXIgPSB0aGlzLndvdC53dFRhYmxlLmhpZGVyO1xuICB0aGlzLnNwcmVhZGVyID0gdGhpcy53b3Qud3RUYWJsZS5zcHJlYWRlcjtcbiAgdGhpcy5ob2xkZXIgPSB0aGlzLndvdC53dFRhYmxlLmhvbGRlcjtcbiAgdGhpcy53dFJvb3RFbGVtZW50ID0gdGhpcy53b3Qud3RUYWJsZS53dFJvb3RFbGVtZW50O1xuICB0aGlzLnRyaW1taW5nQ29udGFpbmVyID0gZ2V0VHJpbW1pbmdDb250YWluZXIodGhpcy5oaWRlci5wYXJlbnROb2RlLnBhcmVudE5vZGUpO1xuICB0aGlzLmFyZUVsZW1lbnRTaXplc0FkanVzdGVkID0gZmFsc2U7XG4gIHRoaXMudXBkYXRlU3RhdGVPZlJlbmRlcmluZygpO1xufTtcbnZhciAkV2Fsa29udGFibGVPdmVybGF5ID0gV2Fsa29udGFibGVPdmVybGF5O1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoV2Fsa29udGFibGVPdmVybGF5LCB7XG4gIHVwZGF0ZVN0YXRlT2ZSZW5kZXJpbmc6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBwcmV2aW91c1N0YXRlID0gdGhpcy5uZWVkRnVsbFJlbmRlcjtcbiAgICB0aGlzLm5lZWRGdWxsUmVuZGVyID0gdGhpcy5zaG91bGRCZVJlbmRlcmVkKCk7XG4gICAgdmFyIGNoYW5nZWQgPSBwcmV2aW91c1N0YXRlICE9PSB0aGlzLm5lZWRGdWxsUmVuZGVyO1xuICAgIGlmIChjaGFuZ2VkICYmICF0aGlzLm5lZWRGdWxsUmVuZGVyKSB7XG4gICAgICB0aGlzLnJlc2V0KCk7XG4gICAgfVxuICAgIHJldHVybiBjaGFuZ2VkO1xuICB9LFxuICBzaG91bGRCZVJlbmRlcmVkOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSxcbiAgdXBkYXRlVHJpbW1pbmdDb250YWluZXI6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMudHJpbW1pbmdDb250YWluZXIgPSBnZXRUcmltbWluZ0NvbnRhaW5lcih0aGlzLmhpZGVyLnBhcmVudE5vZGUucGFyZW50Tm9kZSk7XG4gIH0sXG4gIHVwZGF0ZU1haW5TY3JvbGxhYmxlRWxlbWVudDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5tYWluVGFibGVTY3JvbGxhYmxlRWxlbWVudCA9IGdldFNjcm9sbGFibGVFbGVtZW50KHRoaXMud290Lnd0VGFibGUuVEFCTEUpO1xuICB9LFxuICBtYWtlQ2xvbmU6IGZ1bmN0aW9uKGRpcmVjdGlvbikge1xuICAgIGlmICgkV2Fsa29udGFibGVPdmVybGF5LkNMT05FX1RZUEVTLmluZGV4T2YoZGlyZWN0aW9uKSA9PT0gLTEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2xvbmUgdHlwZSBcIicgKyBkaXJlY3Rpb24gKyAnXCIgaXMgbm90IHN1cHBvcnRlZC4nKTtcbiAgICB9XG4gICAgdmFyIGNsb25lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnRElWJyk7XG4gICAgdmFyIGNsb25lZFRhYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnVEFCTEUnKTtcbiAgICBjbG9uZS5jbGFzc05hbWUgPSAnaHRfY2xvbmVfJyArIGRpcmVjdGlvbiArICcgaGFuZHNvbnRhYmxlJztcbiAgICBjbG9uZS5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgY2xvbmUuc3R5bGUudG9wID0gMDtcbiAgICBjbG9uZS5zdHlsZS5sZWZ0ID0gMDtcbiAgICBjbG9uZS5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuICAgIGNsb25lZFRhYmxlLmNsYXNzTmFtZSA9IHRoaXMud290Lnd0VGFibGUuVEFCTEUuY2xhc3NOYW1lO1xuICAgIGNsb25lLmFwcGVuZENoaWxkKGNsb25lZFRhYmxlKTtcbiAgICB0aGlzLnR5cGUgPSBkaXJlY3Rpb247XG4gICAgdGhpcy53b3Qud3RUYWJsZS53dFJvb3RFbGVtZW50LnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQoY2xvbmUpO1xuICAgIHZhciBwcmV2ZW50T3ZlcmZsb3cgPSB0aGlzLndvdC5nZXRTZXR0aW5nKCdwcmV2ZW50T3ZlcmZsb3cnKTtcbiAgICBpZiAocHJldmVudE92ZXJmbG93ID09PSB0cnVlIHx8IHByZXZlbnRPdmVyZmxvdyA9PT0gJ2hvcml6b250YWwnICYmIHRoaXMudHlwZSA9PT0gJFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9UT1AgfHwgcHJldmVudE92ZXJmbG93ID09PSAndmVydGljYWwnICYmIHRoaXMudHlwZSA9PT0gJFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9MRUZUKSB7XG4gICAgICB0aGlzLm1haW5UYWJsZVNjcm9sbGFibGVFbGVtZW50ID0gd2luZG93O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm1haW5UYWJsZVNjcm9sbGFibGVFbGVtZW50ID0gZ2V0U2Nyb2xsYWJsZUVsZW1lbnQodGhpcy53b3Qud3RUYWJsZS5UQUJMRSk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgV2Fsa29udGFibGUoe1xuICAgICAgY2xvbmVTb3VyY2U6IHRoaXMud290LFxuICAgICAgY2xvbmVPdmVybGF5OiB0aGlzLFxuICAgICAgdGFibGU6IGNsb25lZFRhYmxlXG4gICAgfSk7XG4gIH0sXG4gIHJlZnJlc2g6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBmYXN0RHJhdyA9IGFyZ3VtZW50c1swXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTtcbiAgICB2YXIgbmV4dEN5Y2xlUmVuZGVyRmxhZyA9IHRoaXMuc2hvdWxkQmVSZW5kZXJlZCgpO1xuICAgIGlmICh0aGlzLmNsb25lICYmICh0aGlzLm5lZWRGdWxsUmVuZGVyIHx8IG5leHRDeWNsZVJlbmRlckZsYWcpKSB7XG4gICAgICB0aGlzLmNsb25lLmRyYXcoZmFzdERyYXcpO1xuICAgIH1cbiAgICB0aGlzLm5lZWRGdWxsUmVuZGVyID0gbmV4dEN5Y2xlUmVuZGVyRmxhZztcbiAgfSxcbiAgcmVzZXQ6IGZ1bmN0aW9uKCkge1xuICAgIGlmICghdGhpcy5jbG9uZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgaG9sZGVyID0gdGhpcy5jbG9uZS53dFRhYmxlLmhvbGRlcjtcbiAgICB2YXIgaGlkZXIgPSB0aGlzLmNsb25lLnd0VGFibGUuaGlkZXI7XG4gICAgdmFyIGhvbGRlclN0eWxlID0gaG9sZGVyLnN0eWxlO1xuICAgIHZhciBoaWRkZXJTdHlsZSA9IGhpZGVyLnN0eWxlO1xuICAgIHZhciByb290U3R5bGUgPSBob2xkZXIucGFyZW50Tm9kZS5zdHlsZTtcbiAgICBhcnJheUVhY2goW2hvbGRlclN0eWxlLCBoaWRkZXJTdHlsZSwgcm9vdFN0eWxlXSwgKGZ1bmN0aW9uKHN0eWxlKSB7XG4gICAgICBzdHlsZS53aWR0aCA9ICcnO1xuICAgICAgc3R5bGUuaGVpZ2h0ID0gJyc7XG4gICAgfSkpO1xuICB9LFxuICBkZXN0cm95OiBmdW5jdGlvbigpIHtcbiAgICBldmVudE1hbmFnZXJPYmplY3QodGhpcy5jbG9uZSkuZGVzdHJveSgpO1xuICB9XG59LCB7XG4gIGdldCBDTE9ORV9UT1AoKSB7XG4gICAgcmV0dXJuICd0b3AnO1xuICB9LFxuICBnZXQgQ0xPTkVfQk9UVE9NKCkge1xuICAgIHJldHVybiAnYm90dG9tJztcbiAgfSxcbiAgZ2V0IENMT05FX0xFRlQoKSB7XG4gICAgcmV0dXJuICdsZWZ0JztcbiAgfSxcbiAgZ2V0IENMT05FX1RPUF9MRUZUX0NPUk5FUigpIHtcbiAgICByZXR1cm4gJ3RvcF9sZWZ0X2Nvcm5lcic7XG4gIH0sXG4gIGdldCBDTE9ORV9CT1RUT01fTEVGVF9DT1JORVIoKSB7XG4gICAgcmV0dXJuICdib3R0b21fbGVmdF9jb3JuZXInO1xuICB9LFxuICBnZXQgQ0xPTkVfREVCVUcoKSB7XG4gICAgcmV0dXJuICdkZWJ1Zyc7XG4gIH0sXG4gIGdldCBDTE9ORV9UWVBFUygpIHtcbiAgICByZXR1cm4gWyRXYWxrb250YWJsZU92ZXJsYXkuQ0xPTkVfVE9QLCAkV2Fsa29udGFibGVPdmVybGF5LkNMT05FX0JPVFRPTSwgJFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9MRUZULCAkV2Fsa29udGFibGVPdmVybGF5LkNMT05FX1RPUF9MRUZUX0NPUk5FUiwgJFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9CT1RUT01fTEVGVF9DT1JORVIsICRXYWxrb250YWJsZU92ZXJsYXkuQ0xPTkVfREVCVUddO1xuICB9LFxuICByZWdpc3Rlck92ZXJsYXk6IGZ1bmN0aW9uKHR5cGUsIG92ZXJsYXlDbGFzcykge1xuICAgIGlmICgkV2Fsa29udGFibGVPdmVybGF5LkNMT05FX1RZUEVTLmluZGV4T2YodHlwZSkgPT09IC0xKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoKFwiVW5zdXBwb3J0ZWQgb3ZlcmxheSAoXCIgKyB0eXBlICsgXCIpLlwiKSk7XG4gICAgfVxuICAgIHJlZ2lzdGVyZWRPdmVybGF5c1t0eXBlXSA9IG92ZXJsYXlDbGFzcztcbiAgfSxcbiAgY3JlYXRlT3ZlcmxheTogZnVuY3Rpb24odHlwZSwgd290KSB7XG4gICAgcmV0dXJuIG5ldyByZWdpc3RlcmVkT3ZlcmxheXNbdHlwZV0od290KTtcbiAgfSxcbiAgaXNPdmVybGF5VHlwZU9mOiBmdW5jdGlvbihvdmVybGF5LCB0eXBlKSB7XG4gICAgaWYgKCFvdmVybGF5IHx8ICFyZWdpc3RlcmVkT3ZlcmxheXNbdHlwZV0pIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIG92ZXJsYXkgaW5zdGFuY2VvZiByZWdpc3RlcmVkT3ZlcmxheXNbdHlwZV07XG4gIH1cbn0pO1xuO1xud2luZG93LldhbGtvbnRhYmxlT3ZlcmxheSA9IFdhbGtvbnRhYmxlT3ZlcmxheTtcblxuLy8jIFxufSx7XCJldmVudE1hbmFnZXJcIjo0MixcImhlbHBlcnMvYXJyYXlcIjo0MyxcImhlbHBlcnMvZG9tL2VsZW1lbnRcIjo0NyxcImhlbHBlcnMvb2JqZWN0XCI6NTN9XSwxMzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgV2Fsa29udGFibGVEZWJ1Z092ZXJsYXk6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFdhbGtvbnRhYmxlRGVidWdPdmVybGF5O1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzk1X2Jhc2VfXztcbnZhciBhZGRDbGFzcyA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSkuYWRkQ2xhc3M7XG52YXIgV2Fsa29udGFibGVPdmVybGF5ID0gKCRfX185NV9iYXNlX18gPSBfZGVyZXFfKFwiX2Jhc2VcIiksICRfX185NV9iYXNlX18gJiYgJF9fXzk1X2Jhc2VfXy5fX2VzTW9kdWxlICYmICRfX185NV9iYXNlX18gfHwge2RlZmF1bHQ6ICRfX185NV9iYXNlX199KS5XYWxrb250YWJsZU92ZXJsYXk7XG52YXIgV2Fsa29udGFibGVEZWJ1Z092ZXJsYXkgPSBmdW5jdGlvbiBXYWxrb250YWJsZURlYnVnT3ZlcmxheSh3b3RJbnN0YW5jZSkge1xuICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJDb25zdHJ1Y3RvcigkV2Fsa29udGFibGVEZWJ1Z092ZXJsYXkpLmNhbGwodGhpcywgd290SW5zdGFuY2UpO1xuICB0aGlzLmNsb25lID0gdGhpcy5tYWtlQ2xvbmUoV2Fsa29udGFibGVPdmVybGF5LkNMT05FX0RFQlVHKTtcbiAgdGhpcy5jbG9uZS53dFRhYmxlLmhvbGRlci5zdHlsZS5vcGFjaXR5ID0gMC40O1xuICB0aGlzLmNsb25lLnd0VGFibGUuaG9sZGVyLnN0eWxlLnRleHRTaGFkb3cgPSAnMCAwIDJweCAjZmYwMDAwJztcbiAgYWRkQ2xhc3ModGhpcy5jbG9uZS53dFRhYmxlLmhvbGRlci5wYXJlbnROb2RlLCAnd3REZWJ1Z1Zpc2libGUnKTtcbn07XG52YXIgJFdhbGtvbnRhYmxlRGVidWdPdmVybGF5ID0gV2Fsa29udGFibGVEZWJ1Z092ZXJsYXk7XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShXYWxrb250YWJsZURlYnVnT3ZlcmxheSwge30sIHt9LCBXYWxrb250YWJsZU92ZXJsYXkpO1xuO1xud2luZG93LldhbGtvbnRhYmxlRGVidWdPdmVybGF5ID0gV2Fsa29udGFibGVEZWJ1Z092ZXJsYXk7XG5XYWxrb250YWJsZU92ZXJsYXkucmVnaXN0ZXJPdmVybGF5KFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9ERUJVRywgV2Fsa29udGFibGVEZWJ1Z092ZXJsYXkpO1xuXG4vLyMgXG59LHtcIl9iYXNlXCI6MTIsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDd9XSwxNDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgV2Fsa29udGFibGVMZWZ0T3ZlcmxheToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gV2Fsa29udGFibGVMZWZ0T3ZlcmxheTtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLFxuICAgICRfX185NV9iYXNlX187XG52YXIgJF9fMCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSksXG4gICAgYWRkQ2xhc3MgPSAkX18wLmFkZENsYXNzLFxuICAgIGdldFNjcm9sbGJhcldpZHRoID0gJF9fMC5nZXRTY3JvbGxiYXJXaWR0aCxcbiAgICBnZXRTY3JvbGxMZWZ0ID0gJF9fMC5nZXRTY3JvbGxMZWZ0LFxuICAgIGdldFdpbmRvd1Njcm9sbFRvcCA9ICRfXzAuZ2V0V2luZG93U2Nyb2xsVG9wLFxuICAgIGhhc0NsYXNzID0gJF9fMC5oYXNDbGFzcyxcbiAgICBvdXRlcldpZHRoID0gJF9fMC5vdXRlcldpZHRoLFxuICAgIGlubmVySGVpZ2h0ID0gJF9fMC5pbm5lckhlaWdodCxcbiAgICByZW1vdmVDbGFzcyA9ICRfXzAucmVtb3ZlQ2xhc3MsXG4gICAgc2V0T3ZlcmxheVBvc2l0aW9uID0gJF9fMC5zZXRPdmVybGF5UG9zaXRpb24sXG4gICAgcmVzZXRDc3NUcmFuc2Zvcm0gPSAkX18wLnJlc2V0Q3NzVHJhbnNmb3JtO1xudmFyIFdhbGtvbnRhYmxlT3ZlcmxheSA9ICgkX19fOTVfYmFzZV9fID0gX2RlcmVxXyhcIl9iYXNlXCIpLCAkX19fOTVfYmFzZV9fICYmICRfX185NV9iYXNlX18uX19lc01vZHVsZSAmJiAkX19fOTVfYmFzZV9fIHx8IHtkZWZhdWx0OiAkX19fOTVfYmFzZV9ffSkuV2Fsa29udGFibGVPdmVybGF5O1xudmFyIFdhbGtvbnRhYmxlTGVmdE92ZXJsYXkgPSBmdW5jdGlvbiBXYWxrb250YWJsZUxlZnRPdmVybGF5KHdvdEluc3RhbmNlKSB7XG4gICR0cmFjZXVyUnVudGltZS5zdXBlckNvbnN0cnVjdG9yKCRXYWxrb250YWJsZUxlZnRPdmVybGF5KS5jYWxsKHRoaXMsIHdvdEluc3RhbmNlKTtcbiAgdGhpcy5jbG9uZSA9IHRoaXMubWFrZUNsb25lKFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9MRUZUKTtcbn07XG52YXIgJFdhbGtvbnRhYmxlTGVmdE92ZXJsYXkgPSBXYWxrb250YWJsZUxlZnRPdmVybGF5O1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoV2Fsa29udGFibGVMZWZ0T3ZlcmxheSwge1xuICBzaG91bGRCZVJlbmRlcmVkOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy53b3QuZ2V0U2V0dGluZygnZml4ZWRDb2x1bW5zTGVmdCcpIHx8IHRoaXMud290LmdldFNldHRpbmcoJ3Jvd0hlYWRlcnMnKS5sZW5ndGggPyB0cnVlIDogZmFsc2U7XG4gIH0sXG4gIHJlc2V0Rml4ZWRQb3NpdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgaWYgKCF0aGlzLm5lZWRGdWxsUmVuZGVyIHx8ICF0aGlzLndvdC53dFRhYmxlLmhvbGRlci5wYXJlbnROb2RlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBvdmVybGF5Um9vdCA9IHRoaXMuY2xvbmUud3RUYWJsZS5ob2xkZXIucGFyZW50Tm9kZTtcbiAgICB2YXIgaGVhZGVyUG9zaXRpb24gPSAwO1xuICAgIHZhciBwcmV2ZW50T3ZlcmZsb3cgPSB0aGlzLndvdC5nZXRTZXR0aW5nKCdwcmV2ZW50T3ZlcmZsb3cnKTtcbiAgICBpZiAodGhpcy50cmltbWluZ0NvbnRhaW5lciA9PT0gd2luZG93ICYmICghcHJldmVudE92ZXJmbG93IHx8IHByZXZlbnRPdmVyZmxvdyAhPT0gJ2hvcml6b250YWwnKSkge1xuICAgICAgdmFyIGJveCA9IHRoaXMud290Lnd0VGFibGUuaGlkZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICB2YXIgbGVmdCA9IE1hdGguY2VpbChib3gubGVmdCk7XG4gICAgICB2YXIgcmlnaHQgPSBNYXRoLmNlaWwoYm94LnJpZ2h0KTtcbiAgICAgIHZhciBmaW5hbExlZnQ7XG4gICAgICB2YXIgZmluYWxUb3A7XG4gICAgICBmaW5hbFRvcCA9IHRoaXMud290Lnd0VGFibGUuaGlkZXIuc3R5bGUudG9wO1xuICAgICAgZmluYWxUb3AgPSBmaW5hbFRvcCA9PT0gJycgPyAwIDogZmluYWxUb3A7XG4gICAgICBpZiAobGVmdCA8IDAgJiYgKHJpZ2h0IC0gb3ZlcmxheVJvb3Qub2Zmc2V0V2lkdGgpID4gMCkge1xuICAgICAgICBmaW5hbExlZnQgPSAtbGVmdDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZpbmFsTGVmdCA9IDA7XG4gICAgICB9XG4gICAgICBoZWFkZXJQb3NpdGlvbiA9IGZpbmFsTGVmdDtcbiAgICAgIGZpbmFsTGVmdCA9IGZpbmFsTGVmdCArICdweCc7XG4gICAgICBzZXRPdmVybGF5UG9zaXRpb24ob3ZlcmxheVJvb3QsIGZpbmFsTGVmdCwgZmluYWxUb3ApO1xuICAgIH0gZWxzZSB7XG4gICAgICBoZWFkZXJQb3NpdGlvbiA9IHRoaXMuZ2V0U2Nyb2xsUG9zaXRpb24oKTtcbiAgICAgIHJlc2V0Q3NzVHJhbnNmb3JtKG92ZXJsYXlSb290KTtcbiAgICB9XG4gICAgdGhpcy5hZGp1c3RIZWFkZXJCb3JkZXJzUG9zaXRpb24oaGVhZGVyUG9zaXRpb24pO1xuICAgIHRoaXMuYWRqdXN0RWxlbWVudHNTaXplKCk7XG4gIH0sXG4gIHNldFNjcm9sbFBvc2l0aW9uOiBmdW5jdGlvbihwb3MpIHtcbiAgICBpZiAodGhpcy5tYWluVGFibGVTY3JvbGxhYmxlRWxlbWVudCA9PT0gd2luZG93KSB7XG4gICAgICB3aW5kb3cuc2Nyb2xsVG8ocG9zLCBnZXRXaW5kb3dTY3JvbGxUb3AoKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubWFpblRhYmxlU2Nyb2xsYWJsZUVsZW1lbnQuc2Nyb2xsTGVmdCA9IHBvcztcbiAgICB9XG4gIH0sXG4gIG9uU2Nyb2xsOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLndvdC5nZXRTZXR0aW5nKCdvblNjcm9sbFZlcnRpY2FsbHknKTtcbiAgfSxcbiAgc3VtQ2VsbFNpemVzOiBmdW5jdGlvbihmcm9tLCB0bykge1xuICAgIHZhciBzdW0gPSAwO1xuICAgIHZhciBkZWZhdWx0Q29sdW1uV2lkdGggPSB0aGlzLndvdC53dFNldHRpbmdzLmRlZmF1bHRDb2x1bW5XaWR0aDtcbiAgICB3aGlsZSAoZnJvbSA8IHRvKSB7XG4gICAgICBzdW0gKz0gdGhpcy53b3Qud3RUYWJsZS5nZXRTdHJldGNoZWRDb2x1bW5XaWR0aChmcm9tKSB8fCBkZWZhdWx0Q29sdW1uV2lkdGg7XG4gICAgICBmcm9tKys7XG4gICAgfVxuICAgIHJldHVybiBzdW07XG4gIH0sXG4gIGFkanVzdEVsZW1lbnRzU2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGZvcmNlID0gYXJndW1lbnRzWzBdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1swXSA6IGZhbHNlO1xuICAgIHRoaXMudXBkYXRlVHJpbW1pbmdDb250YWluZXIoKTtcbiAgICBpZiAodGhpcy5uZWVkRnVsbFJlbmRlciB8fCBmb3JjZSkge1xuICAgICAgdGhpcy5hZGp1c3RSb290RWxlbWVudFNpemUoKTtcbiAgICAgIHRoaXMuYWRqdXN0Um9vdENoaWxkcmVuU2l6ZSgpO1xuICAgICAgaWYgKCFmb3JjZSkge1xuICAgICAgICB0aGlzLmFyZUVsZW1lbnRTaXplc0FkanVzdGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFkanVzdFJvb3RFbGVtZW50U2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIG1hc3RlckhvbGRlciA9IHRoaXMud290Lnd0VGFibGUuaG9sZGVyO1xuICAgIHZhciBzY3JvbGxiYXJIZWlnaHQgPSBtYXN0ZXJIb2xkZXIuY2xpZW50SGVpZ2h0ID09PSBtYXN0ZXJIb2xkZXIub2Zmc2V0SGVpZ2h0ID8gMCA6IGdldFNjcm9sbGJhcldpZHRoKCk7XG4gICAgdmFyIG92ZXJsYXlSb290ID0gdGhpcy5jbG9uZS53dFRhYmxlLmhvbGRlci5wYXJlbnROb2RlO1xuICAgIHZhciBvdmVybGF5Um9vdFN0eWxlID0gb3ZlcmxheVJvb3Quc3R5bGU7XG4gICAgdmFyIHByZXZlbnRPdmVyZmxvdyA9IHRoaXMud290LmdldFNldHRpbmcoJ3ByZXZlbnRPdmVyZmxvdycpO1xuICAgIHZhciB0YWJsZVdpZHRoO1xuICAgIGlmICh0aGlzLnRyaW1taW5nQ29udGFpbmVyICE9PSB3aW5kb3cgfHwgcHJldmVudE92ZXJmbG93ID09PSAndmVydGljYWwnKSB7XG4gICAgICB2YXIgaGVpZ2h0ID0gdGhpcy53b3Qud3RWaWV3cG9ydC5nZXRXb3Jrc3BhY2VIZWlnaHQoKSAtIHNjcm9sbGJhckhlaWdodDtcbiAgICAgIGhlaWdodCA9IE1hdGgubWluKGhlaWdodCwgaW5uZXJIZWlnaHQodGhpcy53b3Qud3RUYWJsZS53dFJvb3RFbGVtZW50KSk7XG4gICAgICBvdmVybGF5Um9vdFN0eWxlLmhlaWdodCA9IGhlaWdodCArICdweCc7XG4gICAgfSBlbHNlIHtcbiAgICAgIG92ZXJsYXlSb290U3R5bGUuaGVpZ2h0ID0gJyc7XG4gICAgfVxuICAgIHRoaXMuY2xvbmUud3RUYWJsZS5ob2xkZXIuc3R5bGUuaGVpZ2h0ID0gb3ZlcmxheVJvb3RTdHlsZS5oZWlnaHQ7XG4gICAgdGFibGVXaWR0aCA9IG91dGVyV2lkdGgodGhpcy5jbG9uZS53dFRhYmxlLlRBQkxFKTtcbiAgICBvdmVybGF5Um9vdFN0eWxlLndpZHRoID0gKHRhYmxlV2lkdGggPT09IDAgPyB0YWJsZVdpZHRoIDogdGFibGVXaWR0aCArIDQpICsgJ3B4JztcbiAgfSxcbiAgYWRqdXN0Um9vdENoaWxkcmVuU2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNjcm9sbGJhcldpZHRoID0gZ2V0U2Nyb2xsYmFyV2lkdGgoKTtcbiAgICB0aGlzLmNsb25lLnd0VGFibGUuaGlkZXIuc3R5bGUuaGVpZ2h0ID0gdGhpcy5oaWRlci5zdHlsZS5oZWlnaHQ7XG4gICAgdGhpcy5jbG9uZS53dFRhYmxlLmhvbGRlci5zdHlsZS5oZWlnaHQgPSB0aGlzLmNsb25lLnd0VGFibGUuaG9sZGVyLnBhcmVudE5vZGUuc3R5bGUuaGVpZ2h0O1xuICAgIGlmIChzY3JvbGxiYXJXaWR0aCA9PT0gMCkge1xuICAgICAgc2Nyb2xsYmFyV2lkdGggPSAzMDtcbiAgICB9XG4gICAgdGhpcy5jbG9uZS53dFRhYmxlLmhvbGRlci5zdHlsZS53aWR0aCA9IHBhcnNlSW50KHRoaXMuY2xvbmUud3RUYWJsZS5ob2xkZXIucGFyZW50Tm9kZS5zdHlsZS53aWR0aCwgMTApICsgc2Nyb2xsYmFyV2lkdGggKyAncHgnO1xuICB9LFxuICBhcHBseVRvRE9NOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgdG90YWwgPSB0aGlzLndvdC5nZXRTZXR0aW5nKCd0b3RhbENvbHVtbnMnKTtcbiAgICBpZiAoIXRoaXMuYXJlRWxlbWVudFNpemVzQWRqdXN0ZWQpIHtcbiAgICAgIHRoaXMuYWRqdXN0RWxlbWVudHNTaXplKCk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgdGhpcy53b3Qud3RWaWV3cG9ydC5jb2x1bW5zUmVuZGVyQ2FsY3VsYXRvci5zdGFydFBvc2l0aW9uID09PSAnbnVtYmVyJykge1xuICAgICAgdGhpcy5zcHJlYWRlci5zdHlsZS5sZWZ0ID0gdGhpcy53b3Qud3RWaWV3cG9ydC5jb2x1bW5zUmVuZGVyQ2FsY3VsYXRvci5zdGFydFBvc2l0aW9uICsgJ3B4JztcbiAgICB9IGVsc2UgaWYgKHRvdGFsID09PSAwKSB7XG4gICAgICB0aGlzLnNwcmVhZGVyLnN0eWxlLmxlZnQgPSAnMCc7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW5jb3JyZWN0IHZhbHVlIG9mIHRoZSBjb2x1bW5zUmVuZGVyQ2FsY3VsYXRvcicpO1xuICAgIH1cbiAgICB0aGlzLnNwcmVhZGVyLnN0eWxlLnJpZ2h0ID0gJyc7XG4gICAgaWYgKHRoaXMubmVlZEZ1bGxSZW5kZXIpIHtcbiAgICAgIHRoaXMuc3luY092ZXJsYXlPZmZzZXQoKTtcbiAgICB9XG4gIH0sXG4gIHN5bmNPdmVybGF5T2Zmc2V0OiBmdW5jdGlvbigpIHtcbiAgICBpZiAodHlwZW9mIHRoaXMud290Lnd0Vmlld3BvcnQucm93c1JlbmRlckNhbGN1bGF0b3Iuc3RhcnRQb3NpdGlvbiA9PT0gJ251bWJlcicpIHtcbiAgICAgIHRoaXMuY2xvbmUud3RUYWJsZS5zcHJlYWRlci5zdHlsZS50b3AgPSB0aGlzLndvdC53dFZpZXdwb3J0LnJvd3NSZW5kZXJDYWxjdWxhdG9yLnN0YXJ0UG9zaXRpb24gKyAncHgnO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNsb25lLnd0VGFibGUuc3ByZWFkZXIuc3R5bGUudG9wID0gJyc7XG4gICAgfVxuICB9LFxuICBzY3JvbGxUbzogZnVuY3Rpb24oc291cmNlQ29sLCBiZXlvbmRSZW5kZXJlZCkge1xuICAgIHZhciBuZXdYID0gdGhpcy5nZXRUYWJsZVBhcmVudE9mZnNldCgpO1xuICAgIHZhciBzb3VyY2VJbnN0YW5jZSA9IHRoaXMud290LmNsb25lU291cmNlID8gdGhpcy53b3QuY2xvbmVTb3VyY2UgOiB0aGlzLndvdDtcbiAgICB2YXIgbWFpbkhvbGRlciA9IHNvdXJjZUluc3RhbmNlLnd0VGFibGUuaG9sZGVyO1xuICAgIHZhciBzY3JvbGxiYXJDb21wZW5zYXRpb24gPSAwO1xuICAgIGlmIChiZXlvbmRSZW5kZXJlZCAmJiBtYWluSG9sZGVyLm9mZnNldFdpZHRoICE9PSBtYWluSG9sZGVyLmNsaWVudFdpZHRoKSB7XG4gICAgICBzY3JvbGxiYXJDb21wZW5zYXRpb24gPSBnZXRTY3JvbGxiYXJXaWR0aCgpO1xuICAgIH1cbiAgICBpZiAoYmV5b25kUmVuZGVyZWQpIHtcbiAgICAgIG5ld1ggKz0gdGhpcy5zdW1DZWxsU2l6ZXMoMCwgc291cmNlQ29sICsgMSk7XG4gICAgICBuZXdYIC09IHRoaXMud290Lnd0Vmlld3BvcnQuZ2V0Vmlld3BvcnRXaWR0aCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBuZXdYICs9IHRoaXMuc3VtQ2VsbFNpemVzKHRoaXMud290LmdldFNldHRpbmcoJ2ZpeGVkQ29sdW1uc0xlZnQnKSwgc291cmNlQ29sKTtcbiAgICB9XG4gICAgbmV3WCArPSBzY3JvbGxiYXJDb21wZW5zYXRpb247XG4gICAgdGhpcy5zZXRTY3JvbGxQb3NpdGlvbihuZXdYKTtcbiAgfSxcbiAgZ2V0VGFibGVQYXJlbnRPZmZzZXQ6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBwcmV2ZW50T3ZlcmZsb3cgPSB0aGlzLndvdC5nZXRTZXR0aW5nKCdwcmV2ZW50T3ZlcmZsb3cnKTtcbiAgICB2YXIgb2Zmc2V0ID0gMDtcbiAgICBpZiAoIXByZXZlbnRPdmVyZmxvdyAmJiB0aGlzLnRyaW1taW5nQ29udGFpbmVyID09PSB3aW5kb3cpIHtcbiAgICAgIG9mZnNldCA9IHRoaXMud290Lnd0VGFibGUuaG9sZGVyT2Zmc2V0LmxlZnQ7XG4gICAgfVxuICAgIHJldHVybiBvZmZzZXQ7XG4gIH0sXG4gIGdldFNjcm9sbFBvc2l0aW9uOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZ2V0U2Nyb2xsTGVmdCh0aGlzLm1haW5UYWJsZVNjcm9sbGFibGVFbGVtZW50KTtcbiAgfSxcbiAgYWRqdXN0SGVhZGVyQm9yZGVyc1Bvc2l0aW9uOiBmdW5jdGlvbihwb3NpdGlvbikge1xuICAgIHZhciBtYXN0ZXJQYXJlbnQgPSB0aGlzLndvdC53dFRhYmxlLmhvbGRlci5wYXJlbnROb2RlO1xuICAgIHZhciByb3dIZWFkZXJzID0gdGhpcy53b3QuZ2V0U2V0dGluZygncm93SGVhZGVycycpO1xuICAgIHZhciBmaXhlZENvbHVtbnNMZWZ0ID0gdGhpcy53b3QuZ2V0U2V0dGluZygnZml4ZWRDb2x1bW5zTGVmdCcpO1xuICAgIHZhciB0b3RhbFJvd3MgPSB0aGlzLndvdC5nZXRTZXR0aW5nKCd0b3RhbFJvd3MnKTtcbiAgICBpZiAodG90YWxSb3dzKSB7XG4gICAgICByZW1vdmVDbGFzcyhtYXN0ZXJQYXJlbnQsICdlbXB0eVJvd3MnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYWRkQ2xhc3MobWFzdGVyUGFyZW50LCAnZW1wdHlSb3dzJyk7XG4gICAgfVxuICAgIGlmIChmaXhlZENvbHVtbnNMZWZ0ICYmICFyb3dIZWFkZXJzLmxlbmd0aCkge1xuICAgICAgYWRkQ2xhc3MobWFzdGVyUGFyZW50LCAnaW5uZXJCb3JkZXJMZWZ0Jyk7XG4gICAgfSBlbHNlIGlmICghZml4ZWRDb2x1bW5zTGVmdCAmJiByb3dIZWFkZXJzLmxlbmd0aCkge1xuICAgICAgdmFyIHByZXZpb3VzU3RhdGUgPSBoYXNDbGFzcyhtYXN0ZXJQYXJlbnQsICdpbm5lckJvcmRlckxlZnQnKTtcbiAgICAgIGlmIChwb3NpdGlvbikge1xuICAgICAgICBhZGRDbGFzcyhtYXN0ZXJQYXJlbnQsICdpbm5lckJvcmRlckxlZnQnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlbW92ZUNsYXNzKG1hc3RlclBhcmVudCwgJ2lubmVyQm9yZGVyTGVmdCcpO1xuICAgICAgfVxuICAgICAgaWYgKCFwcmV2aW91c1N0YXRlICYmIHBvc2l0aW9uIHx8IHByZXZpb3VzU3RhdGUgJiYgIXBvc2l0aW9uKSB7XG4gICAgICAgIHRoaXMud290Lnd0T3ZlcmxheXMuYWRqdXN0RWxlbWVudHNTaXplKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG59LCB7fSwgV2Fsa29udGFibGVPdmVybGF5KTtcbjtcbndpbmRvdy5XYWxrb250YWJsZUxlZnRPdmVybGF5ID0gV2Fsa29udGFibGVMZWZ0T3ZlcmxheTtcbldhbGtvbnRhYmxlT3ZlcmxheS5yZWdpc3Rlck92ZXJsYXkoV2Fsa29udGFibGVPdmVybGF5LkNMT05FX0xFRlQsIFdhbGtvbnRhYmxlTGVmdE92ZXJsYXkpO1xuXG4vLyMgXG59LHtcIl9iYXNlXCI6MTIsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDd9XSwxNTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgV2Fsa29udGFibGVUb3BPdmVybGF5OiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBXYWxrb250YWJsZVRvcE92ZXJsYXk7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyxcbiAgICAkX19fOTVfYmFzZV9fO1xudmFyICRfXzAgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLFxuICAgIGFkZENsYXNzID0gJF9fMC5hZGRDbGFzcyxcbiAgICBnZXRTY3JvbGxiYXJXaWR0aCA9ICRfXzAuZ2V0U2Nyb2xsYmFyV2lkdGgsXG4gICAgZ2V0U2Nyb2xsVG9wID0gJF9fMC5nZXRTY3JvbGxUb3AsXG4gICAgZ2V0V2luZG93U2Nyb2xsTGVmdCA9ICRfXzAuZ2V0V2luZG93U2Nyb2xsTGVmdCxcbiAgICBoYXNDbGFzcyA9ICRfXzAuaGFzQ2xhc3MsXG4gICAgb3V0ZXJIZWlnaHQgPSAkX18wLm91dGVySGVpZ2h0LFxuICAgIGlubmVyV2lkdGggPSAkX18wLmlubmVyV2lkdGgsXG4gICAgcmVtb3ZlQ2xhc3MgPSAkX18wLnJlbW92ZUNsYXNzLFxuICAgIHNldE92ZXJsYXlQb3NpdGlvbiA9ICRfXzAuc2V0T3ZlcmxheVBvc2l0aW9uLFxuICAgIHJlc2V0Q3NzVHJhbnNmb3JtID0gJF9fMC5yZXNldENzc1RyYW5zZm9ybTtcbnZhciBXYWxrb250YWJsZU92ZXJsYXkgPSAoJF9fXzk1X2Jhc2VfXyA9IF9kZXJlcV8oXCJfYmFzZVwiKSwgJF9fXzk1X2Jhc2VfXyAmJiAkX19fOTVfYmFzZV9fLl9fZXNNb2R1bGUgJiYgJF9fXzk1X2Jhc2VfXyB8fCB7ZGVmYXVsdDogJF9fXzk1X2Jhc2VfX30pLldhbGtvbnRhYmxlT3ZlcmxheTtcbnZhciBXYWxrb250YWJsZVRvcE92ZXJsYXkgPSBmdW5jdGlvbiBXYWxrb250YWJsZVRvcE92ZXJsYXkod290SW5zdGFuY2UpIHtcbiAgJHRyYWNldXJSdW50aW1lLnN1cGVyQ29uc3RydWN0b3IoJFdhbGtvbnRhYmxlVG9wT3ZlcmxheSkuY2FsbCh0aGlzLCB3b3RJbnN0YW5jZSk7XG4gIHRoaXMuY2xvbmUgPSB0aGlzLm1ha2VDbG9uZShXYWxrb250YWJsZU92ZXJsYXkuQ0xPTkVfVE9QKTtcbn07XG52YXIgJFdhbGtvbnRhYmxlVG9wT3ZlcmxheSA9IFdhbGtvbnRhYmxlVG9wT3ZlcmxheTtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKFdhbGtvbnRhYmxlVG9wT3ZlcmxheSwge1xuICBzaG91bGRCZVJlbmRlcmVkOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy53b3QuZ2V0U2V0dGluZygnZml4ZWRSb3dzVG9wJykgfHwgdGhpcy53b3QuZ2V0U2V0dGluZygnY29sdW1uSGVhZGVycycpLmxlbmd0aCA/IHRydWUgOiBmYWxzZTtcbiAgfSxcbiAgcmVzZXRGaXhlZFBvc2l0aW9uOiBmdW5jdGlvbigpIHtcbiAgICBpZiAoIXRoaXMubmVlZEZ1bGxSZW5kZXIgfHwgIXRoaXMud290Lnd0VGFibGUuaG9sZGVyLnBhcmVudE5vZGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIG92ZXJsYXlSb290ID0gdGhpcy5jbG9uZS53dFRhYmxlLmhvbGRlci5wYXJlbnROb2RlO1xuICAgIHZhciBoZWFkZXJQb3NpdGlvbiA9IDA7XG4gICAgdmFyIHByZXZlbnRPdmVyZmxvdyA9IHRoaXMud290LmdldFNldHRpbmcoJ3ByZXZlbnRPdmVyZmxvdycpO1xuICAgIGlmICh0aGlzLnRyaW1taW5nQ29udGFpbmVyID09PSB3aW5kb3cgJiYgKCFwcmV2ZW50T3ZlcmZsb3cgfHwgcHJldmVudE92ZXJmbG93ICE9PSAndmVydGljYWwnKSkge1xuICAgICAgdmFyIGJveCA9IHRoaXMud290Lnd0VGFibGUuaGlkZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICB2YXIgdG9wID0gTWF0aC5jZWlsKGJveC50b3ApO1xuICAgICAgdmFyIGJvdHRvbSA9IE1hdGguY2VpbChib3guYm90dG9tKTtcbiAgICAgIHZhciBmaW5hbExlZnQ7XG4gICAgICB2YXIgZmluYWxUb3A7XG4gICAgICBmaW5hbExlZnQgPSB0aGlzLndvdC53dFRhYmxlLmhpZGVyLnN0eWxlLmxlZnQ7XG4gICAgICBmaW5hbExlZnQgPSBmaW5hbExlZnQgPT09ICcnID8gMCA6IGZpbmFsTGVmdDtcbiAgICAgIGlmICh0b3AgPCAwICYmIChib3R0b20gLSBvdmVybGF5Um9vdC5vZmZzZXRIZWlnaHQpID4gMCkge1xuICAgICAgICBmaW5hbFRvcCA9IC10b3A7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmaW5hbFRvcCA9IDA7XG4gICAgICB9XG4gICAgICBoZWFkZXJQb3NpdGlvbiA9IGZpbmFsVG9wO1xuICAgICAgZmluYWxUb3AgPSBmaW5hbFRvcCArICdweCc7XG4gICAgICBzZXRPdmVybGF5UG9zaXRpb24ob3ZlcmxheVJvb3QsIGZpbmFsTGVmdCwgZmluYWxUb3ApO1xuICAgIH0gZWxzZSB7XG4gICAgICBoZWFkZXJQb3NpdGlvbiA9IHRoaXMuZ2V0U2Nyb2xsUG9zaXRpb24oKTtcbiAgICAgIHJlc2V0Q3NzVHJhbnNmb3JtKG92ZXJsYXlSb290KTtcbiAgICB9XG4gICAgdGhpcy5hZGp1c3RIZWFkZXJCb3JkZXJzUG9zaXRpb24oaGVhZGVyUG9zaXRpb24pO1xuICAgIHRoaXMuYWRqdXN0RWxlbWVudHNTaXplKCk7XG4gIH0sXG4gIHNldFNjcm9sbFBvc2l0aW9uOiBmdW5jdGlvbihwb3MpIHtcbiAgICBpZiAodGhpcy5tYWluVGFibGVTY3JvbGxhYmxlRWxlbWVudCA9PT0gd2luZG93KSB7XG4gICAgICB3aW5kb3cuc2Nyb2xsVG8oZ2V0V2luZG93U2Nyb2xsTGVmdCgpLCBwb3MpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm1haW5UYWJsZVNjcm9sbGFibGVFbGVtZW50LnNjcm9sbFRvcCA9IHBvcztcbiAgICB9XG4gIH0sXG4gIG9uU2Nyb2xsOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLndvdC5nZXRTZXR0aW5nKCdvblNjcm9sbEhvcml6b250YWxseScpO1xuICB9LFxuICBzdW1DZWxsU2l6ZXM6IGZ1bmN0aW9uKGZyb20sIHRvKSB7XG4gICAgdmFyIHN1bSA9IDA7XG4gICAgdmFyIGRlZmF1bHRSb3dIZWlnaHQgPSB0aGlzLndvdC53dFNldHRpbmdzLnNldHRpbmdzLmRlZmF1bHRSb3dIZWlnaHQ7XG4gICAgd2hpbGUgKGZyb20gPCB0bykge1xuICAgICAgdmFyIGhlaWdodCA9IHRoaXMud290Lnd0VGFibGUuZ2V0Um93SGVpZ2h0KGZyb20pO1xuICAgICAgc3VtICs9IGhlaWdodCA9PT0gdm9pZCAwID8gZGVmYXVsdFJvd0hlaWdodCA6IGhlaWdodDtcbiAgICAgIGZyb20rKztcbiAgICB9XG4gICAgcmV0dXJuIHN1bTtcbiAgfSxcbiAgYWRqdXN0RWxlbWVudHNTaXplOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgZm9yY2UgPSBhcmd1bWVudHNbMF0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzBdIDogZmFsc2U7XG4gICAgdGhpcy51cGRhdGVUcmltbWluZ0NvbnRhaW5lcigpO1xuICAgIGlmICh0aGlzLm5lZWRGdWxsUmVuZGVyIHx8IGZvcmNlKSB7XG4gICAgICB0aGlzLmFkanVzdFJvb3RFbGVtZW50U2l6ZSgpO1xuICAgICAgdGhpcy5hZGp1c3RSb290Q2hpbGRyZW5TaXplKCk7XG4gICAgICBpZiAoIWZvcmNlKSB7XG4gICAgICAgIHRoaXMuYXJlRWxlbWVudFNpemVzQWRqdXN0ZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYWRqdXN0Um9vdEVsZW1lbnRTaXplOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgbWFzdGVySG9sZGVyID0gdGhpcy53b3Qud3RUYWJsZS5ob2xkZXI7XG4gICAgdmFyIHNjcm9sbGJhcldpZHRoID0gbWFzdGVySG9sZGVyLmNsaWVudFdpZHRoID09PSBtYXN0ZXJIb2xkZXIub2Zmc2V0V2lkdGggPyAwIDogZ2V0U2Nyb2xsYmFyV2lkdGgoKTtcbiAgICB2YXIgb3ZlcmxheVJvb3QgPSB0aGlzLmNsb25lLnd0VGFibGUuaG9sZGVyLnBhcmVudE5vZGU7XG4gICAgdmFyIG92ZXJsYXlSb290U3R5bGUgPSBvdmVybGF5Um9vdC5zdHlsZTtcbiAgICB2YXIgcHJldmVudE92ZXJmbG93ID0gdGhpcy53b3QuZ2V0U2V0dGluZygncHJldmVudE92ZXJmbG93Jyk7XG4gICAgdmFyIHRhYmxlSGVpZ2h0O1xuICAgIGlmICh0aGlzLnRyaW1taW5nQ29udGFpbmVyICE9PSB3aW5kb3cgfHwgcHJldmVudE92ZXJmbG93ID09PSAnaG9yaXpvbnRhbCcpIHtcbiAgICAgIHZhciB3aWR0aCA9IHRoaXMud290Lnd0Vmlld3BvcnQuZ2V0V29ya3NwYWNlV2lkdGgoKSAtIHNjcm9sbGJhcldpZHRoO1xuICAgICAgd2lkdGggPSBNYXRoLm1pbih3aWR0aCwgaW5uZXJXaWR0aCh0aGlzLndvdC53dFRhYmxlLnd0Um9vdEVsZW1lbnQpKTtcbiAgICAgIG92ZXJsYXlSb290U3R5bGUud2lkdGggPSB3aWR0aCArICdweCc7XG4gICAgfSBlbHNlIHtcbiAgICAgIG92ZXJsYXlSb290U3R5bGUud2lkdGggPSAnJztcbiAgICB9XG4gICAgdGhpcy5jbG9uZS53dFRhYmxlLmhvbGRlci5zdHlsZS53aWR0aCA9IG92ZXJsYXlSb290U3R5bGUud2lkdGg7XG4gICAgdGFibGVIZWlnaHQgPSBvdXRlckhlaWdodCh0aGlzLmNsb25lLnd0VGFibGUuVEFCTEUpO1xuICAgIG92ZXJsYXlSb290U3R5bGUuaGVpZ2h0ID0gKHRhYmxlSGVpZ2h0ID09PSAwID8gdGFibGVIZWlnaHQgOiB0YWJsZUhlaWdodCArIDQpICsgJ3B4JztcbiAgfSxcbiAgYWRqdXN0Um9vdENoaWxkcmVuU2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNjcm9sbGJhcldpZHRoID0gZ2V0U2Nyb2xsYmFyV2lkdGgoKTtcbiAgICB0aGlzLmNsb25lLnd0VGFibGUuaGlkZXIuc3R5bGUud2lkdGggPSB0aGlzLmhpZGVyLnN0eWxlLndpZHRoO1xuICAgIHRoaXMuY2xvbmUud3RUYWJsZS5ob2xkZXIuc3R5bGUud2lkdGggPSB0aGlzLmNsb25lLnd0VGFibGUuaG9sZGVyLnBhcmVudE5vZGUuc3R5bGUud2lkdGg7XG4gICAgaWYgKHNjcm9sbGJhcldpZHRoID09PSAwKSB7XG4gICAgICBzY3JvbGxiYXJXaWR0aCA9IDMwO1xuICAgIH1cbiAgICB0aGlzLmNsb25lLnd0VGFibGUuaG9sZGVyLnN0eWxlLmhlaWdodCA9IHBhcnNlSW50KHRoaXMuY2xvbmUud3RUYWJsZS5ob2xkZXIucGFyZW50Tm9kZS5zdHlsZS5oZWlnaHQsIDEwKSArIHNjcm9sbGJhcldpZHRoICsgJ3B4JztcbiAgfSxcbiAgYXBwbHlUb0RPTTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHRvdGFsID0gdGhpcy53b3QuZ2V0U2V0dGluZygndG90YWxSb3dzJyk7XG4gICAgaWYgKCF0aGlzLmFyZUVsZW1lbnRTaXplc0FkanVzdGVkKSB7XG4gICAgICB0aGlzLmFkanVzdEVsZW1lbnRzU2l6ZSgpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHRoaXMud290Lnd0Vmlld3BvcnQucm93c1JlbmRlckNhbGN1bGF0b3Iuc3RhcnRQb3NpdGlvbiA9PT0gJ251bWJlcicpIHtcbiAgICAgIHRoaXMuc3ByZWFkZXIuc3R5bGUudG9wID0gdGhpcy53b3Qud3RWaWV3cG9ydC5yb3dzUmVuZGVyQ2FsY3VsYXRvci5zdGFydFBvc2l0aW9uICsgJ3B4JztcbiAgICB9IGVsc2UgaWYgKHRvdGFsID09PSAwKSB7XG4gICAgICB0aGlzLnNwcmVhZGVyLnN0eWxlLnRvcCA9ICcwJztcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbmNvcnJlY3QgdmFsdWUgb2YgdGhlIHJvd3NSZW5kZXJDYWxjdWxhdG9yJyk7XG4gICAgfVxuICAgIHRoaXMuc3ByZWFkZXIuc3R5bGUuYm90dG9tID0gJyc7XG4gICAgaWYgKHRoaXMubmVlZEZ1bGxSZW5kZXIpIHtcbiAgICAgIHRoaXMuc3luY092ZXJsYXlPZmZzZXQoKTtcbiAgICB9XG4gIH0sXG4gIHN5bmNPdmVybGF5T2Zmc2V0OiBmdW5jdGlvbigpIHtcbiAgICBpZiAodHlwZW9mIHRoaXMud290Lnd0Vmlld3BvcnQuY29sdW1uc1JlbmRlckNhbGN1bGF0b3Iuc3RhcnRQb3NpdGlvbiA9PT0gJ251bWJlcicpIHtcbiAgICAgIHRoaXMuY2xvbmUud3RUYWJsZS5zcHJlYWRlci5zdHlsZS5sZWZ0ID0gdGhpcy53b3Qud3RWaWV3cG9ydC5jb2x1bW5zUmVuZGVyQ2FsY3VsYXRvci5zdGFydFBvc2l0aW9uICsgJ3B4JztcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jbG9uZS53dFRhYmxlLnNwcmVhZGVyLnN0eWxlLmxlZnQgPSAnJztcbiAgICB9XG4gIH0sXG4gIHNjcm9sbFRvOiBmdW5jdGlvbihzb3VyY2VSb3csIGJvdHRvbUVkZ2UpIHtcbiAgICB2YXIgbmV3WSA9IHRoaXMuZ2V0VGFibGVQYXJlbnRPZmZzZXQoKTtcbiAgICB2YXIgc291cmNlSW5zdGFuY2UgPSB0aGlzLndvdC5jbG9uZVNvdXJjZSA/IHRoaXMud290LmNsb25lU291cmNlIDogdGhpcy53b3Q7XG4gICAgdmFyIG1haW5Ib2xkZXIgPSBzb3VyY2VJbnN0YW5jZS53dFRhYmxlLmhvbGRlcjtcbiAgICB2YXIgc2Nyb2xsYmFyQ29tcGVuc2F0aW9uID0gMDtcbiAgICBpZiAoYm90dG9tRWRnZSAmJiBtYWluSG9sZGVyLm9mZnNldEhlaWdodCAhPT0gbWFpbkhvbGRlci5jbGllbnRIZWlnaHQpIHtcbiAgICAgIHNjcm9sbGJhckNvbXBlbnNhdGlvbiA9IGdldFNjcm9sbGJhcldpZHRoKCk7XG4gICAgfVxuICAgIGlmIChib3R0b21FZGdlKSB7XG4gICAgICB2YXIgZml4ZWRSb3dzQm90dG9tID0gdGhpcy53b3QuZ2V0U2V0dGluZygnZml4ZWRSb3dzQm90dG9tJyk7XG4gICAgICB2YXIgZml4ZWRSb3dzVG9wID0gdGhpcy53b3QuZ2V0U2V0dGluZygnZml4ZWRSb3dzVG9wJyk7XG4gICAgICB2YXIgdG90YWxSb3dzID0gdGhpcy53b3QuZ2V0U2V0dGluZygndG90YWxSb3dzJyk7XG4gICAgICBuZXdZICs9IHRoaXMuc3VtQ2VsbFNpemVzKDAsIHNvdXJjZVJvdyArIDEpO1xuICAgICAgbmV3WSAtPSB0aGlzLndvdC53dFZpZXdwb3J0LmdldFZpZXdwb3J0SGVpZ2h0KCkgLSB0aGlzLnN1bUNlbGxTaXplcyh0b3RhbFJvd3MgLSBmaXhlZFJvd3NCb3R0b20sIHRvdGFsUm93cyk7XG4gICAgICBuZXdZICs9IDE7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5ld1kgKz0gdGhpcy5zdW1DZWxsU2l6ZXModGhpcy53b3QuZ2V0U2V0dGluZygnZml4ZWRSb3dzVG9wJyksIHNvdXJjZVJvdyk7XG4gICAgfVxuICAgIG5ld1kgKz0gc2Nyb2xsYmFyQ29tcGVuc2F0aW9uO1xuICAgIHRoaXMuc2V0U2Nyb2xsUG9zaXRpb24obmV3WSk7XG4gIH0sXG4gIGdldFRhYmxlUGFyZW50T2Zmc2V0OiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5tYWluVGFibGVTY3JvbGxhYmxlRWxlbWVudCA9PT0gd2luZG93KSB7XG4gICAgICByZXR1cm4gdGhpcy53b3Qud3RUYWJsZS5ob2xkZXJPZmZzZXQudG9wO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gIH0sXG4gIGdldFNjcm9sbFBvc2l0aW9uOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZ2V0U2Nyb2xsVG9wKHRoaXMubWFpblRhYmxlU2Nyb2xsYWJsZUVsZW1lbnQpO1xuICB9LFxuICByZWRyYXdTZWxlY3Rpb25Cb3JkZXJzOiBmdW5jdGlvbihzZWxlY3Rpb24pIHtcbiAgICBpZiAoc2VsZWN0aW9uICYmIHNlbGVjdGlvbi5jZWxsUmFuZ2UpIHtcbiAgICAgIHZhciBib3JkZXIgPSBzZWxlY3Rpb24uZ2V0Qm9yZGVyKHRoaXMud290KTtcbiAgICAgIGlmIChib3JkZXIpIHtcbiAgICAgICAgdmFyIGNvcm5lcnMgPSBzZWxlY3Rpb24uZ2V0Q29ybmVycygpO1xuICAgICAgICBib3JkZXIuZGlzYXBwZWFyKCk7XG4gICAgICAgIGJvcmRlci5hcHBlYXIoY29ybmVycyk7XG4gICAgICB9XG4gICAgfVxuICB9LFxuICByZWRyYXdBbGxTZWxlY3Rpb25zQm9yZGVyczogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHNlbGVjdGlvbnMgPSB0aGlzLndvdC5zZWxlY3Rpb25zO1xuICAgIHRoaXMucmVkcmF3U2VsZWN0aW9uQm9yZGVycyhzZWxlY3Rpb25zLmN1cnJlbnQpO1xuICAgIHRoaXMucmVkcmF3U2VsZWN0aW9uQm9yZGVycyhzZWxlY3Rpb25zLmFyZWEpO1xuICAgIHRoaXMucmVkcmF3U2VsZWN0aW9uQm9yZGVycyhzZWxlY3Rpb25zLmZpbGwpO1xuICAgIHRoaXMud290Lnd0VGFibGUud290Lnd0T3ZlcmxheXMubGVmdE92ZXJsYXkucmVmcmVzaCgpO1xuICB9LFxuICBhZGp1c3RIZWFkZXJCb3JkZXJzUG9zaXRpb246IGZ1bmN0aW9uKHBvc2l0aW9uKSB7XG4gICAgdmFyIG1hc3RlclBhcmVudCA9IHRoaXMud290Lnd0VGFibGUuaG9sZGVyLnBhcmVudE5vZGU7XG4gICAgdmFyIHRvdGFsQ29sdW1ucyA9IHRoaXMud290LmdldFNldHRpbmcoJ3RvdGFsQ29sdW1ucycpO1xuICAgIGlmICh0b3RhbENvbHVtbnMpIHtcbiAgICAgIHJlbW92ZUNsYXNzKG1hc3RlclBhcmVudCwgJ2VtcHR5Q29sdW1ucycpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhZGRDbGFzcyhtYXN0ZXJQYXJlbnQsICdlbXB0eUNvbHVtbnMnKTtcbiAgICB9XG4gICAgaWYgKHRoaXMud290LmdldFNldHRpbmcoJ2ZpeGVkUm93c1RvcCcpID09PSAwICYmIHRoaXMud290LmdldFNldHRpbmcoJ2NvbHVtbkhlYWRlcnMnKS5sZW5ndGggPiAwKSB7XG4gICAgICB2YXIgcHJldmlvdXNTdGF0ZSA9IGhhc0NsYXNzKG1hc3RlclBhcmVudCwgJ2lubmVyQm9yZGVyVG9wJyk7XG4gICAgICBpZiAocG9zaXRpb24gfHwgdGhpcy53b3QuZ2V0U2V0dGluZygndG90YWxSb3dzJykgPT09IDApIHtcbiAgICAgICAgYWRkQ2xhc3MobWFzdGVyUGFyZW50LCAnaW5uZXJCb3JkZXJUb3AnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlbW92ZUNsYXNzKG1hc3RlclBhcmVudCwgJ2lubmVyQm9yZGVyVG9wJyk7XG4gICAgICB9XG4gICAgICBpZiAoIXByZXZpb3VzU3RhdGUgJiYgcG9zaXRpb24gfHwgcHJldmlvdXNTdGF0ZSAmJiAhcG9zaXRpb24pIHtcbiAgICAgICAgdGhpcy53b3Qud3RPdmVybGF5cy5hZGp1c3RFbGVtZW50c1NpemUoKTtcbiAgICAgICAgdGhpcy5yZWRyYXdBbGxTZWxlY3Rpb25zQm9yZGVycygpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAodGhpcy53b3QuZ2V0U2V0dGluZygncm93SGVhZGVycycpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdmFyIHNlY29uZEhlYWRlckNlbGwgPSB0aGlzLmNsb25lLnd0VGFibGUuVEhFQUQucXVlcnlTZWxlY3RvckFsbCgndGg6bnRoLW9mLXR5cGUoMiknKTtcbiAgICAgIGlmIChzZWNvbmRIZWFkZXJDZWxsKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2Vjb25kSGVhZGVyQ2VsbC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHNlY29uZEhlYWRlckNlbGxbaV0uc3R5bGVbJ2JvcmRlci1sZWZ0LXdpZHRoJ10gPSAwO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59LCB7fSwgV2Fsa29udGFibGVPdmVybGF5KTtcbjtcbndpbmRvdy5XYWxrb250YWJsZVRvcE92ZXJsYXkgPSBXYWxrb250YWJsZVRvcE92ZXJsYXk7XG5XYWxrb250YWJsZU92ZXJsYXkucmVnaXN0ZXJPdmVybGF5KFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9UT1AsIFdhbGtvbnRhYmxlVG9wT3ZlcmxheSk7XG5cbi8vIyBcbn0se1wiX2Jhc2VcIjoxMixcImhlbHBlcnMvZG9tL2VsZW1lbnRcIjo0N31dLDE2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBXYWxrb250YWJsZVRvcExlZnRDb3JuZXJPdmVybGF5OiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBXYWxrb250YWJsZVRvcExlZnRDb3JuZXJPdmVybGF5O1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzk1X2Jhc2VfXztcbnZhciAkX18wID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9lbGVtZW50XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X199KSxcbiAgICBvdXRlckhlaWdodCA9ICRfXzAub3V0ZXJIZWlnaHQsXG4gICAgb3V0ZXJXaWR0aCA9ICRfXzAub3V0ZXJXaWR0aCxcbiAgICBzZXRPdmVybGF5UG9zaXRpb24gPSAkX18wLnNldE92ZXJsYXlQb3NpdGlvbixcbiAgICByZXNldENzc1RyYW5zZm9ybSA9ICRfXzAucmVzZXRDc3NUcmFuc2Zvcm07XG52YXIgV2Fsa29udGFibGVPdmVybGF5ID0gKCRfX185NV9iYXNlX18gPSBfZGVyZXFfKFwiX2Jhc2VcIiksICRfX185NV9iYXNlX18gJiYgJF9fXzk1X2Jhc2VfXy5fX2VzTW9kdWxlICYmICRfX185NV9iYXNlX18gfHwge2RlZmF1bHQ6ICRfX185NV9iYXNlX199KS5XYWxrb250YWJsZU92ZXJsYXk7XG52YXIgV2Fsa29udGFibGVUb3BMZWZ0Q29ybmVyT3ZlcmxheSA9IGZ1bmN0aW9uIFdhbGtvbnRhYmxlVG9wTGVmdENvcm5lck92ZXJsYXkod290SW5zdGFuY2UpIHtcbiAgJHRyYWNldXJSdW50aW1lLnN1cGVyQ29uc3RydWN0b3IoJFdhbGtvbnRhYmxlVG9wTGVmdENvcm5lck92ZXJsYXkpLmNhbGwodGhpcywgd290SW5zdGFuY2UpO1xuICB0aGlzLmNsb25lID0gdGhpcy5tYWtlQ2xvbmUoV2Fsa29udGFibGVPdmVybGF5LkNMT05FX1RPUF9MRUZUX0NPUk5FUik7XG59O1xudmFyICRXYWxrb250YWJsZVRvcExlZnRDb3JuZXJPdmVybGF5ID0gV2Fsa29udGFibGVUb3BMZWZ0Q29ybmVyT3ZlcmxheTtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKFdhbGtvbnRhYmxlVG9wTGVmdENvcm5lck92ZXJsYXksIHtcbiAgc2hvdWxkQmVSZW5kZXJlZDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuICh0aGlzLndvdC5nZXRTZXR0aW5nKCdmaXhlZFJvd3NUb3AnKSB8fCB0aGlzLndvdC5nZXRTZXR0aW5nKCdjb2x1bW5IZWFkZXJzJykubGVuZ3RoKSAmJiAodGhpcy53b3QuZ2V0U2V0dGluZygnZml4ZWRDb2x1bW5zTGVmdCcpIHx8IHRoaXMud290LmdldFNldHRpbmcoJ3Jvd0hlYWRlcnMnKS5sZW5ndGgpID8gdHJ1ZSA6IGZhbHNlO1xuICB9LFxuICByZXNldEZpeGVkUG9zaXRpb246IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMudXBkYXRlVHJpbW1pbmdDb250YWluZXIoKTtcbiAgICBpZiAoIXRoaXMud290Lnd0VGFibGUuaG9sZGVyLnBhcmVudE5vZGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIG92ZXJsYXlSb290ID0gdGhpcy5jbG9uZS53dFRhYmxlLmhvbGRlci5wYXJlbnROb2RlO1xuICAgIHZhciB0YWJsZUhlaWdodCA9IG91dGVySGVpZ2h0KHRoaXMuY2xvbmUud3RUYWJsZS5UQUJMRSk7XG4gICAgdmFyIHRhYmxlV2lkdGggPSBvdXRlcldpZHRoKHRoaXMuY2xvbmUud3RUYWJsZS5UQUJMRSk7XG4gICAgdmFyIHByZXZlbnRPdmVyZmxvdyA9IHRoaXMud290LmdldFNldHRpbmcoJ3ByZXZlbnRPdmVyZmxvdycpO1xuICAgIGlmICh0aGlzLnRyaW1taW5nQ29udGFpbmVyID09PSB3aW5kb3cpIHtcbiAgICAgIHZhciBib3ggPSB0aGlzLndvdC53dFRhYmxlLmhpZGVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgdmFyIHRvcCA9IE1hdGguY2VpbChib3gudG9wKTtcbiAgICAgIHZhciBsZWZ0ID0gTWF0aC5jZWlsKGJveC5sZWZ0KTtcbiAgICAgIHZhciBib3R0b20gPSBNYXRoLmNlaWwoYm94LmJvdHRvbSk7XG4gICAgICB2YXIgcmlnaHQgPSBNYXRoLmNlaWwoYm94LnJpZ2h0KTtcbiAgICAgIHZhciBmaW5hbExlZnQgPSAnMCc7XG4gICAgICB2YXIgZmluYWxUb3AgPSAnMCc7XG4gICAgICBpZiAoIXByZXZlbnRPdmVyZmxvdyB8fCBwcmV2ZW50T3ZlcmZsb3cgPT09ICd2ZXJ0aWNhbCcpIHtcbiAgICAgICAgaWYgKGxlZnQgPCAwICYmIChyaWdodCAtIG92ZXJsYXlSb290Lm9mZnNldFdpZHRoKSA+IDApIHtcbiAgICAgICAgICBmaW5hbExlZnQgPSAtbGVmdCArICdweCc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghcHJldmVudE92ZXJmbG93IHx8IHByZXZlbnRPdmVyZmxvdyA9PT0gJ2hvcml6b250YWwnKSB7XG4gICAgICAgIGlmICh0b3AgPCAwICYmIChib3R0b20gLSBvdmVybGF5Um9vdC5vZmZzZXRIZWlnaHQpID4gMCkge1xuICAgICAgICAgIGZpbmFsVG9wID0gLXRvcCArICdweCc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHNldE92ZXJsYXlQb3NpdGlvbihvdmVybGF5Um9vdCwgZmluYWxMZWZ0LCBmaW5hbFRvcCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc2V0Q3NzVHJhbnNmb3JtKG92ZXJsYXlSb290KTtcbiAgICB9XG4gICAgb3ZlcmxheVJvb3Quc3R5bGUuaGVpZ2h0ID0gKHRhYmxlSGVpZ2h0ID09PSAwID8gdGFibGVIZWlnaHQgOiB0YWJsZUhlaWdodCArIDQpICsgJ3B4JztcbiAgICBvdmVybGF5Um9vdC5zdHlsZS53aWR0aCA9ICh0YWJsZVdpZHRoID09PSAwID8gdGFibGVXaWR0aCA6IHRhYmxlV2lkdGggKyA0KSArICdweCc7XG4gIH1cbn0sIHt9LCBXYWxrb250YWJsZU92ZXJsYXkpO1xuO1xud2luZG93LldhbGtvbnRhYmxlVG9wTGVmdENvcm5lck92ZXJsYXkgPSBXYWxrb250YWJsZVRvcExlZnRDb3JuZXJPdmVybGF5O1xuV2Fsa29udGFibGVPdmVybGF5LnJlZ2lzdGVyT3ZlcmxheShXYWxrb250YWJsZU92ZXJsYXkuQ0xPTkVfVE9QX0xFRlRfQ09STkVSLCBXYWxrb250YWJsZVRvcExlZnRDb3JuZXJPdmVybGF5KTtcblxuLy8jIFxufSx7XCJfYmFzZVwiOjEyLFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3fV0sMTc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIFdhbGtvbnRhYmxlT3ZlcmxheXM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFdhbGtvbnRhYmxlT3ZlcmxheXM7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19icm93c2VyX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX187XG52YXIgJF9fMCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSksXG4gICAgZ2V0U2Nyb2xsYWJsZUVsZW1lbnQgPSAkX18wLmdldFNjcm9sbGFibGVFbGVtZW50LFxuICAgIGdldFNjcm9sbGJhcldpZHRoID0gJF9fMC5nZXRTY3JvbGxiYXJXaWR0aCxcbiAgICBnZXRTY3JvbGxMZWZ0ID0gJF9fMC5nZXRTY3JvbGxMZWZ0LFxuICAgIGdldFNjcm9sbFRvcCA9ICRfXzAuZ2V0U2Nyb2xsVG9wO1xudmFyIGFycmF5RWFjaCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gPSBfZGVyZXFfKFwiaGVscGVycy9hcnJheVwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9ffSkuYXJyYXlFYWNoO1xudmFyIGlzS2V5ID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9fID0gX2RlcmVxXyhcImhlbHBlcnMvdW5pY29kZVwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX199KS5pc0tleTtcbnZhciBpc01vYmlsZUJyb3dzZXIgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19icm93c2VyX18gPSBfZGVyZXFfKFwiaGVscGVycy9icm93c2VyXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Jyb3dzZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Jyb3dzZXJfX30pLmlzTW9iaWxlQnJvd3NlcjtcbnZhciBFdmVudE1hbmFnZXIgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gPSBfZGVyZXFfKFwiZXZlbnRNYW5hZ2VyXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfX30pLkV2ZW50TWFuYWdlcjtcbnZhciBXYWxrb250YWJsZU92ZXJsYXlzID0gZnVuY3Rpb24gV2Fsa29udGFibGVPdmVybGF5cyh3b3RJbnN0YW5jZSkge1xuICB0aGlzLndvdCA9IHdvdEluc3RhbmNlO1xuICB0aGlzLmluc3RhbmNlID0gdGhpcy53b3Q7XG4gIHRoaXMuZXZlbnRNYW5hZ2VyID0gbmV3IEV2ZW50TWFuYWdlcih0aGlzLndvdCk7XG4gIHRoaXMud290LnVwZGF0ZSgnc2Nyb2xsYmFyV2lkdGgnLCBnZXRTY3JvbGxiYXJXaWR0aCgpKTtcbiAgdGhpcy53b3QudXBkYXRlKCdzY3JvbGxiYXJIZWlnaHQnLCBnZXRTY3JvbGxiYXJXaWR0aCgpKTtcbiAgdGhpcy5zY3JvbGxhYmxlRWxlbWVudCA9IGdldFNjcm9sbGFibGVFbGVtZW50KHRoaXMud290Lnd0VGFibGUuVEFCTEUpO1xuICB0aGlzLnByZXBhcmVPdmVybGF5cygpO1xuICB0aGlzLmRlc3Ryb3llZCA9IGZhbHNlO1xuICB0aGlzLmtleVByZXNzZWQgPSBmYWxzZTtcbiAgdGhpcy5zcHJlYWRlckxhc3RTaXplID0ge1xuICAgIHdpZHRoOiBudWxsLFxuICAgIGhlaWdodDogbnVsbFxuICB9O1xuICB0aGlzLm92ZXJsYXlTY3JvbGxQb3NpdGlvbnMgPSB7XG4gICAgbWFzdGVyOiB7XG4gICAgICB0b3A6IDAsXG4gICAgICBsZWZ0OiAwXG4gICAgfSxcbiAgICB0b3A6IHtcbiAgICAgIHRvcDogbnVsbCxcbiAgICAgIGxlZnQ6IDBcbiAgICB9LFxuICAgIGJvdHRvbToge1xuICAgICAgdG9wOiBudWxsLFxuICAgICAgbGVmdDogMFxuICAgIH0sXG4gICAgbGVmdDoge1xuICAgICAgdG9wOiAwLFxuICAgICAgbGVmdDogbnVsbFxuICAgIH1cbiAgfTtcbiAgdGhpcy5wZW5kaW5nU2Nyb2xsQ2FsbGJhY2tzID0ge1xuICAgIG1hc3Rlcjoge1xuICAgICAgdG9wOiAwLFxuICAgICAgbGVmdDogMFxuICAgIH0sXG4gICAgdG9wOiB7bGVmdDogMH0sXG4gICAgYm90dG9tOiB7bGVmdDogMH0sXG4gICAgbGVmdDoge3RvcDogMH1cbiAgfTtcbiAgdGhpcy52ZXJ0aWNhbFNjcm9sbGluZyA9IGZhbHNlO1xuICB0aGlzLmhvcml6b250YWxTY3JvbGxpbmcgPSBmYWxzZTtcbiAgdGhpcy5kZWxlZ2F0ZWRTY3JvbGxDYWxsYmFjayA9IGZhbHNlO1xuICB0aGlzLnJlZ2lzdGVyZWRMaXN0ZW5lcnMgPSBbXTtcbiAgdGhpcy5yZWdpc3Rlckxpc3RlbmVycygpO1xufTtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKFdhbGtvbnRhYmxlT3ZlcmxheXMsIHtcbiAgcHJlcGFyZU92ZXJsYXlzOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc3luY1Njcm9sbCA9IGZhbHNlO1xuICAgIGlmICh0aGlzLnRvcE92ZXJsYXkpIHtcbiAgICAgIHN5bmNTY3JvbGwgPSB0aGlzLnRvcE92ZXJsYXkudXBkYXRlU3RhdGVPZlJlbmRlcmluZygpIHx8IHN5bmNTY3JvbGw7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudG9wT3ZlcmxheSA9IFdhbGtvbnRhYmxlT3ZlcmxheS5jcmVhdGVPdmVybGF5KFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9UT1AsIHRoaXMud290KTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBXYWxrb250YWJsZUJvdHRvbU92ZXJsYXkgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB0aGlzLmJvdHRvbU92ZXJsYXkgPSB7XG4gICAgICAgIG5lZWRGdWxsUmVuZGVyOiBmYWxzZSxcbiAgICAgICAgdXBkYXRlU3RhdGVPZlJlbmRlcmluZzogKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSlcbiAgICAgIH07XG4gICAgfVxuICAgIGlmICh0eXBlb2YgV2Fsa29udGFibGVCb3R0b21MZWZ0Q29ybmVyT3ZlcmxheSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHRoaXMuYm90dG9tTGVmdENvcm5lck92ZXJsYXkgPSB7XG4gICAgICAgIG5lZWRGdWxsUmVuZGVyOiBmYWxzZSxcbiAgICAgICAgdXBkYXRlU3RhdGVPZlJlbmRlcmluZzogKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSlcbiAgICAgIH07XG4gICAgfVxuICAgIGlmICh0aGlzLmJvdHRvbU92ZXJsYXkpIHtcbiAgICAgIHN5bmNTY3JvbGwgPSB0aGlzLmJvdHRvbU92ZXJsYXkudXBkYXRlU3RhdGVPZlJlbmRlcmluZygpIHx8IHN5bmNTY3JvbGw7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYm90dG9tT3ZlcmxheSA9IFdhbGtvbnRhYmxlT3ZlcmxheS5jcmVhdGVPdmVybGF5KFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9CT1RUT00sIHRoaXMud290KTtcbiAgICB9XG4gICAgaWYgKHRoaXMubGVmdE92ZXJsYXkpIHtcbiAgICAgIHN5bmNTY3JvbGwgPSB0aGlzLmxlZnRPdmVybGF5LnVwZGF0ZVN0YXRlT2ZSZW5kZXJpbmcoKSB8fCBzeW5jU2Nyb2xsO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmxlZnRPdmVybGF5ID0gV2Fsa29udGFibGVPdmVybGF5LmNyZWF0ZU92ZXJsYXkoV2Fsa29udGFibGVPdmVybGF5LkNMT05FX0xFRlQsIHRoaXMud290KTtcbiAgICB9XG4gICAgaWYgKHRoaXMudG9wT3ZlcmxheS5uZWVkRnVsbFJlbmRlciAmJiB0aGlzLmxlZnRPdmVybGF5Lm5lZWRGdWxsUmVuZGVyKSB7XG4gICAgICBpZiAodGhpcy50b3BMZWZ0Q29ybmVyT3ZlcmxheSkge1xuICAgICAgICBzeW5jU2Nyb2xsID0gdGhpcy50b3BMZWZ0Q29ybmVyT3ZlcmxheS51cGRhdGVTdGF0ZU9mUmVuZGVyaW5nKCkgfHwgc3luY1Njcm9sbDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMudG9wTGVmdENvcm5lck92ZXJsYXkgPSBXYWxrb250YWJsZU92ZXJsYXkuY3JlYXRlT3ZlcmxheShXYWxrb250YWJsZU92ZXJsYXkuQ0xPTkVfVE9QX0xFRlRfQ09STkVSLCB0aGlzLndvdCk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0aGlzLmJvdHRvbU92ZXJsYXkubmVlZEZ1bGxSZW5kZXIgJiYgdGhpcy5sZWZ0T3ZlcmxheS5uZWVkRnVsbFJlbmRlcikge1xuICAgICAgaWYgKHRoaXMuYm90dG9tTGVmdENvcm5lck92ZXJsYXkpIHtcbiAgICAgICAgc3luY1Njcm9sbCA9IHRoaXMuYm90dG9tTGVmdENvcm5lck92ZXJsYXkudXBkYXRlU3RhdGVPZlJlbmRlcmluZygpIHx8IHN5bmNTY3JvbGw7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmJvdHRvbUxlZnRDb3JuZXJPdmVybGF5ID0gV2Fsa29udGFibGVPdmVybGF5LmNyZWF0ZU92ZXJsYXkoV2Fsa29udGFibGVPdmVybGF5LkNMT05FX0JPVFRPTV9MRUZUX0NPUk5FUiwgdGhpcy53b3QpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAodGhpcy53b3QuZ2V0U2V0dGluZygnZGVidWcnKSAmJiAhdGhpcy5kZWJ1Zykge1xuICAgICAgdGhpcy5kZWJ1ZyA9IFdhbGtvbnRhYmxlT3ZlcmxheS5jcmVhdGVPdmVybGF5KFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9ERUJVRywgdGhpcy53b3QpO1xuICAgIH1cbiAgICByZXR1cm4gc3luY1Njcm9sbDtcbiAgfSxcbiAgcmVmcmVzaEFsbDogZnVuY3Rpb24oKSB7XG4gICAgaWYgKCF0aGlzLndvdC5kcmF3bikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIXRoaXMud290Lnd0VGFibGUuaG9sZGVyLnBhcmVudE5vZGUpIHtcbiAgICAgIHRoaXMuZGVzdHJveSgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLndvdC5kcmF3KHRydWUpO1xuICAgIGlmICh0aGlzLnZlcnRpY2FsU2Nyb2xsaW5nKSB7XG4gICAgICB0aGlzLmxlZnRPdmVybGF5Lm9uU2Nyb2xsKCk7XG4gICAgfVxuICAgIGlmICh0aGlzLmhvcml6b250YWxTY3JvbGxpbmcpIHtcbiAgICAgIHRoaXMudG9wT3ZlcmxheS5vblNjcm9sbCgpO1xuICAgIH1cbiAgICB0aGlzLnZlcnRpY2FsU2Nyb2xsaW5nID0gZmFsc2U7XG4gICAgdGhpcy5ob3Jpem9udGFsU2Nyb2xsaW5nID0gZmFsc2U7XG4gIH0sXG4gIHJlZ2lzdGVyTGlzdGVuZXJzOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fNSA9IHRoaXM7XG4gICAgdmFyIHRvcE92ZXJsYXlTY3JvbGxhYmxlID0gdGhpcy50b3BPdmVybGF5Lm1haW5UYWJsZVNjcm9sbGFibGVFbGVtZW50O1xuICAgIHZhciBsZWZ0T3ZlcmxheVNjcm9sbGFibGUgPSB0aGlzLmxlZnRPdmVybGF5Lm1haW5UYWJsZVNjcm9sbGFibGVFbGVtZW50O1xuICAgIHZhciBsaXN0ZW5lcnNUb1JlZ2lzdGVyID0gW107XG4gICAgbGlzdGVuZXJzVG9SZWdpc3Rlci5wdXNoKFtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsICdrZXlkb3duJywgKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICByZXR1cm4gJF9fNS5vbktleURvd24oZXZlbnQpO1xuICAgIH0pXSk7XG4gICAgbGlzdGVuZXJzVG9SZWdpc3Rlci5wdXNoKFtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsICdrZXl1cCcsIChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX181Lm9uS2V5VXAoKTtcbiAgICB9KV0pO1xuICAgIGxpc3RlbmVyc1RvUmVnaXN0ZXIucHVzaChbZG9jdW1lbnQsICd2aXNpYmlsaXR5Y2hhbmdlJywgKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICRfXzUub25LZXlVcCgpO1xuICAgIH0pXSk7XG4gICAgbGlzdGVuZXJzVG9SZWdpc3Rlci5wdXNoKFt0b3BPdmVybGF5U2Nyb2xsYWJsZSwgJ3Njcm9sbCcsIChmdW5jdGlvbihldmVudCkge1xuICAgICAgcmV0dXJuICRfXzUub25UYWJsZVNjcm9sbChldmVudCk7XG4gICAgfSldKTtcbiAgICBpZiAodG9wT3ZlcmxheVNjcm9sbGFibGUgIT09IGxlZnRPdmVybGF5U2Nyb2xsYWJsZSkge1xuICAgICAgbGlzdGVuZXJzVG9SZWdpc3Rlci5wdXNoKFtsZWZ0T3ZlcmxheVNjcm9sbGFibGUsICdzY3JvbGwnLCAoZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuICRfXzUub25UYWJsZVNjcm9sbChldmVudCk7XG4gICAgICB9KV0pO1xuICAgIH1cbiAgICBpZiAodGhpcy50b3BPdmVybGF5Lm5lZWRGdWxsUmVuZGVyKSB7XG4gICAgICBsaXN0ZW5lcnNUb1JlZ2lzdGVyLnB1c2goW3RoaXMudG9wT3ZlcmxheS5jbG9uZS53dFRhYmxlLmhvbGRlciwgJ3Njcm9sbCcsIChmdW5jdGlvbihldmVudCkge1xuICAgICAgICByZXR1cm4gJF9fNS5vblRhYmxlU2Nyb2xsKGV2ZW50KTtcbiAgICAgIH0pXSk7XG4gICAgICBsaXN0ZW5lcnNUb1JlZ2lzdGVyLnB1c2goW3RoaXMudG9wT3ZlcmxheS5jbG9uZS53dFRhYmxlLmhvbGRlciwgJ3doZWVsJywgKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIHJldHVybiAkX181Lm9uVGFibGVTY3JvbGwoZXZlbnQpO1xuICAgICAgfSldKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuYm90dG9tT3ZlcmxheS5uZWVkRnVsbFJlbmRlcikge1xuICAgICAgbGlzdGVuZXJzVG9SZWdpc3Rlci5wdXNoKFt0aGlzLmJvdHRvbU92ZXJsYXkuY2xvbmUud3RUYWJsZS5ob2xkZXIsICdzY3JvbGwnLCAoZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuICRfXzUub25UYWJsZVNjcm9sbChldmVudCk7XG4gICAgICB9KV0pO1xuICAgICAgbGlzdGVuZXJzVG9SZWdpc3Rlci5wdXNoKFt0aGlzLmJvdHRvbU92ZXJsYXkuY2xvbmUud3RUYWJsZS5ob2xkZXIsICd3aGVlbCcsIChmdW5jdGlvbihldmVudCkge1xuICAgICAgICByZXR1cm4gJF9fNS5vblRhYmxlU2Nyb2xsKGV2ZW50KTtcbiAgICAgIH0pXSk7XG4gICAgfVxuICAgIGlmICh0aGlzLmxlZnRPdmVybGF5Lm5lZWRGdWxsUmVuZGVyKSB7XG4gICAgICBsaXN0ZW5lcnNUb1JlZ2lzdGVyLnB1c2goW3RoaXMubGVmdE92ZXJsYXkuY2xvbmUud3RUYWJsZS5ob2xkZXIsICdzY3JvbGwnLCAoZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuICRfXzUub25UYWJsZVNjcm9sbChldmVudCk7XG4gICAgICB9KV0pO1xuICAgICAgbGlzdGVuZXJzVG9SZWdpc3Rlci5wdXNoKFt0aGlzLmxlZnRPdmVybGF5LmNsb25lLnd0VGFibGUuaG9sZGVyLCAnd2hlZWwnLCAoZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuICRfXzUub25UYWJsZVNjcm9sbChldmVudCk7XG4gICAgICB9KV0pO1xuICAgIH1cbiAgICBpZiAodGhpcy50b3BMZWZ0Q29ybmVyT3ZlcmxheSAmJiB0aGlzLnRvcExlZnRDb3JuZXJPdmVybGF5Lm5lZWRGdWxsUmVuZGVyKSB7XG4gICAgICBsaXN0ZW5lcnNUb1JlZ2lzdGVyLnB1c2goW3RoaXMudG9wTGVmdENvcm5lck92ZXJsYXkuY2xvbmUud3RUYWJsZS5ob2xkZXIsICd3aGVlbCcsIChmdW5jdGlvbihldmVudCkge1xuICAgICAgICByZXR1cm4gJF9fNS5vblRhYmxlU2Nyb2xsKGV2ZW50KTtcbiAgICAgIH0pXSk7XG4gICAgfVxuICAgIGlmICh0aGlzLmJvdHRvbUxlZnRDb3JuZXJPdmVybGF5ICYmIHRoaXMuYm90dG9tTGVmdENvcm5lck92ZXJsYXkubmVlZEZ1bGxSZW5kZXIpIHtcbiAgICAgIGxpc3RlbmVyc1RvUmVnaXN0ZXIucHVzaChbdGhpcy5ib3R0b21MZWZ0Q29ybmVyT3ZlcmxheS5jbG9uZS53dFRhYmxlLmhvbGRlciwgJ3doZWVsJywgKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIHJldHVybiAkX181Lm9uVGFibGVTY3JvbGwoZXZlbnQpO1xuICAgICAgfSldKTtcbiAgICB9XG4gICAgaWYgKHRoaXMudG9wT3ZlcmxheS50cmltbWluZ0NvbnRhaW5lciAhPT0gd2luZG93ICYmIHRoaXMubGVmdE92ZXJsYXkudHJpbW1pbmdDb250YWluZXIgIT09IHdpbmRvdykge1xuICAgICAgbGlzdGVuZXJzVG9SZWdpc3Rlci5wdXNoKFt3aW5kb3csICd3aGVlbCcsIChmdW5jdGlvbihldmVudCkge1xuICAgICAgICB2YXIgb3ZlcmxheTtcbiAgICAgICAgdmFyIGRlbHRhWSA9IGV2ZW50LndoZWVsRGVsdGFZIHx8IGV2ZW50LmRlbHRhWTtcbiAgICAgICAgdmFyIGRlbHRhWCA9IGV2ZW50LndoZWVsRGVsdGFYIHx8IGV2ZW50LmRlbHRhWDtcbiAgICAgICAgaWYgKCRfXzUudG9wT3ZlcmxheS5jbG9uZS53dFRhYmxlLmhvbGRlci5jb250YWlucyhldmVudC5yZWFsVGFyZ2V0KSkge1xuICAgICAgICAgIG92ZXJsYXkgPSAndG9wJztcbiAgICAgICAgfSBlbHNlIGlmICgkX181LmJvdHRvbU92ZXJsYXkuY2xvbmUgJiYgJF9fNS5ib3R0b21PdmVybGF5LmNsb25lLnd0VGFibGUuaG9sZGVyLmNvbnRhaW5zKGV2ZW50LnJlYWxUYXJnZXQpKSB7XG4gICAgICAgICAgb3ZlcmxheSA9ICdib3R0b20nO1xuICAgICAgICB9IGVsc2UgaWYgKCRfXzUubGVmdE92ZXJsYXkuY2xvbmUud3RUYWJsZS5ob2xkZXIuY29udGFpbnMoZXZlbnQucmVhbFRhcmdldCkpIHtcbiAgICAgICAgICBvdmVybGF5ID0gJ2xlZnQnO1xuICAgICAgICB9IGVsc2UgaWYgKCRfXzUudG9wTGVmdENvcm5lck92ZXJsYXkgJiYgJF9fNS50b3BMZWZ0Q29ybmVyT3ZlcmxheS5jbG9uZSAmJiAkX181LnRvcExlZnRDb3JuZXJPdmVybGF5LmNsb25lLnd0VGFibGUuaG9sZGVyLmNvbnRhaW5zKGV2ZW50LnJlYWxUYXJnZXQpKSB7XG4gICAgICAgICAgb3ZlcmxheSA9ICd0b3BMZWZ0JztcbiAgICAgICAgfSBlbHNlIGlmICgkX181LmJvdHRvbUxlZnRDb3JuZXJPdmVybGF5ICYmICRfXzUuYm90dG9tTGVmdENvcm5lck92ZXJsYXkuY2xvbmUgJiYgJF9fNS5ib3R0b21MZWZ0Q29ybmVyT3ZlcmxheS5jbG9uZS53dFRhYmxlLmhvbGRlci5jb250YWlucyhldmVudC5yZWFsVGFyZ2V0KSkge1xuICAgICAgICAgIG92ZXJsYXkgPSAnYm90dG9tTGVmdCc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKChvdmVybGF5ID09ICd0b3AnICYmIGRlbHRhWSAhPT0gMCkgfHwgKG92ZXJsYXkgPT0gJ2xlZnQnICYmIGRlbHRhWCAhPT0gMCkgfHwgKG92ZXJsYXkgPT0gJ2JvdHRvbScgJiYgZGVsdGFZICE9PSAwKSB8fCAoKG92ZXJsYXkgPT09ICd0b3BMZWZ0JyB8fCBvdmVybGF5ID09PSAnYm90dG9tTGVmdCcpICYmIChkZWx0YVkgIT09IDAgfHwgZGVsdGFYICE9PSAwKSkpIHtcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgICB9KV0pO1xuICAgIH1cbiAgICB3aGlsZSAobGlzdGVuZXJzVG9SZWdpc3Rlci5sZW5ndGgpIHtcbiAgICAgIHZhciBsaXN0ZW5lciA9IGxpc3RlbmVyc1RvUmVnaXN0ZXIucG9wKCk7XG4gICAgICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKGxpc3RlbmVyWzBdLCBsaXN0ZW5lclsxXSwgbGlzdGVuZXJbMl0pO1xuICAgICAgdGhpcy5yZWdpc3RlcmVkTGlzdGVuZXJzLnB1c2gobGlzdGVuZXIpO1xuICAgIH1cbiAgfSxcbiAgZGVyZWdpc3Rlckxpc3RlbmVyczogZnVuY3Rpb24oKSB7XG4gICAgd2hpbGUgKHRoaXMucmVnaXN0ZXJlZExpc3RlbmVycy5sZW5ndGgpIHtcbiAgICAgIHZhciBsaXN0ZW5lciA9IHRoaXMucmVnaXN0ZXJlZExpc3RlbmVycy5wb3AoKTtcbiAgICAgIHRoaXMuZXZlbnRNYW5hZ2VyLnJlbW92ZUV2ZW50TGlzdGVuZXIobGlzdGVuZXJbMF0sIGxpc3RlbmVyWzFdLCBsaXN0ZW5lclsyXSk7XG4gICAgfVxuICB9LFxuICBvblRhYmxlU2Nyb2xsOiBmdW5jdGlvbihldmVudCkge1xuICAgIGlmIChpc01vYmlsZUJyb3dzZXIoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgbWFzdGVySG9yaXpvbnRhbCA9IHRoaXMubGVmdE92ZXJsYXkubWFpblRhYmxlU2Nyb2xsYWJsZUVsZW1lbnQ7XG4gICAgdmFyIG1hc3RlclZlcnRpY2FsID0gdGhpcy50b3BPdmVybGF5Lm1haW5UYWJsZVNjcm9sbGFibGVFbGVtZW50O1xuICAgIHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG4gICAgaWYgKHRoaXMua2V5UHJlc3NlZCkge1xuICAgICAgaWYgKChtYXN0ZXJWZXJ0aWNhbCAhPT0gd2luZG93ICYmIHRhcmdldCAhPT0gd2luZG93ICYmICFldmVudC50YXJnZXQuY29udGFpbnMobWFzdGVyVmVydGljYWwpKSB8fCAobWFzdGVySG9yaXpvbnRhbCAhPT0gd2luZG93ICYmIHRhcmdldCAhPT0gd2luZG93ICYmICFldmVudC50YXJnZXQuY29udGFpbnMobWFzdGVySG9yaXpvbnRhbCkpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGV2ZW50LnR5cGUgPT09ICdzY3JvbGwnKSB7XG4gICAgICB0aGlzLnN5bmNTY3JvbGxQb3NpdGlvbnMoZXZlbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnRyYW5zbGF0ZU1vdXNlV2hlZWxUb1Njcm9sbChldmVudCk7XG4gICAgfVxuICB9LFxuICBvbktleURvd246IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdGhpcy5rZXlQcmVzc2VkID0gaXNLZXkoZXZlbnQua2V5Q29kZSwgJ0FSUk9XX1VQfEFSUk9XX1JJR0hUfEFSUk9XX0RPV058QVJST1dfTEVGVCcpO1xuICB9LFxuICBvbktleVVwOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmtleVByZXNzZWQgPSBmYWxzZTtcbiAgfSxcbiAgdHJhbnNsYXRlTW91c2VXaGVlbFRvU2Nyb2xsOiBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciB0b3BPdmVybGF5ID0gdGhpcy50b3BPdmVybGF5LmNsb25lLnd0VGFibGUuaG9sZGVyO1xuICAgIHZhciBib3R0b21PdmVybGF5ID0gdGhpcy5ib3R0b21PdmVybGF5LmNsb25lID8gdGhpcy5ib3R0b21PdmVybGF5LmNsb25lLnd0VGFibGUuaG9sZGVyIDogbnVsbDtcbiAgICB2YXIgbGVmdE92ZXJsYXkgPSB0aGlzLmxlZnRPdmVybGF5LmNsb25lLnd0VGFibGUuaG9sZGVyO1xuICAgIHZhciB0b3BMZWZ0Q29ybmVyT3ZlcmxheSA9IHRoaXMudG9wTGVmdENvcm5lck92ZXJsYXkgJiYgdGhpcy50b3BMZWZ0Q29ybmVyT3ZlcmxheS5jbG9uZSA/IHRoaXMudG9wTGVmdENvcm5lck92ZXJsYXkuY2xvbmUud3RUYWJsZS5ob2xkZXIgOiBudWxsO1xuICAgIHZhciBib3R0b21MZWZ0Q29ybmVyT3ZlcmxheSA9IHRoaXMuYm90dG9tTGVmdENvcm5lck92ZXJsYXkgJiYgdGhpcy5ib3R0b21MZWZ0Q29ybmVyT3ZlcmxheS5jbG9uZSA/IHRoaXMuYm90dG9tTGVmdENvcm5lck92ZXJsYXkuY2xvbmUud3RUYWJsZS5ob2xkZXIgOiBudWxsO1xuICAgIHZhciBtb3VzZVdoZWVsU3BlZWRSYXRpbyA9IC0wLjI7XG4gICAgdmFyIGRlbHRhWSA9IGV2ZW50LndoZWVsRGVsdGFZIHx8ICgtMSkgKiBldmVudC5kZWx0YVk7XG4gICAgdmFyIGRlbHRhWCA9IGV2ZW50LndoZWVsRGVsdGFYIHx8ICgtMSkgKiBldmVudC5kZWx0YVg7XG4gICAgdmFyIHBhcmVudEhvbGRlciA9IG51bGw7XG4gICAgdmFyIGV2ZW50TW9ja3VwID0ge3R5cGU6ICd3aGVlbCd9O1xuICAgIHZhciB0ZW1wRWxlbSA9IGV2ZW50LnRhcmdldDtcbiAgICB2YXIgZGVsdGEgPSBudWxsO1xuICAgIGlmIChldmVudC5kZWx0YU1vZGUgPT09IDEpIHtcbiAgICAgIGRlbHRhWSA9IGRlbHRhWSAqIDEyMDtcbiAgICAgIGRlbHRhWCA9IGRlbHRhWCAqIDEyMDtcbiAgICB9XG4gICAgd2hpbGUgKHRlbXBFbGVtICE9IGRvY3VtZW50ICYmIHRlbXBFbGVtICE9IG51bGwpIHtcbiAgICAgIGlmICh0ZW1wRWxlbS5jbGFzc05hbWUuaW5kZXhPZignd3RIb2xkZXInKSA+IC0xKSB7XG4gICAgICAgIHBhcmVudEhvbGRlciA9IHRlbXBFbGVtO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHRlbXBFbGVtID0gdGVtcEVsZW0ucGFyZW50Tm9kZTtcbiAgICB9XG4gICAgZXZlbnRNb2NrdXAudGFyZ2V0ID0gcGFyZW50SG9sZGVyO1xuICAgIGlmIChwYXJlbnRIb2xkZXIgPT09IHRvcExlZnRDb3JuZXJPdmVybGF5IHx8IHBhcmVudEhvbGRlciA9PT0gYm90dG9tTGVmdENvcm5lck92ZXJsYXkpIHtcbiAgICAgIHRoaXMuc3luY1Njcm9sbFBvc2l0aW9ucyhldmVudE1vY2t1cCwgbW91c2VXaGVlbFNwZWVkUmF0aW8gKiBkZWx0YVgsICd4Jyk7XG4gICAgICB0aGlzLnN5bmNTY3JvbGxQb3NpdGlvbnMoZXZlbnRNb2NrdXAsIG1vdXNlV2hlZWxTcGVlZFJhdGlvICogZGVsdGFZLCAneScpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAocGFyZW50SG9sZGVyID09PSB0b3BPdmVybGF5IHx8IHBhcmVudEhvbGRlciA9PT0gYm90dG9tT3ZlcmxheSkge1xuICAgICAgICBkZWx0YSA9IGRlbHRhWTtcbiAgICAgIH0gZWxzZSBpZiAocGFyZW50SG9sZGVyID09PSBsZWZ0T3ZlcmxheSkge1xuICAgICAgICBkZWx0YSA9IGRlbHRhWDtcbiAgICAgIH1cbiAgICAgIHRoaXMuc3luY1Njcm9sbFBvc2l0aW9ucyhldmVudE1vY2t1cCwgbW91c2VXaGVlbFNwZWVkUmF0aW8gKiBkZWx0YSk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfSxcbiAgc3luY1Njcm9sbFBvc2l0aW9uczogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgZmFrZVNjcm9sbFZhbHVlID0gYXJndW1lbnRzWzFdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1sxXSA6IG51bGw7XG4gICAgdmFyIGZha2VTY3JvbGxEaXJlY3Rpb24gPSBhcmd1bWVudHNbMl0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzJdIDogbnVsbDtcbiAgICBpZiAodGhpcy5kZXN0cm95ZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgIHRoaXMuc3luY1Njcm9sbFdpdGhNYXN0ZXIoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIG1hc3Rlckhvcml6b250YWwgPSB0aGlzLmxlZnRPdmVybGF5Lm1haW5UYWJsZVNjcm9sbGFibGVFbGVtZW50O1xuICAgIHZhciBtYXN0ZXJWZXJ0aWNhbCA9IHRoaXMudG9wT3ZlcmxheS5tYWluVGFibGVTY3JvbGxhYmxlRWxlbWVudDtcbiAgICB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICAgIHZhciB0ZW1wU2Nyb2xsVmFsdWUgPSAwO1xuICAgIHZhciBzY3JvbGxWYWx1ZUNoYW5nZWQgPSBmYWxzZTtcbiAgICB2YXIgdG9wT3ZlcmxheTtcbiAgICB2YXIgbGVmdE92ZXJsYXk7XG4gICAgdmFyIHRvcExlZnRDb3JuZXJPdmVybGF5O1xuICAgIHZhciBib3R0b21MZWZ0Q29ybmVyT3ZlcmxheTtcbiAgICB2YXIgYm90dG9tT3ZlcmxheTtcbiAgICB2YXIgZGVsZWdhdGVkU2Nyb2xsID0gZmFsc2U7XG4gICAgdmFyIHByZXZlbnRPdmVyZmxvdyA9IHRoaXMud290LmdldFNldHRpbmcoJ3ByZXZlbnRPdmVyZmxvdycpO1xuICAgIGlmICh0aGlzLnRvcE92ZXJsYXkubmVlZEZ1bGxSZW5kZXIpIHtcbiAgICAgIHRvcE92ZXJsYXkgPSB0aGlzLnRvcE92ZXJsYXkuY2xvbmUud3RUYWJsZS5ob2xkZXI7XG4gICAgfVxuICAgIGlmICh0aGlzLmJvdHRvbU92ZXJsYXkubmVlZEZ1bGxSZW5kZXIpIHtcbiAgICAgIGJvdHRvbU92ZXJsYXkgPSB0aGlzLmJvdHRvbU92ZXJsYXkuY2xvbmUud3RUYWJsZS5ob2xkZXI7XG4gICAgfVxuICAgIGlmICh0aGlzLmxlZnRPdmVybGF5Lm5lZWRGdWxsUmVuZGVyKSB7XG4gICAgICBsZWZ0T3ZlcmxheSA9IHRoaXMubGVmdE92ZXJsYXkuY2xvbmUud3RUYWJsZS5ob2xkZXI7XG4gICAgfVxuICAgIGlmICh0aGlzLmxlZnRPdmVybGF5Lm5lZWRGdWxsUmVuZGVyICYmIHRoaXMudG9wT3ZlcmxheS5uZWVkRnVsbFJlbmRlcikge1xuICAgICAgdG9wTGVmdENvcm5lck92ZXJsYXkgPSB0aGlzLnRvcExlZnRDb3JuZXJPdmVybGF5LmNsb25lLnd0VGFibGUuaG9sZGVyO1xuICAgIH1cbiAgICBpZiAodGhpcy5sZWZ0T3ZlcmxheS5uZWVkRnVsbFJlbmRlciAmJiB0aGlzLmJvdHRvbU92ZXJsYXkubmVlZEZ1bGxSZW5kZXIpIHtcbiAgICAgIGJvdHRvbUxlZnRDb3JuZXJPdmVybGF5ID0gdGhpcy5ib3R0b21MZWZ0Q29ybmVyT3ZlcmxheS5jbG9uZS53dFRhYmxlLmhvbGRlcjtcbiAgICB9XG4gICAgaWYgKHRhcmdldCA9PT0gZG9jdW1lbnQpIHtcbiAgICAgIHRhcmdldCA9IHdpbmRvdztcbiAgICB9XG4gICAgaWYgKHRhcmdldCA9PT0gbWFzdGVySG9yaXpvbnRhbCB8fCB0YXJnZXQgPT09IG1hc3RlclZlcnRpY2FsKSB7XG4gICAgICBpZiAocHJldmVudE92ZXJmbG93KSB7XG4gICAgICAgIHRlbXBTY3JvbGxWYWx1ZSA9IGdldFNjcm9sbExlZnQodGhpcy5zY3JvbGxhYmxlRWxlbWVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0ZW1wU2Nyb2xsVmFsdWUgPSBnZXRTY3JvbGxMZWZ0KHRhcmdldCk7XG4gICAgICB9XG4gICAgICB0aGlzLmhvcml6b250YWxTY3JvbGxpbmcgPSB0cnVlO1xuICAgICAgdGhpcy5vdmVybGF5U2Nyb2xsUG9zaXRpb25zLm1hc3Rlci5sZWZ0ID0gdGVtcFNjcm9sbFZhbHVlO1xuICAgICAgc2Nyb2xsVmFsdWVDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgIGlmICh0aGlzLnBlbmRpbmdTY3JvbGxDYWxsYmFja3MubWFzdGVyLmxlZnQgPiAwKSB7XG4gICAgICAgIHRoaXMucGVuZGluZ1Njcm9sbENhbGxiYWNrcy5tYXN0ZXIubGVmdC0tO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHRvcE92ZXJsYXkgJiYgdG9wT3ZlcmxheS5zY3JvbGxMZWZ0ICE9PSB0ZW1wU2Nyb2xsVmFsdWUpIHtcbiAgICAgICAgICBpZiAoZmFrZVNjcm9sbFZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMucGVuZGluZ1Njcm9sbENhbGxiYWNrcy50b3AubGVmdCsrO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0b3BPdmVybGF5LnNjcm9sbExlZnQgPSB0ZW1wU2Nyb2xsVmFsdWU7XG4gICAgICAgICAgZGVsZWdhdGVkU2Nyb2xsID0gKG1hc3Rlckhvcml6b250YWwgIT09IHdpbmRvdyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJvdHRvbU92ZXJsYXkgJiYgYm90dG9tT3ZlcmxheS5zY3JvbGxMZWZ0ICE9PSB0ZW1wU2Nyb2xsVmFsdWUpIHtcbiAgICAgICAgICBpZiAoZmFrZVNjcm9sbFZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMucGVuZGluZ1Njcm9sbENhbGxiYWNrcy5ib3R0b20ubGVmdCsrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBib3R0b21PdmVybGF5LnNjcm9sbExlZnQgPSB0ZW1wU2Nyb2xsVmFsdWU7XG4gICAgICAgICAgZGVsZWdhdGVkU2Nyb2xsID0gKG1hc3Rlckhvcml6b250YWwgIT09IHdpbmRvdyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRlbXBTY3JvbGxWYWx1ZSA9IGdldFNjcm9sbFRvcCh0YXJnZXQpO1xuICAgICAgdGhpcy52ZXJ0aWNhbFNjcm9sbGluZyA9IHRydWU7XG4gICAgICB0aGlzLm92ZXJsYXlTY3JvbGxQb3NpdGlvbnMubWFzdGVyLnRvcCA9IHRlbXBTY3JvbGxWYWx1ZTtcbiAgICAgIHNjcm9sbFZhbHVlQ2hhbmdlZCA9IHRydWU7XG4gICAgICBpZiAodGhpcy5wZW5kaW5nU2Nyb2xsQ2FsbGJhY2tzLm1hc3Rlci50b3AgPiAwKSB7XG4gICAgICAgIHRoaXMucGVuZGluZ1Njcm9sbENhbGxiYWNrcy5tYXN0ZXIudG9wLS07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAobGVmdE92ZXJsYXkgJiYgbGVmdE92ZXJsYXkuc2Nyb2xsVG9wICE9PSB0ZW1wU2Nyb2xsVmFsdWUpIHtcbiAgICAgICAgICBpZiAoZmFrZVNjcm9sbFZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMucGVuZGluZ1Njcm9sbENhbGxiYWNrcy5sZWZ0LnRvcCsrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBsZWZ0T3ZlcmxheS5zY3JvbGxUb3AgPSB0ZW1wU2Nyb2xsVmFsdWU7XG4gICAgICAgICAgZGVsZWdhdGVkU2Nyb2xsID0gKG1hc3RlclZlcnRpY2FsICE9PSB3aW5kb3cpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0YXJnZXQgPT09IGJvdHRvbU92ZXJsYXkpIHtcbiAgICAgIHRlbXBTY3JvbGxWYWx1ZSA9IGdldFNjcm9sbExlZnQodGFyZ2V0KTtcbiAgICAgIHRoaXMuaG9yaXpvbnRhbFNjcm9sbGluZyA9IHRydWU7XG4gICAgICB0aGlzLm92ZXJsYXlTY3JvbGxQb3NpdGlvbnMuYm90dG9tLmxlZnQgPSB0ZW1wU2Nyb2xsVmFsdWU7XG4gICAgICBzY3JvbGxWYWx1ZUNoYW5nZWQgPSB0cnVlO1xuICAgICAgaWYgKHRoaXMucGVuZGluZ1Njcm9sbENhbGxiYWNrcy5ib3R0b20ubGVmdCA+IDApIHtcbiAgICAgICAgdGhpcy5wZW5kaW5nU2Nyb2xsQ2FsbGJhY2tzLmJvdHRvbS5sZWZ0LS07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoZmFrZVNjcm9sbFZhbHVlID09IG51bGwpIHtcbiAgICAgICAgICB0aGlzLnBlbmRpbmdTY3JvbGxDYWxsYmFja3MubWFzdGVyLmxlZnQrKztcbiAgICAgICAgfVxuICAgICAgICBtYXN0ZXJIb3Jpem9udGFsLnNjcm9sbExlZnQgPSB0ZW1wU2Nyb2xsVmFsdWU7XG4gICAgICAgIGlmICh0b3BPdmVybGF5ICYmIHRvcE92ZXJsYXkuc2Nyb2xsTGVmdCAhPT0gdGVtcFNjcm9sbFZhbHVlKSB7XG4gICAgICAgICAgaWYgKGZha2VTY3JvbGxWYWx1ZSA9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLnBlbmRpbmdTY3JvbGxDYWxsYmFja3MudG9wLmxlZnQrKztcbiAgICAgICAgICB9XG4gICAgICAgICAgdG9wT3ZlcmxheS5zY3JvbGxMZWZ0ID0gdGVtcFNjcm9sbFZhbHVlO1xuICAgICAgICAgIGRlbGVnYXRlZFNjcm9sbCA9IChtYXN0ZXJWZXJ0aWNhbCAhPT0gd2luZG93KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGZha2VTY3JvbGxWYWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICBzY3JvbGxWYWx1ZUNoYW5nZWQgPSB0cnVlO1xuICAgICAgICBtYXN0ZXJWZXJ0aWNhbC5zY3JvbGxUb3AgKz0gZmFrZVNjcm9sbFZhbHVlO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodGFyZ2V0ID09PSB0b3BPdmVybGF5KSB7XG4gICAgICB0ZW1wU2Nyb2xsVmFsdWUgPSBnZXRTY3JvbGxMZWZ0KHRhcmdldCk7XG4gICAgICB0aGlzLmhvcml6b250YWxTY3JvbGxpbmcgPSB0cnVlO1xuICAgICAgdGhpcy5vdmVybGF5U2Nyb2xsUG9zaXRpb25zLnRvcC5sZWZ0ID0gdGVtcFNjcm9sbFZhbHVlO1xuICAgICAgc2Nyb2xsVmFsdWVDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgIGlmICh0aGlzLnBlbmRpbmdTY3JvbGxDYWxsYmFja3MudG9wLmxlZnQgPiAwKSB7XG4gICAgICAgIHRoaXMucGVuZGluZ1Njcm9sbENhbGxiYWNrcy50b3AubGVmdC0tO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGZha2VTY3JvbGxWYWx1ZSA9PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5wZW5kaW5nU2Nyb2xsQ2FsbGJhY2tzLm1hc3Rlci5sZWZ0Kys7XG4gICAgICAgIH1cbiAgICAgICAgbWFzdGVySG9yaXpvbnRhbC5zY3JvbGxMZWZ0ID0gdGVtcFNjcm9sbFZhbHVlO1xuICAgICAgfVxuICAgICAgaWYgKGZha2VTY3JvbGxWYWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICBzY3JvbGxWYWx1ZUNoYW5nZWQgPSB0cnVlO1xuICAgICAgICBtYXN0ZXJWZXJ0aWNhbC5zY3JvbGxUb3AgKz0gZmFrZVNjcm9sbFZhbHVlO1xuICAgICAgfVxuICAgICAgaWYgKGJvdHRvbU92ZXJsYXkgJiYgYm90dG9tT3ZlcmxheS5zY3JvbGxMZWZ0ICE9PSB0ZW1wU2Nyb2xsVmFsdWUpIHtcbiAgICAgICAgaWYgKGZha2VTY3JvbGxWYWx1ZSA9PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5wZW5kaW5nU2Nyb2xsQ2FsbGJhY2tzLmJvdHRvbS5sZWZ0Kys7XG4gICAgICAgIH1cbiAgICAgICAgYm90dG9tT3ZlcmxheS5zY3JvbGxMZWZ0ID0gdGVtcFNjcm9sbFZhbHVlO1xuICAgICAgICBkZWxlZ2F0ZWRTY3JvbGwgPSAobWFzdGVyVmVydGljYWwgIT09IHdpbmRvdyk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0YXJnZXQgPT09IGxlZnRPdmVybGF5KSB7XG4gICAgICB0ZW1wU2Nyb2xsVmFsdWUgPSBnZXRTY3JvbGxUb3AodGFyZ2V0KTtcbiAgICAgIGlmICh0aGlzLm92ZXJsYXlTY3JvbGxQb3NpdGlvbnMubGVmdC50b3AgIT09IHRlbXBTY3JvbGxWYWx1ZSkge1xuICAgICAgICB0aGlzLnZlcnRpY2FsU2Nyb2xsaW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5vdmVybGF5U2Nyb2xsUG9zaXRpb25zLmxlZnQudG9wID0gdGVtcFNjcm9sbFZhbHVlO1xuICAgICAgICBzY3JvbGxWYWx1ZUNoYW5nZWQgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5wZW5kaW5nU2Nyb2xsQ2FsbGJhY2tzLmxlZnQudG9wID4gMCkge1xuICAgICAgICAgIHRoaXMucGVuZGluZ1Njcm9sbENhbGxiYWNrcy5sZWZ0LnRvcC0tO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChmYWtlU2Nyb2xsVmFsdWUgPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5wZW5kaW5nU2Nyb2xsQ2FsbGJhY2tzLm1hc3Rlci50b3ArKztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWFzdGVyVmVydGljYWwuc2Nyb2xsVG9wID0gdGVtcFNjcm9sbFZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoZmFrZVNjcm9sbFZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgIHNjcm9sbFZhbHVlQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgIG1hc3RlclZlcnRpY2FsLnNjcm9sbExlZnQgKz0gZmFrZVNjcm9sbFZhbHVlO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodGFyZ2V0ID09PSB0b3BMZWZ0Q29ybmVyT3ZlcmxheSB8fCB0YXJnZXQgPT09IGJvdHRvbUxlZnRDb3JuZXJPdmVybGF5KSB7XG4gICAgICBpZiAoZmFrZVNjcm9sbFZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgIHNjcm9sbFZhbHVlQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgIGlmIChmYWtlU2Nyb2xsRGlyZWN0aW9uID09PSAneCcpIHtcbiAgICAgICAgICBtYXN0ZXJWZXJ0aWNhbC5zY3JvbGxMZWZ0ICs9IGZha2VTY3JvbGxWYWx1ZTtcbiAgICAgICAgfSBlbHNlIGlmIChmYWtlU2Nyb2xsRGlyZWN0aW9uID09PSAneScpIHtcbiAgICAgICAgICBtYXN0ZXJWZXJ0aWNhbC5zY3JvbGxUb3AgKz0gZmFrZVNjcm9sbFZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghdGhpcy5rZXlQcmVzc2VkICYmIHNjcm9sbFZhbHVlQ2hhbmdlZCAmJiBldmVudC50eXBlID09PSAnc2Nyb2xsJykge1xuICAgICAgaWYgKHRoaXMuZGVsZWdhdGVkU2Nyb2xsQ2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5kZWxlZ2F0ZWRTY3JvbGxDYWxsYmFjayA9IGZhbHNlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5yZWZyZXNoQWxsKCk7XG4gICAgICB9XG4gICAgICBpZiAoZGVsZWdhdGVkU2Nyb2xsKSB7XG4gICAgICAgIHRoaXMuZGVsZWdhdGVkU2Nyb2xsQ2FsbGJhY2sgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgc3luY1Njcm9sbFdpdGhNYXN0ZXI6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBtYXN0ZXIgPSB0aGlzLnRvcE92ZXJsYXkubWFpblRhYmxlU2Nyb2xsYWJsZUVsZW1lbnQ7XG4gICAgdmFyICRfXzcgPSBtYXN0ZXIsXG4gICAgICAgIHNjcm9sbExlZnQgPSAkX183LnNjcm9sbExlZnQsXG4gICAgICAgIHNjcm9sbFRvcCA9ICRfXzcuc2Nyb2xsVG9wO1xuICAgIGlmICh0aGlzLnRvcE92ZXJsYXkubmVlZEZ1bGxSZW5kZXIpIHtcbiAgICAgIHRoaXMudG9wT3ZlcmxheS5jbG9uZS53dFRhYmxlLmhvbGRlci5zY3JvbGxMZWZ0ID0gc2Nyb2xsTGVmdDtcbiAgICB9XG4gICAgaWYgKHRoaXMuYm90dG9tT3ZlcmxheS5uZWVkRnVsbFJlbmRlcikge1xuICAgICAgdGhpcy5ib3R0b21PdmVybGF5LmNsb25lLnd0VGFibGUuaG9sZGVyLnNjcm9sbExlZnQgPSBzY3JvbGxMZWZ0O1xuICAgIH1cbiAgICBpZiAodGhpcy5sZWZ0T3ZlcmxheS5uZWVkRnVsbFJlbmRlcikge1xuICAgICAgdGhpcy5sZWZ0T3ZlcmxheS5jbG9uZS53dFRhYmxlLmhvbGRlci5zY3JvbGxUb3AgPSBzY3JvbGxUb3A7XG4gICAgfVxuICB9LFxuICB1cGRhdGVNYWluU2Nyb2xsYWJsZUVsZW1lbnRzOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmRlcmVnaXN0ZXJMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLmxlZnRPdmVybGF5LnVwZGF0ZU1haW5TY3JvbGxhYmxlRWxlbWVudCgpO1xuICAgIHRoaXMudG9wT3ZlcmxheS51cGRhdGVNYWluU2Nyb2xsYWJsZUVsZW1lbnQoKTtcbiAgICBpZiAodGhpcy5ib3R0b21PdmVybGF5Lm5lZWRGdWxsUmVuZGVyKSB7XG4gICAgICB0aGlzLmJvdHRvbU92ZXJsYXkudXBkYXRlTWFpblNjcm9sbGFibGVFbGVtZW50KCk7XG4gICAgfVxuICAgIHRoaXMuc2Nyb2xsYWJsZUVsZW1lbnQgPSBnZXRTY3JvbGxhYmxlRWxlbWVudCh0aGlzLndvdC53dFRhYmxlLlRBQkxFKTtcbiAgICB0aGlzLnJlZ2lzdGVyTGlzdGVuZXJzKCk7XG4gIH0sXG4gIGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmRlc3Ryb3koKTtcbiAgICB0aGlzLnRvcE92ZXJsYXkuZGVzdHJveSgpO1xuICAgIGlmICh0aGlzLmJvdHRvbU92ZXJsYXkuY2xvbmUpIHtcbiAgICAgIHRoaXMuYm90dG9tT3ZlcmxheS5kZXN0cm95KCk7XG4gICAgfVxuICAgIHRoaXMubGVmdE92ZXJsYXkuZGVzdHJveSgpO1xuICAgIGlmICh0aGlzLnRvcExlZnRDb3JuZXJPdmVybGF5KSB7XG4gICAgICB0aGlzLnRvcExlZnRDb3JuZXJPdmVybGF5LmRlc3Ryb3koKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuYm90dG9tTGVmdENvcm5lck92ZXJsYXkgJiYgdGhpcy5ib3R0b21MZWZ0Q29ybmVyT3ZlcmxheS5jbG9uZSkge1xuICAgICAgdGhpcy5ib3R0b21MZWZ0Q29ybmVyT3ZlcmxheS5kZXN0cm95KCk7XG4gICAgfVxuICAgIGlmICh0aGlzLmRlYnVnKSB7XG4gICAgICB0aGlzLmRlYnVnLmRlc3Ryb3koKTtcbiAgICB9XG4gICAgdGhpcy5kZXN0cm95ZWQgPSB0cnVlO1xuICB9LFxuICByZWZyZXNoOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgZmFzdERyYXcgPSBhcmd1bWVudHNbMF0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzBdIDogZmFsc2U7XG4gICAgaWYgKHRoaXMudG9wT3ZlcmxheS5hcmVFbGVtZW50U2l6ZXNBZGp1c3RlZCAmJiB0aGlzLmxlZnRPdmVybGF5LmFyZUVsZW1lbnRTaXplc0FkanVzdGVkKSB7XG4gICAgICB2YXIgY29udGFpbmVyID0gdGhpcy53b3Qud3RUYWJsZS53dFJvb3RFbGVtZW50LnBhcmVudE5vZGUgfHwgdGhpcy53b3Qud3RUYWJsZS53dFJvb3RFbGVtZW50O1xuICAgICAgdmFyIHdpZHRoID0gY29udGFpbmVyLmNsaWVudFdpZHRoO1xuICAgICAgdmFyIGhlaWdodCA9IGNvbnRhaW5lci5jbGllbnRIZWlnaHQ7XG4gICAgICBpZiAod2lkdGggIT09IHRoaXMuc3ByZWFkZXJMYXN0U2l6ZS53aWR0aCB8fCBoZWlnaHQgIT09IHRoaXMuc3ByZWFkZXJMYXN0U2l6ZS5oZWlnaHQpIHtcbiAgICAgICAgdGhpcy5zcHJlYWRlckxhc3RTaXplLndpZHRoID0gd2lkdGg7XG4gICAgICAgIHRoaXMuc3ByZWFkZXJMYXN0U2l6ZS5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgIHRoaXMuYWRqdXN0RWxlbWVudHNTaXplKCk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0aGlzLmJvdHRvbU92ZXJsYXkuY2xvbmUpIHtcbiAgICAgIHRoaXMuYm90dG9tT3ZlcmxheS5yZWZyZXNoKGZhc3REcmF3KTtcbiAgICB9XG4gICAgdGhpcy5sZWZ0T3ZlcmxheS5yZWZyZXNoKGZhc3REcmF3KTtcbiAgICB0aGlzLnRvcE92ZXJsYXkucmVmcmVzaChmYXN0RHJhdyk7XG4gICAgaWYgKHRoaXMudG9wTGVmdENvcm5lck92ZXJsYXkpIHtcbiAgICAgIHRoaXMudG9wTGVmdENvcm5lck92ZXJsYXkucmVmcmVzaChmYXN0RHJhdyk7XG4gICAgfVxuICAgIGlmICh0aGlzLmJvdHRvbUxlZnRDb3JuZXJPdmVybGF5ICYmIHRoaXMuYm90dG9tTGVmdENvcm5lck92ZXJsYXkuY2xvbmUpIHtcbiAgICAgIHRoaXMuYm90dG9tTGVmdENvcm5lck92ZXJsYXkucmVmcmVzaChmYXN0RHJhdyk7XG4gICAgfVxuICAgIGlmICh0aGlzLmRlYnVnKSB7XG4gICAgICB0aGlzLmRlYnVnLnJlZnJlc2goZmFzdERyYXcpO1xuICAgIH1cbiAgfSxcbiAgYWRqdXN0RWxlbWVudHNTaXplOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgZm9yY2UgPSBhcmd1bWVudHNbMF0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzBdIDogZmFsc2U7XG4gICAgdmFyIHRvdGFsQ29sdW1ucyA9IHRoaXMud290LmdldFNldHRpbmcoJ3RvdGFsQ29sdW1ucycpO1xuICAgIHZhciB0b3RhbFJvd3MgPSB0aGlzLndvdC5nZXRTZXR0aW5nKCd0b3RhbFJvd3MnKTtcbiAgICB2YXIgaGVhZGVyUm93U2l6ZSA9IHRoaXMud290Lnd0Vmlld3BvcnQuZ2V0Um93SGVhZGVyV2lkdGgoKTtcbiAgICB2YXIgaGVhZGVyQ29sdW1uU2l6ZSA9IHRoaXMud290Lnd0Vmlld3BvcnQuZ2V0Q29sdW1uSGVhZGVySGVpZ2h0KCk7XG4gICAgdmFyIGhpZGVyU3R5bGUgPSB0aGlzLndvdC53dFRhYmxlLmhpZGVyLnN0eWxlO1xuICAgIGhpZGVyU3R5bGUud2lkdGggPSAoaGVhZGVyUm93U2l6ZSArIHRoaXMubGVmdE92ZXJsYXkuc3VtQ2VsbFNpemVzKDAsIHRvdGFsQ29sdW1ucykpICsgJ3B4JztcbiAgICBoaWRlclN0eWxlLmhlaWdodCA9IChoZWFkZXJDb2x1bW5TaXplICsgdGhpcy50b3BPdmVybGF5LnN1bUNlbGxTaXplcygwLCB0b3RhbFJvd3MpICsgMSkgKyAncHgnO1xuICAgIHRoaXMudG9wT3ZlcmxheS5hZGp1c3RFbGVtZW50c1NpemUoZm9yY2UpO1xuICAgIHRoaXMubGVmdE92ZXJsYXkuYWRqdXN0RWxlbWVudHNTaXplKGZvcmNlKTtcbiAgICBpZiAodGhpcy5ib3R0b21PdmVybGF5LmNsb25lKSB7XG4gICAgICB0aGlzLmJvdHRvbU92ZXJsYXkuYWRqdXN0RWxlbWVudHNTaXplKGZvcmNlKTtcbiAgICB9XG4gIH0sXG4gIGFwcGx5VG9ET006IGZ1bmN0aW9uKCkge1xuICAgIGlmICghdGhpcy50b3BPdmVybGF5LmFyZUVsZW1lbnRTaXplc0FkanVzdGVkIHx8ICF0aGlzLmxlZnRPdmVybGF5LmFyZUVsZW1lbnRTaXplc0FkanVzdGVkKSB7XG4gICAgICB0aGlzLmFkanVzdEVsZW1lbnRzU2l6ZSgpO1xuICAgIH1cbiAgICB0aGlzLnRvcE92ZXJsYXkuYXBwbHlUb0RPTSgpO1xuICAgIGlmICh0aGlzLmJvdHRvbU92ZXJsYXkuY2xvbmUpIHtcbiAgICAgIHRoaXMuYm90dG9tT3ZlcmxheS5hcHBseVRvRE9NKCk7XG4gICAgfVxuICAgIHRoaXMubGVmdE92ZXJsYXkuYXBwbHlUb0RPTSgpO1xuICB9LFxuICBnZXRQYXJlbnRPdmVybGF5OiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgaWYgKCFlbGVtZW50KSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIG92ZXJsYXlzID0gW3RoaXMudG9wT3ZlcmxheSwgdGhpcy5sZWZ0T3ZlcmxheSwgdGhpcy5ib3R0b21PdmVybGF5LCB0aGlzLnRvcExlZnRDb3JuZXJPdmVybGF5LCB0aGlzLmJvdHRvbUxlZnRDb3JuZXJPdmVybGF5XTtcbiAgICB2YXIgcmVzdWx0ID0gbnVsbDtcbiAgICBhcnJheUVhY2gob3ZlcmxheXMsIChmdW5jdGlvbihlbGVtLCBpKSB7XG4gICAgICBpZiAoIWVsZW0pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGVsZW0uY2xvbmUgJiYgZWxlbS5jbG9uZS53dFRhYmxlLlRBQkxFLmNvbnRhaW5zKGVsZW1lbnQpKSB7XG4gICAgICAgIHJlc3VsdCA9IGVsZW0uY2xvbmU7XG4gICAgICB9XG4gICAgfSkpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbn0sIHt9KTtcbjtcbndpbmRvdy5XYWxrb250YWJsZU92ZXJsYXlzID0gV2Fsa29udGFibGVPdmVybGF5cztcblxuLy8jIFxufSx7XCJldmVudE1hbmFnZXJcIjo0MixcImhlbHBlcnMvYXJyYXlcIjo0MyxcImhlbHBlcnMvYnJvd3NlclwiOjQ0LFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwiaGVscGVycy91bmljb2RlXCI6NTZ9XSwxODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgV2Fsa29udGFibGVTY3JvbGw6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFdhbGtvbnRhYmxlU2Nyb2xsO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXztcbnZhciAkX18wID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9lbGVtZW50XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X199KSxcbiAgICBpbm5lckhlaWdodCA9ICRfXzAuaW5uZXJIZWlnaHQsXG4gICAgaW5uZXJXaWR0aCA9ICRfXzAuaW5uZXJXaWR0aCxcbiAgICBnZXRTY3JvbGxMZWZ0ID0gJF9fMC5nZXRTY3JvbGxMZWZ0LFxuICAgIGdldFNjcm9sbFRvcCA9ICRfXzAuZ2V0U2Nyb2xsVG9wLFxuICAgIG9mZnNldCA9ICRfXzAub2Zmc2V0O1xudmFyICRfXzEgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL251bWJlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X251bWJlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfX30pLFxuICAgIHJhbmdlRWFjaCA9ICRfXzEucmFuZ2VFYWNoLFxuICAgIHJhbmdlRWFjaFJldmVyc2UgPSAkX18xLnJhbmdlRWFjaFJldmVyc2U7XG52YXIgV2Fsa29udGFibGVTY3JvbGwgPSBmdW5jdGlvbiBXYWxrb250YWJsZVNjcm9sbCh3b3RJbnN0YW5jZSkge1xuICB0aGlzLndvdCA9IHdvdEluc3RhbmNlO1xuICB0aGlzLmluc3RhbmNlID0gd290SW5zdGFuY2U7XG59O1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoV2Fsa29udGFibGVTY3JvbGwsIHtcbiAgc2Nyb2xsVmlld3BvcnQ6IGZ1bmN0aW9uKGNvb3Jkcykge1xuICAgIGlmICghdGhpcy53b3QuZHJhd24pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyICRfXzMgPSB0aGlzLl9nZXRWYXJpYWJsZXMoKSxcbiAgICAgICAgdG9wT3ZlcmxheSA9ICRfXzMudG9wT3ZlcmxheSxcbiAgICAgICAgbGVmdE92ZXJsYXkgPSAkX18zLmxlZnRPdmVybGF5LFxuICAgICAgICB0b3RhbFJvd3MgPSAkX18zLnRvdGFsUm93cyxcbiAgICAgICAgdG90YWxDb2x1bW5zID0gJF9fMy50b3RhbENvbHVtbnMsXG4gICAgICAgIGZpeGVkUm93c1RvcCA9ICRfXzMuZml4ZWRSb3dzVG9wLFxuICAgICAgICBmaXhlZFJvd3NCb3R0b20gPSAkX18zLmZpeGVkUm93c0JvdHRvbSxcbiAgICAgICAgZml4ZWRDb2x1bW5zTGVmdCA9ICRfXzMuZml4ZWRDb2x1bW5zTGVmdDtcbiAgICBpZiAoY29vcmRzLnJvdyA8IDAgfHwgY29vcmRzLnJvdyA+IE1hdGgubWF4KHRvdGFsUm93cyAtIDEsIDApKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoKFwicm93IFwiICsgY29vcmRzLnJvdyArIFwiIGRvZXMgbm90IGV4aXN0XCIpKTtcbiAgICB9XG4gICAgaWYgKGNvb3Jkcy5jb2wgPCAwIHx8IGNvb3Jkcy5jb2wgPiBNYXRoLm1heCh0b3RhbENvbHVtbnMgLSAxLCAwKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKChcImNvbHVtbiBcIiArIGNvb3Jkcy5jb2wgKyBcIiBkb2VzIG5vdCBleGlzdFwiKSk7XG4gICAgfVxuICAgIGlmIChjb29yZHMucm93ID49IGZpeGVkUm93c1RvcCAmJiBjb29yZHMucm93IDwgdGhpcy5nZXRGaXJzdFZpc2libGVSb3coKSkge1xuICAgICAgdG9wT3ZlcmxheS5zY3JvbGxUbyhjb29yZHMucm93KTtcbiAgICB9IGVsc2UgaWYgKGNvb3Jkcy5yb3cgPiB0aGlzLmdldExhc3RWaXNpYmxlUm93KCkgJiYgY29vcmRzLnJvdyA8IHRvdGFsUm93cyAtIGZpeGVkUm93c0JvdHRvbSkge1xuICAgICAgdG9wT3ZlcmxheS5zY3JvbGxUbyhjb29yZHMucm93LCB0cnVlKTtcbiAgICB9XG4gICAgaWYgKGNvb3Jkcy5jb2wgPj0gZml4ZWRDb2x1bW5zTGVmdCAmJiBjb29yZHMuY29sIDwgdGhpcy5nZXRGaXJzdFZpc2libGVDb2x1bW4oKSkge1xuICAgICAgbGVmdE92ZXJsYXkuc2Nyb2xsVG8oY29vcmRzLmNvbCk7XG4gICAgfSBlbHNlIGlmIChjb29yZHMuY29sID4gdGhpcy5nZXRMYXN0VmlzaWJsZUNvbHVtbigpKSB7XG4gICAgICBsZWZ0T3ZlcmxheS5zY3JvbGxUbyhjb29yZHMuY29sLCB0cnVlKTtcbiAgICB9XG4gIH0sXG4gIGdldEZpcnN0VmlzaWJsZVJvdzogZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzMgPSB0aGlzLl9nZXRWYXJpYWJsZXMoKSxcbiAgICAgICAgdG9wT3ZlcmxheSA9ICRfXzMudG9wT3ZlcmxheSxcbiAgICAgICAgd3RUYWJsZSA9ICRfXzMud3RUYWJsZSxcbiAgICAgICAgd3RWaWV3cG9ydCA9ICRfXzMud3RWaWV3cG9ydCxcbiAgICAgICAgdG90YWxSb3dzID0gJF9fMy50b3RhbFJvd3MsXG4gICAgICAgIGZpeGVkUm93c1RvcCA9ICRfXzMuZml4ZWRSb3dzVG9wO1xuICAgIHZhciBmaXJzdFZpc2libGVSb3cgPSB3dFRhYmxlLmdldEZpcnN0VmlzaWJsZVJvdygpO1xuICAgIGlmICh0b3BPdmVybGF5Lm1haW5UYWJsZVNjcm9sbGFibGVFbGVtZW50ID09PSB3aW5kb3cpIHtcbiAgICAgIHZhciByb290RWxlbWVudE9mZnNldCA9IG9mZnNldCh3dFRhYmxlLnd0Um9vdEVsZW1lbnQpO1xuICAgICAgdmFyIHRvdGFsVGFibGVIZWlnaHQgPSBpbm5lckhlaWdodCh3dFRhYmxlLmhpZGVyKTtcbiAgICAgIHZhciB3aW5kb3dIZWlnaHQgPSBpbm5lckhlaWdodCh3aW5kb3cpO1xuICAgICAgdmFyIHdpbmRvd1Njcm9sbFRvcCA9IGdldFNjcm9sbFRvcCh3aW5kb3cpO1xuICAgICAgaWYgKHJvb3RFbGVtZW50T2Zmc2V0LnRvcCArIHRvdGFsVGFibGVIZWlnaHQgLSB3aW5kb3dIZWlnaHQgPD0gd2luZG93U2Nyb2xsVG9wKSB7XG4gICAgICAgIHZhciByb3dzSGVpZ2h0ID0gd3RWaWV3cG9ydC5nZXRDb2x1bW5IZWFkZXJIZWlnaHQoKTtcbiAgICAgICAgcm93c0hlaWdodCArPSB0b3BPdmVybGF5LnN1bUNlbGxTaXplcygwLCBmaXhlZFJvd3NUb3ApO1xuICAgICAgICByYW5nZUVhY2hSZXZlcnNlKHRvdGFsUm93cywgMSwgKGZ1bmN0aW9uKHJvdykge1xuICAgICAgICAgIHJvd3NIZWlnaHQgKz0gdG9wT3ZlcmxheS5zdW1DZWxsU2l6ZXMocm93IC0gMSwgcm93KTtcbiAgICAgICAgICBpZiAocm9vdEVsZW1lbnRPZmZzZXQudG9wICsgdG90YWxUYWJsZUhlaWdodCAtIHJvd3NIZWlnaHQgPD0gd2luZG93U2Nyb2xsVG9wKSB7XG4gICAgICAgICAgICBmaXJzdFZpc2libGVSb3cgPSByb3c7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmaXJzdFZpc2libGVSb3c7XG4gIH0sXG4gIGdldExhc3RWaXNpYmxlUm93OiBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fMyA9IHRoaXMuX2dldFZhcmlhYmxlcygpLFxuICAgICAgICB0b3BPdmVybGF5ID0gJF9fMy50b3BPdmVybGF5LFxuICAgICAgICB3dFRhYmxlID0gJF9fMy53dFRhYmxlLFxuICAgICAgICB3dFZpZXdwb3J0ID0gJF9fMy53dFZpZXdwb3J0LFxuICAgICAgICB0b3RhbFJvd3MgPSAkX18zLnRvdGFsUm93cztcbiAgICB2YXIgbGFzdFZpc2libGVSb3cgPSB3dFRhYmxlLmdldExhc3RWaXNpYmxlUm93KCk7XG4gICAgaWYgKHRvcE92ZXJsYXkubWFpblRhYmxlU2Nyb2xsYWJsZUVsZW1lbnQgPT09IHdpbmRvdykge1xuICAgICAgdmFyIHJvb3RFbGVtZW50T2Zmc2V0ID0gb2Zmc2V0KHd0VGFibGUud3RSb290RWxlbWVudCk7XG4gICAgICB2YXIgd2luZG93SGVpZ2h0ID0gaW5uZXJIZWlnaHQod2luZG93KTtcbiAgICAgIHZhciB3aW5kb3dTY3JvbGxUb3AgPSBnZXRTY3JvbGxUb3Aod2luZG93KTtcbiAgICAgIGlmIChyb290RWxlbWVudE9mZnNldC50b3AgPiB3aW5kb3dTY3JvbGxUb3ApIHtcbiAgICAgICAgdmFyIHJvd3NIZWlnaHQgPSB3dFZpZXdwb3J0LmdldENvbHVtbkhlYWRlckhlaWdodCgpO1xuICAgICAgICByYW5nZUVhY2goMSwgdG90YWxSb3dzLCAoZnVuY3Rpb24ocm93KSB7XG4gICAgICAgICAgcm93c0hlaWdodCArPSB0b3BPdmVybGF5LnN1bUNlbGxTaXplcyhyb3cgLSAxLCByb3cpO1xuICAgICAgICAgIGlmIChyb290RWxlbWVudE9mZnNldC50b3AgKyByb3dzSGVpZ2h0IC0gd2luZG93U2Nyb2xsVG9wID49IHdpbmRvd0hlaWdodCkge1xuICAgICAgICAgICAgbGFzdFZpc2libGVSb3cgPSByb3cgLSAyO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbGFzdFZpc2libGVSb3c7XG4gIH0sXG4gIGdldEZpcnN0VmlzaWJsZUNvbHVtbjogZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzMgPSB0aGlzLl9nZXRWYXJpYWJsZXMoKSxcbiAgICAgICAgbGVmdE92ZXJsYXkgPSAkX18zLmxlZnRPdmVybGF5LFxuICAgICAgICB3dFRhYmxlID0gJF9fMy53dFRhYmxlLFxuICAgICAgICB3dFZpZXdwb3J0ID0gJF9fMy53dFZpZXdwb3J0LFxuICAgICAgICB0b3RhbENvbHVtbnMgPSAkX18zLnRvdGFsQ29sdW1ucyxcbiAgICAgICAgZml4ZWRDb2x1bW5zTGVmdCA9ICRfXzMuZml4ZWRDb2x1bW5zTGVmdDtcbiAgICB2YXIgZmlyc3RWaXNpYmxlQ29sdW1uID0gd3RUYWJsZS5nZXRGaXJzdFZpc2libGVDb2x1bW4oKTtcbiAgICBpZiAobGVmdE92ZXJsYXkubWFpblRhYmxlU2Nyb2xsYWJsZUVsZW1lbnQgPT09IHdpbmRvdykge1xuICAgICAgdmFyIHJvb3RFbGVtZW50T2Zmc2V0ID0gb2Zmc2V0KHd0VGFibGUud3RSb290RWxlbWVudCk7XG4gICAgICB2YXIgdG90YWxUYWJsZVdpZHRoID0gaW5uZXJXaWR0aCh3dFRhYmxlLmhpZGVyKTtcbiAgICAgIHZhciB3aW5kb3dXaWR0aCA9IGlubmVyV2lkdGgod2luZG93KTtcbiAgICAgIHZhciB3aW5kb3dTY3JvbGxMZWZ0ID0gZ2V0U2Nyb2xsTGVmdCh3aW5kb3cpO1xuICAgICAgaWYgKHJvb3RFbGVtZW50T2Zmc2V0LmxlZnQgKyB0b3RhbFRhYmxlV2lkdGggLSB3aW5kb3dXaWR0aCA8PSB3aW5kb3dTY3JvbGxMZWZ0KSB7XG4gICAgICAgIHZhciBjb2x1bW5zV2lkdGggPSB3dFZpZXdwb3J0LmdldFJvd0hlYWRlcldpZHRoKCk7XG4gICAgICAgIHJhbmdlRWFjaFJldmVyc2UodG90YWxDb2x1bW5zLCAxLCAoZnVuY3Rpb24oY29sdW1uKSB7XG4gICAgICAgICAgY29sdW1uc1dpZHRoICs9IGxlZnRPdmVybGF5LnN1bUNlbGxTaXplcyhjb2x1bW4gLSAxLCBjb2x1bW4pO1xuICAgICAgICAgIGlmIChyb290RWxlbWVudE9mZnNldC5sZWZ0ICsgdG90YWxUYWJsZVdpZHRoIC0gY29sdW1uc1dpZHRoIDw9IHdpbmRvd1Njcm9sbExlZnQpIHtcbiAgICAgICAgICAgIGZpcnN0VmlzaWJsZUNvbHVtbiA9IGNvbHVtbjtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZpcnN0VmlzaWJsZUNvbHVtbjtcbiAgfSxcbiAgZ2V0TGFzdFZpc2libGVDb2x1bW46IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX18zID0gdGhpcy5fZ2V0VmFyaWFibGVzKCksXG4gICAgICAgIGxlZnRPdmVybGF5ID0gJF9fMy5sZWZ0T3ZlcmxheSxcbiAgICAgICAgd3RUYWJsZSA9ICRfXzMud3RUYWJsZSxcbiAgICAgICAgd3RWaWV3cG9ydCA9ICRfXzMud3RWaWV3cG9ydCxcbiAgICAgICAgdG90YWxDb2x1bW5zID0gJF9fMy50b3RhbENvbHVtbnM7XG4gICAgdmFyIGxhc3RWaXNpYmxlQ29sdW1uID0gd3RUYWJsZS5nZXRMYXN0VmlzaWJsZUNvbHVtbigpO1xuICAgIGlmIChsZWZ0T3ZlcmxheS5tYWluVGFibGVTY3JvbGxhYmxlRWxlbWVudCA9PT0gd2luZG93KSB7XG4gICAgICB2YXIgcm9vdEVsZW1lbnRPZmZzZXQgPSBvZmZzZXQod3RUYWJsZS53dFJvb3RFbGVtZW50KTtcbiAgICAgIHZhciB3aW5kb3dXaWR0aCA9IGlubmVyV2lkdGgod2luZG93KTtcbiAgICAgIHZhciB3aW5kb3dTY3JvbGxMZWZ0ID0gZ2V0U2Nyb2xsTGVmdCh3aW5kb3cpO1xuICAgICAgaWYgKHJvb3RFbGVtZW50T2Zmc2V0LmxlZnQgPiB3aW5kb3dTY3JvbGxMZWZ0KSB7XG4gICAgICAgIHZhciBjb2x1bW5zV2lkdGggPSB3dFZpZXdwb3J0LmdldFJvd0hlYWRlcldpZHRoKCk7XG4gICAgICAgIHJhbmdlRWFjaCgxLCB0b3RhbENvbHVtbnMsIChmdW5jdGlvbihjb2x1bW4pIHtcbiAgICAgICAgICBjb2x1bW5zV2lkdGggKz0gbGVmdE92ZXJsYXkuc3VtQ2VsbFNpemVzKGNvbHVtbiAtIDEsIGNvbHVtbik7XG4gICAgICAgICAgaWYgKHJvb3RFbGVtZW50T2Zmc2V0LmxlZnQgKyBjb2x1bW5zV2lkdGggLSB3aW5kb3dTY3JvbGxMZWZ0ID49IHdpbmRvd1dpZHRoKSB7XG4gICAgICAgICAgICBsYXN0VmlzaWJsZUNvbHVtbiA9IGNvbHVtbiAtIDI7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBsYXN0VmlzaWJsZUNvbHVtbjtcbiAgfSxcbiAgX2dldFZhcmlhYmxlczogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHdvdCA9IHRoaXMud290O1xuICAgIHZhciB0b3BPdmVybGF5ID0gd290Lnd0T3ZlcmxheXMudG9wT3ZlcmxheTtcbiAgICB2YXIgbGVmdE92ZXJsYXkgPSB3b3Qud3RPdmVybGF5cy5sZWZ0T3ZlcmxheTtcbiAgICB2YXIgd3RUYWJsZSA9IHdvdC53dFRhYmxlO1xuICAgIHZhciB3dFZpZXdwb3J0ID0gd290Lnd0Vmlld3BvcnQ7XG4gICAgdmFyIHRvdGFsUm93cyA9IHdvdC5nZXRTZXR0aW5nKCd0b3RhbFJvd3MnKTtcbiAgICB2YXIgdG90YWxDb2x1bW5zID0gd290LmdldFNldHRpbmcoJ3RvdGFsQ29sdW1ucycpO1xuICAgIHZhciBmaXhlZFJvd3NUb3AgPSB3b3QuZ2V0U2V0dGluZygnZml4ZWRSb3dzVG9wJyk7XG4gICAgdmFyIGZpeGVkUm93c0JvdHRvbSA9IHdvdC5nZXRTZXR0aW5nKCdmaXhlZFJvd3NCb3R0b20nKTtcbiAgICB2YXIgZml4ZWRDb2x1bW5zTGVmdCA9IHdvdC5nZXRTZXR0aW5nKCdmaXhlZENvbHVtbnNMZWZ0Jyk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRvcE92ZXJsYXk6IHRvcE92ZXJsYXksXG4gICAgICBsZWZ0T3ZlcmxheTogbGVmdE92ZXJsYXksXG4gICAgICB3dFRhYmxlOiB3dFRhYmxlLFxuICAgICAgd3RWaWV3cG9ydDogd3RWaWV3cG9ydCxcbiAgICAgIHRvdGFsUm93czogdG90YWxSb3dzLFxuICAgICAgdG90YWxDb2x1bW5zOiB0b3RhbENvbHVtbnMsXG4gICAgICBmaXhlZFJvd3NUb3A6IGZpeGVkUm93c1RvcCxcbiAgICAgIGZpeGVkUm93c0JvdHRvbTogZml4ZWRSb3dzQm90dG9tLFxuICAgICAgZml4ZWRDb2x1bW5zTGVmdDogZml4ZWRDb2x1bW5zTGVmdFxuICAgIH07XG4gIH1cbn0sIHt9KTtcbjtcbndpbmRvdy5XYWxrb250YWJsZVNjcm9sbCA9IFdhbGtvbnRhYmxlU2Nyb2xsO1xuXG4vLyMgXG59LHtcImhlbHBlcnMvZG9tL2VsZW1lbnRcIjo0NyxcImhlbHBlcnMvbnVtYmVyXCI6NTJ9XSwxOTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgV2Fsa29udGFibGVTZWxlY3Rpb246IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFdhbGtvbnRhYmxlU2VsZWN0aW9uO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fYm9yZGVyX18sXG4gICAgJF9fY2VsbF80N19jb29yZHNfXyxcbiAgICAkX19jZWxsXzQ3X3JhbmdlX187XG52YXIgYWRkQ2xhc3MgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLmFkZENsYXNzO1xudmFyIFdhbGtvbnRhYmxlQm9yZGVyID0gKCRfX2JvcmRlcl9fID0gX2RlcmVxXyhcImJvcmRlclwiKSwgJF9fYm9yZGVyX18gJiYgJF9fYm9yZGVyX18uX19lc01vZHVsZSAmJiAkX19ib3JkZXJfXyB8fCB7ZGVmYXVsdDogJF9fYm9yZGVyX199KS5XYWxrb250YWJsZUJvcmRlcjtcbnZhciBXYWxrb250YWJsZUNlbGxDb29yZHMgPSAoJF9fY2VsbF80N19jb29yZHNfXyA9IF9kZXJlcV8oXCJjZWxsL2Nvb3Jkc1wiKSwgJF9fY2VsbF80N19jb29yZHNfXyAmJiAkX19jZWxsXzQ3X2Nvb3Jkc19fLl9fZXNNb2R1bGUgJiYgJF9fY2VsbF80N19jb29yZHNfXyB8fCB7ZGVmYXVsdDogJF9fY2VsbF80N19jb29yZHNfX30pLldhbGtvbnRhYmxlQ2VsbENvb3JkcztcbnZhciBXYWxrb250YWJsZUNlbGxSYW5nZSA9ICgkX19jZWxsXzQ3X3JhbmdlX18gPSBfZGVyZXFfKFwiY2VsbC9yYW5nZVwiKSwgJF9fY2VsbF80N19yYW5nZV9fICYmICRfX2NlbGxfNDdfcmFuZ2VfXy5fX2VzTW9kdWxlICYmICRfX2NlbGxfNDdfcmFuZ2VfXyB8fCB7ZGVmYXVsdDogJF9fY2VsbF80N19yYW5nZV9ffSkuV2Fsa29udGFibGVDZWxsUmFuZ2U7XG52YXIgV2Fsa29udGFibGVTZWxlY3Rpb24gPSBmdW5jdGlvbiBXYWxrb250YWJsZVNlbGVjdGlvbihzZXR0aW5ncywgY2VsbFJhbmdlKSB7XG4gIHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgdGhpcy5jZWxsUmFuZ2UgPSBjZWxsUmFuZ2UgfHwgbnVsbDtcbiAgdGhpcy5pbnN0YW5jZUJvcmRlcnMgPSB7fTtcbn07XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShXYWxrb250YWJsZVNlbGVjdGlvbiwge1xuICBnZXRCb3JkZXI6IGZ1bmN0aW9uKHdvdEluc3RhbmNlKSB7XG4gICAgaWYgKHRoaXMuaW5zdGFuY2VCb3JkZXJzW3dvdEluc3RhbmNlLmd1aWRdKSB7XG4gICAgICByZXR1cm4gdGhpcy5pbnN0YW5jZUJvcmRlcnNbd290SW5zdGFuY2UuZ3VpZF07XG4gICAgfVxuICAgIHRoaXMuaW5zdGFuY2VCb3JkZXJzW3dvdEluc3RhbmNlLmd1aWRdID0gbmV3IFdhbGtvbnRhYmxlQm9yZGVyKHdvdEluc3RhbmNlLCB0aGlzLnNldHRpbmdzKTtcbiAgfSxcbiAgaXNFbXB0eTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuY2VsbFJhbmdlID09PSBudWxsO1xuICB9LFxuICBhZGQ6IGZ1bmN0aW9uKGNvb3Jkcykge1xuICAgIGlmICh0aGlzLmlzRW1wdHkoKSkge1xuICAgICAgdGhpcy5jZWxsUmFuZ2UgPSBuZXcgV2Fsa29udGFibGVDZWxsUmFuZ2UoY29vcmRzLCBjb29yZHMsIGNvb3Jkcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY2VsbFJhbmdlLmV4cGFuZChjb29yZHMpO1xuICAgIH1cbiAgfSxcbiAgcmVwbGFjZTogZnVuY3Rpb24ob2xkQ29vcmRzLCBuZXdDb29yZHMpIHtcbiAgICBpZiAoIXRoaXMuaXNFbXB0eSgpKSB7XG4gICAgICBpZiAodGhpcy5jZWxsUmFuZ2UuZnJvbS5pc0VxdWFsKG9sZENvb3JkcykpIHtcbiAgICAgICAgdGhpcy5jZWxsUmFuZ2UuZnJvbSA9IG5ld0Nvb3JkcztcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5jZWxsUmFuZ2UudG8uaXNFcXVhbChvbGRDb29yZHMpKSB7XG4gICAgICAgIHRoaXMuY2VsbFJhbmdlLnRvID0gbmV3Q29vcmRzO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuICBjbGVhcjogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5jZWxsUmFuZ2UgPSBudWxsO1xuICB9LFxuICBnZXRDb3JuZXJzOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgdG9wTGVmdCA9IHRoaXMuY2VsbFJhbmdlLmdldFRvcExlZnRDb3JuZXIoKTtcbiAgICB2YXIgYm90dG9tUmlnaHQgPSB0aGlzLmNlbGxSYW5nZS5nZXRCb3R0b21SaWdodENvcm5lcigpO1xuICAgIHJldHVybiBbdG9wTGVmdC5yb3csIHRvcExlZnQuY29sLCBib3R0b21SaWdodC5yb3csIGJvdHRvbVJpZ2h0LmNvbF07XG4gIH0sXG4gIGFkZENsYXNzQXRDb29yZHM6IGZ1bmN0aW9uKHdvdEluc3RhbmNlLCBzb3VyY2VSb3csIHNvdXJjZUNvbHVtbiwgY2xhc3NOYW1lKSB7XG4gICAgdmFyIFREID0gd290SW5zdGFuY2Uud3RUYWJsZS5nZXRDZWxsKG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoc291cmNlUm93LCBzb3VyY2VDb2x1bW4pKTtcbiAgICBpZiAodHlwZW9mIFREID09PSAnb2JqZWN0Jykge1xuICAgICAgYWRkQ2xhc3MoVEQsIGNsYXNzTmFtZSk7XG4gICAgfVxuICB9LFxuICBkcmF3OiBmdW5jdGlvbih3b3RJbnN0YW5jZSkge1xuICAgIGlmICh0aGlzLmlzRW1wdHkoKSkge1xuICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuYm9yZGVyKSB7XG4gICAgICAgIHZhciBib3JkZXIgPSB0aGlzLmdldEJvcmRlcih3b3RJbnN0YW5jZSk7XG4gICAgICAgIGlmIChib3JkZXIpIHtcbiAgICAgICAgICBib3JkZXIuZGlzYXBwZWFyKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHJlbmRlcmVkUm93cyA9IHdvdEluc3RhbmNlLnd0VGFibGUuZ2V0UmVuZGVyZWRSb3dzQ291bnQoKTtcbiAgICB2YXIgcmVuZGVyZWRDb2x1bW5zID0gd290SW5zdGFuY2Uud3RUYWJsZS5nZXRSZW5kZXJlZENvbHVtbnNDb3VudCgpO1xuICAgIHZhciBjb3JuZXJzID0gdGhpcy5nZXRDb3JuZXJzKCk7XG4gICAgdmFyIHNvdXJjZVJvdyxcbiAgICAgICAgc291cmNlQ29sLFxuICAgICAgICBUSDtcbiAgICBmb3IgKHZhciBjb2x1bW4gPSAwOyBjb2x1bW4gPCByZW5kZXJlZENvbHVtbnM7IGNvbHVtbisrKSB7XG4gICAgICBzb3VyY2VDb2wgPSB3b3RJbnN0YW5jZS53dFRhYmxlLmNvbHVtbkZpbHRlci5yZW5kZXJlZFRvU291cmNlKGNvbHVtbik7XG4gICAgICBpZiAoc291cmNlQ29sID49IGNvcm5lcnNbMV0gJiYgc291cmNlQ29sIDw9IGNvcm5lcnNbM10pIHtcbiAgICAgICAgVEggPSB3b3RJbnN0YW5jZS53dFRhYmxlLmdldENvbHVtbkhlYWRlcihzb3VyY2VDb2wpO1xuICAgICAgICBpZiAoVEgpIHtcbiAgICAgICAgICB2YXIgbmV3Q2xhc3NlcyA9IFtdO1xuICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmhpZ2hsaWdodEhlYWRlckNsYXNzTmFtZSkge1xuICAgICAgICAgICAgbmV3Q2xhc3Nlcy5wdXNoKHRoaXMuc2V0dGluZ3MuaGlnaGxpZ2h0SGVhZGVyQ2xhc3NOYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuaGlnaGxpZ2h0Q29sdW1uQ2xhc3NOYW1lKSB7XG4gICAgICAgICAgICBuZXdDbGFzc2VzLnB1c2godGhpcy5zZXR0aW5ncy5oaWdobGlnaHRDb2x1bW5DbGFzc05hbWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhZGRDbGFzcyhUSCwgbmV3Q2xhc3Nlcyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgcmVuZGVyZWRSb3dzOyByb3crKykge1xuICAgICAgc291cmNlUm93ID0gd290SW5zdGFuY2Uud3RUYWJsZS5yb3dGaWx0ZXIucmVuZGVyZWRUb1NvdXJjZShyb3cpO1xuICAgICAgaWYgKHNvdXJjZVJvdyA+PSBjb3JuZXJzWzBdICYmIHNvdXJjZVJvdyA8PSBjb3JuZXJzWzJdKSB7XG4gICAgICAgIFRIID0gd290SW5zdGFuY2Uud3RUYWJsZS5nZXRSb3dIZWFkZXIoc291cmNlUm93KTtcbiAgICAgICAgaWYgKFRIKSB7XG4gICAgICAgICAgdmFyIG5ld0NsYXNzZXMkX181ID0gW107XG4gICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuaGlnaGxpZ2h0SGVhZGVyQ2xhc3NOYW1lKSB7XG4gICAgICAgICAgICBuZXdDbGFzc2VzJF9fNS5wdXNoKHRoaXMuc2V0dGluZ3MuaGlnaGxpZ2h0SGVhZGVyQ2xhc3NOYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuaGlnaGxpZ2h0Um93Q2xhc3NOYW1lKSB7XG4gICAgICAgICAgICBuZXdDbGFzc2VzJF9fNS5wdXNoKHRoaXMuc2V0dGluZ3MuaGlnaGxpZ2h0Um93Q2xhc3NOYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYWRkQ2xhc3MoVEgsIG5ld0NsYXNzZXMkX181KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZm9yICh2YXIgY29sdW1uJF9fNiA9IDA7IGNvbHVtbiRfXzYgPCByZW5kZXJlZENvbHVtbnM7IGNvbHVtbiRfXzYrKykge1xuICAgICAgICBzb3VyY2VDb2wgPSB3b3RJbnN0YW5jZS53dFRhYmxlLmNvbHVtbkZpbHRlci5yZW5kZXJlZFRvU291cmNlKGNvbHVtbiRfXzYpO1xuICAgICAgICBpZiAoc291cmNlUm93ID49IGNvcm5lcnNbMF0gJiYgc291cmNlUm93IDw9IGNvcm5lcnNbMl0gJiYgc291cmNlQ29sID49IGNvcm5lcnNbMV0gJiYgc291cmNlQ29sIDw9IGNvcm5lcnNbM10pIHtcbiAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5jbGFzc05hbWUpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2xhc3NBdENvb3Jkcyh3b3RJbnN0YW5jZSwgc291cmNlUm93LCBzb3VyY2VDb2wsIHRoaXMuc2V0dGluZ3MuY2xhc3NOYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoc291cmNlUm93ID49IGNvcm5lcnNbMF0gJiYgc291cmNlUm93IDw9IGNvcm5lcnNbMl0pIHtcbiAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5oaWdobGlnaHRSb3dDbGFzc05hbWUpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2xhc3NBdENvb3Jkcyh3b3RJbnN0YW5jZSwgc291cmNlUm93LCBzb3VyY2VDb2wsIHRoaXMuc2V0dGluZ3MuaGlnaGxpZ2h0Um93Q2xhc3NOYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoc291cmNlQ29sID49IGNvcm5lcnNbMV0gJiYgc291cmNlQ29sIDw9IGNvcm5lcnNbM10pIHtcbiAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5oaWdobGlnaHRDb2x1bW5DbGFzc05hbWUpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2xhc3NBdENvb3Jkcyh3b3RJbnN0YW5jZSwgc291cmNlUm93LCBzb3VyY2VDb2wsIHRoaXMuc2V0dGluZ3MuaGlnaGxpZ2h0Q29sdW1uQ2xhc3NOYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgd290SW5zdGFuY2UuZ2V0U2V0dGluZygnb25CZWZvcmVEcmF3Qm9yZGVycycsIGNvcm5lcnMsIHRoaXMuc2V0dGluZ3MuY2xhc3NOYW1lKTtcbiAgICBpZiAodGhpcy5zZXR0aW5ncy5ib3JkZXIpIHtcbiAgICAgIHZhciBib3JkZXIkX183ID0gdGhpcy5nZXRCb3JkZXIod290SW5zdGFuY2UpO1xuICAgICAgaWYgKGJvcmRlciRfXzcpIHtcbiAgICAgICAgYm9yZGVyJF9fNy5hcHBlYXIoY29ybmVycyk7XG4gICAgICB9XG4gICAgfVxuICB9XG59LCB7fSk7XG47XG53aW5kb3cuV2Fsa29udGFibGVTZWxlY3Rpb24gPSBXYWxrb250YWJsZVNlbGVjdGlvbjtcblxuLy8jIFxufSx7XCJib3JkZXJcIjozLFwiY2VsbC9jb29yZHNcIjo2LFwiY2VsbC9yYW5nZVwiOjcsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDd9XSwyMDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgV2Fsa29udGFibGVTZXR0aW5nczoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gV2Fsa29udGFibGVTZXR0aW5ncztcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fO1xudmFyIGZhc3RJbm5lclRleHQgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLmZhc3RJbm5lclRleHQ7XG52YXIgV2Fsa29udGFibGVTZXR0aW5ncyA9IGZ1bmN0aW9uIFdhbGtvbnRhYmxlU2V0dGluZ3Mod290SW5zdGFuY2UsIHNldHRpbmdzKSB7XG4gIHZhciAkX18xID0gdGhpcztcbiAgdGhpcy53b3QgPSB3b3RJbnN0YW5jZTtcbiAgdGhpcy5pbnN0YW5jZSA9IHdvdEluc3RhbmNlO1xuICB0aGlzLmRlZmF1bHRzID0ge1xuICAgIHRhYmxlOiB2b2lkIDAsXG4gICAgZGVidWc6IGZhbHNlLFxuICAgIGV4dGVybmFsUm93Q2FsY3VsYXRvcjogZmFsc2UsXG4gICAgc3RyZXRjaEg6ICdub25lJyxcbiAgICBjdXJyZW50Um93Q2xhc3NOYW1lOiBudWxsLFxuICAgIGN1cnJlbnRDb2x1bW5DbGFzc05hbWU6IG51bGwsXG4gICAgcHJldmVudE92ZXJmbG93OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9LFxuICAgIGRhdGE6IHZvaWQgMCxcbiAgICBmaXhlZENvbHVtbnNMZWZ0OiAwLFxuICAgIGZpeGVkUm93c1RvcDogMCxcbiAgICBmaXhlZFJvd3NCb3R0b206IDAsXG4gICAgbWluU3BhcmVSb3dzOiAwLFxuICAgIHJvd0hlYWRlcnM6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH0sXG4gICAgY29sdW1uSGVhZGVyczogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfSxcbiAgICB0b3RhbFJvd3M6IHZvaWQgMCxcbiAgICB0b3RhbENvbHVtbnM6IHZvaWQgMCxcbiAgICBjZWxsUmVuZGVyZXI6IChmdW5jdGlvbihyb3csIGNvbHVtbiwgVEQpIHtcbiAgICAgIHZhciBjZWxsRGF0YSA9ICRfXzEuZ2V0U2V0dGluZygnZGF0YScsIHJvdywgY29sdW1uKTtcbiAgICAgIGZhc3RJbm5lclRleHQoVEQsIGNlbGxEYXRhID09PSB2b2lkIDAgfHwgY2VsbERhdGEgPT09IG51bGwgPyAnJyA6IGNlbGxEYXRhKTtcbiAgICB9KSxcbiAgICBjb2x1bW5XaWR0aDogZnVuY3Rpb24oY29sKSB7XG4gICAgICByZXR1cm47XG4gICAgfSxcbiAgICByb3dIZWlnaHQ6IGZ1bmN0aW9uKHJvdykge1xuICAgICAgcmV0dXJuO1xuICAgIH0sXG4gICAgZGVmYXVsdFJvd0hlaWdodDogMjMsXG4gICAgZGVmYXVsdENvbHVtbldpZHRoOiA1MCxcbiAgICBzZWxlY3Rpb25zOiBudWxsLFxuICAgIGhpZGVCb3JkZXJPbk1vdXNlRG93bk92ZXI6IGZhbHNlLFxuICAgIHZpZXdwb3J0Um93Q2FsY3VsYXRvck92ZXJyaWRlOiBudWxsLFxuICAgIHZpZXdwb3J0Q29sdW1uQ2FsY3VsYXRvck92ZXJyaWRlOiBudWxsLFxuICAgIG9uQ2VsbE1vdXNlRG93bjogbnVsbCxcbiAgICBvbkNlbGxNb3VzZU92ZXI6IG51bGwsXG4gICAgb25DZWxsTW91c2VPdXQ6IG51bGwsXG4gICAgb25DZWxsTW91c2VVcDogbnVsbCxcbiAgICBvbkNlbGxEYmxDbGljazogbnVsbCxcbiAgICBvbkNlbGxDb3JuZXJNb3VzZURvd246IG51bGwsXG4gICAgb25DZWxsQ29ybmVyRGJsQ2xpY2s6IG51bGwsXG4gICAgYmVmb3JlRHJhdzogbnVsbCxcbiAgICBvbkRyYXc6IG51bGwsXG4gICAgb25CZWZvcmVEcmF3Qm9yZGVyczogbnVsbCxcbiAgICBvblNjcm9sbFZlcnRpY2FsbHk6IG51bGwsXG4gICAgb25TY3JvbGxIb3Jpem9udGFsbHk6IG51bGwsXG4gICAgb25CZWZvcmVUb3VjaFNjcm9sbDogbnVsbCxcbiAgICBvbkFmdGVyTW9tZW50dW1TY3JvbGw6IG51bGwsXG4gICAgb25CZWZvcmVTdHJldGNoaW5nQ29sdW1uV2lkdGg6IChmdW5jdGlvbih3aWR0aCkge1xuICAgICAgcmV0dXJuIHdpZHRoO1xuICAgIH0pLFxuICAgIG9uTW9kaWZ5Um93SGVhZGVyV2lkdGg6IG51bGwsXG4gICAgc2Nyb2xsYmFyV2lkdGg6IDEwLFxuICAgIHNjcm9sbGJhckhlaWdodDogMTAsXG4gICAgcmVuZGVyQWxsUm93czogZmFsc2UsXG4gICAgZ3JvdXBzOiBmYWxzZSxcbiAgICByb3dIZWFkZXJXaWR0aDogbnVsbCxcbiAgICBjb2x1bW5IZWFkZXJIZWlnaHQ6IG51bGwsXG4gICAgaGVhZGVyQ2xhc3NOYW1lOiBudWxsXG4gIH07XG4gIHRoaXMuc2V0dGluZ3MgPSB7fTtcbiAgZm9yICh2YXIgaSBpbiB0aGlzLmRlZmF1bHRzKSB7XG4gICAgaWYgKHRoaXMuZGVmYXVsdHMuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgIGlmIChzZXR0aW5nc1tpXSAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3NbaV0gPSBzZXR0aW5nc1tpXTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5kZWZhdWx0c1tpXSA9PT0gdm9pZCAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQSByZXF1aXJlZCBzZXR0aW5nIFwiJyArIGkgKyAnXCIgd2FzIG5vdCBwcm92aWRlZCcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zZXR0aW5nc1tpXSA9IHRoaXMuZGVmYXVsdHNbaV07XG4gICAgICB9XG4gICAgfVxuICB9XG59O1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoV2Fsa29udGFibGVTZXR0aW5ncywge1xuICB1cGRhdGU6IGZ1bmN0aW9uKHNldHRpbmdzLCB2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PT0gdm9pZCAwKSB7XG4gICAgICBmb3IgKHZhciBpIGluIHNldHRpbmdzKSB7XG4gICAgICAgIGlmIChzZXR0aW5ncy5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICAgIHRoaXMuc2V0dGluZ3NbaV0gPSBzZXR0aW5nc1tpXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNldHRpbmdzW3NldHRpbmdzXSA9IHZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy53b3Q7XG4gIH0sXG4gIGdldFNldHRpbmc6IGZ1bmN0aW9uKGtleSwgcGFyYW0xLCBwYXJhbTIsIHBhcmFtMywgcGFyYW00KSB7XG4gICAgaWYgKHR5cGVvZiB0aGlzLnNldHRpbmdzW2tleV0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzW2tleV0ocGFyYW0xLCBwYXJhbTIsIHBhcmFtMywgcGFyYW00KTtcbiAgICB9IGVsc2UgaWYgKHBhcmFtMSAhPT0gdm9pZCAwICYmIEFycmF5LmlzQXJyYXkodGhpcy5zZXR0aW5nc1trZXldKSkge1xuICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3Nba2V5XVtwYXJhbTFdO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5zZXR0aW5nc1trZXldO1xuICAgIH1cbiAgfSxcbiAgaGFzOiBmdW5jdGlvbihrZXkpIHtcbiAgICByZXR1cm4gISF0aGlzLnNldHRpbmdzW2tleV07XG4gIH1cbn0sIHt9KTtcbjtcbndpbmRvdy5XYWxrb250YWJsZVNldHRpbmdzID0gV2Fsa29udGFibGVTZXR0aW5ncztcblxuLy8jIFxufSx7XCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDd9XSwyMTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgV2Fsa29udGFibGVUYWJsZToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gV2Fsa29udGFibGVUYWJsZTtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZnVuY3Rpb25fXyxcbiAgICAkX19jZWxsXzQ3X2Nvb3Jkc19fLFxuICAgICRfX2NlbGxfNDdfcmFuZ2VfXyxcbiAgICAkX19maWx0ZXJfNDdfY29sdW1uX18sXG4gICAgJF9fZmlsdGVyXzQ3X3Jvd19fLFxuICAgICRfX3RhYmxlUmVuZGVyZXJfXztcbnZhciAkX18wID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9lbGVtZW50XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X199KSxcbiAgICBnZXRTdHlsZSA9ICRfXzAuZ2V0U3R5bGUsXG4gICAgZ2V0VHJpbW1pbmdDb250YWluZXIgPSAkX18wLmdldFRyaW1taW5nQ29udGFpbmVyLFxuICAgIGhhc0NsYXNzID0gJF9fMC5oYXNDbGFzcyxcbiAgICBpbmRleCA9ICRfXzAuaW5kZXgsXG4gICAgb2Zmc2V0ID0gJF9fMC5vZmZzZXQsXG4gICAgcmVtb3ZlQ2xhc3MgPSAkX18wLnJlbW92ZUNsYXNzLFxuICAgIHJlbW92ZVRleHROb2RlcyA9ICRfXzAucmVtb3ZlVGV4dE5vZGVzLFxuICAgIG92ZXJsYXlDb250YWluc0VsZW1lbnQgPSAkX18wLm92ZXJsYXlDb250YWluc0VsZW1lbnQsXG4gICAgY2xvc2VzdCA9ICRfXzAuY2xvc2VzdDtcbnZhciBpc0Z1bmN0aW9uID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZnVuY3Rpb25fXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2Z1bmN0aW9uXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Z1bmN0aW9uX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19mdW5jdGlvbl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19mdW5jdGlvbl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Z1bmN0aW9uX199KS5pc0Z1bmN0aW9uO1xudmFyIFdhbGtvbnRhYmxlQ2VsbENvb3JkcyA9ICgkX19jZWxsXzQ3X2Nvb3Jkc19fID0gX2RlcmVxXyhcImNlbGwvY29vcmRzXCIpLCAkX19jZWxsXzQ3X2Nvb3Jkc19fICYmICRfX2NlbGxfNDdfY29vcmRzX18uX19lc01vZHVsZSAmJiAkX19jZWxsXzQ3X2Nvb3Jkc19fIHx8IHtkZWZhdWx0OiAkX19jZWxsXzQ3X2Nvb3Jkc19ffSkuV2Fsa29udGFibGVDZWxsQ29vcmRzO1xudmFyIFdhbGtvbnRhYmxlQ2VsbFJhbmdlID0gKCRfX2NlbGxfNDdfcmFuZ2VfXyA9IF9kZXJlcV8oXCJjZWxsL3JhbmdlXCIpLCAkX19jZWxsXzQ3X3JhbmdlX18gJiYgJF9fY2VsbF80N19yYW5nZV9fLl9fZXNNb2R1bGUgJiYgJF9fY2VsbF80N19yYW5nZV9fIHx8IHtkZWZhdWx0OiAkX19jZWxsXzQ3X3JhbmdlX199KS5XYWxrb250YWJsZUNlbGxSYW5nZTtcbnZhciBXYWxrb250YWJsZUNvbHVtbkZpbHRlciA9ICgkX19maWx0ZXJfNDdfY29sdW1uX18gPSBfZGVyZXFfKFwiZmlsdGVyL2NvbHVtblwiKSwgJF9fZmlsdGVyXzQ3X2NvbHVtbl9fICYmICRfX2ZpbHRlcl80N19jb2x1bW5fXy5fX2VzTW9kdWxlICYmICRfX2ZpbHRlcl80N19jb2x1bW5fXyB8fCB7ZGVmYXVsdDogJF9fZmlsdGVyXzQ3X2NvbHVtbl9ffSkuV2Fsa29udGFibGVDb2x1bW5GaWx0ZXI7XG52YXIgV2Fsa29udGFibGVSb3dGaWx0ZXIgPSAoJF9fZmlsdGVyXzQ3X3Jvd19fID0gX2RlcmVxXyhcImZpbHRlci9yb3dcIiksICRfX2ZpbHRlcl80N19yb3dfXyAmJiAkX19maWx0ZXJfNDdfcm93X18uX19lc01vZHVsZSAmJiAkX19maWx0ZXJfNDdfcm93X18gfHwge2RlZmF1bHQ6ICRfX2ZpbHRlcl80N19yb3dfX30pLldhbGtvbnRhYmxlUm93RmlsdGVyO1xudmFyIFdhbGtvbnRhYmxlVGFibGVSZW5kZXJlciA9ICgkX190YWJsZVJlbmRlcmVyX18gPSBfZGVyZXFfKFwidGFibGVSZW5kZXJlclwiKSwgJF9fdGFibGVSZW5kZXJlcl9fICYmICRfX3RhYmxlUmVuZGVyZXJfXy5fX2VzTW9kdWxlICYmICRfX3RhYmxlUmVuZGVyZXJfXyB8fCB7ZGVmYXVsdDogJF9fdGFibGVSZW5kZXJlcl9ffSkuV2Fsa29udGFibGVUYWJsZVJlbmRlcmVyO1xudmFyIFdhbGtvbnRhYmxlVGFibGUgPSBmdW5jdGlvbiBXYWxrb250YWJsZVRhYmxlKHdvdEluc3RhbmNlLCB0YWJsZSkge1xuICB2YXIgJF9fNyA9IHRoaXM7XG4gIHRoaXMud290ID0gd290SW5zdGFuY2U7XG4gIHRoaXMuaW5zdGFuY2UgPSB0aGlzLndvdDtcbiAgdGhpcy5UQUJMRSA9IHRhYmxlO1xuICB0aGlzLlRCT0RZID0gbnVsbDtcbiAgdGhpcy5USEVBRCA9IG51bGw7XG4gIHRoaXMuQ09MR1JPVVAgPSBudWxsO1xuICB0aGlzLnRhYmxlT2Zmc2V0ID0gMDtcbiAgdGhpcy5ob2xkZXJPZmZzZXQgPSAwO1xuICByZW1vdmVUZXh0Tm9kZXModGhpcy5UQUJMRSk7XG4gIHRoaXMuc3ByZWFkZXIgPSB0aGlzLmNyZWF0ZVNwcmVhZGVyKHRoaXMuVEFCTEUpO1xuICB0aGlzLmhpZGVyID0gdGhpcy5jcmVhdGVIaWRlcih0aGlzLnNwcmVhZGVyKTtcbiAgdGhpcy5ob2xkZXIgPSB0aGlzLmNyZWF0ZUhvbGRlcih0aGlzLmhpZGVyKTtcbiAgdGhpcy53dFJvb3RFbGVtZW50ID0gdGhpcy5ob2xkZXIucGFyZW50Tm9kZTtcbiAgdGhpcy5hbGlnbk92ZXJsYXlzV2l0aFRyaW1taW5nQ29udGFpbmVyKCk7XG4gIHRoaXMuZml4VGFibGVEb21UcmVlKCk7XG4gIHRoaXMuY29sZ3JvdXBDaGlsZHJlbkxlbmd0aCA9IHRoaXMuQ09MR1JPVVAuY2hpbGROb2Rlcy5sZW5ndGg7XG4gIHRoaXMudGhlYWRDaGlsZHJlbkxlbmd0aCA9IHRoaXMuVEhFQUQuZmlyc3RDaGlsZCA/IHRoaXMuVEhFQUQuZmlyc3RDaGlsZC5jaGlsZE5vZGVzLmxlbmd0aCA6IDA7XG4gIHRoaXMudGJvZHlDaGlsZHJlbkxlbmd0aCA9IHRoaXMuVEJPRFkuY2hpbGROb2Rlcy5sZW5ndGg7XG4gIHRoaXMucm93RmlsdGVyID0gbnVsbDtcbiAgdGhpcy5jb2x1bW5GaWx0ZXIgPSBudWxsO1xuICB0aGlzLmNvcnJlY3RIZWFkZXJXaWR0aCA9IGZhbHNlO1xuICB2YXIgb3JpZ1Jvd0hlYWRlcldpZHRoID0gdGhpcy53b3Qud3RTZXR0aW5ncy5zZXR0aW5ncy5yb3dIZWFkZXJXaWR0aDtcbiAgdGhpcy53b3Qud3RTZXR0aW5ncy5zZXR0aW5ncy5yb3dIZWFkZXJXaWR0aCA9IChmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJF9fNy5fbW9kaWZ5Um93SGVhZGVyV2lkdGgob3JpZ1Jvd0hlYWRlcldpZHRoKTtcbiAgfSk7XG59O1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoV2Fsa29udGFibGVUYWJsZSwge1xuICBmaXhUYWJsZURvbVRyZWU6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuVEJPRFkgPSB0aGlzLlRBQkxFLnF1ZXJ5U2VsZWN0b3IoJ3Rib2R5Jyk7XG4gICAgaWYgKCF0aGlzLlRCT0RZKSB7XG4gICAgICB0aGlzLlRCT0RZID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGJvZHknKTtcbiAgICAgIHRoaXMuVEFCTEUuYXBwZW5kQ2hpbGQodGhpcy5UQk9EWSk7XG4gICAgfVxuICAgIHRoaXMuVEhFQUQgPSB0aGlzLlRBQkxFLnF1ZXJ5U2VsZWN0b3IoJ3RoZWFkJyk7XG4gICAgaWYgKCF0aGlzLlRIRUFEKSB7XG4gICAgICB0aGlzLlRIRUFEID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGhlYWQnKTtcbiAgICAgIHRoaXMuVEFCTEUuaW5zZXJ0QmVmb3JlKHRoaXMuVEhFQUQsIHRoaXMuVEJPRFkpO1xuICAgIH1cbiAgICB0aGlzLkNPTEdST1VQID0gdGhpcy5UQUJMRS5xdWVyeVNlbGVjdG9yKCdjb2xncm91cCcpO1xuICAgIGlmICghdGhpcy5DT0xHUk9VUCkge1xuICAgICAgdGhpcy5DT0xHUk9VUCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NvbGdyb3VwJyk7XG4gICAgICB0aGlzLlRBQkxFLmluc2VydEJlZm9yZSh0aGlzLkNPTEdST1VQLCB0aGlzLlRIRUFEKTtcbiAgICB9XG4gICAgaWYgKHRoaXMud290LmdldFNldHRpbmcoJ2NvbHVtbkhlYWRlcnMnKS5sZW5ndGggJiYgIXRoaXMuVEhFQUQuY2hpbGROb2Rlcy5sZW5ndGgpIHtcbiAgICAgIHRoaXMuVEhFQUQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnVFInKSk7XG4gICAgfVxuICB9LFxuICBjcmVhdGVTcHJlYWRlcjogZnVuY3Rpb24odGFibGUpIHtcbiAgICB2YXIgcGFyZW50ID0gdGFibGUucGFyZW50Tm9kZTtcbiAgICB2YXIgc3ByZWFkZXI7XG4gICAgaWYgKCFwYXJlbnQgfHwgcGFyZW50Lm5vZGVUeXBlICE9PSAxIHx8ICFoYXNDbGFzcyhwYXJlbnQsICd3dEhvbGRlcicpKSB7XG4gICAgICBzcHJlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgc3ByZWFkZXIuY2xhc3NOYW1lID0gJ3d0U3ByZWFkZXInO1xuICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKHNwcmVhZGVyLCB0YWJsZSk7XG4gICAgICB9XG4gICAgICBzcHJlYWRlci5hcHBlbmRDaGlsZCh0YWJsZSk7XG4gICAgfVxuICAgIHNwcmVhZGVyLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcbiAgICByZXR1cm4gc3ByZWFkZXI7XG4gIH0sXG4gIGNyZWF0ZUhpZGVyOiBmdW5jdGlvbihzcHJlYWRlcikge1xuICAgIHZhciBwYXJlbnQgPSBzcHJlYWRlci5wYXJlbnROb2RlO1xuICAgIHZhciBoaWRlcjtcbiAgICBpZiAoIXBhcmVudCB8fCBwYXJlbnQubm9kZVR5cGUgIT09IDEgfHwgIWhhc0NsYXNzKHBhcmVudCwgJ3d0SG9sZGVyJykpIHtcbiAgICAgIGhpZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBoaWRlci5jbGFzc05hbWUgPSAnd3RIaWRlcic7XG4gICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUoaGlkZXIsIHNwcmVhZGVyKTtcbiAgICAgIH1cbiAgICAgIGhpZGVyLmFwcGVuZENoaWxkKHNwcmVhZGVyKTtcbiAgICB9XG4gICAgcmV0dXJuIGhpZGVyO1xuICB9LFxuICBjcmVhdGVIb2xkZXI6IGZ1bmN0aW9uKGhpZGVyKSB7XG4gICAgdmFyIHBhcmVudCA9IGhpZGVyLnBhcmVudE5vZGU7XG4gICAgdmFyIGhvbGRlcjtcbiAgICBpZiAoIXBhcmVudCB8fCBwYXJlbnQubm9kZVR5cGUgIT09IDEgfHwgIWhhc0NsYXNzKHBhcmVudCwgJ3d0SG9sZGVyJykpIHtcbiAgICAgIGhvbGRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgaG9sZGVyLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcbiAgICAgIGhvbGRlci5jbGFzc05hbWUgPSAnd3RIb2xkZXInO1xuICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKGhvbGRlciwgaGlkZXIpO1xuICAgICAgfVxuICAgICAgaWYgKCF0aGlzLmlzV29ya2luZ09uQ2xvbmUoKSkge1xuICAgICAgICBob2xkZXIucGFyZW50Tm9kZS5jbGFzc05hbWUgKz0gJ2h0X21hc3RlciBoYW5kc29udGFibGUnO1xuICAgICAgfVxuICAgICAgaG9sZGVyLmFwcGVuZENoaWxkKGhpZGVyKTtcbiAgICB9XG4gICAgcmV0dXJuIGhvbGRlcjtcbiAgfSxcbiAgYWxpZ25PdmVybGF5c1dpdGhUcmltbWluZ0NvbnRhaW5lcjogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHRyaW1taW5nRWxlbWVudCA9IGdldFRyaW1taW5nQ29udGFpbmVyKHRoaXMud3RSb290RWxlbWVudCk7XG4gICAgaWYgKCF0aGlzLmlzV29ya2luZ09uQ2xvbmUoKSkge1xuICAgICAgdGhpcy5ob2xkZXIucGFyZW50Tm9kZS5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XG4gICAgICBpZiAodHJpbW1pbmdFbGVtZW50ID09PSB3aW5kb3cpIHtcbiAgICAgICAgdmFyIHByZXZlbnRPdmVyZmxvdyA9IHRoaXMud290LmdldFNldHRpbmcoJ3ByZXZlbnRPdmVyZmxvdycpO1xuICAgICAgICBpZiAoIXByZXZlbnRPdmVyZmxvdykge1xuICAgICAgICAgIHRoaXMuaG9sZGVyLnN0eWxlLm92ZXJmbG93ID0gJ3Zpc2libGUnO1xuICAgICAgICAgIHRoaXMud3RSb290RWxlbWVudC5zdHlsZS5vdmVyZmxvdyA9ICd2aXNpYmxlJztcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5ob2xkZXIuc3R5bGUud2lkdGggPSBnZXRTdHlsZSh0cmltbWluZ0VsZW1lbnQsICd3aWR0aCcpO1xuICAgICAgICB0aGlzLmhvbGRlci5zdHlsZS5oZWlnaHQgPSBnZXRTdHlsZSh0cmltbWluZ0VsZW1lbnQsICdoZWlnaHQnKTtcbiAgICAgICAgdGhpcy5ob2xkZXIuc3R5bGUub3ZlcmZsb3cgPSAnJztcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGlzV29ya2luZ09uQ2xvbmU6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAhIXRoaXMud290LmNsb25lU291cmNlO1xuICB9LFxuICBkcmF3OiBmdW5jdGlvbihmYXN0RHJhdykge1xuICAgIHZhciAkX185ID0gdGhpcy53b3QsXG4gICAgICAgIHd0T3ZlcmxheXMgPSAkX185Lnd0T3ZlcmxheXMsXG4gICAgICAgIHd0Vmlld3BvcnQgPSAkX185Lnd0Vmlld3BvcnQ7XG4gICAgdmFyIHRvdGFsUm93cyA9IHRoaXMuaW5zdGFuY2UuZ2V0U2V0dGluZygndG90YWxSb3dzJyk7XG4gICAgdmFyIHJvd0hlYWRlcnMgPSB0aGlzLndvdC5nZXRTZXR0aW5nKCdyb3dIZWFkZXJzJykubGVuZ3RoO1xuICAgIHZhciBjb2x1bW5IZWFkZXJzID0gdGhpcy53b3QuZ2V0U2V0dGluZygnY29sdW1uSGVhZGVycycpLmxlbmd0aDtcbiAgICB2YXIgc3luY1Njcm9sbCA9IGZhbHNlO1xuICAgIGlmICghdGhpcy5pc1dvcmtpbmdPbkNsb25lKCkpIHtcbiAgICAgIHRoaXMuaG9sZGVyT2Zmc2V0ID0gb2Zmc2V0KHRoaXMuaG9sZGVyKTtcbiAgICAgIGZhc3REcmF3ID0gd3RWaWV3cG9ydC5jcmVhdGVSZW5kZXJDYWxjdWxhdG9ycyhmYXN0RHJhdyk7XG4gICAgICBpZiAocm93SGVhZGVycyAmJiAhdGhpcy53b3QuZ2V0U2V0dGluZygnZml4ZWRDb2x1bW5zTGVmdCcpKSB7XG4gICAgICAgIHZhciBsZWZ0U2Nyb2xsUG9zID0gd3RPdmVybGF5cy5sZWZ0T3ZlcmxheS5nZXRTY3JvbGxQb3NpdGlvbigpO1xuICAgICAgICB2YXIgcHJldmlvdXNTdGF0ZSA9IHRoaXMuY29ycmVjdEhlYWRlcldpZHRoO1xuICAgICAgICB0aGlzLmNvcnJlY3RIZWFkZXJXaWR0aCA9IGxlZnRTY3JvbGxQb3MgPiAwO1xuICAgICAgICBpZiAocHJldmlvdXNTdGF0ZSAhPT0gdGhpcy5jb3JyZWN0SGVhZGVyV2lkdGgpIHtcbiAgICAgICAgICBmYXN0RHJhdyA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmICghdGhpcy5pc1dvcmtpbmdPbkNsb25lKCkpIHtcbiAgICAgIHN5bmNTY3JvbGwgPSB3dE92ZXJsYXlzLnByZXBhcmVPdmVybGF5cygpO1xuICAgIH1cbiAgICBpZiAoZmFzdERyYXcpIHtcbiAgICAgIGlmICghdGhpcy5pc1dvcmtpbmdPbkNsb25lKCkpIHtcbiAgICAgICAgd3RWaWV3cG9ydC5jcmVhdGVWaXNpYmxlQ2FsY3VsYXRvcnMoKTtcbiAgICAgIH1cbiAgICAgIGlmICh3dE92ZXJsYXlzKSB7XG4gICAgICAgIHd0T3ZlcmxheXMucmVmcmVzaCh0cnVlKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHRoaXMuaXNXb3JraW5nT25DbG9uZSgpKSB7XG4gICAgICAgIHRoaXMudGFibGVPZmZzZXQgPSB0aGlzLndvdC5jbG9uZVNvdXJjZS53dFRhYmxlLnRhYmxlT2Zmc2V0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy50YWJsZU9mZnNldCA9IG9mZnNldCh0aGlzLlRBQkxFKTtcbiAgICAgIH1cbiAgICAgIHZhciBzdGFydFJvdztcbiAgICAgIGlmIChXYWxrb250YWJsZU92ZXJsYXkuaXNPdmVybGF5VHlwZU9mKHRoaXMud290LmNsb25lT3ZlcmxheSwgV2Fsa29udGFibGVPdmVybGF5LkNMT05FX0RFQlVHKSB8fCBXYWxrb250YWJsZU92ZXJsYXkuaXNPdmVybGF5VHlwZU9mKHRoaXMud290LmNsb25lT3ZlcmxheSwgV2Fsa29udGFibGVPdmVybGF5LkNMT05FX1RPUCkgfHwgV2Fsa29udGFibGVPdmVybGF5LmlzT3ZlcmxheVR5cGVPZih0aGlzLndvdC5jbG9uZU92ZXJsYXksIFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9UT1BfTEVGVF9DT1JORVIpKSB7XG4gICAgICAgIHN0YXJ0Um93ID0gMDtcbiAgICAgIH0gZWxzZSBpZiAoV2Fsa29udGFibGVPdmVybGF5LmlzT3ZlcmxheVR5cGVPZih0aGlzLmluc3RhbmNlLmNsb25lT3ZlcmxheSwgV2Fsa29udGFibGVPdmVybGF5LkNMT05FX0JPVFRPTSkgfHwgV2Fsa29udGFibGVPdmVybGF5LmlzT3ZlcmxheVR5cGVPZih0aGlzLmluc3RhbmNlLmNsb25lT3ZlcmxheSwgV2Fsa29udGFibGVPdmVybGF5LkNMT05FX0JPVFRPTV9MRUZUX0NPUk5FUikpIHtcbiAgICAgICAgc3RhcnRSb3cgPSBNYXRoLm1heCh0b3RhbFJvd3MgLSB0aGlzLndvdC5nZXRTZXR0aW5nKCdmaXhlZFJvd3NCb3R0b20nKSwgMCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdGFydFJvdyA9IHd0Vmlld3BvcnQucm93c1JlbmRlckNhbGN1bGF0b3Iuc3RhcnRSb3c7XG4gICAgICB9XG4gICAgICB2YXIgc3RhcnRDb2x1bW47XG4gICAgICBpZiAoV2Fsa29udGFibGVPdmVybGF5LmlzT3ZlcmxheVR5cGVPZih0aGlzLndvdC5jbG9uZU92ZXJsYXksIFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9ERUJVRykgfHwgV2Fsa29udGFibGVPdmVybGF5LmlzT3ZlcmxheVR5cGVPZih0aGlzLndvdC5jbG9uZU92ZXJsYXksIFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9MRUZUKSB8fCBXYWxrb250YWJsZU92ZXJsYXkuaXNPdmVybGF5VHlwZU9mKHRoaXMud290LmNsb25lT3ZlcmxheSwgV2Fsa29udGFibGVPdmVybGF5LkNMT05FX1RPUF9MRUZUX0NPUk5FUikgfHwgV2Fsa29udGFibGVPdmVybGF5LmlzT3ZlcmxheVR5cGVPZih0aGlzLndvdC5jbG9uZU92ZXJsYXksIFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9CT1RUT01fTEVGVF9DT1JORVIpKSB7XG4gICAgICAgIHN0YXJ0Q29sdW1uID0gMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN0YXJ0Q29sdW1uID0gd3RWaWV3cG9ydC5jb2x1bW5zUmVuZGVyQ2FsY3VsYXRvci5zdGFydENvbHVtbjtcbiAgICAgIH1cbiAgICAgIHRoaXMucm93RmlsdGVyID0gbmV3IFdhbGtvbnRhYmxlUm93RmlsdGVyKHN0YXJ0Um93LCB0b3RhbFJvd3MsIGNvbHVtbkhlYWRlcnMpO1xuICAgICAgdGhpcy5jb2x1bW5GaWx0ZXIgPSBuZXcgV2Fsa29udGFibGVDb2x1bW5GaWx0ZXIoc3RhcnRDb2x1bW4sIHRoaXMud290LmdldFNldHRpbmcoJ3RvdGFsQ29sdW1ucycpLCByb3dIZWFkZXJzKTtcbiAgICAgIHRoaXMuYWxpZ25PdmVybGF5c1dpdGhUcmltbWluZ0NvbnRhaW5lcigpO1xuICAgICAgdGhpcy5fZG9EcmF3KCk7XG4gICAgfVxuICAgIHRoaXMucmVmcmVzaFNlbGVjdGlvbnMoZmFzdERyYXcpO1xuICAgIGlmICghdGhpcy5pc1dvcmtpbmdPbkNsb25lKCkpIHtcbiAgICAgIHd0T3ZlcmxheXMudG9wT3ZlcmxheS5yZXNldEZpeGVkUG9zaXRpb24oKTtcbiAgICAgIGlmICh3dE92ZXJsYXlzLmJvdHRvbU92ZXJsYXkuY2xvbmUpIHtcbiAgICAgICAgd3RPdmVybGF5cy5ib3R0b21PdmVybGF5LnJlc2V0Rml4ZWRQb3NpdGlvbigpO1xuICAgICAgfVxuICAgICAgd3RPdmVybGF5cy5sZWZ0T3ZlcmxheS5yZXNldEZpeGVkUG9zaXRpb24oKTtcbiAgICAgIGlmICh3dE92ZXJsYXlzLnRvcExlZnRDb3JuZXJPdmVybGF5KSB7XG4gICAgICAgIHd0T3ZlcmxheXMudG9wTGVmdENvcm5lck92ZXJsYXkucmVzZXRGaXhlZFBvc2l0aW9uKCk7XG4gICAgICB9XG4gICAgICBpZiAod3RPdmVybGF5cy5ib3R0b21MZWZ0Q29ybmVyT3ZlcmxheSAmJiB3dE92ZXJsYXlzLmJvdHRvbUxlZnRDb3JuZXJPdmVybGF5LmNsb25lKSB7XG4gICAgICAgIHd0T3ZlcmxheXMuYm90dG9tTGVmdENvcm5lck92ZXJsYXkucmVzZXRGaXhlZFBvc2l0aW9uKCk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChzeW5jU2Nyb2xsKSB7XG4gICAgICB3dE92ZXJsYXlzLnN5bmNTY3JvbGxXaXRoTWFzdGVyKCk7XG4gICAgfVxuICAgIHRoaXMud290LmRyYXduID0gdHJ1ZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfSxcbiAgX2RvRHJhdzogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHd0UmVuZGVyZXIgPSBuZXcgV2Fsa29udGFibGVUYWJsZVJlbmRlcmVyKHRoaXMpO1xuICAgIHd0UmVuZGVyZXIucmVuZGVyKCk7XG4gIH0sXG4gIHJlbW92ZUNsYXNzRnJvbUNlbGxzOiBmdW5jdGlvbihjbGFzc05hbWUpIHtcbiAgICB2YXIgbm9kZXMgPSB0aGlzLlRBQkxFLnF1ZXJ5U2VsZWN0b3JBbGwoJy4nICsgY2xhc3NOYW1lKTtcbiAgICBmb3IgKHZhciBpID0gMCxcbiAgICAgICAgbGVuID0gbm9kZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIHJlbW92ZUNsYXNzKG5vZGVzW2ldLCBjbGFzc05hbWUpO1xuICAgIH1cbiAgfSxcbiAgcmVmcmVzaFNlbGVjdGlvbnM6IGZ1bmN0aW9uKGZhc3REcmF3KSB7XG4gICAgaWYgKCF0aGlzLndvdC5zZWxlY3Rpb25zKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBsZW4gPSB0aGlzLndvdC5zZWxlY3Rpb25zLmxlbmd0aDtcbiAgICBpZiAoZmFzdERyYXcpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgaWYgKHRoaXMud290LnNlbGVjdGlvbnNbaV0uc2V0dGluZ3MuY2xhc3NOYW1lKSB7XG4gICAgICAgICAgdGhpcy5yZW1vdmVDbGFzc0Zyb21DZWxscyh0aGlzLndvdC5zZWxlY3Rpb25zW2ldLnNldHRpbmdzLmNsYXNzTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMud290LnNlbGVjdGlvbnNbaV0uc2V0dGluZ3MuaGlnaGxpZ2h0SGVhZGVyQ2xhc3NOYW1lKSB7XG4gICAgICAgICAgdGhpcy5yZW1vdmVDbGFzc0Zyb21DZWxscyh0aGlzLndvdC5zZWxlY3Rpb25zW2ldLnNldHRpbmdzLmhpZ2hsaWdodEhlYWRlckNsYXNzTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMud290LnNlbGVjdGlvbnNbaV0uc2V0dGluZ3MuaGlnaGxpZ2h0Um93Q2xhc3NOYW1lKSB7XG4gICAgICAgICAgdGhpcy5yZW1vdmVDbGFzc0Zyb21DZWxscyh0aGlzLndvdC5zZWxlY3Rpb25zW2ldLnNldHRpbmdzLmhpZ2hsaWdodFJvd0NsYXNzTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMud290LnNlbGVjdGlvbnNbaV0uc2V0dGluZ3MuaGlnaGxpZ2h0Q29sdW1uQ2xhc3NOYW1lKSB7XG4gICAgICAgICAgdGhpcy5yZW1vdmVDbGFzc0Zyb21DZWxscyh0aGlzLndvdC5zZWxlY3Rpb25zW2ldLnNldHRpbmdzLmhpZ2hsaWdodENvbHVtbkNsYXNzTmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgZm9yICh2YXIgaSRfXzEwID0gMDsgaSRfXzEwIDwgbGVuOyBpJF9fMTArKykge1xuICAgICAgdGhpcy53b3Quc2VsZWN0aW9uc1tpJF9fMTBdLmRyYXcodGhpcy53b3QsIGZhc3REcmF3KTtcbiAgICB9XG4gIH0sXG4gIGdldENlbGw6IGZ1bmN0aW9uKGNvb3Jkcykge1xuICAgIGlmICh0aGlzLmlzUm93QmVmb3JlUmVuZGVyZWRSb3dzKGNvb3Jkcy5yb3cpKSB7XG4gICAgICByZXR1cm4gLTE7XG4gICAgfSBlbHNlIGlmICh0aGlzLmlzUm93QWZ0ZXJSZW5kZXJlZFJvd3MoY29vcmRzLnJvdykpIHtcbiAgICAgIHJldHVybiAtMjtcbiAgICB9XG4gICAgdmFyIFRSID0gdGhpcy5UQk9EWS5jaGlsZE5vZGVzW3RoaXMucm93RmlsdGVyLnNvdXJjZVRvUmVuZGVyZWQoY29vcmRzLnJvdyldO1xuICAgIGlmIChUUikge1xuICAgICAgcmV0dXJuIFRSLmNoaWxkTm9kZXNbdGhpcy5jb2x1bW5GaWx0ZXIuc291cmNlQ29sdW1uVG9WaXNpYmxlUm93SGVhZGVkQ29sdW1uKGNvb3Jkcy5jb2wpXTtcbiAgICB9XG4gIH0sXG4gIGdldENvbHVtbkhlYWRlcjogZnVuY3Rpb24oY29sKSB7XG4gICAgdmFyIGxldmVsID0gYXJndW1lbnRzWzFdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1sxXSA6IDA7XG4gICAgdmFyIFRSID0gdGhpcy5USEVBRC5jaGlsZE5vZGVzW2xldmVsXTtcbiAgICBpZiAoVFIpIHtcbiAgICAgIHJldHVybiBUUi5jaGlsZE5vZGVzW3RoaXMuY29sdW1uRmlsdGVyLnNvdXJjZUNvbHVtblRvVmlzaWJsZVJvd0hlYWRlZENvbHVtbihjb2wpXTtcbiAgICB9XG4gIH0sXG4gIGdldFJvd0hlYWRlcjogZnVuY3Rpb24ocm93KSB7XG4gICAgaWYgKHRoaXMuY29sdW1uRmlsdGVyLnNvdXJjZUNvbHVtblRvVmlzaWJsZVJvd0hlYWRlZENvbHVtbigwKSA9PT0gMCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBUUiA9IHRoaXMuVEJPRFkuY2hpbGROb2Rlc1t0aGlzLnJvd0ZpbHRlci5zb3VyY2VUb1JlbmRlcmVkKHJvdyldO1xuICAgIGlmIChUUikge1xuICAgICAgcmV0dXJuIFRSLmNoaWxkTm9kZXNbMF07XG4gICAgfVxuICB9LFxuICBnZXRDb29yZHM6IGZ1bmN0aW9uKFREKSB7XG4gICAgaWYgKFRELm5vZGVOYW1lICE9PSAnVEQnICYmIFRELm5vZGVOYW1lICE9PSAnVEgnKSB7XG4gICAgICBURCA9IGNsb3Nlc3QoVEQsIFsnVEQnLCAnVEgnXSk7XG4gICAgfVxuICAgIHZhciBUUiA9IFRELnBhcmVudE5vZGU7XG4gICAgdmFyIENPTlRBSU5FUiA9IFRSLnBhcmVudE5vZGU7XG4gICAgdmFyIHJvdyA9IGluZGV4KFRSKTtcbiAgICB2YXIgY29sID0gVEQuY2VsbEluZGV4O1xuICAgIGlmIChvdmVybGF5Q29udGFpbnNFbGVtZW50KFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9UT1BfTEVGVF9DT1JORVIsIFREKSB8fCBvdmVybGF5Q29udGFpbnNFbGVtZW50KFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9UT1AsIFREKSkge1xuICAgICAgaWYgKENPTlRBSU5FUi5ub2RlTmFtZSA9PT0gJ1RIRUFEJykge1xuICAgICAgICByb3cgLT0gQ09OVEFJTkVSLmNoaWxkTm9kZXMubGVuZ3RoO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoQ09OVEFJTkVSID09PSB0aGlzLlRIRUFEKSB7XG4gICAgICAgIHJvdyA9IHRoaXMucm93RmlsdGVyLnZpc2libGVDb2xIZWFkZWRSb3dUb1NvdXJjZVJvdyhyb3cpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcm93ID0gdGhpcy5yb3dGaWx0ZXIucmVuZGVyZWRUb1NvdXJjZShyb3cpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAob3ZlcmxheUNvbnRhaW5zRWxlbWVudChXYWxrb250YWJsZU92ZXJsYXkuQ0xPTkVfVE9QX0xFRlRfQ09STkVSLCBURCkgfHwgb3ZlcmxheUNvbnRhaW5zRWxlbWVudChXYWxrb250YWJsZU92ZXJsYXkuQ0xPTkVfTEVGVCwgVEQpKSB7XG4gICAgICBjb2wgPSB0aGlzLmNvbHVtbkZpbHRlci5vZmZzZXR0ZWRUSChjb2wpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb2wgPSB0aGlzLmNvbHVtbkZpbHRlci52aXNpYmxlUm93SGVhZGVkQ29sdW1uVG9Tb3VyY2VDb2x1bW4oY29sKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMocm93LCBjb2wpO1xuICB9LFxuICBnZXRUckZvclJvdzogZnVuY3Rpb24ocm93KSB7XG4gICAgcmV0dXJuIHRoaXMuVEJPRFkuY2hpbGROb2Rlc1t0aGlzLnJvd0ZpbHRlci5zb3VyY2VUb1JlbmRlcmVkKHJvdyldO1xuICB9LFxuICBnZXRGaXJzdFJlbmRlcmVkUm93OiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy53b3Qud3RWaWV3cG9ydC5yb3dzUmVuZGVyQ2FsY3VsYXRvci5zdGFydFJvdztcbiAgfSxcbiAgZ2V0Rmlyc3RWaXNpYmxlUm93OiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy53b3Qud3RWaWV3cG9ydC5yb3dzVmlzaWJsZUNhbGN1bGF0b3Iuc3RhcnRSb3c7XG4gIH0sXG4gIGdldEZpcnN0UmVuZGVyZWRDb2x1bW46IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLndvdC53dFZpZXdwb3J0LmNvbHVtbnNSZW5kZXJDYWxjdWxhdG9yLnN0YXJ0Q29sdW1uO1xuICB9LFxuICBnZXRGaXJzdFZpc2libGVDb2x1bW46IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLndvdC53dFZpZXdwb3J0LmNvbHVtbnNWaXNpYmxlQ2FsY3VsYXRvci5zdGFydENvbHVtbjtcbiAgfSxcbiAgZ2V0TGFzdFJlbmRlcmVkUm93OiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy53b3Qud3RWaWV3cG9ydC5yb3dzUmVuZGVyQ2FsY3VsYXRvci5lbmRSb3c7XG4gIH0sXG4gIGdldExhc3RWaXNpYmxlUm93OiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy53b3Qud3RWaWV3cG9ydC5yb3dzVmlzaWJsZUNhbGN1bGF0b3IuZW5kUm93O1xuICB9LFxuICBnZXRMYXN0UmVuZGVyZWRDb2x1bW46IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLndvdC53dFZpZXdwb3J0LmNvbHVtbnNSZW5kZXJDYWxjdWxhdG9yLmVuZENvbHVtbjtcbiAgfSxcbiAgZ2V0TGFzdFZpc2libGVDb2x1bW46IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLndvdC53dFZpZXdwb3J0LmNvbHVtbnNWaXNpYmxlQ2FsY3VsYXRvci5lbmRDb2x1bW47XG4gIH0sXG4gIGlzUm93QmVmb3JlUmVuZGVyZWRSb3dzOiBmdW5jdGlvbihyb3cpIHtcbiAgICByZXR1cm4gdGhpcy5yb3dGaWx0ZXIgJiYgKHRoaXMucm93RmlsdGVyLnNvdXJjZVRvUmVuZGVyZWQocm93KSA8IDAgJiYgcm93ID49IDApO1xuICB9LFxuICBpc1Jvd0FmdGVyVmlld3BvcnQ6IGZ1bmN0aW9uKHJvdykge1xuICAgIHJldHVybiB0aGlzLnJvd0ZpbHRlciAmJiAodGhpcy5yb3dGaWx0ZXIuc291cmNlVG9SZW5kZXJlZChyb3cpID4gdGhpcy5nZXRMYXN0VmlzaWJsZVJvdygpKTtcbiAgfSxcbiAgaXNSb3dBZnRlclJlbmRlcmVkUm93czogZnVuY3Rpb24ocm93KSB7XG4gICAgcmV0dXJuIHRoaXMucm93RmlsdGVyICYmICh0aGlzLnJvd0ZpbHRlci5zb3VyY2VUb1JlbmRlcmVkKHJvdykgPiB0aGlzLmdldExhc3RSZW5kZXJlZFJvdygpKTtcbiAgfSxcbiAgaXNDb2x1bW5CZWZvcmVWaWV3cG9ydDogZnVuY3Rpb24oY29sdW1uKSB7XG4gICAgcmV0dXJuIHRoaXMuY29sdW1uRmlsdGVyICYmICh0aGlzLmNvbHVtbkZpbHRlci5zb3VyY2VUb1JlbmRlcmVkKGNvbHVtbikgPCAwICYmIGNvbHVtbiA+PSAwKTtcbiAgfSxcbiAgaXNDb2x1bW5BZnRlclZpZXdwb3J0OiBmdW5jdGlvbihjb2x1bW4pIHtcbiAgICByZXR1cm4gdGhpcy5jb2x1bW5GaWx0ZXIgJiYgKHRoaXMuY29sdW1uRmlsdGVyLnNvdXJjZVRvUmVuZGVyZWQoY29sdW1uKSA+IHRoaXMuZ2V0TGFzdFZpc2libGVDb2x1bW4oKSk7XG4gIH0sXG4gIGlzTGFzdFJvd0Z1bGx5VmlzaWJsZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0TGFzdFZpc2libGVSb3coKSA9PT0gdGhpcy5nZXRMYXN0UmVuZGVyZWRSb3coKTtcbiAgfSxcbiAgaXNMYXN0Q29sdW1uRnVsbHlWaXNpYmxlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRMYXN0VmlzaWJsZUNvbHVtbigpID09PSB0aGlzLmdldExhc3RSZW5kZXJlZENvbHVtbigpO1xuICB9LFxuICBnZXRSZW5kZXJlZENvbHVtbnNDb3VudDogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNvbHVtbnNDb3VudCA9IHRoaXMud290Lnd0Vmlld3BvcnQuY29sdW1uc1JlbmRlckNhbGN1bGF0b3IuY291bnQ7XG4gICAgdmFyIHRvdGFsQ29sdW1ucyA9IHRoaXMud290LmdldFNldHRpbmcoJ3RvdGFsQ29sdW1ucycpO1xuICAgIGlmICh0aGlzLndvdC5pc092ZXJsYXlOYW1lKFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9ERUJVRykpIHtcbiAgICAgIGNvbHVtbnNDb3VudCA9IHRvdGFsQ29sdW1ucztcbiAgICB9IGVsc2UgaWYgKHRoaXMud290LmlzT3ZlcmxheU5hbWUoV2Fsa29udGFibGVPdmVybGF5LkNMT05FX0xFRlQpIHx8IHRoaXMud290LmlzT3ZlcmxheU5hbWUoV2Fsa29udGFibGVPdmVybGF5LkNMT05FX1RPUF9MRUZUX0NPUk5FUikgfHwgdGhpcy53b3QuaXNPdmVybGF5TmFtZShXYWxrb250YWJsZU92ZXJsYXkuQ0xPTkVfQk9UVE9NX0xFRlRfQ09STkVSKSkge1xuICAgICAgcmV0dXJuIE1hdGgubWluKHRoaXMud290LmdldFNldHRpbmcoJ2ZpeGVkQ29sdW1uc0xlZnQnKSwgdG90YWxDb2x1bW5zKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbHVtbnNDb3VudDtcbiAgfSxcbiAgZ2V0UmVuZGVyZWRSb3dzQ291bnQ6IGZ1bmN0aW9uKCkge1xuICAgIHZhciByb3dzQ291bnQgPSB0aGlzLndvdC53dFZpZXdwb3J0LnJvd3NSZW5kZXJDYWxjdWxhdG9yLmNvdW50O1xuICAgIHZhciB0b3RhbFJvd3MgPSB0aGlzLndvdC5nZXRTZXR0aW5nKCd0b3RhbFJvd3MnKTtcbiAgICBpZiAodGhpcy53b3QuaXNPdmVybGF5TmFtZShXYWxrb250YWJsZU92ZXJsYXkuQ0xPTkVfREVCVUcpKSB7XG4gICAgICByb3dzQ291bnQgPSB0b3RhbFJvd3M7XG4gICAgfSBlbHNlIGlmICh0aGlzLndvdC5pc092ZXJsYXlOYW1lKFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9UT1ApIHx8IHRoaXMud290LmlzT3ZlcmxheU5hbWUoV2Fsa29udGFibGVPdmVybGF5LkNMT05FX1RPUF9MRUZUX0NPUk5FUikpIHtcbiAgICAgIHJvd3NDb3VudCA9IE1hdGgubWluKHRoaXMud290LmdldFNldHRpbmcoJ2ZpeGVkUm93c1RvcCcpLCB0b3RhbFJvd3MpO1xuICAgIH0gZWxzZSBpZiAodGhpcy53b3QuaXNPdmVybGF5TmFtZShXYWxrb250YWJsZU92ZXJsYXkuQ0xPTkVfQk9UVE9NKSB8fCB0aGlzLndvdC5pc092ZXJsYXlOYW1lKFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9CT1RUT01fTEVGVF9DT1JORVIpKSB7XG4gICAgICByb3dzQ291bnQgPSBNYXRoLm1pbih0aGlzLndvdC5nZXRTZXR0aW5nKCdmaXhlZFJvd3NCb3R0b20nKSwgdG90YWxSb3dzKTtcbiAgICB9XG4gICAgcmV0dXJuIHJvd3NDb3VudDtcbiAgfSxcbiAgZ2V0VmlzaWJsZVJvd3NDb3VudDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMud290Lnd0Vmlld3BvcnQucm93c1Zpc2libGVDYWxjdWxhdG9yLmNvdW50O1xuICB9LFxuICBhbGxSb3dzSW5WaWV3cG9ydDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMud290LmdldFNldHRpbmcoJ3RvdGFsUm93cycpID09IHRoaXMuZ2V0VmlzaWJsZVJvd3NDb3VudCgpO1xuICB9LFxuICBnZXRSb3dIZWlnaHQ6IGZ1bmN0aW9uKHNvdXJjZVJvdykge1xuICAgIHZhciBoZWlnaHQgPSB0aGlzLndvdC53dFNldHRpbmdzLnNldHRpbmdzLnJvd0hlaWdodChzb3VyY2VSb3cpO1xuICAgIHZhciBvdmVyc2l6ZWRIZWlnaHQgPSB0aGlzLndvdC53dFZpZXdwb3J0Lm92ZXJzaXplZFJvd3Nbc291cmNlUm93XTtcbiAgICBpZiAob3ZlcnNpemVkSGVpZ2h0ICE9PSB2b2lkIDApIHtcbiAgICAgIGhlaWdodCA9IGhlaWdodCA9PT0gdm9pZCAwID8gb3ZlcnNpemVkSGVpZ2h0IDogTWF0aC5tYXgoaGVpZ2h0LCBvdmVyc2l6ZWRIZWlnaHQpO1xuICAgIH1cbiAgICByZXR1cm4gaGVpZ2h0O1xuICB9LFxuICBnZXRDb2x1bW5IZWFkZXJIZWlnaHQ6IGZ1bmN0aW9uKGxldmVsKSB7XG4gICAgdmFyIGhlaWdodCA9IHRoaXMud290Lnd0U2V0dGluZ3Muc2V0dGluZ3MuZGVmYXVsdFJvd0hlaWdodDtcbiAgICB2YXIgb3ZlcnNpemVkSGVpZ2h0ID0gdGhpcy53b3Qud3RWaWV3cG9ydC5vdmVyc2l6ZWRDb2x1bW5IZWFkZXJzW2xldmVsXTtcbiAgICBpZiAob3ZlcnNpemVkSGVpZ2h0ICE9PSB2b2lkIDApIHtcbiAgICAgIGhlaWdodCA9IGhlaWdodCA/IE1hdGgubWF4KGhlaWdodCwgb3ZlcnNpemVkSGVpZ2h0KSA6IG92ZXJzaXplZEhlaWdodDtcbiAgICB9XG4gICAgcmV0dXJuIGhlaWdodDtcbiAgfSxcbiAgZ2V0VmlzaWJsZUNvbHVtbnNDb3VudDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMud290Lnd0Vmlld3BvcnQuY29sdW1uc1Zpc2libGVDYWxjdWxhdG9yLmNvdW50O1xuICB9LFxuICBhbGxDb2x1bW5zSW5WaWV3cG9ydDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMud290LmdldFNldHRpbmcoJ3RvdGFsQ29sdW1ucycpID09IHRoaXMuZ2V0VmlzaWJsZUNvbHVtbnNDb3VudCgpO1xuICB9LFxuICBnZXRDb2x1bW5XaWR0aDogZnVuY3Rpb24oc291cmNlQ29sdW1uKSB7XG4gICAgdmFyIHdpZHRoID0gdGhpcy53b3Qud3RTZXR0aW5ncy5zZXR0aW5ncy5jb2x1bW5XaWR0aDtcbiAgICBpZiAodHlwZW9mIHdpZHRoID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICB3aWR0aCA9IHdpZHRoKHNvdXJjZUNvbHVtbik7XG4gICAgfSBlbHNlIGlmICh0eXBlb2Ygd2lkdGggPT09ICdvYmplY3QnKSB7XG4gICAgICB3aWR0aCA9IHdpZHRoW3NvdXJjZUNvbHVtbl07XG4gICAgfVxuICAgIHJldHVybiB3aWR0aCB8fCB0aGlzLndvdC53dFNldHRpbmdzLnNldHRpbmdzLmRlZmF1bHRDb2x1bW5XaWR0aDtcbiAgfSxcbiAgZ2V0U3RyZXRjaGVkQ29sdW1uV2lkdGg6IGZ1bmN0aW9uKHNvdXJjZUNvbHVtbikge1xuICAgIHZhciBjb2x1bW5XaWR0aCA9IHRoaXMuZ2V0Q29sdW1uV2lkdGgoc291cmNlQ29sdW1uKTtcbiAgICB2YXIgd2lkdGggPSBjb2x1bW5XaWR0aCA9PSBudWxsID8gdGhpcy5pbnN0YW5jZS53dFNldHRpbmdzLnNldHRpbmdzLmRlZmF1bHRDb2x1bW5XaWR0aCA6IGNvbHVtbldpZHRoO1xuICAgIHZhciBjYWxjdWxhdG9yID0gdGhpcy53b3Qud3RWaWV3cG9ydC5jb2x1bW5zUmVuZGVyQ2FsY3VsYXRvcjtcbiAgICBpZiAoY2FsY3VsYXRvcikge1xuICAgICAgdmFyIHN0cmV0Y2hlZFdpZHRoID0gY2FsY3VsYXRvci5nZXRTdHJldGNoZWRDb2x1bW5XaWR0aChzb3VyY2VDb2x1bW4sIHdpZHRoKTtcbiAgICAgIGlmIChzdHJldGNoZWRXaWR0aCkge1xuICAgICAgICB3aWR0aCA9IHN0cmV0Y2hlZFdpZHRoO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gd2lkdGg7XG4gIH0sXG4gIF9tb2RpZnlSb3dIZWFkZXJXaWR0aDogZnVuY3Rpb24ocm93SGVhZGVyV2lkdGhGYWN0b3J5KSB7XG4gICAgdmFyIHdpZHRocyA9IGlzRnVuY3Rpb24ocm93SGVhZGVyV2lkdGhGYWN0b3J5KSA/IHJvd0hlYWRlcldpZHRoRmFjdG9yeSgpIDogbnVsbDtcbiAgICBpZiAoQXJyYXkuaXNBcnJheSh3aWR0aHMpKSB7XG4gICAgICB3aWR0aHMgPSAkdHJhY2V1clJ1bnRpbWUuc3ByZWFkKHdpZHRocyk7XG4gICAgICB3aWR0aHNbd2lkdGhzLmxlbmd0aCAtIDFdID0gdGhpcy5fY29ycmVjdFJvd0hlYWRlcldpZHRoKHdpZHRoc1t3aWR0aHMubGVuZ3RoIC0gMV0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB3aWR0aHMgPSB0aGlzLl9jb3JyZWN0Um93SGVhZGVyV2lkdGgod2lkdGhzKTtcbiAgICB9XG4gICAgcmV0dXJuIHdpZHRocztcbiAgfSxcbiAgX2NvcnJlY3RSb3dIZWFkZXJXaWR0aDogZnVuY3Rpb24od2lkdGgpIHtcbiAgICBpZiAodHlwZW9mIHdpZHRoICE9PSAnbnVtYmVyJykge1xuICAgICAgd2lkdGggPSB0aGlzLndvdC5nZXRTZXR0aW5nKCdkZWZhdWx0Q29sdW1uV2lkdGgnKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuY29ycmVjdEhlYWRlcldpZHRoKSB7XG4gICAgICB3aWR0aCsrO1xuICAgIH1cbiAgICByZXR1cm4gd2lkdGg7XG4gIH1cbn0sIHt9KTtcbjtcbndpbmRvdy5XYWxrb250YWJsZVRhYmxlID0gV2Fsa29udGFibGVUYWJsZTtcblxuLy8jIFxufSx7XCJjZWxsL2Nvb3Jkc1wiOjYsXCJjZWxsL3JhbmdlXCI6NyxcImZpbHRlci9jb2x1bW5cIjoxMCxcImZpbHRlci9yb3dcIjoxMSxcImhlbHBlcnMvZG9tL2VsZW1lbnRcIjo0NyxcImhlbHBlcnMvZnVuY3Rpb25cIjo1MCxcInRhYmxlUmVuZGVyZXJcIjoyMn1dLDIyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBXYWxrb250YWJsZVRhYmxlUmVuZGVyZXI6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFdhbGtvbnRhYmxlVGFibGVSZW5kZXJlcjtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fO1xudmFyICRfXzAgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLFxuICAgIGFkZENsYXNzID0gJF9fMC5hZGRDbGFzcyxcbiAgICBlbXB0eSA9ICRfXzAuZW1wdHksXG4gICAgZ2V0U2Nyb2xsYmFyV2lkdGggPSAkX18wLmdldFNjcm9sbGJhcldpZHRoLFxuICAgIGhhc0NsYXNzID0gJF9fMC5oYXNDbGFzcyxcbiAgICBpbm5lckhlaWdodCA9ICRfXzAuaW5uZXJIZWlnaHQsXG4gICAgb3V0ZXJXaWR0aCA9ICRfXzAub3V0ZXJXaWR0aDtcbnZhciBwZXJmb3JtYW5jZVdhcm5pbmdBcHBlYXJlZCA9IGZhbHNlO1xudmFyIFdhbGtvbnRhYmxlVGFibGVSZW5kZXJlciA9IGZ1bmN0aW9uIFdhbGtvbnRhYmxlVGFibGVSZW5kZXJlcih3dFRhYmxlKSB7XG4gIHRoaXMud3RUYWJsZSA9IHd0VGFibGU7XG4gIHRoaXMud290ID0gd3RUYWJsZS5pbnN0YW5jZTtcbiAgdGhpcy5pbnN0YW5jZSA9IHd0VGFibGUuaW5zdGFuY2U7XG4gIHRoaXMucm93RmlsdGVyID0gd3RUYWJsZS5yb3dGaWx0ZXI7XG4gIHRoaXMuY29sdW1uRmlsdGVyID0gd3RUYWJsZS5jb2x1bW5GaWx0ZXI7XG4gIHRoaXMuVEFCTEUgPSB3dFRhYmxlLlRBQkxFO1xuICB0aGlzLlRIRUFEID0gd3RUYWJsZS5USEVBRDtcbiAgdGhpcy5UQk9EWSA9IHd0VGFibGUuVEJPRFk7XG4gIHRoaXMuQ09MR1JPVVAgPSB3dFRhYmxlLkNPTEdST1VQO1xuICB0aGlzLnJvd0hlYWRlcnMgPSBbXTtcbiAgdGhpcy5yb3dIZWFkZXJDb3VudCA9IDA7XG4gIHRoaXMuY29sdW1uSGVhZGVycyA9IFtdO1xuICB0aGlzLmNvbHVtbkhlYWRlckNvdW50ID0gMDtcbiAgdGhpcy5maXhlZFJvd3NUb3AgPSAwO1xuICB0aGlzLmZpeGVkUm93c0JvdHRvbSA9IDA7XG59O1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoV2Fsa29udGFibGVUYWJsZVJlbmRlcmVyLCB7XG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgaWYgKCF0aGlzLnd0VGFibGUuaXNXb3JraW5nT25DbG9uZSgpKSB7XG4gICAgICB2YXIgc2tpcFJlbmRlciA9IHt9O1xuICAgICAgdGhpcy53b3QuZ2V0U2V0dGluZygnYmVmb3JlRHJhdycsIHRydWUsIHNraXBSZW5kZXIpO1xuICAgICAgaWYgKHNraXBSZW5kZXIuc2tpcFJlbmRlciA9PT0gdHJ1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMucm93SGVhZGVycyA9IHRoaXMud290LmdldFNldHRpbmcoJ3Jvd0hlYWRlcnMnKTtcbiAgICB0aGlzLnJvd0hlYWRlckNvdW50ID0gdGhpcy5yb3dIZWFkZXJzLmxlbmd0aDtcbiAgICB0aGlzLmZpeGVkUm93c1RvcCA9IHRoaXMud290LmdldFNldHRpbmcoJ2ZpeGVkUm93c1RvcCcpO1xuICAgIHRoaXMuZml4ZWRSb3dzQm90dG9tID0gdGhpcy53b3QuZ2V0U2V0dGluZygnZml4ZWRSb3dzQm90dG9tJyk7XG4gICAgdGhpcy5jb2x1bW5IZWFkZXJzID0gdGhpcy53b3QuZ2V0U2V0dGluZygnY29sdW1uSGVhZGVycycpO1xuICAgIHRoaXMuY29sdW1uSGVhZGVyQ291bnQgPSB0aGlzLmNvbHVtbkhlYWRlcnMubGVuZ3RoO1xuICAgIHZhciBjb2x1bW5zVG9SZW5kZXIgPSB0aGlzLnd0VGFibGUuZ2V0UmVuZGVyZWRDb2x1bW5zQ291bnQoKTtcbiAgICB2YXIgcm93c1RvUmVuZGVyID0gdGhpcy53dFRhYmxlLmdldFJlbmRlcmVkUm93c0NvdW50KCk7XG4gICAgdmFyIHRvdGFsQ29sdW1ucyA9IHRoaXMud290LmdldFNldHRpbmcoJ3RvdGFsQ29sdW1ucycpO1xuICAgIHZhciB0b3RhbFJvd3MgPSB0aGlzLndvdC5nZXRTZXR0aW5nKCd0b3RhbFJvd3MnKTtcbiAgICB2YXIgd29ya3NwYWNlV2lkdGg7XG4gICAgdmFyIGFkanVzdGVkID0gZmFsc2U7XG4gICAgaWYgKFdhbGtvbnRhYmxlT3ZlcmxheS5pc092ZXJsYXlUeXBlT2YodGhpcy53b3QuY2xvbmVPdmVybGF5LCBXYWxrb250YWJsZU92ZXJsYXkuQ0xPTkVfQk9UVE9NKSB8fCBXYWxrb250YWJsZU92ZXJsYXkuaXNPdmVybGF5VHlwZU9mKHRoaXMud290LmNsb25lT3ZlcmxheSwgV2Fsa29udGFibGVPdmVybGF5LkNMT05FX0JPVFRPTV9MRUZUX0NPUk5FUikpIHtcbiAgICAgIHRoaXMuY29sdW1uSGVhZGVycyA9IFtdO1xuICAgICAgdGhpcy5jb2x1bW5IZWFkZXJDb3VudCA9IDA7XG4gICAgfVxuICAgIGlmICh0b3RhbENvbHVtbnMgPj0gMCkge1xuICAgICAgdGhpcy5hZGp1c3RBdmFpbGFibGVOb2RlcygpO1xuICAgICAgYWRqdXN0ZWQgPSB0cnVlO1xuICAgICAgdGhpcy5yZW5kZXJDb2x1bW5IZWFkZXJzKCk7XG4gICAgICB0aGlzLnJlbmRlclJvd3ModG90YWxSb3dzLCByb3dzVG9SZW5kZXIsIGNvbHVtbnNUb1JlbmRlcik7XG4gICAgICBpZiAoIXRoaXMud3RUYWJsZS5pc1dvcmtpbmdPbkNsb25lKCkpIHtcbiAgICAgICAgd29ya3NwYWNlV2lkdGggPSB0aGlzLndvdC53dFZpZXdwb3J0LmdldFdvcmtzcGFjZVdpZHRoKCk7XG4gICAgICAgIHRoaXMud290Lnd0Vmlld3BvcnQuY29udGFpbmVyV2lkdGggPSBudWxsO1xuICAgICAgfVxuICAgICAgdGhpcy5hZGp1c3RDb2x1bW5XaWR0aHMoY29sdW1uc1RvUmVuZGVyKTtcbiAgICAgIHRoaXMubWFya092ZXJzaXplZENvbHVtbkhlYWRlcnMoKTtcbiAgICAgIHRoaXMuYWRqdXN0Q29sdW1uSGVhZGVySGVpZ2h0cygpO1xuICAgIH1cbiAgICBpZiAoIWFkanVzdGVkKSB7XG4gICAgICB0aGlzLmFkanVzdEF2YWlsYWJsZU5vZGVzKCk7XG4gICAgfVxuICAgIHRoaXMucmVtb3ZlUmVkdW5kYW50Um93cyhyb3dzVG9SZW5kZXIpO1xuICAgIGlmICghdGhpcy53dFRhYmxlLmlzV29ya2luZ09uQ2xvbmUoKSB8fCB0aGlzLndvdC5pc092ZXJsYXlOYW1lKFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9CT1RUT00pKSB7XG4gICAgICB0aGlzLm1hcmtPdmVyc2l6ZWRSb3dzKCk7XG4gICAgfVxuICAgIGlmICghdGhpcy53dFRhYmxlLmlzV29ya2luZ09uQ2xvbmUoKSkge1xuICAgICAgdGhpcy53b3Qud3RWaWV3cG9ydC5jcmVhdGVWaXNpYmxlQ2FsY3VsYXRvcnMoKTtcbiAgICAgIHRoaXMud290Lnd0T3ZlcmxheXMucmVmcmVzaChmYWxzZSk7XG4gICAgICB0aGlzLndvdC53dE92ZXJsYXlzLmFwcGx5VG9ET00oKTtcbiAgICAgIHZhciBoaWRlcldpZHRoID0gb3V0ZXJXaWR0aCh0aGlzLnd0VGFibGUuaGlkZXIpO1xuICAgICAgdmFyIHRhYmxlV2lkdGggPSBvdXRlcldpZHRoKHRoaXMud3RUYWJsZS5UQUJMRSk7XG4gICAgICBpZiAoaGlkZXJXaWR0aCAhPT0gMCAmJiAodGFibGVXaWR0aCAhPT0gaGlkZXJXaWR0aCkpIHtcbiAgICAgICAgdGhpcy5hZGp1c3RDb2x1bW5XaWR0aHMoY29sdW1uc1RvUmVuZGVyKTtcbiAgICAgIH1cbiAgICAgIGlmICh3b3Jrc3BhY2VXaWR0aCAhPT0gdGhpcy53b3Qud3RWaWV3cG9ydC5nZXRXb3Jrc3BhY2VXaWR0aCgpKSB7XG4gICAgICAgIHRoaXMud290Lnd0Vmlld3BvcnQuY29udGFpbmVyV2lkdGggPSBudWxsO1xuICAgICAgICB2YXIgZmlyc3RSZW5kZXJlZCA9IHRoaXMud3RUYWJsZS5nZXRGaXJzdFJlbmRlcmVkQ29sdW1uKCk7XG4gICAgICAgIHZhciBsYXN0UmVuZGVyZWQgPSB0aGlzLnd0VGFibGUuZ2V0TGFzdFJlbmRlcmVkQ29sdW1uKCk7XG4gICAgICAgIHZhciBkZWZhdWx0Q29sdW1uV2lkdGggPSB0aGlzLndvdC5nZXRTZXR0aW5nKCdkZWZhdWx0Q29sdW1uV2lkdGgnKTtcbiAgICAgICAgdmFyIHJvd0hlYWRlcldpZHRoU2V0dGluZyA9IHRoaXMud290LmdldFNldHRpbmcoJ3Jvd0hlYWRlcldpZHRoJyk7XG4gICAgICAgIHJvd0hlYWRlcldpZHRoU2V0dGluZyA9IHRoaXMuaW5zdGFuY2UuZ2V0U2V0dGluZygnb25Nb2RpZnlSb3dIZWFkZXJXaWR0aCcsIHJvd0hlYWRlcldpZHRoU2V0dGluZyk7XG4gICAgICAgIGlmIChyb3dIZWFkZXJXaWR0aFNldHRpbmcgIT0gbnVsbCkge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5yb3dIZWFkZXJDb3VudDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSBBcnJheS5pc0FycmF5KHJvd0hlYWRlcldpZHRoU2V0dGluZykgPyByb3dIZWFkZXJXaWR0aFNldHRpbmdbaV0gOiByb3dIZWFkZXJXaWR0aFNldHRpbmc7XG4gICAgICAgICAgICB3aWR0aCA9IHdpZHRoID09IG51bGwgPyBkZWZhdWx0Q29sdW1uV2lkdGggOiB3aWR0aDtcbiAgICAgICAgICAgIHRoaXMuQ09MR1JPVVAuY2hpbGROb2Rlc1tpXS5zdHlsZS53aWR0aCA9IHdpZHRoICsgJ3B4JztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSRfXzIgPSBmaXJzdFJlbmRlcmVkOyBpJF9fMiA8IGxhc3RSZW5kZXJlZDsgaSRfXzIrKykge1xuICAgICAgICAgIHZhciB3aWR0aCRfXzMgPSB0aGlzLnd0VGFibGUuZ2V0U3RyZXRjaGVkQ29sdW1uV2lkdGgoaSRfXzIpO1xuICAgICAgICAgIHZhciByZW5kZXJlZEluZGV4ID0gdGhpcy5jb2x1bW5GaWx0ZXIuc291cmNlVG9SZW5kZXJlZChpJF9fMik7XG4gICAgICAgICAgdGhpcy5DT0xHUk9VUC5jaGlsZE5vZGVzW3JlbmRlcmVkSW5kZXggKyB0aGlzLnJvd0hlYWRlckNvdW50XS5zdHlsZS53aWR0aCA9IHdpZHRoJF9fMyArICdweCc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMud290LmdldFNldHRpbmcoJ29uRHJhdycsIHRydWUpO1xuICAgIH0gZWxzZSBpZiAodGhpcy53b3QuaXNPdmVybGF5TmFtZShXYWxrb250YWJsZU92ZXJsYXkuQ0xPTkVfQk9UVE9NKSkge1xuICAgICAgdGhpcy53b3QuY2xvbmVTb3VyY2Uud3RPdmVybGF5cy5hZGp1c3RFbGVtZW50c1NpemUoKTtcbiAgICB9XG4gIH0sXG4gIHJlbW92ZVJlZHVuZGFudFJvd3M6IGZ1bmN0aW9uKHJlbmRlcmVkUm93c0NvdW50KSB7XG4gICAgd2hpbGUgKHRoaXMud3RUYWJsZS50Ym9keUNoaWxkcmVuTGVuZ3RoID4gcmVuZGVyZWRSb3dzQ291bnQpIHtcbiAgICAgIHRoaXMuVEJPRFkucmVtb3ZlQ2hpbGQodGhpcy5UQk9EWS5sYXN0Q2hpbGQpO1xuICAgICAgdGhpcy53dFRhYmxlLnRib2R5Q2hpbGRyZW5MZW5ndGgtLTtcbiAgICB9XG4gIH0sXG4gIHJlbmRlclJvd3M6IGZ1bmN0aW9uKHRvdGFsUm93cywgcm93c1RvUmVuZGVyLCBjb2x1bW5zVG9SZW5kZXIpIHtcbiAgICB2YXIgbGFzdFRELFxuICAgICAgICBUUjtcbiAgICB2YXIgdmlzaWJsZVJvd0luZGV4ID0gMDtcbiAgICB2YXIgc291cmNlUm93SW5kZXggPSB0aGlzLnJvd0ZpbHRlci5yZW5kZXJlZFRvU291cmNlKHZpc2libGVSb3dJbmRleCk7XG4gICAgdmFyIGlzV29ya2luZ09uQ2xvbmUgPSB0aGlzLnd0VGFibGUuaXNXb3JraW5nT25DbG9uZSgpO1xuICAgIHdoaWxlIChzb3VyY2VSb3dJbmRleCA8IHRvdGFsUm93cyAmJiBzb3VyY2VSb3dJbmRleCA+PSAwKSB7XG4gICAgICBpZiAoIXBlcmZvcm1hbmNlV2FybmluZ0FwcGVhcmVkICYmIHZpc2libGVSb3dJbmRleCA+IDEwMDApIHtcbiAgICAgICAgcGVyZm9ybWFuY2VXYXJuaW5nQXBwZWFyZWQgPSB0cnVlO1xuICAgICAgICBjb25zb2xlLndhcm4oJ1BlcmZvcm1hbmNlIHRpcDogSGFuZHNvbnRhYmxlIHJlbmRlcmVkIG1vcmUgdGhhbiAxMDAwIHZpc2libGUgcm93cy4gQ29uc2lkZXIgbGltaXRpbmcgdGhlIG51bWJlciAnICsgJ29mIHJlbmRlcmVkIHJvd3MgYnkgc3BlY2lmeWluZyB0aGUgdGFibGUgaGVpZ2h0IGFuZC9vciB0dXJuaW5nIG9mZiB0aGUgXCJyZW5kZXJBbGxSb3dzXCIgb3B0aW9uLicpO1xuICAgICAgfVxuICAgICAgaWYgKHJvd3NUb1JlbmRlciAhPT0gdm9pZCAwICYmIHZpc2libGVSb3dJbmRleCA9PT0gcm93c1RvUmVuZGVyKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgVFIgPSB0aGlzLmdldE9yQ3JlYXRlVHJGb3JSb3codmlzaWJsZVJvd0luZGV4LCBUUik7XG4gICAgICB0aGlzLnJlbmRlclJvd0hlYWRlcnMoc291cmNlUm93SW5kZXgsIFRSKTtcbiAgICAgIHRoaXMuYWRqdXN0Q29sdW1ucyhUUiwgY29sdW1uc1RvUmVuZGVyICsgdGhpcy5yb3dIZWFkZXJDb3VudCk7XG4gICAgICBsYXN0VEQgPSB0aGlzLnJlbmRlckNlbGxzKHNvdXJjZVJvd0luZGV4LCBUUiwgY29sdW1uc1RvUmVuZGVyKTtcbiAgICAgIGlmICghaXNXb3JraW5nT25DbG9uZSB8fCB0aGlzLndvdC5pc092ZXJsYXlOYW1lKFdhbGtvbnRhYmxlT3ZlcmxheS5DTE9ORV9CT1RUT00pKSB7XG4gICAgICAgIHRoaXMucmVzZXRPdmVyc2l6ZWRSb3coc291cmNlUm93SW5kZXgpO1xuICAgICAgfVxuICAgICAgaWYgKFRSLmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMud290Lnd0VGFibGUuZ2V0Um93SGVpZ2h0KHNvdXJjZVJvd0luZGV4KTtcbiAgICAgICAgaWYgKGhlaWdodCkge1xuICAgICAgICAgIGhlaWdodC0tO1xuICAgICAgICAgIFRSLmZpcnN0Q2hpbGQuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBUUi5maXJzdENoaWxkLnN0eWxlLmhlaWdodCA9ICcnO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB2aXNpYmxlUm93SW5kZXgrKztcbiAgICAgIHNvdXJjZVJvd0luZGV4ID0gdGhpcy5yb3dGaWx0ZXIucmVuZGVyZWRUb1NvdXJjZSh2aXNpYmxlUm93SW5kZXgpO1xuICAgIH1cbiAgfSxcbiAgcmVzZXRPdmVyc2l6ZWRSb3c6IGZ1bmN0aW9uKHNvdXJjZVJvdykge1xuICAgIGlmICh0aGlzLndvdC5nZXRTZXR0aW5nKCdleHRlcm5hbFJvd0NhbGN1bGF0b3InKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodGhpcy53b3Qud3RWaWV3cG9ydC5vdmVyc2l6ZWRSb3dzICYmIHRoaXMud290Lnd0Vmlld3BvcnQub3ZlcnNpemVkUm93c1tzb3VyY2VSb3ddKSB7XG4gICAgICB0aGlzLndvdC53dFZpZXdwb3J0Lm92ZXJzaXplZFJvd3Nbc291cmNlUm93XSA9IHZvaWQgMDtcbiAgICB9XG4gIH0sXG4gIG1hcmtPdmVyc2l6ZWRSb3dzOiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy53b3QuZ2V0U2V0dGluZygnZXh0ZXJuYWxSb3dDYWxjdWxhdG9yJykpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHJvd0NvdW50ID0gdGhpcy5pbnN0YW5jZS53dFRhYmxlLlRCT0RZLmNoaWxkTm9kZXMubGVuZ3RoO1xuICAgIHZhciBleHBlY3RlZFRhYmxlSGVpZ2h0ID0gcm93Q291bnQgKiB0aGlzLmluc3RhbmNlLnd0U2V0dGluZ3Muc2V0dGluZ3MuZGVmYXVsdFJvd0hlaWdodDtcbiAgICB2YXIgYWN0dWFsVGFibGVIZWlnaHQgPSBpbm5lckhlaWdodCh0aGlzLmluc3RhbmNlLnd0VGFibGUuVEJPRFkpIC0gMTtcbiAgICB2YXIgcHJldmlvdXNSb3dIZWlnaHQ7XG4gICAgdmFyIHJvd0lubmVySGVpZ2h0O1xuICAgIHZhciBzb3VyY2VSb3dJbmRleDtcbiAgICB2YXIgY3VycmVudFRyO1xuICAgIHZhciByb3dIZWFkZXI7XG4gICAgdmFyIHRvdGFsUm93cyA9IHRoaXMuaW5zdGFuY2UuZ2V0U2V0dGluZygndG90YWxSb3dzJyk7XG4gICAgaWYgKGV4cGVjdGVkVGFibGVIZWlnaHQgPT09IGFjdHVhbFRhYmxlSGVpZ2h0ICYmICF0aGlzLmluc3RhbmNlLmdldFNldHRpbmcoJ2ZpeGVkUm93c0JvdHRvbScpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHdoaWxlIChyb3dDb3VudCkge1xuICAgICAgcm93Q291bnQtLTtcbiAgICAgIHNvdXJjZVJvd0luZGV4ID0gdGhpcy5pbnN0YW5jZS53dFRhYmxlLnJvd0ZpbHRlci5yZW5kZXJlZFRvU291cmNlKHJvd0NvdW50KTtcbiAgICAgIHByZXZpb3VzUm93SGVpZ2h0ID0gdGhpcy5pbnN0YW5jZS53dFRhYmxlLmdldFJvd0hlaWdodChzb3VyY2VSb3dJbmRleCk7XG4gICAgICBjdXJyZW50VHIgPSB0aGlzLmluc3RhbmNlLnd0VGFibGUuZ2V0VHJGb3JSb3coc291cmNlUm93SW5kZXgpO1xuICAgICAgcm93SGVhZGVyID0gY3VycmVudFRyLnF1ZXJ5U2VsZWN0b3IoJ3RoJyk7XG4gICAgICBpZiAocm93SGVhZGVyKSB7XG4gICAgICAgIHJvd0lubmVySGVpZ2h0ID0gaW5uZXJIZWlnaHQocm93SGVhZGVyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJvd0lubmVySGVpZ2h0ID0gaW5uZXJIZWlnaHQoY3VycmVudFRyKSAtIDE7XG4gICAgICB9XG4gICAgICBpZiAoKCFwcmV2aW91c1Jvd0hlaWdodCAmJiB0aGlzLmluc3RhbmNlLnd0U2V0dGluZ3Muc2V0dGluZ3MuZGVmYXVsdFJvd0hlaWdodCA8IHJvd0lubmVySGVpZ2h0IHx8IHByZXZpb3VzUm93SGVpZ2h0IDwgcm93SW5uZXJIZWlnaHQpKSB7XG4gICAgICAgIHRoaXMuaW5zdGFuY2Uud3RWaWV3cG9ydC5vdmVyc2l6ZWRSb3dzW3NvdXJjZVJvd0luZGV4XSA9ICsrcm93SW5uZXJIZWlnaHQ7XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBtYXJrT3ZlcnNpemVkQ29sdW1uSGVhZGVyczogZnVuY3Rpb24oKSB7XG4gICAgdmFyIG92ZXJsYXlOYW1lID0gdGhpcy53b3QuZ2V0T3ZlcmxheU5hbWUoKTtcbiAgICBpZiAoIXRoaXMuY29sdW1uSGVhZGVyQ291bnQgfHwgdGhpcy53b3Qud3RWaWV3cG9ydC5oYXNPdmVyc2l6ZWRDb2x1bW5IZWFkZXJzTWFya2VkW292ZXJsYXlOYW1lXSB8fCB0aGlzLnd0VGFibGUuaXNXb3JraW5nT25DbG9uZSgpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBjb2x1bW5Db3VudCA9IHRoaXMud3RUYWJsZS5nZXRSZW5kZXJlZENvbHVtbnNDb3VudCgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jb2x1bW5IZWFkZXJDb3VudDsgaSsrKSB7XG4gICAgICBmb3IgKHZhciByZW5kZXJlZENvbHVtbkluZGV4ID0gKC0xKSAqIHRoaXMucm93SGVhZGVyQ291bnQ7IHJlbmRlcmVkQ29sdW1uSW5kZXggPCBjb2x1bW5Db3VudDsgcmVuZGVyZWRDb2x1bW5JbmRleCsrKSB7XG4gICAgICAgIHRoaXMubWFya0lmT3ZlcnNpemVkQ29sdW1uSGVhZGVyKHJlbmRlcmVkQ29sdW1uSW5kZXgpO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLndvdC53dFZpZXdwb3J0Lmhhc092ZXJzaXplZENvbHVtbkhlYWRlcnNNYXJrZWRbb3ZlcmxheU5hbWVdID0gdHJ1ZTtcbiAgfSxcbiAgYWRqdXN0Q29sdW1uSGVhZGVySGVpZ2h0czogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNvbHVtbkhlYWRlcnMgPSB0aGlzLndvdC5nZXRTZXR0aW5nKCdjb2x1bW5IZWFkZXJzJyk7XG4gICAgdmFyIGNoaWxkcmVuID0gdGhpcy53b3Qud3RUYWJsZS5USEVBRC5jaGlsZE5vZGVzO1xuICAgIHZhciBvdmVyc2l6ZWRDb2x1bW5IZWFkZXJzID0gdGhpcy53b3Qud3RWaWV3cG9ydC5vdmVyc2l6ZWRDb2x1bW5IZWFkZXJzO1xuICAgIGZvciAodmFyIGkgPSAwLFxuICAgICAgICBsZW4gPSBjb2x1bW5IZWFkZXJzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBpZiAob3ZlcnNpemVkQ29sdW1uSGVhZGVyc1tpXSkge1xuICAgICAgICBpZiAoIWNoaWxkcmVuW2ldIHx8IGNoaWxkcmVuW2ldLmNoaWxkTm9kZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNoaWxkcmVuW2ldLmNoaWxkTm9kZXNbMF0uc3R5bGUuaGVpZ2h0ID0gb3ZlcnNpemVkQ29sdW1uSGVhZGVyc1tpXSArICdweCc7XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBtYXJrSWZPdmVyc2l6ZWRDb2x1bW5IZWFkZXI6IGZ1bmN0aW9uKGNvbCkge1xuICAgIHZhciBzb3VyY2VDb2xJbmRleCA9IHRoaXMud290Lnd0VGFibGUuY29sdW1uRmlsdGVyLnJlbmRlcmVkVG9Tb3VyY2UoY29sKTtcbiAgICB2YXIgbGV2ZWwgPSB0aGlzLmNvbHVtbkhlYWRlckNvdW50O1xuICAgIHZhciBkZWZhdWx0Um93SGVpZ2h0ID0gdGhpcy53b3Qud3RTZXR0aW5ncy5zZXR0aW5ncy5kZWZhdWx0Um93SGVpZ2h0O1xuICAgIHZhciBwcmV2aW91c0NvbEhlYWRlckhlaWdodDtcbiAgICB2YXIgY3VycmVudEhlYWRlcjtcbiAgICB2YXIgY3VycmVudEhlYWRlckhlaWdodDtcbiAgICB2YXIgY29sdW1uSGVhZGVySGVpZ2h0U2V0dGluZyA9IHRoaXMud290LmdldFNldHRpbmcoJ2NvbHVtbkhlYWRlckhlaWdodCcpIHx8IFtdO1xuICAgIHdoaWxlIChsZXZlbCkge1xuICAgICAgbGV2ZWwtLTtcbiAgICAgIHByZXZpb3VzQ29sSGVhZGVySGVpZ2h0ID0gdGhpcy53b3Qud3RUYWJsZS5nZXRDb2x1bW5IZWFkZXJIZWlnaHQobGV2ZWwpO1xuICAgICAgY3VycmVudEhlYWRlciA9IHRoaXMud290Lnd0VGFibGUuZ2V0Q29sdW1uSGVhZGVyKHNvdXJjZUNvbEluZGV4LCBsZXZlbCk7XG4gICAgICBpZiAoIWN1cnJlbnRIZWFkZXIpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBjdXJyZW50SGVhZGVySGVpZ2h0ID0gaW5uZXJIZWlnaHQoY3VycmVudEhlYWRlcik7XG4gICAgICBpZiAoIXByZXZpb3VzQ29sSGVhZGVySGVpZ2h0ICYmIGRlZmF1bHRSb3dIZWlnaHQgPCBjdXJyZW50SGVhZGVySGVpZ2h0IHx8IHByZXZpb3VzQ29sSGVhZGVySGVpZ2h0IDwgY3VycmVudEhlYWRlckhlaWdodCkge1xuICAgICAgICB0aGlzLndvdC53dFZpZXdwb3J0Lm92ZXJzaXplZENvbHVtbkhlYWRlcnNbbGV2ZWxdID0gY3VycmVudEhlYWRlckhlaWdodDtcbiAgICAgIH1cbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGNvbHVtbkhlYWRlckhlaWdodFNldHRpbmcpKSB7XG4gICAgICAgIGlmIChjb2x1bW5IZWFkZXJIZWlnaHRTZXR0aW5nW2xldmVsXSAhPSBudWxsKSB7XG4gICAgICAgICAgdGhpcy53b3Qud3RWaWV3cG9ydC5vdmVyc2l6ZWRDb2x1bW5IZWFkZXJzW2xldmVsXSA9IGNvbHVtbkhlYWRlckhlaWdodFNldHRpbmdbbGV2ZWxdO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKCFpc05hTihjb2x1bW5IZWFkZXJIZWlnaHRTZXR0aW5nKSkge1xuICAgICAgICB0aGlzLndvdC53dFZpZXdwb3J0Lm92ZXJzaXplZENvbHVtbkhlYWRlcnNbbGV2ZWxdID0gY29sdW1uSGVhZGVySGVpZ2h0U2V0dGluZztcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLndvdC53dFZpZXdwb3J0Lm92ZXJzaXplZENvbHVtbkhlYWRlcnNbbGV2ZWxdIDwgKGNvbHVtbkhlYWRlckhlaWdodFNldHRpbmdbbGV2ZWxdIHx8IGNvbHVtbkhlYWRlckhlaWdodFNldHRpbmcpKSB7XG4gICAgICAgIHRoaXMud290Lnd0Vmlld3BvcnQub3ZlcnNpemVkQ29sdW1uSGVhZGVyc1tsZXZlbF0gPSAoY29sdW1uSGVhZGVySGVpZ2h0U2V0dGluZ1tsZXZlbF0gfHwgY29sdW1uSGVhZGVySGVpZ2h0U2V0dGluZyk7XG4gICAgICB9XG4gICAgfVxuICB9LFxuICByZW5kZXJDZWxsczogZnVuY3Rpb24oc291cmNlUm93SW5kZXgsIFRSLCBjb2x1bW5zVG9SZW5kZXIpIHtcbiAgICB2YXIgVEQ7XG4gICAgdmFyIHNvdXJjZUNvbEluZGV4O1xuICAgIGZvciAodmFyIHZpc2libGVDb2xJbmRleCA9IDA7IHZpc2libGVDb2xJbmRleCA8IGNvbHVtbnNUb1JlbmRlcjsgdmlzaWJsZUNvbEluZGV4KyspIHtcbiAgICAgIHNvdXJjZUNvbEluZGV4ID0gdGhpcy5jb2x1bW5GaWx0ZXIucmVuZGVyZWRUb1NvdXJjZSh2aXNpYmxlQ29sSW5kZXgpO1xuICAgICAgaWYgKHZpc2libGVDb2xJbmRleCA9PT0gMCkge1xuICAgICAgICBURCA9IFRSLmNoaWxkTm9kZXNbdGhpcy5jb2x1bW5GaWx0ZXIuc291cmNlQ29sdW1uVG9WaXNpYmxlUm93SGVhZGVkQ29sdW1uKHNvdXJjZUNvbEluZGV4KV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBURCA9IFRELm5leHRTaWJsaW5nO1xuICAgICAgfVxuICAgICAgaWYgKFRELm5vZGVOYW1lID09ICdUSCcpIHtcbiAgICAgICAgVEQgPSByZXBsYWNlVGhXaXRoVGQoVEQsIFRSKTtcbiAgICAgIH1cbiAgICAgIGlmICghaGFzQ2xhc3MoVEQsICdoaWRlJykpIHtcbiAgICAgICAgVEQuY2xhc3NOYW1lID0gJyc7XG4gICAgICB9XG4gICAgICBURC5yZW1vdmVBdHRyaWJ1dGUoJ3N0eWxlJyk7XG4gICAgICB0aGlzLndvdC53dFNldHRpbmdzLnNldHRpbmdzLmNlbGxSZW5kZXJlcihzb3VyY2VSb3dJbmRleCwgc291cmNlQ29sSW5kZXgsIFREKTtcbiAgICB9XG4gICAgcmV0dXJuIFREO1xuICB9LFxuICBhZGp1c3RDb2x1bW5XaWR0aHM6IGZ1bmN0aW9uKGNvbHVtbnNUb1JlbmRlcikge1xuICAgIHZhciBzY3JvbGxiYXJDb21wZW5zYXRpb24gPSAwO1xuICAgIHZhciBzb3VyY2VJbnN0YW5jZSA9IHRoaXMud290LmNsb25lU291cmNlID8gdGhpcy53b3QuY2xvbmVTb3VyY2UgOiB0aGlzLndvdDtcbiAgICB2YXIgbWFpbkhvbGRlciA9IHNvdXJjZUluc3RhbmNlLnd0VGFibGUuaG9sZGVyO1xuICAgIHZhciBkZWZhdWx0Q29sdW1uV2lkdGggPSB0aGlzLndvdC5nZXRTZXR0aW5nKCdkZWZhdWx0Q29sdW1uV2lkdGgnKTtcbiAgICB2YXIgcm93SGVhZGVyV2lkdGhTZXR0aW5nID0gdGhpcy53b3QuZ2V0U2V0dGluZygncm93SGVhZGVyV2lkdGgnKTtcbiAgICBpZiAobWFpbkhvbGRlci5vZmZzZXRIZWlnaHQgPCBtYWluSG9sZGVyLnNjcm9sbEhlaWdodCkge1xuICAgICAgc2Nyb2xsYmFyQ29tcGVuc2F0aW9uID0gZ2V0U2Nyb2xsYmFyV2lkdGgoKTtcbiAgICB9XG4gICAgdGhpcy53b3Qud3RWaWV3cG9ydC5jb2x1bW5zUmVuZGVyQ2FsY3VsYXRvci5yZWZyZXNoU3RyZXRjaGluZyh0aGlzLndvdC53dFZpZXdwb3J0LmdldFZpZXdwb3J0V2lkdGgoKSAtIHNjcm9sbGJhckNvbXBlbnNhdGlvbik7XG4gICAgcm93SGVhZGVyV2lkdGhTZXR0aW5nID0gdGhpcy5pbnN0YW5jZS5nZXRTZXR0aW5nKCdvbk1vZGlmeVJvd0hlYWRlcldpZHRoJywgcm93SGVhZGVyV2lkdGhTZXR0aW5nKTtcbiAgICBpZiAocm93SGVhZGVyV2lkdGhTZXR0aW5nICE9IG51bGwpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5yb3dIZWFkZXJDb3VudDsgaSsrKSB7XG4gICAgICAgIHZhciB3aWR0aCA9IEFycmF5LmlzQXJyYXkocm93SGVhZGVyV2lkdGhTZXR0aW5nKSA/IHJvd0hlYWRlcldpZHRoU2V0dGluZ1tpXSA6IHJvd0hlYWRlcldpZHRoU2V0dGluZztcbiAgICAgICAgd2lkdGggPSB3aWR0aCA9PSBudWxsID8gZGVmYXVsdENvbHVtbldpZHRoIDogd2lkdGg7XG4gICAgICAgIHRoaXMuQ09MR1JPVVAuY2hpbGROb2Rlc1tpXS5zdHlsZS53aWR0aCA9IHdpZHRoICsgJ3B4JztcbiAgICAgIH1cbiAgICB9XG4gICAgZm9yICh2YXIgcmVuZGVyZWRDb2xJbmRleCA9IDA7IHJlbmRlcmVkQ29sSW5kZXggPCBjb2x1bW5zVG9SZW5kZXI7IHJlbmRlcmVkQ29sSW5kZXgrKykge1xuICAgICAgdmFyIHdpZHRoJF9fNCA9IHRoaXMud3RUYWJsZS5nZXRTdHJldGNoZWRDb2x1bW5XaWR0aCh0aGlzLmNvbHVtbkZpbHRlci5yZW5kZXJlZFRvU291cmNlKHJlbmRlcmVkQ29sSW5kZXgpKTtcbiAgICAgIHRoaXMuQ09MR1JPVVAuY2hpbGROb2Rlc1tyZW5kZXJlZENvbEluZGV4ICsgdGhpcy5yb3dIZWFkZXJDb3VudF0uc3R5bGUud2lkdGggPSB3aWR0aCRfXzQgKyAncHgnO1xuICAgIH1cbiAgfSxcbiAgYXBwZW5kVG9UYm9keTogZnVuY3Rpb24oVFIpIHtcbiAgICB0aGlzLlRCT0RZLmFwcGVuZENoaWxkKFRSKTtcbiAgICB0aGlzLnd0VGFibGUudGJvZHlDaGlsZHJlbkxlbmd0aCsrO1xuICB9LFxuICBnZXRPckNyZWF0ZVRyRm9yUm93OiBmdW5jdGlvbihyb3dJbmRleCwgY3VycmVudFRyKSB7XG4gICAgdmFyIFRSO1xuICAgIGlmIChyb3dJbmRleCA+PSB0aGlzLnd0VGFibGUudGJvZHlDaGlsZHJlbkxlbmd0aCkge1xuICAgICAgVFIgPSB0aGlzLmNyZWF0ZVJvdygpO1xuICAgICAgdGhpcy5hcHBlbmRUb1Rib2R5KFRSKTtcbiAgICB9IGVsc2UgaWYgKHJvd0luZGV4ID09PSAwKSB7XG4gICAgICBUUiA9IHRoaXMuVEJPRFkuZmlyc3RDaGlsZDtcbiAgICB9IGVsc2Uge1xuICAgICAgVFIgPSBjdXJyZW50VHIubmV4dFNpYmxpbmc7XG4gICAgfVxuICAgIGlmIChUUi5jbGFzc05hbWUpIHtcbiAgICAgIFRSLnJlbW92ZUF0dHJpYnV0ZSgnY2xhc3MnKTtcbiAgICB9XG4gICAgcmV0dXJuIFRSO1xuICB9LFxuICBjcmVhdGVSb3c6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBUUiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ1RSJyk7XG4gICAgZm9yICh2YXIgdmlzaWJsZUNvbEluZGV4ID0gMDsgdmlzaWJsZUNvbEluZGV4IDwgdGhpcy5yb3dIZWFkZXJDb3VudDsgdmlzaWJsZUNvbEluZGV4KyspIHtcbiAgICAgIFRSLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ1RIJykpO1xuICAgIH1cbiAgICByZXR1cm4gVFI7XG4gIH0sXG4gIHJlbmRlclJvd0hlYWRlcjogZnVuY3Rpb24ocm93LCBjb2wsIFRIKSB7XG4gICAgVEguY2xhc3NOYW1lID0gJyc7XG4gICAgVEgucmVtb3ZlQXR0cmlidXRlKCdzdHlsZScpO1xuICAgIHRoaXMucm93SGVhZGVyc1tjb2xdKHJvdywgVEgsIGNvbCk7XG4gIH0sXG4gIHJlbmRlclJvd0hlYWRlcnM6IGZ1bmN0aW9uKHJvdywgVFIpIHtcbiAgICBmb3IgKHZhciBUSCA9IFRSLmZpcnN0Q2hpbGQsXG4gICAgICAgIHZpc2libGVDb2xJbmRleCA9IDA7IHZpc2libGVDb2xJbmRleCA8IHRoaXMucm93SGVhZGVyQ291bnQ7IHZpc2libGVDb2xJbmRleCsrKSB7XG4gICAgICBpZiAoIVRIKSB7XG4gICAgICAgIFRIID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnVEgnKTtcbiAgICAgICAgVFIuYXBwZW5kQ2hpbGQoVEgpO1xuICAgICAgfSBlbHNlIGlmIChUSC5ub2RlTmFtZSA9PSAnVEQnKSB7XG4gICAgICAgIFRIID0gcmVwbGFjZVRkV2l0aFRoKFRILCBUUik7XG4gICAgICB9XG4gICAgICB0aGlzLnJlbmRlclJvd0hlYWRlcihyb3csIHZpc2libGVDb2xJbmRleCwgVEgpO1xuICAgICAgVEggPSBUSC5uZXh0U2libGluZztcbiAgICB9XG4gIH0sXG4gIGFkanVzdEF2YWlsYWJsZU5vZGVzOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmFkanVzdENvbEdyb3VwcygpO1xuICAgIHRoaXMuYWRqdXN0VGhlYWQoKTtcbiAgfSxcbiAgcmVuZGVyQ29sdW1uSGVhZGVyczogZnVuY3Rpb24oKSB7XG4gICAgaWYgKCF0aGlzLmNvbHVtbkhlYWRlckNvdW50KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBjb2x1bW5Db3VudCA9IHRoaXMud3RUYWJsZS5nZXRSZW5kZXJlZENvbHVtbnNDb3VudCgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jb2x1bW5IZWFkZXJDb3VudDsgaSsrKSB7XG4gICAgICB2YXIgVFIgPSB0aGlzLmdldFRyRm9yQ29sdW1uSGVhZGVycyhpKTtcbiAgICAgIGZvciAodmFyIHJlbmRlcmVkQ29sdW1uSW5kZXggPSAoLTEpICogdGhpcy5yb3dIZWFkZXJDb3VudDsgcmVuZGVyZWRDb2x1bW5JbmRleCA8IGNvbHVtbkNvdW50OyByZW5kZXJlZENvbHVtbkluZGV4KyspIHtcbiAgICAgICAgdmFyIHNvdXJjZUNvbCA9IHRoaXMuY29sdW1uRmlsdGVyLnJlbmRlcmVkVG9Tb3VyY2UocmVuZGVyZWRDb2x1bW5JbmRleCk7XG4gICAgICAgIHRoaXMucmVuZGVyQ29sdW1uSGVhZGVyKGksIHNvdXJjZUNvbCwgVFIuY2hpbGROb2Rlc1tyZW5kZXJlZENvbHVtbkluZGV4ICsgdGhpcy5yb3dIZWFkZXJDb3VudF0pO1xuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYWRqdXN0Q29sR3JvdXBzOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgY29sdW1uQ291bnQgPSB0aGlzLnd0VGFibGUuZ2V0UmVuZGVyZWRDb2x1bW5zQ291bnQoKTtcbiAgICB3aGlsZSAodGhpcy53dFRhYmxlLmNvbGdyb3VwQ2hpbGRyZW5MZW5ndGggPCBjb2x1bW5Db3VudCArIHRoaXMucm93SGVhZGVyQ291bnQpIHtcbiAgICAgIHRoaXMuQ09MR1JPVVAuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnQ09MJykpO1xuICAgICAgdGhpcy53dFRhYmxlLmNvbGdyb3VwQ2hpbGRyZW5MZW5ndGgrKztcbiAgICB9XG4gICAgd2hpbGUgKHRoaXMud3RUYWJsZS5jb2xncm91cENoaWxkcmVuTGVuZ3RoID4gY29sdW1uQ291bnQgKyB0aGlzLnJvd0hlYWRlckNvdW50KSB7XG4gICAgICB0aGlzLkNPTEdST1VQLnJlbW92ZUNoaWxkKHRoaXMuQ09MR1JPVVAubGFzdENoaWxkKTtcbiAgICAgIHRoaXMud3RUYWJsZS5jb2xncm91cENoaWxkcmVuTGVuZ3RoLS07XG4gICAgfVxuICAgIGlmICh0aGlzLnJvd0hlYWRlckNvdW50KSB7XG4gICAgICBhZGRDbGFzcyh0aGlzLkNPTEdST1VQLmNoaWxkTm9kZXNbMF0sICdyb3dIZWFkZXInKTtcbiAgICB9XG4gIH0sXG4gIGFkanVzdFRoZWFkOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgY29sdW1uQ291bnQgPSB0aGlzLnd0VGFibGUuZ2V0UmVuZGVyZWRDb2x1bW5zQ291bnQoKTtcbiAgICB2YXIgVFIgPSB0aGlzLlRIRUFELmZpcnN0Q2hpbGQ7XG4gICAgaWYgKHRoaXMuY29sdW1uSGVhZGVycy5sZW5ndGgpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwLFxuICAgICAgICAgIGxlbiA9IHRoaXMuY29sdW1uSGVhZGVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBUUiA9IHRoaXMuVEhFQUQuY2hpbGROb2Rlc1tpXTtcbiAgICAgICAgaWYgKCFUUikge1xuICAgICAgICAgIFRSID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnVFInKTtcbiAgICAgICAgICB0aGlzLlRIRUFELmFwcGVuZENoaWxkKFRSKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRoZWFkQ2hpbGRyZW5MZW5ndGggPSBUUi5jaGlsZE5vZGVzLmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKHRoaXMudGhlYWRDaGlsZHJlbkxlbmd0aCA8IGNvbHVtbkNvdW50ICsgdGhpcy5yb3dIZWFkZXJDb3VudCkge1xuICAgICAgICAgIFRSLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ1RIJykpO1xuICAgICAgICAgIHRoaXMudGhlYWRDaGlsZHJlbkxlbmd0aCsrO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlICh0aGlzLnRoZWFkQ2hpbGRyZW5MZW5ndGggPiBjb2x1bW5Db3VudCArIHRoaXMucm93SGVhZGVyQ291bnQpIHtcbiAgICAgICAgICBUUi5yZW1vdmVDaGlsZChUUi5sYXN0Q2hpbGQpO1xuICAgICAgICAgIHRoaXMudGhlYWRDaGlsZHJlbkxlbmd0aC0tO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB2YXIgdGhlYWRDaGlsZHJlbkxlbmd0aCA9IHRoaXMuVEhFQUQuY2hpbGROb2Rlcy5sZW5ndGg7XG4gICAgICBpZiAodGhlYWRDaGlsZHJlbkxlbmd0aCA+IHRoaXMuY29sdW1uSGVhZGVycy5sZW5ndGgpIHtcbiAgICAgICAgZm9yICh2YXIgaSRfXzUgPSB0aGlzLmNvbHVtbkhlYWRlcnMubGVuZ3RoOyBpJF9fNSA8IHRoZWFkQ2hpbGRyZW5MZW5ndGg7IGkkX181KyspIHtcbiAgICAgICAgICB0aGlzLlRIRUFELnJlbW92ZUNoaWxkKHRoaXMuVEhFQUQubGFzdENoaWxkKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoVFIpIHtcbiAgICAgIGVtcHR5KFRSKTtcbiAgICB9XG4gIH0sXG4gIGdldFRyRm9yQ29sdW1uSGVhZGVyczogZnVuY3Rpb24oaW5kZXgpIHtcbiAgICByZXR1cm4gdGhpcy5USEVBRC5jaGlsZE5vZGVzW2luZGV4XTtcbiAgfSxcbiAgcmVuZGVyQ29sdW1uSGVhZGVyOiBmdW5jdGlvbihyb3csIGNvbCwgVEgpIHtcbiAgICBUSC5jbGFzc05hbWUgPSAnJztcbiAgICBUSC5yZW1vdmVBdHRyaWJ1dGUoJ3N0eWxlJyk7XG4gICAgcmV0dXJuIHRoaXMuY29sdW1uSGVhZGVyc1tyb3ddKGNvbCwgVEgsIHJvdyk7XG4gIH0sXG4gIGFkanVzdENvbHVtbnM6IGZ1bmN0aW9uKFRSLCBkZXNpcmVkQ291bnQpIHtcbiAgICB2YXIgY291bnQgPSBUUi5jaGlsZE5vZGVzLmxlbmd0aDtcbiAgICB3aGlsZSAoY291bnQgPCBkZXNpcmVkQ291bnQpIHtcbiAgICAgIHZhciBURCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ1REJyk7XG4gICAgICBUUi5hcHBlbmRDaGlsZChURCk7XG4gICAgICBjb3VudCsrO1xuICAgIH1cbiAgICB3aGlsZSAoY291bnQgPiBkZXNpcmVkQ291bnQpIHtcbiAgICAgIFRSLnJlbW92ZUNoaWxkKFRSLmxhc3RDaGlsZCk7XG4gICAgICBjb3VudC0tO1xuICAgIH1cbiAgfSxcbiAgcmVtb3ZlUmVkdW5kYW50Q29sdW1uczogZnVuY3Rpb24oY29sdW1uc1RvUmVuZGVyKSB7XG4gICAgd2hpbGUgKHRoaXMud3RUYWJsZS50Ym9keUNoaWxkcmVuTGVuZ3RoID4gY29sdW1uc1RvUmVuZGVyKSB7XG4gICAgICB0aGlzLlRCT0RZLnJlbW92ZUNoaWxkKHRoaXMuVEJPRFkubGFzdENoaWxkKTtcbiAgICAgIHRoaXMud3RUYWJsZS50Ym9keUNoaWxkcmVuTGVuZ3RoLS07XG4gICAgfVxuICB9XG59LCB7fSk7XG5mdW5jdGlvbiByZXBsYWNlVGRXaXRoVGgoVEQsIFRSKSB7XG4gIHZhciBUSCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ1RIJyk7XG4gIFRSLmluc2VydEJlZm9yZShUSCwgVEQpO1xuICBUUi5yZW1vdmVDaGlsZChURCk7XG4gIHJldHVybiBUSDtcbn1cbmZ1bmN0aW9uIHJlcGxhY2VUaFdpdGhUZChUSCwgVFIpIHtcbiAgdmFyIFREID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnVEQnKTtcbiAgVFIuaW5zZXJ0QmVmb3JlKFRELCBUSCk7XG4gIFRSLnJlbW92ZUNoaWxkKFRIKTtcbiAgcmV0dXJuIFREO1xufVxuO1xud2luZG93LldhbGtvbnRhYmxlVGFibGVSZW5kZXJlciA9IFdhbGtvbnRhYmxlVGFibGVSZW5kZXJlcjtcblxuLy8jIFxufSx7XCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDd9XSwyMzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgV2Fsa29udGFibGVWaWV3cG9ydDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gV2Fsa29udGFibGVWaWV3cG9ydDtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fLFxuICAgICRfX2NhbGN1bGF0b3JfNDdfdmlld3BvcnRDb2x1bW5zX18sXG4gICAgJF9fY2FsY3VsYXRvcl80N192aWV3cG9ydFJvd3NfXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgJF9fMSA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSksXG4gICAgZ2V0U2Nyb2xsYmFyV2lkdGggPSAkX18xLmdldFNjcm9sbGJhcldpZHRoLFxuICAgIGdldFNjcm9sbFRvcCA9ICRfXzEuZ2V0U2Nyb2xsVG9wLFxuICAgIGdldFN0eWxlID0gJF9fMS5nZXRTdHlsZSxcbiAgICBvZmZzZXQgPSAkX18xLm9mZnNldCxcbiAgICBvdXRlckhlaWdodCA9ICRfXzEub3V0ZXJIZWlnaHQsXG4gICAgb3V0ZXJXaWR0aCA9ICRfXzEub3V0ZXJXaWR0aDtcbnZhciBvYmplY3RFYWNoID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gPSBfZGVyZXFfKFwiaGVscGVycy9vYmplY3RcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X199KS5vYmplY3RFYWNoO1xudmFyIEV2ZW50TWFuYWdlciA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyA9IF9kZXJlcV8oXCJldmVudE1hbmFnZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9ffSkuRXZlbnRNYW5hZ2VyO1xudmFyIFdhbGtvbnRhYmxlVmlld3BvcnRDb2x1bW5zQ2FsY3VsYXRvciA9ICgkX19jYWxjdWxhdG9yXzQ3X3ZpZXdwb3J0Q29sdW1uc19fID0gX2RlcmVxXyhcImNhbGN1bGF0b3Ivdmlld3BvcnRDb2x1bW5zXCIpLCAkX19jYWxjdWxhdG9yXzQ3X3ZpZXdwb3J0Q29sdW1uc19fICYmICRfX2NhbGN1bGF0b3JfNDdfdmlld3BvcnRDb2x1bW5zX18uX19lc01vZHVsZSAmJiAkX19jYWxjdWxhdG9yXzQ3X3ZpZXdwb3J0Q29sdW1uc19fIHx8IHtkZWZhdWx0OiAkX19jYWxjdWxhdG9yXzQ3X3ZpZXdwb3J0Q29sdW1uc19ffSkuV2Fsa29udGFibGVWaWV3cG9ydENvbHVtbnNDYWxjdWxhdG9yO1xudmFyIFdhbGtvbnRhYmxlVmlld3BvcnRSb3dzQ2FsY3VsYXRvciA9ICgkX19jYWxjdWxhdG9yXzQ3X3ZpZXdwb3J0Um93c19fID0gX2RlcmVxXyhcImNhbGN1bGF0b3Ivdmlld3BvcnRSb3dzXCIpLCAkX19jYWxjdWxhdG9yXzQ3X3ZpZXdwb3J0Um93c19fICYmICRfX2NhbGN1bGF0b3JfNDdfdmlld3BvcnRSb3dzX18uX19lc01vZHVsZSAmJiAkX19jYWxjdWxhdG9yXzQ3X3ZpZXdwb3J0Um93c19fIHx8IHtkZWZhdWx0OiAkX19jYWxjdWxhdG9yXzQ3X3ZpZXdwb3J0Um93c19ffSkuV2Fsa29udGFibGVWaWV3cG9ydFJvd3NDYWxjdWxhdG9yO1xudmFyIFdhbGtvbnRhYmxlVmlld3BvcnQgPSBmdW5jdGlvbiBXYWxrb250YWJsZVZpZXdwb3J0KHdvdEluc3RhbmNlKSB7XG4gIHZhciAkX182ID0gdGhpcztcbiAgdGhpcy53b3QgPSB3b3RJbnN0YW5jZTtcbiAgdGhpcy5pbnN0YW5jZSA9IHRoaXMud290O1xuICB0aGlzLm92ZXJzaXplZFJvd3MgPSBbXTtcbiAgdGhpcy5vdmVyc2l6ZWRDb2x1bW5IZWFkZXJzID0gW107XG4gIHRoaXMuaGFzT3ZlcnNpemVkQ29sdW1uSGVhZGVyc01hcmtlZCA9IHt9O1xuICB0aGlzLmNsaWVudEhlaWdodCA9IDA7XG4gIHRoaXMuY29udGFpbmVyV2lkdGggPSBOYU47XG4gIHRoaXMucm93SGVhZGVyV2lkdGggPSBOYU47XG4gIHRoaXMucm93c1Zpc2libGVDYWxjdWxhdG9yID0gbnVsbDtcbiAgdGhpcy5jb2x1bW5zVmlzaWJsZUNhbGN1bGF0b3IgPSBudWxsO1xuICB0aGlzLmV2ZW50TWFuYWdlciA9IG5ldyBFdmVudE1hbmFnZXIodGhpcy53b3QpO1xuICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKHdpbmRvdywgJ3Jlc2l6ZScsIChmdW5jdGlvbigpIHtcbiAgICAkX182LmNsaWVudEhlaWdodCA9ICRfXzYuZ2V0V29ya3NwYWNlSGVpZ2h0KCk7XG4gIH0pKTtcbn07XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShXYWxrb250YWJsZVZpZXdwb3J0LCB7XG4gIGdldFdvcmtzcGFjZUhlaWdodDogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHRyaW1taW5nQ29udGFpbmVyID0gdGhpcy5pbnN0YW5jZS53dE92ZXJsYXlzLnRvcE92ZXJsYXkudHJpbW1pbmdDb250YWluZXI7XG4gICAgdmFyIGVsZW1IZWlnaHQ7XG4gICAgdmFyIGhlaWdodCA9IDA7XG4gICAgaWYgKHRyaW1taW5nQ29udGFpbmVyID09PSB3aW5kb3cpIHtcbiAgICAgIGhlaWdodCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsZW1IZWlnaHQgPSBvdXRlckhlaWdodCh0cmltbWluZ0NvbnRhaW5lcik7XG4gICAgICBoZWlnaHQgPSAoZWxlbUhlaWdodCA+IDAgJiYgdHJpbW1pbmdDb250YWluZXIuY2xpZW50SGVpZ2h0ID4gMCkgPyB0cmltbWluZ0NvbnRhaW5lci5jbGllbnRIZWlnaHQgOiBJbmZpbml0eTtcbiAgICB9XG4gICAgcmV0dXJuIGhlaWdodDtcbiAgfSxcbiAgZ2V0V29ya3NwYWNlV2lkdGg6IGZ1bmN0aW9uKCkge1xuICAgIHZhciB3aWR0aDtcbiAgICB2YXIgdG90YWxDb2x1bW5zID0gdGhpcy53b3QuZ2V0U2V0dGluZygndG90YWxDb2x1bW5zJyk7XG4gICAgdmFyIHRyaW1taW5nQ29udGFpbmVyID0gdGhpcy5pbnN0YW5jZS53dE92ZXJsYXlzLmxlZnRPdmVybGF5LnRyaW1taW5nQ29udGFpbmVyO1xuICAgIHZhciBvdmVyZmxvdztcbiAgICB2YXIgc3RyZXRjaFNldHRpbmcgPSB0aGlzLndvdC5nZXRTZXR0aW5nKCdzdHJldGNoSCcpO1xuICAgIHZhciBkb2NPZmZzZXRXaWR0aCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5vZmZzZXRXaWR0aDtcbiAgICB2YXIgcHJldmVudE92ZXJmbG93ID0gdGhpcy53b3QuZ2V0U2V0dGluZygncHJldmVudE92ZXJmbG93Jyk7XG4gICAgaWYgKHByZXZlbnRPdmVyZmxvdykge1xuICAgICAgcmV0dXJuIG91dGVyV2lkdGgodGhpcy5pbnN0YW5jZS53dFRhYmxlLnd0Um9vdEVsZW1lbnQpO1xuICAgIH1cbiAgICBpZiAoSGFuZHNvbnRhYmxlLmZyZWV6ZU92ZXJsYXlzKSB7XG4gICAgICB3aWR0aCA9IE1hdGgubWluKGRvY09mZnNldFdpZHRoIC0gdGhpcy5nZXRXb3Jrc3BhY2VPZmZzZXQoKS5sZWZ0LCBkb2NPZmZzZXRXaWR0aCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdpZHRoID0gTWF0aC5taW4odGhpcy5nZXRDb250YWluZXJGaWxsV2lkdGgoKSwgZG9jT2Zmc2V0V2lkdGggLSB0aGlzLmdldFdvcmtzcGFjZU9mZnNldCgpLmxlZnQsIGRvY09mZnNldFdpZHRoKTtcbiAgICB9XG4gICAgaWYgKHRyaW1taW5nQ29udGFpbmVyID09PSB3aW5kb3cgJiYgdG90YWxDb2x1bW5zID4gMCAmJiB0aGlzLnN1bUNvbHVtbldpZHRocygwLCB0b3RhbENvbHVtbnMgLSAxKSA+IHdpZHRoKSB7XG4gICAgICByZXR1cm4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoO1xuICAgIH1cbiAgICBpZiAodHJpbW1pbmdDb250YWluZXIgIT09IHdpbmRvdykge1xuICAgICAgb3ZlcmZsb3cgPSBnZXRTdHlsZSh0aGlzLmluc3RhbmNlLnd0T3ZlcmxheXMubGVmdE92ZXJsYXkudHJpbW1pbmdDb250YWluZXIsICdvdmVyZmxvdycpO1xuICAgICAgaWYgKG92ZXJmbG93ID09ICdzY3JvbGwnIHx8IG92ZXJmbG93ID09ICdoaWRkZW4nIHx8IG92ZXJmbG93ID09ICdhdXRvJykge1xuICAgICAgICByZXR1cm4gTWF0aC5tYXgod2lkdGgsIHRyaW1taW5nQ29udGFpbmVyLmNsaWVudFdpZHRoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHN0cmV0Y2hTZXR0aW5nID09PSAnbm9uZScgfHwgIXN0cmV0Y2hTZXR0aW5nKSB7XG4gICAgICByZXR1cm4gTWF0aC5tYXgod2lkdGgsIG91dGVyV2lkdGgodGhpcy5pbnN0YW5jZS53dFRhYmxlLlRBQkxFKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB3aWR0aDtcbiAgICB9XG4gIH0sXG4gIGhhc1ZlcnRpY2FsU2Nyb2xsOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRXb3Jrc3BhY2VBY3R1YWxIZWlnaHQoKSA+IHRoaXMuZ2V0V29ya3NwYWNlSGVpZ2h0KCk7XG4gIH0sXG4gIGhhc0hvcml6b250YWxTY3JvbGw6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmdldFdvcmtzcGFjZUFjdHVhbFdpZHRoKCkgPiB0aGlzLmdldFdvcmtzcGFjZVdpZHRoKCk7XG4gIH0sXG4gIHN1bUNvbHVtbldpZHRoczogZnVuY3Rpb24oZnJvbSwgbGVuZ3RoKSB7XG4gICAgdmFyIHN1bSA9IDA7XG4gICAgd2hpbGUgKGZyb20gPCBsZW5ndGgpIHtcbiAgICAgIHN1bSArPSB0aGlzLndvdC53dFRhYmxlLmdldENvbHVtbldpZHRoKGZyb20pO1xuICAgICAgZnJvbSsrO1xuICAgIH1cbiAgICByZXR1cm4gc3VtO1xuICB9LFxuICBnZXRDb250YWluZXJGaWxsV2lkdGg6IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLmNvbnRhaW5lcldpZHRoKSB7XG4gICAgICByZXR1cm4gdGhpcy5jb250YWluZXJXaWR0aDtcbiAgICB9XG4gICAgdmFyIG1haW5Db250YWluZXIgPSB0aGlzLmluc3RhbmNlLnd0VGFibGUuaG9sZGVyO1xuICAgIHZhciBmaWxsV2lkdGg7XG4gICAgdmFyIGR1bW15RWxlbWVudDtcbiAgICBkdW1teUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBkdW1teUVsZW1lbnQuc3R5bGUud2lkdGggPSAnMTAwJSc7XG4gICAgZHVtbXlFbGVtZW50LnN0eWxlLmhlaWdodCA9ICcxcHgnO1xuICAgIG1haW5Db250YWluZXIuYXBwZW5kQ2hpbGQoZHVtbXlFbGVtZW50KTtcbiAgICBmaWxsV2lkdGggPSBkdW1teUVsZW1lbnQub2Zmc2V0V2lkdGg7XG4gICAgdGhpcy5jb250YWluZXJXaWR0aCA9IGZpbGxXaWR0aDtcbiAgICBtYWluQ29udGFpbmVyLnJlbW92ZUNoaWxkKGR1bW15RWxlbWVudCk7XG4gICAgcmV0dXJuIGZpbGxXaWR0aDtcbiAgfSxcbiAgZ2V0V29ya3NwYWNlT2Zmc2V0OiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gb2Zmc2V0KHRoaXMud290Lnd0VGFibGUuVEFCTEUpO1xuICB9LFxuICBnZXRXb3Jrc3BhY2VBY3R1YWxIZWlnaHQ6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBvdXRlckhlaWdodCh0aGlzLndvdC53dFRhYmxlLlRBQkxFKTtcbiAgfSxcbiAgZ2V0V29ya3NwYWNlQWN0dWFsV2lkdGg6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBvdXRlcldpZHRoKHRoaXMud290Lnd0VGFibGUuVEFCTEUpIHx8IG91dGVyV2lkdGgodGhpcy53b3Qud3RUYWJsZS5UQk9EWSkgfHwgb3V0ZXJXaWR0aCh0aGlzLndvdC53dFRhYmxlLlRIRUFEKTtcbiAgfSxcbiAgZ2V0Q29sdW1uSGVhZGVySGVpZ2h0OiBmdW5jdGlvbigpIHtcbiAgICBpZiAoaXNOYU4odGhpcy5jb2x1bW5IZWFkZXJIZWlnaHQpKSB7XG4gICAgICB0aGlzLmNvbHVtbkhlYWRlckhlaWdodCA9IG91dGVySGVpZ2h0KHRoaXMud290Lnd0VGFibGUuVEhFQUQpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5jb2x1bW5IZWFkZXJIZWlnaHQ7XG4gIH0sXG4gIGdldFZpZXdwb3J0SGVpZ2h0OiBmdW5jdGlvbigpIHtcbiAgICB2YXIgY29udGFpbmVySGVpZ2h0ID0gdGhpcy5nZXRXb3Jrc3BhY2VIZWlnaHQoKTtcbiAgICB2YXIgY29sdW1uSGVhZGVySGVpZ2h0O1xuICAgIGlmIChjb250YWluZXJIZWlnaHQgPT09IEluZmluaXR5KSB7XG4gICAgICByZXR1cm4gY29udGFpbmVySGVpZ2h0O1xuICAgIH1cbiAgICBjb2x1bW5IZWFkZXJIZWlnaHQgPSB0aGlzLmdldENvbHVtbkhlYWRlckhlaWdodCgpO1xuICAgIGlmIChjb2x1bW5IZWFkZXJIZWlnaHQgPiAwKSB7XG4gICAgICBjb250YWluZXJIZWlnaHQgLT0gY29sdW1uSGVhZGVySGVpZ2h0O1xuICAgIH1cbiAgICByZXR1cm4gY29udGFpbmVySGVpZ2h0O1xuICB9LFxuICBnZXRSb3dIZWFkZXJXaWR0aDogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHJvd0hlYWRlcnNIZWlnaHRTZXR0aW5nID0gdGhpcy5pbnN0YW5jZS5nZXRTZXR0aW5nKCdyb3dIZWFkZXJXaWR0aCcpO1xuICAgIHZhciByb3dIZWFkZXJzID0gdGhpcy5pbnN0YW5jZS5nZXRTZXR0aW5nKCdyb3dIZWFkZXJzJyk7XG4gICAgaWYgKHJvd0hlYWRlcnNIZWlnaHRTZXR0aW5nKSB7XG4gICAgICB0aGlzLnJvd0hlYWRlcldpZHRoID0gMDtcbiAgICAgIGZvciAodmFyIGkgPSAwLFxuICAgICAgICAgIGxlbiA9IHJvd0hlYWRlcnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgdGhpcy5yb3dIZWFkZXJXaWR0aCArPSByb3dIZWFkZXJzSGVpZ2h0U2V0dGluZ1tpXSB8fCByb3dIZWFkZXJzSGVpZ2h0U2V0dGluZztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHRoaXMud290LmNsb25lU291cmNlKSB7XG4gICAgICByZXR1cm4gdGhpcy53b3QuY2xvbmVTb3VyY2Uud3RWaWV3cG9ydC5nZXRSb3dIZWFkZXJXaWR0aCgpO1xuICAgIH1cbiAgICBpZiAoaXNOYU4odGhpcy5yb3dIZWFkZXJXaWR0aCkpIHtcbiAgICAgIGlmIChyb3dIZWFkZXJzLmxlbmd0aCkge1xuICAgICAgICB2YXIgVEggPSB0aGlzLmluc3RhbmNlLnd0VGFibGUuVEFCTEUucXVlcnlTZWxlY3RvcignVEgnKTtcbiAgICAgICAgdGhpcy5yb3dIZWFkZXJXaWR0aCA9IDA7XG4gICAgICAgIGZvciAodmFyIGkkX184ID0gMCxcbiAgICAgICAgICAgIGxlbiRfXzkgPSByb3dIZWFkZXJzLmxlbmd0aDsgaSRfXzggPCBsZW4kX185OyBpJF9fOCsrKSB7XG4gICAgICAgICAgaWYgKFRIKSB7XG4gICAgICAgICAgICB0aGlzLnJvd0hlYWRlcldpZHRoICs9IG91dGVyV2lkdGgoVEgpO1xuICAgICAgICAgICAgVEggPSBUSC5uZXh0U2libGluZztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5yb3dIZWFkZXJXaWR0aCArPSA1MDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucm93SGVhZGVyV2lkdGggPSAwO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLnJvd0hlYWRlcldpZHRoID0gdGhpcy5pbnN0YW5jZS5nZXRTZXR0aW5nKCdvbk1vZGlmeVJvd0hlYWRlcldpZHRoJywgdGhpcy5yb3dIZWFkZXJXaWR0aCkgfHwgdGhpcy5yb3dIZWFkZXJXaWR0aDtcbiAgICByZXR1cm4gdGhpcy5yb3dIZWFkZXJXaWR0aDtcbiAgfSxcbiAgZ2V0Vmlld3BvcnRXaWR0aDogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNvbnRhaW5lcldpZHRoID0gdGhpcy5nZXRXb3Jrc3BhY2VXaWR0aCgpO1xuICAgIHZhciByb3dIZWFkZXJXaWR0aDtcbiAgICBpZiAoY29udGFpbmVyV2lkdGggPT09IEluZmluaXR5KSB7XG4gICAgICByZXR1cm4gY29udGFpbmVyV2lkdGg7XG4gICAgfVxuICAgIHJvd0hlYWRlcldpZHRoID0gdGhpcy5nZXRSb3dIZWFkZXJXaWR0aCgpO1xuICAgIGlmIChyb3dIZWFkZXJXaWR0aCA+IDApIHtcbiAgICAgIHJldHVybiBjb250YWluZXJXaWR0aCAtIHJvd0hlYWRlcldpZHRoO1xuICAgIH1cbiAgICByZXR1cm4gY29udGFpbmVyV2lkdGg7XG4gIH0sXG4gIGNyZWF0ZVJvd3NDYWxjdWxhdG9yOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgdmlzaWJsZSA9IGFyZ3VtZW50c1swXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTtcbiAgICB2YXIgJF9fNiA9IHRoaXM7XG4gICAgdmFyIGhlaWdodDtcbiAgICB2YXIgcG9zO1xuICAgIHZhciBmaXhlZFJvd3NUb3A7XG4gICAgdmFyIHNjcm9sbGJhckhlaWdodDtcbiAgICB2YXIgZml4ZWRSb3dzQm90dG9tO1xuICAgIHZhciBmaXhlZFJvd3NIZWlnaHQ7XG4gICAgdmFyIHRvdGFsUm93cztcbiAgICB0aGlzLnJvd0hlYWRlcldpZHRoID0gTmFOO1xuICAgIGlmICh0aGlzLndvdC53dFNldHRpbmdzLnNldHRpbmdzLnJlbmRlckFsbFJvd3MpIHtcbiAgICAgIGhlaWdodCA9IEluZmluaXR5O1xuICAgIH0gZWxzZSB7XG4gICAgICBoZWlnaHQgPSB0aGlzLmdldFZpZXdwb3J0SGVpZ2h0KCk7XG4gICAgfVxuICAgIHBvcyA9IHRoaXMud290Lnd0T3ZlcmxheXMudG9wT3ZlcmxheS5nZXRTY3JvbGxQb3NpdGlvbigpIC0gdGhpcy53b3Qud3RPdmVybGF5cy50b3BPdmVybGF5LmdldFRhYmxlUGFyZW50T2Zmc2V0KCk7XG4gICAgaWYgKHBvcyA8IDApIHtcbiAgICAgIHBvcyA9IDA7XG4gICAgfVxuICAgIGZpeGVkUm93c1RvcCA9IHRoaXMud290LmdldFNldHRpbmcoJ2ZpeGVkUm93c1RvcCcpO1xuICAgIGZpeGVkUm93c0JvdHRvbSA9IHRoaXMud290LmdldFNldHRpbmcoJ2ZpeGVkUm93c0JvdHRvbScpO1xuICAgIHRvdGFsUm93cyA9IHRoaXMud290LmdldFNldHRpbmcoJ3RvdGFsUm93cycpO1xuICAgIGlmIChmaXhlZFJvd3NUb3ApIHtcbiAgICAgIGZpeGVkUm93c0hlaWdodCA9IHRoaXMud290Lnd0T3ZlcmxheXMudG9wT3ZlcmxheS5zdW1DZWxsU2l6ZXMoMCwgZml4ZWRSb3dzVG9wKTtcbiAgICAgIHBvcyArPSBmaXhlZFJvd3NIZWlnaHQ7XG4gICAgICBoZWlnaHQgLT0gZml4ZWRSb3dzSGVpZ2h0O1xuICAgIH1cbiAgICBpZiAoZml4ZWRSb3dzQm90dG9tICYmIHRoaXMud290Lnd0T3ZlcmxheXMuYm90dG9tT3ZlcmxheS5jbG9uZSkge1xuICAgICAgZml4ZWRSb3dzSGVpZ2h0ID0gdGhpcy53b3Qud3RPdmVybGF5cy5ib3R0b21PdmVybGF5LnN1bUNlbGxTaXplcyh0b3RhbFJvd3MgLSBmaXhlZFJvd3NCb3R0b20sIHRvdGFsUm93cyk7XG4gICAgICBoZWlnaHQgLT0gZml4ZWRSb3dzSGVpZ2h0O1xuICAgIH1cbiAgICBpZiAodGhpcy53b3Qud3RUYWJsZS5ob2xkZXIuY2xpZW50SGVpZ2h0ID09PSB0aGlzLndvdC53dFRhYmxlLmhvbGRlci5vZmZzZXRIZWlnaHQpIHtcbiAgICAgIHNjcm9sbGJhckhlaWdodCA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNjcm9sbGJhckhlaWdodCA9IGdldFNjcm9sbGJhcldpZHRoKCk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgV2Fsa29udGFibGVWaWV3cG9ydFJvd3NDYWxjdWxhdG9yKGhlaWdodCwgcG9zLCB0aGlzLndvdC5nZXRTZXR0aW5nKCd0b3RhbFJvd3MnKSwgKGZ1bmN0aW9uKHNvdXJjZVJvdykge1xuICAgICAgcmV0dXJuICRfXzYud290Lnd0VGFibGUuZ2V0Um93SGVpZ2h0KHNvdXJjZVJvdyk7XG4gICAgfSksIHZpc2libGUgPyBudWxsIDogdGhpcy53b3Qud3RTZXR0aW5ncy5zZXR0aW5ncy52aWV3cG9ydFJvd0NhbGN1bGF0b3JPdmVycmlkZSwgdmlzaWJsZSwgc2Nyb2xsYmFySGVpZ2h0KTtcbiAgfSxcbiAgY3JlYXRlQ29sdW1uc0NhbGN1bGF0b3I6IGZ1bmN0aW9uKCkge1xuICAgIHZhciB2aXNpYmxlID0gYXJndW1lbnRzWzBdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1swXSA6IGZhbHNlO1xuICAgIHZhciAkX182ID0gdGhpcztcbiAgICB2YXIgd2lkdGggPSB0aGlzLmdldFZpZXdwb3J0V2lkdGgoKTtcbiAgICB2YXIgcG9zO1xuICAgIHZhciBmaXhlZENvbHVtbnNMZWZ0O1xuICAgIHRoaXMuY29sdW1uSGVhZGVySGVpZ2h0ID0gTmFOO1xuICAgIHBvcyA9IHRoaXMud290Lnd0T3ZlcmxheXMubGVmdE92ZXJsYXkuZ2V0U2Nyb2xsUG9zaXRpb24oKSAtIHRoaXMud290Lnd0T3ZlcmxheXMubGVmdE92ZXJsYXkuZ2V0VGFibGVQYXJlbnRPZmZzZXQoKTtcbiAgICBpZiAocG9zIDwgMCkge1xuICAgICAgcG9zID0gMDtcbiAgICB9XG4gICAgZml4ZWRDb2x1bW5zTGVmdCA9IHRoaXMud290LmdldFNldHRpbmcoJ2ZpeGVkQ29sdW1uc0xlZnQnKTtcbiAgICBpZiAoZml4ZWRDb2x1bW5zTGVmdCkge1xuICAgICAgdmFyIGZpeGVkQ29sdW1uc1dpZHRoID0gdGhpcy53b3Qud3RPdmVybGF5cy5sZWZ0T3ZlcmxheS5zdW1DZWxsU2l6ZXMoMCwgZml4ZWRDb2x1bW5zTGVmdCk7XG4gICAgICBwb3MgKz0gZml4ZWRDb2x1bW5zV2lkdGg7XG4gICAgICB3aWR0aCAtPSBmaXhlZENvbHVtbnNXaWR0aDtcbiAgICB9XG4gICAgaWYgKHRoaXMud290Lnd0VGFibGUuaG9sZGVyLmNsaWVudFdpZHRoICE9PSB0aGlzLndvdC53dFRhYmxlLmhvbGRlci5vZmZzZXRXaWR0aCkge1xuICAgICAgd2lkdGggLT0gZ2V0U2Nyb2xsYmFyV2lkdGgoKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBXYWxrb250YWJsZVZpZXdwb3J0Q29sdW1uc0NhbGN1bGF0b3Iod2lkdGgsIHBvcywgdGhpcy53b3QuZ2V0U2V0dGluZygndG90YWxDb2x1bW5zJyksIChmdW5jdGlvbihzb3VyY2VDb2wpIHtcbiAgICAgIHJldHVybiAkX182LndvdC53dFRhYmxlLmdldENvbHVtbldpZHRoKHNvdXJjZUNvbCk7XG4gICAgfSksIHZpc2libGUgPyBudWxsIDogdGhpcy53b3Qud3RTZXR0aW5ncy5zZXR0aW5ncy52aWV3cG9ydENvbHVtbkNhbGN1bGF0b3JPdmVycmlkZSwgdmlzaWJsZSwgdGhpcy53b3QuZ2V0U2V0dGluZygnc3RyZXRjaEgnKSwgKGZ1bmN0aW9uKHN0cmV0Y2hlZFdpZHRoLCBjb2x1bW4pIHtcbiAgICAgIHJldHVybiAkX182LndvdC5nZXRTZXR0aW5nKCdvbkJlZm9yZVN0cmV0Y2hpbmdDb2x1bW5XaWR0aCcsIHN0cmV0Y2hlZFdpZHRoLCBjb2x1bW4pO1xuICAgIH0pKTtcbiAgfSxcbiAgY3JlYXRlUmVuZGVyQ2FsY3VsYXRvcnM6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBmYXN0RHJhdyA9IGFyZ3VtZW50c1swXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTtcbiAgICBpZiAoZmFzdERyYXcpIHtcbiAgICAgIHZhciBwcm9wb3NlZFJvd3NWaXNpYmxlQ2FsY3VsYXRvciA9IHRoaXMuY3JlYXRlUm93c0NhbGN1bGF0b3IodHJ1ZSk7XG4gICAgICB2YXIgcHJvcG9zZWRDb2x1bW5zVmlzaWJsZUNhbGN1bGF0b3IgPSB0aGlzLmNyZWF0ZUNvbHVtbnNDYWxjdWxhdG9yKHRydWUpO1xuICAgICAgaWYgKCEodGhpcy5hcmVBbGxQcm9wb3NlZFZpc2libGVSb3dzQWxyZWFkeVJlbmRlcmVkKHByb3Bvc2VkUm93c1Zpc2libGVDYWxjdWxhdG9yKSAmJiB0aGlzLmFyZUFsbFByb3Bvc2VkVmlzaWJsZUNvbHVtbnNBbHJlYWR5UmVuZGVyZWQocHJvcG9zZWRDb2x1bW5zVmlzaWJsZUNhbGN1bGF0b3IpKSkge1xuICAgICAgICBmYXN0RHJhdyA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIWZhc3REcmF3KSB7XG4gICAgICB0aGlzLnJvd3NSZW5kZXJDYWxjdWxhdG9yID0gdGhpcy5jcmVhdGVSb3dzQ2FsY3VsYXRvcigpO1xuICAgICAgdGhpcy5jb2x1bW5zUmVuZGVyQ2FsY3VsYXRvciA9IHRoaXMuY3JlYXRlQ29sdW1uc0NhbGN1bGF0b3IoKTtcbiAgICB9XG4gICAgdGhpcy5yb3dzVmlzaWJsZUNhbGN1bGF0b3IgPSBudWxsO1xuICAgIHRoaXMuY29sdW1uc1Zpc2libGVDYWxjdWxhdG9yID0gbnVsbDtcbiAgICByZXR1cm4gZmFzdERyYXc7XG4gIH0sXG4gIGNyZWF0ZVZpc2libGVDYWxjdWxhdG9yczogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5yb3dzVmlzaWJsZUNhbGN1bGF0b3IgPSB0aGlzLmNyZWF0ZVJvd3NDYWxjdWxhdG9yKHRydWUpO1xuICAgIHRoaXMuY29sdW1uc1Zpc2libGVDYWxjdWxhdG9yID0gdGhpcy5jcmVhdGVDb2x1bW5zQ2FsY3VsYXRvcih0cnVlKTtcbiAgfSxcbiAgYXJlQWxsUHJvcG9zZWRWaXNpYmxlUm93c0FscmVhZHlSZW5kZXJlZDogZnVuY3Rpb24ocHJvcG9zZWRSb3dzVmlzaWJsZUNhbGN1bGF0b3IpIHtcbiAgICBpZiAodGhpcy5yb3dzVmlzaWJsZUNhbGN1bGF0b3IpIHtcbiAgICAgIGlmIChwcm9wb3NlZFJvd3NWaXNpYmxlQ2FsY3VsYXRvci5zdGFydFJvdyA8IHRoaXMucm93c1JlbmRlckNhbGN1bGF0b3Iuc3RhcnRSb3cgfHwgKHByb3Bvc2VkUm93c1Zpc2libGVDYWxjdWxhdG9yLnN0YXJ0Um93ID09PSB0aGlzLnJvd3NSZW5kZXJDYWxjdWxhdG9yLnN0YXJ0Um93ICYmIHByb3Bvc2VkUm93c1Zpc2libGVDYWxjdWxhdG9yLnN0YXJ0Um93ID4gMCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSBlbHNlIGlmIChwcm9wb3NlZFJvd3NWaXNpYmxlQ2FsY3VsYXRvci5lbmRSb3cgPiB0aGlzLnJvd3NSZW5kZXJDYWxjdWxhdG9yLmVuZFJvdyB8fCAocHJvcG9zZWRSb3dzVmlzaWJsZUNhbGN1bGF0b3IuZW5kUm93ID09PSB0aGlzLnJvd3NSZW5kZXJDYWxjdWxhdG9yLmVuZFJvdyAmJiBwcm9wb3NlZFJvd3NWaXNpYmxlQ2FsY3VsYXRvci5lbmRSb3cgPCB0aGlzLndvdC5nZXRTZXR0aW5nKCd0b3RhbFJvd3MnKSAtIDEpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG4gIGFyZUFsbFByb3Bvc2VkVmlzaWJsZUNvbHVtbnNBbHJlYWR5UmVuZGVyZWQ6IGZ1bmN0aW9uKHByb3Bvc2VkQ29sdW1uc1Zpc2libGVDYWxjdWxhdG9yKSB7XG4gICAgaWYgKHRoaXMuY29sdW1uc1Zpc2libGVDYWxjdWxhdG9yKSB7XG4gICAgICBpZiAocHJvcG9zZWRDb2x1bW5zVmlzaWJsZUNhbGN1bGF0b3Iuc3RhcnRDb2x1bW4gPCB0aGlzLmNvbHVtbnNSZW5kZXJDYWxjdWxhdG9yLnN0YXJ0Q29sdW1uIHx8IChwcm9wb3NlZENvbHVtbnNWaXNpYmxlQ2FsY3VsYXRvci5zdGFydENvbHVtbiA9PT0gdGhpcy5jb2x1bW5zUmVuZGVyQ2FsY3VsYXRvci5zdGFydENvbHVtbiAmJiBwcm9wb3NlZENvbHVtbnNWaXNpYmxlQ2FsY3VsYXRvci5zdGFydENvbHVtbiA+IDApKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0gZWxzZSBpZiAocHJvcG9zZWRDb2x1bW5zVmlzaWJsZUNhbGN1bGF0b3IuZW5kQ29sdW1uID4gdGhpcy5jb2x1bW5zUmVuZGVyQ2FsY3VsYXRvci5lbmRDb2x1bW4gfHwgKHByb3Bvc2VkQ29sdW1uc1Zpc2libGVDYWxjdWxhdG9yLmVuZENvbHVtbiA9PT0gdGhpcy5jb2x1bW5zUmVuZGVyQ2FsY3VsYXRvci5lbmRDb2x1bW4gJiYgcHJvcG9zZWRDb2x1bW5zVmlzaWJsZUNhbGN1bGF0b3IuZW5kQ29sdW1uIDwgdGhpcy53b3QuZ2V0U2V0dGluZygndG90YWxDb2x1bW5zJykgLSAxKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuICByZXNldEhhc092ZXJzaXplZENvbHVtbkhlYWRlcnNNYXJrZWQ6IGZ1bmN0aW9uKCkge1xuICAgIG9iamVjdEVhY2godGhpcy5oYXNPdmVyc2l6ZWRDb2x1bW5IZWFkZXJzTWFya2VkLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBvYmplY3QpIHtcbiAgICAgIG9iamVjdFtrZXldID0gdm9pZCAwO1xuICAgIH0pO1xuICB9XG59LCB7fSk7XG47XG53aW5kb3cuV2Fsa29udGFibGVWaWV3cG9ydCA9IFdhbGtvbnRhYmxlVmlld3BvcnQ7XG5cbi8vIyBcbn0se1wiYnJvd3NlclwiOjI0LFwiY2FsY3VsYXRvci92aWV3cG9ydENvbHVtbnNcIjo0LFwiY2FsY3VsYXRvci92aWV3cG9ydFJvd3NcIjo1LFwiZXZlbnRNYW5hZ2VyXCI6NDIsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJoZWxwZXJzL29iamVjdFwiOjUzfV0sMjQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgJF9fc2hpbXNfNDdfcnVudGltZV9fLFxuICAgICRfX2VzNmNvbGxlY3Rpb25zX18sXG4gICAgJF9fcGx1Z2luSG9va3NfXyxcbiAgICAkX19udW1icm9fXyxcbiAgICAkX19tb21lbnRfXyxcbiAgICAkX19jb3JlX18sXG4gICAgJF9fcmVuZGVyZXJzXzQ3X185NV9jZWxsRGVjb3JhdG9yX18sXG4gICAgJF9fY2VsbFR5cGVzX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfcGx1Z2luc180N19qcXVlcnlIYW5kc29udGFibGVfXyxcbiAgICAkX19oZWxwZXJzXzQ3X2FycmF5X18sXG4gICAgJF9faGVscGVyc180N19icm93c2VyX18sXG4gICAgJF9faGVscGVyc180N19kYXRhX18sXG4gICAgJF9faGVscGVyc180N19kYXRlX18sXG4gICAgJF9faGVscGVyc180N19mZWF0dXJlX18sXG4gICAgJF9faGVscGVyc180N19mdW5jdGlvbl9fLFxuICAgICRfX2hlbHBlcnNfNDdfbWl4ZWRfXyxcbiAgICAkX19oZWxwZXJzXzQ3X251bWJlcl9fLFxuICAgICRfX2hlbHBlcnNfNDdfb2JqZWN0X18sXG4gICAgJF9faGVscGVyc180N19zZXR0aW5nX18sXG4gICAgJF9faGVscGVyc180N19zdHJpbmdfXyxcbiAgICAkX19oZWxwZXJzXzQ3X3VuaWNvZGVfXyxcbiAgICAkX19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9faGVscGVyc180N19kb21fNDdfZXZlbnRfXyxcbiAgICAkX19wbHVnaW5zX187XG5mdW5jdGlvbiBIYW5kc29udGFibGUocm9vdEVsZW1lbnQsIHVzZXJTZXR0aW5ncykge1xuICB2YXIgaW5zdGFuY2UgPSBuZXcgSGFuZHNvbnRhYmxlLkNvcmUocm9vdEVsZW1lbnQsIHVzZXJTZXR0aW5ncyB8fCB7fSk7XG4gIGluc3RhbmNlLmluaXQoKTtcbiAgcmV0dXJuIGluc3RhbmNlO1xufVxubW9kdWxlLmV4cG9ydHMgPSBIYW5kc29udGFibGU7XG5IYW5kc29udGFibGUudXRpbHMgPSB7fTtcbigkX19zaGltc180N19ydW50aW1lX18gPSBfZGVyZXFfKFwic2hpbXMvcnVudGltZVwiKSwgJF9fc2hpbXNfNDdfcnVudGltZV9fICYmICRfX3NoaW1zXzQ3X3J1bnRpbWVfXy5fX2VzTW9kdWxlICYmICRfX3NoaW1zXzQ3X3J1bnRpbWVfXyB8fCB7ZGVmYXVsdDogJF9fc2hpbXNfNDdfcnVudGltZV9ffSk7XG4oJF9fZXM2Y29sbGVjdGlvbnNfXyA9IF9kZXJlcV8oXCJlczZjb2xsZWN0aW9uc1wiKSwgJF9fZXM2Y29sbGVjdGlvbnNfXyAmJiAkX19lczZjb2xsZWN0aW9uc19fLl9fZXNNb2R1bGUgJiYgJF9fZXM2Y29sbGVjdGlvbnNfXyB8fCB7ZGVmYXVsdDogJF9fZXM2Y29sbGVjdGlvbnNfX30pO1xudmFyIEhvb2tzID0gKCRfX3BsdWdpbkhvb2tzX18gPSBfZGVyZXFfKFwicGx1Z2luSG9va3NcIiksICRfX3BsdWdpbkhvb2tzX18gJiYgJF9fcGx1Z2luSG9va3NfXy5fX2VzTW9kdWxlICYmICRfX3BsdWdpbkhvb2tzX18gfHwge2RlZmF1bHQ6ICRfX3BsdWdpbkhvb2tzX199KS5Ib29rcztcbnZhciBudW1icm8gPSAoJF9fbnVtYnJvX18gPSBfZGVyZXFfKFwibnVtYnJvXCIpLCAkX19udW1icm9fXyAmJiAkX19udW1icm9fXy5fX2VzTW9kdWxlICYmICRfX251bWJyb19fIHx8IHtkZWZhdWx0OiAkX19udW1icm9fX30pLmRlZmF1bHQ7XG52YXIgbW9tZW50ID0gKCRfX21vbWVudF9fID0gX2RlcmVxXyhcIm1vbWVudFwiKSwgJF9fbW9tZW50X18gJiYgJF9fbW9tZW50X18uX19lc01vZHVsZSAmJiAkX19tb21lbnRfXyB8fCB7ZGVmYXVsdDogJF9fbW9tZW50X199KS5kZWZhdWx0O1xuaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSB7XG4gIGlmICh0eXBlb2Ygd2luZG93Lm51bWJybyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICB3aW5kb3cubnVtYnJvID0gbnVtYnJvO1xuICB9XG4gIGlmICh0eXBlb2Ygd2luZG93Lm1vbWVudCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICB3aW5kb3cubW9tZW50ID0gbW9tZW50O1xuICB9XG59XG5pZiAoIUhhbmRzb250YWJsZS5ob29rcykge1xuICBIYW5kc29udGFibGUuaG9va3MgPSBuZXcgSG9va3MoKTtcbn1cbkhhbmRzb250YWJsZS51dGlscy5Ib29rcyA9IEhvb2tzO1xuKCRfX2NvcmVfXyA9IF9kZXJlcV8oXCJjb3JlXCIpLCAkX19jb3JlX18gJiYgJF9fY29yZV9fLl9fZXNNb2R1bGUgJiYgJF9fY29yZV9fIHx8IHtkZWZhdWx0OiAkX19jb3JlX199KTtcbigkX19yZW5kZXJlcnNfNDdfXzk1X2NlbGxEZWNvcmF0b3JfXyA9IF9kZXJlcV8oXCJyZW5kZXJlcnMvX2NlbGxEZWNvcmF0b3JcIiksICRfX3JlbmRlcmVyc180N19fOTVfY2VsbERlY29yYXRvcl9fICYmICRfX3JlbmRlcmVyc180N19fOTVfY2VsbERlY29yYXRvcl9fLl9fZXNNb2R1bGUgJiYgJF9fcmVuZGVyZXJzXzQ3X185NV9jZWxsRGVjb3JhdG9yX18gfHwge2RlZmF1bHQ6ICRfX3JlbmRlcmVyc180N19fOTVfY2VsbERlY29yYXRvcl9ffSk7XG4oJF9fY2VsbFR5cGVzX18gPSBfZGVyZXFfKFwiY2VsbFR5cGVzXCIpLCAkX19jZWxsVHlwZXNfXyAmJiAkX19jZWxsVHlwZXNfXy5fX2VzTW9kdWxlICYmICRfX2NlbGxUeXBlc19fIHx8IHtkZWZhdWx0OiAkX19jZWxsVHlwZXNfX30pO1xuKCRfX180Nl9fNDZfXzQ3X3BsdWdpbnNfNDdfanF1ZXJ5SGFuZHNvbnRhYmxlX18gPSBfZGVyZXFfKFwicGx1Z2lucy9qcXVlcnlIYW5kc29udGFibGVcIiksICRfX180Nl9fNDZfXzQ3X3BsdWdpbnNfNDdfanF1ZXJ5SGFuZHNvbnRhYmxlX18gJiYgJF9fXzQ2X180Nl9fNDdfcGx1Z2luc180N19qcXVlcnlIYW5kc29udGFibGVfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X3BsdWdpbnNfNDdfanF1ZXJ5SGFuZHNvbnRhYmxlX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X3BsdWdpbnNfNDdfanF1ZXJ5SGFuZHNvbnRhYmxlX199KTtcbnZhciBhcnJheUhlbHBlcnMgPSAoJF9faGVscGVyc180N19hcnJheV9fID0gX2RlcmVxXyhcImhlbHBlcnMvYXJyYXlcIiksICRfX2hlbHBlcnNfNDdfYXJyYXlfXyAmJiAkX19oZWxwZXJzXzQ3X2FycmF5X18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X2FycmF5X18gfHwge2RlZmF1bHQ6ICRfX2hlbHBlcnNfNDdfYXJyYXlfX30pO1xudmFyIGJyb3dzZXJIZWxwZXJzID0gKCRfX2hlbHBlcnNfNDdfYnJvd3Nlcl9fID0gX2RlcmVxXyhcImhlbHBlcnMvYnJvd3NlclwiKSwgJF9faGVscGVyc180N19icm93c2VyX18gJiYgJF9faGVscGVyc180N19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9faGVscGVyc180N19icm93c2VyX199KTtcbnZhciBkYXRhSGVscGVycyA9ICgkX19oZWxwZXJzXzQ3X2RhdGFfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RhdGFcIiksICRfX2hlbHBlcnNfNDdfZGF0YV9fICYmICRfX2hlbHBlcnNfNDdfZGF0YV9fLl9fZXNNb2R1bGUgJiYgJF9faGVscGVyc180N19kYXRhX18gfHwge2RlZmF1bHQ6ICRfX2hlbHBlcnNfNDdfZGF0YV9ffSk7XG52YXIgZGF0ZUhlbHBlcnMgPSAoJF9faGVscGVyc180N19kYXRlX18gPSBfZGVyZXFfKFwiaGVscGVycy9kYXRlXCIpLCAkX19oZWxwZXJzXzQ3X2RhdGVfXyAmJiAkX19oZWxwZXJzXzQ3X2RhdGVfXy5fX2VzTW9kdWxlICYmICRfX2hlbHBlcnNfNDdfZGF0ZV9fIHx8IHtkZWZhdWx0OiAkX19oZWxwZXJzXzQ3X2RhdGVfX30pO1xudmFyIGZlYXR1cmVIZWxwZXJzID0gKCRfX2hlbHBlcnNfNDdfZmVhdHVyZV9fID0gX2RlcmVxXyhcImhlbHBlcnMvZmVhdHVyZVwiKSwgJF9faGVscGVyc180N19mZWF0dXJlX18gJiYgJF9faGVscGVyc180N19mZWF0dXJlX18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X2ZlYXR1cmVfXyB8fCB7ZGVmYXVsdDogJF9faGVscGVyc180N19mZWF0dXJlX199KTtcbnZhciBmdW5jdGlvbkhlbHBlcnMgPSAoJF9faGVscGVyc180N19mdW5jdGlvbl9fID0gX2RlcmVxXyhcImhlbHBlcnMvZnVuY3Rpb25cIiksICRfX2hlbHBlcnNfNDdfZnVuY3Rpb25fXyAmJiAkX19oZWxwZXJzXzQ3X2Z1bmN0aW9uX18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X2Z1bmN0aW9uX18gfHwge2RlZmF1bHQ6ICRfX2hlbHBlcnNfNDdfZnVuY3Rpb25fX30pO1xudmFyIG1peGVkSGVscGVycyA9ICgkX19oZWxwZXJzXzQ3X21peGVkX18gPSBfZGVyZXFfKFwiaGVscGVycy9taXhlZFwiKSwgJF9faGVscGVyc180N19taXhlZF9fICYmICRfX2hlbHBlcnNfNDdfbWl4ZWRfXy5fX2VzTW9kdWxlICYmICRfX2hlbHBlcnNfNDdfbWl4ZWRfXyB8fCB7ZGVmYXVsdDogJF9faGVscGVyc180N19taXhlZF9ffSk7XG52YXIgbnVtYmVySGVscGVycyA9ICgkX19oZWxwZXJzXzQ3X251bWJlcl9fID0gX2RlcmVxXyhcImhlbHBlcnMvbnVtYmVyXCIpLCAkX19oZWxwZXJzXzQ3X251bWJlcl9fICYmICRfX2hlbHBlcnNfNDdfbnVtYmVyX18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X251bWJlcl9fIHx8IHtkZWZhdWx0OiAkX19oZWxwZXJzXzQ3X251bWJlcl9ffSk7XG52YXIgb2JqZWN0SGVscGVycyA9ICgkX19oZWxwZXJzXzQ3X29iamVjdF9fID0gX2RlcmVxXyhcImhlbHBlcnMvb2JqZWN0XCIpLCAkX19oZWxwZXJzXzQ3X29iamVjdF9fICYmICRfX2hlbHBlcnNfNDdfb2JqZWN0X18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X29iamVjdF9fIHx8IHtkZWZhdWx0OiAkX19oZWxwZXJzXzQ3X29iamVjdF9ffSk7XG52YXIgc2V0dGluZ0hlbHBlcnMgPSAoJF9faGVscGVyc180N19zZXR0aW5nX18gPSBfZGVyZXFfKFwiaGVscGVycy9zZXR0aW5nXCIpLCAkX19oZWxwZXJzXzQ3X3NldHRpbmdfXyAmJiAkX19oZWxwZXJzXzQ3X3NldHRpbmdfXy5fX2VzTW9kdWxlICYmICRfX2hlbHBlcnNfNDdfc2V0dGluZ19fIHx8IHtkZWZhdWx0OiAkX19oZWxwZXJzXzQ3X3NldHRpbmdfX30pO1xudmFyIHN0cmluZ0hlbHBlcnMgPSAoJF9faGVscGVyc180N19zdHJpbmdfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL3N0cmluZ1wiKSwgJF9faGVscGVyc180N19zdHJpbmdfXyAmJiAkX19oZWxwZXJzXzQ3X3N0cmluZ19fLl9fZXNNb2R1bGUgJiYgJF9faGVscGVyc180N19zdHJpbmdfXyB8fCB7ZGVmYXVsdDogJF9faGVscGVyc180N19zdHJpbmdfX30pO1xudmFyIHVuaWNvZGVIZWxwZXJzID0gKCRfX2hlbHBlcnNfNDdfdW5pY29kZV9fID0gX2RlcmVxXyhcImhlbHBlcnMvdW5pY29kZVwiKSwgJF9faGVscGVyc180N191bmljb2RlX18gJiYgJF9faGVscGVyc180N191bmljb2RlX18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X3VuaWNvZGVfXyB8fCB7ZGVmYXVsdDogJF9faGVscGVyc180N191bmljb2RlX199KTtcbnZhciBkb21IZWxwZXJzID0gKCRfX2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9lbGVtZW50XCIpLCAkX19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gJiYgJF9faGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9faGVscGVyc180N19kb21fNDdfZWxlbWVudF9fIHx8IHtkZWZhdWx0OiAkX19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X199KTtcbnZhciBkb21FdmVudEhlbHBlcnMgPSAoJF9faGVscGVyc180N19kb21fNDdfZXZlbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9ldmVudFwiKSwgJF9faGVscGVyc180N19kb21fNDdfZXZlbnRfXyAmJiAkX19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fLl9fZXNNb2R1bGUgJiYgJF9faGVscGVyc180N19kb21fNDdfZXZlbnRfXyB8fCB7ZGVmYXVsdDogJF9faGVscGVyc180N19kb21fNDdfZXZlbnRfX30pO1xudmFyIEhFTFBFUlMgPSBbYXJyYXlIZWxwZXJzLCBicm93c2VySGVscGVycywgZGF0YUhlbHBlcnMsIGRhdGVIZWxwZXJzLCBmZWF0dXJlSGVscGVycywgZnVuY3Rpb25IZWxwZXJzLCBtaXhlZEhlbHBlcnMsIG51bWJlckhlbHBlcnMsIG9iamVjdEhlbHBlcnMsIHNldHRpbmdIZWxwZXJzLCBzdHJpbmdIZWxwZXJzLCB1bmljb2RlSGVscGVyc107XG52YXIgRE9NID0gW2RvbUhlbHBlcnMsIGRvbUV2ZW50SGVscGVyc107XG5IYW5kc29udGFibGUuYnVpbGREYXRlID0gJ01vbiBBcHIgMDMgMjAxNyAxNDoyMjowMSBHTVQrMDIwMCAoQ0VTVCknO1xuSGFuZHNvbnRhYmxlLnBhY2thZ2VOYW1lID0gJ2hhbmRzb250YWJsZSc7XG5IYW5kc29udGFibGUudmVyc2lvbiA9ICcwLjMxLjInO1xudmFyIGJhc2VWZXJzaW9uID0gJ0BAYmFzZVZlcnNpb24nO1xuaWYgKCEvXkBALy50ZXN0KGJhc2VWZXJzaW9uKSkge1xuICBIYW5kc29udGFibGUuYmFzZVZlcnNpb24gPSBiYXNlVmVyc2lvbjtcbn1cbkhhbmRzb250YWJsZS5wbHVnaW5zID0ge307XG52YXIgcmVnaXN0ZXJQbHVnaW4gPSAoJF9fcGx1Z2luc19fID0gX2RlcmVxXyhcInBsdWdpbnNcIiksICRfX3BsdWdpbnNfXyAmJiAkX19wbHVnaW5zX18uX19lc01vZHVsZSAmJiAkX19wbHVnaW5zX18gfHwge2RlZmF1bHQ6ICRfX3BsdWdpbnNfX30pLnJlZ2lzdGVyUGx1Z2luO1xuSGFuZHNvbnRhYmxlLnBsdWdpbnMucmVnaXN0ZXJQbHVnaW4gPSByZWdpc3RlclBsdWdpbjtcbkhhbmRzb250YWJsZS5oZWxwZXIgPSB7fTtcbkhhbmRzb250YWJsZS5kb20gPSB7fTtcbkhhbmRzb250YWJsZS5Eb20gPSBIYW5kc29udGFibGUuZG9tO1xuYXJyYXlIZWxwZXJzLmFycmF5RWFjaChIRUxQRVJTLCAoZnVuY3Rpb24oaGVscGVyKSB7XG4gIGFycmF5SGVscGVycy5hcnJheUVhY2goT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoaGVscGVyKSwgKGZ1bmN0aW9uKGtleSkge1xuICAgIGlmIChrZXkuY2hhckF0KDApICE9PSAnXycpIHtcbiAgICAgIEhhbmRzb250YWJsZS5oZWxwZXJba2V5XSA9IGhlbHBlcltrZXldO1xuICAgIH1cbiAgfSkpO1xufSkpO1xuYXJyYXlIZWxwZXJzLmFycmF5RWFjaChET00sIChmdW5jdGlvbihoZWxwZXIpIHtcbiAgYXJyYXlIZWxwZXJzLmFycmF5RWFjaChPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhoZWxwZXIpLCAoZnVuY3Rpb24oa2V5KSB7XG4gICAgaWYgKGtleS5jaGFyQXQoMCkgIT09ICdfJykge1xuICAgICAgSGFuZHNvbnRhYmxlLmRvbVtrZXldID0gaGVscGVyW2tleV07XG4gICAgfVxuICB9KSk7XG59KSk7XG5cbi8vIyBcbn0se1wiY2VsbFR5cGVzXCI6MjUsXCJjb3JlXCI6MjYsXCJlczZjb2xsZWN0aW9uc1wiOlwiZXM2Y29sbGVjdGlvbnNcIixcImhlbHBlcnMvYXJyYXlcIjo0MyxcImhlbHBlcnMvYnJvd3NlclwiOjQ0LFwiaGVscGVycy9kYXRhXCI6NDUsXCJoZWxwZXJzL2RhdGVcIjo0NixcImhlbHBlcnMvZG9tL2VsZW1lbnRcIjo0NyxcImhlbHBlcnMvZG9tL2V2ZW50XCI6NDgsXCJoZWxwZXJzL2ZlYXR1cmVcIjo0OSxcImhlbHBlcnMvZnVuY3Rpb25cIjo1MCxcImhlbHBlcnMvbWl4ZWRcIjo1MSxcImhlbHBlcnMvbnVtYmVyXCI6NTIsXCJoZWxwZXJzL29iamVjdFwiOjUzLFwiaGVscGVycy9zZXR0aW5nXCI6NTQsXCJoZWxwZXJzL3N0cmluZ1wiOjU1LFwiaGVscGVycy91bmljb2RlXCI6NTYsXCJtb21lbnRcIjpcIm1vbWVudFwiLFwibnVtYnJvXCI6XCJudW1icm9cIixcInBsdWdpbkhvb2tzXCI6NjAsXCJwbHVnaW5zXCI6NjEsXCJwbHVnaW5zL2pxdWVyeUhhbmRzb250YWJsZVwiOjIsXCJyZW5kZXJlcnMvX2NlbGxEZWNvcmF0b3JcIjoxMTgsXCJzaGltcy9ydW50aW1lXCI6MTI1fV0sMjU6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgJF9faGVscGVyc180N19icm93c2VyX18sXG4gICAgJF9fZWRpdG9yc19fLFxuICAgICRfX3JlbmRlcmVyc19fLFxuICAgICRfX2VkaXRvcnNfNDdfYXV0b2NvbXBsZXRlRWRpdG9yX18sXG4gICAgJF9fZWRpdG9yc180N19jaGVja2JveEVkaXRvcl9fLFxuICAgICRfX2VkaXRvcnNfNDdfZGF0ZUVkaXRvcl9fLFxuICAgICRfX2VkaXRvcnNfNDdfZHJvcGRvd25FZGl0b3JfXyxcbiAgICAkX19lZGl0b3JzXzQ3X2hhbmRzb250YWJsZUVkaXRvcl9fLFxuICAgICRfX2VkaXRvcnNfNDdfbW9iaWxlVGV4dEVkaXRvcl9fLFxuICAgICRfX2VkaXRvcnNfNDdfbnVtZXJpY0VkaXRvcl9fLFxuICAgICRfX2VkaXRvcnNfNDdfcGFzc3dvcmRFZGl0b3JfXyxcbiAgICAkX19lZGl0b3JzXzQ3X3NlbGVjdEVkaXRvcl9fLFxuICAgICRfX2VkaXRvcnNfNDdfdGV4dEVkaXRvcl9fLFxuICAgICRfX3JlbmRlcmVyc180N19hdXRvY29tcGxldGVSZW5kZXJlcl9fLFxuICAgICRfX3JlbmRlcmVyc180N19jaGVja2JveFJlbmRlcmVyX18sXG4gICAgJF9fcmVuZGVyZXJzXzQ3X2h0bWxSZW5kZXJlcl9fLFxuICAgICRfX3JlbmRlcmVyc180N19udW1lcmljUmVuZGVyZXJfXyxcbiAgICAkX19yZW5kZXJlcnNfNDdfcGFzc3dvcmRSZW5kZXJlcl9fLFxuICAgICRfX3JlbmRlcmVyc180N190ZXh0UmVuZGVyZXJfXyxcbiAgICAkX192YWxpZGF0b3JzXzQ3X2F1dG9jb21wbGV0ZVZhbGlkYXRvcl9fLFxuICAgICRfX3ZhbGlkYXRvcnNfNDdfZGF0ZVZhbGlkYXRvcl9fLFxuICAgICRfX3ZhbGlkYXRvcnNfNDdfdGltZVZhbGlkYXRvcl9fLFxuICAgICRfX3ZhbGlkYXRvcnNfNDdfbnVtZXJpY1ZhbGlkYXRvcl9fLFxuICAgICRfX2Jyb3dzZXJfXztcbnZhciBpc01vYmlsZUJyb3dzZXIgPSAoJF9faGVscGVyc180N19icm93c2VyX18gPSBfZGVyZXFfKFwiaGVscGVycy9icm93c2VyXCIpLCAkX19oZWxwZXJzXzQ3X2Jyb3dzZXJfXyAmJiAkX19oZWxwZXJzXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX2hlbHBlcnNfNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19oZWxwZXJzXzQ3X2Jyb3dzZXJfX30pLmlzTW9iaWxlQnJvd3NlcjtcbnZhciBnZXRFZGl0b3JDb25zdHJ1Y3RvciA9ICgkX19lZGl0b3JzX18gPSBfZGVyZXFfKFwiZWRpdG9yc1wiKSwgJF9fZWRpdG9yc19fICYmICRfX2VkaXRvcnNfXy5fX2VzTW9kdWxlICYmICRfX2VkaXRvcnNfXyB8fCB7ZGVmYXVsdDogJF9fZWRpdG9yc19ffSkuZ2V0RWRpdG9yQ29uc3RydWN0b3I7XG52YXIgZ2V0UmVuZGVyZXIgPSAoJF9fcmVuZGVyZXJzX18gPSBfZGVyZXFfKFwicmVuZGVyZXJzXCIpLCAkX19yZW5kZXJlcnNfXyAmJiAkX19yZW5kZXJlcnNfXy5fX2VzTW9kdWxlICYmICRfX3JlbmRlcmVyc19fIHx8IHtkZWZhdWx0OiAkX19yZW5kZXJlcnNfX30pLmdldFJlbmRlcmVyO1xudmFyIEF1dG9jb21wbGV0ZUVkaXRvciA9ICgkX19lZGl0b3JzXzQ3X2F1dG9jb21wbGV0ZUVkaXRvcl9fID0gX2RlcmVxXyhcImVkaXRvcnMvYXV0b2NvbXBsZXRlRWRpdG9yXCIpLCAkX19lZGl0b3JzXzQ3X2F1dG9jb21wbGV0ZUVkaXRvcl9fICYmICRfX2VkaXRvcnNfNDdfYXV0b2NvbXBsZXRlRWRpdG9yX18uX19lc01vZHVsZSAmJiAkX19lZGl0b3JzXzQ3X2F1dG9jb21wbGV0ZUVkaXRvcl9fIHx8IHtkZWZhdWx0OiAkX19lZGl0b3JzXzQ3X2F1dG9jb21wbGV0ZUVkaXRvcl9ffSkuQXV0b2NvbXBsZXRlRWRpdG9yO1xudmFyIENoZWNrYm94RWRpdG9yID0gKCRfX2VkaXRvcnNfNDdfY2hlY2tib3hFZGl0b3JfXyA9IF9kZXJlcV8oXCJlZGl0b3JzL2NoZWNrYm94RWRpdG9yXCIpLCAkX19lZGl0b3JzXzQ3X2NoZWNrYm94RWRpdG9yX18gJiYgJF9fZWRpdG9yc180N19jaGVja2JveEVkaXRvcl9fLl9fZXNNb2R1bGUgJiYgJF9fZWRpdG9yc180N19jaGVja2JveEVkaXRvcl9fIHx8IHtkZWZhdWx0OiAkX19lZGl0b3JzXzQ3X2NoZWNrYm94RWRpdG9yX199KS5DaGVja2JveEVkaXRvcjtcbnZhciBEYXRlRWRpdG9yID0gKCRfX2VkaXRvcnNfNDdfZGF0ZUVkaXRvcl9fID0gX2RlcmVxXyhcImVkaXRvcnMvZGF0ZUVkaXRvclwiKSwgJF9fZWRpdG9yc180N19kYXRlRWRpdG9yX18gJiYgJF9fZWRpdG9yc180N19kYXRlRWRpdG9yX18uX19lc01vZHVsZSAmJiAkX19lZGl0b3JzXzQ3X2RhdGVFZGl0b3JfXyB8fCB7ZGVmYXVsdDogJF9fZWRpdG9yc180N19kYXRlRWRpdG9yX199KS5EYXRlRWRpdG9yO1xudmFyIERyb3Bkb3duRWRpdG9yID0gKCRfX2VkaXRvcnNfNDdfZHJvcGRvd25FZGl0b3JfXyA9IF9kZXJlcV8oXCJlZGl0b3JzL2Ryb3Bkb3duRWRpdG9yXCIpLCAkX19lZGl0b3JzXzQ3X2Ryb3Bkb3duRWRpdG9yX18gJiYgJF9fZWRpdG9yc180N19kcm9wZG93bkVkaXRvcl9fLl9fZXNNb2R1bGUgJiYgJF9fZWRpdG9yc180N19kcm9wZG93bkVkaXRvcl9fIHx8IHtkZWZhdWx0OiAkX19lZGl0b3JzXzQ3X2Ryb3Bkb3duRWRpdG9yX199KS5Ecm9wZG93bkVkaXRvcjtcbnZhciBIYW5kc29udGFibGVFZGl0b3IgPSAoJF9fZWRpdG9yc180N19oYW5kc29udGFibGVFZGl0b3JfXyA9IF9kZXJlcV8oXCJlZGl0b3JzL2hhbmRzb250YWJsZUVkaXRvclwiKSwgJF9fZWRpdG9yc180N19oYW5kc29udGFibGVFZGl0b3JfXyAmJiAkX19lZGl0b3JzXzQ3X2hhbmRzb250YWJsZUVkaXRvcl9fLl9fZXNNb2R1bGUgJiYgJF9fZWRpdG9yc180N19oYW5kc29udGFibGVFZGl0b3JfXyB8fCB7ZGVmYXVsdDogJF9fZWRpdG9yc180N19oYW5kc29udGFibGVFZGl0b3JfX30pLkhhbmRzb250YWJsZUVkaXRvcjtcbnZhciBNb2JpbGVUZXh0RWRpdG9yID0gKCRfX2VkaXRvcnNfNDdfbW9iaWxlVGV4dEVkaXRvcl9fID0gX2RlcmVxXyhcImVkaXRvcnMvbW9iaWxlVGV4dEVkaXRvclwiKSwgJF9fZWRpdG9yc180N19tb2JpbGVUZXh0RWRpdG9yX18gJiYgJF9fZWRpdG9yc180N19tb2JpbGVUZXh0RWRpdG9yX18uX19lc01vZHVsZSAmJiAkX19lZGl0b3JzXzQ3X21vYmlsZVRleHRFZGl0b3JfXyB8fCB7ZGVmYXVsdDogJF9fZWRpdG9yc180N19tb2JpbGVUZXh0RWRpdG9yX199KS5Nb2JpbGVUZXh0RWRpdG9yO1xudmFyIE51bWVyaWNFZGl0b3IgPSAoJF9fZWRpdG9yc180N19udW1lcmljRWRpdG9yX18gPSBfZGVyZXFfKFwiZWRpdG9ycy9udW1lcmljRWRpdG9yXCIpLCAkX19lZGl0b3JzXzQ3X251bWVyaWNFZGl0b3JfXyAmJiAkX19lZGl0b3JzXzQ3X251bWVyaWNFZGl0b3JfXy5fX2VzTW9kdWxlICYmICRfX2VkaXRvcnNfNDdfbnVtZXJpY0VkaXRvcl9fIHx8IHtkZWZhdWx0OiAkX19lZGl0b3JzXzQ3X251bWVyaWNFZGl0b3JfX30pLk51bWVyaWNFZGl0b3I7XG52YXIgUGFzc3dvcmRFZGl0b3IgPSAoJF9fZWRpdG9yc180N19wYXNzd29yZEVkaXRvcl9fID0gX2RlcmVxXyhcImVkaXRvcnMvcGFzc3dvcmRFZGl0b3JcIiksICRfX2VkaXRvcnNfNDdfcGFzc3dvcmRFZGl0b3JfXyAmJiAkX19lZGl0b3JzXzQ3X3Bhc3N3b3JkRWRpdG9yX18uX19lc01vZHVsZSAmJiAkX19lZGl0b3JzXzQ3X3Bhc3N3b3JkRWRpdG9yX18gfHwge2RlZmF1bHQ6ICRfX2VkaXRvcnNfNDdfcGFzc3dvcmRFZGl0b3JfX30pLlBhc3N3b3JkRWRpdG9yO1xudmFyIFNlbGVjdEVkaXRvciA9ICgkX19lZGl0b3JzXzQ3X3NlbGVjdEVkaXRvcl9fID0gX2RlcmVxXyhcImVkaXRvcnMvc2VsZWN0RWRpdG9yXCIpLCAkX19lZGl0b3JzXzQ3X3NlbGVjdEVkaXRvcl9fICYmICRfX2VkaXRvcnNfNDdfc2VsZWN0RWRpdG9yX18uX19lc01vZHVsZSAmJiAkX19lZGl0b3JzXzQ3X3NlbGVjdEVkaXRvcl9fIHx8IHtkZWZhdWx0OiAkX19lZGl0b3JzXzQ3X3NlbGVjdEVkaXRvcl9ffSkuU2VsZWN0RWRpdG9yO1xudmFyIFRleHRFZGl0b3IgPSAoJF9fZWRpdG9yc180N190ZXh0RWRpdG9yX18gPSBfZGVyZXFfKFwiZWRpdG9ycy90ZXh0RWRpdG9yXCIpLCAkX19lZGl0b3JzXzQ3X3RleHRFZGl0b3JfXyAmJiAkX19lZGl0b3JzXzQ3X3RleHRFZGl0b3JfXy5fX2VzTW9kdWxlICYmICRfX2VkaXRvcnNfNDdfdGV4dEVkaXRvcl9fIHx8IHtkZWZhdWx0OiAkX19lZGl0b3JzXzQ3X3RleHRFZGl0b3JfX30pLlRleHRFZGl0b3I7XG52YXIgQXV0b2NvbXBsZXRlUmVuZGVyZXIgPSAoJF9fcmVuZGVyZXJzXzQ3X2F1dG9jb21wbGV0ZVJlbmRlcmVyX18gPSBfZGVyZXFfKFwicmVuZGVyZXJzL2F1dG9jb21wbGV0ZVJlbmRlcmVyXCIpLCAkX19yZW5kZXJlcnNfNDdfYXV0b2NvbXBsZXRlUmVuZGVyZXJfXyAmJiAkX19yZW5kZXJlcnNfNDdfYXV0b2NvbXBsZXRlUmVuZGVyZXJfXy5fX2VzTW9kdWxlICYmICRfX3JlbmRlcmVyc180N19hdXRvY29tcGxldGVSZW5kZXJlcl9fIHx8IHtkZWZhdWx0OiAkX19yZW5kZXJlcnNfNDdfYXV0b2NvbXBsZXRlUmVuZGVyZXJfX30pLkF1dG9jb21wbGV0ZVJlbmRlcmVyO1xudmFyIENoZWNrYm94UmVuZGVyZXIgPSAoJF9fcmVuZGVyZXJzXzQ3X2NoZWNrYm94UmVuZGVyZXJfXyA9IF9kZXJlcV8oXCJyZW5kZXJlcnMvY2hlY2tib3hSZW5kZXJlclwiKSwgJF9fcmVuZGVyZXJzXzQ3X2NoZWNrYm94UmVuZGVyZXJfXyAmJiAkX19yZW5kZXJlcnNfNDdfY2hlY2tib3hSZW5kZXJlcl9fLl9fZXNNb2R1bGUgJiYgJF9fcmVuZGVyZXJzXzQ3X2NoZWNrYm94UmVuZGVyZXJfXyB8fCB7ZGVmYXVsdDogJF9fcmVuZGVyZXJzXzQ3X2NoZWNrYm94UmVuZGVyZXJfX30pLkNoZWNrYm94UmVuZGVyZXI7XG52YXIgSHRtbFJlbmRlcmVyID0gKCRfX3JlbmRlcmVyc180N19odG1sUmVuZGVyZXJfXyA9IF9kZXJlcV8oXCJyZW5kZXJlcnMvaHRtbFJlbmRlcmVyXCIpLCAkX19yZW5kZXJlcnNfNDdfaHRtbFJlbmRlcmVyX18gJiYgJF9fcmVuZGVyZXJzXzQ3X2h0bWxSZW5kZXJlcl9fLl9fZXNNb2R1bGUgJiYgJF9fcmVuZGVyZXJzXzQ3X2h0bWxSZW5kZXJlcl9fIHx8IHtkZWZhdWx0OiAkX19yZW5kZXJlcnNfNDdfaHRtbFJlbmRlcmVyX199KS5IdG1sUmVuZGVyZXI7XG52YXIgTnVtZXJpY1JlbmRlcmVyID0gKCRfX3JlbmRlcmVyc180N19udW1lcmljUmVuZGVyZXJfXyA9IF9kZXJlcV8oXCJyZW5kZXJlcnMvbnVtZXJpY1JlbmRlcmVyXCIpLCAkX19yZW5kZXJlcnNfNDdfbnVtZXJpY1JlbmRlcmVyX18gJiYgJF9fcmVuZGVyZXJzXzQ3X251bWVyaWNSZW5kZXJlcl9fLl9fZXNNb2R1bGUgJiYgJF9fcmVuZGVyZXJzXzQ3X251bWVyaWNSZW5kZXJlcl9fIHx8IHtkZWZhdWx0OiAkX19yZW5kZXJlcnNfNDdfbnVtZXJpY1JlbmRlcmVyX199KS5OdW1lcmljUmVuZGVyZXI7XG52YXIgUGFzc3dvcmRSZW5kZXJlciA9ICgkX19yZW5kZXJlcnNfNDdfcGFzc3dvcmRSZW5kZXJlcl9fID0gX2RlcmVxXyhcInJlbmRlcmVycy9wYXNzd29yZFJlbmRlcmVyXCIpLCAkX19yZW5kZXJlcnNfNDdfcGFzc3dvcmRSZW5kZXJlcl9fICYmICRfX3JlbmRlcmVyc180N19wYXNzd29yZFJlbmRlcmVyX18uX19lc01vZHVsZSAmJiAkX19yZW5kZXJlcnNfNDdfcGFzc3dvcmRSZW5kZXJlcl9fIHx8IHtkZWZhdWx0OiAkX19yZW5kZXJlcnNfNDdfcGFzc3dvcmRSZW5kZXJlcl9ffSkuUGFzc3dvcmRSZW5kZXJlcjtcbnZhciBUZXh0UmVuZGVyZXIgPSAoJF9fcmVuZGVyZXJzXzQ3X3RleHRSZW5kZXJlcl9fID0gX2RlcmVxXyhcInJlbmRlcmVycy90ZXh0UmVuZGVyZXJcIiksICRfX3JlbmRlcmVyc180N190ZXh0UmVuZGVyZXJfXyAmJiAkX19yZW5kZXJlcnNfNDdfdGV4dFJlbmRlcmVyX18uX19lc01vZHVsZSAmJiAkX19yZW5kZXJlcnNfNDdfdGV4dFJlbmRlcmVyX18gfHwge2RlZmF1bHQ6ICRfX3JlbmRlcmVyc180N190ZXh0UmVuZGVyZXJfX30pLlRleHRSZW5kZXJlcjtcbnZhciBBdXRvY29tcGxldGVWYWxpZGF0b3IgPSAoJF9fdmFsaWRhdG9yc180N19hdXRvY29tcGxldGVWYWxpZGF0b3JfXyA9IF9kZXJlcV8oXCJ2YWxpZGF0b3JzL2F1dG9jb21wbGV0ZVZhbGlkYXRvclwiKSwgJF9fdmFsaWRhdG9yc180N19hdXRvY29tcGxldGVWYWxpZGF0b3JfXyAmJiAkX192YWxpZGF0b3JzXzQ3X2F1dG9jb21wbGV0ZVZhbGlkYXRvcl9fLl9fZXNNb2R1bGUgJiYgJF9fdmFsaWRhdG9yc180N19hdXRvY29tcGxldGVWYWxpZGF0b3JfXyB8fCB7ZGVmYXVsdDogJF9fdmFsaWRhdG9yc180N19hdXRvY29tcGxldGVWYWxpZGF0b3JfX30pLkF1dG9jb21wbGV0ZVZhbGlkYXRvcjtcbnZhciBEYXRlVmFsaWRhdG9yID0gKCRfX3ZhbGlkYXRvcnNfNDdfZGF0ZVZhbGlkYXRvcl9fID0gX2RlcmVxXyhcInZhbGlkYXRvcnMvZGF0ZVZhbGlkYXRvclwiKSwgJF9fdmFsaWRhdG9yc180N19kYXRlVmFsaWRhdG9yX18gJiYgJF9fdmFsaWRhdG9yc180N19kYXRlVmFsaWRhdG9yX18uX19lc01vZHVsZSAmJiAkX192YWxpZGF0b3JzXzQ3X2RhdGVWYWxpZGF0b3JfXyB8fCB7ZGVmYXVsdDogJF9fdmFsaWRhdG9yc180N19kYXRlVmFsaWRhdG9yX199KS5EYXRlVmFsaWRhdG9yO1xudmFyIFRpbWVWYWxpZGF0b3IgPSAoJF9fdmFsaWRhdG9yc180N190aW1lVmFsaWRhdG9yX18gPSBfZGVyZXFfKFwidmFsaWRhdG9ycy90aW1lVmFsaWRhdG9yXCIpLCAkX192YWxpZGF0b3JzXzQ3X3RpbWVWYWxpZGF0b3JfXyAmJiAkX192YWxpZGF0b3JzXzQ3X3RpbWVWYWxpZGF0b3JfXy5fX2VzTW9kdWxlICYmICRfX3ZhbGlkYXRvcnNfNDdfdGltZVZhbGlkYXRvcl9fIHx8IHtkZWZhdWx0OiAkX192YWxpZGF0b3JzXzQ3X3RpbWVWYWxpZGF0b3JfX30pLlRpbWVWYWxpZGF0b3I7XG52YXIgTnVtZXJpY1ZhbGlkYXRvciA9ICgkX192YWxpZGF0b3JzXzQ3X251bWVyaWNWYWxpZGF0b3JfXyA9IF9kZXJlcV8oXCJ2YWxpZGF0b3JzL251bWVyaWNWYWxpZGF0b3JcIiksICRfX3ZhbGlkYXRvcnNfNDdfbnVtZXJpY1ZhbGlkYXRvcl9fICYmICRfX3ZhbGlkYXRvcnNfNDdfbnVtZXJpY1ZhbGlkYXRvcl9fLl9fZXNNb2R1bGUgJiYgJF9fdmFsaWRhdG9yc180N19udW1lcmljVmFsaWRhdG9yX18gfHwge2RlZmF1bHQ6ICRfX3ZhbGlkYXRvcnNfNDdfbnVtZXJpY1ZhbGlkYXRvcl9ffSkuTnVtZXJpY1ZhbGlkYXRvcjtcbnZhciBIYW5kc29udGFibGUgPSAoJF9fYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX2Jyb3dzZXJfXyAmJiAkX19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG5IYW5kc29udGFibGUuQXV0b2NvbXBsZXRlQ2VsbCA9IHtcbiAgZWRpdG9yOiBnZXRFZGl0b3JDb25zdHJ1Y3RvcignYXV0b2NvbXBsZXRlJyksXG4gIHJlbmRlcmVyOiBnZXRSZW5kZXJlcignYXV0b2NvbXBsZXRlJyksXG4gIHZhbGlkYXRvcjogSGFuZHNvbnRhYmxlLkF1dG9jb21wbGV0ZVZhbGlkYXRvclxufTtcbkhhbmRzb250YWJsZS5DaGVja2JveENlbGwgPSB7XG4gIGVkaXRvcjogZ2V0RWRpdG9yQ29uc3RydWN0b3IoJ2NoZWNrYm94JyksXG4gIHJlbmRlcmVyOiBnZXRSZW5kZXJlcignY2hlY2tib3gnKVxufTtcbkhhbmRzb250YWJsZS5UZXh0Q2VsbCA9IHtcbiAgZWRpdG9yOiBpc01vYmlsZUJyb3dzZXIoKSA/IGdldEVkaXRvckNvbnN0cnVjdG9yKCdtb2JpbGUnKSA6IGdldEVkaXRvckNvbnN0cnVjdG9yKCd0ZXh0JyksXG4gIHJlbmRlcmVyOiBnZXRSZW5kZXJlcigndGV4dCcpXG59O1xuSGFuZHNvbnRhYmxlLk51bWVyaWNDZWxsID0ge1xuICBlZGl0b3I6IGdldEVkaXRvckNvbnN0cnVjdG9yKCdudW1lcmljJyksXG4gIHJlbmRlcmVyOiBnZXRSZW5kZXJlcignbnVtZXJpYycpLFxuICB2YWxpZGF0b3I6IEhhbmRzb250YWJsZS5OdW1lcmljVmFsaWRhdG9yLFxuICBkYXRhVHlwZTogJ251bWJlcidcbn07XG5IYW5kc29udGFibGUuRGF0ZUNlbGwgPSB7XG4gIGVkaXRvcjogZ2V0RWRpdG9yQ29uc3RydWN0b3IoJ2RhdGUnKSxcbiAgdmFsaWRhdG9yOiBIYW5kc29udGFibGUuRGF0ZVZhbGlkYXRvcixcbiAgcmVuZGVyZXI6IGdldFJlbmRlcmVyKCdhdXRvY29tcGxldGUnKVxufTtcbkhhbmRzb250YWJsZS5UaW1lQ2VsbCA9IHtcbiAgZWRpdG9yOiBnZXRFZGl0b3JDb25zdHJ1Y3RvcigndGV4dCcpLFxuICB2YWxpZGF0b3I6IEhhbmRzb250YWJsZS5UaW1lVmFsaWRhdG9yLFxuICByZW5kZXJlcjogZ2V0UmVuZGVyZXIoJ3RleHQnKVxufTtcbkhhbmRzb250YWJsZS5IYW5kc29udGFibGVDZWxsID0ge1xuICBlZGl0b3I6IGdldEVkaXRvckNvbnN0cnVjdG9yKCdoYW5kc29udGFibGUnKSxcbiAgcmVuZGVyZXI6IGdldFJlbmRlcmVyKCdhdXRvY29tcGxldGUnKVxufTtcbkhhbmRzb250YWJsZS5QYXNzd29yZENlbGwgPSB7XG4gIGVkaXRvcjogZ2V0RWRpdG9yQ29uc3RydWN0b3IoJ3Bhc3N3b3JkJyksXG4gIHJlbmRlcmVyOiBnZXRSZW5kZXJlcigncGFzc3dvcmQnKSxcbiAgY29weWFibGU6IGZhbHNlXG59O1xuSGFuZHNvbnRhYmxlLkRyb3Bkb3duQ2VsbCA9IHtcbiAgZWRpdG9yOiBnZXRFZGl0b3JDb25zdHJ1Y3RvcignZHJvcGRvd24nKSxcbiAgcmVuZGVyZXI6IGdldFJlbmRlcmVyKCdhdXRvY29tcGxldGUnKSxcbiAgdmFsaWRhdG9yOiBIYW5kc29udGFibGUuQXV0b2NvbXBsZXRlVmFsaWRhdG9yXG59O1xuSGFuZHNvbnRhYmxlLmNlbGxUeXBlcyA9IHtcbiAgdGV4dDogSGFuZHNvbnRhYmxlLlRleHRDZWxsLFxuICBkYXRlOiBIYW5kc29udGFibGUuRGF0ZUNlbGwsXG4gIHRpbWU6IEhhbmRzb250YWJsZS5UaW1lQ2VsbCxcbiAgbnVtZXJpYzogSGFuZHNvbnRhYmxlLk51bWVyaWNDZWxsLFxuICBjaGVja2JveDogSGFuZHNvbnRhYmxlLkNoZWNrYm94Q2VsbCxcbiAgYXV0b2NvbXBsZXRlOiBIYW5kc29udGFibGUuQXV0b2NvbXBsZXRlQ2VsbCxcbiAgaGFuZHNvbnRhYmxlOiBIYW5kc29udGFibGUuSGFuZHNvbnRhYmxlQ2VsbCxcbiAgcGFzc3dvcmQ6IEhhbmRzb250YWJsZS5QYXNzd29yZENlbGwsXG4gIGRyb3Bkb3duOiBIYW5kc29udGFibGUuRHJvcGRvd25DZWxsXG59O1xuSGFuZHNvbnRhYmxlLmNlbGxMb29rdXAgPSB7dmFsaWRhdG9yOiB7XG4gICAgbnVtZXJpYzogSGFuZHNvbnRhYmxlLk51bWVyaWNWYWxpZGF0b3IsXG4gICAgYXV0b2NvbXBsZXRlOiBIYW5kc29udGFibGUuQXV0b2NvbXBsZXRlVmFsaWRhdG9yXG4gIH19O1xuXG4vLyMgXG59LHtcImJyb3dzZXJcIjoyNCxcImVkaXRvcnNcIjozMCxcImVkaXRvcnMvYXV0b2NvbXBsZXRlRWRpdG9yXCI6MzIsXCJlZGl0b3JzL2NoZWNrYm94RWRpdG9yXCI6MzMsXCJlZGl0b3JzL2RhdGVFZGl0b3JcIjozNCxcImVkaXRvcnMvZHJvcGRvd25FZGl0b3JcIjozNSxcImVkaXRvcnMvaGFuZHNvbnRhYmxlRWRpdG9yXCI6MzYsXCJlZGl0b3JzL21vYmlsZVRleHRFZGl0b3JcIjozNyxcImVkaXRvcnMvbnVtZXJpY0VkaXRvclwiOjM4LFwiZWRpdG9ycy9wYXNzd29yZEVkaXRvclwiOjM5LFwiZWRpdG9ycy9zZWxlY3RFZGl0b3JcIjo0MCxcImVkaXRvcnMvdGV4dEVkaXRvclwiOjQxLFwiaGVscGVycy9icm93c2VyXCI6NDQsXCJyZW5kZXJlcnNcIjoxMTcsXCJyZW5kZXJlcnMvYXV0b2NvbXBsZXRlUmVuZGVyZXJcIjoxMTksXCJyZW5kZXJlcnMvY2hlY2tib3hSZW5kZXJlclwiOjEyMCxcInJlbmRlcmVycy9odG1sUmVuZGVyZXJcIjoxMjEsXCJyZW5kZXJlcnMvbnVtZXJpY1JlbmRlcmVyXCI6MTIyLFwicmVuZGVyZXJzL3Bhc3N3b3JkUmVuZGVyZXJcIjoxMjMsXCJyZW5kZXJlcnMvdGV4dFJlbmRlcmVyXCI6MTI0LFwidmFsaWRhdG9ycy9hdXRvY29tcGxldGVWYWxpZGF0b3JcIjoxMzMsXCJ2YWxpZGF0b3JzL2RhdGVWYWxpZGF0b3JcIjoxMzQsXCJ2YWxpZGF0b3JzL251bWVyaWNWYWxpZGF0b3JcIjoxMzUsXCJ2YWxpZGF0b3JzL3RpbWVWYWxpZGF0b3JcIjoxMzZ9XSwyNjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbnZhciAkX19icm93c2VyX18sXG4gICAgJF9fbnVtYnJvX18sXG4gICAgJF9faGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLFxuICAgICRfX2hlbHBlcnNfNDdfc2V0dGluZ19fLFxuICAgICRfX2hlbHBlcnNfNDdfZnVuY3Rpb25fXyxcbiAgICAkX19oZWxwZXJzXzQ3X21peGVkX18sXG4gICAgJF9faGVscGVyc180N19icm93c2VyX18sXG4gICAgJF9fZGF0YU1hcF9fLFxuICAgICRfX2VkaXRvck1hbmFnZXJfXyxcbiAgICAkX19ldmVudE1hbmFnZXJfXyxcbiAgICAkX19oZWxwZXJzXzQ3X29iamVjdF9fLFxuICAgICRfX2hlbHBlcnNfNDdfYXJyYXlfXyxcbiAgICAkX19wbHVnaW5zX18sXG4gICAgJF9fcmVuZGVyZXJzX18sXG4gICAgJF9faGVscGVyc180N19zdHJpbmdfXyxcbiAgICAkX19oZWxwZXJzXzQ3X251bWJlcl9fLFxuICAgICRfX3RhYmxlVmlld19fLFxuICAgICRfX2RhdGFTb3VyY2VfXyxcbiAgICAkX19oZWxwZXJzXzQ3X2RhdGFfXyxcbiAgICAkX191dGlsc180N19yZWNvcmRUcmFuc2xhdG9yX18sXG4gICAgJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX18sXG4gICAgJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfcmFuZ2VfXyxcbiAgICAkX18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2FsY3VsYXRvcl80N192aWV3cG9ydENvbHVtbnNfXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX2Jyb3dzZXJfXyAmJiAkX19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgbnVtYnJvID0gKCRfX251bWJyb19fID0gX2RlcmVxXyhcIm51bWJyb1wiKSwgJF9fbnVtYnJvX18gJiYgJF9fbnVtYnJvX18uX19lc01vZHVsZSAmJiAkX19udW1icm9fXyB8fCB7ZGVmYXVsdDogJF9fbnVtYnJvX199KS5kZWZhdWx0O1xudmFyICRfXzIgPSAoJF9faGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLFxuICAgIGFkZENsYXNzID0gJF9fMi5hZGRDbGFzcyxcbiAgICBlbXB0eSA9ICRfXzIuZW1wdHksXG4gICAgaXNDaGlsZE9mV2ViQ29tcG9uZW50VGFibGUgPSAkX18yLmlzQ2hpbGRPZldlYkNvbXBvbmVudFRhYmxlLFxuICAgIHJlbW92ZUNsYXNzID0gJF9fMi5yZW1vdmVDbGFzcztcbnZhciBjb2x1bW5GYWN0b3J5ID0gKCRfX2hlbHBlcnNfNDdfc2V0dGluZ19fID0gX2RlcmVxXyhcImhlbHBlcnMvc2V0dGluZ1wiKSwgJF9faGVscGVyc180N19zZXR0aW5nX18gJiYgJF9faGVscGVyc180N19zZXR0aW5nX18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X3NldHRpbmdfXyB8fCB7ZGVmYXVsdDogJF9faGVscGVyc180N19zZXR0aW5nX199KS5jb2x1bW5GYWN0b3J5O1xudmFyIGlzRnVuY3Rpb24gPSAoJF9faGVscGVyc180N19mdW5jdGlvbl9fID0gX2RlcmVxXyhcImhlbHBlcnMvZnVuY3Rpb25cIiksICRfX2hlbHBlcnNfNDdfZnVuY3Rpb25fXyAmJiAkX19oZWxwZXJzXzQ3X2Z1bmN0aW9uX18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X2Z1bmN0aW9uX18gfHwge2RlZmF1bHQ6ICRfX2hlbHBlcnNfNDdfZnVuY3Rpb25fX30pLmlzRnVuY3Rpb247XG52YXIgJF9fNSA9ICgkX19oZWxwZXJzXzQ3X21peGVkX18gPSBfZGVyZXFfKFwiaGVscGVycy9taXhlZFwiKSwgJF9faGVscGVyc180N19taXhlZF9fICYmICRfX2hlbHBlcnNfNDdfbWl4ZWRfXy5fX2VzTW9kdWxlICYmICRfX2hlbHBlcnNfNDdfbWl4ZWRfXyB8fCB7ZGVmYXVsdDogJF9faGVscGVyc180N19taXhlZF9ffSksXG4gICAgaXNEZWZpbmVkID0gJF9fNS5pc0RlZmluZWQsXG4gICAgaXNVbmRlZmluZWQgPSAkX181LmlzVW5kZWZpbmVkO1xudmFyIGlzTW9iaWxlQnJvd3NlciA9ICgkX19oZWxwZXJzXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2Jyb3dzZXJcIiksICRfX2hlbHBlcnNfNDdfYnJvd3Nlcl9fICYmICRfX2hlbHBlcnNfNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9faGVscGVyc180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX2hlbHBlcnNfNDdfYnJvd3Nlcl9ffSkuaXNNb2JpbGVCcm93c2VyO1xudmFyIERhdGFNYXAgPSAoJF9fZGF0YU1hcF9fID0gX2RlcmVxXyhcImRhdGFNYXBcIiksICRfX2RhdGFNYXBfXyAmJiAkX19kYXRhTWFwX18uX19lc01vZHVsZSAmJiAkX19kYXRhTWFwX18gfHwge2RlZmF1bHQ6ICRfX2RhdGFNYXBfX30pLkRhdGFNYXA7XG52YXIgRWRpdG9yTWFuYWdlciA9ICgkX19lZGl0b3JNYW5hZ2VyX18gPSBfZGVyZXFfKFwiZWRpdG9yTWFuYWdlclwiKSwgJF9fZWRpdG9yTWFuYWdlcl9fICYmICRfX2VkaXRvck1hbmFnZXJfXy5fX2VzTW9kdWxlICYmICRfX2VkaXRvck1hbmFnZXJfXyB8fCB7ZGVmYXVsdDogJF9fZWRpdG9yTWFuYWdlcl9ffSkuRWRpdG9yTWFuYWdlcjtcbnZhciBldmVudE1hbmFnZXJPYmplY3QgPSAoJF9fZXZlbnRNYW5hZ2VyX18gPSBfZGVyZXFfKFwiZXZlbnRNYW5hZ2VyXCIpLCAkX19ldmVudE1hbmFnZXJfXyAmJiAkX19ldmVudE1hbmFnZXJfXy5fX2VzTW9kdWxlICYmICRfX2V2ZW50TWFuYWdlcl9fIHx8IHtkZWZhdWx0OiAkX19ldmVudE1hbmFnZXJfX30pLmV2ZW50TWFuYWdlcjtcbnZhciAkX18xMCA9ICgkX19oZWxwZXJzXzQ3X29iamVjdF9fID0gX2RlcmVxXyhcImhlbHBlcnMvb2JqZWN0XCIpLCAkX19oZWxwZXJzXzQ3X29iamVjdF9fICYmICRfX2hlbHBlcnNfNDdfb2JqZWN0X18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X29iamVjdF9fIHx8IHtkZWZhdWx0OiAkX19oZWxwZXJzXzQ3X29iamVjdF9ffSksXG4gICAgZGVlcENsb25lID0gJF9fMTAuZGVlcENsb25lLFxuICAgIGR1Y2tTY2hlbWEgPSAkX18xMC5kdWNrU2NoZW1hLFxuICAgIGV4dGVuZCA9ICRfXzEwLmV4dGVuZCxcbiAgICBpc09iamVjdCA9ICRfXzEwLmlzT2JqZWN0LFxuICAgIGlzT2JqZWN0RXF1YWxzID0gJF9fMTAuaXNPYmplY3RFcXVhbHMsXG4gICAgZGVlcE9iamVjdFNpemUgPSAkX18xMC5kZWVwT2JqZWN0U2l6ZSxcbiAgICBjcmVhdGVPYmplY3RQcm9wTGlzdGVuZXIgPSAkX18xMC5jcmVhdGVPYmplY3RQcm9wTGlzdGVuZXI7XG52YXIgJF9fMTEgPSAoJF9faGVscGVyc180N19hcnJheV9fID0gX2RlcmVxXyhcImhlbHBlcnMvYXJyYXlcIiksICRfX2hlbHBlcnNfNDdfYXJyYXlfXyAmJiAkX19oZWxwZXJzXzQ3X2FycmF5X18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X2FycmF5X18gfHwge2RlZmF1bHQ6ICRfX2hlbHBlcnNfNDdfYXJyYXlfX30pLFxuICAgIGFycmF5RmxhdHRlbiA9ICRfXzExLmFycmF5RmxhdHRlbixcbiAgICBhcnJheU1hcCA9ICRfXzExLmFycmF5TWFwO1xudmFyIGdldFBsdWdpbiA9ICgkX19wbHVnaW5zX18gPSBfZGVyZXFfKFwicGx1Z2luc1wiKSwgJF9fcGx1Z2luc19fICYmICRfX3BsdWdpbnNfXy5fX2VzTW9kdWxlICYmICRfX3BsdWdpbnNfXyB8fCB7ZGVmYXVsdDogJF9fcGx1Z2luc19ffSkuZ2V0UGx1Z2luO1xudmFyIGdldFJlbmRlcmVyID0gKCRfX3JlbmRlcmVyc19fID0gX2RlcmVxXyhcInJlbmRlcmVyc1wiKSwgJF9fcmVuZGVyZXJzX18gJiYgJF9fcmVuZGVyZXJzX18uX19lc01vZHVsZSAmJiAkX19yZW5kZXJlcnNfXyB8fCB7ZGVmYXVsdDogJF9fcmVuZGVyZXJzX199KS5nZXRSZW5kZXJlcjtcbnZhciByYW5kb21TdHJpbmcgPSAoJF9faGVscGVyc180N19zdHJpbmdfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL3N0cmluZ1wiKSwgJF9faGVscGVyc180N19zdHJpbmdfXyAmJiAkX19oZWxwZXJzXzQ3X3N0cmluZ19fLl9fZXNNb2R1bGUgJiYgJF9faGVscGVyc180N19zdHJpbmdfXyB8fCB7ZGVmYXVsdDogJF9faGVscGVyc180N19zdHJpbmdfX30pLnJhbmRvbVN0cmluZztcbnZhciByYW5nZUVhY2ggPSAoJF9faGVscGVyc180N19udW1iZXJfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL251bWJlclwiKSwgJF9faGVscGVyc180N19udW1iZXJfXyAmJiAkX19oZWxwZXJzXzQ3X251bWJlcl9fLl9fZXNNb2R1bGUgJiYgJF9faGVscGVyc180N19udW1iZXJfXyB8fCB7ZGVmYXVsdDogJF9faGVscGVyc180N19udW1iZXJfX30pLnJhbmdlRWFjaDtcbnZhciBUYWJsZVZpZXcgPSAoJF9fdGFibGVWaWV3X18gPSBfZGVyZXFfKFwidGFibGVWaWV3XCIpLCAkX190YWJsZVZpZXdfXyAmJiAkX190YWJsZVZpZXdfXy5fX2VzTW9kdWxlICYmICRfX3RhYmxlVmlld19fIHx8IHtkZWZhdWx0OiAkX190YWJsZVZpZXdfX30pLlRhYmxlVmlldztcbnZhciBEYXRhU291cmNlID0gKCRfX2RhdGFTb3VyY2VfXyA9IF9kZXJlcV8oXCJkYXRhU291cmNlXCIpLCAkX19kYXRhU291cmNlX18gJiYgJF9fZGF0YVNvdXJjZV9fLl9fZXNNb2R1bGUgJiYgJF9fZGF0YVNvdXJjZV9fIHx8IHtkZWZhdWx0OiAkX19kYXRhU291cmNlX199KS5EYXRhU291cmNlO1xudmFyICRfXzE4ID0gKCRfX2hlbHBlcnNfNDdfZGF0YV9fID0gX2RlcmVxXyhcImhlbHBlcnMvZGF0YVwiKSwgJF9faGVscGVyc180N19kYXRhX18gJiYgJF9faGVscGVyc180N19kYXRhX18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X2RhdGFfXyB8fCB7ZGVmYXVsdDogJF9faGVscGVyc180N19kYXRhX199KSxcbiAgICB0cmFuc2xhdGVSb3dzVG9Db2x1bW5zID0gJF9fMTgudHJhbnNsYXRlUm93c1RvQ29sdW1ucyxcbiAgICBjZWxsTWV0aG9kTG9va3VwRmFjdG9yeSA9ICRfXzE4LmNlbGxNZXRob2RMb29rdXBGYWN0b3J5LFxuICAgIHNwcmVhZHNoZWV0Q29sdW1uTGFiZWwgPSAkX18xOC5zcHJlYWRzaGVldENvbHVtbkxhYmVsO1xudmFyIGdldFRyYW5zbGF0b3IgPSAoJF9fdXRpbHNfNDdfcmVjb3JkVHJhbnNsYXRvcl9fID0gX2RlcmVxXyhcInV0aWxzL3JlY29yZFRyYW5zbGF0b3JcIiksICRfX3V0aWxzXzQ3X3JlY29yZFRyYW5zbGF0b3JfXyAmJiAkX191dGlsc180N19yZWNvcmRUcmFuc2xhdG9yX18uX19lc01vZHVsZSAmJiAkX191dGlsc180N19yZWNvcmRUcmFuc2xhdG9yX18gfHwge2RlZmF1bHQ6ICRfX3V0aWxzXzQ3X3JlY29yZFRyYW5zbGF0b3JfX30pLmdldFRyYW5zbGF0b3I7XG52YXIgV2Fsa29udGFibGVDZWxsQ29vcmRzID0gKCRfXzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19fID0gX2RlcmVxXyhcIjNyZHBhcnR5L3dhbGtvbnRhYmxlL3NyYy9jZWxsL2Nvb3Jkc1wiKSwgJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX18gJiYgJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX18uX19lc01vZHVsZSAmJiAkX18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2VsbF80N19jb29yZHNfXyB8fCB7ZGVmYXVsdDogJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX199KS5XYWxrb250YWJsZUNlbGxDb29yZHM7XG52YXIgV2Fsa29udGFibGVDZWxsUmFuZ2UgPSAoJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfcmFuZ2VfXyA9IF9kZXJlcV8oXCIzcmRwYXJ0eS93YWxrb250YWJsZS9zcmMvY2VsbC9yYW5nZVwiKSwgJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfcmFuZ2VfXyAmJiAkX18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2VsbF80N19yYW5nZV9fLl9fZXNNb2R1bGUgJiYgJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfcmFuZ2VfXyB8fCB7ZGVmYXVsdDogJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfcmFuZ2VfX30pLldhbGtvbnRhYmxlQ2VsbFJhbmdlO1xudmFyIFdhbGtvbnRhYmxlVmlld3BvcnRDb2x1bW5zQ2FsY3VsYXRvciA9ICgkX18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2FsY3VsYXRvcl80N192aWV3cG9ydENvbHVtbnNfXyA9IF9kZXJlcV8oXCIzcmRwYXJ0eS93YWxrb250YWJsZS9zcmMvY2FsY3VsYXRvci92aWV3cG9ydENvbHVtbnNcIiksICRfXzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jYWxjdWxhdG9yXzQ3X3ZpZXdwb3J0Q29sdW1uc19fICYmICRfXzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jYWxjdWxhdG9yXzQ3X3ZpZXdwb3J0Q29sdW1uc19fLl9fZXNNb2R1bGUgJiYgJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NhbGN1bGF0b3JfNDdfdmlld3BvcnRDb2x1bW5zX18gfHwge2RlZmF1bHQ6ICRfXzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jYWxjdWxhdG9yXzQ3X3ZpZXdwb3J0Q29sdW1uc19ffSkuV2Fsa29udGFibGVWaWV3cG9ydENvbHVtbnNDYWxjdWxhdG9yO1xuSGFuZHNvbnRhYmxlLmFjdGl2ZUd1aWQgPSBudWxsO1xuSGFuZHNvbnRhYmxlLkNvcmUgPSBmdW5jdGlvbiBDb3JlKHJvb3RFbGVtZW50LCB1c2VyU2V0dGluZ3MpIHtcbiAgdmFyIHByaXYsXG4gICAgICBkYXRhbWFwLFxuICAgICAgZGF0YVNvdXJjZSxcbiAgICAgIGdyaWQsXG4gICAgICBzZWxlY3Rpb24sXG4gICAgICBlZGl0b3JNYW5hZ2VyLFxuICAgICAgaW5zdGFuY2UgPSB0aGlzLFxuICAgICAgR3JpZFNldHRpbmdzID0gZnVuY3Rpb24oKSB7fSxcbiAgICAgIGV2ZW50TWFuYWdlciA9IGV2ZW50TWFuYWdlck9iamVjdChpbnN0YW5jZSk7XG4gIHZhciByZWNvcmRUcmFuc2xhdG9yID0gZ2V0VHJhbnNsYXRvcihpbnN0YW5jZSk7XG4gIGV4dGVuZChHcmlkU2V0dGluZ3MucHJvdG90eXBlLCBEZWZhdWx0U2V0dGluZ3MucHJvdG90eXBlKTtcbiAgZXh0ZW5kKEdyaWRTZXR0aW5ncy5wcm90b3R5cGUsIHVzZXJTZXR0aW5ncyk7XG4gIGV4dGVuZChHcmlkU2V0dGluZ3MucHJvdG90eXBlLCBleHBhbmRUeXBlKHVzZXJTZXR0aW5ncykpO1xuICB0aGlzLnJvb3RFbGVtZW50ID0gcm9vdEVsZW1lbnQ7XG4gIHRoaXMuaXNIb3RUYWJsZUVudiA9IGlzQ2hpbGRPZldlYkNvbXBvbmVudFRhYmxlKHRoaXMucm9vdEVsZW1lbnQpO1xuICBIYW5kc29udGFibGUuZXZlbnRNYW5hZ2VyLmlzSG90VGFibGVFbnYgPSB0aGlzLmlzSG90VGFibGVFbnY7XG4gIHRoaXMuY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnRElWJyk7XG4gIHRoaXMucmVuZGVyQ2FsbCA9IGZhbHNlO1xuICByb290RWxlbWVudC5pbnNlcnRCZWZvcmUodGhpcy5jb250YWluZXIsIHJvb3RFbGVtZW50LmZpcnN0Q2hpbGQpO1xuICB0aGlzLmd1aWQgPSAnaHRfJyArIHJhbmRvbVN0cmluZygpO1xuICBkYXRhU291cmNlID0gbmV3IERhdGFTb3VyY2UoaW5zdGFuY2UpO1xuICBpZiAoIXRoaXMucm9vdEVsZW1lbnQuaWQgfHwgdGhpcy5yb290RWxlbWVudC5pZC5zdWJzdHJpbmcoMCwgMykgPT09ICdodF8nKSB7XG4gICAgdGhpcy5yb290RWxlbWVudC5pZCA9IHRoaXMuZ3VpZDtcbiAgfVxuICBwcml2ID0ge1xuICAgIGNlbGxTZXR0aW5nczogW10sXG4gICAgY29sdW1uU2V0dGluZ3M6IFtdLFxuICAgIGNvbHVtbnNTZXR0aW5nQ29uZmxpY3RzOiBbJ2RhdGEnLCAnd2lkdGgnXSxcbiAgICBzZXR0aW5nczogbmV3IEdyaWRTZXR0aW5ncygpLFxuICAgIHNlbFJhbmdlOiBudWxsLFxuICAgIGlzUG9wdWxhdGVkOiBudWxsLFxuICAgIHNjcm9sbGFibGU6IG51bGwsXG4gICAgZmlyc3RSdW46IHRydWVcbiAgfTtcbiAgZ3JpZCA9IHtcbiAgICBhbHRlcjogZnVuY3Rpb24oYWN0aW9uLCBpbmRleCwgYW1vdW50LCBzb3VyY2UsIGtlZXBFbXB0eVJvd3MpIHtcbiAgICAgIHZhciBkZWx0YTtcbiAgICAgIGFtb3VudCA9IGFtb3VudCB8fCAxO1xuICAgICAgZnVuY3Rpb24gc3BsaWNlV2l0aChkYXRhLCBpbmRleCwgY291bnQsIHRvSW5qZWN0KSB7XG4gICAgICAgIHZhciB2YWx1ZUZhY3RvcnkgPSAoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIHJlc3VsdDtcbiAgICAgICAgICBpZiAodG9JbmplY3QgPT09ICdhcnJheScpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IFtdO1xuICAgICAgICAgIH0gZWxzZSBpZiAodG9JbmplY3QgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICByZXN1bHQgPSB7fTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBzcGxpY2VBcmdzID0gYXJyYXlNYXAobmV3IEFycmF5KGNvdW50KSwgKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB2YWx1ZUZhY3RvcnkoKTtcbiAgICAgICAgfSkpO1xuICAgICAgICBzcGxpY2VBcmdzLnVuc2hpZnQoaW5kZXgsIDApO1xuICAgICAgICBkYXRhLnNwbGljZS5hcHBseShkYXRhLCBzcGxpY2VBcmdzKTtcbiAgICAgIH1cbiAgICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICAgIGNhc2UgJ2luc2VydF9yb3cnOlxuICAgICAgICAgIHZhciBudW1iZXJPZlNvdXJjZVJvd3MgPSBpbnN0YW5jZS5jb3VudFNvdXJjZVJvd3MoKTtcbiAgICAgICAgICBpZiAoaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5tYXhSb3dzID09PSBudW1iZXJPZlNvdXJjZVJvd3MpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgaW5kZXggPSAoaXNEZWZpbmVkKGluZGV4KSkgPyBpbmRleCA6IG51bWJlck9mU291cmNlUm93cztcbiAgICAgICAgICBkZWx0YSA9IGRhdGFtYXAuY3JlYXRlUm93KGluZGV4LCBhbW91bnQsIHNvdXJjZSk7XG4gICAgICAgICAgc3BsaWNlV2l0aChwcml2LmNlbGxTZXR0aW5ncywgaW5kZXgsIGFtb3VudCwgJ2FycmF5Jyk7XG4gICAgICAgICAgaWYgKGRlbHRhKSB7XG4gICAgICAgICAgICBpZiAoc2VsZWN0aW9uLmlzU2VsZWN0ZWQoKSAmJiBwcml2LnNlbFJhbmdlLmZyb20ucm93ID49IGluZGV4KSB7XG4gICAgICAgICAgICAgIHByaXYuc2VsUmFuZ2UuZnJvbS5yb3cgPSBwcml2LnNlbFJhbmdlLmZyb20ucm93ICsgZGVsdGE7XG4gICAgICAgICAgICAgIHNlbGVjdGlvbi50cmFuc2Zvcm1FbmQoZGVsdGEsIDApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgc2VsZWN0aW9uLnJlZnJlc2hCb3JkZXJzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdpbnNlcnRfY29sJzpcbiAgICAgICAgICBkZWx0YSA9IGRhdGFtYXAuY3JlYXRlQ29sKGluZGV4LCBhbW91bnQsIHNvdXJjZSk7XG4gICAgICAgICAgZm9yICh2YXIgcm93ID0gMCxcbiAgICAgICAgICAgICAgbGVuID0gaW5zdGFuY2UuY291bnRTb3VyY2VSb3dzKCk7IHJvdyA8IGxlbjsgcm93KyspIHtcbiAgICAgICAgICAgIGlmIChwcml2LmNlbGxTZXR0aW5nc1tyb3ddKSB7XG4gICAgICAgICAgICAgIHNwbGljZVdpdGgocHJpdi5jZWxsU2V0dGluZ3Nbcm93XSwgaW5kZXgsIGFtb3VudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChkZWx0YSkge1xuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5jb2xIZWFkZXJzKSkge1xuICAgICAgICAgICAgICB2YXIgc3BsaWNlQXJyYXkgPSBbaW5kZXgsIDBdO1xuICAgICAgICAgICAgICBzcGxpY2VBcnJheS5sZW5ndGggKz0gZGVsdGE7XG4gICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5zcGxpY2UuYXBwbHkoaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5jb2xIZWFkZXJzLCBzcGxpY2VBcnJheSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2VsZWN0aW9uLmlzU2VsZWN0ZWQoKSAmJiBwcml2LnNlbFJhbmdlLmZyb20uY29sID49IGluZGV4KSB7XG4gICAgICAgICAgICAgIHByaXYuc2VsUmFuZ2UuZnJvbS5jb2wgPSBwcml2LnNlbFJhbmdlLmZyb20uY29sICsgZGVsdGE7XG4gICAgICAgICAgICAgIHNlbGVjdGlvbi50cmFuc2Zvcm1FbmQoMCwgZGVsdGEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgc2VsZWN0aW9uLnJlZnJlc2hCb3JkZXJzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdyZW1vdmVfcm93JzpcbiAgICAgICAgICBkYXRhbWFwLnJlbW92ZVJvdyhpbmRleCwgYW1vdW50LCBzb3VyY2UpO1xuICAgICAgICAgIHByaXYuY2VsbFNldHRpbmdzLnNwbGljZShpbmRleCwgYW1vdW50KTtcbiAgICAgICAgICB2YXIgdG90YWxSb3dzID0gaW5zdGFuY2UuY291bnRSb3dzKCk7XG4gICAgICAgICAgdmFyIGZpeGVkUm93c1RvcCA9IGluc3RhbmNlLmdldFNldHRpbmdzKCkuZml4ZWRSb3dzVG9wO1xuICAgICAgICAgIGlmIChmaXhlZFJvd3NUb3AgPj0gaW5kZXggKyAxKSB7XG4gICAgICAgICAgICBpbnN0YW5jZS5nZXRTZXR0aW5ncygpLmZpeGVkUm93c1RvcCAtPSBNYXRoLm1pbihhbW91bnQsIGZpeGVkUm93c1RvcCAtIGluZGV4KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGZpeGVkUm93c0JvdHRvbSA9IGluc3RhbmNlLmdldFNldHRpbmdzKCkuZml4ZWRSb3dzQm90dG9tO1xuICAgICAgICAgIGlmIChmaXhlZFJvd3NCb3R0b20gJiYgaW5kZXggPj0gdG90YWxSb3dzIC0gZml4ZWRSb3dzQm90dG9tKSB7XG4gICAgICAgICAgICBpbnN0YW5jZS5nZXRTZXR0aW5ncygpLmZpeGVkUm93c0JvdHRvbSAtPSBNYXRoLm1pbihhbW91bnQsIGZpeGVkUm93c0JvdHRvbSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGdyaWQuYWRqdXN0Um93c0FuZENvbHMoKTtcbiAgICAgICAgICBzZWxlY3Rpb24ucmVmcmVzaEJvcmRlcnMoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAncmVtb3ZlX2NvbCc6XG4gICAgICAgICAgdmFyIGxvZ2ljYWxDb2x1bW5JbmRleCA9IHJlY29yZFRyYW5zbGF0b3IudG9QaHlzaWNhbENvbHVtbihpbmRleCk7XG4gICAgICAgICAgZGF0YW1hcC5yZW1vdmVDb2woaW5kZXgsIGFtb3VudCwgc291cmNlKTtcbiAgICAgICAgICBmb3IgKHZhciByb3ckX18yNyA9IDAsXG4gICAgICAgICAgICAgIGxlbiRfXzI4ID0gaW5zdGFuY2UuY291bnRTb3VyY2VSb3dzKCk7IHJvdyRfXzI3IDwgbGVuJF9fMjg7IHJvdyRfXzI3KyspIHtcbiAgICAgICAgICAgIGlmIChwcml2LmNlbGxTZXR0aW5nc1tyb3ckX18yN10pIHtcbiAgICAgICAgICAgICAgcHJpdi5jZWxsU2V0dGluZ3Nbcm93JF9fMjddLnNwbGljZShsb2dpY2FsQ29sdW1uSW5kZXgsIGFtb3VudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBmaXhlZENvbHVtbnNMZWZ0ID0gaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5maXhlZENvbHVtbnNMZWZ0O1xuICAgICAgICAgIGlmIChmaXhlZENvbHVtbnNMZWZ0ID49IGluZGV4ICsgMSkge1xuICAgICAgICAgICAgaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5maXhlZENvbHVtbnNMZWZ0IC09IE1hdGgubWluKGFtb3VudCwgZml4ZWRDb2x1bW5zTGVmdCAtIGluZGV4KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5jb2xIZWFkZXJzKSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBsb2dpY2FsQ29sdW1uSW5kZXggPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgbG9naWNhbENvbHVtbkluZGV4ID0gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpbnN0YW5jZS5nZXRTZXR0aW5ncygpLmNvbEhlYWRlcnMuc3BsaWNlKGxvZ2ljYWxDb2x1bW5JbmRleCwgYW1vdW50KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZ3JpZC5hZGp1c3RSb3dzQW5kQ29scygpO1xuICAgICAgICAgIHNlbGVjdGlvbi5yZWZyZXNoQm9yZGVycygpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlcmUgaXMgbm8gc3VjaCBhY3Rpb24gXCInICsgYWN0aW9uICsgJ1wiJyk7XG4gICAgICB9XG4gICAgICBpZiAoIWtlZXBFbXB0eVJvd3MpIHtcbiAgICAgICAgZ3JpZC5hZGp1c3RSb3dzQW5kQ29scygpO1xuICAgICAgfVxuICAgIH0sXG4gICAgYWRqdXN0Um93c0FuZENvbHM6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHByaXYuc2V0dGluZ3MubWluUm93cykge1xuICAgICAgICB2YXIgcm93cyA9IGluc3RhbmNlLmNvdW50Um93cygpO1xuICAgICAgICBpZiAocm93cyA8IHByaXYuc2V0dGluZ3MubWluUm93cykge1xuICAgICAgICAgIGZvciAodmFyIHIgPSAwLFxuICAgICAgICAgICAgICBtaW5Sb3dzID0gcHJpdi5zZXR0aW5ncy5taW5Sb3dzOyByIDwgbWluUm93cyAtIHJvd3M7IHIrKykge1xuICAgICAgICAgICAgZGF0YW1hcC5jcmVhdGVSb3coaW5zdGFuY2UuY291bnRSb3dzKCksIDEsICdhdXRvJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAocHJpdi5zZXR0aW5ncy5taW5TcGFyZVJvd3MpIHtcbiAgICAgICAgdmFyIGVtcHR5Um93cyA9IGluc3RhbmNlLmNvdW50RW1wdHlSb3dzKHRydWUpO1xuICAgICAgICBpZiAoZW1wdHlSb3dzIDwgcHJpdi5zZXR0aW5ncy5taW5TcGFyZVJvd3MpIHtcbiAgICAgICAgICBmb3IgKDsgZW1wdHlSb3dzIDwgcHJpdi5zZXR0aW5ncy5taW5TcGFyZVJvd3MgJiYgaW5zdGFuY2UuY291bnRTb3VyY2VSb3dzKCkgPCBwcml2LnNldHRpbmdzLm1heFJvd3M7IGVtcHR5Um93cysrKSB7XG4gICAgICAgICAgICBkYXRhbWFwLmNyZWF0ZVJvdyhpbnN0YW5jZS5jb3VudFJvd3MoKSwgMSwgJ2F1dG8nKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHtcbiAgICAgICAgdmFyIGVtcHR5Q29scztcbiAgICAgICAgaWYgKHByaXYuc2V0dGluZ3MubWluQ29scyB8fCBwcml2LnNldHRpbmdzLm1pblNwYXJlQ29scykge1xuICAgICAgICAgIGVtcHR5Q29scyA9IGluc3RhbmNlLmNvdW50RW1wdHlDb2xzKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwcml2LnNldHRpbmdzLm1pbkNvbHMgJiYgIXByaXYuc2V0dGluZ3MuY29sdW1ucyAmJiBpbnN0YW5jZS5jb3VudENvbHMoKSA8IHByaXYuc2V0dGluZ3MubWluQ29scykge1xuICAgICAgICAgIGZvciAoOyBpbnN0YW5jZS5jb3VudENvbHMoKSA8IHByaXYuc2V0dGluZ3MubWluQ29sczsgZW1wdHlDb2xzKyspIHtcbiAgICAgICAgICAgIGRhdGFtYXAuY3JlYXRlQ29sKGluc3RhbmNlLmNvdW50Q29scygpLCAxLCAnYXV0bycpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAocHJpdi5zZXR0aW5ncy5taW5TcGFyZUNvbHMgJiYgIXByaXYuc2V0dGluZ3MuY29sdW1ucyAmJiBpbnN0YW5jZS5kYXRhVHlwZSA9PT0gJ2FycmF5JyAmJiBlbXB0eUNvbHMgPCBwcml2LnNldHRpbmdzLm1pblNwYXJlQ29scykge1xuICAgICAgICAgIGZvciAoOyBlbXB0eUNvbHMgPCBwcml2LnNldHRpbmdzLm1pblNwYXJlQ29scyAmJiBpbnN0YW5jZS5jb3VudENvbHMoKSA8IHByaXYuc2V0dGluZ3MubWF4Q29sczsgZW1wdHlDb2xzKyspIHtcbiAgICAgICAgICAgIGRhdGFtYXAuY3JlYXRlQ29sKGluc3RhbmNlLmNvdW50Q29scygpLCAxLCAnYXV0bycpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdmFyIHJvd0NvdW50ID0gaW5zdGFuY2UuY291bnRSb3dzKCk7XG4gICAgICB2YXIgY29sQ291bnQgPSBpbnN0YW5jZS5jb3VudENvbHMoKTtcbiAgICAgIGlmIChyb3dDb3VudCA9PT0gMCB8fCBjb2xDb3VudCA9PT0gMCkge1xuICAgICAgICBzZWxlY3Rpb24uZGVzZWxlY3QoKTtcbiAgICAgIH1cbiAgICAgIGlmIChzZWxlY3Rpb24uaXNTZWxlY3RlZCgpKSB7XG4gICAgICAgIHZhciBzZWxlY3Rpb25DaGFuZ2VkID0gZmFsc2U7XG4gICAgICAgIHZhciBmcm9tUm93ID0gcHJpdi5zZWxSYW5nZS5mcm9tLnJvdztcbiAgICAgICAgdmFyIGZyb21Db2wgPSBwcml2LnNlbFJhbmdlLmZyb20uY29sO1xuICAgICAgICB2YXIgdG9Sb3cgPSBwcml2LnNlbFJhbmdlLnRvLnJvdztcbiAgICAgICAgdmFyIHRvQ29sID0gcHJpdi5zZWxSYW5nZS50by5jb2w7XG4gICAgICAgIGlmIChmcm9tUm93ID4gcm93Q291bnQgLSAxKSB7XG4gICAgICAgICAgZnJvbVJvdyA9IHJvd0NvdW50IC0gMTtcbiAgICAgICAgICBzZWxlY3Rpb25DaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICBpZiAodG9Sb3cgPiBmcm9tUm93KSB7XG4gICAgICAgICAgICB0b1JvdyA9IGZyb21Sb3c7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHRvUm93ID4gcm93Q291bnQgLSAxKSB7XG4gICAgICAgICAgdG9Sb3cgPSByb3dDb3VudCAtIDE7XG4gICAgICAgICAgc2VsZWN0aW9uQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgaWYgKGZyb21Sb3cgPiB0b1Jvdykge1xuICAgICAgICAgICAgZnJvbVJvdyA9IHRvUm93O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZnJvbUNvbCA+IGNvbENvdW50IC0gMSkge1xuICAgICAgICAgIGZyb21Db2wgPSBjb2xDb3VudCAtIDE7XG4gICAgICAgICAgc2VsZWN0aW9uQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgaWYgKHRvQ29sID4gZnJvbUNvbCkge1xuICAgICAgICAgICAgdG9Db2wgPSBmcm9tQ29sO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0b0NvbCA+IGNvbENvdW50IC0gMSkge1xuICAgICAgICAgIHRvQ29sID0gY29sQ291bnQgLSAxO1xuICAgICAgICAgIHNlbGVjdGlvbkNoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgIGlmIChmcm9tQ29sID4gdG9Db2wpIHtcbiAgICAgICAgICAgIGZyb21Db2wgPSB0b0NvbDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGVjdGlvbkNoYW5nZWQpIHtcbiAgICAgICAgICBpbnN0YW5jZS5zZWxlY3RDZWxsKGZyb21Sb3csIGZyb21Db2wsIHRvUm93LCB0b0NvbCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChpbnN0YW5jZS52aWV3KSB7XG4gICAgICAgIGluc3RhbmNlLnZpZXcud3Qud3RPdmVybGF5cy5hZGp1c3RFbGVtZW50c1NpemUoKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHBvcHVsYXRlRnJvbUFycmF5OiBmdW5jdGlvbihzdGFydCwgaW5wdXQsIGVuZCwgc291cmNlLCBtZXRob2QsIGRpcmVjdGlvbiwgZGVsdGFzKSB7XG4gICAgICB2YXIgcixcbiAgICAgICAgICBybGVuLFxuICAgICAgICAgIGMsXG4gICAgICAgICAgY2xlbixcbiAgICAgICAgICBzZXREYXRhID0gW10sXG4gICAgICAgICAgY3VycmVudCA9IHt9O1xuICAgICAgcmxlbiA9IGlucHV0Lmxlbmd0aDtcbiAgICAgIGlmIChybGVuID09PSAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHZhciByZXBlYXRDb2wsXG4gICAgICAgICAgcmVwZWF0Um93LFxuICAgICAgICAgIGNtYXgsXG4gICAgICAgICAgcm1heCxcbiAgICAgICAgICBiYXNlRW5kID0ge1xuICAgICAgICAgICAgcm93OiBlbmQgPT09IG51bGwgPyBudWxsIDogZW5kLnJvdyxcbiAgICAgICAgICAgIGNvbDogZW5kID09PSBudWxsID8gbnVsbCA6IGVuZC5jb2xcbiAgICAgICAgICB9O1xuICAgICAgc3dpdGNoIChtZXRob2QpIHtcbiAgICAgICAgY2FzZSAnc2hpZnRfZG93bic6XG4gICAgICAgICAgcmVwZWF0Q29sID0gZW5kID8gZW5kLmNvbCAtIHN0YXJ0LmNvbCArIDEgOiAwO1xuICAgICAgICAgIHJlcGVhdFJvdyA9IGVuZCA/IGVuZC5yb3cgLSBzdGFydC5yb3cgKyAxIDogMDtcbiAgICAgICAgICBpbnB1dCA9IHRyYW5zbGF0ZVJvd3NUb0NvbHVtbnMoaW5wdXQpO1xuICAgICAgICAgIGZvciAoYyA9IDAsIGNsZW4gPSBpbnB1dC5sZW5ndGgsIGNtYXggPSBNYXRoLm1heChjbGVuLCByZXBlYXRDb2wpOyBjIDwgY21heDsgYysrKSB7XG4gICAgICAgICAgICBpZiAoYyA8IGNsZW4pIHtcbiAgICAgICAgICAgICAgZm9yIChyID0gMCwgcmxlbiA9IGlucHV0W2NdLmxlbmd0aDsgciA8IHJlcGVhdFJvdyAtIHJsZW47IHIrKykge1xuICAgICAgICAgICAgICAgIGlucHV0W2NdLnB1c2goaW5wdXRbY11bciAlIHJsZW5dKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBpbnB1dFtjXS51bnNoaWZ0KHN0YXJ0LmNvbCArIGMsIHN0YXJ0LnJvdywgMCk7XG4gICAgICAgICAgICAgIGluc3RhbmNlLnNwbGljZUNvbC5hcHBseShpbnN0YW5jZSwgaW5wdXRbY10pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgaW5wdXRbYyAlIGNsZW5dWzBdID0gc3RhcnQuY29sICsgYztcbiAgICAgICAgICAgICAgaW5zdGFuY2Uuc3BsaWNlQ29sLmFwcGx5KGluc3RhbmNlLCBpbnB1dFtjICUgY2xlbl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnc2hpZnRfcmlnaHQnOlxuICAgICAgICAgIHJlcGVhdENvbCA9IGVuZCA/IGVuZC5jb2wgLSBzdGFydC5jb2wgKyAxIDogMDtcbiAgICAgICAgICByZXBlYXRSb3cgPSBlbmQgPyBlbmQucm93IC0gc3RhcnQucm93ICsgMSA6IDA7XG4gICAgICAgICAgZm9yIChyID0gMCwgcmxlbiA9IGlucHV0Lmxlbmd0aCwgcm1heCA9IE1hdGgubWF4KHJsZW4sIHJlcGVhdFJvdyk7IHIgPCBybWF4OyByKyspIHtcbiAgICAgICAgICAgIGlmIChyIDwgcmxlbikge1xuICAgICAgICAgICAgICBmb3IgKGMgPSAwLCBjbGVuID0gaW5wdXRbcl0ubGVuZ3RoOyBjIDwgcmVwZWF0Q29sIC0gY2xlbjsgYysrKSB7XG4gICAgICAgICAgICAgICAgaW5wdXRbcl0ucHVzaChpbnB1dFtyXVtjICUgY2xlbl0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGlucHV0W3JdLnVuc2hpZnQoc3RhcnQucm93ICsgciwgc3RhcnQuY29sLCAwKTtcbiAgICAgICAgICAgICAgaW5zdGFuY2Uuc3BsaWNlUm93LmFwcGx5KGluc3RhbmNlLCBpbnB1dFtyXSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBpbnB1dFtyICUgcmxlbl1bMF0gPSBzdGFydC5yb3cgKyByO1xuICAgICAgICAgICAgICBpbnN0YW5jZS5zcGxpY2VSb3cuYXBwbHkoaW5zdGFuY2UsIGlucHV0W3IgJSBybGVuXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdvdmVyd3JpdGUnOlxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGN1cnJlbnQucm93ID0gc3RhcnQucm93O1xuICAgICAgICAgIGN1cnJlbnQuY29sID0gc3RhcnQuY29sO1xuICAgICAgICAgIHZhciBzZWxlY3RlZCA9IHtcbiAgICAgICAgICAgIHJvdzogKGVuZCAmJiBzdGFydCkgPyAoZW5kLnJvdyAtIHN0YXJ0LnJvdyArIDEpIDogMSxcbiAgICAgICAgICAgIGNvbDogKGVuZCAmJiBzdGFydCkgPyAoZW5kLmNvbCAtIHN0YXJ0LmNvbCArIDEpIDogMVxuICAgICAgICAgIH07XG4gICAgICAgICAgdmFyIHNraXBwZWRSb3cgPSAwO1xuICAgICAgICAgIHZhciBza2lwcGVkQ29sdW1uID0gMDtcbiAgICAgICAgICB2YXIgcHVzaERhdGEgPSB0cnVlO1xuICAgICAgICAgIHZhciBjZWxsTWV0YTtcbiAgICAgICAgICB2YXIgZ2V0SW5wdXRWYWx1ZSA9IGZ1bmN0aW9uIGdldElucHV0VmFsdWUocm93KSB7XG4gICAgICAgICAgICB2YXIgY29sID0gYXJndW1lbnRzWzFdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1sxXSA6IG51bGw7XG4gICAgICAgICAgICB2YXIgcm93VmFsdWUgPSBpbnB1dFtyb3cgJSBpbnB1dC5sZW5ndGhdO1xuICAgICAgICAgICAgaWYgKGNvbCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICByZXR1cm4gcm93VmFsdWVbY29sICUgcm93VmFsdWUubGVuZ3RoXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByb3dWYWx1ZTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIHZhciByb3dJbnB1dExlbmd0aCA9IGlucHV0Lmxlbmd0aDtcbiAgICAgICAgICB2YXIgcm93U2VsZWN0aW9uTGVuZ3RoID0gZW5kID8gZW5kLnJvdyAtIHN0YXJ0LnJvdyArIDEgOiAwO1xuICAgICAgICAgIGlmIChlbmQpIHtcbiAgICAgICAgICAgIHJsZW4gPSByb3dTZWxlY3Rpb25MZW5ndGg7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJsZW4gPSBNYXRoLm1heChyb3dJbnB1dExlbmd0aCwgcm93U2VsZWN0aW9uTGVuZ3RoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZm9yIChyID0gMDsgciA8IHJsZW47IHIrKykge1xuICAgICAgICAgICAgaWYgKChlbmQgJiYgY3VycmVudC5yb3cgPiBlbmQucm93ICYmIHJvd1NlbGVjdGlvbkxlbmd0aCA+IHJvd0lucHV0TGVuZ3RoKSB8fCAoIXByaXYuc2V0dGluZ3MuYWxsb3dJbnNlcnRSb3cgJiYgY3VycmVudC5yb3cgPiBpbnN0YW5jZS5jb3VudFJvd3MoKSAtIDEpIHx8IChjdXJyZW50LnJvdyA+PSBwcml2LnNldHRpbmdzLm1heFJvd3MpKSB7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGxvZ2ljYWxSb3cgPSByIC0gc2tpcHBlZFJvdztcbiAgICAgICAgICAgIHZhciBjb2xJbnB1dExlbmd0aCA9IGdldElucHV0VmFsdWUobG9naWNhbFJvdykubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGNvbFNlbGVjdGlvbkxlbmd0aCA9IGVuZCA/IGVuZC5jb2wgLSBzdGFydC5jb2wgKyAxIDogMDtcbiAgICAgICAgICAgIGlmIChlbmQpIHtcbiAgICAgICAgICAgICAgY2xlbiA9IGNvbFNlbGVjdGlvbkxlbmd0aDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNsZW4gPSBNYXRoLm1heChjb2xJbnB1dExlbmd0aCwgY29sU2VsZWN0aW9uTGVuZ3RoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN1cnJlbnQuY29sID0gc3RhcnQuY29sO1xuICAgICAgICAgICAgY2VsbE1ldGEgPSBpbnN0YW5jZS5nZXRDZWxsTWV0YShjdXJyZW50LnJvdywgY3VycmVudC5jb2wpO1xuICAgICAgICAgICAgaWYgKChzb3VyY2UgPT09ICdDb3B5UGFzdGUucGFzdGUnIHx8IHNvdXJjZSA9PT0gJ0F1dG9maWxsLmF1dG9maWxsJykgJiYgY2VsbE1ldGEuc2tpcFJvd09uUGFzdGUpIHtcbiAgICAgICAgICAgICAgc2tpcHBlZFJvdysrO1xuICAgICAgICAgICAgICBjdXJyZW50LnJvdysrO1xuICAgICAgICAgICAgICBybGVuKys7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2tpcHBlZENvbHVtbiA9IDA7XG4gICAgICAgICAgICBmb3IgKGMgPSAwOyBjIDwgY2xlbjsgYysrKSB7XG4gICAgICAgICAgICAgIGlmICgoZW5kICYmIGN1cnJlbnQuY29sID4gZW5kLmNvbCAmJiBjb2xTZWxlY3Rpb25MZW5ndGggPiBjb2xJbnB1dExlbmd0aCkgfHwgKCFwcml2LnNldHRpbmdzLmFsbG93SW5zZXJ0Q29sdW1uICYmIGN1cnJlbnQuY29sID4gaW5zdGFuY2UuY291bnRDb2xzKCkgLSAxKSB8fCAoY3VycmVudC5jb2wgPj0gcHJpdi5zZXR0aW5ncy5tYXhDb2xzKSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNlbGxNZXRhID0gaW5zdGFuY2UuZ2V0Q2VsbE1ldGEoY3VycmVudC5yb3csIGN1cnJlbnQuY29sKTtcbiAgICAgICAgICAgICAgaWYgKChzb3VyY2UgPT09ICdDb3B5UGFzdGUucGFzdGUnIHx8IHNvdXJjZSA9PT0gJ0F1dG9maWxsLmZpbGwnKSAmJiBjZWxsTWV0YS5za2lwQ29sdW1uT25QYXN0ZSkge1xuICAgICAgICAgICAgICAgIHNraXBwZWRDb2x1bW4rKztcbiAgICAgICAgICAgICAgICBjdXJyZW50LmNvbCsrO1xuICAgICAgICAgICAgICAgIGNsZW4rKztcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBpZiAoY2VsbE1ldGEucmVhZE9ubHkpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50LmNvbCsrO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHZhciBsb2dpY2FsQ29sdW1uID0gYyAtIHNraXBwZWRDb2x1bW47XG4gICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGdldElucHV0VmFsdWUobG9naWNhbFJvdywgbG9naWNhbENvbHVtbik7XG4gICAgICAgICAgICAgIHZhciBvcmdWYWx1ZSA9IGluc3RhbmNlLmdldERhdGFBdENlbGwoY3VycmVudC5yb3csIGN1cnJlbnQuY29sKTtcbiAgICAgICAgICAgICAgdmFyIGluZGV4ID0ge1xuICAgICAgICAgICAgICAgIHJvdzogbG9naWNhbFJvdyxcbiAgICAgICAgICAgICAgICBjb2w6IGxvZ2ljYWxDb2x1bW5cbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgaWYgKHNvdXJjZSA9PT0gJ0F1dG9maWxsLmZpbGwnKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGluc3RhbmNlLnJ1bkhvb2tzKCdiZWZvcmVBdXRvZmlsbEluc2lkZVBvcHVsYXRlJywgaW5kZXgsIGRpcmVjdGlvbiwgaW5wdXQsIGRlbHRhcywge30sIHNlbGVjdGVkKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICB2YWx1ZSA9IGlzVW5kZWZpbmVkKHJlc3VsdC52YWx1ZSkgPyB2YWx1ZSA6IHJlc3VsdC52YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICBpZiAob3JnVmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIG9yZ1ZhbHVlICE9PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgcHVzaERhdGEgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgdmFyIG9yZ1ZhbHVlU2NoZW1hID0gZHVja1NjaGVtYShvcmdWYWx1ZVswXSB8fCBvcmdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICB2YXIgdmFsdWVTY2hlbWEgPSBkdWNrU2NoZW1hKHZhbHVlWzBdIHx8IHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgIGlmIChpc09iamVjdEVxdWFscyhvcmdWYWx1ZVNjaGVtYSwgdmFsdWVTY2hlbWEpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZGVlcENsb25lKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHB1c2hEYXRhID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9IGVsc2UgaWYgKG9yZ1ZhbHVlICE9PSBudWxsICYmIHR5cGVvZiBvcmdWYWx1ZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICBwdXNoRGF0YSA9IGZhbHNlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGlmIChwdXNoRGF0YSkge1xuICAgICAgICAgICAgICAgIHNldERhdGEucHVzaChbY3VycmVudC5yb3csIGN1cnJlbnQuY29sLCB2YWx1ZV0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHB1c2hEYXRhID0gdHJ1ZTtcbiAgICAgICAgICAgICAgY3VycmVudC5jb2wrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN1cnJlbnQucm93Kys7XG4gICAgICAgICAgfVxuICAgICAgICAgIGluc3RhbmNlLnNldERhdGFBdENlbGwoc2V0RGF0YSwgbnVsbCwgbnVsbCwgc291cmNlIHx8ICdwb3B1bGF0ZUZyb21BcnJheScpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgdGhpcy5zZWxlY3Rpb24gPSBzZWxlY3Rpb24gPSB7XG4gICAgaW5Qcm9ncmVzczogZmFsc2UsXG4gICAgc2VsZWN0ZWRIZWFkZXI6IHtcbiAgICAgIGNvbHM6IGZhbHNlLFxuICAgICAgcm93czogZmFsc2VcbiAgICB9LFxuICAgIHNldFNlbGVjdGVkSGVhZGVyczogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcm93cyA9IGFyZ3VtZW50c1swXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTtcbiAgICAgIHZhciBjb2xzID0gYXJndW1lbnRzWzFdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlO1xuICAgICAgdmFyIGNvcm5lciA9IGFyZ3VtZW50c1syXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMl0gOiBmYWxzZTtcbiAgICAgIGluc3RhbmNlLnNlbGVjdGlvbi5zZWxlY3RlZEhlYWRlci5yb3dzID0gcm93cztcbiAgICAgIGluc3RhbmNlLnNlbGVjdGlvbi5zZWxlY3RlZEhlYWRlci5jb2xzID0gY29scztcbiAgICAgIGluc3RhbmNlLnNlbGVjdGlvbi5zZWxlY3RlZEhlYWRlci5jb3JuZXIgPSBjb3JuZXI7XG4gICAgfSxcbiAgICBiZWdpbjogZnVuY3Rpb24oKSB7XG4gICAgICBpbnN0YW5jZS5zZWxlY3Rpb24uaW5Qcm9ncmVzcyA9IHRydWU7XG4gICAgfSxcbiAgICBmaW5pc2g6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHNlbCA9IGluc3RhbmNlLmdldFNlbGVjdGVkKCk7XG4gICAgICBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnYWZ0ZXJTZWxlY3Rpb25FbmQnLCBzZWxbMF0sIHNlbFsxXSwgc2VsWzJdLCBzZWxbM10pO1xuICAgICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2FmdGVyU2VsZWN0aW9uRW5kQnlQcm9wJywgc2VsWzBdLCBpbnN0YW5jZS5jb2xUb1Byb3Aoc2VsWzFdKSwgc2VsWzJdLCBpbnN0YW5jZS5jb2xUb1Byb3Aoc2VsWzNdKSk7XG4gICAgICBpbnN0YW5jZS5zZWxlY3Rpb24uaW5Qcm9ncmVzcyA9IGZhbHNlO1xuICAgIH0sXG4gICAgaXNJblByb2dyZXNzOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBpbnN0YW5jZS5zZWxlY3Rpb24uaW5Qcm9ncmVzcztcbiAgICB9LFxuICAgIHNldFJhbmdlU3RhcnQ6IGZ1bmN0aW9uKGNvb3Jkcywga2VlcEVkaXRvck9wZW5lZCkge1xuICAgICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2JlZm9yZVNldFJhbmdlU3RhcnQnLCBjb29yZHMpO1xuICAgICAgcHJpdi5zZWxSYW5nZSA9IG5ldyBXYWxrb250YWJsZUNlbGxSYW5nZShjb29yZHMsIGNvb3JkcywgY29vcmRzKTtcbiAgICAgIHNlbGVjdGlvbi5zZXRSYW5nZUVuZChjb29yZHMsIG51bGwsIGtlZXBFZGl0b3JPcGVuZWQpO1xuICAgIH0sXG4gICAgc2V0UmFuZ2VTdGFydE9ubHk6IGZ1bmN0aW9uKGNvb3Jkcykge1xuICAgICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2JlZm9yZVNldFJhbmdlU3RhcnRPbmx5JywgY29vcmRzKTtcbiAgICAgIHByaXYuc2VsUmFuZ2UgPSBuZXcgV2Fsa29udGFibGVDZWxsUmFuZ2UoY29vcmRzLCBjb29yZHMsIGNvb3Jkcyk7XG4gICAgfSxcbiAgICBzZXRSYW5nZUVuZDogZnVuY3Rpb24oY29vcmRzLCBzY3JvbGxUb0NlbGwsIGtlZXBFZGl0b3JPcGVuZWQpIHtcbiAgICAgIGlmIChwcml2LnNlbFJhbmdlID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhciBkaXNhYmxlVmlzdWFsU2VsZWN0aW9uLFxuICAgICAgICAgIGlzSGVhZGVyU2VsZWN0ZWQgPSBmYWxzZSxcbiAgICAgICAgICBhcmVDb29yZHNQb3NpdGl2ZSA9IHRydWU7XG4gICAgICB2YXIgZmlyc3RWaXNpYmxlUm93ID0gaW5zdGFuY2Uudmlldy53dC53dFRhYmxlLmdldEZpcnN0VmlzaWJsZVJvdygpO1xuICAgICAgdmFyIGZpcnN0VmlzaWJsZUNvbHVtbiA9IGluc3RhbmNlLnZpZXcud3Qud3RUYWJsZS5nZXRGaXJzdFZpc2libGVDb2x1bW4oKTtcbiAgICAgIHZhciBuZXdSYW5nZUNvb3JkcyA9IHtcbiAgICAgICAgcm93OiBudWxsLFxuICAgICAgICBjb2w6IG51bGxcbiAgICAgIH07XG4gICAgICBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnYmVmb3JlU2V0UmFuZ2VFbmQnLCBjb29yZHMpO1xuICAgICAgaW5zdGFuY2Uuc2VsZWN0aW9uLmJlZ2luKCk7XG4gICAgICBuZXdSYW5nZUNvb3Jkcy5yb3cgPSBjb29yZHMucm93IDwgMCA/IGZpcnN0VmlzaWJsZVJvdyA6IGNvb3Jkcy5yb3c7XG4gICAgICBuZXdSYW5nZUNvb3Jkcy5jb2wgPSBjb29yZHMuY29sIDwgMCA/IGZpcnN0VmlzaWJsZUNvbHVtbiA6IGNvb3Jkcy5jb2w7XG4gICAgICBwcml2LnNlbFJhbmdlLnRvID0gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhuZXdSYW5nZUNvb3Jkcy5yb3csIG5ld1JhbmdlQ29vcmRzLmNvbCk7XG4gICAgICBpZiAoIXByaXYuc2V0dGluZ3MubXVsdGlTZWxlY3QpIHtcbiAgICAgICAgcHJpdi5zZWxSYW5nZS5mcm9tID0gY29vcmRzO1xuICAgICAgfVxuICAgICAgaW5zdGFuY2Uudmlldy53dC5zZWxlY3Rpb25zLmN1cnJlbnQuY2xlYXIoKTtcbiAgICAgIGRpc2FibGVWaXN1YWxTZWxlY3Rpb24gPSBpbnN0YW5jZS5nZXRDZWxsTWV0YShwcml2LnNlbFJhbmdlLmhpZ2hsaWdodC5yb3csIHByaXYuc2VsUmFuZ2UuaGlnaGxpZ2h0LmNvbCkuZGlzYWJsZVZpc3VhbFNlbGVjdGlvbjtcbiAgICAgIGlmICh0eXBlb2YgZGlzYWJsZVZpc3VhbFNlbGVjdGlvbiA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgZGlzYWJsZVZpc3VhbFNlbGVjdGlvbiA9IFtkaXNhYmxlVmlzdWFsU2VsZWN0aW9uXTtcbiAgICAgIH1cbiAgICAgIGlmIChkaXNhYmxlVmlzdWFsU2VsZWN0aW9uID09PSBmYWxzZSB8fCBBcnJheS5pc0FycmF5KGRpc2FibGVWaXN1YWxTZWxlY3Rpb24pICYmIGRpc2FibGVWaXN1YWxTZWxlY3Rpb24uaW5kZXhPZignY3VycmVudCcpID09PSAtMSkge1xuICAgICAgICBpbnN0YW5jZS52aWV3Lnd0LnNlbGVjdGlvbnMuY3VycmVudC5hZGQocHJpdi5zZWxSYW5nZS5oaWdobGlnaHQpO1xuICAgICAgfVxuICAgICAgaW5zdGFuY2Uudmlldy53dC5zZWxlY3Rpb25zLmFyZWEuY2xlYXIoKTtcbiAgICAgIGlmICgoZGlzYWJsZVZpc3VhbFNlbGVjdGlvbiA9PT0gZmFsc2UgfHwgQXJyYXkuaXNBcnJheShkaXNhYmxlVmlzdWFsU2VsZWN0aW9uKSAmJiBkaXNhYmxlVmlzdWFsU2VsZWN0aW9uLmluZGV4T2YoJ2FyZWEnKSA9PT0gLTEpICYmIHNlbGVjdGlvbi5pc011bHRpcGxlKCkpIHtcbiAgICAgICAgaW5zdGFuY2Uudmlldy53dC5zZWxlY3Rpb25zLmFyZWEuYWRkKHByaXYuc2VsUmFuZ2UuZnJvbSk7XG4gICAgICAgIGluc3RhbmNlLnZpZXcud3Quc2VsZWN0aW9ucy5hcmVhLmFkZChwcml2LnNlbFJhbmdlLnRvKTtcbiAgICAgIH1cbiAgICAgIGlmIChwcml2LnNldHRpbmdzLmN1cnJlbnRIZWFkZXJDbGFzc05hbWUgfHwgcHJpdi5zZXR0aW5ncy5jdXJyZW50Um93Q2xhc3NOYW1lIHx8IHByaXYuc2V0dGluZ3MuY3VycmVudENvbENsYXNzTmFtZSkge1xuICAgICAgICBpbnN0YW5jZS52aWV3Lnd0LnNlbGVjdGlvbnMuaGlnaGxpZ2h0LmNsZWFyKCk7XG4gICAgICAgIGluc3RhbmNlLnZpZXcud3Quc2VsZWN0aW9ucy5oaWdobGlnaHQuYWRkKHByaXYuc2VsUmFuZ2UuZnJvbSk7XG4gICAgICAgIGluc3RhbmNlLnZpZXcud3Quc2VsZWN0aW9ucy5oaWdobGlnaHQuYWRkKHByaXYuc2VsUmFuZ2UudG8pO1xuICAgICAgfVxuICAgICAgdmFyIHByZXZlbnRTY3JvbGxpbmcgPSBjcmVhdGVPYmplY3RQcm9wTGlzdGVuZXIoJ3ZhbHVlJyk7XG4gICAgICBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnYWZ0ZXJTZWxlY3Rpb24nLCBwcml2LnNlbFJhbmdlLmZyb20ucm93LCBwcml2LnNlbFJhbmdlLmZyb20uY29sLCBwcml2LnNlbFJhbmdlLnRvLnJvdywgcHJpdi5zZWxSYW5nZS50by5jb2wsIHByZXZlbnRTY3JvbGxpbmcpO1xuICAgICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2FmdGVyU2VsZWN0aW9uQnlQcm9wJywgcHJpdi5zZWxSYW5nZS5mcm9tLnJvdywgZGF0YW1hcC5jb2xUb1Byb3AocHJpdi5zZWxSYW5nZS5mcm9tLmNvbCksIHByaXYuc2VsUmFuZ2UudG8ucm93LCBkYXRhbWFwLmNvbFRvUHJvcChwcml2LnNlbFJhbmdlLnRvLmNvbCksIHByZXZlbnRTY3JvbGxpbmcpO1xuICAgICAgaWYgKChwcml2LnNlbFJhbmdlLmZyb20ucm93ID09PSAwICYmIHByaXYuc2VsUmFuZ2UudG8ucm93ID09PSBpbnN0YW5jZS5jb3VudFJvd3MoKSAtIDEgJiYgaW5zdGFuY2UuY291bnRSb3dzKCkgPiAxKSB8fCAocHJpdi5zZWxSYW5nZS5mcm9tLmNvbCA9PT0gMCAmJiBwcml2LnNlbFJhbmdlLnRvLmNvbCA9PT0gaW5zdGFuY2UuY291bnRDb2xzKCkgLSAxICYmIGluc3RhbmNlLmNvdW50Q29scygpID4gMSkpIHtcbiAgICAgICAgaXNIZWFkZXJTZWxlY3RlZCA9IHRydWU7XG4gICAgICB9XG4gICAgICBpZiAoY29vcmRzLnJvdyA8IDAgfHwgY29vcmRzLmNvbCA8IDApIHtcbiAgICAgICAgYXJlQ29vcmRzUG9zaXRpdmUgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChwcmV2ZW50U2Nyb2xsaW5nLmlzVG91Y2hlZCgpKSB7XG4gICAgICAgIHNjcm9sbFRvQ2VsbCA9ICFwcmV2ZW50U2Nyb2xsaW5nLnZhbHVlO1xuICAgICAgfVxuICAgICAgaWYgKHNjcm9sbFRvQ2VsbCAhPT0gZmFsc2UgJiYgIWlzSGVhZGVyU2VsZWN0ZWQgJiYgYXJlQ29vcmRzUG9zaXRpdmUpIHtcbiAgICAgICAgaWYgKHByaXYuc2VsUmFuZ2UuZnJvbSAmJiAhc2VsZWN0aW9uLmlzTXVsdGlwbGUoKSkge1xuICAgICAgICAgIGluc3RhbmNlLnZpZXcuc2Nyb2xsVmlld3BvcnQocHJpdi5zZWxSYW5nZS5mcm9tKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpbnN0YW5jZS52aWV3LnNjcm9sbFZpZXdwb3J0KGNvb3Jkcyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChzZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIucm93cyAmJiBzZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIuY29scykge1xuICAgICAgICBhZGRDbGFzcyhpbnN0YW5jZS5yb290RWxlbWVudCwgWydodF9fc2VsZWN0aW9uLS1yb3dzJywgJ2h0X19zZWxlY3Rpb24tLWNvbHVtbnMnXSk7XG4gICAgICB9IGVsc2UgaWYgKHNlbGVjdGlvbi5zZWxlY3RlZEhlYWRlci5yb3dzKSB7XG4gICAgICAgIHJlbW92ZUNsYXNzKGluc3RhbmNlLnJvb3RFbGVtZW50LCAnaHRfX3NlbGVjdGlvbi0tY29sdW1ucycpO1xuICAgICAgICBhZGRDbGFzcyhpbnN0YW5jZS5yb290RWxlbWVudCwgJ2h0X19zZWxlY3Rpb24tLXJvd3MnKTtcbiAgICAgIH0gZWxzZSBpZiAoc2VsZWN0aW9uLnNlbGVjdGVkSGVhZGVyLmNvbHMpIHtcbiAgICAgICAgcmVtb3ZlQ2xhc3MoaW5zdGFuY2Uucm9vdEVsZW1lbnQsICdodF9fc2VsZWN0aW9uLS1yb3dzJyk7XG4gICAgICAgIGFkZENsYXNzKGluc3RhbmNlLnJvb3RFbGVtZW50LCAnaHRfX3NlbGVjdGlvbi0tY29sdW1ucycpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVtb3ZlQ2xhc3MoaW5zdGFuY2Uucm9vdEVsZW1lbnQsIFsnaHRfX3NlbGVjdGlvbi0tcm93cycsICdodF9fc2VsZWN0aW9uLS1jb2x1bW5zJ10pO1xuICAgICAgfVxuICAgICAgc2VsZWN0aW9uLnJlZnJlc2hCb3JkZXJzKG51bGwsIGtlZXBFZGl0b3JPcGVuZWQpO1xuICAgIH0sXG4gICAgcmVmcmVzaEJvcmRlcnM6IGZ1bmN0aW9uKHJldmVydE9yaWdpbmFsLCBrZWVwRWRpdG9yKSB7XG4gICAgICBpZiAoIWtlZXBFZGl0b3IpIHtcbiAgICAgICAgZWRpdG9yTWFuYWdlci5kZXN0cm95RWRpdG9yKHJldmVydE9yaWdpbmFsKTtcbiAgICAgIH1cbiAgICAgIGluc3RhbmNlLnZpZXcucmVuZGVyKCk7XG4gICAgICBpZiAoc2VsZWN0aW9uLmlzU2VsZWN0ZWQoKSAmJiAha2VlcEVkaXRvcikge1xuICAgICAgICBlZGl0b3JNYW5hZ2VyLnByZXBhcmVFZGl0b3IoKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGlzTXVsdGlwbGU6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGlzTXVsdGlwbGUgPSAhKHByaXYuc2VsUmFuZ2UudG8uY29sID09PSBwcml2LnNlbFJhbmdlLmZyb20uY29sICYmIHByaXYuc2VsUmFuZ2UudG8ucm93ID09PSBwcml2LnNlbFJhbmdlLmZyb20ucm93KSxcbiAgICAgICAgICBtb2RpZmllciA9IEhhbmRzb250YWJsZS5ob29rcy5ydW4oaW5zdGFuY2UsICdhZnRlcklzTXVsdGlwbGVTZWxlY3Rpb24nLCBpc011bHRpcGxlKTtcbiAgICAgIGlmIChpc011bHRpcGxlKSB7XG4gICAgICAgIHJldHVybiBtb2RpZmllcjtcbiAgICAgIH1cbiAgICB9LFxuICAgIHRyYW5zZm9ybVN0YXJ0OiBmdW5jdGlvbihyb3dEZWx0YSwgY29sRGVsdGEsIGZvcmNlLCBrZWVwRWRpdG9yT3BlbmVkKSB7XG4gICAgICB2YXIgZGVsdGEgPSBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHJvd0RlbHRhLCBjb2xEZWx0YSksXG4gICAgICAgICAgcm93VHJhbnNmb3JtRGlyID0gMCxcbiAgICAgICAgICBjb2xUcmFuc2Zvcm1EaXIgPSAwLFxuICAgICAgICAgIHRvdGFsUm93cyxcbiAgICAgICAgICB0b3RhbENvbHMsXG4gICAgICAgICAgY29vcmRzLFxuICAgICAgICAgIGZpeGVkUm93c0JvdHRvbTtcbiAgICAgIGluc3RhbmNlLnJ1bkhvb2tzKCdtb2RpZnlUcmFuc2Zvcm1TdGFydCcsIGRlbHRhKTtcbiAgICAgIHRvdGFsUm93cyA9IGluc3RhbmNlLmNvdW50Um93cygpO1xuICAgICAgdG90YWxDb2xzID0gaW5zdGFuY2UuY291bnRDb2xzKCk7XG4gICAgICBmaXhlZFJvd3NCb3R0b20gPSBpbnN0YW5jZS5nZXRTZXR0aW5ncygpLmZpeGVkUm93c0JvdHRvbTtcbiAgICAgIGlmIChwcml2LnNlbFJhbmdlLmhpZ2hsaWdodC5yb3cgKyByb3dEZWx0YSA+IHRvdGFsUm93cyAtIDEpIHtcbiAgICAgICAgaWYgKGZvcmNlICYmIHByaXYuc2V0dGluZ3MubWluU3BhcmVSb3dzID4gMCAmJiAhKGZpeGVkUm93c0JvdHRvbSAmJiBwcml2LnNlbFJhbmdlLmhpZ2hsaWdodC5yb3cgPj0gdG90YWxSb3dzIC0gZml4ZWRSb3dzQm90dG9tIC0gMSkpIHtcbiAgICAgICAgICBpbnN0YW5jZS5hbHRlcignaW5zZXJ0X3JvdycsIHRvdGFsUm93cyk7XG4gICAgICAgICAgdG90YWxSb3dzID0gaW5zdGFuY2UuY291bnRSb3dzKCk7XG4gICAgICAgIH0gZWxzZSBpZiAocHJpdi5zZXR0aW5ncy5hdXRvV3JhcENvbCkge1xuICAgICAgICAgIGRlbHRhLnJvdyA9IDEgLSB0b3RhbFJvd3M7XG4gICAgICAgICAgZGVsdGEuY29sID0gcHJpdi5zZWxSYW5nZS5oaWdobGlnaHQuY29sICsgZGVsdGEuY29sID09IHRvdGFsQ29scyAtIDEgPyAxIC0gdG90YWxDb2xzIDogMTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChwcml2LnNldHRpbmdzLmF1dG9XcmFwQ29sICYmIHByaXYuc2VsUmFuZ2UuaGlnaGxpZ2h0LnJvdyArIGRlbHRhLnJvdyA8IDAgJiYgcHJpdi5zZWxSYW5nZS5oaWdobGlnaHQuY29sICsgZGVsdGEuY29sID49IDApIHtcbiAgICAgICAgZGVsdGEucm93ID0gdG90YWxSb3dzIC0gMTtcbiAgICAgICAgZGVsdGEuY29sID0gcHJpdi5zZWxSYW5nZS5oaWdobGlnaHQuY29sICsgZGVsdGEuY29sID09IDAgPyB0b3RhbENvbHMgLSAxIDogLTE7XG4gICAgICB9XG4gICAgICBpZiAocHJpdi5zZWxSYW5nZS5oaWdobGlnaHQuY29sICsgZGVsdGEuY29sID4gdG90YWxDb2xzIC0gMSkge1xuICAgICAgICBpZiAoZm9yY2UgJiYgcHJpdi5zZXR0aW5ncy5taW5TcGFyZUNvbHMgPiAwKSB7XG4gICAgICAgICAgaW5zdGFuY2UuYWx0ZXIoJ2luc2VydF9jb2wnLCB0b3RhbENvbHMpO1xuICAgICAgICAgIHRvdGFsQ29scyA9IGluc3RhbmNlLmNvdW50Q29scygpO1xuICAgICAgICB9IGVsc2UgaWYgKHByaXYuc2V0dGluZ3MuYXV0b1dyYXBSb3cpIHtcbiAgICAgICAgICBkZWx0YS5yb3cgPSBwcml2LnNlbFJhbmdlLmhpZ2hsaWdodC5yb3cgKyBkZWx0YS5yb3cgPT0gdG90YWxSb3dzIC0gMSA/IDEgLSB0b3RhbFJvd3MgOiAxO1xuICAgICAgICAgIGRlbHRhLmNvbCA9IDEgLSB0b3RhbENvbHM7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAocHJpdi5zZXR0aW5ncy5hdXRvV3JhcFJvdyAmJiBwcml2LnNlbFJhbmdlLmhpZ2hsaWdodC5jb2wgKyBkZWx0YS5jb2wgPCAwICYmIHByaXYuc2VsUmFuZ2UuaGlnaGxpZ2h0LnJvdyArIGRlbHRhLnJvdyA+PSAwKSB7XG4gICAgICAgIGRlbHRhLnJvdyA9IHByaXYuc2VsUmFuZ2UuaGlnaGxpZ2h0LnJvdyArIGRlbHRhLnJvdyA9PSAwID8gdG90YWxSb3dzIC0gMSA6IC0xO1xuICAgICAgICBkZWx0YS5jb2wgPSB0b3RhbENvbHMgLSAxO1xuICAgICAgfVxuICAgICAgY29vcmRzID0gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3Jkcyhwcml2LnNlbFJhbmdlLmhpZ2hsaWdodC5yb3cgKyBkZWx0YS5yb3csIHByaXYuc2VsUmFuZ2UuaGlnaGxpZ2h0LmNvbCArIGRlbHRhLmNvbCk7XG4gICAgICBpZiAoY29vcmRzLnJvdyA8IDApIHtcbiAgICAgICAgcm93VHJhbnNmb3JtRGlyID0gLTE7XG4gICAgICAgIGNvb3Jkcy5yb3cgPSAwO1xuICAgICAgfSBlbHNlIGlmIChjb29yZHMucm93ID4gMCAmJiBjb29yZHMucm93ID49IHRvdGFsUm93cykge1xuICAgICAgICByb3dUcmFuc2Zvcm1EaXIgPSAxO1xuICAgICAgICBjb29yZHMucm93ID0gdG90YWxSb3dzIC0gMTtcbiAgICAgIH1cbiAgICAgIGlmIChjb29yZHMuY29sIDwgMCkge1xuICAgICAgICBjb2xUcmFuc2Zvcm1EaXIgPSAtMTtcbiAgICAgICAgY29vcmRzLmNvbCA9IDA7XG4gICAgICB9IGVsc2UgaWYgKGNvb3Jkcy5jb2wgPiAwICYmIGNvb3Jkcy5jb2wgPj0gdG90YWxDb2xzKSB7XG4gICAgICAgIGNvbFRyYW5zZm9ybURpciA9IDE7XG4gICAgICAgIGNvb3Jkcy5jb2wgPSB0b3RhbENvbHMgLSAxO1xuICAgICAgfVxuICAgICAgaW5zdGFuY2UucnVuSG9va3MoJ2FmdGVyTW9kaWZ5VHJhbnNmb3JtU3RhcnQnLCBjb29yZHMsIHJvd1RyYW5zZm9ybURpciwgY29sVHJhbnNmb3JtRGlyKTtcbiAgICAgIHNlbGVjdGlvbi5zZXRSYW5nZVN0YXJ0KGNvb3Jkcywga2VlcEVkaXRvck9wZW5lZCk7XG4gICAgfSxcbiAgICB0cmFuc2Zvcm1FbmQ6IGZ1bmN0aW9uKHJvd0RlbHRhLCBjb2xEZWx0YSkge1xuICAgICAgdmFyIGRlbHRhID0gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3Jkcyhyb3dEZWx0YSwgY29sRGVsdGEpLFxuICAgICAgICAgIHJvd1RyYW5zZm9ybURpciA9IDAsXG4gICAgICAgICAgY29sVHJhbnNmb3JtRGlyID0gMCxcbiAgICAgICAgICB0b3RhbFJvd3MsXG4gICAgICAgICAgdG90YWxDb2xzLFxuICAgICAgICAgIGNvb3JkcztcbiAgICAgIGluc3RhbmNlLnJ1bkhvb2tzKCdtb2RpZnlUcmFuc2Zvcm1FbmQnLCBkZWx0YSk7XG4gICAgICB0b3RhbFJvd3MgPSBpbnN0YW5jZS5jb3VudFJvd3MoKTtcbiAgICAgIHRvdGFsQ29scyA9IGluc3RhbmNlLmNvdW50Q29scygpO1xuICAgICAgY29vcmRzID0gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3Jkcyhwcml2LnNlbFJhbmdlLnRvLnJvdyArIGRlbHRhLnJvdywgcHJpdi5zZWxSYW5nZS50by5jb2wgKyBkZWx0YS5jb2wpO1xuICAgICAgaWYgKGNvb3Jkcy5yb3cgPCAwKSB7XG4gICAgICAgIHJvd1RyYW5zZm9ybURpciA9IC0xO1xuICAgICAgICBjb29yZHMucm93ID0gMDtcbiAgICAgIH0gZWxzZSBpZiAoY29vcmRzLnJvdyA+IDAgJiYgY29vcmRzLnJvdyA+PSB0b3RhbFJvd3MpIHtcbiAgICAgICAgcm93VHJhbnNmb3JtRGlyID0gMTtcbiAgICAgICAgY29vcmRzLnJvdyA9IHRvdGFsUm93cyAtIDE7XG4gICAgICB9XG4gICAgICBpZiAoY29vcmRzLmNvbCA8IDApIHtcbiAgICAgICAgY29sVHJhbnNmb3JtRGlyID0gLTE7XG4gICAgICAgIGNvb3Jkcy5jb2wgPSAwO1xuICAgICAgfSBlbHNlIGlmIChjb29yZHMuY29sID4gMCAmJiBjb29yZHMuY29sID49IHRvdGFsQ29scykge1xuICAgICAgICBjb2xUcmFuc2Zvcm1EaXIgPSAxO1xuICAgICAgICBjb29yZHMuY29sID0gdG90YWxDb2xzIC0gMTtcbiAgICAgIH1cbiAgICAgIGluc3RhbmNlLnJ1bkhvb2tzKCdhZnRlck1vZGlmeVRyYW5zZm9ybUVuZCcsIGNvb3Jkcywgcm93VHJhbnNmb3JtRGlyLCBjb2xUcmFuc2Zvcm1EaXIpO1xuICAgICAgc2VsZWN0aW9uLnNldFJhbmdlRW5kKGNvb3JkcywgdHJ1ZSk7XG4gICAgfSxcbiAgICBpc1NlbGVjdGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAocHJpdi5zZWxSYW5nZSAhPT0gbnVsbCk7XG4gICAgfSxcbiAgICBpbkluU2VsZWN0aW9uOiBmdW5jdGlvbihjb29yZHMpIHtcbiAgICAgIGlmICghc2VsZWN0aW9uLmlzU2VsZWN0ZWQoKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gcHJpdi5zZWxSYW5nZS5pbmNsdWRlcyhjb29yZHMpO1xuICAgIH0sXG4gICAgZGVzZWxlY3Q6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCFzZWxlY3Rpb24uaXNTZWxlY3RlZCgpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGluc3RhbmNlLnNlbGVjdGlvbi5pblByb2dyZXNzID0gZmFsc2U7XG4gICAgICBwcml2LnNlbFJhbmdlID0gbnVsbDtcbiAgICAgIGluc3RhbmNlLnZpZXcud3Quc2VsZWN0aW9ucy5jdXJyZW50LmNsZWFyKCk7XG4gICAgICBpbnN0YW5jZS52aWV3Lnd0LnNlbGVjdGlvbnMuYXJlYS5jbGVhcigpO1xuICAgICAgaWYgKHByaXYuc2V0dGluZ3MuY3VycmVudEhlYWRlckNsYXNzTmFtZSB8fCBwcml2LnNldHRpbmdzLmN1cnJlbnRSb3dDbGFzc05hbWUgfHwgcHJpdi5zZXR0aW5ncy5jdXJyZW50Q29sQ2xhc3NOYW1lKSB7XG4gICAgICAgIGluc3RhbmNlLnZpZXcud3Quc2VsZWN0aW9ucy5oaWdobGlnaHQuY2xlYXIoKTtcbiAgICAgIH1cbiAgICAgIGVkaXRvck1hbmFnZXIuZGVzdHJveUVkaXRvcigpO1xuICAgICAgc2VsZWN0aW9uLnJlZnJlc2hCb3JkZXJzKCk7XG4gICAgICByZW1vdmVDbGFzcyhpbnN0YW5jZS5yb290RWxlbWVudCwgWydodF9fc2VsZWN0aW9uLS1yb3dzJywgJ2h0X19zZWxlY3Rpb24tLWNvbHVtbnMnXSk7XG4gICAgICBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnYWZ0ZXJEZXNlbGVjdCcpO1xuICAgIH0sXG4gICAgc2VsZWN0QWxsOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICghcHJpdi5zZXR0aW5ncy5tdWx0aVNlbGVjdCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBzZWxlY3Rpb24uc2V0U2VsZWN0ZWRIZWFkZXJzKHRydWUsIHRydWUsIHRydWUpO1xuICAgICAgc2VsZWN0aW9uLnNldFJhbmdlU3RhcnQobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcygwLCAwKSk7XG4gICAgICBzZWxlY3Rpb24uc2V0UmFuZ2VFbmQobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhpbnN0YW5jZS5jb3VudFJvd3MoKSAtIDEsIGluc3RhbmNlLmNvdW50Q29scygpIC0gMSksIGZhbHNlKTtcbiAgICB9LFxuICAgIGVtcHR5OiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICghc2VsZWN0aW9uLmlzU2VsZWN0ZWQoKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgdG9wTGVmdCA9IHByaXYuc2VsUmFuZ2UuZ2V0VG9wTGVmdENvcm5lcigpO1xuICAgICAgdmFyIGJvdHRvbVJpZ2h0ID0gcHJpdi5zZWxSYW5nZS5nZXRCb3R0b21SaWdodENvcm5lcigpO1xuICAgICAgdmFyIHIsXG4gICAgICAgICAgYyxcbiAgICAgICAgICBjaGFuZ2VzID0gW107XG4gICAgICBmb3IgKHIgPSB0b3BMZWZ0LnJvdzsgciA8PSBib3R0b21SaWdodC5yb3c7IHIrKykge1xuICAgICAgICBmb3IgKGMgPSB0b3BMZWZ0LmNvbDsgYyA8PSBib3R0b21SaWdodC5jb2w7IGMrKykge1xuICAgICAgICAgIGlmICghaW5zdGFuY2UuZ2V0Q2VsbE1ldGEociwgYykucmVhZE9ubHkpIHtcbiAgICAgICAgICAgIGNoYW5nZXMucHVzaChbciwgYywgJyddKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGluc3RhbmNlLnNldERhdGFBdENlbGwoY2hhbmdlcyk7XG4gICAgfVxuICB9O1xuICB0aGlzLmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICBkYXRhU291cmNlLnNldERhdGEocHJpdi5zZXR0aW5ncy5kYXRhKTtcbiAgICBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnYmVmb3JlSW5pdCcpO1xuICAgIGlmIChpc01vYmlsZUJyb3dzZXIoKSkge1xuICAgICAgYWRkQ2xhc3MoaW5zdGFuY2Uucm9vdEVsZW1lbnQsICdtb2JpbGUnKTtcbiAgICB9XG4gICAgdGhpcy51cGRhdGVTZXR0aW5ncyhwcml2LnNldHRpbmdzLCB0cnVlKTtcbiAgICB0aGlzLnZpZXcgPSBuZXcgVGFibGVWaWV3KHRoaXMpO1xuICAgIGVkaXRvck1hbmFnZXIgPSBuZXcgRWRpdG9yTWFuYWdlcihpbnN0YW5jZSwgcHJpdiwgc2VsZWN0aW9uLCBkYXRhbWFwKTtcbiAgICB0aGlzLmZvcmNlRnVsbFJlbmRlciA9IHRydWU7XG4gICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2luaXQnKTtcbiAgICB0aGlzLnZpZXcucmVuZGVyKCk7XG4gICAgaWYgKHR5cGVvZiBwcml2LmZpcnN0UnVuID09PSAnb2JqZWN0Jykge1xuICAgICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2FmdGVyQ2hhbmdlJywgcHJpdi5maXJzdFJ1blswXSwgcHJpdi5maXJzdFJ1blsxXSk7XG4gICAgICBwcml2LmZpcnN0UnVuID0gZmFsc2U7XG4gICAgfVxuICAgIEhhbmRzb250YWJsZS5ob29rcy5ydW4oaW5zdGFuY2UsICdhZnRlckluaXQnKTtcbiAgfTtcbiAgZnVuY3Rpb24gVmFsaWRhdG9yc1F1ZXVlKCkge1xuICAgIHZhciByZXNvbHZlZCA9IGZhbHNlO1xuICAgIHJldHVybiB7XG4gICAgICB2YWxpZGF0b3JzSW5RdWV1ZTogMCxcbiAgICAgIHZhbGlkOiB0cnVlLFxuICAgICAgYWRkVmFsaWRhdG9yVG9RdWV1ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMudmFsaWRhdG9yc0luUXVldWUrKztcbiAgICAgICAgcmVzb2x2ZWQgPSBmYWxzZTtcbiAgICAgIH0sXG4gICAgICByZW1vdmVWYWxpZGF0b3JGb3JtUXVldWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnZhbGlkYXRvcnNJblF1ZXVlID0gdGhpcy52YWxpZGF0b3JzSW5RdWV1ZSAtIDEgPCAwID8gMCA6IHRoaXMudmFsaWRhdG9yc0luUXVldWUgLSAxO1xuICAgICAgICB0aGlzLmNoZWNrSWZRdWV1ZUlzRW1wdHkoKTtcbiAgICAgIH0sXG4gICAgICBvblF1ZXVlRW1wdHk6IGZ1bmN0aW9uKHZhbGlkKSB7fSxcbiAgICAgIGNoZWNrSWZRdWV1ZUlzRW1wdHk6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy52YWxpZGF0b3JzSW5RdWV1ZSA9PSAwICYmIHJlc29sdmVkID09IGZhbHNlKSB7XG4gICAgICAgICAgcmVzb2x2ZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMub25RdWV1ZUVtcHR5KHRoaXMudmFsaWQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxuICBmdW5jdGlvbiB2YWxpZGF0ZUNoYW5nZXMoY2hhbmdlcywgc291cmNlLCBjYWxsYmFjaykge1xuICAgIHZhciB3YWl0aW5nRm9yVmFsaWRhdG9yID0gbmV3IFZhbGlkYXRvcnNRdWV1ZSgpO1xuICAgIHdhaXRpbmdGb3JWYWxpZGF0b3Iub25RdWV1ZUVtcHR5ID0gcmVzb2x2ZTtcbiAgICBmb3IgKHZhciBpID0gY2hhbmdlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgaWYgKGNoYW5nZXNbaV0gPT09IG51bGwpIHtcbiAgICAgICAgY2hhbmdlcy5zcGxpY2UoaSwgMSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgcm93ID0gY2hhbmdlc1tpXVswXTtcbiAgICAgICAgdmFyIGNvbCA9IGRhdGFtYXAucHJvcFRvQ29sKGNoYW5nZXNbaV1bMV0pO1xuICAgICAgICB2YXIgY2VsbFByb3BlcnRpZXMgPSBpbnN0YW5jZS5nZXRDZWxsTWV0YShyb3csIGNvbCk7XG4gICAgICAgIGlmIChjZWxsUHJvcGVydGllcy50eXBlID09PSAnbnVtZXJpYycgJiYgdHlwZW9mIGNoYW5nZXNbaV1bM10gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgaWYgKGNoYW5nZXNbaV1bM10ubGVuZ3RoID4gMCAmJiAoL14tP1tcXGRcXHNdKihcXC58XFwsKT9cXGQqJC8udGVzdChjaGFuZ2VzW2ldWzNdKSB8fCBjZWxsUHJvcGVydGllcy5mb3JtYXQpKSB7XG4gICAgICAgICAgICB2YXIgbGVuID0gY2hhbmdlc1tpXVszXS5sZW5ndGg7XG4gICAgICAgICAgICBpZiAoaXNVbmRlZmluZWQoY2VsbFByb3BlcnRpZXMubGFuZ3VhZ2UpKSB7XG4gICAgICAgICAgICAgIG51bWJyby5jdWx0dXJlKCdlbi1VUycpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFuZ2VzW2ldWzNdLmluZGV4T2YoJy4nKSA9PT0gbGVuIC0gMyAmJiBjaGFuZ2VzW2ldWzNdLmluZGV4T2YoJywnKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgbnVtYnJvLmN1bHR1cmUoJ2VuLVVTJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBudW1icm8uY3VsdHVyZShjZWxsUHJvcGVydGllcy5sYW5ndWFnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGVsaW1pdGVycyA9IG51bWJyby5jdWx0dXJlRGF0YShudW1icm8uY3VsdHVyZSgpKS5kZWxpbWl0ZXJzO1xuICAgICAgICAgICAgaWYgKG51bWJyby52YWxpZGF0ZShjaGFuZ2VzW2ldWzNdKSAmJiAhaXNOYU4oY2hhbmdlc1tpXVszXSkpIHtcbiAgICAgICAgICAgICAgY2hhbmdlc1tpXVszXSA9IHBhcnNlRmxvYXQoY2hhbmdlc1tpXVszXSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjaGFuZ2VzW2ldWzNdID0gbnVtYnJvKCkudW5mb3JtYXQoY2hhbmdlc1tpXVszXSkgfHwgY2hhbmdlc1tpXVszXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGluc3RhbmNlLmdldENlbGxWYWxpZGF0b3IoY2VsbFByb3BlcnRpZXMpKSB7XG4gICAgICAgICAgd2FpdGluZ0ZvclZhbGlkYXRvci5hZGRWYWxpZGF0b3JUb1F1ZXVlKCk7XG4gICAgICAgICAgaW5zdGFuY2UudmFsaWRhdGVDZWxsKGNoYW5nZXNbaV1bM10sIGNlbGxQcm9wZXJ0aWVzLCAoZnVuY3Rpb24oaSwgY2VsbFByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZXN1bHQgIT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVmFsaWRhdGlvbiBlcnJvcjogcmVzdWx0IGlzIG5vdCBib29sZWFuJyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKHJlc3VsdCA9PT0gZmFsc2UgJiYgY2VsbFByb3BlcnRpZXMuYWxsb3dJbnZhbGlkID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGNoYW5nZXMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgIGNlbGxQcm9wZXJ0aWVzLnZhbGlkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2YXIgY2VsbCA9IGluc3RhbmNlLmdldENlbGwoY2VsbFByb3BlcnRpZXMucm93LCBjZWxsUHJvcGVydGllcy5jb2wpO1xuICAgICAgICAgICAgICAgIHJlbW92ZUNsYXNzKGNlbGwsIGluc3RhbmNlLmdldFNldHRpbmdzKCkuaW52YWxpZENlbGxDbGFzc05hbWUpO1xuICAgICAgICAgICAgICAgIC0taTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB3YWl0aW5nRm9yVmFsaWRhdG9yLnJlbW92ZVZhbGlkYXRvckZvcm1RdWV1ZSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9KShpLCBjZWxsUHJvcGVydGllcyksIHNvdXJjZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgd2FpdGluZ0ZvclZhbGlkYXRvci5jaGVja0lmUXVldWVJc0VtcHR5KCk7XG4gICAgZnVuY3Rpb24gcmVzb2x2ZSgpIHtcbiAgICAgIHZhciBiZWZvcmVDaGFuZ2VSZXN1bHQ7XG4gICAgICBpZiAoY2hhbmdlcy5sZW5ndGgpIHtcbiAgICAgICAgYmVmb3JlQ2hhbmdlUmVzdWx0ID0gSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2JlZm9yZUNoYW5nZScsIGNoYW5nZXMsIHNvdXJjZSk7XG4gICAgICAgIGlmIChpc0Z1bmN0aW9uKGJlZm9yZUNoYW5nZVJlc3VsdCkpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oJ1lvdXIgYmVmb3JlQ2hhbmdlIGNhbGxiYWNrIHJldHVybnMgYSBmdW5jdGlvbi4gSXRcXCdzIG5vdCBzdXBwb3J0ZWQgc2luY2UgSGFuZHNvbnRhYmxlIDAuMTIuMSAoYW5kIHRoZSByZXR1cm5lZCBmdW5jdGlvbiB3aWxsIG5vdCBiZSBleGVjdXRlZCkuJyk7XG4gICAgICAgIH0gZWxzZSBpZiAoYmVmb3JlQ2hhbmdlUmVzdWx0ID09PSBmYWxzZSkge1xuICAgICAgICAgIGNoYW5nZXMuc3BsaWNlKDAsIGNoYW5nZXMubGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY2FsbGJhY2soKTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gYXBwbHlDaGFuZ2VzKGNoYW5nZXMsIHNvdXJjZSkge1xuICAgIHZhciBpID0gY2hhbmdlcy5sZW5ndGggLSAxO1xuICAgIGlmIChpIDwgMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmb3IgKDsgMCA8PSBpOyBpLS0pIHtcbiAgICAgIHZhciBza2lwVGhpc0NoYW5nZSA9IGZhbHNlO1xuICAgICAgaWYgKGNoYW5nZXNbaV0gPT09IG51bGwpIHtcbiAgICAgICAgY2hhbmdlcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKGNoYW5nZXNbaV1bMl0gPT0gbnVsbCAmJiBjaGFuZ2VzW2ldWzNdID09IG51bGwpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBpZiAocHJpdi5zZXR0aW5ncy5hbGxvd0luc2VydFJvdykge1xuICAgICAgICB3aGlsZSAoY2hhbmdlc1tpXVswXSA+IGluc3RhbmNlLmNvdW50Um93cygpIC0gMSkge1xuICAgICAgICAgIHZhciBudW1iZXJPZkNyZWF0ZWRSb3dzID0gZGF0YW1hcC5jcmVhdGVSb3codm9pZCAwLCB2b2lkIDAsIHNvdXJjZSk7XG4gICAgICAgICAgaWYgKG51bWJlck9mQ3JlYXRlZFJvd3MgPT09IDApIHtcbiAgICAgICAgICAgIHNraXBUaGlzQ2hhbmdlID0gdHJ1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHNraXBUaGlzQ2hhbmdlKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKGluc3RhbmNlLmRhdGFUeXBlID09PSAnYXJyYXknICYmICghcHJpdi5zZXR0aW5ncy5jb2x1bW5zIHx8IHByaXYuc2V0dGluZ3MuY29sdW1ucy5sZW5ndGggPT09IDApICYmIHByaXYuc2V0dGluZ3MuYWxsb3dJbnNlcnRDb2x1bW4pIHtcbiAgICAgICAgd2hpbGUgKGRhdGFtYXAucHJvcFRvQ29sKGNoYW5nZXNbaV1bMV0pID4gaW5zdGFuY2UuY291bnRDb2xzKCkgLSAxKSB7XG4gICAgICAgICAgZGF0YW1hcC5jcmVhdGVDb2wodm9pZCAwLCB2b2lkIDAsIHNvdXJjZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGRhdGFtYXAuc2V0KGNoYW5nZXNbaV1bMF0sIGNoYW5nZXNbaV1bMV0sIGNoYW5nZXNbaV1bM10pO1xuICAgIH1cbiAgICBpbnN0YW5jZS5mb3JjZUZ1bGxSZW5kZXIgPSB0cnVlO1xuICAgIGdyaWQuYWRqdXN0Um93c0FuZENvbHMoKTtcbiAgICBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnYmVmb3JlQ2hhbmdlUmVuZGVyJywgY2hhbmdlcywgc291cmNlKTtcbiAgICBzZWxlY3Rpb24ucmVmcmVzaEJvcmRlcnMobnVsbCwgdHJ1ZSk7XG4gICAgaW5zdGFuY2Uudmlldy53dC53dE92ZXJsYXlzLmFkanVzdEVsZW1lbnRzU2l6ZSgpO1xuICAgIEhhbmRzb250YWJsZS5ob29rcy5ydW4oaW5zdGFuY2UsICdhZnRlckNoYW5nZScsIGNoYW5nZXMsIHNvdXJjZSB8fCAnZWRpdCcpO1xuICAgIHZhciBhY3RpdmVFZGl0b3IgPSBpbnN0YW5jZS5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgICBpZiAoYWN0aXZlRWRpdG9yICYmIGlzRGVmaW5lZChhY3RpdmVFZGl0b3IucmVmcmVzaFZhbHVlKSkge1xuICAgICAgYWN0aXZlRWRpdG9yLnJlZnJlc2hWYWx1ZSgpO1xuICAgIH1cbiAgfVxuICB0aGlzLnZhbGlkYXRlQ2VsbCA9IGZ1bmN0aW9uKHZhbHVlLCBjZWxsUHJvcGVydGllcywgY2FsbGJhY2ssIHNvdXJjZSkge1xuICAgIHZhciB2YWxpZGF0b3IgPSBpbnN0YW5jZS5nZXRDZWxsVmFsaWRhdG9yKGNlbGxQcm9wZXJ0aWVzKTtcbiAgICBmdW5jdGlvbiBkb25lKHZhbGlkKSB7XG4gICAgICB2YXIgY29sID0gY2VsbFByb3BlcnRpZXMudmlzdWFsQ29sLFxuICAgICAgICAgIHJvdyA9IGNlbGxQcm9wZXJ0aWVzLnZpc3VhbFJvdyxcbiAgICAgICAgICB0ZCA9IGluc3RhbmNlLmdldENlbGwocm93LCBjb2wsIHRydWUpO1xuICAgICAgaWYgKHRkICYmIHRkLm5vZGVOYW1lICE9ICdUSCcpIHtcbiAgICAgICAgaW5zdGFuY2Uudmlldy53dC53dFNldHRpbmdzLnNldHRpbmdzLmNlbGxSZW5kZXJlcihyb3csIGNvbCwgdGQpO1xuICAgICAgfVxuICAgICAgY2FsbGJhY2sodmFsaWQpO1xuICAgIH1cbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbGlkYXRvcikgPT09ICdbb2JqZWN0IFJlZ0V4cF0nKSB7XG4gICAgICB2YWxpZGF0b3IgPSAoZnVuY3Rpb24odmFsaWRhdG9yKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih2YWx1ZSwgY2FsbGJhY2spIHtcbiAgICAgICAgICBjYWxsYmFjayh2YWxpZGF0b3IudGVzdCh2YWx1ZSkpO1xuICAgICAgICB9O1xuICAgICAgfSkodmFsaWRhdG9yKTtcbiAgICB9XG4gICAgaWYgKGlzRnVuY3Rpb24odmFsaWRhdG9yKSkge1xuICAgICAgdmFsdWUgPSBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnYmVmb3JlVmFsaWRhdGUnLCB2YWx1ZSwgY2VsbFByb3BlcnRpZXMudmlzdWFsUm93LCBjZWxsUHJvcGVydGllcy5wcm9wLCBzb3VyY2UpO1xuICAgICAgaW5zdGFuY2UuX3JlZ2lzdGVyVGltZW91dChzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICB2YWxpZGF0b3IuY2FsbChjZWxsUHJvcGVydGllcywgdmFsdWUsIGZ1bmN0aW9uKHZhbGlkKSB7XG4gICAgICAgICAgdmFsaWQgPSBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnYWZ0ZXJWYWxpZGF0ZScsIHZhbGlkLCB2YWx1ZSwgY2VsbFByb3BlcnRpZXMudmlzdWFsUm93LCBjZWxsUHJvcGVydGllcy5wcm9wLCBzb3VyY2UpO1xuICAgICAgICAgIGNlbGxQcm9wZXJ0aWVzLnZhbGlkID0gdmFsaWQ7XG4gICAgICAgICAgZG9uZSh2YWxpZCk7XG4gICAgICAgICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ3Bvc3RBZnRlclZhbGlkYXRlJywgdmFsaWQsIHZhbHVlLCBjZWxsUHJvcGVydGllcy52aXN1YWxSb3csIGNlbGxQcm9wZXJ0aWVzLnByb3AsIHNvdXJjZSk7XG4gICAgICAgIH0pO1xuICAgICAgfSwgMCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbnN0YW5jZS5fcmVnaXN0ZXJUaW1lb3V0KHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIGNlbGxQcm9wZXJ0aWVzLnZhbGlkID0gdHJ1ZTtcbiAgICAgICAgZG9uZShjZWxsUHJvcGVydGllcy52YWxpZCk7XG4gICAgICB9LCAwKSk7XG4gICAgfVxuICB9O1xuICBmdW5jdGlvbiBzZXREYXRhSW5wdXRUb0FycmF5KHJvdywgcHJvcE9yQ29sLCB2YWx1ZSkge1xuICAgIGlmICh0eXBlb2Ygcm93ID09PSAnb2JqZWN0Jykge1xuICAgICAgcmV0dXJuIHJvdztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFtbcm93LCBwcm9wT3JDb2wsIHZhbHVlXV07XG4gICAgfVxuICB9XG4gIHRoaXMuc2V0RGF0YUF0Q2VsbCA9IGZ1bmN0aW9uKHJvdywgY29sLCB2YWx1ZSwgc291cmNlKSB7XG4gICAgdmFyIGlucHV0ID0gc2V0RGF0YUlucHV0VG9BcnJheShyb3csIGNvbCwgdmFsdWUpLFxuICAgICAgICBpLFxuICAgICAgICBpbGVuLFxuICAgICAgICBjaGFuZ2VzID0gW10sXG4gICAgICAgIHByb3A7XG4gICAgZm9yIChpID0gMCwgaWxlbiA9IGlucHV0Lmxlbmd0aDsgaSA8IGlsZW47IGkrKykge1xuICAgICAgaWYgKHR5cGVvZiBpbnB1dFtpXSAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNZXRob2QgYHNldERhdGFBdENlbGxgIGFjY2VwdHMgcm93IG51bWJlciBvciBjaGFuZ2VzIGFycmF5IG9mIGFycmF5cyBhcyBpdHMgZmlyc3QgcGFyYW1ldGVyJyk7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIGlucHV0W2ldWzFdICE9PSAnbnVtYmVyJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01ldGhvZCBgc2V0RGF0YUF0Q2VsbGAgYWNjZXB0cyByb3cgYW5kIGNvbHVtbiBudW1iZXIgYXMgaXRzIHBhcmFtZXRlcnMuIElmIHlvdSB3YW50IHRvIHVzZSBvYmplY3QgcHJvcGVydHkgbmFtZSwgdXNlIG1ldGhvZCBgc2V0RGF0YUF0Um93UHJvcGAnKTtcbiAgICAgIH1cbiAgICAgIHByb3AgPSBkYXRhbWFwLmNvbFRvUHJvcChpbnB1dFtpXVsxXSk7XG4gICAgICBjaGFuZ2VzLnB1c2goW2lucHV0W2ldWzBdLCBwcm9wLCBkYXRhU291cmNlLmdldEF0Q2VsbChyZWNvcmRUcmFuc2xhdG9yLnRvUGh5c2ljYWxSb3coaW5wdXRbaV1bMF0pLCBpbnB1dFtpXVsxXSksIGlucHV0W2ldWzJdXSk7XG4gICAgfVxuICAgIGlmICghc291cmNlICYmIHR5cGVvZiByb3cgPT09ICdvYmplY3QnKSB7XG4gICAgICBzb3VyY2UgPSBjb2w7XG4gICAgfVxuICAgIGluc3RhbmNlLnJ1bkhvb2tzKCdhZnRlclNldERhdGFBdENlbGwnLCBjaGFuZ2VzLCBzb3VyY2UpO1xuICAgIHZhbGlkYXRlQ2hhbmdlcyhjaGFuZ2VzLCBzb3VyY2UsIGZ1bmN0aW9uKCkge1xuICAgICAgYXBwbHlDaGFuZ2VzKGNoYW5nZXMsIHNvdXJjZSk7XG4gICAgfSk7XG4gIH07XG4gIHRoaXMuc2V0RGF0YUF0Um93UHJvcCA9IGZ1bmN0aW9uKHJvdywgcHJvcCwgdmFsdWUsIHNvdXJjZSkge1xuICAgIHZhciBpbnB1dCA9IHNldERhdGFJbnB1dFRvQXJyYXkocm93LCBwcm9wLCB2YWx1ZSksXG4gICAgICAgIGksXG4gICAgICAgIGlsZW4sXG4gICAgICAgIGNoYW5nZXMgPSBbXTtcbiAgICBmb3IgKGkgPSAwLCBpbGVuID0gaW5wdXQubGVuZ3RoOyBpIDwgaWxlbjsgaSsrKSB7XG4gICAgICBjaGFuZ2VzLnB1c2goW2lucHV0W2ldWzBdLCBpbnB1dFtpXVsxXSwgZGF0YVNvdXJjZS5nZXRBdENlbGwocmVjb3JkVHJhbnNsYXRvci50b1BoeXNpY2FsUm93KGlucHV0W2ldWzBdKSwgaW5wdXRbaV1bMV0pLCBpbnB1dFtpXVsyXV0pO1xuICAgIH1cbiAgICBpZiAoIXNvdXJjZSAmJiB0eXBlb2Ygcm93ID09PSAnb2JqZWN0Jykge1xuICAgICAgc291cmNlID0gcHJvcDtcbiAgICB9XG4gICAgaW5zdGFuY2UucnVuSG9va3MoJ2FmdGVyU2V0RGF0YUF0Um93UHJvcCcsIGNoYW5nZXMsIHNvdXJjZSk7XG4gICAgdmFsaWRhdGVDaGFuZ2VzKGNoYW5nZXMsIHNvdXJjZSwgZnVuY3Rpb24oKSB7XG4gICAgICBhcHBseUNoYW5nZXMoY2hhbmdlcywgc291cmNlKTtcbiAgICB9KTtcbiAgfTtcbiAgdGhpcy5saXN0ZW4gPSBmdW5jdGlvbigpIHtcbiAgICBIYW5kc29udGFibGUuYWN0aXZlR3VpZCA9IGluc3RhbmNlLmd1aWQ7XG4gIH07XG4gIHRoaXMudW5saXN0ZW4gPSBmdW5jdGlvbigpIHtcbiAgICBIYW5kc29udGFibGUuYWN0aXZlR3VpZCA9IG51bGw7XG4gIH07XG4gIHRoaXMuaXNMaXN0ZW5pbmcgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gSGFuZHNvbnRhYmxlLmFjdGl2ZUd1aWQgPT09IGluc3RhbmNlLmd1aWQ7XG4gIH07XG4gIHRoaXMuZGVzdHJveUVkaXRvciA9IGZ1bmN0aW9uKHJldmVydE9yaWdpbmFsKSB7XG4gICAgc2VsZWN0aW9uLnJlZnJlc2hCb3JkZXJzKHJldmVydE9yaWdpbmFsKTtcbiAgfTtcbiAgdGhpcy5wb3B1bGF0ZUZyb21BcnJheSA9IGZ1bmN0aW9uKHJvdywgY29sLCBpbnB1dCwgZW5kUm93LCBlbmRDb2wsIHNvdXJjZSwgbWV0aG9kLCBkaXJlY3Rpb24sIGRlbHRhcykge1xuICAgIHZhciBjO1xuICAgIGlmICghKHR5cGVvZiBpbnB1dCA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIGlucHV0WzBdID09PSAnb2JqZWN0JykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcigncG9wdWxhdGVGcm9tQXJyYXkgcGFyYW1ldGVyIGBpbnB1dGAgbXVzdCBiZSBhbiBhcnJheSBvZiBhcnJheXMnKTtcbiAgICB9XG4gICAgYyA9IHR5cGVvZiBlbmRSb3cgPT09ICdudW1iZXInID8gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhlbmRSb3csIGVuZENvbCkgOiBudWxsO1xuICAgIHJldHVybiBncmlkLnBvcHVsYXRlRnJvbUFycmF5KG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMocm93LCBjb2wpLCBpbnB1dCwgYywgc291cmNlLCBtZXRob2QsIGRpcmVjdGlvbiwgZGVsdGFzKTtcbiAgfTtcbiAgdGhpcy5zcGxpY2VDb2wgPSBmdW5jdGlvbihjb2wsIGluZGV4LCBhbW91bnQpIHtcbiAgICByZXR1cm4gZGF0YW1hcC5zcGxpY2VDb2wuYXBwbHkoZGF0YW1hcCwgYXJndW1lbnRzKTtcbiAgfTtcbiAgdGhpcy5zcGxpY2VSb3cgPSBmdW5jdGlvbihyb3csIGluZGV4LCBhbW91bnQpIHtcbiAgICByZXR1cm4gZGF0YW1hcC5zcGxpY2VSb3cuYXBwbHkoZGF0YW1hcCwgYXJndW1lbnRzKTtcbiAgfTtcbiAgdGhpcy5nZXRTZWxlY3RlZCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmIChzZWxlY3Rpb24uaXNTZWxlY3RlZCgpKSB7XG4gICAgICByZXR1cm4gW3ByaXYuc2VsUmFuZ2UuZnJvbS5yb3csIHByaXYuc2VsUmFuZ2UuZnJvbS5jb2wsIHByaXYuc2VsUmFuZ2UudG8ucm93LCBwcml2LnNlbFJhbmdlLnRvLmNvbF07XG4gICAgfVxuICB9O1xuICB0aGlzLmdldFNlbGVjdGVkUmFuZ2UgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoc2VsZWN0aW9uLmlzU2VsZWN0ZWQoKSkge1xuICAgICAgcmV0dXJuIHByaXYuc2VsUmFuZ2U7XG4gICAgfVxuICB9O1xuICB0aGlzLnJlbmRlciA9IGZ1bmN0aW9uKCkge1xuICAgIGlmIChpbnN0YW5jZS52aWV3KSB7XG4gICAgICBpbnN0YW5jZS5yZW5kZXJDYWxsID0gdHJ1ZTtcbiAgICAgIGluc3RhbmNlLmZvcmNlRnVsbFJlbmRlciA9IHRydWU7XG4gICAgICBzZWxlY3Rpb24ucmVmcmVzaEJvcmRlcnMobnVsbCwgdHJ1ZSk7XG4gICAgfVxuICB9O1xuICB0aGlzLmxvYWREYXRhID0gZnVuY3Rpb24oZGF0YSkge1xuICAgIGlmIChBcnJheS5pc0FycmF5KHByaXYuc2V0dGluZ3MuZGF0YVNjaGVtYSkpIHtcbiAgICAgIGluc3RhbmNlLmRhdGFUeXBlID0gJ2FycmF5JztcbiAgICB9IGVsc2UgaWYgKGlzRnVuY3Rpb24ocHJpdi5zZXR0aW5ncy5kYXRhU2NoZW1hKSkge1xuICAgICAgaW5zdGFuY2UuZGF0YVR5cGUgPSAnZnVuY3Rpb24nO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbnN0YW5jZS5kYXRhVHlwZSA9ICdvYmplY3QnO1xuICAgIH1cbiAgICBpZiAoZGF0YW1hcCkge1xuICAgICAgZGF0YW1hcC5kZXN0cm95KCk7XG4gICAgfVxuICAgIGRhdGFtYXAgPSBuZXcgRGF0YU1hcChpbnN0YW5jZSwgcHJpdiwgR3JpZFNldHRpbmdzKTtcbiAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdvYmplY3QnICYmIGRhdGEgIT09IG51bGwpIHtcbiAgICAgIGlmICghKGRhdGEucHVzaCAmJiBkYXRhLnNwbGljZSkpIHtcbiAgICAgICAgZGF0YSA9IFtkYXRhXTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGRhdGEgPT09IG51bGwpIHtcbiAgICAgIGRhdGEgPSBbXTtcbiAgICAgIHZhciByb3c7XG4gICAgICB2YXIgciA9IDA7XG4gICAgICB2YXIgcmxlbiA9IDA7XG4gICAgICB2YXIgZGF0YVNjaGVtYSA9IGRhdGFtYXAuZ2V0U2NoZW1hKCk7XG4gICAgICBmb3IgKHIgPSAwLCBybGVuID0gcHJpdi5zZXR0aW5ncy5zdGFydFJvd3M7IHIgPCBybGVuOyByKyspIHtcbiAgICAgICAgaWYgKChpbnN0YW5jZS5kYXRhVHlwZSA9PT0gJ29iamVjdCcgfHwgaW5zdGFuY2UuZGF0YVR5cGUgPT09ICdmdW5jdGlvbicpICYmIHByaXYuc2V0dGluZ3MuZGF0YVNjaGVtYSkge1xuICAgICAgICAgIHJvdyA9IGRlZXBDbG9uZShkYXRhU2NoZW1hKTtcbiAgICAgICAgICBkYXRhLnB1c2gocm93KTtcbiAgICAgICAgfSBlbHNlIGlmIChpbnN0YW5jZS5kYXRhVHlwZSA9PT0gJ2FycmF5Jykge1xuICAgICAgICAgIHJvdyA9IGRlZXBDbG9uZShkYXRhU2NoZW1hWzBdKTtcbiAgICAgICAgICBkYXRhLnB1c2gocm93KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByb3cgPSBbXTtcbiAgICAgICAgICBmb3IgKHZhciBjID0gMCxcbiAgICAgICAgICAgICAgY2xlbiA9IHByaXYuc2V0dGluZ3Muc3RhcnRDb2xzOyBjIDwgY2xlbjsgYysrKSB7XG4gICAgICAgICAgICByb3cucHVzaChudWxsKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZGF0YS5wdXNoKHJvdyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdsb2FkRGF0YSBvbmx5IGFjY2VwdHMgYXJyYXkgb2Ygb2JqZWN0cyBvciBhcnJheSBvZiBhcnJheXMgKCcgKyB0eXBlb2YgZGF0YSArICcgZ2l2ZW4pJyk7XG4gICAgfVxuICAgIHByaXYuaXNQb3B1bGF0ZWQgPSBmYWxzZTtcbiAgICBHcmlkU2V0dGluZ3MucHJvdG90eXBlLmRhdGEgPSBkYXRhO1xuICAgIGlmIChBcnJheS5pc0FycmF5KGRhdGFbMF0pKSB7XG4gICAgICBpbnN0YW5jZS5kYXRhVHlwZSA9ICdhcnJheSc7XG4gICAgfVxuICAgIGRhdGFtYXAuZGF0YVNvdXJjZSA9IGRhdGE7XG4gICAgZGF0YVNvdXJjZS5kYXRhID0gZGF0YTtcbiAgICBkYXRhU291cmNlLmRhdGFUeXBlID0gaW5zdGFuY2UuZGF0YVR5cGU7XG4gICAgZGF0YVNvdXJjZS5jb2xUb1Byb3AgPSBkYXRhbWFwLmNvbFRvUHJvcC5iaW5kKGRhdGFtYXApO1xuICAgIGRhdGFTb3VyY2UucHJvcFRvQ29sID0gZGF0YW1hcC5wcm9wVG9Db2wuYmluZChkYXRhbWFwKTtcbiAgICBjbGVhckNlbGxTZXR0aW5nQ2FjaGUoKTtcbiAgICBncmlkLmFkanVzdFJvd3NBbmRDb2xzKCk7XG4gICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2FmdGVyTG9hZERhdGEnLCBwcml2LmZpcnN0UnVuKTtcbiAgICBpZiAocHJpdi5maXJzdFJ1bikge1xuICAgICAgcHJpdi5maXJzdFJ1biA9IFtudWxsLCAnbG9hZERhdGEnXTtcbiAgICB9IGVsc2Uge1xuICAgICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2FmdGVyQ2hhbmdlJywgbnVsbCwgJ2xvYWREYXRhJyk7XG4gICAgICBpbnN0YW5jZS5yZW5kZXIoKTtcbiAgICB9XG4gICAgcHJpdi5pc1BvcHVsYXRlZCA9IHRydWU7XG4gICAgZnVuY3Rpb24gY2xlYXJDZWxsU2V0dGluZ0NhY2hlKCkge1xuICAgICAgcHJpdi5jZWxsU2V0dGluZ3MubGVuZ3RoID0gMDtcbiAgICB9XG4gIH07XG4gIHRoaXMuZ2V0RGF0YSA9IGZ1bmN0aW9uKHIsIGMsIHIyLCBjMikge1xuICAgIGlmIChpc1VuZGVmaW5lZChyKSkge1xuICAgICAgcmV0dXJuIGRhdGFtYXAuZ2V0QWxsKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBkYXRhbWFwLmdldFJhbmdlKG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMociwgYyksIG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMocjIsIGMyKSwgZGF0YW1hcC5ERVNUSU5BVElPTl9SRU5ERVJFUik7XG4gICAgfVxuICB9O1xuICB0aGlzLmdldENvcHlhYmxlVGV4dCA9IGZ1bmN0aW9uKHN0YXJ0Um93LCBzdGFydENvbCwgZW5kUm93LCBlbmRDb2wpIHtcbiAgICByZXR1cm4gZGF0YW1hcC5nZXRDb3B5YWJsZVRleHQobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhzdGFydFJvdywgc3RhcnRDb2wpLCBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKGVuZFJvdywgZW5kQ29sKSk7XG4gIH07XG4gIHRoaXMuZ2V0Q29weWFibGVEYXRhID0gZnVuY3Rpb24ocm93LCBjb2x1bW4pIHtcbiAgICByZXR1cm4gZGF0YW1hcC5nZXRDb3B5YWJsZShyb3csIGRhdGFtYXAuY29sVG9Qcm9wKGNvbHVtbikpO1xuICB9O1xuICB0aGlzLmdldFNjaGVtYSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBkYXRhbWFwLmdldFNjaGVtYSgpO1xuICB9O1xuICB0aGlzLnVwZGF0ZVNldHRpbmdzID0gZnVuY3Rpb24oc2V0dGluZ3MsIGluaXQpIHtcbiAgICB2YXIgY29sdW1uc0FzRnVuYyA9IGZhbHNlO1xuICAgIHZhciBpO1xuICAgIHZhciBqO1xuICAgIHZhciBjbGVuO1xuICAgIGlmIChpc0RlZmluZWQoc2V0dGluZ3Mucm93cykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignXCJyb3dzXCIgc2V0dGluZyBpcyBubyBsb25nZXIgc3VwcG9ydGVkLiBkbyB5b3UgbWVhbiBzdGFydFJvd3MsIG1pblJvd3Mgb3IgbWF4Um93cz8nKTtcbiAgICB9XG4gICAgaWYgKGlzRGVmaW5lZChzZXR0aW5ncy5jb2xzKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdcImNvbHNcIiBzZXR0aW5nIGlzIG5vIGxvbmdlciBzdXBwb3J0ZWQuIGRvIHlvdSBtZWFuIHN0YXJ0Q29scywgbWluQ29scyBvciBtYXhDb2xzPycpO1xuICAgIH1cbiAgICBmb3IgKGkgaW4gc2V0dGluZ3MpIHtcbiAgICAgIGlmIChpID09PSAnZGF0YScpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoSGFuZHNvbnRhYmxlLmhvb2tzLmdldFJlZ2lzdGVyZWQoKS5pbmRleE9mKGkpID4gLTEpIHtcbiAgICAgICAgICBpZiAoaXNGdW5jdGlvbihzZXR0aW5nc1tpXSkgfHwgQXJyYXkuaXNBcnJheShzZXR0aW5nc1tpXSkpIHtcbiAgICAgICAgICAgIHNldHRpbmdzW2ldLmluaXRpYWxIb29rID0gdHJ1ZTtcbiAgICAgICAgICAgIGluc3RhbmNlLmFkZEhvb2soaSwgc2V0dGluZ3NbaV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoIWluaXQgJiYgc2V0dGluZ3MuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgICAgIEdyaWRTZXR0aW5ncy5wcm90b3R5cGVbaV0gPSBzZXR0aW5nc1tpXTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHNldHRpbmdzLmRhdGEgPT09IHZvaWQgMCAmJiBwcml2LnNldHRpbmdzLmRhdGEgPT09IHZvaWQgMCkge1xuICAgICAgaW5zdGFuY2UubG9hZERhdGEobnVsbCk7XG4gICAgfSBlbHNlIGlmIChzZXR0aW5ncy5kYXRhICE9PSB2b2lkIDApIHtcbiAgICAgIGluc3RhbmNlLmxvYWREYXRhKHNldHRpbmdzLmRhdGEpO1xuICAgIH0gZWxzZSBpZiAoc2V0dGluZ3MuY29sdW1ucyAhPT0gdm9pZCAwKSB7XG4gICAgICBkYXRhbWFwLmNyZWF0ZU1hcCgpO1xuICAgIH1cbiAgICBjbGVuID0gaW5zdGFuY2UuY291bnRDb2xzKCk7XG4gICAgdmFyIGNvbHVtblNldHRpbmcgPSBzZXR0aW5ncy5jb2x1bW5zIHx8IEdyaWRTZXR0aW5ncy5wcm90b3R5cGUuY29sdW1ucztcbiAgICBpZiAoY29sdW1uU2V0dGluZyAmJiBpc0Z1bmN0aW9uKGNvbHVtblNldHRpbmcpKSB7XG4gICAgICBjbGVuID0gaW5zdGFuY2UuY291bnRTb3VyY2VDb2xzKCk7XG4gICAgICBjb2x1bW5zQXNGdW5jID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKHNldHRpbmdzLmNlbGwgIT09IHZvaWQgMCB8fCBzZXR0aW5ncy5jZWxscyAhPT0gdm9pZCAwIHx8IHNldHRpbmdzLmNvbHVtbnMgIT09IHZvaWQgMCkge1xuICAgICAgcHJpdi5jZWxsU2V0dGluZ3MubGVuZ3RoID0gMDtcbiAgICB9XG4gICAgaWYgKGNsZW4gPiAwKSB7XG4gICAgICB2YXIgcHJvdG87XG4gICAgICB2YXIgY29sdW1uO1xuICAgICAgZm9yIChpID0gMCwgaiA9IDA7IGkgPCBjbGVuOyBpKyspIHtcbiAgICAgICAgaWYgKGNvbHVtbnNBc0Z1bmMgJiYgIWNvbHVtblNldHRpbmcoaSkpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBwcml2LmNvbHVtblNldHRpbmdzW2pdID0gY29sdW1uRmFjdG9yeShHcmlkU2V0dGluZ3MsIHByaXYuY29sdW1uc1NldHRpbmdDb25mbGljdHMpO1xuICAgICAgICBwcm90byA9IHByaXYuY29sdW1uU2V0dGluZ3Nbal0ucHJvdG90eXBlO1xuICAgICAgICBpZiAoY29sdW1uU2V0dGluZykge1xuICAgICAgICAgIGlmIChjb2x1bW5zQXNGdW5jKSB7XG4gICAgICAgICAgICBjb2x1bW4gPSBjb2x1bW5TZXR0aW5nKGkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb2x1bW4gPSBjb2x1bW5TZXR0aW5nW2pdO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY29sdW1uKSB7XG4gICAgICAgICAgICBleHRlbmQocHJvdG8sIGNvbHVtbik7XG4gICAgICAgICAgICBleHRlbmQocHJvdG8sIGV4cGFuZFR5cGUoY29sdW1uKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGorKztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGlzRGVmaW5lZChzZXR0aW5ncy5jZWxsKSkge1xuICAgICAgZm9yICh2YXIga2V5IGluIHNldHRpbmdzLmNlbGwpIHtcbiAgICAgICAgaWYgKHNldHRpbmdzLmNlbGwuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgIHZhciBjZWxsID0gc2V0dGluZ3MuY2VsbFtrZXldO1xuICAgICAgICAgIGluc3RhbmNlLnNldENlbGxNZXRhT2JqZWN0KGNlbGwucm93LCBjZWxsLmNvbCwgY2VsbCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2FmdGVyQ2VsbE1ldGFSZXNldCcpO1xuICAgIGlmIChpc0RlZmluZWQoc2V0dGluZ3MuY2xhc3NOYW1lKSkge1xuICAgICAgaWYgKEdyaWRTZXR0aW5ncy5wcm90b3R5cGUuY2xhc3NOYW1lKSB7XG4gICAgICAgIHJlbW92ZUNsYXNzKGluc3RhbmNlLnJvb3RFbGVtZW50LCBHcmlkU2V0dGluZ3MucHJvdG90eXBlLmNsYXNzTmFtZSk7XG4gICAgICB9XG4gICAgICBpZiAoc2V0dGluZ3MuY2xhc3NOYW1lKSB7XG4gICAgICAgIGFkZENsYXNzKGluc3RhbmNlLnJvb3RFbGVtZW50LCBzZXR0aW5ncy5jbGFzc05hbWUpO1xuICAgICAgfVxuICAgIH1cbiAgICB2YXIgY3VycmVudEhlaWdodCA9IGluc3RhbmNlLnJvb3RFbGVtZW50LnN0eWxlLmhlaWdodDtcbiAgICBpZiAoY3VycmVudEhlaWdodCAhPT0gJycpIHtcbiAgICAgIGN1cnJlbnRIZWlnaHQgPSBwYXJzZUludChpbnN0YW5jZS5yb290RWxlbWVudC5zdHlsZS5oZWlnaHQsIDEwKTtcbiAgICB9XG4gICAgdmFyIGhlaWdodCA9IHNldHRpbmdzLmhlaWdodDtcbiAgICBpZiAoaXNGdW5jdGlvbihoZWlnaHQpKSB7XG4gICAgICBoZWlnaHQgPSBoZWlnaHQoKTtcbiAgICB9XG4gICAgaWYgKGluaXQpIHtcbiAgICAgIHZhciBpbml0aWFsU3R5bGUgPSBpbnN0YW5jZS5yb290RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3N0eWxlJyk7XG4gICAgICBpZiAoaW5pdGlhbFN0eWxlKSB7XG4gICAgICAgIGluc3RhbmNlLnJvb3RFbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1pbml0aWFsc3R5bGUnLCBpbnN0YW5jZS5yb290RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3N0eWxlJykpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoaGVpZ2h0ID09PSBudWxsKSB7XG4gICAgICB2YXIgaW5pdGlhbFN0eWxlJF9fMjkgPSBpbnN0YW5jZS5yb290RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaW5pdGlhbHN0eWxlJyk7XG4gICAgICBpZiAoaW5pdGlhbFN0eWxlJF9fMjkgJiYgKGluaXRpYWxTdHlsZSRfXzI5LmluZGV4T2YoJ2hlaWdodCcpID4gLTEgfHwgaW5pdGlhbFN0eWxlJF9fMjkuaW5kZXhPZignb3ZlcmZsb3cnKSA+IC0xKSkge1xuICAgICAgICBpbnN0YW5jZS5yb290RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgaW5pdGlhbFN0eWxlJF9fMjkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaW5zdGFuY2Uucm9vdEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gJyc7XG4gICAgICAgIGluc3RhbmNlLnJvb3RFbGVtZW50LnN0eWxlLm92ZXJmbG93ID0gJyc7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChoZWlnaHQgIT09IHZvaWQgMCkge1xuICAgICAgaW5zdGFuY2Uucm9vdEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgJ3B4JztcbiAgICAgIGluc3RhbmNlLnJvb3RFbGVtZW50LnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygc2V0dGluZ3Mud2lkdGggIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHZhciB3aWR0aCA9IHNldHRpbmdzLndpZHRoO1xuICAgICAgaWYgKGlzRnVuY3Rpb24od2lkdGgpKSB7XG4gICAgICAgIHdpZHRoID0gd2lkdGgoKTtcbiAgICAgIH1cbiAgICAgIGluc3RhbmNlLnJvb3RFbGVtZW50LnN0eWxlLndpZHRoID0gd2lkdGggKyAncHgnO1xuICAgIH1cbiAgICBpZiAoIWluaXQpIHtcbiAgICAgIGRhdGFtYXAuY2xlYXJMZW5ndGhDYWNoZSgpO1xuICAgICAgaWYgKGluc3RhbmNlLnZpZXcpIHtcbiAgICAgICAgaW5zdGFuY2Uudmlldy53dC53dFZpZXdwb3J0LnJlc2V0SGFzT3ZlcnNpemVkQ29sdW1uSGVhZGVyc01hcmtlZCgpO1xuICAgICAgfVxuICAgICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2FmdGVyVXBkYXRlU2V0dGluZ3MnKTtcbiAgICB9XG4gICAgZ3JpZC5hZGp1c3RSb3dzQW5kQ29scygpO1xuICAgIGlmIChpbnN0YW5jZS52aWV3ICYmICFwcml2LmZpcnN0UnVuKSB7XG4gICAgICBpbnN0YW5jZS5mb3JjZUZ1bGxSZW5kZXIgPSB0cnVlO1xuICAgICAgc2VsZWN0aW9uLnJlZnJlc2hCb3JkZXJzKG51bGwsIHRydWUpO1xuICAgIH1cbiAgICBpZiAoIWluaXQgJiYgaW5zdGFuY2UudmlldyAmJiAoY3VycmVudEhlaWdodCA9PT0gJycgfHwgaGVpZ2h0ID09PSAnJyB8fCBoZWlnaHQgPT09IHZvaWQgMCkgJiYgY3VycmVudEhlaWdodCAhPT0gaGVpZ2h0KSB7XG4gICAgICBpbnN0YW5jZS52aWV3Lnd0Lnd0T3ZlcmxheXMudXBkYXRlTWFpblNjcm9sbGFibGVFbGVtZW50cygpO1xuICAgIH1cbiAgfTtcbiAgdGhpcy5nZXRWYWx1ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWwgPSBpbnN0YW5jZS5nZXRTZWxlY3RlZCgpO1xuICAgIGlmIChHcmlkU2V0dGluZ3MucHJvdG90eXBlLmdldFZhbHVlKSB7XG4gICAgICBpZiAoaXNGdW5jdGlvbihHcmlkU2V0dGluZ3MucHJvdG90eXBlLmdldFZhbHVlKSkge1xuICAgICAgICByZXR1cm4gR3JpZFNldHRpbmdzLnByb3RvdHlwZS5nZXRWYWx1ZS5jYWxsKGluc3RhbmNlKTtcbiAgICAgIH0gZWxzZSBpZiAoc2VsKSB7XG4gICAgICAgIHJldHVybiBpbnN0YW5jZS5nZXREYXRhKClbc2VsWzBdXVtHcmlkU2V0dGluZ3MucHJvdG90eXBlLmdldFZhbHVlXTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHNlbCkge1xuICAgICAgcmV0dXJuIGluc3RhbmNlLmdldERhdGFBdENlbGwoc2VsWzBdLCBzZWxbMV0pO1xuICAgIH1cbiAgfTtcbiAgZnVuY3Rpb24gZXhwYW5kVHlwZShvYmopIHtcbiAgICBpZiAoIW9iai5oYXNPd25Qcm9wZXJ0eSgndHlwZScpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0eXBlLFxuICAgICAgICBleHBhbmRlZFR5cGUgPSB7fTtcbiAgICBpZiAodHlwZW9mIG9iai50eXBlID09PSAnb2JqZWN0Jykge1xuICAgICAgdHlwZSA9IG9iai50eXBlO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIG9iai50eXBlID09PSAnc3RyaW5nJykge1xuICAgICAgdHlwZSA9IEhhbmRzb250YWJsZS5jZWxsVHlwZXNbb2JqLnR5cGVdO1xuICAgICAgaWYgKHR5cGUgPT09IHZvaWQgMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBkZWNsYXJlZCBjZWxsIHR5cGUgXCInICsgb2JqLnR5cGUgKyAnXCIgYXMgYSBzdHJpbmcgdGhhdCBpcyBub3QgbWFwcGVkIHRvIGEga25vd24gb2JqZWN0LiBDZWxsIHR5cGUgbXVzdCBiZSBhbiBvYmplY3Qgb3IgYSBzdHJpbmcgbWFwcGVkIHRvIGFuIG9iamVjdCBpbiBIYW5kc29udGFibGUuY2VsbFR5cGVzJyk7XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAodmFyIGkgaW4gdHlwZSkge1xuICAgICAgaWYgKHR5cGUuaGFzT3duUHJvcGVydHkoaSkgJiYgIW9iai5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICBleHBhbmRlZFR5cGVbaV0gPSB0eXBlW2ldO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZXhwYW5kZWRUeXBlO1xuICB9XG4gIHRoaXMuZ2V0U2V0dGluZ3MgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gcHJpdi5zZXR0aW5ncztcbiAgfTtcbiAgdGhpcy5jbGVhciA9IGZ1bmN0aW9uKCkge1xuICAgIHNlbGVjdGlvbi5zZWxlY3RBbGwoKTtcbiAgICBzZWxlY3Rpb24uZW1wdHkoKTtcbiAgfTtcbiAgdGhpcy5hbHRlciA9IGZ1bmN0aW9uKGFjdGlvbiwgaW5kZXgsIGFtb3VudCwgc291cmNlLCBrZWVwRW1wdHlSb3dzKSB7XG4gICAgZ3JpZC5hbHRlcihhY3Rpb24sIGluZGV4LCBhbW91bnQsIHNvdXJjZSwga2VlcEVtcHR5Um93cyk7XG4gIH07XG4gIHRoaXMuZ2V0Q2VsbCA9IGZ1bmN0aW9uKHJvdywgY29sLCB0b3Btb3N0KSB7XG4gICAgcmV0dXJuIGluc3RhbmNlLnZpZXcuZ2V0Q2VsbEF0Q29vcmRzKG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMocm93LCBjb2wpLCB0b3Btb3N0KTtcbiAgfTtcbiAgdGhpcy5nZXRDb29yZHMgPSBmdW5jdGlvbihlbGVtKSB7XG4gICAgcmV0dXJuIHRoaXMudmlldy53dC53dFRhYmxlLmdldENvb3Jkcy5jYWxsKHRoaXMudmlldy53dC53dFRhYmxlLCBlbGVtKTtcbiAgfTtcbiAgdGhpcy5jb2xUb1Byb3AgPSBmdW5jdGlvbihjb2wpIHtcbiAgICByZXR1cm4gZGF0YW1hcC5jb2xUb1Byb3AoY29sKTtcbiAgfTtcbiAgdGhpcy5wcm9wVG9Db2wgPSBmdW5jdGlvbihwcm9wKSB7XG4gICAgcmV0dXJuIGRhdGFtYXAucHJvcFRvQ29sKHByb3ApO1xuICB9O1xuICB0aGlzLnRvVmlzdWFsUm93ID0gKGZ1bmN0aW9uKHJvdykge1xuICAgIHJldHVybiByZWNvcmRUcmFuc2xhdG9yLnRvVmlzdWFsUm93KHJvdyk7XG4gIH0pO1xuICB0aGlzLnRvVmlzdWFsQ29sdW1uID0gKGZ1bmN0aW9uKGNvbHVtbikge1xuICAgIHJldHVybiByZWNvcmRUcmFuc2xhdG9yLnRvVmlzdWFsQ29sdW1uKGNvbHVtbik7XG4gIH0pO1xuICB0aGlzLnRvUGh5c2ljYWxSb3cgPSAoZnVuY3Rpb24ocm93KSB7XG4gICAgcmV0dXJuIHJlY29yZFRyYW5zbGF0b3IudG9QaHlzaWNhbFJvdyhyb3cpO1xuICB9KTtcbiAgdGhpcy50b1BoeXNpY2FsQ29sdW1uID0gKGZ1bmN0aW9uKGNvbHVtbikge1xuICAgIHJldHVybiByZWNvcmRUcmFuc2xhdG9yLnRvUGh5c2ljYWxDb2x1bW4oY29sdW1uKTtcbiAgfSk7XG4gIHRoaXMuZ2V0RGF0YUF0Q2VsbCA9IGZ1bmN0aW9uKHJvdywgY29sKSB7XG4gICAgcmV0dXJuIGRhdGFtYXAuZ2V0KHJvdywgZGF0YW1hcC5jb2xUb1Byb3AoY29sKSk7XG4gIH07XG4gIHRoaXMuZ2V0RGF0YUF0Um93UHJvcCA9IGZ1bmN0aW9uKHJvdywgcHJvcCkge1xuICAgIHJldHVybiBkYXRhbWFwLmdldChyb3csIHByb3ApO1xuICB9O1xuICB0aGlzLmdldERhdGFBdENvbCA9IGZ1bmN0aW9uKGNvbCkge1xuICAgIHZhciBvdXQgPSBbXTtcbiAgICByZXR1cm4gb3V0LmNvbmNhdC5hcHBseShvdXQsIGRhdGFtYXAuZ2V0UmFuZ2UobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcygwLCBjb2wpLCBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHByaXYuc2V0dGluZ3MuZGF0YS5sZW5ndGggLSAxLCBjb2wpLCBkYXRhbWFwLkRFU1RJTkFUSU9OX1JFTkRFUkVSKSk7XG4gIH07XG4gIHRoaXMuZ2V0RGF0YUF0UHJvcCA9IGZ1bmN0aW9uKHByb3ApIHtcbiAgICB2YXIgb3V0ID0gW10sXG4gICAgICAgIHJhbmdlO1xuICAgIHJhbmdlID0gZGF0YW1hcC5nZXRSYW5nZShuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKDAsIGRhdGFtYXAucHJvcFRvQ29sKHByb3ApKSwgbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3Jkcyhwcml2LnNldHRpbmdzLmRhdGEubGVuZ3RoIC0gMSwgZGF0YW1hcC5wcm9wVG9Db2wocHJvcCkpLCBkYXRhbWFwLkRFU1RJTkFUSU9OX1JFTkRFUkVSKTtcbiAgICByZXR1cm4gb3V0LmNvbmNhdC5hcHBseShvdXQsIHJhbmdlKTtcbiAgfTtcbiAgdGhpcy5nZXRTb3VyY2VEYXRhID0gZnVuY3Rpb24ociwgYywgcjIsIGMyKSB7XG4gICAgdmFyIGRhdGE7XG4gICAgaWYgKHIgPT09IHZvaWQgMCkge1xuICAgICAgZGF0YSA9IGRhdGFTb3VyY2UuZ2V0RGF0YSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkYXRhID0gZGF0YVNvdXJjZS5nZXRCeVJhbmdlKG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMociwgYyksIG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMocjIsIGMyKSk7XG4gICAgfVxuICAgIHJldHVybiBkYXRhO1xuICB9O1xuICB0aGlzLmdldFNvdXJjZURhdGFBcnJheSA9IGZ1bmN0aW9uKHIsIGMsIHIyLCBjMikge1xuICAgIHZhciBkYXRhO1xuICAgIGlmIChyID09PSB2b2lkIDApIHtcbiAgICAgIGRhdGEgPSBkYXRhU291cmNlLmdldERhdGEodHJ1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRhdGEgPSBkYXRhU291cmNlLmdldEJ5UmFuZ2UobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhyLCBjKSwgbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhyMiwgYzIpLCB0cnVlKTtcbiAgICB9XG4gICAgcmV0dXJuIGRhdGE7XG4gIH07XG4gIHRoaXMuZ2V0U291cmNlRGF0YUF0Q29sID0gZnVuY3Rpb24oY29sdW1uKSB7XG4gICAgcmV0dXJuIGRhdGFTb3VyY2UuZ2V0QXRDb2x1bW4oY29sdW1uKTtcbiAgfTtcbiAgdGhpcy5nZXRTb3VyY2VEYXRhQXRSb3cgPSBmdW5jdGlvbihyb3cpIHtcbiAgICByZXR1cm4gZGF0YVNvdXJjZS5nZXRBdFJvdyhyb3cpO1xuICB9O1xuICB0aGlzLmdldFNvdXJjZURhdGFBdENlbGwgPSBmdW5jdGlvbihyb3csIGNvbHVtbikge1xuICAgIHJldHVybiBkYXRhU291cmNlLmdldEF0Q2VsbChyb3csIGNvbHVtbik7XG4gIH07XG4gIHRoaXMuZ2V0RGF0YUF0Um93ID0gZnVuY3Rpb24ocm93KSB7XG4gICAgdmFyIGRhdGEgPSBkYXRhbWFwLmdldFJhbmdlKG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMocm93LCAwKSwgbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3Jkcyhyb3csIHRoaXMuY291bnRDb2xzKCkgLSAxKSwgZGF0YW1hcC5ERVNUSU5BVElPTl9SRU5ERVJFUik7XG4gICAgcmV0dXJuIGRhdGFbMF07XG4gIH07XG4gIHRoaXMuZ2V0RGF0YVR5cGUgPSBmdW5jdGlvbihyb3dGcm9tLCBjb2x1bW5Gcm9tLCByb3dUbywgY29sdW1uVG8pIHtcbiAgICB2YXIgJF9fMjMgPSB0aGlzO1xuICAgIHZhciBwcmV2aW91c1R5cGUgPSBudWxsO1xuICAgIHZhciBjdXJyZW50VHlwZSA9IG51bGw7XG4gICAgaWYgKHJvd0Zyb20gPT09IHZvaWQgMCkge1xuICAgICAgcm93RnJvbSA9IDA7XG4gICAgICByb3dUbyA9IHRoaXMuY291bnRSb3dzKCk7XG4gICAgICBjb2x1bW5Gcm9tID0gMDtcbiAgICAgIGNvbHVtblRvID0gdGhpcy5jb3VudENvbHMoKTtcbiAgICB9XG4gICAgaWYgKHJvd1RvID09PSB2b2lkIDApIHtcbiAgICAgIHJvd1RvID0gcm93RnJvbTtcbiAgICB9XG4gICAgaWYgKGNvbHVtblRvID09PSB2b2lkIDApIHtcbiAgICAgIGNvbHVtblRvID0gY29sdW1uRnJvbTtcbiAgICB9XG4gICAgdmFyIHR5cGUgPSAnbWl4ZWQnO1xuICAgIHJhbmdlRWFjaChNYXRoLm1pbihyb3dGcm9tLCByb3dUbyksIE1hdGgubWF4KHJvd0Zyb20sIHJvd1RvKSwgKGZ1bmN0aW9uKHJvdykge1xuICAgICAgdmFyIGlzVHlwZUVxdWFsID0gdHJ1ZTtcbiAgICAgIHJhbmdlRWFjaChNYXRoLm1pbihjb2x1bW5Gcm9tLCBjb2x1bW5UbyksIE1hdGgubWF4KGNvbHVtbkZyb20sIGNvbHVtblRvKSwgKGZ1bmN0aW9uKGNvbHVtbikge1xuICAgICAgICB2YXIgY2VsbFR5cGUgPSAkX18yMy5nZXRDZWxsTWV0YShyb3csIGNvbHVtbik7XG4gICAgICAgIGN1cnJlbnRUeXBlID0gY2VsbFR5cGUudHlwZTtcbiAgICAgICAgaWYgKHByZXZpb3VzVHlwZSkge1xuICAgICAgICAgIGlzVHlwZUVxdWFsID0gcHJldmlvdXNUeXBlID09PSBjdXJyZW50VHlwZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwcmV2aW91c1R5cGUgPSBjdXJyZW50VHlwZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNUeXBlRXF1YWw7XG4gICAgICB9KSk7XG4gICAgICB0eXBlID0gaXNUeXBlRXF1YWwgPyBjdXJyZW50VHlwZSA6ICdtaXhlZCc7XG4gICAgICByZXR1cm4gaXNUeXBlRXF1YWw7XG4gICAgfSkpO1xuICAgIHJldHVybiB0eXBlO1xuICB9O1xuICB0aGlzLnJlbW92ZUNlbGxNZXRhID0gZnVuY3Rpb24ocm93LCBjb2wsIGtleSkge1xuICAgIHZhciBjZWxsTWV0YSA9IGluc3RhbmNlLmdldENlbGxNZXRhKHJvdywgY29sKTtcbiAgICBpZiAoY2VsbE1ldGFba2V5XSAhPSB1bmRlZmluZWQpIHtcbiAgICAgIGRlbGV0ZSBwcml2LmNlbGxTZXR0aW5nc1tyb3ddW2NvbF1ba2V5XTtcbiAgICB9XG4gIH07XG4gIHRoaXMuc3BsaWNlQ2VsbHNNZXRhID0gZnVuY3Rpb24oaW5kZXgsIGRlbGV0ZUFtb3VudCkge1xuICAgIHZhciAkX18yNjtcbiAgICBmb3IgKHZhciBpdGVtcyA9IFtdLFxuICAgICAgICAkX18yNCA9IDI7ICRfXzI0IDwgYXJndW1lbnRzLmxlbmd0aDsgJF9fMjQrKylcbiAgICAgIGl0ZW1zWyRfXzI0IC0gMl0gPSBhcmd1bWVudHNbJF9fMjRdO1xuICAgICgkX18yNiA9IHByaXYuY2VsbFNldHRpbmdzKS5zcGxpY2UuYXBwbHkoJF9fMjYsICR0cmFjZXVyUnVudGltZS5zcHJlYWQoW2luZGV4LCBkZWxldGVBbW91bnRdLCBpdGVtcykpO1xuICB9O1xuICB0aGlzLnNldENlbGxNZXRhT2JqZWN0ID0gZnVuY3Rpb24ocm93LCBjb2wsIHByb3ApIHtcbiAgICBpZiAodHlwZW9mIHByb3AgPT09ICdvYmplY3QnKSB7XG4gICAgICBmb3IgKHZhciBrZXkgaW4gcHJvcCkge1xuICAgICAgICBpZiAocHJvcC5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgdmFyIHZhbHVlID0gcHJvcFtrZXldO1xuICAgICAgICAgIHRoaXMuc2V0Q2VsbE1ldGEocm93LCBjb2wsIGtleSwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuICB0aGlzLnNldENlbGxNZXRhID0gZnVuY3Rpb24ocm93LCBjb2wsIGtleSwgdmFsKSB7XG4gICAgdmFyICRfXzI1O1xuICAgICgkX18yNSA9IHJlY29yZFRyYW5zbGF0b3IudG9QaHlzaWNhbChyb3csIGNvbCksIHJvdyA9ICRfXzI1WzBdLCBjb2wgPSAkX18yNVsxXSwgJF9fMjUpO1xuICAgIGlmICghcHJpdi5jZWxsU2V0dGluZ3Nbcm93XSkge1xuICAgICAgcHJpdi5jZWxsU2V0dGluZ3Nbcm93XSA9IFtdO1xuICAgIH1cbiAgICBpZiAoIXByaXYuY2VsbFNldHRpbmdzW3Jvd11bY29sXSkge1xuICAgICAgcHJpdi5jZWxsU2V0dGluZ3Nbcm93XVtjb2xdID0gbmV3IHByaXYuY29sdW1uU2V0dGluZ3NbY29sXSgpO1xuICAgIH1cbiAgICBwcml2LmNlbGxTZXR0aW5nc1tyb3ddW2NvbF1ba2V5XSA9IHZhbDtcbiAgICBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnYWZ0ZXJTZXRDZWxsTWV0YScsIHJvdywgY29sLCBrZXksIHZhbCk7XG4gIH07XG4gIHRoaXMuZ2V0Q2VsbHNNZXRhID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGFycmF5RmxhdHRlbihwcml2LmNlbGxTZXR0aW5ncyk7XG4gIH07XG4gIHRoaXMuZ2V0Q2VsbE1ldGEgPSBmdW5jdGlvbihyb3csIGNvbCkge1xuICAgIHZhciAkX18yNTtcbiAgICB2YXIgcHJvcCA9IGRhdGFtYXAuY29sVG9Qcm9wKGNvbCksXG4gICAgICAgIGNlbGxQcm9wZXJ0aWVzO1xuICAgIHZhciB2aXN1YWxSb3cgPSByb3c7XG4gICAgdmFyIHZpc3VhbENvbCA9IGNvbDtcbiAgICAoJF9fMjUgPSByZWNvcmRUcmFuc2xhdG9yLnRvUGh5c2ljYWwocm93LCBjb2wpLCByb3cgPSAkX18yNVswXSwgY29sID0gJF9fMjVbMV0sICRfXzI1KTtcbiAgICBpZiAoIXByaXYuY29sdW1uU2V0dGluZ3NbY29sXSkge1xuICAgICAgcHJpdi5jb2x1bW5TZXR0aW5nc1tjb2xdID0gY29sdW1uRmFjdG9yeShHcmlkU2V0dGluZ3MsIHByaXYuY29sdW1uc1NldHRpbmdDb25mbGljdHMpO1xuICAgIH1cbiAgICBpZiAoIXByaXYuY2VsbFNldHRpbmdzW3Jvd10pIHtcbiAgICAgIHByaXYuY2VsbFNldHRpbmdzW3Jvd10gPSBbXTtcbiAgICB9XG4gICAgaWYgKCFwcml2LmNlbGxTZXR0aW5nc1tyb3ddW2NvbF0pIHtcbiAgICAgIHByaXYuY2VsbFNldHRpbmdzW3Jvd11bY29sXSA9IG5ldyBwcml2LmNvbHVtblNldHRpbmdzW2NvbF0oKTtcbiAgICB9XG4gICAgY2VsbFByb3BlcnRpZXMgPSBwcml2LmNlbGxTZXR0aW5nc1tyb3ddW2NvbF07XG4gICAgY2VsbFByb3BlcnRpZXMucm93ID0gcm93O1xuICAgIGNlbGxQcm9wZXJ0aWVzLmNvbCA9IGNvbDtcbiAgICBjZWxsUHJvcGVydGllcy52aXN1YWxSb3cgPSB2aXN1YWxSb3c7XG4gICAgY2VsbFByb3BlcnRpZXMudmlzdWFsQ29sID0gdmlzdWFsQ29sO1xuICAgIGNlbGxQcm9wZXJ0aWVzLnByb3AgPSBwcm9wO1xuICAgIGNlbGxQcm9wZXJ0aWVzLmluc3RhbmNlID0gaW5zdGFuY2U7XG4gICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2JlZm9yZUdldENlbGxNZXRhJywgcm93LCBjb2wsIGNlbGxQcm9wZXJ0aWVzKTtcbiAgICBleHRlbmQoY2VsbFByb3BlcnRpZXMsIGV4cGFuZFR5cGUoY2VsbFByb3BlcnRpZXMpKTtcbiAgICBpZiAoY2VsbFByb3BlcnRpZXMuY2VsbHMpIHtcbiAgICAgIHZhciBzZXR0aW5ncyA9IGNlbGxQcm9wZXJ0aWVzLmNlbGxzLmNhbGwoY2VsbFByb3BlcnRpZXMsIHJvdywgY29sLCBwcm9wKTtcbiAgICAgIGlmIChzZXR0aW5ncykge1xuICAgICAgICBleHRlbmQoY2VsbFByb3BlcnRpZXMsIHNldHRpbmdzKTtcbiAgICAgICAgZXh0ZW5kKGNlbGxQcm9wZXJ0aWVzLCBleHBhbmRUeXBlKHNldHRpbmdzKSk7XG4gICAgICB9XG4gICAgfVxuICAgIEhhbmRzb250YWJsZS5ob29rcy5ydW4oaW5zdGFuY2UsICdhZnRlckdldENlbGxNZXRhJywgcm93LCBjb2wsIGNlbGxQcm9wZXJ0aWVzKTtcbiAgICByZXR1cm4gY2VsbFByb3BlcnRpZXM7XG4gIH07XG4gIHRoaXMuZ2V0Q2VsbE1ldGFBdFJvdyA9IGZ1bmN0aW9uKHJvdykge1xuICAgIHJldHVybiBwcml2LmNlbGxTZXR0aW5nc1tyb3ddO1xuICB9O1xuICB0aGlzLmlzQ29sdW1uTW9kaWZpY2F0aW9uQWxsb3dlZCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAhKGluc3RhbmNlLmRhdGFUeXBlID09PSAnb2JqZWN0JyB8fCBpbnN0YW5jZS5nZXRTZXR0aW5ncygpLmNvbHVtbnMpO1xuICB9O1xuICB2YXIgcmVuZGVyZXJMb29rdXAgPSBjZWxsTWV0aG9kTG9va3VwRmFjdG9yeSgncmVuZGVyZXInKTtcbiAgdGhpcy5nZXRDZWxsUmVuZGVyZXIgPSBmdW5jdGlvbihyb3csIGNvbCkge1xuICAgIHZhciByZW5kZXJlciA9IHJlbmRlcmVyTG9va3VwLmNhbGwodGhpcywgcm93LCBjb2wpO1xuICAgIHJldHVybiBnZXRSZW5kZXJlcihyZW5kZXJlcik7XG4gIH07XG4gIHRoaXMuZ2V0Q2VsbEVkaXRvciA9IGNlbGxNZXRob2RMb29rdXBGYWN0b3J5KCdlZGl0b3InKTtcbiAgdGhpcy5nZXRDZWxsVmFsaWRhdG9yID0gY2VsbE1ldGhvZExvb2t1cEZhY3RvcnkoJ3ZhbGlkYXRvcicpO1xuICB0aGlzLnZhbGlkYXRlQ2VsbHMgPSBmdW5jdGlvbihjYWxsYmFjaykge1xuICAgIHZhciB3YWl0aW5nRm9yVmFsaWRhdG9yID0gbmV3IFZhbGlkYXRvcnNRdWV1ZSgpO1xuICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgd2FpdGluZ0ZvclZhbGlkYXRvci5vblF1ZXVlRW1wdHkgPSBjYWxsYmFjaztcbiAgICB9XG4gICAgdmFyIGkgPSBpbnN0YW5jZS5jb3VudFJvd3MoKSAtIDE7XG4gICAgd2hpbGUgKGkgPj0gMCkge1xuICAgICAgdmFyIGogPSBpbnN0YW5jZS5jb3VudENvbHMoKSAtIDE7XG4gICAgICB3aGlsZSAoaiA+PSAwKSB7XG4gICAgICAgIHdhaXRpbmdGb3JWYWxpZGF0b3IuYWRkVmFsaWRhdG9yVG9RdWV1ZSgpO1xuICAgICAgICBpbnN0YW5jZS52YWxpZGF0ZUNlbGwoaW5zdGFuY2UuZ2V0RGF0YUF0Q2VsbChpLCBqKSwgaW5zdGFuY2UuZ2V0Q2VsbE1ldGEoaSwgaiksIGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgIGlmICh0eXBlb2YgcmVzdWx0ICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVmFsaWRhdGlvbiBlcnJvcjogcmVzdWx0IGlzIG5vdCBib29sZWFuJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICB3YWl0aW5nRm9yVmFsaWRhdG9yLnZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICAgIHdhaXRpbmdGb3JWYWxpZGF0b3IucmVtb3ZlVmFsaWRhdG9yRm9ybVF1ZXVlKCk7XG4gICAgICAgIH0sICd2YWxpZGF0ZUNlbGxzJyk7XG4gICAgICAgIGotLTtcbiAgICAgIH1cbiAgICAgIGktLTtcbiAgICB9XG4gICAgd2FpdGluZ0ZvclZhbGlkYXRvci5jaGVja0lmUXVldWVJc0VtcHR5KCk7XG4gIH07XG4gIHRoaXMuZ2V0Um93SGVhZGVyID0gZnVuY3Rpb24ocm93KSB7XG4gICAgdmFyIHJvd0hlYWRlciA9IHByaXYuc2V0dGluZ3Mucm93SGVhZGVycztcbiAgICBpZiAocm93ICE9PSB2b2lkIDApIHtcbiAgICAgIHJvdyA9IEhhbmRzb250YWJsZS5ob29rcy5ydW4oaW5zdGFuY2UsICdtb2RpZnlSb3dIZWFkZXInLCByb3cpO1xuICAgIH1cbiAgICBpZiAocm93ID09PSB2b2lkIDApIHtcbiAgICAgIHJvd0hlYWRlciA9IFtdO1xuICAgICAgcmFuZ2VFYWNoKGluc3RhbmNlLmNvdW50Um93cygpIC0gMSwgKGZ1bmN0aW9uKGkpIHtcbiAgICAgICAgcm93SGVhZGVyLnB1c2goaW5zdGFuY2UuZ2V0Um93SGVhZGVyKGkpKTtcbiAgICAgIH0pKTtcbiAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkocm93SGVhZGVyKSAmJiByb3dIZWFkZXJbcm93XSAhPT0gdm9pZCAwKSB7XG4gICAgICByb3dIZWFkZXIgPSByb3dIZWFkZXJbcm93XTtcbiAgICB9IGVsc2UgaWYgKGlzRnVuY3Rpb24ocm93SGVhZGVyKSkge1xuICAgICAgcm93SGVhZGVyID0gcm93SGVhZGVyKHJvdyk7XG4gICAgfSBlbHNlIGlmIChyb3dIZWFkZXIgJiYgdHlwZW9mIHJvd0hlYWRlciAhPT0gJ3N0cmluZycgJiYgdHlwZW9mIHJvd0hlYWRlciAhPT0gJ251bWJlcicpIHtcbiAgICAgIHJvd0hlYWRlciA9IHJvdyArIDE7XG4gICAgfVxuICAgIHJldHVybiByb3dIZWFkZXI7XG4gIH07XG4gIHRoaXMuaGFzUm93SGVhZGVycyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAhIXByaXYuc2V0dGluZ3Mucm93SGVhZGVycztcbiAgfTtcbiAgdGhpcy5oYXNDb2xIZWFkZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHByaXYuc2V0dGluZ3MuY29sSGVhZGVycyAhPT0gdm9pZCAwICYmIHByaXYuc2V0dGluZ3MuY29sSGVhZGVycyAhPT0gbnVsbCkge1xuICAgICAgcmV0dXJuICEhcHJpdi5zZXR0aW5ncy5jb2xIZWFkZXJzO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMCxcbiAgICAgICAgaWxlbiA9IGluc3RhbmNlLmNvdW50Q29scygpOyBpIDwgaWxlbjsgaSsrKSB7XG4gICAgICBpZiAoaW5zdGFuY2UuZ2V0Q29sSGVhZGVyKGkpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG4gIHRoaXMuZ2V0Q29sSGVhZGVyID0gZnVuY3Rpb24oY29sKSB7XG4gICAgdmFyIGNvbHVtbnNBc0Z1bmMgPSBwcml2LnNldHRpbmdzLmNvbHVtbnMgJiYgaXNGdW5jdGlvbihwcml2LnNldHRpbmdzLmNvbHVtbnMpO1xuICAgIHZhciByZXN1bHQgPSBwcml2LnNldHRpbmdzLmNvbEhlYWRlcnM7XG4gICAgY29sID0gSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ21vZGlmeUNvbEhlYWRlcicsIGNvbCk7XG4gICAgaWYgKGNvbCA9PT0gdm9pZCAwKSB7XG4gICAgICB2YXIgb3V0ID0gW107XG4gICAgICB2YXIgaWxlbiA9IGNvbHVtbnNBc0Z1bmMgPyBpbnN0YW5jZS5jb3VudFNvdXJjZUNvbHMoKSA6IGluc3RhbmNlLmNvdW50Q29scygpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbGVuOyBpKyspIHtcbiAgICAgICAgb3V0LnB1c2goaW5zdGFuY2UuZ2V0Q29sSGVhZGVyKGkpKTtcbiAgICAgIH1cbiAgICAgIHJlc3VsdCA9IG91dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIHRyYW5zbGF0ZVZpc3VhbEluZGV4VG9Db2x1bW5zID0gZnVuY3Rpb24oY29sKSB7XG4gICAgICAgIHZhciBhcnIgPSBbXTtcbiAgICAgICAgdmFyIGNvbHVtbnNMZW4gPSBpbnN0YW5jZS5jb3VudFNvdXJjZUNvbHMoKTtcbiAgICAgICAgdmFyIGluZGV4ID0gMDtcbiAgICAgICAgZm9yICg7IGluZGV4IDwgY29sdW1uc0xlbjsgaW5kZXgrKykge1xuICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKGluc3RhbmNlLmdldFNldHRpbmdzKCkuY29sdW1ucykgJiYgaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5jb2x1bW5zKGluZGV4KSkge1xuICAgICAgICAgICAgYXJyLnB1c2goaW5kZXgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJyW2NvbF07XG4gICAgICB9O1xuICAgICAgdmFyIGJhc2VDb2wgPSBjb2w7XG4gICAgICBjb2wgPSBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnbW9kaWZ5Q29sJywgY29sKTtcbiAgICAgIHZhciBwcm9wID0gdHJhbnNsYXRlVmlzdWFsSW5kZXhUb0NvbHVtbnMoY29sKTtcbiAgICAgIGlmIChwcml2LnNldHRpbmdzLmNvbHVtbnMgJiYgaXNGdW5jdGlvbihwcml2LnNldHRpbmdzLmNvbHVtbnMpICYmIHByaXYuc2V0dGluZ3MuY29sdW1ucyhwcm9wKSAmJiBwcml2LnNldHRpbmdzLmNvbHVtbnMocHJvcCkudGl0bGUpIHtcbiAgICAgICAgcmVzdWx0ID0gcHJpdi5zZXR0aW5ncy5jb2x1bW5zKHByb3ApLnRpdGxlO1xuICAgICAgfSBlbHNlIGlmIChwcml2LnNldHRpbmdzLmNvbHVtbnMgJiYgcHJpdi5zZXR0aW5ncy5jb2x1bW5zW2NvbF0gJiYgcHJpdi5zZXR0aW5ncy5jb2x1bW5zW2NvbF0udGl0bGUpIHtcbiAgICAgICAgcmVzdWx0ID0gcHJpdi5zZXR0aW5ncy5jb2x1bW5zW2NvbF0udGl0bGU7XG4gICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkocHJpdi5zZXR0aW5ncy5jb2xIZWFkZXJzKSAmJiBwcml2LnNldHRpbmdzLmNvbEhlYWRlcnNbY29sXSAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHJlc3VsdCA9IHByaXYuc2V0dGluZ3MuY29sSGVhZGVyc1tjb2xdO1xuICAgICAgfSBlbHNlIGlmIChpc0Z1bmN0aW9uKHByaXYuc2V0dGluZ3MuY29sSGVhZGVycykpIHtcbiAgICAgICAgcmVzdWx0ID0gcHJpdi5zZXR0aW5ncy5jb2xIZWFkZXJzKGNvbCk7XG4gICAgICB9IGVsc2UgaWYgKHByaXYuc2V0dGluZ3MuY29sSGVhZGVycyAmJiB0eXBlb2YgcHJpdi5zZXR0aW5ncy5jb2xIZWFkZXJzICE9PSAnc3RyaW5nJyAmJiB0eXBlb2YgcHJpdi5zZXR0aW5ncy5jb2xIZWFkZXJzICE9PSAnbnVtYmVyJykge1xuICAgICAgICByZXN1bHQgPSBzcHJlYWRzaGVldENvbHVtbkxhYmVsKGJhc2VDb2wpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuICB0aGlzLl9nZXRDb2xXaWR0aEZyb21TZXR0aW5ncyA9IGZ1bmN0aW9uKGNvbCkge1xuICAgIHZhciBjZWxsUHJvcGVydGllcyA9IGluc3RhbmNlLmdldENlbGxNZXRhKDAsIGNvbCk7XG4gICAgdmFyIHdpZHRoID0gY2VsbFByb3BlcnRpZXMud2lkdGg7XG4gICAgaWYgKHdpZHRoID09PSB2b2lkIDAgfHwgd2lkdGggPT09IHByaXYuc2V0dGluZ3Mud2lkdGgpIHtcbiAgICAgIHdpZHRoID0gY2VsbFByb3BlcnRpZXMuY29sV2lkdGhzO1xuICAgIH1cbiAgICBpZiAod2lkdGggIT09IHZvaWQgMCAmJiB3aWR0aCAhPT0gbnVsbCkge1xuICAgICAgc3dpdGNoICh0eXBlb2Ygd2lkdGgpIHtcbiAgICAgICAgY2FzZSAnb2JqZWN0JzpcbiAgICAgICAgICB3aWR0aCA9IHdpZHRoW2NvbF07XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2Z1bmN0aW9uJzpcbiAgICAgICAgICB3aWR0aCA9IHdpZHRoKGNvbCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHdpZHRoID09PSAnc3RyaW5nJykge1xuICAgICAgICB3aWR0aCA9IHBhcnNlSW50KHdpZHRoLCAxMCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB3aWR0aDtcbiAgfTtcbiAgdGhpcy5nZXRDb2xXaWR0aCA9IGZ1bmN0aW9uKGNvbCkge1xuICAgIHZhciB3aWR0aCA9IGluc3RhbmNlLl9nZXRDb2xXaWR0aEZyb21TZXR0aW5ncyhjb2wpO1xuICAgIHdpZHRoID0gSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ21vZGlmeUNvbFdpZHRoJywgd2lkdGgsIGNvbCk7XG4gICAgaWYgKHdpZHRoID09PSB2b2lkIDApIHtcbiAgICAgIHdpZHRoID0gV2Fsa29udGFibGVWaWV3cG9ydENvbHVtbnNDYWxjdWxhdG9yLkRFRkFVTFRfV0lEVEg7XG4gICAgfVxuICAgIHJldHVybiB3aWR0aDtcbiAgfTtcbiAgdGhpcy5fZ2V0Um93SGVpZ2h0RnJvbVNldHRpbmdzID0gZnVuY3Rpb24ocm93KSB7XG4gICAgdmFyIGhlaWdodCA9IHByaXYuc2V0dGluZ3Mucm93SGVpZ2h0cztcbiAgICBpZiAoaGVpZ2h0ICE9PSB2b2lkIDAgJiYgaGVpZ2h0ICE9PSBudWxsKSB7XG4gICAgICBzd2l0Y2ggKHR5cGVvZiBoZWlnaHQpIHtcbiAgICAgICAgY2FzZSAnb2JqZWN0JzpcbiAgICAgICAgICBoZWlnaHQgPSBoZWlnaHRbcm93XTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZnVuY3Rpb24nOlxuICAgICAgICAgIGhlaWdodCA9IGhlaWdodChyb3cpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiBoZWlnaHQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGhlaWdodCA9IHBhcnNlSW50KGhlaWdodCwgMTApO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaGVpZ2h0O1xuICB9O1xuICB0aGlzLmdldFJvd0hlaWdodCA9IGZ1bmN0aW9uKHJvdykge1xuICAgIHZhciBoZWlnaHQgPSBpbnN0YW5jZS5fZ2V0Um93SGVpZ2h0RnJvbVNldHRpbmdzKHJvdyk7XG4gICAgaGVpZ2h0ID0gSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ21vZGlmeVJvd0hlaWdodCcsIGhlaWdodCwgcm93KTtcbiAgICByZXR1cm4gaGVpZ2h0O1xuICB9O1xuICB0aGlzLmNvdW50U291cmNlUm93cyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzb3VyY2VMZW5ndGggPSBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnbW9kaWZ5U291cmNlTGVuZ3RoJyk7XG4gICAgcmV0dXJuIHNvdXJjZUxlbmd0aCB8fCAoaW5zdGFuY2UuZ2V0U291cmNlRGF0YSgpID8gaW5zdGFuY2UuZ2V0U291cmNlRGF0YSgpLmxlbmd0aCA6IDApO1xuICB9O1xuICB0aGlzLmNvdW50U291cmNlQ29scyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBsZW4gPSAwO1xuICAgIHZhciBvYmogPSBpbnN0YW5jZS5nZXRTb3VyY2VEYXRhKCkgJiYgaW5zdGFuY2UuZ2V0U291cmNlRGF0YSgpWzBdID8gaW5zdGFuY2UuZ2V0U291cmNlRGF0YSgpWzBdIDogW107XG4gICAgaWYgKGlzT2JqZWN0KG9iaikpIHtcbiAgICAgIGxlbiA9IGRlZXBPYmplY3RTaXplKG9iaik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxlbiA9IG9iai5sZW5ndGggfHwgMDtcbiAgICB9XG4gICAgcmV0dXJuIGxlbjtcbiAgfTtcbiAgdGhpcy5jb3VudFJvd3MgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZGF0YW1hcC5nZXRMZW5ndGgoKTtcbiAgfTtcbiAgdGhpcy5jb3VudENvbHMgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgZGF0YUhhc0xlbmd0aCA9IGZhbHNlO1xuICAgIHZhciBkYXRhTGVuID0gMDtcbiAgICBpZiAoaW5zdGFuY2UuZGF0YVR5cGUgPT09ICdhcnJheScpIHtcbiAgICAgIGRhdGFIYXNMZW5ndGggPSBwcml2LnNldHRpbmdzLmRhdGEgJiYgcHJpdi5zZXR0aW5ncy5kYXRhWzBdICYmIHByaXYuc2V0dGluZ3MuZGF0YVswXS5sZW5ndGg7XG4gICAgfVxuICAgIGlmIChkYXRhSGFzTGVuZ3RoKSB7XG4gICAgICBkYXRhTGVuID0gcHJpdi5zZXR0aW5ncy5kYXRhWzBdLmxlbmd0aDtcbiAgICB9XG4gICAgaWYgKHByaXYuc2V0dGluZ3MuY29sdW1ucykge1xuICAgICAgdmFyIGNvbHVtbnNJc0Z1bmN0aW9uID0gaXNGdW5jdGlvbihwcml2LnNldHRpbmdzLmNvbHVtbnMpO1xuICAgICAgaWYgKGNvbHVtbnNJc0Z1bmN0aW9uKSB7XG4gICAgICAgIGlmIChpbnN0YW5jZS5kYXRhVHlwZSA9PT0gJ2FycmF5Jykge1xuICAgICAgICAgIHZhciBjb2x1bW5MZW4gPSAwO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YUxlbjsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocHJpdi5zZXR0aW5ncy5jb2x1bW5zKGkpKSB7XG4gICAgICAgICAgICAgIGNvbHVtbkxlbisrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBkYXRhTGVuID0gY29sdW1uTGVuO1xuICAgICAgICB9IGVsc2UgaWYgKGluc3RhbmNlLmRhdGFUeXBlID09PSAnb2JqZWN0JyB8fCBpbnN0YW5jZS5kYXRhVHlwZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIGRhdGFMZW4gPSBkYXRhbWFwLmNvbFRvUHJvcENhY2hlLmxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGF0YUxlbiA9IHByaXYuc2V0dGluZ3MuY29sdW1ucy5sZW5ndGg7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChpbnN0YW5jZS5kYXRhVHlwZSA9PT0gJ29iamVjdCcgfHwgaW5zdGFuY2UuZGF0YVR5cGUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgZGF0YUxlbiA9IGRhdGFtYXAuY29sVG9Qcm9wQ2FjaGUubGVuZ3RoO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZGF0YUxlbjtcbiAgfTtcbiAgdGhpcy5yb3dPZmZzZXQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gaW5zdGFuY2Uudmlldy53dC53dFRhYmxlLmdldEZpcnN0UmVuZGVyZWRSb3coKTtcbiAgfTtcbiAgdGhpcy5jb2xPZmZzZXQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gaW5zdGFuY2Uudmlldy53dC53dFRhYmxlLmdldEZpcnN0UmVuZGVyZWRDb2x1bW4oKTtcbiAgfTtcbiAgdGhpcy5jb3VudFJlbmRlcmVkUm93cyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBpbnN0YW5jZS52aWV3Lnd0LmRyYXduID8gaW5zdGFuY2Uudmlldy53dC53dFRhYmxlLmdldFJlbmRlcmVkUm93c0NvdW50KCkgOiAtMTtcbiAgfTtcbiAgdGhpcy5jb3VudFZpc2libGVSb3dzID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGluc3RhbmNlLnZpZXcud3QuZHJhd24gPyBpbnN0YW5jZS52aWV3Lnd0Lnd0VGFibGUuZ2V0VmlzaWJsZVJvd3NDb3VudCgpIDogLTE7XG4gIH07XG4gIHRoaXMuY291bnRSZW5kZXJlZENvbHMgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gaW5zdGFuY2Uudmlldy53dC5kcmF3biA/IGluc3RhbmNlLnZpZXcud3Qud3RUYWJsZS5nZXRSZW5kZXJlZENvbHVtbnNDb3VudCgpIDogLTE7XG4gIH07XG4gIHRoaXMuY291bnRWaXNpYmxlQ29scyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBpbnN0YW5jZS52aWV3Lnd0LmRyYXduID8gaW5zdGFuY2Uudmlldy53dC53dFRhYmxlLmdldFZpc2libGVDb2x1bW5zQ291bnQoKSA6IC0xO1xuICB9O1xuICB0aGlzLmNvdW50RW1wdHlSb3dzID0gZnVuY3Rpb24oZW5kaW5nKSB7XG4gICAgdmFyIGkgPSBpbnN0YW5jZS5jb3VudFJvd3MoKSAtIDEsXG4gICAgICAgIGVtcHR5ID0gMCxcbiAgICAgICAgcm93O1xuICAgIHdoaWxlIChpID49IDApIHtcbiAgICAgIHJvdyA9IEhhbmRzb250YWJsZS5ob29rcy5ydW4odGhpcywgJ21vZGlmeVJvdycsIGkpO1xuICAgICAgaWYgKGluc3RhbmNlLmlzRW1wdHlSb3cocm93KSkge1xuICAgICAgICBlbXB0eSsrO1xuICAgICAgfSBlbHNlIGlmIChlbmRpbmcpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBpLS07XG4gICAgfVxuICAgIHJldHVybiBlbXB0eTtcbiAgfTtcbiAgdGhpcy5jb3VudEVtcHR5Q29scyA9IGZ1bmN0aW9uKGVuZGluZykge1xuICAgIGlmIChpbnN0YW5jZS5jb3VudFJvd3MoKSA8IDEpIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICB2YXIgaSA9IGluc3RhbmNlLmNvdW50Q29scygpIC0gMSxcbiAgICAgICAgZW1wdHkgPSAwO1xuICAgIHdoaWxlIChpID49IDApIHtcbiAgICAgIGlmIChpbnN0YW5jZS5pc0VtcHR5Q29sKGkpKSB7XG4gICAgICAgIGVtcHR5Kys7XG4gICAgICB9IGVsc2UgaWYgKGVuZGluZykge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGktLTtcbiAgICB9XG4gICAgcmV0dXJuIGVtcHR5O1xuICB9O1xuICB0aGlzLmlzRW1wdHlSb3cgPSBmdW5jdGlvbihyb3cpIHtcbiAgICByZXR1cm4gcHJpdi5zZXR0aW5ncy5pc0VtcHR5Um93LmNhbGwoaW5zdGFuY2UsIHJvdyk7XG4gIH07XG4gIHRoaXMuaXNFbXB0eUNvbCA9IGZ1bmN0aW9uKGNvbCkge1xuICAgIHJldHVybiBwcml2LnNldHRpbmdzLmlzRW1wdHlDb2wuY2FsbChpbnN0YW5jZSwgY29sKTtcbiAgfTtcbiAgdGhpcy5zZWxlY3RDZWxsID0gZnVuY3Rpb24ocm93LCBjb2wsIGVuZFJvdywgZW5kQ29sLCBzY3JvbGxUb0NlbGwsIGNoYW5nZUxpc3RlbmVyKSB7XG4gICAgdmFyIGNvb3JkcztcbiAgICBjaGFuZ2VMaXN0ZW5lciA9IGlzVW5kZWZpbmVkKGNoYW5nZUxpc3RlbmVyKSB8fCBjaGFuZ2VMaXN0ZW5lciA9PT0gdHJ1ZTtcbiAgICBpZiAodHlwZW9mIHJvdyAhPT0gJ251bWJlcicgfHwgcm93IDwgMCB8fCByb3cgPj0gaW5zdGFuY2UuY291bnRSb3dzKCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBjb2wgIT09ICdudW1iZXInIHx8IGNvbCA8IDAgfHwgY29sID49IGluc3RhbmNlLmNvdW50Q29scygpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChpc0RlZmluZWQoZW5kUm93KSkge1xuICAgICAgaWYgKHR5cGVvZiBlbmRSb3cgIT09ICdudW1iZXInIHx8IGVuZFJvdyA8IDAgfHwgZW5kUm93ID49IGluc3RhbmNlLmNvdW50Um93cygpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgZW5kQ29sICE9PSAnbnVtYmVyJyB8fCBlbmRDb2wgPCAwIHx8IGVuZENvbCA+PSBpbnN0YW5jZS5jb3VudENvbHMoKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIGNvb3JkcyA9IG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMocm93LCBjb2wpO1xuICAgIHByaXYuc2VsUmFuZ2UgPSBuZXcgV2Fsa29udGFibGVDZWxsUmFuZ2UoY29vcmRzLCBjb29yZHMsIGNvb3Jkcyk7XG4gICAgaWYgKGNoYW5nZUxpc3RlbmVyKSB7XG4gICAgICBpbnN0YW5jZS5saXN0ZW4oKTtcbiAgICB9XG4gICAgaWYgKGlzVW5kZWZpbmVkKGVuZFJvdykpIHtcbiAgICAgIHNlbGVjdGlvbi5zZXRSYW5nZUVuZChwcml2LnNlbFJhbmdlLmZyb20sIHNjcm9sbFRvQ2VsbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNlbGVjdGlvbi5zZXRSYW5nZUVuZChuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKGVuZFJvdywgZW5kQ29sKSwgc2Nyb2xsVG9DZWxsKTtcbiAgICB9XG4gICAgaW5zdGFuY2Uuc2VsZWN0aW9uLmZpbmlzaCgpO1xuICAgIHJldHVybiB0cnVlO1xuICB9O1xuICB0aGlzLnNlbGVjdENlbGxCeVByb3AgPSBmdW5jdGlvbihyb3csIHByb3AsIGVuZFJvdywgZW5kUHJvcCwgc2Nyb2xsVG9DZWxsKSB7XG4gICAgYXJndW1lbnRzWzFdID0gZGF0YW1hcC5wcm9wVG9Db2woYXJndW1lbnRzWzFdKTtcbiAgICBpZiAoaXNEZWZpbmVkKGFyZ3VtZW50c1szXSkpIHtcbiAgICAgIGFyZ3VtZW50c1szXSA9IGRhdGFtYXAucHJvcFRvQ29sKGFyZ3VtZW50c1szXSk7XG4gICAgfVxuICAgIHJldHVybiBpbnN0YW5jZS5zZWxlY3RDZWxsLmFwcGx5KGluc3RhbmNlLCBhcmd1bWVudHMpO1xuICB9O1xuICB0aGlzLmRlc2VsZWN0Q2VsbCA9IGZ1bmN0aW9uKCkge1xuICAgIHNlbGVjdGlvbi5kZXNlbGVjdCgpO1xuICB9O1xuICB0aGlzLnNjcm9sbFZpZXdwb3J0VG8gPSBmdW5jdGlvbihyb3csIGNvbHVtbikge1xuICAgIHZhciBzbmFwVG9Cb3R0b20gPSBhcmd1bWVudHNbMl0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzJdIDogZmFsc2U7XG4gICAgdmFyIHNuYXBUb1JpZ2h0ID0gYXJndW1lbnRzWzNdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1szXSA6IGZhbHNlO1xuICAgIGlmIChyb3cgIT09IHZvaWQgMCAmJiAocm93IDwgMCB8fCByb3cgPj0gaW5zdGFuY2UuY291bnRSb3dzKCkpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChjb2x1bW4gIT09IHZvaWQgMCAmJiAoY29sdW1uIDwgMCB8fCBjb2x1bW4gPj0gaW5zdGFuY2UuY291bnRDb2xzKCkpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciByZXN1bHQgPSBmYWxzZTtcbiAgICBpZiAocm93ICE9PSB2b2lkIDAgJiYgY29sdW1uICE9PSB2b2lkIDApIHtcbiAgICAgIGluc3RhbmNlLnZpZXcud3Qud3RPdmVybGF5cy50b3BPdmVybGF5LnNjcm9sbFRvKHJvdywgc25hcFRvQm90dG9tKTtcbiAgICAgIGluc3RhbmNlLnZpZXcud3Qud3RPdmVybGF5cy5sZWZ0T3ZlcmxheS5zY3JvbGxUbyhjb2x1bW4sIHNuYXBUb1JpZ2h0KTtcbiAgICAgIHJlc3VsdCA9IHRydWU7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygcm93ID09PSAnbnVtYmVyJyAmJiB0eXBlb2YgY29sdW1uICE9PSAnbnVtYmVyJykge1xuICAgICAgaW5zdGFuY2Uudmlldy53dC53dE92ZXJsYXlzLnRvcE92ZXJsYXkuc2Nyb2xsVG8ocm93LCBzbmFwVG9Cb3R0b20pO1xuICAgICAgcmVzdWx0ID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBjb2x1bW4gPT09ICdudW1iZXInICYmIHR5cGVvZiByb3cgIT09ICdudW1iZXInKSB7XG4gICAgICBpbnN0YW5jZS52aWV3Lnd0Lnd0T3ZlcmxheXMubGVmdE92ZXJsYXkuc2Nyb2xsVG8oY29sdW1uLCBzbmFwVG9SaWdodCk7XG4gICAgICByZXN1bHQgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuICB0aGlzLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICBpbnN0YW5jZS5fY2xlYXJUaW1lb3V0cygpO1xuICAgIGlmIChpbnN0YW5jZS52aWV3KSB7XG4gICAgICBpbnN0YW5jZS52aWV3LmRlc3Ryb3koKTtcbiAgICB9XG4gICAgaWYgKGRhdGFTb3VyY2UpIHtcbiAgICAgIGRhdGFTb3VyY2UuZGVzdHJveSgpO1xuICAgIH1cbiAgICBkYXRhU291cmNlID0gbnVsbDtcbiAgICBlbXB0eShpbnN0YW5jZS5yb290RWxlbWVudCk7XG4gICAgZXZlbnRNYW5hZ2VyLmRlc3Ryb3koKTtcbiAgICBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnYWZ0ZXJEZXN0cm95Jyk7XG4gICAgSGFuZHNvbnRhYmxlLmhvb2tzLmRlc3Ryb3koaW5zdGFuY2UpO1xuICAgIGZvciAodmFyIGkgaW4gaW5zdGFuY2UpIHtcbiAgICAgIGlmIChpbnN0YW5jZS5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICBpZiAoaXNGdW5jdGlvbihpbnN0YW5jZVtpXSkpIHtcbiAgICAgICAgICBpbnN0YW5jZVtpXSA9IHBvc3RNb3J0ZW07XG4gICAgICAgIH0gZWxzZSBpZiAoaSAhPT0gJ2d1aWQnKSB7XG4gICAgICAgICAgaW5zdGFuY2VbaV0gPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChkYXRhbWFwKSB7XG4gICAgICBkYXRhbWFwLmRlc3Ryb3koKTtcbiAgICB9XG4gICAgZGF0YW1hcCA9IG51bGw7XG4gICAgcHJpdiA9IG51bGw7XG4gICAgZ3JpZCA9IG51bGw7XG4gICAgc2VsZWN0aW9uID0gbnVsbDtcbiAgICBlZGl0b3JNYW5hZ2VyID0gbnVsbDtcbiAgICBpbnN0YW5jZSA9IG51bGw7XG4gICAgR3JpZFNldHRpbmdzID0gbnVsbDtcbiAgfTtcbiAgZnVuY3Rpb24gcG9zdE1vcnRlbSgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoaXMgbWV0aG9kIGNhbm5vdCBiZSBjYWxsZWQgYmVjYXVzZSB0aGlzIEhhbmRzb250YWJsZSBpbnN0YW5jZSBoYXMgYmVlbiBkZXN0cm95ZWQnKTtcbiAgfVxuICB0aGlzLmdldEFjdGl2ZUVkaXRvciA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBlZGl0b3JNYW5hZ2VyLmdldEFjdGl2ZUVkaXRvcigpO1xuICB9O1xuICB0aGlzLmdldFBsdWdpbiA9IGZ1bmN0aW9uKHBsdWdpbk5hbWUpIHtcbiAgICByZXR1cm4gZ2V0UGx1Z2luKHRoaXMsIHBsdWdpbk5hbWUpO1xuICB9O1xuICB0aGlzLmdldEluc3RhbmNlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGluc3RhbmNlO1xuICB9O1xuICB0aGlzLmFkZEhvb2sgPSBmdW5jdGlvbihrZXksIGNhbGxiYWNrKSB7XG4gICAgSGFuZHNvbnRhYmxlLmhvb2tzLmFkZChrZXksIGNhbGxiYWNrLCBpbnN0YW5jZSk7XG4gIH07XG4gIHRoaXMuaGFzSG9vayA9IGZ1bmN0aW9uKGtleSkge1xuICAgIHJldHVybiBIYW5kc29udGFibGUuaG9va3MuaGFzKGtleSwgaW5zdGFuY2UpO1xuICB9O1xuICB0aGlzLmFkZEhvb2tPbmNlID0gZnVuY3Rpb24oa2V5LCBjYWxsYmFjaykge1xuICAgIEhhbmRzb250YWJsZS5ob29rcy5vbmNlKGtleSwgY2FsbGJhY2ssIGluc3RhbmNlKTtcbiAgfTtcbiAgdGhpcy5yZW1vdmVIb29rID0gZnVuY3Rpb24oa2V5LCBjYWxsYmFjaykge1xuICAgIEhhbmRzb250YWJsZS5ob29rcy5yZW1vdmUoa2V5LCBjYWxsYmFjaywgaW5zdGFuY2UpO1xuICB9O1xuICB0aGlzLnJ1bkhvb2tzID0gZnVuY3Rpb24oa2V5LCBwMSwgcDIsIHAzLCBwNCwgcDUsIHA2KSB7XG4gICAgcmV0dXJuIEhhbmRzb250YWJsZS5ob29rcy5ydW4oaW5zdGFuY2UsIGtleSwgcDEsIHAyLCBwMywgcDQsIHA1LCBwNik7XG4gIH07XG4gIHRoaXMudGltZW91dHMgPSBbXTtcbiAgdGhpcy5fcmVnaXN0ZXJUaW1lb3V0ID0gZnVuY3Rpb24oaGFuZGxlKSB7XG4gICAgdGhpcy50aW1lb3V0cy5wdXNoKGhhbmRsZSk7XG4gIH07XG4gIHRoaXMuX2NsZWFyVGltZW91dHMgPSBmdW5jdGlvbigpIHtcbiAgICBmb3IgKHZhciBpID0gMCxcbiAgICAgICAgaWxlbiA9IHRoaXMudGltZW91dHMubGVuZ3RoOyBpIDwgaWxlbjsgaSsrKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0c1tpXSk7XG4gICAgfVxuICB9O1xuICB0aGlzLnZlcnNpb24gPSBIYW5kc29udGFibGUudmVyc2lvbjtcbiAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2NvbnN0cnVjdCcpO1xufTtcbnZhciBEZWZhdWx0U2V0dGluZ3MgPSBmdW5jdGlvbigpIHt9O1xuRGVmYXVsdFNldHRpbmdzLnByb3RvdHlwZSA9IHtcbiAgZGF0YTogdm9pZCAwLFxuICBkYXRhU2NoZW1hOiB2b2lkIDAsXG4gIHdpZHRoOiB2b2lkIDAsXG4gIGhlaWdodDogdm9pZCAwLFxuICBzdGFydFJvd3M6IDUsXG4gIHN0YXJ0Q29sczogNSxcbiAgcm93SGVhZGVyczogdm9pZCAwLFxuICBjb2xIZWFkZXJzOiBudWxsLFxuICBjb2xXaWR0aHM6IHZvaWQgMCxcbiAgcm93SGVpZ2h0czogdm9pZCAwLFxuICBjb2x1bW5zOiB2b2lkIDAsXG4gIGNlbGxzOiB2b2lkIDAsXG4gIGNlbGw6IFtdLFxuICBjb21tZW50czogZmFsc2UsXG4gIGN1c3RvbUJvcmRlcnM6IGZhbHNlLFxuICBtaW5Sb3dzOiAwLFxuICBtaW5Db2xzOiAwLFxuICBtYXhSb3dzOiBJbmZpbml0eSxcbiAgbWF4Q29sczogSW5maW5pdHksXG4gIG1pblNwYXJlUm93czogMCxcbiAgbWluU3BhcmVDb2xzOiAwLFxuICBhbGxvd0luc2VydFJvdzogdHJ1ZSxcbiAgYWxsb3dJbnNlcnRDb2x1bW46IHRydWUsXG4gIGFsbG93UmVtb3ZlUm93OiB0cnVlLFxuICBhbGxvd1JlbW92ZUNvbHVtbjogdHJ1ZSxcbiAgbXVsdGlTZWxlY3Q6IHRydWUsXG4gIGZpbGxIYW5kbGU6IHRydWUsXG4gIGZpeGVkUm93c1RvcDogMCxcbiAgZml4ZWRSb3dzQm90dG9tOiAwLFxuICBmaXhlZENvbHVtbnNMZWZ0OiAwLFxuICBvdXRzaWRlQ2xpY2tEZXNlbGVjdHM6IHRydWUsXG4gIGVudGVyQmVnaW5zRWRpdGluZzogdHJ1ZSxcbiAgZW50ZXJNb3Zlczoge1xuICAgIHJvdzogMSxcbiAgICBjb2w6IDBcbiAgfSxcbiAgdGFiTW92ZXM6IHtcbiAgICByb3c6IDAsXG4gICAgY29sOiAxXG4gIH0sXG4gIGF1dG9XcmFwUm93OiBmYWxzZSxcbiAgYXV0b1dyYXBDb2w6IGZhbHNlLFxuICBjb3B5Um93c0xpbWl0OiAxMDAwLFxuICBjb3B5Q29sc0xpbWl0OiAxMDAwLFxuICBwYXN0ZU1vZGU6ICdvdmVyd3JpdGUnLFxuICBwZXJzaXN0ZW50U3RhdGU6IHZvaWQgMCxcbiAgY3VycmVudFJvd0NsYXNzTmFtZTogdm9pZCAwLFxuICBjdXJyZW50Q29sQ2xhc3NOYW1lOiB2b2lkIDAsXG4gIGN1cnJlbnRIZWFkZXJDbGFzc05hbWU6ICdodF9faGlnaGxpZ2h0JyxcbiAgY2xhc3NOYW1lOiB2b2lkIDAsXG4gIHRhYmxlQ2xhc3NOYW1lOiB2b2lkIDAsXG4gIHN0cmV0Y2hIOiAnbm9uZScsXG4gIGlzRW1wdHlSb3c6IGZ1bmN0aW9uKHJvdykge1xuICAgIHZhciBjb2wsXG4gICAgICAgIGNvbExlbixcbiAgICAgICAgdmFsdWUsXG4gICAgICAgIG1ldGE7XG4gICAgZm9yIChjb2wgPSAwLCBjb2xMZW4gPSB0aGlzLmNvdW50Q29scygpOyBjb2wgPCBjb2xMZW47IGNvbCsrKSB7XG4gICAgICB2YWx1ZSA9IHRoaXMuZ2V0RGF0YUF0Q2VsbChyb3csIGNvbCk7XG4gICAgICBpZiAodmFsdWUgIT09ICcnICYmIHZhbHVlICE9PSBudWxsICYmIGlzRGVmaW5lZCh2YWx1ZSkpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICBtZXRhID0gdGhpcy5nZXRDZWxsTWV0YShyb3csIGNvbCk7XG4gICAgICAgICAgcmV0dXJuIGlzT2JqZWN0RXF1YWxzKHRoaXMuZ2V0U2NoZW1hKClbbWV0YS5wcm9wXSwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH0sXG4gIGlzRW1wdHlDb2w6IGZ1bmN0aW9uKGNvbCkge1xuICAgIHZhciByb3csXG4gICAgICAgIHJvd0xlbixcbiAgICAgICAgdmFsdWU7XG4gICAgZm9yIChyb3cgPSAwLCByb3dMZW4gPSB0aGlzLmNvdW50Um93cygpOyByb3cgPCByb3dMZW47IHJvdysrKSB7XG4gICAgICB2YWx1ZSA9IHRoaXMuZ2V0RGF0YUF0Q2VsbChyb3csIGNvbCk7XG4gICAgICBpZiAodmFsdWUgIT09ICcnICYmIHZhbHVlICE9PSBudWxsICYmIGlzRGVmaW5lZCh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSxcbiAgb2JzZXJ2ZURPTVZpc2liaWxpdHk6IHRydWUsXG4gIGFsbG93SW52YWxpZDogdHJ1ZSxcbiAgYWxsb3dFbXB0eTogdHJ1ZSxcbiAgaW52YWxpZENlbGxDbGFzc05hbWU6ICdodEludmFsaWQnLFxuICBwbGFjZWhvbGRlcjogZmFsc2UsXG4gIHBsYWNlaG9sZGVyQ2VsbENsYXNzTmFtZTogJ2h0UGxhY2Vob2xkZXInLFxuICByZWFkT25seUNlbGxDbGFzc05hbWU6ICdodERpbW1lZCcsXG4gIHJlbmRlcmVyOiB2b2lkIDAsXG4gIGNvbW1lbnRlZENlbGxDbGFzc05hbWU6ICdodENvbW1lbnRDZWxsJyxcbiAgZnJhZ21lbnRTZWxlY3Rpb246IGZhbHNlLFxuICByZWFkT25seTogZmFsc2UsXG4gIHNraXBDb2x1bW5PblBhc3RlOiBmYWxzZSxcbiAgc2VhcmNoOiBmYWxzZSxcbiAgdHlwZTogJ3RleHQnLFxuICBjb3B5YWJsZTogdHJ1ZSxcbiAgZWRpdG9yOiB2b2lkIDAsXG4gIGF1dG9Db21wbGV0ZTogdm9pZCAwLFxuICB2aXNpYmxlUm93czogMTAsXG4gIHRyaW1Ecm9wZG93bjogdHJ1ZSxcbiAgZGVidWc6IGZhbHNlLFxuICB3b3JkV3JhcDogdHJ1ZSxcbiAgbm9Xb3JkV3JhcENsYXNzTmFtZTogJ2h0Tm9XcmFwJyxcbiAgY29udGV4dE1lbnU6IHZvaWQgMCxcbiAgY29udGV4dE1lbnVDb3B5UGFzdGU6IHZvaWQgMCxcbiAgY29weVBhc3RlOiB2b2lkIDAsXG4gIHVuZG86IHZvaWQgMCxcbiAgY29sdW1uU29ydGluZzogdm9pZCAwLFxuICBtYW51YWxDb2x1bW5Nb3ZlOiB2b2lkIDAsXG4gIG1hbnVhbENvbHVtblJlc2l6ZTogdm9pZCAwLFxuICBtYW51YWxSb3dNb3ZlOiB2b2lkIDAsXG4gIG1hbnVhbFJvd1Jlc2l6ZTogdm9pZCAwLFxuICBtZXJnZUNlbGxzOiBmYWxzZSxcbiAgdmlld3BvcnRSb3dSZW5kZXJpbmdPZmZzZXQ6ICdhdXRvJyxcbiAgdmlld3BvcnRDb2x1bW5SZW5kZXJpbmdPZmZzZXQ6ICdhdXRvJyxcbiAgdmFsaWRhdG9yOiB2b2lkIDAsXG4gIGRpc2FibGVWaXN1YWxTZWxlY3Rpb246IGZhbHNlLFxuICBzb3J0SW5kaWNhdG9yOiB2b2lkIDAsXG4gIG1hbnVhbENvbHVtbkZyZWV6ZTogdm9pZCAwLFxuICB0cmltV2hpdGVzcGFjZTogdHJ1ZSxcbiAgc2V0dGluZ3M6IHZvaWQgMCxcbiAgc291cmNlOiB2b2lkIDAsXG4gIHRpdGxlOiB2b2lkIDAsXG4gIGNoZWNrZWRUZW1wbGF0ZTogdm9pZCAwLFxuICB1bmNoZWNrZWRUZW1wbGF0ZTogdm9pZCAwLFxuICBsYWJlbDogdm9pZCAwLFxuICBmb3JtYXQ6IHZvaWQgMCxcbiAgbGFuZ3VhZ2U6IHZvaWQgMCxcbiAgc2VsZWN0T3B0aW9uczogdm9pZCAwLFxuICBhdXRvQ29sdW1uU2l6ZTogdm9pZCAwLFxuICBhdXRvUm93U2l6ZTogdm9pZCAwLFxuICBkYXRlRm9ybWF0OiB2b2lkIDAsXG4gIGNvcnJlY3RGb3JtYXQ6IGZhbHNlLFxuICBkZWZhdWx0RGF0ZTogdm9pZCAwLFxuICBzdHJpY3Q6IHZvaWQgMCxcbiAgYWxsb3dIdG1sOiBmYWxzZSxcbiAgcmVuZGVyQWxsUm93czogdm9pZCAwLFxuICBwcmV2ZW50T3ZlcmZsb3c6IGZhbHNlLFxuICBiaW5kUm93c1dpdGhIZWFkZXJzOiB2b2lkIDAsXG4gIGNvbGxhcHNpYmxlQ29sdW1uczogdm9pZCAwLFxuICBjb2x1bW5TdW1tYXJ5OiB2b2lkIDAsXG4gIGRyb3Bkb3duTWVudTogdm9pZCAwLFxuICBmaWx0ZXJzOiB2b2lkIDAsXG4gIGZvcm11bGFzOiB2b2lkIDAsXG4gIGdhbnR0Q2hhcnQ6IHZvaWQgMCxcbiAgaGVhZGVyVG9vbHRpcHM6IHZvaWQgMCxcbiAgaGlkZGVuQ29sdW1uczogdm9pZCAwLFxuICBoaWRkZW5Sb3dzOiB2b2lkIDAsXG4gIG5lc3RlZEhlYWRlcnM6IHZvaWQgMCxcbiAgdHJpbVJvd3M6IHZvaWQgMCxcbiAgcm93SGVhZGVyV2lkdGg6IHZvaWQgMCxcbiAgY29sdW1uSGVhZGVySGVpZ2h0OiB2b2lkIDAsXG4gIG9ic2VydmVDaGFuZ2VzOiB2b2lkIDAsXG4gIHNvcnRGdW5jdGlvbjogdm9pZCAwLFxuICBzb3J0QnlSZWxldmFuY2U6IHRydWUsXG4gIGZpbHRlcjogdHJ1ZSxcbiAgZmlsdGVyaW5nQ2FzZVNlbnNpdGl2ZTogZmFsc2Vcbn07XG5IYW5kc29udGFibGUuRGVmYXVsdFNldHRpbmdzID0gRGVmYXVsdFNldHRpbmdzO1xuXG4vLyMgXG59LHtcIjNyZHBhcnR5L3dhbGtvbnRhYmxlL3NyYy9jYWxjdWxhdG9yL3ZpZXdwb3J0Q29sdW1uc1wiOjQsXCIzcmRwYXJ0eS93YWxrb250YWJsZS9zcmMvY2VsbC9jb29yZHNcIjo2LFwiM3JkcGFydHkvd2Fsa29udGFibGUvc3JjL2NlbGwvcmFuZ2VcIjo3LFwiYnJvd3NlclwiOjI0LFwiZGF0YU1hcFwiOjI3LFwiZGF0YVNvdXJjZVwiOjI4LFwiZWRpdG9yTWFuYWdlclwiOjI5LFwiZXZlbnRNYW5hZ2VyXCI6NDIsXCJoZWxwZXJzL2FycmF5XCI6NDMsXCJoZWxwZXJzL2Jyb3dzZXJcIjo0NCxcImhlbHBlcnMvZGF0YVwiOjQ1LFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwiaGVscGVycy9mdW5jdGlvblwiOjUwLFwiaGVscGVycy9taXhlZFwiOjUxLFwiaGVscGVycy9udW1iZXJcIjo1MixcImhlbHBlcnMvb2JqZWN0XCI6NTMsXCJoZWxwZXJzL3NldHRpbmdcIjo1NCxcImhlbHBlcnMvc3RyaW5nXCI6NTUsXCJudW1icm9cIjpcIm51bWJyb1wiLFwicGx1Z2luc1wiOjYxLFwicmVuZGVyZXJzXCI6MTE3LFwidGFibGVWaWV3XCI6MTI2LFwidXRpbHMvcmVjb3JkVHJhbnNsYXRvclwiOjEzMH1dLDI3OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBEYXRhTWFwOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBEYXRhTWFwO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19icm93c2VyX18sXG4gICAgJF9fU2hlZXRDbGlwX18sXG4gICAgJF9faGVscGVyc180N19kYXRhX18sXG4gICAgJF9faGVscGVyc180N19zZXR0aW5nX18sXG4gICAgJF9faGVscGVyc180N19vYmplY3RfXyxcbiAgICAkX19oZWxwZXJzXzQ3X2FycmF5X18sXG4gICAgJF9fdXRpbHNfNDdfaW50ZXJ2YWxfXyxcbiAgICAkX19oZWxwZXJzXzQ3X251bWJlcl9fLFxuICAgICRfX211bHRpTWFwX187XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19icm93c2VyX18gJiYgJF9fYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19icm93c2VyX199KS5kZWZhdWx0O1xudmFyIFNoZWV0Q2xpcCA9ICgkX19TaGVldENsaXBfXyA9IF9kZXJlcV8oXCJTaGVldENsaXBcIiksICRfX1NoZWV0Q2xpcF9fICYmICRfX1NoZWV0Q2xpcF9fLl9fZXNNb2R1bGUgJiYgJF9fU2hlZXRDbGlwX18gfHwge2RlZmF1bHQ6ICRfX1NoZWV0Q2xpcF9ffSkuZGVmYXVsdDtcbnZhciBjZWxsTWV0aG9kTG9va3VwRmFjdG9yeSA9ICgkX19oZWxwZXJzXzQ3X2RhdGFfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RhdGFcIiksICRfX2hlbHBlcnNfNDdfZGF0YV9fICYmICRfX2hlbHBlcnNfNDdfZGF0YV9fLl9fZXNNb2R1bGUgJiYgJF9faGVscGVyc180N19kYXRhX18gfHwge2RlZmF1bHQ6ICRfX2hlbHBlcnNfNDdfZGF0YV9ffSkuY2VsbE1ldGhvZExvb2t1cEZhY3Rvcnk7XG52YXIgY29sdW1uRmFjdG9yeSA9ICgkX19oZWxwZXJzXzQ3X3NldHRpbmdfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL3NldHRpbmdcIiksICRfX2hlbHBlcnNfNDdfc2V0dGluZ19fICYmICRfX2hlbHBlcnNfNDdfc2V0dGluZ19fLl9fZXNNb2R1bGUgJiYgJF9faGVscGVyc180N19zZXR0aW5nX18gfHwge2RlZmF1bHQ6ICRfX2hlbHBlcnNfNDdfc2V0dGluZ19ffSkuY29sdW1uRmFjdG9yeTtcbnZhciAkX180ID0gKCRfX2hlbHBlcnNfNDdfb2JqZWN0X18gPSBfZGVyZXFfKFwiaGVscGVycy9vYmplY3RcIiksICRfX2hlbHBlcnNfNDdfb2JqZWN0X18gJiYgJF9faGVscGVyc180N19vYmplY3RfXy5fX2VzTW9kdWxlICYmICRfX2hlbHBlcnNfNDdfb2JqZWN0X18gfHwge2RlZmF1bHQ6ICRfX2hlbHBlcnNfNDdfb2JqZWN0X199KSxcbiAgICBjcmVhdGVPYmplY3RQcm9wTGlzdGVuZXIgPSAkX180LmNyZWF0ZU9iamVjdFByb3BMaXN0ZW5lcixcbiAgICBkdWNrU2NoZW1hID0gJF9fNC5kdWNrU2NoZW1hLFxuICAgIGRlZXBFeHRlbmQgPSAkX180LmRlZXBFeHRlbmQsXG4gICAgZGVlcENsb25lID0gJF9fNC5kZWVwQ2xvbmUsXG4gICAgaXNPYmplY3QgPSAkX180LmlzT2JqZWN0LFxuICAgIGRlZXBPYmplY3RTaXplID0gJF9fNC5kZWVwT2JqZWN0U2l6ZTtcbnZhciAkX181ID0gKCRfX2hlbHBlcnNfNDdfYXJyYXlfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2FycmF5XCIpLCAkX19oZWxwZXJzXzQ3X2FycmF5X18gJiYgJF9faGVscGVyc180N19hcnJheV9fLl9fZXNNb2R1bGUgJiYgJF9faGVscGVyc180N19hcnJheV9fIHx8IHtkZWZhdWx0OiAkX19oZWxwZXJzXzQ3X2FycmF5X199KSxcbiAgICBleHRlbmRBcnJheSA9ICRfXzUuZXh0ZW5kQXJyYXksXG4gICAgdG8yZEFycmF5ID0gJF9fNS50bzJkQXJyYXk7XG52YXIgSW50ZXJ2YWwgPSAoJF9fdXRpbHNfNDdfaW50ZXJ2YWxfXyA9IF9kZXJlcV8oXCJ1dGlscy9pbnRlcnZhbFwiKSwgJF9fdXRpbHNfNDdfaW50ZXJ2YWxfXyAmJiAkX191dGlsc180N19pbnRlcnZhbF9fLl9fZXNNb2R1bGUgJiYgJF9fdXRpbHNfNDdfaW50ZXJ2YWxfXyB8fCB7ZGVmYXVsdDogJF9fdXRpbHNfNDdfaW50ZXJ2YWxfX30pLkludGVydmFsO1xudmFyIHJhbmdlRWFjaCA9ICgkX19oZWxwZXJzXzQ3X251bWJlcl9fID0gX2RlcmVxXyhcImhlbHBlcnMvbnVtYmVyXCIpLCAkX19oZWxwZXJzXzQ3X251bWJlcl9fICYmICRfX2hlbHBlcnNfNDdfbnVtYmVyX18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X251bWJlcl9fIHx8IHtkZWZhdWx0OiAkX19oZWxwZXJzXzQ3X251bWJlcl9ffSkucmFuZ2VFYWNoO1xudmFyIE11bHRpTWFwID0gKCRfX211bHRpTWFwX18gPSBfZGVyZXFfKFwibXVsdGlNYXBcIiksICRfX211bHRpTWFwX18gJiYgJF9fbXVsdGlNYXBfXy5fX2VzTW9kdWxlICYmICRfX211bHRpTWFwX18gfHwge2RlZmF1bHQ6ICRfX211bHRpTWFwX199KS5NdWx0aU1hcDtcbmZ1bmN0aW9uIERhdGFNYXAoaW5zdGFuY2UsIHByaXYsIEdyaWRTZXR0aW5ncykge1xuICB2YXIgJF9fOSA9IHRoaXM7XG4gIHRoaXMuaW5zdGFuY2UgPSBpbnN0YW5jZTtcbiAgdGhpcy5wcml2ID0gcHJpdjtcbiAgdGhpcy5HcmlkU2V0dGluZ3MgPSBHcmlkU2V0dGluZ3M7XG4gIHRoaXMuZGF0YVNvdXJjZSA9IHRoaXMuaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5kYXRhO1xuICB0aGlzLmNhY2hlZExlbmd0aCA9IG51bGw7XG4gIHRoaXMuc2tpcENhY2hlID0gZmFsc2U7XG4gIHRoaXMubGF0ZXN0U291cmNlUm93c0NvdW50ID0gMDtcbiAgaWYgKHRoaXMuZGF0YVNvdXJjZSAmJiB0aGlzLmRhdGFTb3VyY2VbMF0pIHtcbiAgICB0aGlzLmR1Y2tTY2hlbWEgPSB0aGlzLnJlY3Vyc2l2ZUR1Y2tTY2hlbWEodGhpcy5kYXRhU291cmNlWzBdKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLmR1Y2tTY2hlbWEgPSB7fTtcbiAgfVxuICB0aGlzLmNyZWF0ZU1hcCgpO1xuICB0aGlzLmludGVydmFsID0gSW50ZXJ2YWwuY3JlYXRlKChmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJF9fOS5jbGVhckxlbmd0aENhY2hlKCk7XG4gIH0pLCAnMTVmcHMnKTtcbiAgdGhpcy5pbnN0YW5jZS5hZGRIb29rKCdza2lwTGVuZ3RoQ2FjaGUnLCAoZnVuY3Rpb24oZGVsYXkpIHtcbiAgICByZXR1cm4gJF9fOS5vblNraXBMZW5ndGhDYWNoZShkZWxheSk7XG4gIH0pKTtcbiAgdGhpcy5vblNraXBMZW5ndGhDYWNoZSg1MDApO1xufVxuRGF0YU1hcC5wcm90b3R5cGUuREVTVElOQVRJT05fUkVOREVSRVIgPSAxO1xuRGF0YU1hcC5wcm90b3R5cGUuREVTVElOQVRJT05fQ0xJUEJPQVJEX0dFTkVSQVRPUiA9IDI7XG5EYXRhTWFwLnByb3RvdHlwZS5yZWN1cnNpdmVEdWNrU2NoZW1hID0gZnVuY3Rpb24ob2JqZWN0KSB7XG4gIHJldHVybiBkdWNrU2NoZW1hKG9iamVjdCk7XG59O1xuRGF0YU1hcC5wcm90b3R5cGUucmVjdXJzaXZlRHVja0NvbHVtbnMgPSBmdW5jdGlvbihzY2hlbWEsIGxhc3RDb2wsIHBhcmVudCkge1xuICB2YXIgcHJvcCxcbiAgICAgIGk7XG4gIGlmICh0eXBlb2YgbGFzdENvbCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBsYXN0Q29sID0gMDtcbiAgICBwYXJlbnQgPSAnJztcbiAgfVxuICBpZiAodHlwZW9mIHNjaGVtYSA9PT0gJ29iamVjdCcgJiYgIUFycmF5LmlzQXJyYXkoc2NoZW1hKSkge1xuICAgIGZvciAoaSBpbiBzY2hlbWEpIHtcbiAgICAgIGlmIChzY2hlbWEuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgaWYgKHNjaGVtYVtpXSA9PT0gbnVsbCkge1xuICAgICAgICAgIHByb3AgPSBwYXJlbnQgKyBpO1xuICAgICAgICAgIHRoaXMuY29sVG9Qcm9wQ2FjaGUucHVzaChwcm9wKTtcbiAgICAgICAgICB0aGlzLnByb3BUb0NvbENhY2hlLnNldChwcm9wLCBsYXN0Q29sKTtcbiAgICAgICAgICBsYXN0Q29sKys7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbGFzdENvbCA9IHRoaXMucmVjdXJzaXZlRHVja0NvbHVtbnMoc2NoZW1hW2ldLCBsYXN0Q29sLCBpICsgJy4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gbGFzdENvbDtcbn07XG5EYXRhTWFwLnByb3RvdHlwZS5jcmVhdGVNYXAgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGk7XG4gIHZhciBzY2hlbWEgPSB0aGlzLmdldFNjaGVtYSgpO1xuICBpZiAodHlwZW9mIHNjaGVtYSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3RyeWluZyB0byBjcmVhdGUgYGNvbHVtbnNgIGRlZmluaXRpb24gYnV0IHlvdSBkaWRuXFwndCBwcm92aWRlIGBzY2hlbWFgIG5vciBgZGF0YWAnKTtcbiAgfVxuICB0aGlzLmNvbFRvUHJvcENhY2hlID0gW107XG4gIHRoaXMucHJvcFRvQ29sQ2FjaGUgPSBuZXcgTXVsdGlNYXAoKTtcbiAgdmFyIGNvbHVtbnMgPSB0aGlzLmluc3RhbmNlLmdldFNldHRpbmdzKCkuY29sdW1ucztcbiAgaWYgKGNvbHVtbnMpIHtcbiAgICB2YXIgY29sdW1uc0xlbiA9IGNvbHVtbnMubGVuZ3RoO1xuICAgIHZhciBmaWx0ZXJlZEluZGV4ID0gMDtcbiAgICB2YXIgY29sdW1uc0FzRnVuYyA9IGZhbHNlO1xuICAgIHZhciBzY2hlbWFMZW4gPSBkZWVwT2JqZWN0U2l6ZShzY2hlbWEpO1xuICAgIGlmICh0eXBlb2YgY29sdW1ucyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgY29sdW1uc0xlbiA9IHNjaGVtYUxlbiA+IDAgPyBzY2hlbWFMZW4gOiB0aGlzLmluc3RhbmNlLmNvdW50U291cmNlQ29scygpO1xuICAgICAgY29sdW1uc0FzRnVuYyA9IHRydWU7XG4gICAgfVxuICAgIGZvciAoaSA9IDA7IGkgPCBjb2x1bW5zTGVuOyBpKyspIHtcbiAgICAgIHZhciBjb2x1bW4gPSBjb2x1bW5zQXNGdW5jID8gY29sdW1ucyhpKSA6IGNvbHVtbnNbaV07XG4gICAgICBpZiAoaXNPYmplY3QoY29sdW1uKSkge1xuICAgICAgICBpZiAodHlwZW9mIGNvbHVtbi5kYXRhICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgIHZhciBpbmRleCA9IGNvbHVtbnNBc0Z1bmMgPyBmaWx0ZXJlZEluZGV4IDogaTtcbiAgICAgICAgICB0aGlzLmNvbFRvUHJvcENhY2hlW2luZGV4XSA9IGNvbHVtbi5kYXRhO1xuICAgICAgICAgIHRoaXMucHJvcFRvQ29sQ2FjaGUuc2V0KGNvbHVtbi5kYXRhLCBpbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgZmlsdGVyZWRJbmRleCsrO1xuICAgICAgfVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB0aGlzLnJlY3Vyc2l2ZUR1Y2tDb2x1bW5zKHNjaGVtYSk7XG4gIH1cbn07XG5EYXRhTWFwLnByb3RvdHlwZS5jb2xUb1Byb3AgPSBmdW5jdGlvbihjb2wpIHtcbiAgY29sID0gSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bih0aGlzLmluc3RhbmNlLCAnbW9kaWZ5Q29sJywgY29sKTtcbiAgaWYgKHRoaXMuY29sVG9Qcm9wQ2FjaGUgJiYgdHlwZW9mIHRoaXMuY29sVG9Qcm9wQ2FjaGVbY29sXSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gdGhpcy5jb2xUb1Byb3BDYWNoZVtjb2xdO1xuICB9XG4gIHJldHVybiBjb2w7XG59O1xuRGF0YU1hcC5wcm90b3R5cGUucHJvcFRvQ29sID0gZnVuY3Rpb24ocHJvcCkge1xuICB2YXIgY29sO1xuICBpZiAodHlwZW9mIHRoaXMucHJvcFRvQ29sQ2FjaGUuZ2V0KHByb3ApID09PSAndW5kZWZpbmVkJykge1xuICAgIGNvbCA9IHByb3A7XG4gIH0gZWxzZSB7XG4gICAgY29sID0gdGhpcy5wcm9wVG9Db2xDYWNoZS5nZXQocHJvcCk7XG4gIH1cbiAgY29sID0gSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bih0aGlzLmluc3RhbmNlLCAndW5tb2RpZnlDb2wnLCBjb2wpO1xuICByZXR1cm4gY29sO1xufTtcbkRhdGFNYXAucHJvdG90eXBlLmdldFNjaGVtYSA9IGZ1bmN0aW9uKCkge1xuICB2YXIgc2NoZW1hID0gdGhpcy5pbnN0YW5jZS5nZXRTZXR0aW5ncygpLmRhdGFTY2hlbWE7XG4gIGlmIChzY2hlbWEpIHtcbiAgICBpZiAodHlwZW9mIHNjaGVtYSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmV0dXJuIHNjaGVtYSgpO1xuICAgIH1cbiAgICByZXR1cm4gc2NoZW1hO1xuICB9XG4gIHJldHVybiB0aGlzLmR1Y2tTY2hlbWE7XG59O1xuRGF0YU1hcC5wcm90b3R5cGUuY3JlYXRlUm93ID0gZnVuY3Rpb24oaW5kZXgsIGFtb3VudCwgc291cmNlKSB7XG4gIHZhciByb3csXG4gICAgICBjb2xDb3VudCA9IHRoaXMuaW5zdGFuY2UuY291bnRDb2xzKCksXG4gICAgICBudW1iZXJPZkNyZWF0ZWRSb3dzID0gMCxcbiAgICAgIGN1cnJlbnRJbmRleDtcbiAgaWYgKCFhbW91bnQpIHtcbiAgICBhbW91bnQgPSAxO1xuICB9XG4gIGlmICh0eXBlb2YgaW5kZXggIT09ICdudW1iZXInIHx8IGluZGV4ID49IHRoaXMuaW5zdGFuY2UuY291bnRTb3VyY2VSb3dzKCkpIHtcbiAgICBpbmRleCA9IHRoaXMuaW5zdGFuY2UuY291bnRTb3VyY2VSb3dzKCk7XG4gIH1cbiAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bih0aGlzLmluc3RhbmNlLCAnYmVmb3JlQ3JlYXRlUm93JywgaW5kZXgsIGFtb3VudCwgc291cmNlKTtcbiAgY3VycmVudEluZGV4ID0gaW5kZXg7XG4gIHZhciBtYXhSb3dzID0gdGhpcy5pbnN0YW5jZS5nZXRTZXR0aW5ncygpLm1heFJvd3M7XG4gIHdoaWxlIChudW1iZXJPZkNyZWF0ZWRSb3dzIDwgYW1vdW50ICYmIHRoaXMuaW5zdGFuY2UuY291bnRTb3VyY2VSb3dzKCkgPCBtYXhSb3dzKSB7XG4gICAgaWYgKHRoaXMuaW5zdGFuY2UuZGF0YVR5cGUgPT09ICdhcnJheScpIHtcbiAgICAgIGlmICh0aGlzLmluc3RhbmNlLmdldFNldHRpbmdzKCkuZGF0YVNjaGVtYSkge1xuICAgICAgICByb3cgPSBkZWVwQ2xvbmUodGhpcy5nZXRTY2hlbWEoKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByb3cgPSBbXTtcbiAgICAgICAgcmFuZ2VFYWNoKGNvbENvdW50IC0gMSwgKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiByb3cucHVzaChudWxsKTtcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodGhpcy5pbnN0YW5jZS5kYXRhVHlwZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcm93ID0gdGhpcy5pbnN0YW5jZS5nZXRTZXR0aW5ncygpLmRhdGFTY2hlbWEoaW5kZXgpO1xuICAgIH0gZWxzZSB7XG4gICAgICByb3cgPSB7fTtcbiAgICAgIGRlZXBFeHRlbmQocm93LCB0aGlzLmdldFNjaGVtYSgpKTtcbiAgICB9XG4gICAgaWYgKGluZGV4ID09PSB0aGlzLmluc3RhbmNlLmNvdW50U291cmNlUm93cygpKSB7XG4gICAgICB0aGlzLmRhdGFTb3VyY2UucHVzaChyb3cpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNwbGljZURhdGEoaW5kZXgsIDAsIHJvdyk7XG4gICAgfVxuICAgIG51bWJlck9mQ3JlYXRlZFJvd3MrKztcbiAgICBjdXJyZW50SW5kZXgrKztcbiAgfVxuICBIYW5kc29udGFibGUuaG9va3MucnVuKHRoaXMuaW5zdGFuY2UsICdhZnRlckNyZWF0ZVJvdycsIGluZGV4LCBudW1iZXJPZkNyZWF0ZWRSb3dzLCBzb3VyY2UpO1xuICB0aGlzLmluc3RhbmNlLmZvcmNlRnVsbFJlbmRlciA9IHRydWU7XG4gIHJldHVybiBudW1iZXJPZkNyZWF0ZWRSb3dzO1xufTtcbkRhdGFNYXAucHJvdG90eXBlLmNyZWF0ZUNvbCA9IGZ1bmN0aW9uKGluZGV4LCBhbW91bnQsIHNvdXJjZSkge1xuICBpZiAoIXRoaXMuaW5zdGFuY2UuaXNDb2x1bW5Nb2RpZmljYXRpb25BbGxvd2VkKCkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBjcmVhdGUgbmV3IGNvbHVtbi4gV2hlbiBkYXRhIHNvdXJjZSBpbiBhbiBvYmplY3QsICcgKyAneW91IGNhbiBvbmx5IGhhdmUgYXMgbXVjaCBjb2x1bW5zIGFzIGRlZmluZWQgaW4gZmlyc3QgZGF0YSByb3csIGRhdGEgc2NoZW1hIG9yIGluIHRoZSBcXCdjb2x1bW5zXFwnIHNldHRpbmcuJyArICdJZiB5b3Ugd2FudCB0byBiZSBhYmxlIHRvIGFkZCBuZXcgY29sdW1ucywgeW91IGhhdmUgdG8gdXNlIGFycmF5IGRhdGFzb3VyY2UuJyk7XG4gIH1cbiAgdmFyIHJsZW4gPSB0aGlzLmluc3RhbmNlLmNvdW50U291cmNlUm93cygpLFxuICAgICAgZGF0YSA9IHRoaXMuZGF0YVNvdXJjZSxcbiAgICAgIGNvbnN0cnVjdG9yLFxuICAgICAgbnVtYmVyT2ZDcmVhdGVkQ29scyA9IDAsXG4gICAgICBjdXJyZW50SW5kZXg7XG4gIGlmICghYW1vdW50KSB7XG4gICAgYW1vdW50ID0gMTtcbiAgfVxuICBpZiAodHlwZW9mIGluZGV4ICE9PSAnbnVtYmVyJyB8fCBpbmRleCA+PSB0aGlzLmluc3RhbmNlLmNvdW50Q29scygpKSB7XG4gICAgaW5kZXggPSB0aGlzLmluc3RhbmNlLmNvdW50Q29scygpO1xuICB9XG4gIEhhbmRzb250YWJsZS5ob29rcy5ydW4odGhpcy5pbnN0YW5jZSwgJ2JlZm9yZUNyZWF0ZUNvbCcsIGluZGV4LCBhbW91bnQsIHNvdXJjZSk7XG4gIGN1cnJlbnRJbmRleCA9IGluZGV4O1xuICB2YXIgbWF4Q29scyA9IHRoaXMuaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5tYXhDb2xzO1xuICB3aGlsZSAobnVtYmVyT2ZDcmVhdGVkQ29scyA8IGFtb3VudCAmJiB0aGlzLmluc3RhbmNlLmNvdW50Q29scygpIDwgbWF4Q29scykge1xuICAgIGNvbnN0cnVjdG9yID0gY29sdW1uRmFjdG9yeSh0aGlzLkdyaWRTZXR0aW5ncywgdGhpcy5wcml2LmNvbHVtbnNTZXR0aW5nQ29uZmxpY3RzKTtcbiAgICBpZiAodHlwZW9mIGluZGV4ICE9PSAnbnVtYmVyJyB8fCBpbmRleCA+PSB0aGlzLmluc3RhbmNlLmNvdW50Q29scygpKSB7XG4gICAgICBpZiAocmxlbiA+IDApIHtcbiAgICAgICAgZm9yICh2YXIgciA9IDA7IHIgPCBybGVuOyByKyspIHtcbiAgICAgICAgICBpZiAodHlwZW9mIGRhdGFbcl0gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBkYXRhW3JdID0gW107XG4gICAgICAgICAgfVxuICAgICAgICAgIGRhdGFbcl0ucHVzaChudWxsKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGF0YS5wdXNoKFtudWxsXSk7XG4gICAgICB9XG4gICAgICB0aGlzLnByaXYuY29sdW1uU2V0dGluZ3MucHVzaChjb25zdHJ1Y3Rvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAodmFyIHIgPSAwOyByIDwgcmxlbjsgcisrKSB7XG4gICAgICAgIGRhdGFbcl0uc3BsaWNlKGN1cnJlbnRJbmRleCwgMCwgbnVsbCk7XG4gICAgICB9XG4gICAgICB0aGlzLnByaXYuY29sdW1uU2V0dGluZ3Muc3BsaWNlKGN1cnJlbnRJbmRleCwgMCwgY29uc3RydWN0b3IpO1xuICAgIH1cbiAgICBudW1iZXJPZkNyZWF0ZWRDb2xzKys7XG4gICAgY3VycmVudEluZGV4Kys7XG4gIH1cbiAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bih0aGlzLmluc3RhbmNlLCAnYWZ0ZXJDcmVhdGVDb2wnLCBpbmRleCwgbnVtYmVyT2ZDcmVhdGVkQ29scywgc291cmNlKTtcbiAgdGhpcy5pbnN0YW5jZS5mb3JjZUZ1bGxSZW5kZXIgPSB0cnVlO1xuICByZXR1cm4gbnVtYmVyT2ZDcmVhdGVkQ29scztcbn07XG5EYXRhTWFwLnByb3RvdHlwZS5yZW1vdmVSb3cgPSBmdW5jdGlvbihpbmRleCwgYW1vdW50LCBzb3VyY2UpIHtcbiAgaWYgKCFhbW91bnQpIHtcbiAgICBhbW91bnQgPSAxO1xuICB9XG4gIGlmICh0eXBlb2YgaW5kZXggIT09ICdudW1iZXInKSB7XG4gICAgaW5kZXggPSAtYW1vdW50O1xuICB9XG4gIGFtb3VudCA9IEhhbmRzb250YWJsZS5ob29rcy5ydW4odGhpcy5pbnN0YW5jZSwgJ21vZGlmeVJlbW92ZWRBbW91bnQnLCBhbW91bnQsIGluZGV4KTtcbiAgaW5kZXggPSAodGhpcy5pbnN0YW5jZS5jb3VudFNvdXJjZVJvd3MoKSArIGluZGV4KSAlIHRoaXMuaW5zdGFuY2UuY291bnRTb3VyY2VSb3dzKCk7XG4gIHZhciBsb2dpY1Jvd3MgPSB0aGlzLnBoeXNpY2FsUm93c1RvTG9naWNhbChpbmRleCwgYW1vdW50KTtcbiAgdmFyIGFjdGlvbldhc05vdENhbmNlbGxlZCA9IEhhbmRzb250YWJsZS5ob29rcy5ydW4odGhpcy5pbnN0YW5jZSwgJ2JlZm9yZVJlbW92ZVJvdycsIGluZGV4LCBhbW91bnQsIGxvZ2ljUm93cywgc291cmNlKTtcbiAgaWYgKGFjdGlvbldhc05vdENhbmNlbGxlZCA9PT0gZmFsc2UpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIGRhdGEgPSB0aGlzLmRhdGFTb3VyY2U7XG4gIHZhciBuZXdEYXRhO1xuICBuZXdEYXRhID0gdGhpcy5maWx0ZXJEYXRhKGluZGV4LCBhbW91bnQpO1xuICBpZiAobmV3RGF0YSkge1xuICAgIGRhdGEubGVuZ3RoID0gMDtcbiAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShkYXRhLCBuZXdEYXRhKTtcbiAgfVxuICBIYW5kc29udGFibGUuaG9va3MucnVuKHRoaXMuaW5zdGFuY2UsICdhZnRlclJlbW92ZVJvdycsIGluZGV4LCBhbW91bnQsIGxvZ2ljUm93cywgc291cmNlKTtcbiAgdGhpcy5pbnN0YW5jZS5mb3JjZUZ1bGxSZW5kZXIgPSB0cnVlO1xufTtcbkRhdGFNYXAucHJvdG90eXBlLnJlbW92ZUNvbCA9IGZ1bmN0aW9uKGluZGV4LCBhbW91bnQsIHNvdXJjZSkge1xuICBpZiAodGhpcy5pbnN0YW5jZS5kYXRhVHlwZSA9PT0gJ29iamVjdCcgfHwgdGhpcy5pbnN0YW5jZS5nZXRTZXR0aW5ncygpLmNvbHVtbnMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2Nhbm5vdCByZW1vdmUgY29sdW1uIHdpdGggb2JqZWN0IGRhdGEgc291cmNlIG9yIGNvbHVtbnMgb3B0aW9uIHNwZWNpZmllZCcpO1xuICB9XG4gIGlmICghYW1vdW50KSB7XG4gICAgYW1vdW50ID0gMTtcbiAgfVxuICBpZiAodHlwZW9mIGluZGV4ICE9PSAnbnVtYmVyJykge1xuICAgIGluZGV4ID0gLWFtb3VudDtcbiAgfVxuICBpbmRleCA9ICh0aGlzLmluc3RhbmNlLmNvdW50Q29scygpICsgaW5kZXgpICUgdGhpcy5pbnN0YW5jZS5jb3VudENvbHMoKTtcbiAgdmFyIGxvZ2ljQ29sdW1ucyA9IHRoaXMucGh5c2ljYWxDb2x1bW5zVG9Mb2dpY2FsKGluZGV4LCBhbW91bnQpO1xuICB2YXIgZGVzY2VuZGluZ0xvZ2ljQ29sdW1ucyA9IGxvZ2ljQ29sdW1ucy5zbGljZSgwKS5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcbiAgICByZXR1cm4gYiAtIGE7XG4gIH0pO1xuICB2YXIgYWN0aW9uV2FzTm90Q2FuY2VsbGVkID0gSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bih0aGlzLmluc3RhbmNlLCAnYmVmb3JlUmVtb3ZlQ29sJywgaW5kZXgsIGFtb3VudCwgbG9naWNDb2x1bW5zLCBzb3VyY2UpO1xuICBpZiAoYWN0aW9uV2FzTm90Q2FuY2VsbGVkID09PSBmYWxzZSkge1xuICAgIHJldHVybjtcbiAgfVxuICB2YXIgaXNUYWJsZVVuaWZvcm0gPSB0cnVlO1xuICB2YXIgcmVtb3ZlZENvbHVtbnNDb3VudCA9IGRlc2NlbmRpbmdMb2dpY0NvbHVtbnMubGVuZ3RoO1xuICB2YXIgZGF0YSA9IHRoaXMuZGF0YVNvdXJjZTtcbiAgZm9yICh2YXIgYyA9IDA7IGMgPCByZW1vdmVkQ29sdW1uc0NvdW50OyBjKyspIHtcbiAgICBpZiAoaXNUYWJsZVVuaWZvcm0gJiYgbG9naWNDb2x1bW5zWzBdICE9PSBsb2dpY0NvbHVtbnNbY10gLSBjKSB7XG4gICAgICBpc1RhYmxlVW5pZm9ybSA9IGZhbHNlO1xuICAgIH1cbiAgfVxuICBpZiAoaXNUYWJsZVVuaWZvcm0pIHtcbiAgICBmb3IgKHZhciByID0gMCxcbiAgICAgICAgcmxlbiA9IHRoaXMuaW5zdGFuY2UuY291bnRTb3VyY2VSb3dzKCk7IHIgPCBybGVuOyByKyspIHtcbiAgICAgIGRhdGFbcl0uc3BsaWNlKGxvZ2ljQ29sdW1uc1swXSwgYW1vdW50KTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgZm9yICh2YXIgciRfXzEwID0gMCxcbiAgICAgICAgcmxlbiRfXzExID0gdGhpcy5pbnN0YW5jZS5jb3VudFNvdXJjZVJvd3MoKTsgciRfXzEwIDwgcmxlbiRfXzExOyByJF9fMTArKykge1xuICAgICAgZm9yICh2YXIgYyRfXzEyID0gMDsgYyRfXzEyIDwgcmVtb3ZlZENvbHVtbnNDb3VudDsgYyRfXzEyKyspIHtcbiAgICAgICAgZGF0YVtyJF9fMTBdLnNwbGljZShkZXNjZW5kaW5nTG9naWNDb2x1bW5zW2MkX18xMl0sIDEpO1xuICAgICAgfVxuICAgIH1cbiAgICBmb3IgKHZhciBjJF9fMTMgPSAwOyBjJF9fMTMgPCByZW1vdmVkQ29sdW1uc0NvdW50OyBjJF9fMTMrKykge1xuICAgICAgdGhpcy5wcml2LmNvbHVtblNldHRpbmdzLnNwbGljZShsb2dpY0NvbHVtbnNbYyRfXzEzXSwgMSk7XG4gICAgfVxuICB9XG4gIEhhbmRzb250YWJsZS5ob29rcy5ydW4odGhpcy5pbnN0YW5jZSwgJ2FmdGVyUmVtb3ZlQ29sJywgaW5kZXgsIGFtb3VudCwgbG9naWNDb2x1bW5zLCBzb3VyY2UpO1xuICB0aGlzLmluc3RhbmNlLmZvcmNlRnVsbFJlbmRlciA9IHRydWU7XG59O1xuRGF0YU1hcC5wcm90b3R5cGUuc3BsaWNlQ29sID0gZnVuY3Rpb24oY29sLCBpbmRleCwgYW1vdW50KSB7XG4gIHZhciBlbGVtZW50cyA9IDQgPD0gYXJndW1lbnRzLmxlbmd0aCA/IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAzKSA6IFtdO1xuICB2YXIgY29sRGF0YSA9IHRoaXMuaW5zdGFuY2UuZ2V0RGF0YUF0Q29sKGNvbCk7XG4gIHZhciByZW1vdmVkID0gY29sRGF0YS5zbGljZShpbmRleCwgaW5kZXggKyBhbW91bnQpO1xuICB2YXIgYWZ0ZXIgPSBjb2xEYXRhLnNsaWNlKGluZGV4ICsgYW1vdW50KTtcbiAgZXh0ZW5kQXJyYXkoZWxlbWVudHMsIGFmdGVyKTtcbiAgdmFyIGkgPSAwO1xuICB3aGlsZSAoaSA8IGFtb3VudCkge1xuICAgIGVsZW1lbnRzLnB1c2gobnVsbCk7XG4gICAgaSsrO1xuICB9XG4gIHRvMmRBcnJheShlbGVtZW50cyk7XG4gIHRoaXMuaW5zdGFuY2UucG9wdWxhdGVGcm9tQXJyYXkoaW5kZXgsIGNvbCwgZWxlbWVudHMsIG51bGwsIG51bGwsICdzcGxpY2VDb2wnKTtcbiAgcmV0dXJuIHJlbW92ZWQ7XG59O1xuRGF0YU1hcC5wcm90b3R5cGUuc3BsaWNlUm93ID0gZnVuY3Rpb24ocm93LCBpbmRleCwgYW1vdW50KSB7XG4gIHZhciBlbGVtZW50cyA9IDQgPD0gYXJndW1lbnRzLmxlbmd0aCA/IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAzKSA6IFtdO1xuICB2YXIgcm93RGF0YSA9IHRoaXMuaW5zdGFuY2UuZ2V0U291cmNlRGF0YUF0Um93KHJvdyk7XG4gIHZhciByZW1vdmVkID0gcm93RGF0YS5zbGljZShpbmRleCwgaW5kZXggKyBhbW91bnQpO1xuICB2YXIgYWZ0ZXIgPSByb3dEYXRhLnNsaWNlKGluZGV4ICsgYW1vdW50KTtcbiAgZXh0ZW5kQXJyYXkoZWxlbWVudHMsIGFmdGVyKTtcbiAgdmFyIGkgPSAwO1xuICB3aGlsZSAoaSA8IGFtb3VudCkge1xuICAgIGVsZW1lbnRzLnB1c2gobnVsbCk7XG4gICAgaSsrO1xuICB9XG4gIHRoaXMuaW5zdGFuY2UucG9wdWxhdGVGcm9tQXJyYXkocm93LCBpbmRleCwgW2VsZW1lbnRzXSwgbnVsbCwgbnVsbCwgJ3NwbGljZVJvdycpO1xuICByZXR1cm4gcmVtb3ZlZDtcbn07XG5EYXRhTWFwLnByb3RvdHlwZS5zcGxpY2VEYXRhID0gZnVuY3Rpb24oaW5kZXgsIGFtb3VudCwgZWxlbWVudCkge1xuICB2YXIgY29udGludWVTcGxpY2luZyA9IEhhbmRzb250YWJsZS5ob29rcy5ydW4odGhpcy5pbnN0YW5jZSwgJ2JlZm9yZURhdGFTcGxpY2UnLCBpbmRleCwgYW1vdW50LCBlbGVtZW50KTtcbiAgaWYgKGNvbnRpbnVlU3BsaWNpbmcgIT09IGZhbHNlKSB7XG4gICAgdGhpcy5kYXRhU291cmNlLnNwbGljZShpbmRleCwgYW1vdW50LCBlbGVtZW50KTtcbiAgfVxufTtcbkRhdGFNYXAucHJvdG90eXBlLmZpbHRlckRhdGEgPSBmdW5jdGlvbihpbmRleCwgYW1vdW50KSB7XG4gIHZhciBsb2dpY1Jvd3MgPSB0aGlzLnBoeXNpY2FsUm93c1RvTG9naWNhbChpbmRleCwgYW1vdW50KTtcbiAgdmFyIGNvbnRpbnVlU3BsaWNpbmcgPSBIYW5kc29udGFibGUuaG9va3MucnVuKHRoaXMuaW5zdGFuY2UsICdiZWZvcmVEYXRhRmlsdGVyJywgaW5kZXgsIGFtb3VudCwgbG9naWNSb3dzKTtcbiAgaWYgKGNvbnRpbnVlU3BsaWNpbmcgIT09IGZhbHNlKSB7XG4gICAgdmFyIG5ld0RhdGEgPSB0aGlzLmRhdGFTb3VyY2UuZmlsdGVyKGZ1bmN0aW9uKHJvdywgaW5kZXgpIHtcbiAgICAgIHJldHVybiBsb2dpY1Jvd3MuaW5kZXhPZihpbmRleCkgPT0gLTE7XG4gICAgfSk7XG4gICAgcmV0dXJuIG5ld0RhdGE7XG4gIH1cbn07XG5EYXRhTWFwLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbihyb3csIHByb3ApIHtcbiAgcm93ID0gSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bih0aGlzLmluc3RhbmNlLCAnbW9kaWZ5Um93Jywgcm93KTtcbiAgdmFyIGRhdGFSb3cgPSB0aGlzLmRhdGFTb3VyY2Vbcm93XTtcbiAgdmFyIG1vZGlmaWVkUm93RGF0YSA9IEhhbmRzb250YWJsZS5ob29rcy5ydW4odGhpcy5pbnN0YW5jZSwgJ21vZGlmeVJvd0RhdGEnLCByb3cpO1xuICBkYXRhUm93ID0gaXNOYU4obW9kaWZpZWRSb3dEYXRhKSA/IG1vZGlmaWVkUm93RGF0YSA6IGRhdGFSb3c7XG4gIHZhciB2YWx1ZSA9IG51bGw7XG4gIGlmIChkYXRhUm93ICYmIGRhdGFSb3cuaGFzT3duUHJvcGVydHkgJiYgZGF0YVJvdy5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xuICAgIHZhbHVlID0gZGF0YVJvd1twcm9wXTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgcHJvcCA9PT0gJ3N0cmluZycgJiYgcHJvcC5pbmRleE9mKCcuJykgPiAtMSkge1xuICAgIHZhciBzbGljZWQgPSBwcm9wLnNwbGl0KCcuJyk7XG4gICAgdmFyIG91dCA9IGRhdGFSb3c7XG4gICAgaWYgKCFvdXQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMCxcbiAgICAgICAgaWxlbiA9IHNsaWNlZC5sZW5ndGg7IGkgPCBpbGVuOyBpKyspIHtcbiAgICAgIG91dCA9IG91dFtzbGljZWRbaV1dO1xuICAgICAgaWYgKHR5cGVvZiBvdXQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgICB2YWx1ZSA9IG91dDtcbiAgfSBlbHNlIGlmICh0eXBlb2YgcHJvcCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHZhbHVlID0gcHJvcCh0aGlzLmRhdGFTb3VyY2Uuc2xpY2Uocm93LCByb3cgKyAxKVswXSk7XG4gIH1cbiAgaWYgKEhhbmRzb250YWJsZS5ob29rcy5oYXMoJ21vZGlmeURhdGEnLCB0aGlzLmluc3RhbmNlKSkge1xuICAgIHZhciB2YWx1ZUhvbGRlciA9IGNyZWF0ZU9iamVjdFByb3BMaXN0ZW5lcih2YWx1ZSk7XG4gICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bih0aGlzLmluc3RhbmNlLCAnbW9kaWZ5RGF0YScsIHJvdywgdGhpcy5wcm9wVG9Db2wocHJvcCksIHZhbHVlSG9sZGVyLCAnZ2V0Jyk7XG4gICAgaWYgKHZhbHVlSG9sZGVyLmlzVG91Y2hlZCgpKSB7XG4gICAgICB2YWx1ZSA9IHZhbHVlSG9sZGVyLnZhbHVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdmFsdWU7XG59O1xudmFyIGNvcHlhYmxlTG9va3VwID0gY2VsbE1ldGhvZExvb2t1cEZhY3RvcnkoJ2NvcHlhYmxlJywgZmFsc2UpO1xuRGF0YU1hcC5wcm90b3R5cGUuZ2V0Q29weWFibGUgPSBmdW5jdGlvbihyb3csIHByb3ApIHtcbiAgaWYgKGNvcHlhYmxlTG9va3VwLmNhbGwodGhpcy5pbnN0YW5jZSwgcm93LCB0aGlzLnByb3BUb0NvbChwcm9wKSkpIHtcbiAgICByZXR1cm4gdGhpcy5nZXQocm93LCBwcm9wKTtcbiAgfVxuICByZXR1cm4gJyc7XG59O1xuRGF0YU1hcC5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24ocm93LCBwcm9wLCB2YWx1ZSwgc291cmNlKSB7XG4gIHJvdyA9IEhhbmRzb250YWJsZS5ob29rcy5ydW4odGhpcy5pbnN0YW5jZSwgJ21vZGlmeVJvdycsIHJvdywgc291cmNlIHx8ICdkYXRhbWFwR2V0Jyk7XG4gIHZhciBkYXRhUm93ID0gdGhpcy5kYXRhU291cmNlW3Jvd107XG4gIHZhciBtb2RpZmllZFJvd0RhdGEgPSBIYW5kc29udGFibGUuaG9va3MucnVuKHRoaXMuaW5zdGFuY2UsICdtb2RpZnlSb3dEYXRhJywgcm93KTtcbiAgZGF0YVJvdyA9IGlzTmFOKG1vZGlmaWVkUm93RGF0YSkgPyBtb2RpZmllZFJvd0RhdGEgOiBkYXRhUm93O1xuICBpZiAoSGFuZHNvbnRhYmxlLmhvb2tzLmhhcygnbW9kaWZ5RGF0YScsIHRoaXMuaW5zdGFuY2UpKSB7XG4gICAgdmFyIHZhbHVlSG9sZGVyID0gY3JlYXRlT2JqZWN0UHJvcExpc3RlbmVyKHZhbHVlKTtcbiAgICBIYW5kc29udGFibGUuaG9va3MucnVuKHRoaXMuaW5zdGFuY2UsICdtb2RpZnlEYXRhJywgcm93LCB0aGlzLnByb3BUb0NvbChwcm9wKSwgdmFsdWVIb2xkZXIsICdzZXQnKTtcbiAgICBpZiAodmFsdWVIb2xkZXIuaXNUb3VjaGVkKCkpIHtcbiAgICAgIHZhbHVlID0gdmFsdWVIb2xkZXIudmFsdWU7XG4gICAgfVxuICB9XG4gIGlmIChkYXRhUm93ICYmIGRhdGFSb3cuaGFzT3duUHJvcGVydHkgJiYgZGF0YVJvdy5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xuICAgIGRhdGFSb3dbcHJvcF0gPSB2YWx1ZTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgcHJvcCA9PT0gJ3N0cmluZycgJiYgcHJvcC5pbmRleE9mKCcuJykgPiAtMSkge1xuICAgIHZhciBzbGljZWQgPSBwcm9wLnNwbGl0KCcuJyk7XG4gICAgdmFyIG91dCA9IGRhdGFSb3c7XG4gICAgZm9yICh2YXIgaSA9IDAsXG4gICAgICAgIGlsZW4gPSBzbGljZWQubGVuZ3RoIC0gMTsgaSA8IGlsZW47IGkrKykge1xuICAgICAgaWYgKHR5cGVvZiBvdXRbc2xpY2VkW2ldXSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgb3V0W3NsaWNlZFtpXV0gPSB7fTtcbiAgICAgIH1cbiAgICAgIG91dCA9IG91dFtzbGljZWRbaV1dO1xuICAgIH1cbiAgICBvdXRbc2xpY2VkW2ldXSA9IHZhbHVlO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBwcm9wID09PSAnZnVuY3Rpb24nKSB7XG4gICAgcHJvcCh0aGlzLmRhdGFTb3VyY2Uuc2xpY2Uocm93LCByb3cgKyAxKVswXSwgdmFsdWUpO1xuICB9IGVsc2Uge1xuICAgIGRhdGFSb3dbcHJvcF0gPSB2YWx1ZTtcbiAgfVxufTtcbkRhdGFNYXAucHJvdG90eXBlLnBoeXNpY2FsUm93c1RvTG9naWNhbCA9IGZ1bmN0aW9uKGluZGV4LCBhbW91bnQpIHtcbiAgdmFyIHRvdGFsUm93cyA9IHRoaXMuaW5zdGFuY2UuY291bnRTb3VyY2VSb3dzKCk7XG4gIHZhciBwaHlzaWNSb3cgPSAodG90YWxSb3dzICsgaW5kZXgpICUgdG90YWxSb3dzO1xuICB2YXIgbG9naWNSb3dzID0gW107XG4gIHZhciByb3dzVG9SZW1vdmUgPSBhbW91bnQ7XG4gIHZhciByb3c7XG4gIHdoaWxlIChwaHlzaWNSb3cgPCB0b3RhbFJvd3MgJiYgcm93c1RvUmVtb3ZlKSB7XG4gICAgcm93ID0gSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bih0aGlzLmluc3RhbmNlLCAnbW9kaWZ5Um93JywgcGh5c2ljUm93KTtcbiAgICBsb2dpY1Jvd3MucHVzaChyb3cpO1xuICAgIHJvd3NUb1JlbW92ZS0tO1xuICAgIHBoeXNpY1JvdysrO1xuICB9XG4gIHJldHVybiBsb2dpY1Jvd3M7XG59O1xuRGF0YU1hcC5wcm90b3R5cGUucGh5c2ljYWxDb2x1bW5zVG9Mb2dpY2FsID0gZnVuY3Rpb24oaW5kZXgsIGFtb3VudCkge1xuICB2YXIgdG90YWxDb2xzID0gdGhpcy5pbnN0YW5jZS5jb3VudENvbHMoKTtcbiAgdmFyIHBoeXNpY2FsQ29sID0gKHRvdGFsQ29scyArIGluZGV4KSAlIHRvdGFsQ29scztcbiAgdmFyIGxvZ2ljYWxDb2xzID0gW107XG4gIHZhciBjb2xzVG9SZW1vdmUgPSBhbW91bnQ7XG4gIHdoaWxlIChwaHlzaWNhbENvbCA8IHRvdGFsQ29scyAmJiBjb2xzVG9SZW1vdmUpIHtcbiAgICB2YXIgY29sID0gSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bih0aGlzLmluc3RhbmNlLCAnbW9kaWZ5Q29sJywgcGh5c2ljYWxDb2wpO1xuICAgIGxvZ2ljYWxDb2xzLnB1c2goY29sKTtcbiAgICBjb2xzVG9SZW1vdmUtLTtcbiAgICBwaHlzaWNhbENvbCsrO1xuICB9XG4gIHJldHVybiBsb2dpY2FsQ29scztcbn07XG5EYXRhTWFwLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uKCkge1xuICBmb3IgKHZhciByID0gMDsgciA8IHRoaXMuaW5zdGFuY2UuY291bnRTb3VyY2VSb3dzKCk7IHIrKykge1xuICAgIGZvciAodmFyIGMgPSAwOyBjIDwgdGhpcy5pbnN0YW5jZS5jb3VudENvbHMoKTsgYysrKSB7XG4gICAgICB0aGlzLnNldChyLCB0aGlzLmNvbFRvUHJvcChjKSwgJycpO1xuICAgIH1cbiAgfVxufTtcbkRhdGFNYXAucHJvdG90eXBlLmNsZWFyTGVuZ3RoQ2FjaGUgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5jYWNoZWRMZW5ndGggPSBudWxsO1xufTtcbkRhdGFNYXAucHJvdG90eXBlLmdldExlbmd0aCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgJF9fOSA9IHRoaXM7XG4gIHZhciBtYXhSb3dzLFxuICAgICAgbWF4Um93c0Zyb21TZXR0aW5ncyA9IHRoaXMuaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5tYXhSb3dzO1xuICBpZiAobWF4Um93c0Zyb21TZXR0aW5ncyA8IDAgfHwgbWF4Um93c0Zyb21TZXR0aW5ncyA9PT0gMCkge1xuICAgIG1heFJvd3MgPSAwO1xuICB9IGVsc2Uge1xuICAgIG1heFJvd3MgPSBtYXhSb3dzRnJvbVNldHRpbmdzIHx8IEluZmluaXR5O1xuICB9XG4gIHZhciBsZW5ndGggPSB0aGlzLmluc3RhbmNlLmNvdW50U291cmNlUm93cygpO1xuICBpZiAoSGFuZHNvbnRhYmxlLmhvb2tzLmhhcygnbW9kaWZ5Um93JywgdGhpcy5pbnN0YW5jZSkpIHtcbiAgICB2YXIgcmVWYWxpZGF0ZSA9IHRoaXMuc2tpcENhY2hlO1xuICAgIHRoaXMuaW50ZXJ2YWwuc3RhcnQoKTtcbiAgICBpZiAobGVuZ3RoICE9PSB0aGlzLmxhdGVzdFNvdXJjZVJvd3NDb3VudCkge1xuICAgICAgcmVWYWxpZGF0ZSA9IHRydWU7XG4gICAgfVxuICAgIHRoaXMubGF0ZXN0U291cmNlUm93c0NvdW50ID0gbGVuZ3RoO1xuICAgIGlmICh0aGlzLmNhY2hlZExlbmd0aCA9PT0gbnVsbCB8fCByZVZhbGlkYXRlKSB7XG4gICAgICByYW5nZUVhY2gobGVuZ3RoIC0gMSwgKGZ1bmN0aW9uKHJvdykge1xuICAgICAgICByb3cgPSBIYW5kc29udGFibGUuaG9va3MucnVuKCRfXzkuaW5zdGFuY2UsICdtb2RpZnlSb3cnLCByb3cpO1xuICAgICAgICBpZiAocm93ID09PSBudWxsKSB7XG4gICAgICAgICAgLS1sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgIH0pKTtcbiAgICAgIHRoaXMuY2FjaGVkTGVuZ3RoID0gbGVuZ3RoO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZW5ndGggPSB0aGlzLmNhY2hlZExlbmd0aDtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5pbnRlcnZhbC5zdG9wKCk7XG4gIH1cbiAgcmV0dXJuIE1hdGgubWluKGxlbmd0aCwgbWF4Um93cyk7XG59O1xuRGF0YU1hcC5wcm90b3R5cGUuZ2V0QWxsID0gZnVuY3Rpb24oKSB7XG4gIHZhciBzdGFydCA9IHtcbiAgICByb3c6IDAsXG4gICAgY29sOiAwXG4gIH07XG4gIHZhciBtYXhSb3dzID0gdGhpcy5pbnN0YW5jZS5nZXRTZXR0aW5ncygpLm1heFJvd3M7XG4gIGlmIChtYXhSb3dzID09PSAwKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHZhciBlbmQgPSB7XG4gICAgcm93OiBNYXRoLm1pbihNYXRoLm1heChtYXhSb3dzIC0gMSwgMCksIE1hdGgubWF4KHRoaXMuaW5zdGFuY2UuY291bnRTb3VyY2VSb3dzKCkgLSAxLCAwKSksXG4gICAgY29sOiBNYXRoLm1heCh0aGlzLmluc3RhbmNlLmNvdW50Q29scygpIC0gMSwgMClcbiAgfTtcbiAgaWYgKHN0YXJ0LnJvdyAtIGVuZC5yb3cgPT09IDAgJiYgIXRoaXMuaW5zdGFuY2UuY291bnRTb3VyY2VSb3dzKCkpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgcmV0dXJuIHRoaXMuZ2V0UmFuZ2Uoc3RhcnQsIGVuZCwgRGF0YU1hcC5wcm90b3R5cGUuREVTVElOQVRJT05fUkVOREVSRVIpO1xufTtcbkRhdGFNYXAucHJvdG90eXBlLmdldFJhbmdlID0gZnVuY3Rpb24oc3RhcnQsIGVuZCwgZGVzdGluYXRpb24pIHtcbiAgdmFyIHIsXG4gICAgICBybGVuLFxuICAgICAgYyxcbiAgICAgIGNsZW4sXG4gICAgICBvdXRwdXQgPSBbXSxcbiAgICAgIHJvdztcbiAgdmFyIGdldEZuID0gZGVzdGluYXRpb24gPT09IHRoaXMuREVTVElOQVRJT05fQ0xJUEJPQVJEX0dFTkVSQVRPUiA/IHRoaXMuZ2V0Q29weWFibGUgOiB0aGlzLmdldDtcbiAgcmxlbiA9IE1hdGgubWF4KHN0YXJ0LnJvdywgZW5kLnJvdyk7XG4gIGNsZW4gPSBNYXRoLm1heChzdGFydC5jb2wsIGVuZC5jb2wpO1xuICBmb3IgKHIgPSBNYXRoLm1pbihzdGFydC5yb3csIGVuZC5yb3cpOyByIDw9IHJsZW47IHIrKykge1xuICAgIHJvdyA9IFtdO1xuICAgIHZhciBwaHlzaWNhbFJvdyA9IEhhbmRzb250YWJsZS5ob29rcy5ydW4odGhpcy5pbnN0YW5jZSwgJ21vZGlmeVJvdycsIHIpO1xuICAgIGZvciAoYyA9IE1hdGgubWluKHN0YXJ0LmNvbCwgZW5kLmNvbCk7IGMgPD0gY2xlbjsgYysrKSB7XG4gICAgICBpZiAocGh5c2ljYWxSb3cgPT09IG51bGwpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICByb3cucHVzaChnZXRGbi5jYWxsKHRoaXMsIHIsIHRoaXMuY29sVG9Qcm9wKGMpKSk7XG4gICAgfVxuICAgIGlmIChwaHlzaWNhbFJvdyAhPT0gbnVsbCkge1xuICAgICAgb3V0cHV0LnB1c2gocm93KTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG91dHB1dDtcbn07XG5EYXRhTWFwLnByb3RvdHlwZS5nZXRUZXh0ID0gZnVuY3Rpb24oc3RhcnQsIGVuZCkge1xuICByZXR1cm4gU2hlZXRDbGlwLnN0cmluZ2lmeSh0aGlzLmdldFJhbmdlKHN0YXJ0LCBlbmQsIHRoaXMuREVTVElOQVRJT05fUkVOREVSRVIpKTtcbn07XG5EYXRhTWFwLnByb3RvdHlwZS5nZXRDb3B5YWJsZVRleHQgPSBmdW5jdGlvbihzdGFydCwgZW5kKSB7XG4gIHJldHVybiBTaGVldENsaXAuc3RyaW5naWZ5KHRoaXMuZ2V0UmFuZ2Uoc3RhcnQsIGVuZCwgdGhpcy5ERVNUSU5BVElPTl9DTElQQk9BUkRfR0VORVJBVE9SKSk7XG59O1xuRGF0YU1hcC5wcm90b3R5cGUub25Ta2lwTGVuZ3RoQ2FjaGUgPSBmdW5jdGlvbihkZWxheSkge1xuICB2YXIgJF9fOSA9IHRoaXM7XG4gIHRoaXMuc2tpcENhY2hlID0gdHJ1ZTtcbiAgc2V0VGltZW91dCgoZnVuY3Rpb24oKSB7XG4gICAgJF9fOS5za2lwQ2FjaGUgPSBmYWxzZTtcbiAgfSksIGRlbGF5KTtcbn07XG5EYXRhTWFwLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuaW50ZXJ2YWwuc3RvcCgpO1xuICB0aGlzLmludGVydmFsID0gbnVsbDtcbiAgdGhpcy5pbnN0YW5jZSA9IG51bGw7XG4gIHRoaXMucHJpdiA9IG51bGw7XG4gIHRoaXMuR3JpZFNldHRpbmdzID0gbnVsbDtcbiAgdGhpcy5kYXRhU291cmNlID0gbnVsbDtcbiAgdGhpcy5jYWNoZWRMZW5ndGggPSBudWxsO1xuICB0aGlzLmR1Y2tTY2hlbWEgPSBudWxsO1xufTtcbjtcblxuLy8jIFxufSx7XCJTaGVldENsaXBcIjpcIlNoZWV0Q2xpcFwiLFwiYnJvd3NlclwiOjI0LFwiaGVscGVycy9hcnJheVwiOjQzLFwiaGVscGVycy9kYXRhXCI6NDUsXCJoZWxwZXJzL251bWJlclwiOjUyLFwiaGVscGVycy9vYmplY3RcIjo1MyxcImhlbHBlcnMvc2V0dGluZ1wiOjU0LFwibXVsdGlNYXBcIjo1OSxcInV0aWxzL2ludGVydmFsXCI6MTI5fV0sMjg6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIERhdGFTb3VyY2U6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIERhdGFTb3VyY2U7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX2hlbHBlcnNfNDdfb2JqZWN0X18sXG4gICAgJF9faGVscGVyc180N19hcnJheV9fLFxuICAgICRfX2hlbHBlcnNfNDdfbnVtYmVyX187XG52YXIgZ2V0UHJvcGVydHkgPSAoJF9faGVscGVyc180N19vYmplY3RfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL29iamVjdFwiKSwgJF9faGVscGVyc180N19vYmplY3RfXyAmJiAkX19oZWxwZXJzXzQ3X29iamVjdF9fLl9fZXNNb2R1bGUgJiYgJF9faGVscGVyc180N19vYmplY3RfXyB8fCB7ZGVmYXVsdDogJF9faGVscGVyc180N19vYmplY3RfX30pLmdldFByb3BlcnR5O1xudmFyIGFycmF5RWFjaCA9ICgkX19oZWxwZXJzXzQ3X2FycmF5X18gPSBfZGVyZXFfKFwiaGVscGVycy9hcnJheVwiKSwgJF9faGVscGVyc180N19hcnJheV9fICYmICRfX2hlbHBlcnNfNDdfYXJyYXlfXy5fX2VzTW9kdWxlICYmICRfX2hlbHBlcnNfNDdfYXJyYXlfXyB8fCB7ZGVmYXVsdDogJF9faGVscGVyc180N19hcnJheV9ffSkuYXJyYXlFYWNoO1xudmFyIHJhbmdlRWFjaCA9ICgkX19oZWxwZXJzXzQ3X251bWJlcl9fID0gX2RlcmVxXyhcImhlbHBlcnMvbnVtYmVyXCIpLCAkX19oZWxwZXJzXzQ3X251bWJlcl9fICYmICRfX2hlbHBlcnNfNDdfbnVtYmVyX18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X251bWJlcl9fIHx8IHtkZWZhdWx0OiAkX19oZWxwZXJzXzQ3X251bWJlcl9ffSkucmFuZ2VFYWNoO1xudmFyIERhdGFTb3VyY2UgPSBmdW5jdGlvbiBEYXRhU291cmNlKGhvdEluc3RhbmNlKSB7XG4gIHZhciBkYXRhU291cmNlID0gYXJndW1lbnRzWzFdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1sxXSA6IFtdO1xuICB0aGlzLmhvdCA9IGhvdEluc3RhbmNlO1xuICB0aGlzLmRhdGEgPSBkYXRhU291cmNlO1xuICB0aGlzLmRhdGFUeXBlID0gJ2FycmF5JztcbiAgdGhpcy5jb2xUb1Byb3AgPSAoZnVuY3Rpb24oKSB7fSk7XG4gIHRoaXMucHJvcFRvQ29sID0gKGZ1bmN0aW9uKCkge30pO1xufTtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKERhdGFTb3VyY2UsIHtcbiAgZ2V0RGF0YTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHRvQXJyYXkgPSBhcmd1bWVudHNbMF0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzBdIDogZmFsc2U7XG4gICAgdmFyIHJlc3VsdCA9IHRoaXMuZGF0YTtcbiAgICBpZiAodG9BcnJheSkge1xuICAgICAgcmVzdWx0ID0gdGhpcy5nZXRCeVJhbmdlKHtcbiAgICAgICAgcm93OiAwLFxuICAgICAgICBjb2w6IDBcbiAgICAgIH0sIHtcbiAgICAgICAgcm93OiBNYXRoLm1heCh0aGlzLmNvdW50Um93cygpIC0gMSwgMCksXG4gICAgICAgIGNvbDogTWF0aC5tYXgodGhpcy5jb3VudENvbHVtbnMoKSAtIDEsIDApXG4gICAgICB9LCB0cnVlKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSxcbiAgc2V0RGF0YTogZnVuY3Rpb24oZGF0YSkge1xuICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gIH0sXG4gIGdldEF0Q29sdW1uOiBmdW5jdGlvbihjb2x1bW4pIHtcbiAgICB2YXIgJF9fMyA9IHRoaXM7XG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgIGFycmF5RWFjaCh0aGlzLmRhdGEsIChmdW5jdGlvbihyb3cpIHtcbiAgICAgIHZhciBwcm9wZXJ0eSA9ICRfXzMuY29sVG9Qcm9wKGNvbHVtbik7XG4gICAgICBpZiAodHlwZW9mIHByb3BlcnR5ID09PSAnc3RyaW5nJykge1xuICAgICAgICByb3cgPSBnZXRQcm9wZXJ0eShyb3csIHByb3BlcnR5KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJvdyA9IHJvd1twcm9wZXJ0eV07XG4gICAgICB9XG4gICAgICByZXN1bHQucHVzaChyb3cpO1xuICAgIH0pKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9LFxuICBnZXRBdFJvdzogZnVuY3Rpb24ocm93KSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YVtyb3ddO1xuICB9LFxuICBnZXRBdENlbGw6IGZ1bmN0aW9uKHJvdywgY29sdW1uKSB7XG4gICAgdmFyIHJlc3VsdCA9IG51bGw7XG4gICAgdmFyIG1vZGlmeVJvd0RhdGEgPSB0aGlzLmhvdC5ydW5Ib29rcygnbW9kaWZ5Um93RGF0YScsIHJvdyk7XG4gICAgdmFyIGRhdGFSb3cgPSBpc05hTihtb2RpZnlSb3dEYXRhKSA/IG1vZGlmeVJvd0RhdGEgOiB0aGlzLmRhdGFbcm93XTtcbiAgICBpZiAoZGF0YVJvdykge1xuICAgICAgdmFyIHByb3AgPSB0aGlzLmNvbFRvUHJvcChjb2x1bW4pO1xuICAgICAgaWYgKHR5cGVvZiBwcm9wID09PSAnc3RyaW5nJykge1xuICAgICAgICByZXN1bHQgPSBnZXRQcm9wZXJ0eShkYXRhUm93LCBwcm9wKTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHByb3AgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmVzdWx0ID0gcHJvcCh0aGlzLmRhdGEuc2xpY2Uocm93LCByb3cgKyAxKVswXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSBkYXRhUm93W3Byb3BdO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9LFxuICBnZXRCeVJhbmdlOiBmdW5jdGlvbihzdGFydCwgZW5kKSB7XG4gICAgdmFyIHRvQXJyYXkgPSBhcmd1bWVudHNbMl0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzJdIDogZmFsc2U7XG4gICAgdmFyICRfXzMgPSB0aGlzO1xuICAgIHZhciBzdGFydFJvdyA9IE1hdGgubWluKHN0YXJ0LnJvdywgZW5kLnJvdyk7XG4gICAgdmFyIHN0YXJ0Q29sID0gTWF0aC5taW4oc3RhcnQuY29sLCBlbmQuY29sKTtcbiAgICB2YXIgZW5kUm93ID0gTWF0aC5tYXgoc3RhcnQucm93LCBlbmQucm93KTtcbiAgICB2YXIgZW5kQ29sID0gTWF0aC5tYXgoc3RhcnQuY29sLCBlbmQuY29sKTtcbiAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgcmFuZ2VFYWNoKHN0YXJ0Um93LCBlbmRSb3csIChmdW5jdGlvbihjdXJyZW50Um93KSB7XG4gICAgICB2YXIgcm93ID0gJF9fMy5nZXRBdFJvdyhjdXJyZW50Um93KTtcbiAgICAgIHZhciBuZXdSb3c7XG4gICAgICBpZiAoJF9fMy5kYXRhVHlwZSA9PT0gJ2FycmF5Jykge1xuICAgICAgICBuZXdSb3cgPSByb3cuc2xpY2Uoc3RhcnRDb2wsIGVuZENvbCArIDEpO1xuICAgICAgfSBlbHNlIGlmICgkX18zLmRhdGFUeXBlID09PSAnb2JqZWN0Jykge1xuICAgICAgICBuZXdSb3cgPSB0b0FycmF5ID8gW10gOiB7fTtcbiAgICAgICAgcmFuZ2VFYWNoKHN0YXJ0Q29sLCBlbmRDb2wsIChmdW5jdGlvbihjb2x1bW4pIHtcbiAgICAgICAgICB2YXIgcHJvcCA9ICRfXzMuY29sVG9Qcm9wKGNvbHVtbik7XG4gICAgICAgICAgaWYgKHRvQXJyYXkpIHtcbiAgICAgICAgICAgIG5ld1Jvdy5wdXNoKHJvd1twcm9wXSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ld1Jvd1twcm9wXSA9IHJvd1twcm9wXTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICAgIHJlc3VsdC5wdXNoKG5ld1Jvdyk7XG4gICAgfSkpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH0sXG4gIGNvdW50Um93czogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIEFycmF5LmlzQXJyYXkodGhpcy5kYXRhKSA/IHRoaXMuZGF0YS5sZW5ndGggOiAwO1xuICB9LFxuICBjb3VudENvbHVtbnM6IGZ1bmN0aW9uKCkge1xuICAgIHZhciByZXN1bHQgPSAwO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHRoaXMuZGF0YSkpIHtcbiAgICAgIGlmICh0aGlzLmRhdGFUeXBlID09PSAnYXJyYXknKSB7XG4gICAgICAgIHJlc3VsdCA9IHRoaXMuZGF0YVswXS5sZW5ndGg7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMuZGF0YVR5cGUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIHJlc3VsdCA9IE9iamVjdC5rZXlzKHRoaXMuZGF0YVswXSkubGVuZ3RoO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9LFxuICBkZXN0cm95OiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmRhdGEgPSBudWxsO1xuICAgIHRoaXMuaG90ID0gbnVsbDtcbiAgfVxufSwge30pO1xuO1xuXG4vLyMgXG59LHtcImhlbHBlcnMvYXJyYXlcIjo0MyxcImhlbHBlcnMvbnVtYmVyXCI6NTIsXCJoZWxwZXJzL29iamVjdFwiOjUzfV0sMjk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIEVkaXRvck1hbmFnZXI6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIEVkaXRvck1hbmFnZXI7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX2Jyb3dzZXJfXyxcbiAgICAkX18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2VsbF80N19jb29yZHNfXyxcbiAgICAkX19oZWxwZXJzXzQ3X3VuaWNvZGVfXyxcbiAgICAkX19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fLFxuICAgICRfX2VkaXRvcnNfXyxcbiAgICAkX19ldmVudE1hbmFnZXJfXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX2Jyb3dzZXJfXyAmJiAkX19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgV2Fsa29udGFibGVDZWxsQ29vcmRzID0gKCRfXzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19fID0gX2RlcmVxXyhcIjNyZHBhcnR5L3dhbGtvbnRhYmxlL3NyYy9jZWxsL2Nvb3Jkc1wiKSwgJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX18gJiYgJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX18uX19lc01vZHVsZSAmJiAkX18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2VsbF80N19jb29yZHNfXyB8fCB7ZGVmYXVsdDogJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX199KS5XYWxrb250YWJsZUNlbGxDb29yZHM7XG52YXIgJF9fMiA9ICgkX19oZWxwZXJzXzQ3X3VuaWNvZGVfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL3VuaWNvZGVcIiksICRfX2hlbHBlcnNfNDdfdW5pY29kZV9fICYmICRfX2hlbHBlcnNfNDdfdW5pY29kZV9fLl9fZXNNb2R1bGUgJiYgJF9faGVscGVyc180N191bmljb2RlX18gfHwge2RlZmF1bHQ6ICRfX2hlbHBlcnNfNDdfdW5pY29kZV9ffSksXG4gICAgS0VZX0NPREVTID0gJF9fMi5LRVlfQ09ERVMsXG4gICAgaXNNZXRhS2V5ID0gJF9fMi5pc01ldGFLZXksXG4gICAgaXNDdHJsS2V5ID0gJF9fMi5pc0N0cmxLZXk7XG52YXIgJF9fMyA9ICgkX19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2V2ZW50XCIpLCAkX19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fICYmICRfX2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fIHx8IHtkZWZhdWx0OiAkX19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9ffSksXG4gICAgc3RvcFByb3BhZ2F0aW9uID0gJF9fMy5zdG9wUHJvcGFnYXRpb24sXG4gICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uID0gJF9fMy5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24sXG4gICAgaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSAkX18zLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkO1xudmFyIGdldEVkaXRvciA9ICgkX19lZGl0b3JzX18gPSBfZGVyZXFfKFwiZWRpdG9yc1wiKSwgJF9fZWRpdG9yc19fICYmICRfX2VkaXRvcnNfXy5fX2VzTW9kdWxlICYmICRfX2VkaXRvcnNfXyB8fCB7ZGVmYXVsdDogJF9fZWRpdG9yc19ffSkuZ2V0RWRpdG9yO1xudmFyIGV2ZW50TWFuYWdlck9iamVjdCA9ICgkX19ldmVudE1hbmFnZXJfXyA9IF9kZXJlcV8oXCJldmVudE1hbmFnZXJcIiksICRfX2V2ZW50TWFuYWdlcl9fICYmICRfX2V2ZW50TWFuYWdlcl9fLl9fZXNNb2R1bGUgJiYgJF9fZXZlbnRNYW5hZ2VyX18gfHwge2RlZmF1bHQ6ICRfX2V2ZW50TWFuYWdlcl9ffSkuZXZlbnRNYW5hZ2VyO1xuO1xuSGFuZHNvbnRhYmxlLkVkaXRvck1hbmFnZXIgPSBFZGl0b3JNYW5hZ2VyO1xuZnVuY3Rpb24gRWRpdG9yTWFuYWdlcihpbnN0YW5jZSwgcHJpdiwgc2VsZWN0aW9uKSB7XG4gIHZhciBfdGhpcyA9IHRoaXMsXG4gICAgICBkZXN0cm95ZWQgPSBmYWxzZSxcbiAgICAgIGV2ZW50TWFuYWdlcixcbiAgICAgIGFjdGl2ZUVkaXRvcjtcbiAgZXZlbnRNYW5hZ2VyID0gZXZlbnRNYW5hZ2VyT2JqZWN0KGluc3RhbmNlKTtcbiAgZnVuY3Rpb24gbW92ZVNlbGVjdGlvbkFmdGVyRW50ZXIoc2hpZnRLZXkpIHtcbiAgICBzZWxlY3Rpb24uc2V0U2VsZWN0ZWRIZWFkZXJzKGZhbHNlLCBmYWxzZSwgZmFsc2UpO1xuICAgIHZhciBlbnRlck1vdmVzID0gdHlwZW9mIHByaXYuc2V0dGluZ3MuZW50ZXJNb3ZlcyA9PT0gJ2Z1bmN0aW9uJyA/IHByaXYuc2V0dGluZ3MuZW50ZXJNb3ZlcyhldmVudCkgOiBwcml2LnNldHRpbmdzLmVudGVyTW92ZXM7XG4gICAgaWYgKHNoaWZ0S2V5KSB7XG4gICAgICBzZWxlY3Rpb24udHJhbnNmb3JtU3RhcnQoLWVudGVyTW92ZXMucm93LCAtZW50ZXJNb3Zlcy5jb2wpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZWxlY3Rpb24udHJhbnNmb3JtU3RhcnQoZW50ZXJNb3Zlcy5yb3csIGVudGVyTW92ZXMuY29sLCB0cnVlKTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gbW92ZVNlbGVjdGlvblVwKHNoaWZ0S2V5KSB7XG4gICAgaWYgKHNoaWZ0S2V5KSB7XG4gICAgICBpZiAoc2VsZWN0aW9uLnNlbGVjdGVkSGVhZGVyLmNvbHMpIHtcbiAgICAgICAgc2VsZWN0aW9uLnNldFNlbGVjdGVkSGVhZGVycyhzZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIucm93cywgZmFsc2UsIGZhbHNlKTtcbiAgICAgIH1cbiAgICAgIHNlbGVjdGlvbi50cmFuc2Zvcm1FbmQoLTEsIDApO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZWxlY3Rpb24uc2V0U2VsZWN0ZWRIZWFkZXJzKGZhbHNlLCBmYWxzZSwgZmFsc2UpO1xuICAgICAgc2VsZWN0aW9uLnRyYW5zZm9ybVN0YXJ0KC0xLCAwKTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gbW92ZVNlbGVjdGlvbkRvd24oc2hpZnRLZXkpIHtcbiAgICBpZiAoc2hpZnRLZXkpIHtcbiAgICAgIHNlbGVjdGlvbi50cmFuc2Zvcm1FbmQoMSwgMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNlbGVjdGlvbi5zZXRTZWxlY3RlZEhlYWRlcnMoZmFsc2UsIGZhbHNlLCBmYWxzZSk7XG4gICAgICBzZWxlY3Rpb24udHJhbnNmb3JtU3RhcnQoMSwgMCk7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIG1vdmVTZWxlY3Rpb25SaWdodChzaGlmdEtleSkge1xuICAgIGlmIChzaGlmdEtleSkge1xuICAgICAgc2VsZWN0aW9uLnRyYW5zZm9ybUVuZCgwLCAxKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2VsZWN0aW9uLnNldFNlbGVjdGVkSGVhZGVycyhmYWxzZSwgZmFsc2UsIGZhbHNlKTtcbiAgICAgIHNlbGVjdGlvbi50cmFuc2Zvcm1TdGFydCgwLCAxKTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gbW92ZVNlbGVjdGlvbkxlZnQoc2hpZnRLZXkpIHtcbiAgICBpZiAoc2hpZnRLZXkpIHtcbiAgICAgIGlmIChzZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIucm93cykge1xuICAgICAgICBzZWxlY3Rpb24uc2V0U2VsZWN0ZWRIZWFkZXJzKGZhbHNlLCBzZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIuY29scywgZmFsc2UpO1xuICAgICAgfVxuICAgICAgc2VsZWN0aW9uLnRyYW5zZm9ybUVuZCgwLCAtMSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNlbGVjdGlvbi5zZXRTZWxlY3RlZEhlYWRlcnMoZmFsc2UsIGZhbHNlLCBmYWxzZSk7XG4gICAgICBzZWxlY3Rpb24udHJhbnNmb3JtU3RhcnQoMCwgLTEpO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBvbktleURvd24oZXZlbnQpIHtcbiAgICB2YXIgY3RybERvd24sXG4gICAgICAgIHJhbmdlTW9kaWZpZXI7XG4gICAgaWYgKCFpbnN0YW5jZS5pc0xpc3RlbmluZygpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIEhhbmRzb250YWJsZS5ob29rcy5ydW4oaW5zdGFuY2UsICdiZWZvcmVLZXlEb3duJywgZXZlbnQpO1xuICAgIGlmIChkZXN0cm95ZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKGV2ZW50KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBwcml2Lmxhc3RLZXlDb2RlID0gZXZlbnQua2V5Q29kZTtcbiAgICBpZiAoIXNlbGVjdGlvbi5pc1NlbGVjdGVkKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY3RybERvd24gPSAoZXZlbnQuY3RybEtleSB8fCBldmVudC5tZXRhS2V5KSAmJiAhZXZlbnQuYWx0S2V5O1xuICAgIGlmIChhY3RpdmVFZGl0b3IgJiYgIWFjdGl2ZUVkaXRvci5pc1dhaXRpbmcoKSkge1xuICAgICAgaWYgKCFpc01ldGFLZXkoZXZlbnQua2V5Q29kZSkgJiYgIWlzQ3RybEtleShldmVudC5rZXlDb2RlKSAmJiAhY3RybERvd24gJiYgIV90aGlzLmlzRWRpdG9yT3BlbmVkKCkpIHtcbiAgICAgICAgX3RoaXMub3BlbkVkaXRvcignJywgZXZlbnQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICAgIHJhbmdlTW9kaWZpZXIgPSBldmVudC5zaGlmdEtleSA/IHNlbGVjdGlvbi5zZXRSYW5nZUVuZCA6IHNlbGVjdGlvbi5zZXRSYW5nZVN0YXJ0O1xuICAgIHN3aXRjaCAoZXZlbnQua2V5Q29kZSkge1xuICAgICAgY2FzZSBLRVlfQ09ERVMuQTpcbiAgICAgICAgaWYgKCFfdGhpcy5pc0VkaXRvck9wZW5lZCgpICYmIGN0cmxEb3duKSB7XG4gICAgICAgICAgc2VsZWN0aW9uLnNlbGVjdEFsbCgpO1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgc3RvcFByb3BhZ2F0aW9uKGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgS0VZX0NPREVTLkFSUk9XX1VQOlxuICAgICAgICBpZiAoX3RoaXMuaXNFZGl0b3JPcGVuZWQoKSAmJiAhYWN0aXZlRWRpdG9yLmlzV2FpdGluZygpKSB7XG4gICAgICAgICAgX3RoaXMuY2xvc2VFZGl0b3JBbmRTYXZlQ2hhbmdlcyhjdHJsRG93bik7XG4gICAgICAgIH1cbiAgICAgICAgbW92ZVNlbGVjdGlvblVwKGV2ZW50LnNoaWZ0S2V5KTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgc3RvcFByb3BhZ2F0aW9uKGV2ZW50KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEtFWV9DT0RFUy5BUlJPV19ET1dOOlxuICAgICAgICBpZiAoX3RoaXMuaXNFZGl0b3JPcGVuZWQoKSAmJiAhYWN0aXZlRWRpdG9yLmlzV2FpdGluZygpKSB7XG4gICAgICAgICAgX3RoaXMuY2xvc2VFZGl0b3JBbmRTYXZlQ2hhbmdlcyhjdHJsRG93bik7XG4gICAgICAgIH1cbiAgICAgICAgbW92ZVNlbGVjdGlvbkRvd24oZXZlbnQuc2hpZnRLZXkpO1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBzdG9wUHJvcGFnYXRpb24oZXZlbnQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgS0VZX0NPREVTLkFSUk9XX1JJR0hUOlxuICAgICAgICBpZiAoX3RoaXMuaXNFZGl0b3JPcGVuZWQoKSAmJiAhYWN0aXZlRWRpdG9yLmlzV2FpdGluZygpKSB7XG4gICAgICAgICAgX3RoaXMuY2xvc2VFZGl0b3JBbmRTYXZlQ2hhbmdlcyhjdHJsRG93bik7XG4gICAgICAgIH1cbiAgICAgICAgbW92ZVNlbGVjdGlvblJpZ2h0KGV2ZW50LnNoaWZ0S2V5KTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgc3RvcFByb3BhZ2F0aW9uKGV2ZW50KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEtFWV9DT0RFUy5BUlJPV19MRUZUOlxuICAgICAgICBpZiAoX3RoaXMuaXNFZGl0b3JPcGVuZWQoKSAmJiAhYWN0aXZlRWRpdG9yLmlzV2FpdGluZygpKSB7XG4gICAgICAgICAgX3RoaXMuY2xvc2VFZGl0b3JBbmRTYXZlQ2hhbmdlcyhjdHJsRG93bik7XG4gICAgICAgIH1cbiAgICAgICAgbW92ZVNlbGVjdGlvbkxlZnQoZXZlbnQuc2hpZnRLZXkpO1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBzdG9wUHJvcGFnYXRpb24oZXZlbnQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgS0VZX0NPREVTLlRBQjpcbiAgICAgICAgc2VsZWN0aW9uLnNldFNlbGVjdGVkSGVhZGVycyhmYWxzZSwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgdmFyIHRhYk1vdmVzID0gdHlwZW9mIHByaXYuc2V0dGluZ3MudGFiTW92ZXMgPT09ICdmdW5jdGlvbicgPyBwcml2LnNldHRpbmdzLnRhYk1vdmVzKGV2ZW50KSA6IHByaXYuc2V0dGluZ3MudGFiTW92ZXM7XG4gICAgICAgIGlmIChldmVudC5zaGlmdEtleSkge1xuICAgICAgICAgIHNlbGVjdGlvbi50cmFuc2Zvcm1TdGFydCgtdGFiTW92ZXMucm93LCAtdGFiTW92ZXMuY29sKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzZWxlY3Rpb24udHJhbnNmb3JtU3RhcnQodGFiTW92ZXMucm93LCB0YWJNb3Zlcy5jb2wsIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHN0b3BQcm9wYWdhdGlvbihldmVudCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBLRVlfQ09ERVMuQkFDS1NQQUNFOlxuICAgICAgY2FzZSBLRVlfQ09ERVMuREVMRVRFOlxuICAgICAgICBzZWxlY3Rpb24uZW1wdHkoZXZlbnQpO1xuICAgICAgICBfdGhpcy5wcmVwYXJlRWRpdG9yKCk7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBLRVlfQ09ERVMuRjI6XG4gICAgICAgIF90aGlzLm9wZW5FZGl0b3IobnVsbCwgZXZlbnQpO1xuICAgICAgICBpZiAoYWN0aXZlRWRpdG9yKSB7XG4gICAgICAgICAgYWN0aXZlRWRpdG9yLmVuYWJsZUZ1bGxFZGl0TW9kZSgpO1xuICAgICAgICB9XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBLRVlfQ09ERVMuRU5URVI6XG4gICAgICAgIGlmIChfdGhpcy5pc0VkaXRvck9wZW5lZCgpKSB7XG4gICAgICAgICAgaWYgKGFjdGl2ZUVkaXRvciAmJiBhY3RpdmVFZGl0b3Iuc3RhdGUgIT09IEhhbmRzb250YWJsZS5FZGl0b3JTdGF0ZS5XQUlUSU5HKSB7XG4gICAgICAgICAgICBfdGhpcy5jbG9zZUVkaXRvckFuZFNhdmVDaGFuZ2VzKGN0cmxEb3duKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbW92ZVNlbGVjdGlvbkFmdGVyRW50ZXIoZXZlbnQuc2hpZnRLZXkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChpbnN0YW5jZS5nZXRTZXR0aW5ncygpLmVudGVyQmVnaW5zRWRpdGluZykge1xuICAgICAgICAgICAgX3RoaXMub3BlbkVkaXRvcihudWxsLCBldmVudCk7XG4gICAgICAgICAgICBpZiAoYWN0aXZlRWRpdG9yKSB7XG4gICAgICAgICAgICAgIGFjdGl2ZUVkaXRvci5lbmFibGVGdWxsRWRpdE1vZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbW92ZVNlbGVjdGlvbkFmdGVyRW50ZXIoZXZlbnQuc2hpZnRLZXkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oZXZlbnQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgS0VZX0NPREVTLkVTQ0FQRTpcbiAgICAgICAgaWYgKF90aGlzLmlzRWRpdG9yT3BlbmVkKCkpIHtcbiAgICAgICAgICBfdGhpcy5jbG9zZUVkaXRvckFuZFJlc3RvcmVPcmlnaW5hbFZhbHVlKGN0cmxEb3duKTtcbiAgICAgICAgfVxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgS0VZX0NPREVTLkhPTUU6XG4gICAgICAgIHNlbGVjdGlvbi5zZXRTZWxlY3RlZEhlYWRlcnMoZmFsc2UsIGZhbHNlLCBmYWxzZSk7XG4gICAgICAgIGlmIChldmVudC5jdHJsS2V5IHx8IGV2ZW50Lm1ldGFLZXkpIHtcbiAgICAgICAgICByYW5nZU1vZGlmaWVyKG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoMCwgcHJpdi5zZWxSYW5nZS5mcm9tLmNvbCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJhbmdlTW9kaWZpZXIobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3Jkcyhwcml2LnNlbFJhbmdlLmZyb20ucm93LCAwKSk7XG4gICAgICAgIH1cbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgc3RvcFByb3BhZ2F0aW9uKGV2ZW50KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEtFWV9DT0RFUy5FTkQ6XG4gICAgICAgIHNlbGVjdGlvbi5zZXRTZWxlY3RlZEhlYWRlcnMoZmFsc2UsIGZhbHNlLCBmYWxzZSk7XG4gICAgICAgIGlmIChldmVudC5jdHJsS2V5IHx8IGV2ZW50Lm1ldGFLZXkpIHtcbiAgICAgICAgICByYW5nZU1vZGlmaWVyKG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoaW5zdGFuY2UuY291bnRSb3dzKCkgLSAxLCBwcml2LnNlbFJhbmdlLmZyb20uY29sKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmFuZ2VNb2RpZmllcihuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHByaXYuc2VsUmFuZ2UuZnJvbS5yb3csIGluc3RhbmNlLmNvdW50Q29scygpIC0gMSkpO1xuICAgICAgICB9XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHN0b3BQcm9wYWdhdGlvbihldmVudCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBLRVlfQ09ERVMuUEFHRV9VUDpcbiAgICAgICAgc2VsZWN0aW9uLnNldFNlbGVjdGVkSGVhZGVycyhmYWxzZSwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgc2VsZWN0aW9uLnRyYW5zZm9ybVN0YXJ0KC1pbnN0YW5jZS5jb3VudFZpc2libGVSb3dzKCksIDApO1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBzdG9wUHJvcGFnYXRpb24oZXZlbnQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgS0VZX0NPREVTLlBBR0VfRE9XTjpcbiAgICAgICAgc2VsZWN0aW9uLnNldFNlbGVjdGVkSGVhZGVycyhmYWxzZSwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgc2VsZWN0aW9uLnRyYW5zZm9ybVN0YXJ0KGluc3RhbmNlLmNvdW50VmlzaWJsZVJvd3MoKSwgMCk7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHN0b3BQcm9wYWdhdGlvbihldmVudCk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBpbml0KCkge1xuICAgIGluc3RhbmNlLmFkZEhvb2soJ2FmdGVyRG9jdW1lbnRLZXlEb3duJywgb25LZXlEb3duKTtcbiAgICBldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsICdrZXlkb3duJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGlmICghZGVzdHJveWVkKSB7XG4gICAgICAgIGluc3RhbmNlLnJ1bkhvb2tzKCdhZnRlckRvY3VtZW50S2V5RG93bicsIGV2ZW50KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBmdW5jdGlvbiBvbkRibENsaWNrKGV2ZW50LCBjb29yZHMsIGVsZW0pIHtcbiAgICAgIGlmIChlbGVtLm5vZGVOYW1lID09ICdURCcpIHtcbiAgICAgICAgX3RoaXMub3BlbkVkaXRvcigpO1xuICAgICAgICBpZiAoYWN0aXZlRWRpdG9yKSB7XG4gICAgICAgICAgYWN0aXZlRWRpdG9yLmVuYWJsZUZ1bGxFZGl0TW9kZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGluc3RhbmNlLnZpZXcud3QudXBkYXRlKCdvbkNlbGxEYmxDbGljaycsIG9uRGJsQ2xpY2spO1xuICAgIGluc3RhbmNlLmFkZEhvb2soJ2FmdGVyRGVzdHJveScsIGZ1bmN0aW9uKCkge1xuICAgICAgZGVzdHJveWVkID0gdHJ1ZTtcbiAgICB9KTtcbiAgfVxuICB0aGlzLmRlc3Ryb3lFZGl0b3IgPSBmdW5jdGlvbihyZXZlcnRPcmlnaW5hbCkge1xuICAgIHRoaXMuY2xvc2VFZGl0b3IocmV2ZXJ0T3JpZ2luYWwpO1xuICB9O1xuICB0aGlzLmdldEFjdGl2ZUVkaXRvciA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBhY3RpdmVFZGl0b3I7XG4gIH07XG4gIHRoaXMucHJlcGFyZUVkaXRvciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciByb3csXG4gICAgICAgIGNvbCxcbiAgICAgICAgcHJvcCxcbiAgICAgICAgdGQsXG4gICAgICAgIG9yaWdpbmFsVmFsdWUsXG4gICAgICAgIGNlbGxQcm9wZXJ0aWVzLFxuICAgICAgICBlZGl0b3JDbGFzcztcbiAgICBpZiAoYWN0aXZlRWRpdG9yICYmIGFjdGl2ZUVkaXRvci5pc1dhaXRpbmcoKSkge1xuICAgICAgdGhpcy5jbG9zZUVkaXRvcihmYWxzZSwgZmFsc2UsIGZ1bmN0aW9uKGRhdGFTYXZlZCkge1xuICAgICAgICBpZiAoZGF0YVNhdmVkKSB7XG4gICAgICAgICAgX3RoaXMucHJlcGFyZUVkaXRvcigpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcm93ID0gcHJpdi5zZWxSYW5nZS5oaWdobGlnaHQucm93O1xuICAgIGNvbCA9IHByaXYuc2VsUmFuZ2UuaGlnaGxpZ2h0LmNvbDtcbiAgICBwcm9wID0gaW5zdGFuY2UuY29sVG9Qcm9wKGNvbCk7XG4gICAgdGQgPSBpbnN0YW5jZS5nZXRDZWxsKHJvdywgY29sKTtcbiAgICBvcmlnaW5hbFZhbHVlID0gaW5zdGFuY2UuZ2V0U291cmNlRGF0YUF0Q2VsbChpbnN0YW5jZS5ydW5Ib29rcygnbW9kaWZ5Um93Jywgcm93KSwgY29sKTtcbiAgICBjZWxsUHJvcGVydGllcyA9IGluc3RhbmNlLmdldENlbGxNZXRhKHJvdywgY29sKTtcbiAgICBlZGl0b3JDbGFzcyA9IGluc3RhbmNlLmdldENlbGxFZGl0b3IoY2VsbFByb3BlcnRpZXMpO1xuICAgIGlmIChlZGl0b3JDbGFzcykge1xuICAgICAgYWN0aXZlRWRpdG9yID0gSGFuZHNvbnRhYmxlLmVkaXRvcnMuZ2V0RWRpdG9yKGVkaXRvckNsYXNzLCBpbnN0YW5jZSk7XG4gICAgICBhY3RpdmVFZGl0b3IucHJlcGFyZShyb3csIGNvbCwgcHJvcCwgdGQsIG9yaWdpbmFsVmFsdWUsIGNlbGxQcm9wZXJ0aWVzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYWN0aXZlRWRpdG9yID0gdm9pZCAwO1xuICAgIH1cbiAgfTtcbiAgdGhpcy5pc0VkaXRvck9wZW5lZCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBhY3RpdmVFZGl0b3IgJiYgYWN0aXZlRWRpdG9yLmlzT3BlbmVkKCk7XG4gIH07XG4gIHRoaXMub3BlbkVkaXRvciA9IGZ1bmN0aW9uKGluaXRpYWxWYWx1ZSwgZXZlbnQpIHtcbiAgICBpZiAoYWN0aXZlRWRpdG9yICYmICFhY3RpdmVFZGl0b3IuY2VsbFByb3BlcnRpZXMucmVhZE9ubHkpIHtcbiAgICAgIGFjdGl2ZUVkaXRvci5iZWdpbkVkaXRpbmcoaW5pdGlhbFZhbHVlLCBldmVudCk7XG4gICAgfSBlbHNlIGlmIChhY3RpdmVFZGl0b3IgJiYgYWN0aXZlRWRpdG9yLmNlbGxQcm9wZXJ0aWVzLnJlYWRPbmx5KSB7XG4gICAgICBpZiAoZXZlbnQgJiYgZXZlbnQua2V5Q29kZSA9PT0gS0VZX0NPREVTLkVOVEVSKSB7XG4gICAgICAgIG1vdmVTZWxlY3Rpb25BZnRlckVudGVyKCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuICB0aGlzLmNsb3NlRWRpdG9yID0gZnVuY3Rpb24ocmVzdG9yZU9yaWdpbmFsVmFsdWUsIGN0cmxEb3duLCBjYWxsYmFjaykge1xuICAgIGlmIChhY3RpdmVFZGl0b3IpIHtcbiAgICAgIGFjdGl2ZUVkaXRvci5maW5pc2hFZGl0aW5nKHJlc3RvcmVPcmlnaW5hbFZhbHVlLCBjdHJsRG93biwgY2FsbGJhY2spO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgY2FsbGJhY2soZmFsc2UpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgdGhpcy5jbG9zZUVkaXRvckFuZFNhdmVDaGFuZ2VzID0gZnVuY3Rpb24oY3RybERvd24pIHtcbiAgICByZXR1cm4gdGhpcy5jbG9zZUVkaXRvcihmYWxzZSwgY3RybERvd24pO1xuICB9O1xuICB0aGlzLmNsb3NlRWRpdG9yQW5kUmVzdG9yZU9yaWdpbmFsVmFsdWUgPSBmdW5jdGlvbihjdHJsRG93bikge1xuICAgIHJldHVybiB0aGlzLmNsb3NlRWRpdG9yKHRydWUsIGN0cmxEb3duKTtcbiAgfTtcbiAgaW5pdCgpO1xufVxuXG4vLyMgXG59LHtcIjNyZHBhcnR5L3dhbGtvbnRhYmxlL3NyYy9jZWxsL2Nvb3Jkc1wiOjYsXCJicm93c2VyXCI6MjQsXCJlZGl0b3JzXCI6MzAsXCJldmVudE1hbmFnZXJcIjo0MixcImhlbHBlcnMvZG9tL2V2ZW50XCI6NDgsXCJoZWxwZXJzL3VuaWNvZGVcIjo1Nn1dLDMwOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICByZWdpc3RlckVkaXRvcjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gcmVnaXN0ZXJFZGl0b3I7XG4gICAgfX0sXG4gIGdldEVkaXRvcjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZ2V0RWRpdG9yO1xuICAgIH19LFxuICBoYXNFZGl0b3I6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGhhc0VkaXRvcjtcbiAgICB9fSxcbiAgZ2V0RWRpdG9yQ29uc3RydWN0b3I6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGdldEVkaXRvckNvbnN0cnVjdG9yO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19icm93c2VyX18sXG4gICAgJF9faGVscGVyc180N19zdHJpbmdfXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX2Jyb3dzZXJfXyAmJiAkX19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgdG9VcHBlckNhc2VGaXJzdCA9ICgkX19oZWxwZXJzXzQ3X3N0cmluZ19fID0gX2RlcmVxXyhcImhlbHBlcnMvc3RyaW5nXCIpLCAkX19oZWxwZXJzXzQ3X3N0cmluZ19fICYmICRfX2hlbHBlcnNfNDdfc3RyaW5nX18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X3N0cmluZ19fIHx8IHtkZWZhdWx0OiAkX19oZWxwZXJzXzQ3X3N0cmluZ19ffSkudG9VcHBlckNhc2VGaXJzdDtcbjtcbnZhciByZWdpc3RlcmVkRWRpdG9yTmFtZXMgPSB7fSxcbiAgICByZWdpc3RlcmVkRWRpdG9yQ2xhc3NlcyA9IG5ldyBXZWFrTWFwKCk7XG5IYW5kc29udGFibGUuZWRpdG9ycyA9IEhhbmRzb250YWJsZS5lZGl0b3JzIHx8IHt9O1xuSGFuZHNvbnRhYmxlLmVkaXRvcnMucmVnaXN0ZXJFZGl0b3IgPSByZWdpc3RlckVkaXRvcjtcbkhhbmRzb250YWJsZS5lZGl0b3JzLmdldEVkaXRvciA9IGdldEVkaXRvcjtcbmZ1bmN0aW9uIFJlZ2lzdGVyZWRFZGl0b3IoZWRpdG9yQ2xhc3MpIHtcbiAgdmFyIENsYXp6LFxuICAgICAgaW5zdGFuY2VzO1xuICBpbnN0YW5jZXMgPSB7fTtcbiAgQ2xhenogPSBlZGl0b3JDbGFzcztcbiAgdGhpcy5nZXRDb25zdHJ1Y3RvciA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBlZGl0b3JDbGFzcztcbiAgfTtcbiAgdGhpcy5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uKGhvdEluc3RhbmNlKSB7XG4gICAgaWYgKCEoaG90SW5zdGFuY2UuZ3VpZCBpbiBpbnN0YW5jZXMpKSB7XG4gICAgICBpbnN0YW5jZXNbaG90SW5zdGFuY2UuZ3VpZF0gPSBuZXcgQ2xhenooaG90SW5zdGFuY2UpO1xuICAgIH1cbiAgICByZXR1cm4gaW5zdGFuY2VzW2hvdEluc3RhbmNlLmd1aWRdO1xuICB9O1xuICBIYW5kc29udGFibGUuaG9va3MuYWRkKCdhZnRlckRlc3Ryb3knLCBmdW5jdGlvbigpIHtcbiAgICBpbnN0YW5jZXMgPSB7fTtcbiAgfSk7XG59XG5mdW5jdGlvbiByZWdpc3RlckVkaXRvcihlZGl0b3JOYW1lLCBlZGl0b3JDbGFzcykge1xuICB2YXIgZWRpdG9yID0gbmV3IFJlZ2lzdGVyZWRFZGl0b3IoZWRpdG9yQ2xhc3MpO1xuICBpZiAodHlwZW9mIGVkaXRvck5hbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgcmVnaXN0ZXJlZEVkaXRvck5hbWVzW2VkaXRvck5hbWVdID0gZWRpdG9yO1xuICAgIEhhbmRzb250YWJsZS5lZGl0b3JzW3RvVXBwZXJDYXNlRmlyc3QoZWRpdG9yTmFtZSkgKyAnRWRpdG9yJ10gPSBlZGl0b3JDbGFzcztcbiAgfVxuICByZWdpc3RlcmVkRWRpdG9yQ2xhc3Nlcy5zZXQoZWRpdG9yQ2xhc3MsIGVkaXRvcik7XG59XG5mdW5jdGlvbiBnZXRFZGl0b3IoZWRpdG9yTmFtZSwgaG90SW5zdGFuY2UpIHtcbiAgdmFyIGVkaXRvcjtcbiAgaWYgKHR5cGVvZiBlZGl0b3JOYW1lID09ICdmdW5jdGlvbicpIHtcbiAgICBpZiAoIShyZWdpc3RlcmVkRWRpdG9yQ2xhc3Nlcy5nZXQoZWRpdG9yTmFtZSkpKSB7XG4gICAgICByZWdpc3RlckVkaXRvcihudWxsLCBlZGl0b3JOYW1lKTtcbiAgICB9XG4gICAgZWRpdG9yID0gcmVnaXN0ZXJlZEVkaXRvckNsYXNzZXMuZ2V0KGVkaXRvck5hbWUpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBlZGl0b3JOYW1lID09ICdzdHJpbmcnKSB7XG4gICAgZWRpdG9yID0gcmVnaXN0ZXJlZEVkaXRvck5hbWVzW2VkaXRvck5hbWVdO1xuICB9IGVsc2Uge1xuICAgIHRocm93IEVycm9yKCdPbmx5IHN0cmluZ3MgYW5kIGZ1bmN0aW9ucyBjYW4gYmUgcGFzc2VkIGFzIFwiZWRpdG9yXCIgcGFyYW1ldGVyICcpO1xuICB9XG4gIGlmICghZWRpdG9yKSB7XG4gICAgdGhyb3cgRXJyb3IoJ05vIGVkaXRvciByZWdpc3RlcmVkIHVuZGVyIG5hbWUgXCInICsgZWRpdG9yTmFtZSArICdcIicpO1xuICB9XG4gIHJldHVybiBlZGl0b3IuZ2V0SW5zdGFuY2UoaG90SW5zdGFuY2UpO1xufVxuZnVuY3Rpb24gZ2V0RWRpdG9yQ29uc3RydWN0b3IoZWRpdG9yTmFtZSkge1xuICB2YXIgZWRpdG9yO1xuICBpZiAodHlwZW9mIGVkaXRvck5hbWUgPT0gJ3N0cmluZycpIHtcbiAgICBlZGl0b3IgPSByZWdpc3RlcmVkRWRpdG9yTmFtZXNbZWRpdG9yTmFtZV07XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgRXJyb3IoJ09ubHkgc3RyaW5ncyBhbmQgZnVuY3Rpb25zIGNhbiBiZSBwYXNzZWQgYXMgXCJlZGl0b3JcIiBwYXJhbWV0ZXIgJyk7XG4gIH1cbiAgaWYgKCFlZGl0b3IpIHtcbiAgICB0aHJvdyBFcnJvcignTm8gZWRpdG9yIHJlZ2lzdGVyZWQgdW5kZXIgbmFtZSBcIicgKyBlZGl0b3JOYW1lICsgJ1wiJyk7XG4gIH1cbiAgcmV0dXJuIGVkaXRvci5nZXRDb25zdHJ1Y3RvcigpO1xufVxuZnVuY3Rpb24gaGFzRWRpdG9yKGVkaXRvck5hbWUpIHtcbiAgcmV0dXJuIHJlZ2lzdGVyZWRFZGl0b3JOYW1lc1tlZGl0b3JOYW1lXSA/IHRydWUgOiBmYWxzZTtcbn1cblxuLy8jIFxufSx7XCJicm93c2VyXCI6MjQsXCJoZWxwZXJzL3N0cmluZ1wiOjU1fV0sMzE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIEJhc2VFZGl0b3I6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIEJhc2VFZGl0b3I7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX187XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19fNDZfXzQ2X180N19icm93c2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19icm93c2VyX199KS5kZWZhdWx0O1xudmFyIHN0cmluZ2lmeSA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX18gPSBfZGVyZXFfKFwiaGVscGVycy9taXhlZFwiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19taXhlZF9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbWl4ZWRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbWl4ZWRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19taXhlZF9ffSkuc3RyaW5naWZ5O1xudmFyIFdhbGtvbnRhYmxlQ2VsbENvb3JkcyA9ICgkX19fNDZfXzQ2X180N18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2VsbF80N19jb29yZHNfXyA9IF9kZXJlcV8oXCIzcmRwYXJ0eS93YWxrb250YWJsZS9zcmMvY2VsbC9jb29yZHNcIiksICRfX180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19fICYmICRfX180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19ffSkuV2Fsa29udGFibGVDZWxsQ29vcmRzO1xuO1xuSGFuZHNvbnRhYmxlLmVkaXRvcnMgPSBIYW5kc29udGFibGUuZWRpdG9ycyB8fCB7fTtcbkhhbmRzb250YWJsZS5lZGl0b3JzLkJhc2VFZGl0b3IgPSBCYXNlRWRpdG9yO1xuSGFuZHNvbnRhYmxlLkVkaXRvclN0YXRlID0ge1xuICBWSVJHSU46ICdTVEFURV9WSVJHSU4nLFxuICBFRElUSU5HOiAnU1RBVEVfRURJVElORycsXG4gIFdBSVRJTkc6ICdTVEFURV9XQUlUSU5HJyxcbiAgRklOSVNIRUQ6ICdTVEFURV9GSU5JU0hFRCdcbn07XG5mdW5jdGlvbiBCYXNlRWRpdG9yKGluc3RhbmNlKSB7XG4gIHRoaXMuaW5zdGFuY2UgPSBpbnN0YW5jZTtcbiAgdGhpcy5zdGF0ZSA9IEhhbmRzb250YWJsZS5FZGl0b3JTdGF0ZS5WSVJHSU47XG4gIHRoaXMuX29wZW5lZCA9IGZhbHNlO1xuICB0aGlzLl9mdWxsRWRpdE1vZGUgPSBmYWxzZTtcbiAgdGhpcy5fY2xvc2VDYWxsYmFjayA9IG51bGw7XG4gIHRoaXMuaW5pdCgpO1xufVxuQmFzZUVkaXRvci5wcm90b3R5cGUuX2ZpcmVDYWxsYmFja3MgPSBmdW5jdGlvbihyZXN1bHQpIHtcbiAgaWYgKHRoaXMuX2Nsb3NlQ2FsbGJhY2spIHtcbiAgICB0aGlzLl9jbG9zZUNhbGxiYWNrKHJlc3VsdCk7XG4gICAgdGhpcy5fY2xvc2VDYWxsYmFjayA9IG51bGw7XG4gIH1cbn07XG5CYXNlRWRpdG9yLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKSB7fTtcbkJhc2VFZGl0b3IucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24oKSB7XG4gIHRocm93IEVycm9yKCdFZGl0b3IgZ2V0VmFsdWUoKSBtZXRob2QgdW5pbXBsZW1lbnRlZCcpO1xufTtcbkJhc2VFZGl0b3IucHJvdG90eXBlLnNldFZhbHVlID0gZnVuY3Rpb24obmV3VmFsdWUpIHtcbiAgdGhyb3cgRXJyb3IoJ0VkaXRvciBzZXRWYWx1ZSgpIG1ldGhvZCB1bmltcGxlbWVudGVkJyk7XG59O1xuQmFzZUVkaXRvci5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uKCkge1xuICB0aHJvdyBFcnJvcignRWRpdG9yIG9wZW4oKSBtZXRob2QgdW5pbXBsZW1lbnRlZCcpO1xufTtcbkJhc2VFZGl0b3IucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gIHRocm93IEVycm9yKCdFZGl0b3IgY2xvc2UoKSBtZXRob2QgdW5pbXBsZW1lbnRlZCcpO1xufTtcbkJhc2VFZGl0b3IucHJvdG90eXBlLnByZXBhcmUgPSBmdW5jdGlvbihyb3csIGNvbCwgcHJvcCwgdGQsIG9yaWdpbmFsVmFsdWUsIGNlbGxQcm9wZXJ0aWVzKSB7XG4gIHRoaXMuVEQgPSB0ZDtcbiAgdGhpcy5yb3cgPSByb3c7XG4gIHRoaXMuY29sID0gY29sO1xuICB0aGlzLnByb3AgPSBwcm9wO1xuICB0aGlzLm9yaWdpbmFsVmFsdWUgPSBvcmlnaW5hbFZhbHVlO1xuICB0aGlzLmNlbGxQcm9wZXJ0aWVzID0gY2VsbFByb3BlcnRpZXM7XG4gIHZhciBpbnZhbGlkQWN0aXZlRWxlbWVudCA9ICFkb2N1bWVudC5hY3RpdmVFbGVtZW50IHx8IChkb2N1bWVudC5hY3RpdmVFbGVtZW50ICYmIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQubm9kZU5hbWUgPT09IHZvaWQgMCk7XG4gIGlmICh0aGlzLmluc3RhbmNlLnZpZXcuaXNNb3VzZURvd24oKSAmJiBkb2N1bWVudC5hY3RpdmVFbGVtZW50ICYmIGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgIT09IGRvY3VtZW50LmJvZHkgJiYgIWludmFsaWRBY3RpdmVFbGVtZW50KSB7XG4gICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ibHVyKCk7XG4gIH0gZWxzZSBpZiAoaW52YWxpZEFjdGl2ZUVsZW1lbnQpIHtcbiAgICBkb2N1bWVudC5ib2R5LmZvY3VzKCk7XG4gIH1cbiAgdGhpcy5zdGF0ZSA9IEhhbmRzb250YWJsZS5FZGl0b3JTdGF0ZS5WSVJHSU47XG59O1xuQmFzZUVkaXRvci5wcm90b3R5cGUuZXh0ZW5kID0gZnVuY3Rpb24oKSB7XG4gIHZhciBiYXNlQ2xhc3MgPSB0aGlzLmNvbnN0cnVjdG9yO1xuICBmdW5jdGlvbiBFZGl0b3IoKSB7XG4gICAgYmFzZUNsYXNzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cbiAgZnVuY3Rpb24gaW5oZXJpdChDaGlsZCwgUGFyZW50KSB7XG4gICAgZnVuY3Rpb24gQnJpZGdlKCkge31cbiAgICBCcmlkZ2UucHJvdG90eXBlID0gUGFyZW50LnByb3RvdHlwZTtcbiAgICBDaGlsZC5wcm90b3R5cGUgPSBuZXcgQnJpZGdlKCk7XG4gICAgQ2hpbGQucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ2hpbGQ7XG4gICAgcmV0dXJuIENoaWxkO1xuICB9XG4gIHJldHVybiBpbmhlcml0KEVkaXRvciwgYmFzZUNsYXNzKTtcbn07XG5CYXNlRWRpdG9yLnByb3RvdHlwZS5zYXZlVmFsdWUgPSBmdW5jdGlvbih2YWx1ZSwgY3RybERvd24pIHtcbiAgdmFyIHNlbGVjdGlvbixcbiAgICAgIHRtcDtcbiAgaWYgKGN0cmxEb3duKSB7XG4gICAgc2VsZWN0aW9uID0gdGhpcy5pbnN0YW5jZS5nZXRTZWxlY3RlZCgpO1xuICAgIGlmIChzZWxlY3Rpb25bMF0gPiBzZWxlY3Rpb25bMl0pIHtcbiAgICAgIHRtcCA9IHNlbGVjdGlvblswXTtcbiAgICAgIHNlbGVjdGlvblswXSA9IHNlbGVjdGlvblsyXTtcbiAgICAgIHNlbGVjdGlvblsyXSA9IHRtcDtcbiAgICB9XG4gICAgaWYgKHNlbGVjdGlvblsxXSA+IHNlbGVjdGlvblszXSkge1xuICAgICAgdG1wID0gc2VsZWN0aW9uWzFdO1xuICAgICAgc2VsZWN0aW9uWzFdID0gc2VsZWN0aW9uWzNdO1xuICAgICAgc2VsZWN0aW9uWzNdID0gdG1wO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBzZWxlY3Rpb24gPSBbdGhpcy5yb3csIHRoaXMuY29sLCBudWxsLCBudWxsXTtcbiAgfVxuICB0aGlzLmluc3RhbmNlLnBvcHVsYXRlRnJvbUFycmF5KHNlbGVjdGlvblswXSwgc2VsZWN0aW9uWzFdLCB2YWx1ZSwgc2VsZWN0aW9uWzJdLCBzZWxlY3Rpb25bM10sICdlZGl0Jyk7XG59O1xuQmFzZUVkaXRvci5wcm90b3R5cGUuYmVnaW5FZGl0aW5nID0gZnVuY3Rpb24oaW5pdGlhbFZhbHVlLCBldmVudCkge1xuICBpZiAodGhpcy5zdGF0ZSAhPSBIYW5kc29udGFibGUuRWRpdG9yU3RhdGUuVklSR0lOKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHRoaXMuaW5zdGFuY2Uudmlldy5zY3JvbGxWaWV3cG9ydChuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHRoaXMucm93LCB0aGlzLmNvbCkpO1xuICB0aGlzLmluc3RhbmNlLnZpZXcucmVuZGVyKCk7XG4gIHRoaXMuc3RhdGUgPSBIYW5kc29udGFibGUuRWRpdG9yU3RhdGUuRURJVElORztcbiAgaW5pdGlhbFZhbHVlID0gdHlwZW9mIGluaXRpYWxWYWx1ZSA9PSAnc3RyaW5nJyA/IGluaXRpYWxWYWx1ZSA6IHRoaXMub3JpZ2luYWxWYWx1ZTtcbiAgdGhpcy5zZXRWYWx1ZShzdHJpbmdpZnkoaW5pdGlhbFZhbHVlKSk7XG4gIHRoaXMub3BlbihldmVudCk7XG4gIHRoaXMuX29wZW5lZCA9IHRydWU7XG4gIHRoaXMuZm9jdXMoKTtcbiAgdGhpcy5pbnN0YW5jZS52aWV3LnJlbmRlcigpO1xuICB0aGlzLmluc3RhbmNlLnJ1bkhvb2tzKCdhZnRlckJlZ2luRWRpdGluZycsIHRoaXMucm93LCB0aGlzLmNvbCk7XG59O1xuQmFzZUVkaXRvci5wcm90b3R5cGUuZmluaXNoRWRpdGluZyA9IGZ1bmN0aW9uKHJlc3RvcmVPcmlnaW5hbFZhbHVlLCBjdHJsRG93biwgY2FsbGJhY2spIHtcbiAgdmFyIF90aGlzID0gdGhpcyxcbiAgICAgIHZhbDtcbiAgaWYgKGNhbGxiYWNrKSB7XG4gICAgdmFyIHByZXZpb3VzQ2xvc2VDYWxsYmFjayA9IHRoaXMuX2Nsb3NlQ2FsbGJhY2s7XG4gICAgdGhpcy5fY2xvc2VDYWxsYmFjayA9IGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgaWYgKHByZXZpb3VzQ2xvc2VDYWxsYmFjaykge1xuICAgICAgICBwcmV2aW91c0Nsb3NlQ2FsbGJhY2socmVzdWx0KTtcbiAgICAgIH1cbiAgICAgIGNhbGxiYWNrKHJlc3VsdCk7XG4gICAgICBfdGhpcy5pbnN0YW5jZS52aWV3LnJlbmRlcigpO1xuICAgIH07XG4gIH1cbiAgaWYgKHRoaXMuaXNXYWl0aW5nKCkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKHRoaXMuc3RhdGUgPT0gSGFuZHNvbnRhYmxlLkVkaXRvclN0YXRlLlZJUkdJTikge1xuICAgIHRoaXMuaW5zdGFuY2UuX3JlZ2lzdGVyVGltZW91dChzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgX3RoaXMuX2ZpcmVDYWxsYmFja3ModHJ1ZSk7XG4gICAgfSwgMCkpO1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAodGhpcy5zdGF0ZSA9PSBIYW5kc29udGFibGUuRWRpdG9yU3RhdGUuRURJVElORykge1xuICAgIGlmIChyZXN0b3JlT3JpZ2luYWxWYWx1ZSkge1xuICAgICAgdGhpcy5jYW5jZWxDaGFuZ2VzKCk7XG4gICAgICB0aGlzLmluc3RhbmNlLnZpZXcucmVuZGVyKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB2YWx1ZSA9IHRoaXMuZ2V0VmFsdWUoKTtcbiAgICBpZiAodGhpcy5pbnN0YW5jZS5nZXRTZXR0aW5ncygpLnRyaW1XaGl0ZXNwYWNlKSB7XG4gICAgICB2YWwgPSBbW3R5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgPyBTdHJpbmcucHJvdG90eXBlLnRyaW0uY2FsbCh2YWx1ZSB8fCAnJykgOiB2YWx1ZV1dO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWwgPSBbW3ZhbHVlXV07XG4gICAgfVxuICAgIHRoaXMuc3RhdGUgPSBIYW5kc29udGFibGUuRWRpdG9yU3RhdGUuV0FJVElORztcbiAgICB0aGlzLnNhdmVWYWx1ZSh2YWwsIGN0cmxEb3duKTtcbiAgICBpZiAodGhpcy5pbnN0YW5jZS5nZXRDZWxsVmFsaWRhdG9yKHRoaXMuY2VsbFByb3BlcnRpZXMpKSB7XG4gICAgICB0aGlzLmluc3RhbmNlLmFkZEhvb2tPbmNlKCdwb3N0QWZ0ZXJWYWxpZGF0ZScsIGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICBfdGhpcy5zdGF0ZSA9IEhhbmRzb250YWJsZS5FZGl0b3JTdGF0ZS5GSU5JU0hFRDtcbiAgICAgICAgX3RoaXMuZGlzY2FyZEVkaXRvcihyZXN1bHQpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc3RhdGUgPSBIYW5kc29udGFibGUuRWRpdG9yU3RhdGUuRklOSVNIRUQ7XG4gICAgICB0aGlzLmRpc2NhcmRFZGl0b3IodHJ1ZSk7XG4gICAgfVxuICB9XG59O1xuQmFzZUVkaXRvci5wcm90b3R5cGUuY2FuY2VsQ2hhbmdlcyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnN0YXRlID0gSGFuZHNvbnRhYmxlLkVkaXRvclN0YXRlLkZJTklTSEVEO1xuICB0aGlzLmRpc2NhcmRFZGl0b3IoKTtcbn07XG5CYXNlRWRpdG9yLnByb3RvdHlwZS5kaXNjYXJkRWRpdG9yID0gZnVuY3Rpb24ocmVzdWx0KSB7XG4gIGlmICh0aGlzLnN0YXRlICE9PSBIYW5kc29udGFibGUuRWRpdG9yU3RhdGUuRklOSVNIRUQpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKHJlc3VsdCA9PT0gZmFsc2UgJiYgdGhpcy5jZWxsUHJvcGVydGllcy5hbGxvd0ludmFsaWQgIT09IHRydWUpIHtcbiAgICB0aGlzLmluc3RhbmNlLnNlbGVjdENlbGwodGhpcy5yb3csIHRoaXMuY29sKTtcbiAgICB0aGlzLmZvY3VzKCk7XG4gICAgdGhpcy5zdGF0ZSA9IEhhbmRzb250YWJsZS5FZGl0b3JTdGF0ZS5FRElUSU5HO1xuICAgIHRoaXMuX2ZpcmVDYWxsYmFja3MoZmFsc2UpO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuY2xvc2UoKTtcbiAgICB0aGlzLl9vcGVuZWQgPSBmYWxzZTtcbiAgICB0aGlzLl9mdWxsRWRpdE1vZGUgPSBmYWxzZTtcbiAgICB0aGlzLnN0YXRlID0gSGFuZHNvbnRhYmxlLkVkaXRvclN0YXRlLlZJUkdJTjtcbiAgICB0aGlzLl9maXJlQ2FsbGJhY2tzKHRydWUpO1xuICB9XG59O1xuQmFzZUVkaXRvci5wcm90b3R5cGUuZW5hYmxlRnVsbEVkaXRNb2RlID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuX2Z1bGxFZGl0TW9kZSA9IHRydWU7XG59O1xuQmFzZUVkaXRvci5wcm90b3R5cGUuaXNJbkZ1bGxFZGl0TW9kZSA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5fZnVsbEVkaXRNb2RlO1xufTtcbkJhc2VFZGl0b3IucHJvdG90eXBlLmlzT3BlbmVkID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLl9vcGVuZWQ7XG59O1xuQmFzZUVkaXRvci5wcm90b3R5cGUuaXNXYWl0aW5nID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLnN0YXRlID09PSBIYW5kc29udGFibGUuRWRpdG9yU3RhdGUuV0FJVElORztcbn07XG5CYXNlRWRpdG9yLnByb3RvdHlwZS5jaGVja0VkaXRvclNlY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgdmFyIHRvdGFsUm93cyA9IHRoaXMuaW5zdGFuY2UuY291bnRSb3dzKCk7XG4gIHZhciBzZWN0aW9uID0gJyc7XG4gIGlmICh0aGlzLnJvdyA8IHRoaXMuaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5maXhlZFJvd3NUb3ApIHtcbiAgICBpZiAodGhpcy5jb2wgPCB0aGlzLmluc3RhbmNlLmdldFNldHRpbmdzKCkuZml4ZWRDb2x1bW5zTGVmdCkge1xuICAgICAgc2VjdGlvbiA9ICd0b3AtbGVmdC1jb3JuZXInO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZWN0aW9uID0gJ3RvcCc7XG4gICAgfVxuICB9IGVsc2UgaWYgKHRoaXMuaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5maXhlZFJvd3NCb3R0b20gJiYgdGhpcy5yb3cgPj0gdG90YWxSb3dzIC0gdGhpcy5pbnN0YW5jZS5nZXRTZXR0aW5ncygpLmZpeGVkUm93c0JvdHRvbSkge1xuICAgIGlmICh0aGlzLmNvbCA8IHRoaXMuaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5maXhlZENvbHVtbnNMZWZ0KSB7XG4gICAgICBzZWN0aW9uID0gJ2JvdHRvbS1sZWZ0LWNvcm5lcic7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNlY3Rpb24gPSAnYm90dG9tJztcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaWYgKHRoaXMuY29sIDwgdGhpcy5pbnN0YW5jZS5nZXRTZXR0aW5ncygpLmZpeGVkQ29sdW1uc0xlZnQpIHtcbiAgICAgIHNlY3Rpb24gPSAnbGVmdCc7XG4gICAgfVxuICB9XG4gIHJldHVybiBzZWN0aW9uO1xufTtcblxuLy8jIFxufSx7XCIzcmRwYXJ0eS93YWxrb250YWJsZS9zcmMvY2VsbC9jb29yZHNcIjo2LFwiYnJvd3NlclwiOjI0LFwiaGVscGVycy9taXhlZFwiOjUxfV0sMzI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIEF1dG9jb21wbGV0ZUVkaXRvcjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gQXV0b2NvbXBsZXRlRWRpdG9yO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19zdHJpbmdfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXyxcbiAgICAkX19oYW5kc29udGFibGVFZGl0b3JfXztcbnZhciAkX18wID0gKCRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9fID0gX2RlcmVxXyhcImhlbHBlcnMvdW5pY29kZVwiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX18gJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX199KSxcbiAgICBLRVlfQ09ERVMgPSAkX18wLktFWV9DT0RFUyxcbiAgICBpc1ByaW50YWJsZUNoYXIgPSAkX18wLmlzUHJpbnRhYmxlQ2hhcjtcbnZhciBzdHJpbmdpZnkgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19taXhlZF9fID0gX2RlcmVxXyhcImhlbHBlcnMvbWl4ZWRcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbWl4ZWRfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbWl4ZWRfX30pLnN0cmluZ2lmeTtcbnZhciBzdHJpcFRhZ3MgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19zdHJpbmdfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL3N0cmluZ1wiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19zdHJpbmdfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3N0cmluZ19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19zdHJpbmdfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19zdHJpbmdfX30pLnN0cmlwVGFncztcbnZhciAkX18zID0gKCRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2FycmF5XCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X199KSxcbiAgICBwaXZvdCA9ICRfXzMucGl2b3QsXG4gICAgYXJyYXlGaWx0ZXIgPSAkX18zLmFycmF5RmlsdGVyLFxuICAgIGFycmF5TWFwID0gJF9fMy5hcnJheU1hcDtcbnZhciAkX180ID0gKCRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9lbGVtZW50XCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X199KSxcbiAgICBhZGRDbGFzcyA9ICRfXzQuYWRkQ2xhc3MsXG4gICAgZ2V0Q2FyZXRQb3NpdGlvbiA9ICRfXzQuZ2V0Q2FyZXRQb3NpdGlvbixcbiAgICBnZXRTY3JvbGxiYXJXaWR0aCA9ICRfXzQuZ2V0U2Nyb2xsYmFyV2lkdGgsXG4gICAgZ2V0U2VsZWN0aW9uRW5kUG9zaXRpb24gPSAkX180LmdldFNlbGVjdGlvbkVuZFBvc2l0aW9uLFxuICAgIG91dGVyV2lkdGggPSAkX180Lm91dGVyV2lkdGgsXG4gICAgb3V0ZXJIZWlnaHQgPSAkX180Lm91dGVySGVpZ2h0LFxuICAgIG9mZnNldCA9ICRfXzQub2Zmc2V0LFxuICAgIGdldFRyaW1taW5nQ29udGFpbmVyID0gJF9fNC5nZXRUcmltbWluZ0NvbnRhaW5lcixcbiAgICBzZXRDYXJldFBvc2l0aW9uID0gJF9fNC5zZXRDYXJldFBvc2l0aW9uO1xudmFyIHJlZ2lzdGVyRWRpdG9yID0gKCRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXyA9IF9kZXJlcV8oXCJlZGl0b3JzXCIpLCAkX19fNDZfXzQ2X180N19lZGl0b3JzX18gJiYgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19lZGl0b3JzX199KS5yZWdpc3RlckVkaXRvcjtcbnZhciBIYW5kc29udGFibGVFZGl0b3IgPSAoJF9faGFuZHNvbnRhYmxlRWRpdG9yX18gPSBfZGVyZXFfKFwiaGFuZHNvbnRhYmxlRWRpdG9yXCIpLCAkX19oYW5kc29udGFibGVFZGl0b3JfXyAmJiAkX19oYW5kc29udGFibGVFZGl0b3JfXy5fX2VzTW9kdWxlICYmICRfX2hhbmRzb250YWJsZUVkaXRvcl9fIHx8IHtkZWZhdWx0OiAkX19oYW5kc29udGFibGVFZGl0b3JfX30pLkhhbmRzb250YWJsZUVkaXRvcjtcbnZhciBBdXRvY29tcGxldGVFZGl0b3IgPSBIYW5kc29udGFibGVFZGl0b3IucHJvdG90eXBlLmV4dGVuZCgpO1xuQXV0b2NvbXBsZXRlRWRpdG9yLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKSB7XG4gIEhhbmRzb250YWJsZUVkaXRvci5wcm90b3R5cGUuaW5pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB0aGlzLnF1ZXJ5ID0gbnVsbDtcbiAgdGhpcy5jaG9pY2VzID0gW107XG59O1xuQXV0b2NvbXBsZXRlRWRpdG9yLnByb3RvdHlwZS5jcmVhdGVFbGVtZW50cyA9IGZ1bmN0aW9uKCkge1xuICBIYW5kc29udGFibGVFZGl0b3IucHJvdG90eXBlLmNyZWF0ZUVsZW1lbnRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIGFkZENsYXNzKHRoaXMuaHRDb250YWluZXIsICdhdXRvY29tcGxldGVFZGl0b3InKTtcbiAgYWRkQ2xhc3ModGhpcy5odENvbnRhaW5lciwgd2luZG93Lm5hdmlnYXRvci5wbGF0Zm9ybS5pbmRleE9mKCdNYWMnKSA9PT0gLTEgPyAnJyA6ICdodE1hY1Njcm9sbCcpO1xufTtcbnZhciBza2lwT25lID0gZmFsc2U7XG5mdW5jdGlvbiBvbkJlZm9yZUtleURvd24oZXZlbnQpIHtcbiAgc2tpcE9uZSA9IGZhbHNlO1xuICB2YXIgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgaWYgKGlzUHJpbnRhYmxlQ2hhcihldmVudC5rZXlDb2RlKSB8fCBldmVudC5rZXlDb2RlID09PSBLRVlfQ09ERVMuQkFDS1NQQUNFIHx8IGV2ZW50LmtleUNvZGUgPT09IEtFWV9DT0RFUy5ERUxFVEUgfHwgZXZlbnQua2V5Q29kZSA9PT0gS0VZX0NPREVTLklOU0VSVCkge1xuICAgIHZhciB0aW1lT2Zmc2V0ID0gMDtcbiAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gS0VZX0NPREVTLkMgJiYgKGV2ZW50LmN0cmxLZXkgfHwgZXZlbnQubWV0YUtleSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCFlZGl0b3IuaXNPcGVuZWQoKSkge1xuICAgICAgdGltZU9mZnNldCArPSAxMDtcbiAgICB9XG4gICAgaWYgKGVkaXRvci5odEVkaXRvcikge1xuICAgICAgZWRpdG9yLmluc3RhbmNlLl9yZWdpc3RlclRpbWVvdXQoc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgZWRpdG9yLnF1ZXJ5Q2hvaWNlcyhlZGl0b3IuVEVYVEFSRUEudmFsdWUpO1xuICAgICAgICBza2lwT25lID0gdHJ1ZTtcbiAgICAgIH0sIHRpbWVPZmZzZXQpKTtcbiAgICB9XG4gIH1cbn1cbkF1dG9jb21wbGV0ZUVkaXRvci5wcm90b3R5cGUucHJlcGFyZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmluc3RhbmNlLmFkZEhvb2soJ2JlZm9yZUtleURvd24nLCBvbkJlZm9yZUtleURvd24pO1xuICBIYW5kc29udGFibGVFZGl0b3IucHJvdG90eXBlLnByZXBhcmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn07XG5BdXRvY29tcGxldGVFZGl0b3IucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5URVhUQVJFQV9QQVJFTlQuc3R5bGUub3ZlcmZsb3cgPSAnYXV0byc7XG4gIEhhbmRzb250YWJsZUVkaXRvci5wcm90b3R5cGUub3Blbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB0aGlzLlRFWFRBUkVBX1BBUkVOVC5zdHlsZS5vdmVyZmxvdyA9ICcnO1xuICB2YXIgY2hvaWNlc0xpc3RIb3QgPSB0aGlzLmh0RWRpdG9yLmdldEluc3RhbmNlKCk7XG4gIHZhciBfdGhpcyA9IHRoaXM7XG4gIHZhciB0cmltRHJvcGRvd24gPSB0aGlzLmNlbGxQcm9wZXJ0aWVzLnRyaW1Ecm9wZG93biA9PT0gdm9pZCAwID8gdHJ1ZSA6IHRoaXMuY2VsbFByb3BlcnRpZXMudHJpbURyb3Bkb3duO1xuICB0aGlzLlRFWFRBUkVBLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XG4gIHRoaXMuZm9jdXMoKTtcbiAgY2hvaWNlc0xpc3RIb3QudXBkYXRlU2V0dGluZ3Moe1xuICAgIGNvbFdpZHRoczogdHJpbURyb3Bkb3duID8gW291dGVyV2lkdGgodGhpcy5URVhUQVJFQSkgLSAyXSA6IHZvaWQgMCxcbiAgICB3aWR0aDogdHJpbURyb3Bkb3duID8gb3V0ZXJXaWR0aCh0aGlzLlRFWFRBUkVBKSArIGdldFNjcm9sbGJhcldpZHRoKCkgKyAyIDogdm9pZCAwLFxuICAgIGFmdGVyUmVuZGVyZXI6IGZ1bmN0aW9uKFRELCByb3csIGNvbCwgcHJvcCwgdmFsdWUsIGNlbGxQcm9wZXJ0aWVzKSB7XG4gICAgICB2YXIgJF9fOCA9IF90aGlzLmNlbGxQcm9wZXJ0aWVzLFxuICAgICAgICAgIGZpbHRlcmluZ0Nhc2VTZW5zaXRpdmUgPSAkX184LmZpbHRlcmluZ0Nhc2VTZW5zaXRpdmUsXG4gICAgICAgICAgYWxsb3dIdG1sID0gJF9fOC5hbGxvd0h0bWw7XG4gICAgICB2YXIgaW5kZXhPZk1hdGNoO1xuICAgICAgdmFyIG1hdGNoO1xuICAgICAgdmFsdWUgPSBzdHJpbmdpZnkodmFsdWUpO1xuICAgICAgaWYgKHZhbHVlICYmICFhbGxvd0h0bWwpIHtcbiAgICAgICAgaW5kZXhPZk1hdGNoID0gZmlsdGVyaW5nQ2FzZVNlbnNpdGl2ZSA9PT0gdHJ1ZSA/IHZhbHVlLmluZGV4T2YodGhpcy5xdWVyeSkgOiB2YWx1ZS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoX3RoaXMucXVlcnkudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgIGlmIChpbmRleE9mTWF0Y2ggIT09IC0xKSB7XG4gICAgICAgICAgbWF0Y2ggPSB2YWx1ZS5zdWJzdHIoaW5kZXhPZk1hdGNoLCBfdGhpcy5xdWVyeS5sZW5ndGgpO1xuICAgICAgICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZShtYXRjaCwgJzxzdHJvbmc+JyArIG1hdGNoICsgJzwvc3Ryb25nPicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBURC5pbm5lckhUTUwgPSB2YWx1ZTtcbiAgICB9LFxuICAgIGF1dG9Db2x1bW5TaXplOiB0cnVlLFxuICAgIG1vZGlmeUNvbFdpZHRoOiBmdW5jdGlvbih3aWR0aCwgY29sKSB7XG4gICAgICB2YXIgYXV0b1dpZHRocyA9IHRoaXMuZ2V0UGx1Z2luKCdhdXRvQ29sdW1uU2l6ZScpLndpZHRocztcbiAgICAgIGlmIChhdXRvV2lkdGhzW2NvbF0pIHtcbiAgICAgICAgd2lkdGggPSBhdXRvV2lkdGhzW2NvbF07XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJpbURyb3Bkb3duID8gd2lkdGggOiB3aWR0aCArIDE1O1xuICAgIH1cbiAgfSk7XG4gIHRoaXMuaHRFZGl0b3Iudmlldy53dC53dFRhYmxlLmhvbGRlci5wYXJlbnROb2RlLnN0eWxlWydwYWRkaW5nLXJpZ2h0J10gPSBnZXRTY3JvbGxiYXJXaWR0aCgpICsgMiArICdweCc7XG4gIGlmIChza2lwT25lKSB7XG4gICAgc2tpcE9uZSA9IGZhbHNlO1xuICB9XG4gIF90aGlzLmluc3RhbmNlLl9yZWdpc3RlclRpbWVvdXQoc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICBfdGhpcy5xdWVyeUNob2ljZXMoX3RoaXMuVEVYVEFSRUEudmFsdWUpO1xuICB9LCAwKSk7XG59O1xuQXV0b2NvbXBsZXRlRWRpdG9yLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICBIYW5kc29udGFibGVFZGl0b3IucHJvdG90eXBlLmNsb3NlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59O1xuQXV0b2NvbXBsZXRlRWRpdG9yLnByb3RvdHlwZS5xdWVyeUNob2ljZXMgPSBmdW5jdGlvbihxdWVyeSkge1xuICB2YXIgJF9fNyA9IHRoaXM7XG4gIHRoaXMucXVlcnkgPSBxdWVyeTtcbiAgdmFyICRfXzggPSB0aGlzLmNlbGxQcm9wZXJ0aWVzLFxuICAgICAgc291cmNlID0gJF9fOC5zb3VyY2UsXG4gICAgICBmaWx0ZXIgPSAkX184LmZpbHRlcixcbiAgICAgIGZpbHRlcmluZ0Nhc2VTZW5zaXRpdmUgPSAkX184LmZpbHRlcmluZ0Nhc2VTZW5zaXRpdmUsXG4gICAgICBhbGxvd0h0bWwgPSAkX184LmFsbG93SHRtbDtcbiAgdmFyIHN0cmlwVGFnc0VhY2ggPSAoZnVuY3Rpb24oY2hvaWNlcykge1xuICAgIHJldHVybiBhcnJheU1hcChjaG9pY2VzLCAoZnVuY3Rpb24oY2hvaWNlKSB7XG4gICAgICByZXR1cm4gc3RyaXBUYWdzKGNob2ljZSk7XG4gICAgfSkpO1xuICB9KTtcbiAgaWYgKHR5cGVvZiBzb3VyY2UgPT0gJ2Z1bmN0aW9uJykge1xuICAgIHNvdXJjZS5jYWxsKHRoaXMuY2VsbFByb3BlcnRpZXMsIHF1ZXJ5LCAoZnVuY3Rpb24oY2hvaWNlcykge1xuICAgICAgJF9fNy51cGRhdGVDaG9pY2VzTGlzdChhbGxvd0h0bWwgPyBjaG9pY2VzIDogc3RyaXBUYWdzRWFjaChjaG9pY2VzKSk7XG4gICAgfSkpO1xuICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoc291cmNlKSkge1xuICAgIHRoaXMudXBkYXRlQ2hvaWNlc0xpc3QoYWxsb3dIdG1sID8gc291cmNlIDogc3RyaXBUYWdzRWFjaChzb3VyY2UpKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLnVwZGF0ZUNob2ljZXNMaXN0KFtdKTtcbiAgfVxufTtcbkF1dG9jb21wbGV0ZUVkaXRvci5wcm90b3R5cGUudXBkYXRlQ2hvaWNlc0xpc3QgPSBmdW5jdGlvbihjaG9pY2VzKSB7XG4gIHZhciBwb3MgPSBnZXRDYXJldFBvc2l0aW9uKHRoaXMuVEVYVEFSRUEpO1xuICB2YXIgZW5kUG9zID0gZ2V0U2VsZWN0aW9uRW5kUG9zaXRpb24odGhpcy5URVhUQVJFQSk7XG4gIHZhciBzb3J0QnlSZWxldmFuY2VTZXR0aW5nID0gdGhpcy5jZWxsUHJvcGVydGllcy5zb3J0QnlSZWxldmFuY2U7XG4gIHZhciBmaWx0ZXJTZXR0aW5nID0gdGhpcy5jZWxsUHJvcGVydGllcy5maWx0ZXI7XG4gIHZhciBvcmRlckJ5UmVsZXZhbmNlID0gbnVsbDtcbiAgdmFyIGhpZ2hsaWdodEluZGV4ID0gbnVsbDtcbiAgdmFyIGZsaXBwZWQgPSBudWxsO1xuICBpZiAoc29ydEJ5UmVsZXZhbmNlU2V0dGluZykge1xuICAgIG9yZGVyQnlSZWxldmFuY2UgPSBBdXRvY29tcGxldGVFZGl0b3Iuc29ydEJ5UmVsZXZhbmNlKHRoaXMuZ2V0VmFsdWUoKSwgY2hvaWNlcywgdGhpcy5jZWxsUHJvcGVydGllcy5maWx0ZXJpbmdDYXNlU2Vuc2l0aXZlKTtcbiAgfVxuICB2YXIgb3JkZXJCeVJlbGV2YW5jZUxlbmd0aCA9IEFycmF5LmlzQXJyYXkob3JkZXJCeVJlbGV2YW5jZSkgPyBvcmRlckJ5UmVsZXZhbmNlLmxlbmd0aCA6IDA7XG4gIGlmIChmaWx0ZXJTZXR0aW5nID09PSBmYWxzZSkge1xuICAgIGlmIChvcmRlckJ5UmVsZXZhbmNlTGVuZ3RoKSB7XG4gICAgICBoaWdobGlnaHRJbmRleCA9IG9yZGVyQnlSZWxldmFuY2VbMF07XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHZhciBzb3J0ZWQgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMCxcbiAgICAgICAgY2hvaWNlc0NvdW50ID0gY2hvaWNlcy5sZW5ndGg7IGkgPCBjaG9pY2VzQ291bnQ7IGkrKykge1xuICAgICAgaWYgKHNvcnRCeVJlbGV2YW5jZVNldHRpbmcgJiYgb3JkZXJCeVJlbGV2YW5jZUxlbmd0aCA8PSBpKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgaWYgKG9yZGVyQnlSZWxldmFuY2VMZW5ndGgpIHtcbiAgICAgICAgc29ydGVkLnB1c2goY2hvaWNlc1tvcmRlckJ5UmVsZXZhbmNlW2ldXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzb3J0ZWQucHVzaChjaG9pY2VzW2ldKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaGlnaGxpZ2h0SW5kZXggPSAwO1xuICAgIGNob2ljZXMgPSBzb3J0ZWQ7XG4gIH1cbiAgdGhpcy5jaG9pY2VzID0gY2hvaWNlcztcbiAgdGhpcy5odEVkaXRvci5sb2FkRGF0YShwaXZvdChbY2hvaWNlc10pKTtcbiAgdGhpcy51cGRhdGVEcm9wZG93bkhlaWdodCgpO1xuICB0aGlzLmZsaXBEcm9wZG93bklmTmVlZGVkKCk7XG4gIGlmICh0aGlzLmNlbGxQcm9wZXJ0aWVzLnN0cmljdCA9PT0gdHJ1ZSkge1xuICAgIHRoaXMuaGlnaGxpZ2h0QmVzdE1hdGNoaW5nQ2hvaWNlKGhpZ2hsaWdodEluZGV4KTtcbiAgfVxuICB0aGlzLmluc3RhbmNlLmxpc3RlbigpO1xuICB0aGlzLlRFWFRBUkVBLmZvY3VzKCk7XG4gIHNldENhcmV0UG9zaXRpb24odGhpcy5URVhUQVJFQSwgcG9zLCAocG9zID09PSBlbmRQb3MgPyB2b2lkIDAgOiBlbmRQb3MpKTtcbn07XG5BdXRvY29tcGxldGVFZGl0b3IucHJvdG90eXBlLmZsaXBEcm9wZG93bklmTmVlZGVkID0gZnVuY3Rpb24oKSB7XG4gIHZhciB0ZXh0YXJlYU9mZnNldCA9IG9mZnNldCh0aGlzLlRFWFRBUkVBKTtcbiAgdmFyIHRleHRhcmVhSGVpZ2h0ID0gb3V0ZXJIZWlnaHQodGhpcy5URVhUQVJFQSk7XG4gIHZhciBkcm9wZG93bkhlaWdodCA9IHRoaXMuZ2V0RHJvcGRvd25IZWlnaHQoKTtcbiAgdmFyIHRyaW1taW5nQ29udGFpbmVyID0gZ2V0VHJpbW1pbmdDb250YWluZXIodGhpcy5pbnN0YW5jZS52aWV3Lnd0Lnd0VGFibGUuVEFCTEUpO1xuICB2YXIgdHJpbW1pbmdDb250YWluZXJTY3JvbGxUb3AgPSB0cmltbWluZ0NvbnRhaW5lci5zY3JvbGxUb3A7XG4gIHZhciBoZWFkZXJzSGVpZ2h0ID0gb3V0ZXJIZWlnaHQodGhpcy5pbnN0YW5jZS52aWV3Lnd0Lnd0VGFibGUuVEhFQUQpO1xuICB2YXIgY29udGFpbmVyT2Zmc2V0ID0ge1xuICAgIHJvdzogMCxcbiAgICBjb2w6IDBcbiAgfTtcbiAgaWYgKHRyaW1taW5nQ29udGFpbmVyICE9PSB3aW5kb3cpIHtcbiAgICBjb250YWluZXJPZmZzZXQgPSBvZmZzZXQodHJpbW1pbmdDb250YWluZXIpO1xuICB9XG4gIHZhciBzcGFjZUFib3ZlID0gdGV4dGFyZWFPZmZzZXQudG9wIC0gY29udGFpbmVyT2Zmc2V0LnRvcCAtIGhlYWRlcnNIZWlnaHQgKyB0cmltbWluZ0NvbnRhaW5lclNjcm9sbFRvcDtcbiAgdmFyIHNwYWNlQmVsb3cgPSB0cmltbWluZ0NvbnRhaW5lci5zY3JvbGxIZWlnaHQgLSBzcGFjZUFib3ZlIC0gaGVhZGVyc0hlaWdodCAtIHRleHRhcmVhSGVpZ2h0O1xuICB2YXIgZmxpcE5lZWRlZCA9IGRyb3Bkb3duSGVpZ2h0ID4gc3BhY2VCZWxvdyAmJiBzcGFjZUFib3ZlID4gc3BhY2VCZWxvdztcbiAgaWYgKGZsaXBOZWVkZWQpIHtcbiAgICB0aGlzLmZsaXBEcm9wZG93bihkcm9wZG93bkhlaWdodCk7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy51bmZsaXBEcm9wZG93bigpO1xuICB9XG4gIHRoaXMubGltaXREcm9wZG93bklmTmVlZGVkKGZsaXBOZWVkZWQgPyBzcGFjZUFib3ZlIDogc3BhY2VCZWxvdywgZHJvcGRvd25IZWlnaHQpO1xuICByZXR1cm4gZmxpcE5lZWRlZDtcbn07XG5BdXRvY29tcGxldGVFZGl0b3IucHJvdG90eXBlLmxpbWl0RHJvcGRvd25JZk5lZWRlZCA9IGZ1bmN0aW9uKHNwYWNlQXZhaWxhYmxlLCBkcm9wZG93bkhlaWdodCkge1xuICBpZiAoZHJvcGRvd25IZWlnaHQgPiBzcGFjZUF2YWlsYWJsZSkge1xuICAgIHZhciB0ZW1wSGVpZ2h0ID0gMDtcbiAgICB2YXIgaSA9IDA7XG4gICAgdmFyIGxhc3RSb3dIZWlnaHQgPSAwO1xuICAgIHZhciBoZWlnaHQgPSBudWxsO1xuICAgIGRvIHtcbiAgICAgIGxhc3RSb3dIZWlnaHQgPSB0aGlzLmh0RWRpdG9yLmdldFJvd0hlaWdodChpKSB8fCB0aGlzLmh0RWRpdG9yLnZpZXcud3Qud3RTZXR0aW5ncy5zZXR0aW5ncy5kZWZhdWx0Um93SGVpZ2h0O1xuICAgICAgdGVtcEhlaWdodCArPSBsYXN0Um93SGVpZ2h0O1xuICAgICAgaSsrO1xuICAgIH0gd2hpbGUgKHRlbXBIZWlnaHQgPCBzcGFjZUF2YWlsYWJsZSk7XG4gICAgaGVpZ2h0ID0gdGVtcEhlaWdodCAtIGxhc3RSb3dIZWlnaHQ7XG4gICAgaWYgKHRoaXMuaHRFZGl0b3IuZmxpcHBlZCkge1xuICAgICAgdGhpcy5odEVkaXRvci5yb290RWxlbWVudC5zdHlsZS50b3AgPSBwYXJzZUludCh0aGlzLmh0RWRpdG9yLnJvb3RFbGVtZW50LnN0eWxlLnRvcCwgMTApICsgZHJvcGRvd25IZWlnaHQgLSBoZWlnaHQgKyAncHgnO1xuICAgIH1cbiAgICB0aGlzLnNldERyb3Bkb3duSGVpZ2h0KHRlbXBIZWlnaHQgLSBsYXN0Um93SGVpZ2h0KTtcbiAgfVxufTtcbkF1dG9jb21wbGV0ZUVkaXRvci5wcm90b3R5cGUuZmxpcERyb3Bkb3duID0gZnVuY3Rpb24oZHJvcGRvd25IZWlnaHQpIHtcbiAgdmFyIGRyb3Bkb3duU3R5bGUgPSB0aGlzLmh0RWRpdG9yLnJvb3RFbGVtZW50LnN0eWxlO1xuICBkcm9wZG93blN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgZHJvcGRvd25TdHlsZS50b3AgPSAtZHJvcGRvd25IZWlnaHQgKyAncHgnO1xuICB0aGlzLmh0RWRpdG9yLmZsaXBwZWQgPSB0cnVlO1xufTtcbkF1dG9jb21wbGV0ZUVkaXRvci5wcm90b3R5cGUudW5mbGlwRHJvcGRvd24gPSBmdW5jdGlvbigpIHtcbiAgdmFyIGRyb3Bkb3duU3R5bGUgPSB0aGlzLmh0RWRpdG9yLnJvb3RFbGVtZW50LnN0eWxlO1xuICBpZiAoZHJvcGRvd25TdHlsZS5wb3NpdGlvbiA9PT0gJ2Fic29sdXRlJykge1xuICAgIGRyb3Bkb3duU3R5bGUucG9zaXRpb24gPSAnJztcbiAgICBkcm9wZG93blN0eWxlLnRvcCA9ICcnO1xuICB9XG4gIHRoaXMuaHRFZGl0b3IuZmxpcHBlZCA9IHZvaWQgMDtcbn07XG5BdXRvY29tcGxldGVFZGl0b3IucHJvdG90eXBlLnVwZGF0ZURyb3Bkb3duSGVpZ2h0ID0gZnVuY3Rpb24oKSB7XG4gIHZhciBjdXJyZW50RHJvcGRvd25XaWR0aCA9IHRoaXMuaHRFZGl0b3IuZ2V0Q29sV2lkdGgoMCkgKyBnZXRTY3JvbGxiYXJXaWR0aCgpICsgMjtcbiAgdmFyIHRyaW1Ecm9wZG93biA9IHRoaXMuY2VsbFByb3BlcnRpZXMudHJpbURyb3Bkb3duO1xuICB0aGlzLmh0RWRpdG9yLnVwZGF0ZVNldHRpbmdzKHtcbiAgICBoZWlnaHQ6IHRoaXMuZ2V0RHJvcGRvd25IZWlnaHQoKSxcbiAgICB3aWR0aDogdHJpbURyb3Bkb3duID8gdm9pZCAwIDogY3VycmVudERyb3Bkb3duV2lkdGhcbiAgfSk7XG4gIHRoaXMuaHRFZGl0b3Iudmlldy53dC53dFRhYmxlLmFsaWduT3ZlcmxheXNXaXRoVHJpbW1pbmdDb250YWluZXIoKTtcbn07XG5BdXRvY29tcGxldGVFZGl0b3IucHJvdG90eXBlLnNldERyb3Bkb3duSGVpZ2h0ID0gZnVuY3Rpb24oaGVpZ2h0KSB7XG4gIHRoaXMuaHRFZGl0b3IudXBkYXRlU2V0dGluZ3Moe2hlaWdodDogaGVpZ2h0fSk7XG59O1xuQXV0b2NvbXBsZXRlRWRpdG9yLnByb3RvdHlwZS5maW5pc2hFZGl0aW5nID0gZnVuY3Rpb24ocmVzdG9yZU9yaWdpbmFsVmFsdWUpIHtcbiAgaWYgKCFyZXN0b3JlT3JpZ2luYWxWYWx1ZSkge1xuICAgIHRoaXMuaW5zdGFuY2UucmVtb3ZlSG9vaygnYmVmb3JlS2V5RG93bicsIG9uQmVmb3JlS2V5RG93bik7XG4gIH1cbiAgSGFuZHNvbnRhYmxlRWRpdG9yLnByb3RvdHlwZS5maW5pc2hFZGl0aW5nLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59O1xuQXV0b2NvbXBsZXRlRWRpdG9yLnByb3RvdHlwZS5oaWdobGlnaHRCZXN0TWF0Y2hpbmdDaG9pY2UgPSBmdW5jdGlvbihpbmRleCkge1xuICBpZiAodHlwZW9mIGluZGV4ID09PSAnbnVtYmVyJykge1xuICAgIHRoaXMuaHRFZGl0b3Iuc2VsZWN0Q2VsbChpbmRleCwgMCk7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5odEVkaXRvci5kZXNlbGVjdENlbGwoKTtcbiAgfVxufTtcbkF1dG9jb21wbGV0ZUVkaXRvci5zb3J0QnlSZWxldmFuY2UgPSBmdW5jdGlvbih2YWx1ZSwgY2hvaWNlcywgY2FzZVNlbnNpdGl2ZSkge1xuICB2YXIgY2hvaWNlc1JlbGV2YW5jZSA9IFtdO1xuICB2YXIgY3VycmVudEl0ZW07XG4gIHZhciB2YWx1ZUxlbmd0aCA9IHZhbHVlLmxlbmd0aDtcbiAgdmFyIHZhbHVlSW5kZXg7XG4gIHZhciBjaGFyc0xlZnQ7XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgdmFyIGk7XG4gIHZhciBjaG9pY2VzQ291bnQgPSBjaG9pY2VzLmxlbmd0aDtcbiAgaWYgKHZhbHVlTGVuZ3RoID09PSAwKSB7XG4gICAgZm9yIChpID0gMDsgaSA8IGNob2ljZXNDb3VudDsgaSsrKSB7XG4gICAgICByZXN1bHQucHVzaChpKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuICBmb3IgKGkgPSAwOyBpIDwgY2hvaWNlc0NvdW50OyBpKyspIHtcbiAgICBjdXJyZW50SXRlbSA9IHN0cmlwVGFncyhzdHJpbmdpZnkoY2hvaWNlc1tpXSkpO1xuICAgIGlmIChjYXNlU2Vuc2l0aXZlKSB7XG4gICAgICB2YWx1ZUluZGV4ID0gY3VycmVudEl0ZW0uaW5kZXhPZih2YWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbHVlSW5kZXggPSBjdXJyZW50SXRlbS50b0xvd2VyQ2FzZSgpLmluZGV4T2YodmFsdWUudG9Mb3dlckNhc2UoKSk7XG4gICAgfVxuICAgIGlmICh2YWx1ZUluZGV4ID09IC0xKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgY2hhcnNMZWZ0ID0gY3VycmVudEl0ZW0ubGVuZ3RoIC0gdmFsdWVJbmRleCAtIHZhbHVlTGVuZ3RoO1xuICAgIGNob2ljZXNSZWxldmFuY2UucHVzaCh7XG4gICAgICBiYXNlSW5kZXg6IGksXG4gICAgICBpbmRleDogdmFsdWVJbmRleCxcbiAgICAgIGNoYXJzTGVmdDogY2hhcnNMZWZ0LFxuICAgICAgdmFsdWU6IGN1cnJlbnRJdGVtXG4gICAgfSk7XG4gIH1cbiAgY2hvaWNlc1JlbGV2YW5jZS5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcbiAgICBpZiAoYi5pbmRleCA9PT0gLTEpIHtcbiAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgaWYgKGEuaW5kZXggPT09IC0xKSB7XG4gICAgICByZXR1cm4gMTtcbiAgICB9XG4gICAgaWYgKGEuaW5kZXggPCBiLmluZGV4KSB7XG4gICAgICByZXR1cm4gLTE7XG4gICAgfSBlbHNlIGlmIChiLmluZGV4IDwgYS5pbmRleCkge1xuICAgICAgcmV0dXJuIDE7XG4gICAgfSBlbHNlIGlmIChhLmluZGV4ID09PSBiLmluZGV4KSB7XG4gICAgICBpZiAoYS5jaGFyc0xlZnQgPCBiLmNoYXJzTGVmdCkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgICB9IGVsc2UgaWYgKGEuY2hhcnNMZWZ0ID4gYi5jaGFyc0xlZnQpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gMDtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICBmb3IgKGkgPSAwLCBjaG9pY2VzQ291bnQgPSBjaG9pY2VzUmVsZXZhbmNlLmxlbmd0aDsgaSA8IGNob2ljZXNDb3VudDsgaSsrKSB7XG4gICAgcmVzdWx0LnB1c2goY2hvaWNlc1JlbGV2YW5jZVtpXS5iYXNlSW5kZXgpO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xuQXV0b2NvbXBsZXRlRWRpdG9yLnByb3RvdHlwZS5nZXREcm9wZG93bkhlaWdodCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgZmlyc3RSb3dIZWlnaHQgPSB0aGlzLmh0RWRpdG9yLmdldEluc3RhbmNlKCkuZ2V0Um93SGVpZ2h0KDApIHx8IDIzO1xuICB2YXIgdmlzaWJsZVJvd3MgPSB0aGlzLmNlbGxQcm9wZXJ0aWVzLnZpc2libGVSb3dzO1xuICByZXR1cm4gdGhpcy5jaG9pY2VzLmxlbmd0aCA+PSB2aXNpYmxlUm93cyA/IHZpc2libGVSb3dzICogZmlyc3RSb3dIZWlnaHQgOiB0aGlzLmNob2ljZXMubGVuZ3RoICogZmlyc3RSb3dIZWlnaHQgKyA4O1xufTtcbkF1dG9jb21wbGV0ZUVkaXRvci5wcm90b3R5cGUuYWxsb3dLZXlFdmVudFByb3BhZ2F0aW9uID0gZnVuY3Rpb24oa2V5Q29kZSkge1xuICB2YXIgc2VsZWN0ZWQgPSB7cm93OiB0aGlzLmh0RWRpdG9yLmdldFNlbGVjdGVkUmFuZ2UoKSA/IHRoaXMuaHRFZGl0b3IuZ2V0U2VsZWN0ZWRSYW5nZSgpLmZyb20ucm93IDogLTF9O1xuICB2YXIgYWxsb3dlZCA9IGZhbHNlO1xuICBpZiAoa2V5Q29kZSA9PT0gS0VZX0NPREVTLkFSUk9XX0RPV04gJiYgc2VsZWN0ZWQucm93ID4gMCAmJiBzZWxlY3RlZC5yb3cgPCB0aGlzLmh0RWRpdG9yLmNvdW50Um93cygpIC0gMSkge1xuICAgIGFsbG93ZWQgPSB0cnVlO1xuICB9XG4gIGlmIChrZXlDb2RlID09PSBLRVlfQ09ERVMuQVJST1dfVVAgJiYgc2VsZWN0ZWQucm93ID4gLTEpIHtcbiAgICBhbGxvd2VkID0gdHJ1ZTtcbiAgfVxuICByZXR1cm4gYWxsb3dlZDtcbn07XG5BdXRvY29tcGxldGVFZGl0b3IucHJvdG90eXBlLmRpc2NhcmRFZGl0b3IgPSBmdW5jdGlvbihyZXN1bHQpIHtcbiAgSGFuZHNvbnRhYmxlRWRpdG9yLnByb3RvdHlwZS5kaXNjYXJkRWRpdG9yLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIHRoaXMuaW5zdGFuY2Uudmlldy5yZW5kZXIoKTtcbn07XG47XG5yZWdpc3RlckVkaXRvcignYXV0b2NvbXBsZXRlJywgQXV0b2NvbXBsZXRlRWRpdG9yKTtcblxuLy8jIFxufSx7XCJlZGl0b3JzXCI6MzAsXCJoYW5kc29udGFibGVFZGl0b3JcIjozNixcImhlbHBlcnMvYXJyYXlcIjo0MyxcImhlbHBlcnMvZG9tL2VsZW1lbnRcIjo0NyxcImhlbHBlcnMvbWl4ZWRcIjo1MSxcImhlbHBlcnMvc3RyaW5nXCI6NTUsXCJoZWxwZXJzL3VuaWNvZGVcIjo1Nn1dLDMzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBDaGVja2JveEVkaXRvcjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gQ2hlY2tib3hFZGl0b3I7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXyxcbiAgICAkX19fOTVfYmFzZUVkaXRvcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXztcbnZhciByZWdpc3RlckVkaXRvciA9ICgkX19fNDZfXzQ2X180N19lZGl0b3JzX18gPSBfZGVyZXFfKFwiZWRpdG9yc1wiKSwgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fICYmICRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19ffSkucmVnaXN0ZXJFZGl0b3I7XG52YXIgQmFzZUVkaXRvciA9ICgkX19fOTVfYmFzZUVkaXRvcl9fID0gX2RlcmVxXyhcIl9iYXNlRWRpdG9yXCIpLCAkX19fOTVfYmFzZUVkaXRvcl9fICYmICRfX185NV9iYXNlRWRpdG9yX18uX19lc01vZHVsZSAmJiAkX19fOTVfYmFzZUVkaXRvcl9fIHx8IHtkZWZhdWx0OiAkX19fOTVfYmFzZUVkaXRvcl9ffSkuQmFzZUVkaXRvcjtcbnZhciBoYXNDbGFzcyA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSkuaGFzQ2xhc3M7XG52YXIgQ2hlY2tib3hFZGl0b3IgPSBmdW5jdGlvbiBDaGVja2JveEVkaXRvcigpIHtcbiAgJHRyYWNldXJSdW50aW1lLnN1cGVyQ29uc3RydWN0b3IoJENoZWNrYm94RWRpdG9yKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufTtcbnZhciAkQ2hlY2tib3hFZGl0b3IgPSBDaGVja2JveEVkaXRvcjtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKENoZWNrYm94RWRpdG9yLCB7XG4gIGJlZ2luRWRpdGluZzogZnVuY3Rpb24oaW5pdGlhbFZhbHVlLCBldmVudCkge1xuICAgIGlmIChldmVudCA9PT0gdm9pZCAwKSB7XG4gICAgICB2YXIgY2hlY2tib3ggPSB0aGlzLlRELnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXScpO1xuICAgICAgaWYgKCFoYXNDbGFzcyhjaGVja2JveCwgJ2h0QmFkVmFsdWUnKSkge1xuICAgICAgICBjaGVja2JveC5jbGljaygpO1xuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgZmluaXNoRWRpdGluZzogZnVuY3Rpb24oKSB7fSxcbiAgaW5pdDogZnVuY3Rpb24oKSB7fSxcbiAgb3BlbjogZnVuY3Rpb24oKSB7fSxcbiAgY2xvc2U6IGZ1bmN0aW9uKCkge30sXG4gIGdldFZhbHVlOiBmdW5jdGlvbigpIHt9LFxuICBzZXRWYWx1ZTogZnVuY3Rpb24oKSB7fSxcbiAgZm9jdXM6IGZ1bmN0aW9uKCkge31cbn0sIHt9LCBCYXNlRWRpdG9yKTtcbjtcbnJlZ2lzdGVyRWRpdG9yKCdjaGVja2JveCcsIENoZWNrYm94RWRpdG9yKTtcblxuLy8jIFxufSx7XCJfYmFzZUVkaXRvclwiOjMxLFwiZWRpdG9yc1wiOjMwLFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3fV0sMzQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIERhdGVFZGl0b3I6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIERhdGVFZGl0b3I7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyxcbiAgICAkX19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19lZGl0b3JzX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfXyxcbiAgICAkX190ZXh0RWRpdG9yX18sXG4gICAgJF9fbW9tZW50X18sXG4gICAgJF9fcGlrYWRheV9fO1xudmFyIEhhbmRzb250YWJsZSA9ICgkX19fNDZfXzQ2X180N19icm93c2VyX18gPSBfZGVyZXFfKFwiYnJvd3NlclwiKSwgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9ffSkuZGVmYXVsdDtcbnZhciAkX18xID0gKCRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9lbGVtZW50XCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X199KSxcbiAgICBhZGRDbGFzcyA9ICRfXzEuYWRkQ2xhc3MsXG4gICAgb3V0ZXJIZWlnaHQgPSAkX18xLm91dGVySGVpZ2h0O1xudmFyIGRlZXBFeHRlbmQgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL29iamVjdFwiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfX30pLmRlZXBFeHRlbmQ7XG52YXIgRXZlbnRNYW5hZ2VyID0gKCRfX180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fID0gX2RlcmVxXyhcImV2ZW50TWFuYWdlclwiKSwgJF9fXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX199KS5FdmVudE1hbmFnZXI7XG52YXIgJF9fNCA9ICgkX19fNDZfXzQ2X180N19lZGl0b3JzX18gPSBfZGVyZXFfKFwiZWRpdG9yc1wiKSwgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fICYmICRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19ffSksXG4gICAgZ2V0RWRpdG9yID0gJF9fNC5nZXRFZGl0b3IsXG4gICAgcmVnaXN0ZXJFZGl0b3IgPSAkX180LnJlZ2lzdGVyRWRpdG9yO1xudmFyIGlzTWV0YUtleSA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL3VuaWNvZGVcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9ffSkuaXNNZXRhS2V5O1xudmFyIHN0b3BQcm9wYWdhdGlvbiA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2V2ZW50XCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9ffSkuc3RvcFByb3BhZ2F0aW9uO1xudmFyIFRleHRFZGl0b3IgPSAoJF9fdGV4dEVkaXRvcl9fID0gX2RlcmVxXyhcInRleHRFZGl0b3JcIiksICRfX3RleHRFZGl0b3JfXyAmJiAkX190ZXh0RWRpdG9yX18uX19lc01vZHVsZSAmJiAkX190ZXh0RWRpdG9yX18gfHwge2RlZmF1bHQ6ICRfX3RleHRFZGl0b3JfX30pLlRleHRFZGl0b3I7XG52YXIgbW9tZW50ID0gKCRfX21vbWVudF9fID0gX2RlcmVxXyhcIm1vbWVudFwiKSwgJF9fbW9tZW50X18gJiYgJF9fbW9tZW50X18uX19lc01vZHVsZSAmJiAkX19tb21lbnRfXyB8fCB7ZGVmYXVsdDogJF9fbW9tZW50X199KS5kZWZhdWx0O1xudmFyIFBpa2FkYXkgPSAoJF9fcGlrYWRheV9fID0gX2RlcmVxXyhcInBpa2FkYXlcIiksICRfX3Bpa2FkYXlfXyAmJiAkX19waWthZGF5X18uX19lc01vZHVsZSAmJiAkX19waWthZGF5X18gfHwge2RlZmF1bHQ6ICRfX3Bpa2FkYXlfX30pLmRlZmF1bHQ7XG52YXIgRGF0ZUVkaXRvciA9IGZ1bmN0aW9uIERhdGVFZGl0b3IoaG90SW5zdGFuY2UpIHtcbiAgdGhpcy4kZGF0ZVBpY2tlciA9IG51bGw7XG4gIHRoaXMuZGF0ZVBpY2tlciA9IG51bGw7XG4gIHRoaXMuZGF0ZVBpY2tlclN0eWxlID0gbnVsbDtcbiAgdGhpcy5kZWZhdWx0RGF0ZUZvcm1hdCA9ICdERC9NTS9ZWVlZJztcbiAgdGhpcy5pc0NlbGxFZGl0ZWQgPSBmYWxzZTtcbiAgdGhpcy5wYXJlbnREZXN0cm95ZWQgPSBmYWxzZTtcbiAgJHRyYWNldXJSdW50aW1lLnN1cGVyQ29uc3RydWN0b3IoJERhdGVFZGl0b3IpLmNhbGwodGhpcywgaG90SW5zdGFuY2UpO1xufTtcbnZhciAkRGF0ZUVkaXRvciA9IERhdGVFZGl0b3I7XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShEYXRlRWRpdG9yLCB7XG4gIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX18xMCA9IHRoaXM7XG4gICAgaWYgKHR5cGVvZiBtb21lbnQgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignWW91IG5lZWQgdG8gaW5jbHVkZSBtb21lbnQuanMgdG8geW91ciBwcm9qZWN0LicpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIFBpa2FkYXkgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignWW91IG5lZWQgdG8gaW5jbHVkZSBQaWthZGF5IHRvIHlvdXIgcHJvamVjdC4nKTtcbiAgICB9XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICREYXRlRWRpdG9yLnByb3RvdHlwZSwgXCJpbml0XCIpLmNhbGwodGhpcyk7XG4gICAgdGhpcy5pbnN0YW5jZS5hZGRIb29rKCdhZnRlckRlc3Ryb3knLCAoZnVuY3Rpb24oKSB7XG4gICAgICAkX18xMC5wYXJlbnREZXN0cm95ZWQgPSB0cnVlO1xuICAgICAgJF9fMTAuZGVzdHJveUVsZW1lbnRzKCk7XG4gICAgfSkpO1xuICB9LFxuICBjcmVhdGVFbGVtZW50czogZnVuY3Rpb24oKSB7XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICREYXRlRWRpdG9yLnByb3RvdHlwZSwgXCJjcmVhdGVFbGVtZW50c1wiKS5jYWxsKHRoaXMpO1xuICAgIHRoaXMuZGF0ZVBpY2tlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xuICAgIHRoaXMuZGF0ZVBpY2tlclN0eWxlID0gdGhpcy5kYXRlUGlja2VyLnN0eWxlO1xuICAgIHRoaXMuZGF0ZVBpY2tlclN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICB0aGlzLmRhdGVQaWNrZXJTdHlsZS50b3AgPSAwO1xuICAgIHRoaXMuZGF0ZVBpY2tlclN0eWxlLmxlZnQgPSAwO1xuICAgIHRoaXMuZGF0ZVBpY2tlclN0eWxlLnpJbmRleCA9IDk5OTk7XG4gICAgYWRkQ2xhc3ModGhpcy5kYXRlUGlja2VyLCAnaHREYXRlcGlja2VySG9sZGVyJyk7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLmRhdGVQaWNrZXIpO1xuICAgIHRoaXMuJGRhdGVQaWNrZXIgPSBuZXcgUGlrYWRheSh0aGlzLmdldERhdGVQaWNrZXJDb25maWcoKSk7XG4gICAgdmFyIGV2ZW50TWFuYWdlciA9IG5ldyBFdmVudE1hbmFnZXIodGhpcyk7XG4gICAgZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5kYXRlUGlja2VyLCAnbW91c2Vkb3duJywgKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICByZXR1cm4gc3RvcFByb3BhZ2F0aW9uKGV2ZW50KTtcbiAgICB9KSk7XG4gICAgdGhpcy5oaWRlRGF0ZXBpY2tlcigpO1xuICB9LFxuICBkZXN0cm95RWxlbWVudHM6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuJGRhdGVQaWNrZXIuZGVzdHJveSgpO1xuICB9LFxuICBwcmVwYXJlOiBmdW5jdGlvbihyb3csIGNvbCwgcHJvcCwgdGQsIG9yaWdpbmFsVmFsdWUsIGNlbGxQcm9wZXJ0aWVzKSB7XG4gICAgdGhpcy5fb3BlbmVkID0gZmFsc2U7XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICREYXRlRWRpdG9yLnByb3RvdHlwZSwgXCJwcmVwYXJlXCIpLmNhbGwodGhpcywgcm93LCBjb2wsIHByb3AsIHRkLCBvcmlnaW5hbFZhbHVlLCBjZWxsUHJvcGVydGllcyk7XG4gIH0sXG4gIG9wZW46IGZ1bmN0aW9uKCkge1xuICAgIHZhciBldmVudCA9IGFyZ3VtZW50c1swXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMF0gOiBudWxsO1xuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkRGF0ZUVkaXRvci5wcm90b3R5cGUsIFwib3BlblwiKS5jYWxsKHRoaXMpO1xuICAgIHRoaXMuc2hvd0RhdGVwaWNrZXIoZXZlbnQpO1xuICB9LFxuICBjbG9zZTogZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzEwID0gdGhpcztcbiAgICB0aGlzLl9vcGVuZWQgPSBmYWxzZTtcbiAgICB0aGlzLmluc3RhbmNlLl9yZWdpc3RlclRpbWVvdXQoc2V0VGltZW91dCgoZnVuY3Rpb24oKSB7XG4gICAgICAkX18xMC5pbnN0YW5jZS5zZWxlY3Rpb24ucmVmcmVzaEJvcmRlcnMoKTtcbiAgICB9KSwgMCkpO1xuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkRGF0ZUVkaXRvci5wcm90b3R5cGUsIFwiY2xvc2VcIikuY2FsbCh0aGlzKTtcbiAgfSxcbiAgZmluaXNoRWRpdGluZzogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGlzQ2FuY2VsbGVkID0gYXJndW1lbnRzWzBdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1swXSA6IGZhbHNlO1xuICAgIHZhciBjdHJsRG93biA9IGFyZ3VtZW50c1sxXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTtcbiAgICBpZiAoaXNDYW5jZWxsZWQpIHtcbiAgICAgIHZhciB2YWx1ZSA9IHRoaXMub3JpZ2luYWxWYWx1ZTtcbiAgICAgIGlmICh2YWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHRoaXMuc2V0VmFsdWUodmFsdWUpO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmhpZGVEYXRlcGlja2VyKCk7XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICREYXRlRWRpdG9yLnByb3RvdHlwZSwgXCJmaW5pc2hFZGl0aW5nXCIpLmNhbGwodGhpcywgaXNDYW5jZWxsZWQsIGN0cmxEb3duKTtcbiAgfSxcbiAgc2hvd0RhdGVwaWNrZXI6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdGhpcy4kZGF0ZVBpY2tlci5jb25maWcodGhpcy5nZXREYXRlUGlja2VyQ29uZmlnKCkpO1xuICAgIHZhciBvZmZzZXQgPSB0aGlzLlRELmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIHZhciBkYXRlRm9ybWF0ID0gdGhpcy5jZWxsUHJvcGVydGllcy5kYXRlRm9ybWF0IHx8IHRoaXMuZGVmYXVsdERhdGVGb3JtYXQ7XG4gICAgdmFyIGRhdGVQaWNrZXJDb25maWcgPSB0aGlzLiRkYXRlUGlja2VyLmNvbmZpZygpO1xuICAgIHZhciBkYXRlU3RyO1xuICAgIHZhciBpc01vdXNlRG93biA9IHRoaXMuaW5zdGFuY2Uudmlldy5pc01vdXNlRG93bigpO1xuICAgIHZhciBpc01ldGEgPSBldmVudCA/IGlzTWV0YUtleShldmVudC5rZXlDb2RlKSA6IGZhbHNlO1xuICAgIHRoaXMuZGF0ZVBpY2tlclN0eWxlLnRvcCA9ICh3aW5kb3cucGFnZVlPZmZzZXQgKyBvZmZzZXQudG9wICsgb3V0ZXJIZWlnaHQodGhpcy5URCkpICsgJ3B4JztcbiAgICB0aGlzLmRhdGVQaWNrZXJTdHlsZS5sZWZ0ID0gKHdpbmRvdy5wYWdlWE9mZnNldCArIG9mZnNldC5sZWZ0KSArICdweCc7XG4gICAgdGhpcy4kZGF0ZVBpY2tlci5fb25JbnB1dEZvY3VzID0gZnVuY3Rpb24oKSB7fTtcbiAgICBkYXRlUGlja2VyQ29uZmlnLmZvcm1hdCA9IGRhdGVGb3JtYXQ7XG4gICAgaWYgKHRoaXMub3JpZ2luYWxWYWx1ZSkge1xuICAgICAgZGF0ZVN0ciA9IHRoaXMub3JpZ2luYWxWYWx1ZTtcbiAgICAgIGlmIChtb21lbnQoZGF0ZVN0ciwgZGF0ZUZvcm1hdCwgdHJ1ZSkuaXNWYWxpZCgpKSB7XG4gICAgICAgIHRoaXMuJGRhdGVQaWNrZXIuc2V0TW9tZW50KG1vbWVudChkYXRlU3RyLCBkYXRlRm9ybWF0KSwgdHJ1ZSk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5nZXRWYWx1ZSgpICE9PSB0aGlzLm9yaWdpbmFsVmFsdWUpIHtcbiAgICAgICAgdGhpcy5zZXRWYWx1ZSh0aGlzLm9yaWdpbmFsVmFsdWUpO1xuICAgICAgfVxuICAgICAgaWYgKCFpc01ldGEgJiYgIWlzTW91c2VEb3duKSB7XG4gICAgICAgIHRoaXMuc2V0VmFsdWUoJycpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodGhpcy5jZWxsUHJvcGVydGllcy5kZWZhdWx0RGF0ZSkge1xuICAgICAgICBkYXRlU3RyID0gdGhpcy5jZWxsUHJvcGVydGllcy5kZWZhdWx0RGF0ZTtcbiAgICAgICAgZGF0ZVBpY2tlckNvbmZpZy5kZWZhdWx0RGF0ZSA9IGRhdGVTdHI7XG4gICAgICAgIGlmIChtb21lbnQoZGF0ZVN0ciwgZGF0ZUZvcm1hdCwgdHJ1ZSkuaXNWYWxpZCgpKSB7XG4gICAgICAgICAgdGhpcy4kZGF0ZVBpY2tlci5zZXRNb21lbnQobW9tZW50KGRhdGVTdHIsIGRhdGVGb3JtYXQpLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWlzTWV0YSAmJiAhaXNNb3VzZURvd24pIHtcbiAgICAgICAgICB0aGlzLnNldFZhbHVlKCcnKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy4kZGF0ZVBpY2tlci5nb3RvVG9kYXkoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5kYXRlUGlja2VyU3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgdGhpcy4kZGF0ZVBpY2tlci5zaG93KCk7XG4gIH0sXG4gIGhpZGVEYXRlcGlja2VyOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmRhdGVQaWNrZXJTdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIHRoaXMuJGRhdGVQaWNrZXIuaGlkZSgpO1xuICB9LFxuICBnZXREYXRlUGlja2VyQ29uZmlnOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fMTAgPSB0aGlzO1xuICAgIHZhciBodElucHV0ID0gdGhpcy5URVhUQVJFQTtcbiAgICB2YXIgb3B0aW9ucyA9IHt9O1xuICAgIGlmICh0aGlzLmNlbGxQcm9wZXJ0aWVzICYmIHRoaXMuY2VsbFByb3BlcnRpZXMuZGF0ZVBpY2tlckNvbmZpZykge1xuICAgICAgZGVlcEV4dGVuZChvcHRpb25zLCB0aGlzLmNlbGxQcm9wZXJ0aWVzLmRhdGVQaWNrZXJDb25maWcpO1xuICAgIH1cbiAgICB2YXIgb3JpZ09uU2VsZWN0ID0gb3B0aW9ucy5vblNlbGVjdDtcbiAgICB2YXIgb3JpZ09uQ2xvc2UgPSBvcHRpb25zLm9uQ2xvc2U7XG4gICAgb3B0aW9ucy5maWVsZCA9IGh0SW5wdXQ7XG4gICAgb3B0aW9ucy50cmlnZ2VyID0gaHRJbnB1dDtcbiAgICBvcHRpb25zLmNvbnRhaW5lciA9IHRoaXMuZGF0ZVBpY2tlcjtcbiAgICBvcHRpb25zLmJvdW5kID0gZmFsc2U7XG4gICAgb3B0aW9ucy5mb3JtYXQgPSBvcHRpb25zLmZvcm1hdCB8fCB0aGlzLmRlZmF1bHREYXRlRm9ybWF0O1xuICAgIG9wdGlvbnMucmVwb3NpdGlvbiA9IG9wdGlvbnMucmVwb3NpdGlvbiB8fCBmYWxzZTtcbiAgICBvcHRpb25zLm9uU2VsZWN0ID0gKGZ1bmN0aW9uKGRhdGVTdHIpIHtcbiAgICAgIGlmICghaXNOYU4oZGF0ZVN0ci5nZXRUaW1lKCkpKSB7XG4gICAgICAgIGRhdGVTdHIgPSBtb21lbnQoZGF0ZVN0cikuZm9ybWF0KCRfXzEwLmNlbGxQcm9wZXJ0aWVzLmRhdGVGb3JtYXQgfHwgJF9fMTAuZGVmYXVsdERhdGVGb3JtYXQpO1xuICAgICAgfVxuICAgICAgJF9fMTAuc2V0VmFsdWUoZGF0ZVN0cik7XG4gICAgICAkX18xMC5oaWRlRGF0ZXBpY2tlcigpO1xuICAgICAgaWYgKG9yaWdPblNlbGVjdCkge1xuICAgICAgICBvcmlnT25TZWxlY3QoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBvcHRpb25zLm9uQ2xvc2UgPSAoZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoISRfXzEwLnBhcmVudERlc3Ryb3llZCkge1xuICAgICAgICAkX18xMC5maW5pc2hFZGl0aW5nKGZhbHNlKTtcbiAgICAgIH1cbiAgICAgIGlmIChvcmlnT25DbG9zZSkge1xuICAgICAgICBvcmlnT25DbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBvcHRpb25zO1xuICB9XG59LCB7fSwgVGV4dEVkaXRvcik7XG47XG5IYW5kc29udGFibGUuZWRpdG9ycyA9IEhhbmRzb250YWJsZS5lZGl0b3JzIHx8IHt9O1xuSGFuZHNvbnRhYmxlLmVkaXRvcnMuRGF0ZUVkaXRvciA9IERhdGVFZGl0b3I7XG5yZWdpc3RlckVkaXRvcignZGF0ZScsIERhdGVFZGl0b3IpO1xuXG4vLyMgXG59LHtcImJyb3dzZXJcIjoyNCxcImVkaXRvcnNcIjozMCxcImV2ZW50TWFuYWdlclwiOjQyLFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwiaGVscGVycy9kb20vZXZlbnRcIjo0OCxcImhlbHBlcnMvb2JqZWN0XCI6NTMsXCJoZWxwZXJzL3VuaWNvZGVcIjo1NixcIm1vbWVudFwiOlwibW9tZW50XCIsXCJwaWthZGF5XCI6XCJwaWthZGF5XCIsXCJ0ZXh0RWRpdG9yXCI6NDF9XSwzNTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgRHJvcGRvd25FZGl0b3I6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIERyb3Bkb3duRWRpdG9yO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19icm93c2VyX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fLFxuICAgICRfX2F1dG9jb21wbGV0ZUVkaXRvcl9fO1xudmFyIEhhbmRzb250YWJsZSA9ICgkX19fNDZfXzQ2X180N19icm93c2VyX18gPSBfZGVyZXFfKFwiYnJvd3NlclwiKSwgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9ffSkuZGVmYXVsdDtcbnZhciAkX18xID0gKCRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXyA9IF9kZXJlcV8oXCJlZGl0b3JzXCIpLCAkX19fNDZfXzQ2X180N19lZGl0b3JzX18gJiYgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19lZGl0b3JzX199KSxcbiAgICBnZXRFZGl0b3IgPSAkX18xLmdldEVkaXRvcixcbiAgICByZWdpc3RlckVkaXRvciA9ICRfXzEucmVnaXN0ZXJFZGl0b3IsXG4gICAgZ2V0RWRpdG9yQ29uc3RydWN0b3IgPSAkX18xLmdldEVkaXRvckNvbnN0cnVjdG9yO1xudmFyIEF1dG9jb21wbGV0ZUVkaXRvciA9ICgkX19hdXRvY29tcGxldGVFZGl0b3JfXyA9IF9kZXJlcV8oXCJhdXRvY29tcGxldGVFZGl0b3JcIiksICRfX2F1dG9jb21wbGV0ZUVkaXRvcl9fICYmICRfX2F1dG9jb21wbGV0ZUVkaXRvcl9fLl9fZXNNb2R1bGUgJiYgJF9fYXV0b2NvbXBsZXRlRWRpdG9yX18gfHwge2RlZmF1bHQ6ICRfX2F1dG9jb21wbGV0ZUVkaXRvcl9ffSkuQXV0b2NvbXBsZXRlRWRpdG9yO1xudmFyIERyb3Bkb3duRWRpdG9yID0gZnVuY3Rpb24gRHJvcGRvd25FZGl0b3IoKSB7XG4gICR0cmFjZXVyUnVudGltZS5zdXBlckNvbnN0cnVjdG9yKCREcm9wZG93bkVkaXRvcikuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn07XG52YXIgJERyb3Bkb3duRWRpdG9yID0gRHJvcGRvd25FZGl0b3I7XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShEcm9wZG93bkVkaXRvciwge3ByZXBhcmU6IGZ1bmN0aW9uKHJvdywgY29sLCBwcm9wLCB0ZCwgb3JpZ2luYWxWYWx1ZSwgY2VsbFByb3BlcnRpZXMpIHtcbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJERyb3Bkb3duRWRpdG9yLnByb3RvdHlwZSwgXCJwcmVwYXJlXCIpLmNhbGwodGhpcywgcm93LCBjb2wsIHByb3AsIHRkLCBvcmlnaW5hbFZhbHVlLCBjZWxsUHJvcGVydGllcyk7XG4gICAgdGhpcy5jZWxsUHJvcGVydGllcy5maWx0ZXIgPSBmYWxzZTtcbiAgICB0aGlzLmNlbGxQcm9wZXJ0aWVzLnN0cmljdCA9IHRydWU7XG4gIH19LCB7fSwgQXV0b2NvbXBsZXRlRWRpdG9yKTtcbkhhbmRzb250YWJsZS5ob29rcy5hZGQoJ2JlZm9yZVZhbGlkYXRlJywgZnVuY3Rpb24odmFsdWUsIHJvdywgY29sLCBzb3VyY2UpIHtcbiAgdmFyIGNlbGxNZXRhID0gdGhpcy5nZXRDZWxsTWV0YShyb3csIHRoaXMucHJvcFRvQ29sKGNvbCkpO1xuICBpZiAoY2VsbE1ldGEuZWRpdG9yID09PSBIYW5kc29udGFibGUuZWRpdG9ycy5Ecm9wZG93bkVkaXRvcikge1xuICAgIGlmIChjZWxsTWV0YS5zdHJpY3QgPT09IHZvaWQgMCkge1xuICAgICAgY2VsbE1ldGEuZmlsdGVyID0gZmFsc2U7XG4gICAgICBjZWxsTWV0YS5zdHJpY3QgPSB0cnVlO1xuICAgIH1cbiAgfVxufSk7XG47XG5yZWdpc3RlckVkaXRvcignZHJvcGRvd24nLCBEcm9wZG93bkVkaXRvcik7XG5cbi8vIyBcbn0se1wiYXV0b2NvbXBsZXRlRWRpdG9yXCI6MzIsXCJicm93c2VyXCI6MjQsXCJlZGl0b3JzXCI6MzB9XSwzNjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgSGFuZHNvbnRhYmxlRWRpdG9yOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBIYW5kc29udGFibGVFZGl0b3I7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXyxcbiAgICAkX190ZXh0RWRpdG9yX187XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19fNDZfXzQ2X180N19icm93c2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19icm93c2VyX199KS5kZWZhdWx0O1xudmFyIEtFWV9DT0RFUyA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL3VuaWNvZGVcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9ffSkuS0VZX0NPREVTO1xudmFyIGV4dGVuZCA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fID0gX2RlcmVxXyhcImhlbHBlcnMvb2JqZWN0XCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9ffSkuZXh0ZW5kO1xudmFyIHNldENhcmV0UG9zaXRpb24gPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLnNldENhcmV0UG9zaXRpb247XG52YXIgJF9fNCA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2V2ZW50XCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9ffSksXG4gICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uID0gJF9fNC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24sXG4gICAgaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSAkX180LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkO1xudmFyICRfXzUgPSAoJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fID0gX2RlcmVxXyhcImVkaXRvcnNcIiksICRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXyAmJiAkX19fNDZfXzQ2X180N19lZGl0b3JzX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19lZGl0b3JzX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfX30pLFxuICAgIGdldEVkaXRvciA9ICRfXzUuZ2V0RWRpdG9yLFxuICAgIHJlZ2lzdGVyRWRpdG9yID0gJF9fNS5yZWdpc3RlckVkaXRvcjtcbnZhciBUZXh0RWRpdG9yID0gKCRfX3RleHRFZGl0b3JfXyA9IF9kZXJlcV8oXCJ0ZXh0RWRpdG9yXCIpLCAkX190ZXh0RWRpdG9yX18gJiYgJF9fdGV4dEVkaXRvcl9fLl9fZXNNb2R1bGUgJiYgJF9fdGV4dEVkaXRvcl9fIHx8IHtkZWZhdWx0OiAkX190ZXh0RWRpdG9yX199KS5UZXh0RWRpdG9yO1xudmFyIEhhbmRzb250YWJsZUVkaXRvciA9IFRleHRFZGl0b3IucHJvdG90eXBlLmV4dGVuZCgpO1xuSGFuZHNvbnRhYmxlRWRpdG9yLnByb3RvdHlwZS5jcmVhdGVFbGVtZW50cyA9IGZ1bmN0aW9uKCkge1xuICBUZXh0RWRpdG9yLnByb3RvdHlwZS5jcmVhdGVFbGVtZW50cy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB2YXIgRElWID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnRElWJyk7XG4gIERJVi5jbGFzc05hbWUgPSAnaGFuZHNvbnRhYmxlRWRpdG9yJztcbiAgdGhpcy5URVhUQVJFQV9QQVJFTlQuYXBwZW5kQ2hpbGQoRElWKTtcbiAgdGhpcy5odENvbnRhaW5lciA9IERJVjtcbiAgdGhpcy5hc3NpZ25Ib29rcygpO1xufTtcbkhhbmRzb250YWJsZUVkaXRvci5wcm90b3R5cGUucHJlcGFyZSA9IGZ1bmN0aW9uKHRkLCByb3csIGNvbCwgcHJvcCwgdmFsdWUsIGNlbGxQcm9wZXJ0aWVzKSB7XG4gIFRleHRFZGl0b3IucHJvdG90eXBlLnByZXBhcmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgdmFyIHBhcmVudCA9IHRoaXM7XG4gIHZhciBvcHRpb25zID0ge1xuICAgIHN0YXJ0Um93czogMCxcbiAgICBzdGFydENvbHM6IDAsXG4gICAgbWluUm93czogMCxcbiAgICBtaW5Db2xzOiAwLFxuICAgIGNsYXNzTmFtZTogJ2xpc3Rib3gnLFxuICAgIGNvcHlQYXN0ZTogZmFsc2UsXG4gICAgYXV0b0NvbHVtblNpemU6IGZhbHNlLFxuICAgIGF1dG9Sb3dTaXplOiBmYWxzZSxcbiAgICByZWFkT25seTogdHJ1ZSxcbiAgICBmaWxsSGFuZGxlOiBmYWxzZSxcbiAgICBhZnRlck9uQ2VsbE1vdXNlRG93bjogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgdmFsdWUgPSB0aGlzLmdldFZhbHVlKCk7XG4gICAgICBpZiAodmFsdWUgIT09IHZvaWQgMCkge1xuICAgICAgICBwYXJlbnQuc2V0VmFsdWUodmFsdWUpO1xuICAgICAgfVxuICAgICAgcGFyZW50Lmluc3RhbmNlLmRlc3Ryb3lFZGl0b3IoKTtcbiAgICB9XG4gIH07XG4gIGlmICh0aGlzLmNlbGxQcm9wZXJ0aWVzLmhhbmRzb250YWJsZSkge1xuICAgIGV4dGVuZChvcHRpb25zLCBjZWxsUHJvcGVydGllcy5oYW5kc29udGFibGUpO1xuICB9XG4gIHRoaXMuaHRPcHRpb25zID0gb3B0aW9ucztcbn07XG52YXIgb25CZWZvcmVLZXlEb3duID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgaWYgKGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKGV2ZW50KSkge1xuICAgIHJldHVybjtcbiAgfVxuICB2YXIgZWRpdG9yID0gdGhpcy5nZXRBY3RpdmVFZGl0b3IoKTtcbiAgdmFyIGlubmVySE9UID0gZWRpdG9yLmh0RWRpdG9yLmdldEluc3RhbmNlKCk7XG4gIHZhciByb3dUb1NlbGVjdDtcbiAgaWYgKGV2ZW50LmtleUNvZGUgPT0gS0VZX0NPREVTLkFSUk9XX0RPV04pIHtcbiAgICBpZiAoIWlubmVySE9ULmdldFNlbGVjdGVkKCkgJiYgIWlubmVySE9ULmZsaXBwZWQpIHtcbiAgICAgIHJvd1RvU2VsZWN0ID0gMDtcbiAgICB9IGVsc2UgaWYgKGlubmVySE9ULmdldFNlbGVjdGVkKCkpIHtcbiAgICAgIGlmIChpbm5lckhPVC5mbGlwcGVkKSB7XG4gICAgICAgIHJvd1RvU2VsZWN0ID0gaW5uZXJIT1QuZ2V0U2VsZWN0ZWQoKVswXSArIDE7XG4gICAgICB9IGVsc2UgaWYgKCFpbm5lckhPVC5mbGlwcGVkKSB7XG4gICAgICAgIHZhciBzZWxlY3RlZFJvdyA9IGlubmVySE9ULmdldFNlbGVjdGVkKClbMF07XG4gICAgICAgIHZhciBsYXN0Um93ID0gaW5uZXJIT1QuY291bnRSb3dzKCkgLSAxO1xuICAgICAgICByb3dUb1NlbGVjdCA9IE1hdGgubWluKGxhc3RSb3csIHNlbGVjdGVkUm93ICsgMSk7XG4gICAgICB9XG4gICAgfVxuICB9IGVsc2UgaWYgKGV2ZW50LmtleUNvZGUgPT0gS0VZX0NPREVTLkFSUk9XX1VQKSB7XG4gICAgaWYgKCFpbm5lckhPVC5nZXRTZWxlY3RlZCgpICYmIGlubmVySE9ULmZsaXBwZWQpIHtcbiAgICAgIHJvd1RvU2VsZWN0ID0gaW5uZXJIT1QuY291bnRSb3dzKCkgLSAxO1xuICAgIH0gZWxzZSBpZiAoaW5uZXJIT1QuZ2V0U2VsZWN0ZWQoKSkge1xuICAgICAgaWYgKGlubmVySE9ULmZsaXBwZWQpIHtcbiAgICAgICAgdmFyIHNlbGVjdGVkUm93ID0gaW5uZXJIT1QuZ2V0U2VsZWN0ZWQoKVswXTtcbiAgICAgICAgcm93VG9TZWxlY3QgPSBNYXRoLm1heCgwLCBzZWxlY3RlZFJvdyAtIDEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHNlbGVjdGVkUm93ID0gaW5uZXJIT1QuZ2V0U2VsZWN0ZWQoKVswXTtcbiAgICAgICAgcm93VG9TZWxlY3QgPSBzZWxlY3RlZFJvdyAtIDE7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGlmIChyb3dUb1NlbGVjdCAhPT0gdm9pZCAwKSB7XG4gICAgaWYgKHJvd1RvU2VsZWN0IDwgMCB8fCAoaW5uZXJIT1QuZmxpcHBlZCAmJiByb3dUb1NlbGVjdCA+IGlubmVySE9ULmNvdW50Um93cygpIC0gMSkpIHtcbiAgICAgIGlubmVySE9ULmRlc2VsZWN0Q2VsbCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbm5lckhPVC5zZWxlY3RDZWxsKHJvd1RvU2VsZWN0LCAwKTtcbiAgICB9XG4gICAgaWYgKGlubmVySE9ULmdldERhdGEoKS5sZW5ndGgpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oZXZlbnQpO1xuICAgICAgZWRpdG9yLmluc3RhbmNlLmxpc3RlbigpO1xuICAgICAgZWRpdG9yLlRFWFRBUkVBLmZvY3VzKCk7XG4gICAgfVxuICB9XG59O1xuSGFuZHNvbnRhYmxlRWRpdG9yLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuaW5zdGFuY2UuYWRkSG9vaygnYmVmb3JlS2V5RG93bicsIG9uQmVmb3JlS2V5RG93bik7XG4gIFRleHRFZGl0b3IucHJvdG90eXBlLm9wZW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgaWYgKHRoaXMuaHRFZGl0b3IpIHtcbiAgICB0aGlzLmh0RWRpdG9yLmRlc3Ryb3koKTtcbiAgfVxuICB0aGlzLmh0RWRpdG9yID0gbmV3IEhhbmRzb250YWJsZSh0aGlzLmh0Q29udGFpbmVyLCB0aGlzLmh0T3B0aW9ucyk7XG4gIGlmICh0aGlzLmNlbGxQcm9wZXJ0aWVzLnN0cmljdCkge1xuICAgIHRoaXMuaHRFZGl0b3Iuc2VsZWN0Q2VsbCgwLCAwKTtcbiAgICB0aGlzLlRFWFRBUkVBLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcbiAgfSBlbHNlIHtcbiAgICB0aGlzLmh0RWRpdG9yLmRlc2VsZWN0Q2VsbCgpO1xuICAgIHRoaXMuVEVYVEFSRUEuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJztcbiAgfVxuICBzZXRDYXJldFBvc2l0aW9uKHRoaXMuVEVYVEFSRUEsIDAsIHRoaXMuVEVYVEFSRUEudmFsdWUubGVuZ3RoKTtcbn07XG5IYW5kc29udGFibGVFZGl0b3IucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuaW5zdGFuY2UucmVtb3ZlSG9vaygnYmVmb3JlS2V5RG93bicsIG9uQmVmb3JlS2V5RG93bik7XG4gIHRoaXMuaW5zdGFuY2UubGlzdGVuKCk7XG4gIFRleHRFZGl0b3IucHJvdG90eXBlLmNsb3NlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59O1xuSGFuZHNvbnRhYmxlRWRpdG9yLnByb3RvdHlwZS5mb2N1cyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmluc3RhbmNlLmxpc3RlbigpO1xuICBUZXh0RWRpdG9yLnByb3RvdHlwZS5mb2N1cy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufTtcbkhhbmRzb250YWJsZUVkaXRvci5wcm90b3R5cGUuYmVnaW5FZGl0aW5nID0gZnVuY3Rpb24oaW5pdGlhbFZhbHVlKSB7XG4gIHZhciBvbkJlZ2luRWRpdGluZyA9IHRoaXMuaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5vbkJlZ2luRWRpdGluZztcbiAgaWYgKG9uQmVnaW5FZGl0aW5nICYmIG9uQmVnaW5FZGl0aW5nKCkgPT09IGZhbHNlKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIFRleHRFZGl0b3IucHJvdG90eXBlLmJlZ2luRWRpdGluZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufTtcbkhhbmRzb250YWJsZUVkaXRvci5wcm90b3R5cGUuZmluaXNoRWRpdGluZyA9IGZ1bmN0aW9uKGlzQ2FuY2VsbGVkLCBjdHJsRG93bikge1xuICBpZiAodGhpcy5odEVkaXRvciAmJiB0aGlzLmh0RWRpdG9yLmlzTGlzdGVuaW5nKCkpIHtcbiAgICB0aGlzLmluc3RhbmNlLmxpc3RlbigpO1xuICB9XG4gIGlmICh0aGlzLmh0RWRpdG9yICYmIHRoaXMuaHRFZGl0b3IuZ2V0U2VsZWN0ZWQoKSkge1xuICAgIHZhciB2YWx1ZSA9IHRoaXMuaHRFZGl0b3IuZ2V0SW5zdGFuY2UoKS5nZXRWYWx1ZSgpO1xuICAgIGlmICh2YWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICB0aGlzLnNldFZhbHVlKHZhbHVlKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIFRleHRFZGl0b3IucHJvdG90eXBlLmZpbmlzaEVkaXRpbmcuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn07XG5IYW5kc29udGFibGVFZGl0b3IucHJvdG90eXBlLmFzc2lnbkhvb2tzID0gZnVuY3Rpb24oKSB7XG4gIHZhciBfdGhpcyA9IHRoaXM7XG4gIHRoaXMuaW5zdGFuY2UuYWRkSG9vaygnYWZ0ZXJEZXN0cm95JywgZnVuY3Rpb24oKSB7XG4gICAgaWYgKF90aGlzLmh0RWRpdG9yKSB7XG4gICAgICBfdGhpcy5odEVkaXRvci5kZXN0cm95KCk7XG4gICAgfVxuICB9KTtcbn07XG47XG5yZWdpc3RlckVkaXRvcignaGFuZHNvbnRhYmxlJywgSGFuZHNvbnRhYmxlRWRpdG9yKTtcblxuLy8jIFxufSx7XCJicm93c2VyXCI6MjQsXCJlZGl0b3JzXCI6MzAsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJoZWxwZXJzL2RvbS9ldmVudFwiOjQ4LFwiaGVscGVycy9vYmplY3RcIjo1MyxcImhlbHBlcnMvdW5pY29kZVwiOjU2LFwidGV4dEVkaXRvclwiOjQxfV0sMzc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIE1vYmlsZVRleHRFZGl0b3I6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIE1vYmlsZVRleHRFZGl0b3I7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyxcbiAgICAkX19fNDZfXzQ2X180N19lZGl0b3JzX18sXG4gICAgJF9fXzk1X2Jhc2VFZGl0b3JfXyxcbiAgICAkX19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyAmJiAkX19fNDZfXzQ2X180N19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgS0VZX0NPREVTID0gKCRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9fID0gX2RlcmVxXyhcImhlbHBlcnMvdW5pY29kZVwiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX18gJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX199KS5LRVlfQ09ERVM7XG52YXIgJF9fMiA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2V2ZW50XCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9ffSksXG4gICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uID0gJF9fMi5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24sXG4gICAgaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSAkX18yLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkO1xudmFyICRfXzMgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLFxuICAgIGFkZENsYXNzID0gJF9fMy5hZGRDbGFzcyxcbiAgICBnZXRTY3JvbGxMZWZ0ID0gJF9fMy5nZXRTY3JvbGxMZWZ0LFxuICAgIGdldFNjcm9sbFRvcCA9ICRfXzMuZ2V0U2Nyb2xsVG9wLFxuICAgIGhhc0NsYXNzID0gJF9fMy5oYXNDbGFzcyxcbiAgICBpc0NoaWxkT2YgPSAkX18zLmlzQ2hpbGRPZixcbiAgICBvZmZzZXQgPSAkX18zLm9mZnNldCxcbiAgICBvdXRlckhlaWdodCA9ICRfXzMub3V0ZXJIZWlnaHQsXG4gICAgb3V0ZXJXaWR0aCA9ICRfXzMub3V0ZXJXaWR0aCxcbiAgICByZW1vdmVDbGFzcyA9ICRfXzMucmVtb3ZlQ2xhc3MsXG4gICAgc2V0Q2FyZXRQb3NpdGlvbiA9ICRfXzMuc2V0Q2FyZXRQb3NpdGlvbjtcbnZhciAkX180ID0gKCRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXyA9IF9kZXJlcV8oXCJlZGl0b3JzXCIpLCAkX19fNDZfXzQ2X180N19lZGl0b3JzX18gJiYgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19lZGl0b3JzX199KSxcbiAgICBnZXRFZGl0b3IgPSAkX180LmdldEVkaXRvcixcbiAgICByZWdpc3RlckVkaXRvciA9ICRfXzQucmVnaXN0ZXJFZGl0b3I7XG52YXIgQmFzZUVkaXRvciA9ICgkX19fOTVfYmFzZUVkaXRvcl9fID0gX2RlcmVxXyhcIl9iYXNlRWRpdG9yXCIpLCAkX19fOTVfYmFzZUVkaXRvcl9fICYmICRfX185NV9iYXNlRWRpdG9yX18uX19lc01vZHVsZSAmJiAkX19fOTVfYmFzZUVkaXRvcl9fIHx8IHtkZWZhdWx0OiAkX19fOTVfYmFzZUVkaXRvcl9ffSkuQmFzZUVkaXRvcjtcbnZhciBldmVudE1hbmFnZXJPYmplY3QgPSAoJF9fXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gPSBfZGVyZXFfKFwiZXZlbnRNYW5hZ2VyXCIpLCAkX19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyAmJiAkX19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfX30pLmV2ZW50TWFuYWdlcjtcbnZhciBNb2JpbGVUZXh0RWRpdG9yID0gQmFzZUVkaXRvci5wcm90b3R5cGUuZXh0ZW5kKCksXG4gICAgZG9tRGltZW5zaW9uc0NhY2hlID0ge307XG52YXIgY3JlYXRlQ29udHJvbHMgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5jb250cm9scyA9IHt9O1xuICB0aGlzLmNvbnRyb2xzLmxlZnRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKTtcbiAgdGhpcy5jb250cm9scy5sZWZ0QnV0dG9uLmNsYXNzTmFtZSA9ICdsZWZ0QnV0dG9uJztcbiAgdGhpcy5jb250cm9scy5yaWdodEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xuICB0aGlzLmNvbnRyb2xzLnJpZ2h0QnV0dG9uLmNsYXNzTmFtZSA9ICdyaWdodEJ1dHRvbic7XG4gIHRoaXMuY29udHJvbHMudXBCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKTtcbiAgdGhpcy5jb250cm9scy51cEJ1dHRvbi5jbGFzc05hbWUgPSAndXBCdXR0b24nO1xuICB0aGlzLmNvbnRyb2xzLmRvd25CdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKTtcbiAgdGhpcy5jb250cm9scy5kb3duQnV0dG9uLmNsYXNzTmFtZSA9ICdkb3duQnV0dG9uJztcbiAgZm9yICh2YXIgYnV0dG9uIGluIHRoaXMuY29udHJvbHMpIHtcbiAgICBpZiAodGhpcy5jb250cm9scy5oYXNPd25Qcm9wZXJ0eShidXR0b24pKSB7XG4gICAgICB0aGlzLnBvc2l0aW9uQ29udHJvbHMuYXBwZW5kQ2hpbGQodGhpcy5jb250cm9sc1tidXR0b25dKTtcbiAgICB9XG4gIH1cbn07XG5Nb2JpbGVUZXh0RWRpdG9yLnByb3RvdHlwZS52YWx1ZUNoYW5nZWQgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMuaW5pdFZhbHVlICE9IHRoaXMuZ2V0VmFsdWUoKTtcbn07XG5Nb2JpbGVUZXh0RWRpdG9yLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKSB7XG4gIHZhciB0aGF0ID0gdGhpcztcbiAgdGhpcy5ldmVudE1hbmFnZXIgPSBldmVudE1hbmFnZXJPYmplY3QodGhpcy5pbnN0YW5jZSk7XG4gIHRoaXMuY3JlYXRlRWxlbWVudHMoKTtcbiAgdGhpcy5iaW5kRXZlbnRzKCk7XG4gIHRoaXMuaW5zdGFuY2UuYWRkSG9vaygnYWZ0ZXJEZXN0cm95JywgZnVuY3Rpb24oKSB7XG4gICAgdGhhdC5kZXN0cm95KCk7XG4gIH0pO1xufTtcbk1vYmlsZVRleHRFZGl0b3IucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLlRFWFRBUkVBLnZhbHVlO1xufTtcbk1vYmlsZVRleHRFZGl0b3IucHJvdG90eXBlLnNldFZhbHVlID0gZnVuY3Rpb24obmV3VmFsdWUpIHtcbiAgdGhpcy5pbml0VmFsdWUgPSBuZXdWYWx1ZTtcbiAgdGhpcy5URVhUQVJFQS52YWx1ZSA9IG5ld1ZhbHVlO1xufTtcbk1vYmlsZVRleHRFZGl0b3IucHJvdG90eXBlLmNyZWF0ZUVsZW1lbnRzID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuZWRpdG9yQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnRElWJyk7XG4gIHRoaXMuZWRpdG9yQ29udGFpbmVyLmNsYXNzTmFtZSA9ICdodE1vYmlsZUVkaXRvckNvbnRhaW5lcic7XG4gIHRoaXMuY2VsbFBvaW50ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKTtcbiAgdGhpcy5jZWxsUG9pbnRlci5jbGFzc05hbWUgPSAnY2VsbFBvaW50ZXInO1xuICB0aGlzLm1vdmVIYW5kbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKTtcbiAgdGhpcy5tb3ZlSGFuZGxlLmNsYXNzTmFtZSA9ICdtb3ZlSGFuZGxlJztcbiAgdGhpcy5pbnB1dFBhbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKTtcbiAgdGhpcy5pbnB1dFBhbmUuY2xhc3NOYW1lID0gJ2lucHV0cyc7XG4gIHRoaXMucG9zaXRpb25Db250cm9scyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xuICB0aGlzLnBvc2l0aW9uQ29udHJvbHMuY2xhc3NOYW1lID0gJ3Bvc2l0aW9uQ29udHJvbHMnO1xuICB0aGlzLlRFWFRBUkVBID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnVEVYVEFSRUEnKTtcbiAgYWRkQ2xhc3ModGhpcy5URVhUQVJFQSwgJ2hhbmRzb250YWJsZUlucHV0Jyk7XG4gIHRoaXMuaW5wdXRQYW5lLmFwcGVuZENoaWxkKHRoaXMuVEVYVEFSRUEpO1xuICB0aGlzLmVkaXRvckNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmNlbGxQb2ludGVyKTtcbiAgdGhpcy5lZGl0b3JDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5tb3ZlSGFuZGxlKTtcbiAgdGhpcy5lZGl0b3JDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5pbnB1dFBhbmUpO1xuICB0aGlzLmVkaXRvckNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLnBvc2l0aW9uQ29udHJvbHMpO1xuICBjcmVhdGVDb250cm9scy5jYWxsKHRoaXMpO1xuICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuZWRpdG9yQ29udGFpbmVyKTtcbn07XG5Nb2JpbGVUZXh0RWRpdG9yLnByb3RvdHlwZS5vbkJlZm9yZUtleURvd24gPSBmdW5jdGlvbihldmVudCkge1xuICB2YXIgaW5zdGFuY2UgPSB0aGlzO1xuICB2YXIgdGhhdCA9IGluc3RhbmNlLmdldEFjdGl2ZUVkaXRvcigpO1xuICBpZiAoZXZlbnQudGFyZ2V0ICE9PSB0aGF0LlRFWFRBUkVBIHx8IGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKGV2ZW50KSkge1xuICAgIHJldHVybjtcbiAgfVxuICBzd2l0Y2ggKGV2ZW50LmtleUNvZGUpIHtcbiAgICBjYXNlIEtFWV9DT0RFUy5FTlRFUjpcbiAgICAgIHRoYXQuY2xvc2UoKTtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIEtFWV9DT0RFUy5CQUNLU1BBQ0U6XG4gICAgICBzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oZXZlbnQpO1xuICAgICAgYnJlYWs7XG4gIH1cbn07XG5Nb2JpbGVUZXh0RWRpdG9yLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuaW5zdGFuY2UuYWRkSG9vaygnYmVmb3JlS2V5RG93bicsIHRoaXMub25CZWZvcmVLZXlEb3duKTtcbiAgYWRkQ2xhc3ModGhpcy5lZGl0b3JDb250YWluZXIsICdhY3RpdmUnKTtcbiAgcmVtb3ZlQ2xhc3ModGhpcy5jZWxsUG9pbnRlciwgJ2hpZGRlbicpO1xuICB0aGlzLnVwZGF0ZUVkaXRvclBvc2l0aW9uKCk7XG59O1xuTW9iaWxlVGV4dEVkaXRvci5wcm90b3R5cGUuZm9jdXMgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5URVhUQVJFQS5mb2N1cygpO1xuICBzZXRDYXJldFBvc2l0aW9uKHRoaXMuVEVYVEFSRUEsIHRoaXMuVEVYVEFSRUEudmFsdWUubGVuZ3RoKTtcbn07XG5Nb2JpbGVUZXh0RWRpdG9yLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLlRFWFRBUkVBLmJsdXIoKTtcbiAgdGhpcy5pbnN0YW5jZS5yZW1vdmVIb29rKCdiZWZvcmVLZXlEb3duJywgdGhpcy5vbkJlZm9yZUtleURvd24pO1xuICByZW1vdmVDbGFzcyh0aGlzLmVkaXRvckNvbnRhaW5lciwgJ2FjdGl2ZScpO1xufTtcbk1vYmlsZVRleHRFZGl0b3IucHJvdG90eXBlLnNjcm9sbFRvVmlldyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgY29vcmRzID0gdGhpcy5pbnN0YW5jZS5nZXRTZWxlY3RlZFJhbmdlKCkuaGlnaGxpZ2h0O1xuICB0aGlzLmluc3RhbmNlLnZpZXcuc2Nyb2xsVmlld3BvcnQoY29vcmRzKTtcbn07XG5Nb2JpbGVUZXh0RWRpdG9yLnByb3RvdHlwZS5oaWRlQ2VsbFBvaW50ZXIgPSBmdW5jdGlvbigpIHtcbiAgaWYgKCFoYXNDbGFzcyh0aGlzLmNlbGxQb2ludGVyLCAnaGlkZGVuJykpIHtcbiAgICBhZGRDbGFzcyh0aGlzLmNlbGxQb2ludGVyLCAnaGlkZGVuJyk7XG4gIH1cbn07XG5Nb2JpbGVUZXh0RWRpdG9yLnByb3RvdHlwZS51cGRhdGVFZGl0b3JQb3NpdGlvbiA9IGZ1bmN0aW9uKHgsIHkpIHtcbiAgaWYgKHggJiYgeSkge1xuICAgIHggPSBwYXJzZUludCh4LCAxMCk7XG4gICAgeSA9IHBhcnNlSW50KHksIDEwKTtcbiAgICB0aGlzLmVkaXRvckNvbnRhaW5lci5zdHlsZS50b3AgPSB5ICsgJ3B4JztcbiAgICB0aGlzLmVkaXRvckNvbnRhaW5lci5zdHlsZS5sZWZ0ID0geCArICdweCc7XG4gIH0gZWxzZSB7XG4gICAgdmFyIHNlbGVjdGlvbiA9IHRoaXMuaW5zdGFuY2UuZ2V0U2VsZWN0ZWQoKSxcbiAgICAgICAgc2VsZWN0ZWRDZWxsID0gdGhpcy5pbnN0YW5jZS5nZXRDZWxsKHNlbGVjdGlvblswXSwgc2VsZWN0aW9uWzFdKTtcbiAgICBpZiAoIWRvbURpbWVuc2lvbnNDYWNoZS5jZWxsUG9pbnRlcikge1xuICAgICAgZG9tRGltZW5zaW9uc0NhY2hlLmNlbGxQb2ludGVyID0ge1xuICAgICAgICBoZWlnaHQ6IG91dGVySGVpZ2h0KHRoaXMuY2VsbFBvaW50ZXIpLFxuICAgICAgICB3aWR0aDogb3V0ZXJXaWR0aCh0aGlzLmNlbGxQb2ludGVyKVxuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKCFkb21EaW1lbnNpb25zQ2FjaGUuZWRpdG9yQ29udGFpbmVyKSB7XG4gICAgICBkb21EaW1lbnNpb25zQ2FjaGUuZWRpdG9yQ29udGFpbmVyID0ge3dpZHRoOiBvdXRlcldpZHRoKHRoaXMuZWRpdG9yQ29udGFpbmVyKX07XG4gICAgfVxuICAgIGlmIChzZWxlY3RlZENlbGwgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdmFyIHNjcm9sbExlZnQgPSB0aGlzLmluc3RhbmNlLnZpZXcud3Qud3RPdmVybGF5cy5sZWZ0T3ZlcmxheS50cmltbWluZ0NvbnRhaW5lciA9PSB3aW5kb3cgPyAwIDogZ2V0U2Nyb2xsTGVmdCh0aGlzLmluc3RhbmNlLnZpZXcud3Qud3RPdmVybGF5cy5sZWZ0T3ZlcmxheS5ob2xkZXIpO1xuICAgICAgdmFyIHNjcm9sbFRvcCA9IHRoaXMuaW5zdGFuY2Uudmlldy53dC53dE92ZXJsYXlzLnRvcE92ZXJsYXkudHJpbW1pbmdDb250YWluZXIgPT0gd2luZG93ID8gMCA6IGdldFNjcm9sbFRvcCh0aGlzLmluc3RhbmNlLnZpZXcud3Qud3RPdmVybGF5cy50b3BPdmVybGF5LmhvbGRlcik7XG4gICAgICB2YXIgc2VsZWN0ZWRDZWxsT2Zmc2V0ID0gb2Zmc2V0KHNlbGVjdGVkQ2VsbCksXG4gICAgICAgICAgc2VsZWN0ZWRDZWxsV2lkdGggPSBvdXRlcldpZHRoKHNlbGVjdGVkQ2VsbCksXG4gICAgICAgICAgY3VycmVudFNjcm9sbFBvc2l0aW9uID0ge1xuICAgICAgICAgICAgeDogc2Nyb2xsTGVmdCxcbiAgICAgICAgICAgIHk6IHNjcm9sbFRvcFxuICAgICAgICAgIH07XG4gICAgICB0aGlzLmVkaXRvckNvbnRhaW5lci5zdHlsZS50b3AgPSBwYXJzZUludChzZWxlY3RlZENlbGxPZmZzZXQudG9wICsgb3V0ZXJIZWlnaHQoc2VsZWN0ZWRDZWxsKSAtIGN1cnJlbnRTY3JvbGxQb3NpdGlvbi55ICsgZG9tRGltZW5zaW9uc0NhY2hlLmNlbGxQb2ludGVyLmhlaWdodCwgMTApICsgJ3B4JztcbiAgICAgIHRoaXMuZWRpdG9yQ29udGFpbmVyLnN0eWxlLmxlZnQgPSBwYXJzZUludCgod2luZG93LmlubmVyV2lkdGggLyAyKSAtIChkb21EaW1lbnNpb25zQ2FjaGUuZWRpdG9yQ29udGFpbmVyLndpZHRoIC8gMiksIDEwKSArICdweCc7XG4gICAgICBpZiAoc2VsZWN0ZWRDZWxsT2Zmc2V0LmxlZnQgKyBzZWxlY3RlZENlbGxXaWR0aCAvIDIgPiBwYXJzZUludCh0aGlzLmVkaXRvckNvbnRhaW5lci5zdHlsZS5sZWZ0LCAxMCkgKyBkb21EaW1lbnNpb25zQ2FjaGUuZWRpdG9yQ29udGFpbmVyLndpZHRoKSB7XG4gICAgICAgIHRoaXMuZWRpdG9yQ29udGFpbmVyLnN0eWxlLmxlZnQgPSB3aW5kb3cuaW5uZXJXaWR0aCAtIGRvbURpbWVuc2lvbnNDYWNoZS5lZGl0b3JDb250YWluZXIud2lkdGggKyAncHgnO1xuICAgICAgfSBlbHNlIGlmIChzZWxlY3RlZENlbGxPZmZzZXQubGVmdCArIHNlbGVjdGVkQ2VsbFdpZHRoIC8gMiA8IHBhcnNlSW50KHRoaXMuZWRpdG9yQ29udGFpbmVyLnN0eWxlLmxlZnQsIDEwKSArIDIwKSB7XG4gICAgICAgIHRoaXMuZWRpdG9yQ29udGFpbmVyLnN0eWxlLmxlZnQgPSAwICsgJ3B4JztcbiAgICAgIH1cbiAgICAgIHRoaXMuY2VsbFBvaW50ZXIuc3R5bGUubGVmdCA9IHBhcnNlSW50KHNlbGVjdGVkQ2VsbE9mZnNldC5sZWZ0IC0gKGRvbURpbWVuc2lvbnNDYWNoZS5jZWxsUG9pbnRlci53aWR0aCAvIDIpIC0gb2Zmc2V0KHRoaXMuZWRpdG9yQ29udGFpbmVyKS5sZWZ0ICsgKHNlbGVjdGVkQ2VsbFdpZHRoIC8gMikgLSBjdXJyZW50U2Nyb2xsUG9zaXRpb24ueCwgMTApICsgJ3B4JztcbiAgICB9XG4gIH1cbn07XG5Nb2JpbGVUZXh0RWRpdG9yLnByb3RvdHlwZS51cGRhdGVFZGl0b3JEYXRhID0gZnVuY3Rpb24oKSB7XG4gIHZhciBzZWxlY3RlZCA9IHRoaXMuaW5zdGFuY2UuZ2V0U2VsZWN0ZWQoKSxcbiAgICAgIHNlbGVjdGVkVmFsdWUgPSB0aGlzLmluc3RhbmNlLmdldERhdGFBdENlbGwoc2VsZWN0ZWRbMF0sIHNlbGVjdGVkWzFdKTtcbiAgdGhpcy5yb3cgPSBzZWxlY3RlZFswXTtcbiAgdGhpcy5jb2wgPSBzZWxlY3RlZFsxXTtcbiAgdGhpcy5zZXRWYWx1ZShzZWxlY3RlZFZhbHVlKTtcbiAgdGhpcy51cGRhdGVFZGl0b3JQb3NpdGlvbigpO1xufTtcbk1vYmlsZVRleHRFZGl0b3IucHJvdG90eXBlLnByZXBhcmVBbmRTYXZlID0gZnVuY3Rpb24oKSB7XG4gIHZhciB2YWw7XG4gIGlmICghdGhpcy52YWx1ZUNoYW5nZWQoKSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGlmICh0aGlzLmluc3RhbmNlLmdldFNldHRpbmdzKCkudHJpbVdoaXRlc3BhY2UpIHtcbiAgICB2YWwgPSBbW1N0cmluZy5wcm90b3R5cGUudHJpbS5jYWxsKHRoaXMuZ2V0VmFsdWUoKSldXTtcbiAgfSBlbHNlIHtcbiAgICB2YWwgPSBbW3RoaXMuZ2V0VmFsdWUoKV1dO1xuICB9XG4gIHRoaXMuc2F2ZVZhbHVlKHZhbCk7XG59O1xuTW9iaWxlVGV4dEVkaXRvci5wcm90b3R5cGUuYmluZEV2ZW50cyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgdGhhdCA9IHRoaXM7XG4gIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5jb250cm9scy5sZWZ0QnV0dG9uLCAndG91Y2hlbmQnLCBmdW5jdGlvbihldmVudCkge1xuICAgIHRoYXQucHJlcGFyZUFuZFNhdmUoKTtcbiAgICB0aGF0Lmluc3RhbmNlLnNlbGVjdGlvbi50cmFuc2Zvcm1TdGFydCgwLCAtMSwgbnVsbCwgdHJ1ZSk7XG4gICAgdGhhdC51cGRhdGVFZGl0b3JEYXRhKCk7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgfSk7XG4gIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5jb250cm9scy5yaWdodEJ1dHRvbiwgJ3RvdWNoZW5kJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB0aGF0LnByZXBhcmVBbmRTYXZlKCk7XG4gICAgdGhhdC5pbnN0YW5jZS5zZWxlY3Rpb24udHJhbnNmb3JtU3RhcnQoMCwgMSwgbnVsbCwgdHJ1ZSk7XG4gICAgdGhhdC51cGRhdGVFZGl0b3JEYXRhKCk7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgfSk7XG4gIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5jb250cm9scy51cEJ1dHRvbiwgJ3RvdWNoZW5kJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB0aGF0LnByZXBhcmVBbmRTYXZlKCk7XG4gICAgdGhhdC5pbnN0YW5jZS5zZWxlY3Rpb24udHJhbnNmb3JtU3RhcnQoLTEsIDAsIG51bGwsIHRydWUpO1xuICAgIHRoYXQudXBkYXRlRWRpdG9yRGF0YSgpO1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIH0pO1xuICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKHRoaXMuY29udHJvbHMuZG93bkJ1dHRvbiwgJ3RvdWNoZW5kJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB0aGF0LnByZXBhcmVBbmRTYXZlKCk7XG4gICAgdGhhdC5pbnN0YW5jZS5zZWxlY3Rpb24udHJhbnNmb3JtU3RhcnQoMSwgMCwgbnVsbCwgdHJ1ZSk7XG4gICAgdGhhdC51cGRhdGVFZGl0b3JEYXRhKCk7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgfSk7XG4gIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5tb3ZlSGFuZGxlLCAndG91Y2hzdGFydCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LnRvdWNoZXMubGVuZ3RoID09IDEpIHtcbiAgICAgIHZhciB0b3VjaCA9IGV2ZW50LnRvdWNoZXNbMF0sXG4gICAgICAgICAgb25Ub3VjaFBvc2l0aW9uID0ge1xuICAgICAgICAgICAgeDogdGhhdC5lZGl0b3JDb250YWluZXIub2Zmc2V0TGVmdCxcbiAgICAgICAgICAgIHk6IHRoYXQuZWRpdG9yQ29udGFpbmVyLm9mZnNldFRvcFxuICAgICAgICAgIH0sXG4gICAgICAgICAgb25Ub3VjaE9mZnNldCA9IHtcbiAgICAgICAgICAgIHg6IHRvdWNoLnBhZ2VYIC0gb25Ub3VjaFBvc2l0aW9uLngsXG4gICAgICAgICAgICB5OiB0b3VjaC5wYWdlWSAtIG9uVG91Y2hQb3NpdGlvbi55XG4gICAgICAgICAgfTtcbiAgICAgIHRoYXQuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGhpcywgJ3RvdWNobW92ZScsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIHZhciB0b3VjaCA9IGV2ZW50LnRvdWNoZXNbMF07XG4gICAgICAgIHRoYXQudXBkYXRlRWRpdG9yUG9zaXRpb24odG91Y2gucGFnZVggLSBvblRvdWNoT2Zmc2V0LngsIHRvdWNoLnBhZ2VZIC0gb25Ub3VjaE9mZnNldC55KTtcbiAgICAgICAgdGhhdC5oaWRlQ2VsbFBvaW50ZXIoKTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG4gIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQuYm9keSwgJ3RvdWNoZW5kJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAoIWlzQ2hpbGRPZihldmVudC50YXJnZXQsIHRoYXQuZWRpdG9yQ29udGFpbmVyKSAmJiAhaXNDaGlsZE9mKGV2ZW50LnRhcmdldCwgdGhhdC5pbnN0YW5jZS5yb290RWxlbWVudCkpIHtcbiAgICAgIHRoYXQuY2xvc2UoKTtcbiAgICB9XG4gIH0pO1xuICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKHRoaXMuaW5zdGFuY2Uudmlldy53dC53dE92ZXJsYXlzLmxlZnRPdmVybGF5LmhvbGRlciwgJ3Njcm9sbCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKHRoYXQuaW5zdGFuY2Uudmlldy53dC53dE92ZXJsYXlzLmxlZnRPdmVybGF5LnRyaW1taW5nQ29udGFpbmVyICE9IHdpbmRvdykge1xuICAgICAgdGhhdC5oaWRlQ2VsbFBvaW50ZXIoKTtcbiAgICB9XG4gIH0pO1xuICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKHRoaXMuaW5zdGFuY2Uudmlldy53dC53dE92ZXJsYXlzLnRvcE92ZXJsYXkuaG9sZGVyLCAnc2Nyb2xsJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAodGhhdC5pbnN0YW5jZS52aWV3Lnd0Lnd0T3ZlcmxheXMudG9wT3ZlcmxheS50cmltbWluZ0NvbnRhaW5lciAhPSB3aW5kb3cpIHtcbiAgICAgIHRoYXQuaGlkZUNlbGxQb2ludGVyKCk7XG4gICAgfVxuICB9KTtcbn07XG5Nb2JpbGVUZXh0RWRpdG9yLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuZXZlbnRNYW5hZ2VyLmNsZWFyKCk7XG4gIHRoaXMuZWRpdG9yQ29udGFpbmVyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5lZGl0b3JDb250YWluZXIpO1xufTtcbjtcbnJlZ2lzdGVyRWRpdG9yKCdtb2JpbGUnLCBNb2JpbGVUZXh0RWRpdG9yKTtcblxuLy8jIFxufSx7XCJfYmFzZUVkaXRvclwiOjMxLFwiYnJvd3NlclwiOjI0LFwiZWRpdG9yc1wiOjMwLFwiZXZlbnRNYW5hZ2VyXCI6NDIsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJoZWxwZXJzL2RvbS9ldmVudFwiOjQ4LFwiaGVscGVycy91bmljb2RlXCI6NTZ9XSwzODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgTnVtZXJpY0VkaXRvcjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gTnVtZXJpY0VkaXRvcjtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fbnVtYnJvX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fLFxuICAgICRfX3RleHRFZGl0b3JfXztcbnZhciBudW1icm8gPSAoJF9fbnVtYnJvX18gPSBfZGVyZXFfKFwibnVtYnJvXCIpLCAkX19udW1icm9fXyAmJiAkX19udW1icm9fXy5fX2VzTW9kdWxlICYmICRfX251bWJyb19fIHx8IHtkZWZhdWx0OiAkX19udW1icm9fX30pLmRlZmF1bHQ7XG52YXIgcmVnaXN0ZXJFZGl0b3IgPSAoJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fID0gX2RlcmVxXyhcImVkaXRvcnNcIiksICRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXyAmJiAkX19fNDZfXzQ2X180N19lZGl0b3JzX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19lZGl0b3JzX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfX30pLnJlZ2lzdGVyRWRpdG9yO1xudmFyIFRleHRFZGl0b3IgPSAoJF9fdGV4dEVkaXRvcl9fID0gX2RlcmVxXyhcInRleHRFZGl0b3JcIiksICRfX3RleHRFZGl0b3JfXyAmJiAkX190ZXh0RWRpdG9yX18uX19lc01vZHVsZSAmJiAkX190ZXh0RWRpdG9yX18gfHwge2RlZmF1bHQ6ICRfX3RleHRFZGl0b3JfX30pLlRleHRFZGl0b3I7XG52YXIgTnVtZXJpY0VkaXRvciA9IGZ1bmN0aW9uIE51bWVyaWNFZGl0b3IoKSB7XG4gICR0cmFjZXVyUnVudGltZS5zdXBlckNvbnN0cnVjdG9yKCROdW1lcmljRWRpdG9yKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufTtcbnZhciAkTnVtZXJpY0VkaXRvciA9IE51bWVyaWNFZGl0b3I7XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShOdW1lcmljRWRpdG9yLCB7YmVnaW5FZGl0aW5nOiBmdW5jdGlvbihpbml0aWFsVmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIGluaXRpYWxWYWx1ZSA9PT0gJ3VuZGVmaW5lZCcgJiYgdGhpcy5vcmlnaW5hbFZhbHVlKSB7XG4gICAgICBpZiAodHlwZW9mIHRoaXMuY2VsbFByb3BlcnRpZXMubGFuZ3VhZ2UgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIG51bWJyby5jdWx0dXJlKHRoaXMuY2VsbFByb3BlcnRpZXMubGFuZ3VhZ2UpO1xuICAgICAgfVxuICAgICAgdmFyIGRlY2ltYWxEZWxpbWl0ZXIgPSBudW1icm8uY3VsdHVyZURhdGEoKS5kZWxpbWl0ZXJzLmRlY2ltYWw7XG4gICAgICBpbml0aWFsVmFsdWUgPSAoJycgKyB0aGlzLm9yaWdpbmFsVmFsdWUpLnJlcGxhY2UoJy4nLCBkZWNpbWFsRGVsaW1pdGVyKTtcbiAgICB9XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICROdW1lcmljRWRpdG9yLnByb3RvdHlwZSwgXCJiZWdpbkVkaXRpbmdcIikuY2FsbCh0aGlzLCBpbml0aWFsVmFsdWUpO1xuICB9fSwge30sIFRleHRFZGl0b3IpO1xuO1xucmVnaXN0ZXJFZGl0b3IoJ251bWVyaWMnLCBOdW1lcmljRWRpdG9yKTtcblxuLy8jIFxufSx7XCJlZGl0b3JzXCI6MzAsXCJudW1icm9cIjpcIm51bWJyb1wiLFwidGV4dEVkaXRvclwiOjQxfV0sMzk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIFBhc3N3b3JkRWRpdG9yOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBQYXNzd29yZEVkaXRvcjtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyxcbiAgICAkX19fNDZfXzQ2X180N19lZGl0b3JzX18sXG4gICAgJF9fdGV4dEVkaXRvcl9fO1xudmFyIEhhbmRzb250YWJsZSA9ICgkX19fNDZfXzQ2X180N19icm93c2VyX18gPSBfZGVyZXFfKFwiYnJvd3NlclwiKSwgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9ffSkuZGVmYXVsdDtcbnZhciBlbXB0eSA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSkuZW1wdHk7XG52YXIgJF9fMiA9ICgkX19fNDZfXzQ2X180N19lZGl0b3JzX18gPSBfZGVyZXFfKFwiZWRpdG9yc1wiKSwgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fICYmICRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19ffSksXG4gICAgZ2V0RWRpdG9yID0gJF9fMi5nZXRFZGl0b3IsXG4gICAgcmVnaXN0ZXJFZGl0b3IgPSAkX18yLnJlZ2lzdGVyRWRpdG9yO1xudmFyIFRleHRFZGl0b3IgPSAoJF9fdGV4dEVkaXRvcl9fID0gX2RlcmVxXyhcInRleHRFZGl0b3JcIiksICRfX3RleHRFZGl0b3JfXyAmJiAkX190ZXh0RWRpdG9yX18uX19lc01vZHVsZSAmJiAkX190ZXh0RWRpdG9yX18gfHwge2RlZmF1bHQ6ICRfX3RleHRFZGl0b3JfX30pLlRleHRFZGl0b3I7XG52YXIgUGFzc3dvcmRFZGl0b3IgPSBmdW5jdGlvbiBQYXNzd29yZEVkaXRvcigpIHtcbiAgJHRyYWNldXJSdW50aW1lLnN1cGVyQ29uc3RydWN0b3IoJFBhc3N3b3JkRWRpdG9yKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufTtcbnZhciAkUGFzc3dvcmRFZGl0b3IgPSBQYXNzd29yZEVkaXRvcjtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKFBhc3N3b3JkRWRpdG9yLCB7Y3JlYXRlRWxlbWVudHM6IGZ1bmN0aW9uKCkge1xuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkUGFzc3dvcmRFZGl0b3IucHJvdG90eXBlLCBcImNyZWF0ZUVsZW1lbnRzXCIpLmNhbGwodGhpcyk7XG4gICAgdGhpcy5URVhUQVJFQSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgdGhpcy5URVhUQVJFQS5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAncGFzc3dvcmQnKTtcbiAgICB0aGlzLlRFWFRBUkVBLmNsYXNzTmFtZSA9ICdoYW5kc29udGFibGVJbnB1dCc7XG4gICAgdGhpcy50ZXh0YXJlYVN0eWxlID0gdGhpcy5URVhUQVJFQS5zdHlsZTtcbiAgICB0aGlzLnRleHRhcmVhU3R5bGUud2lkdGggPSAwO1xuICAgIHRoaXMudGV4dGFyZWFTdHlsZS5oZWlnaHQgPSAwO1xuICAgIGVtcHR5KHRoaXMuVEVYVEFSRUFfUEFSRU5UKTtcbiAgICB0aGlzLlRFWFRBUkVBX1BBUkVOVC5hcHBlbmRDaGlsZCh0aGlzLlRFWFRBUkVBKTtcbiAgfX0sIHt9LCBUZXh0RWRpdG9yKTtcbjtcbnJlZ2lzdGVyRWRpdG9yKCdwYXNzd29yZCcsIFBhc3N3b3JkRWRpdG9yKTtcblxuLy8jIFxufSx7XCJicm93c2VyXCI6MjQsXCJlZGl0b3JzXCI6MzAsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJ0ZXh0RWRpdG9yXCI6NDF9XSw0MDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgU2VsZWN0RWRpdG9yOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBTZWxlY3RFZGl0b3I7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXyxcbiAgICAkX19fNDZfXzQ2X180N19lZGl0b3JzX18sXG4gICAgJF9fXzk1X2Jhc2VFZGl0b3JfXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyAmJiAkX19fNDZfXzQ2X180N19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgJF9fMSA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSksXG4gICAgYWRkQ2xhc3MgPSAkX18xLmFkZENsYXNzLFxuICAgIGVtcHR5ID0gJF9fMS5lbXB0eSxcbiAgICBmYXN0SW5uZXJIVE1MID0gJF9fMS5mYXN0SW5uZXJIVE1MLFxuICAgIGdldENvbXB1dGVkU3R5bGUgPSAkX18xLmdldENvbXB1dGVkU3R5bGUsXG4gICAgZ2V0Q3NzVHJhbnNmb3JtID0gJF9fMS5nZXRDc3NUcmFuc2Zvcm0sXG4gICAgZ2V0U2Nyb2xsYWJsZUVsZW1lbnQgPSAkX18xLmdldFNjcm9sbGFibGVFbGVtZW50LFxuICAgIG9mZnNldCA9ICRfXzEub2Zmc2V0LFxuICAgIG91dGVySGVpZ2h0ID0gJF9fMS5vdXRlckhlaWdodCxcbiAgICBvdXRlcldpZHRoID0gJF9fMS5vdXRlcldpZHRoLFxuICAgIHJlc2V0Q3NzVHJhbnNmb3JtID0gJF9fMS5yZXNldENzc1RyYW5zZm9ybTtcbnZhciBzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24gPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9ldmVudFwiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfX30pLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbjtcbnZhciBLRVlfQ09ERVMgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX18gPSBfZGVyZXFfKFwiaGVscGVycy91bmljb2RlXCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfX30pLktFWV9DT0RFUztcbnZhciAkX180ID0gKCRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXyA9IF9kZXJlcV8oXCJlZGl0b3JzXCIpLCAkX19fNDZfXzQ2X180N19lZGl0b3JzX18gJiYgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19lZGl0b3JzX199KSxcbiAgICBnZXRFZGl0b3IgPSAkX180LmdldEVkaXRvcixcbiAgICByZWdpc3RlckVkaXRvciA9ICRfXzQucmVnaXN0ZXJFZGl0b3I7XG52YXIgQmFzZUVkaXRvciA9ICgkX19fOTVfYmFzZUVkaXRvcl9fID0gX2RlcmVxXyhcIl9iYXNlRWRpdG9yXCIpLCAkX19fOTVfYmFzZUVkaXRvcl9fICYmICRfX185NV9iYXNlRWRpdG9yX18uX19lc01vZHVsZSAmJiAkX19fOTVfYmFzZUVkaXRvcl9fIHx8IHtkZWZhdWx0OiAkX19fOTVfYmFzZUVkaXRvcl9ffSkuQmFzZUVkaXRvcjtcbnZhciBTZWxlY3RFZGl0b3IgPSBCYXNlRWRpdG9yLnByb3RvdHlwZS5leHRlbmQoKTtcblNlbGVjdEVkaXRvci5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnNlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ1NFTEVDVCcpO1xuICBhZGRDbGFzcyh0aGlzLnNlbGVjdCwgJ2h0U2VsZWN0RWRpdG9yJyk7XG4gIHRoaXMuc2VsZWN0LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gIHRoaXMuaW5zdGFuY2Uucm9vdEVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5zZWxlY3QpO1xuICB0aGlzLnJlZ2lzdGVySG9va3MoKTtcbn07XG5TZWxlY3RFZGl0b3IucHJvdG90eXBlLnJlZ2lzdGVySG9va3MgPSBmdW5jdGlvbigpIHtcbiAgdmFyICRfXzYgPSB0aGlzO1xuICB0aGlzLmluc3RhbmNlLmFkZEhvb2soJ2FmdGVyU2Nyb2xsSG9yaXpvbnRhbGx5JywgKGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAkX182LnJlZnJlc2hEaW1lbnNpb25zKCk7XG4gIH0pKTtcbiAgdGhpcy5pbnN0YW5jZS5hZGRIb29rKCdhZnRlclNjcm9sbFZlcnRpY2FsbHknLCAoZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuICRfXzYucmVmcmVzaERpbWVuc2lvbnMoKTtcbiAgfSkpO1xuICB0aGlzLmluc3RhbmNlLmFkZEhvb2soJ2FmdGVyQ29sdW1uUmVzaXplJywgKGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAkX182LnJlZnJlc2hEaW1lbnNpb25zKCk7XG4gIH0pKTtcbiAgdGhpcy5pbnN0YW5jZS5hZGRIb29rKCdhZnRlclJvd1Jlc2l6ZScsIChmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJF9fNi5yZWZyZXNoRGltZW5zaW9ucygpO1xuICB9KSk7XG59O1xuU2VsZWN0RWRpdG9yLnByb3RvdHlwZS5wcmVwYXJlID0gZnVuY3Rpb24oKSB7XG4gIEJhc2VFZGl0b3IucHJvdG90eXBlLnByZXBhcmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgdmFyIHNlbGVjdE9wdGlvbnMgPSB0aGlzLmNlbGxQcm9wZXJ0aWVzLnNlbGVjdE9wdGlvbnM7XG4gIHZhciBvcHRpb25zO1xuICBpZiAodHlwZW9mIHNlbGVjdE9wdGlvbnMgPT0gJ2Z1bmN0aW9uJykge1xuICAgIG9wdGlvbnMgPSB0aGlzLnByZXBhcmVPcHRpb25zKHNlbGVjdE9wdGlvbnModGhpcy5yb3csIHRoaXMuY29sLCB0aGlzLnByb3ApKTtcbiAgfSBlbHNlIHtcbiAgICBvcHRpb25zID0gdGhpcy5wcmVwYXJlT3B0aW9ucyhzZWxlY3RPcHRpb25zKTtcbiAgfVxuICBlbXB0eSh0aGlzLnNlbGVjdCk7XG4gIGZvciAodmFyIG9wdGlvbiBpbiBvcHRpb25zKSB7XG4gICAgaWYgKG9wdGlvbnMuaGFzT3duUHJvcGVydHkob3B0aW9uKSkge1xuICAgICAgdmFyIG9wdGlvbkVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdPUFRJT04nKTtcbiAgICAgIG9wdGlvbkVsZW1lbnQudmFsdWUgPSBvcHRpb247XG4gICAgICBmYXN0SW5uZXJIVE1MKG9wdGlvbkVsZW1lbnQsIG9wdGlvbnNbb3B0aW9uXSk7XG4gICAgICB0aGlzLnNlbGVjdC5hcHBlbmRDaGlsZChvcHRpb25FbGVtZW50KTtcbiAgICB9XG4gIH1cbn07XG5TZWxlY3RFZGl0b3IucHJvdG90eXBlLnByZXBhcmVPcHRpb25zID0gZnVuY3Rpb24ob3B0aW9uc1RvUHJlcGFyZSkge1xuICB2YXIgcHJlcGFyZWRPcHRpb25zID0ge307XG4gIGlmIChBcnJheS5pc0FycmF5KG9wdGlvbnNUb1ByZXBhcmUpKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsXG4gICAgICAgIGxlbiA9IG9wdGlvbnNUb1ByZXBhcmUubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIHByZXBhcmVkT3B0aW9uc1tvcHRpb25zVG9QcmVwYXJlW2ldXSA9IG9wdGlvbnNUb1ByZXBhcmVbaV07XG4gICAgfVxuICB9IGVsc2UgaWYgKHR5cGVvZiBvcHRpb25zVG9QcmVwYXJlID09ICdvYmplY3QnKSB7XG4gICAgcHJlcGFyZWRPcHRpb25zID0gb3B0aW9uc1RvUHJlcGFyZTtcbiAgfVxuICByZXR1cm4gcHJlcGFyZWRPcHRpb25zO1xufTtcblNlbGVjdEVkaXRvci5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMuc2VsZWN0LnZhbHVlO1xufTtcblNlbGVjdEVkaXRvci5wcm90b3R5cGUuc2V0VmFsdWUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICB0aGlzLnNlbGVjdC52YWx1ZSA9IHZhbHVlO1xufTtcbnZhciBvbkJlZm9yZUtleURvd24gPSBmdW5jdGlvbihldmVudCkge1xuICB2YXIgaW5zdGFuY2UgPSB0aGlzO1xuICB2YXIgZWRpdG9yID0gaW5zdGFuY2UuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gIHN3aXRjaCAoZXZlbnQua2V5Q29kZSkge1xuICAgIGNhc2UgS0VZX0NPREVTLkFSUk9XX1VQOlxuICAgICAgdmFyIHByZXZpb3VzT3B0aW9uSW5kZXggPSBlZGl0b3Iuc2VsZWN0LnNlbGVjdGVkSW5kZXggLSAxO1xuICAgICAgaWYgKHByZXZpb3VzT3B0aW9uSW5kZXggPj0gMCkge1xuICAgICAgICBlZGl0b3Iuc2VsZWN0W3ByZXZpb3VzT3B0aW9uSW5kZXhdLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbihldmVudCk7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBLRVlfQ09ERVMuQVJST1dfRE9XTjpcbiAgICAgIHZhciBuZXh0T3B0aW9uSW5kZXggPSBlZGl0b3Iuc2VsZWN0LnNlbGVjdGVkSW5kZXggKyAxO1xuICAgICAgaWYgKG5leHRPcHRpb25JbmRleCA8PSBlZGl0b3Iuc2VsZWN0Lmxlbmd0aCAtIDEpIHtcbiAgICAgICAgZWRpdG9yLnNlbGVjdFtuZXh0T3B0aW9uSW5kZXhdLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbihldmVudCk7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgYnJlYWs7XG4gIH1cbn07XG5TZWxlY3RFZGl0b3IucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5fb3BlbmVkID0gdHJ1ZTtcbiAgdGhpcy5yZWZyZXNoRGltZW5zaW9ucygpO1xuICB0aGlzLnNlbGVjdC5zdHlsZS5kaXNwbGF5ID0gJyc7XG4gIHRoaXMuaW5zdGFuY2UuYWRkSG9vaygnYmVmb3JlS2V5RG93bicsIG9uQmVmb3JlS2V5RG93bik7XG59O1xuU2VsZWN0RWRpdG9yLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLl9vcGVuZWQgPSBmYWxzZTtcbiAgdGhpcy5zZWxlY3Quc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgdGhpcy5pbnN0YW5jZS5yZW1vdmVIb29rKCdiZWZvcmVLZXlEb3duJywgb25CZWZvcmVLZXlEb3duKTtcbn07XG5TZWxlY3RFZGl0b3IucHJvdG90eXBlLmZvY3VzID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuc2VsZWN0LmZvY3VzKCk7XG59O1xuU2VsZWN0RWRpdG9yLnByb3RvdHlwZS5yZWZyZXNoVmFsdWUgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHNvdXJjZURhdGEgPSB0aGlzLmluc3RhbmNlLmdldFNvdXJjZURhdGFBdENlbGwodGhpcy5yb3csIHRoaXMucHJvcCk7XG4gIHRoaXMub3JpZ2luYWxWYWx1ZSA9IHNvdXJjZURhdGE7XG4gIHRoaXMuc2V0VmFsdWUoc291cmNlRGF0YSk7XG4gIHRoaXMucmVmcmVzaERpbWVuc2lvbnMoKTtcbn07XG5TZWxlY3RFZGl0b3IucHJvdG90eXBlLnJlZnJlc2hEaW1lbnNpb25zID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0aGlzLnN0YXRlICE9PSBIYW5kc29udGFibGUuRWRpdG9yU3RhdGUuRURJVElORykge1xuICAgIHJldHVybjtcbiAgfVxuICB0aGlzLlREID0gdGhpcy5nZXRFZGl0ZWRDZWxsKCk7XG4gIGlmICghdGhpcy5URCkge1xuICAgIHRoaXMuY2xvc2UoKTtcbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIHdpZHRoID0gb3V0ZXJXaWR0aCh0aGlzLlREKSArIDEsXG4gICAgICBoZWlnaHQgPSBvdXRlckhlaWdodCh0aGlzLlREKSArIDEsXG4gICAgICBjdXJyZW50T2Zmc2V0ID0gb2Zmc2V0KHRoaXMuVEQpLFxuICAgICAgY29udGFpbmVyT2Zmc2V0ID0gb2Zmc2V0KHRoaXMuaW5zdGFuY2Uucm9vdEVsZW1lbnQpLFxuICAgICAgc2Nyb2xsYWJsZUNvbnRhaW5lciA9IGdldFNjcm9sbGFibGVFbGVtZW50KHRoaXMuVEQpLFxuICAgICAgZWRpdFRvcCA9IGN1cnJlbnRPZmZzZXQudG9wIC0gY29udGFpbmVyT2Zmc2V0LnRvcCAtIDEgLSAoc2Nyb2xsYWJsZUNvbnRhaW5lci5zY3JvbGxUb3AgfHwgMCksXG4gICAgICBlZGl0TGVmdCA9IGN1cnJlbnRPZmZzZXQubGVmdCAtIGNvbnRhaW5lck9mZnNldC5sZWZ0IC0gMSAtIChzY3JvbGxhYmxlQ29udGFpbmVyLnNjcm9sbExlZnQgfHwgMCksXG4gICAgICBlZGl0b3JTZWN0aW9uID0gdGhpcy5jaGVja0VkaXRvclNlY3Rpb24oKSxcbiAgICAgIGNzc1RyYW5zZm9ybU9mZnNldDtcbiAgdmFyIHNldHRpbmdzID0gdGhpcy5pbnN0YW5jZS5nZXRTZXR0aW5ncygpO1xuICB2YXIgcm93SGVhZGVyc0NvdW50ID0gc2V0dGluZ3Mucm93SGVhZGVycyA/IDEgOiAwO1xuICB2YXIgY29sSGVhZGVyc0NvdW50ID0gc2V0dGluZ3MuY29sSGVhZGVycyA/IDEgOiAwO1xuICBzd2l0Y2ggKGVkaXRvclNlY3Rpb24pIHtcbiAgICBjYXNlICd0b3AnOlxuICAgICAgY3NzVHJhbnNmb3JtT2Zmc2V0ID0gZ2V0Q3NzVHJhbnNmb3JtKHRoaXMuaW5zdGFuY2Uudmlldy53dC53dE92ZXJsYXlzLnRvcE92ZXJsYXkuY2xvbmUud3RUYWJsZS5ob2xkZXIucGFyZW50Tm9kZSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdsZWZ0JzpcbiAgICAgIGNzc1RyYW5zZm9ybU9mZnNldCA9IGdldENzc1RyYW5zZm9ybSh0aGlzLmluc3RhbmNlLnZpZXcud3Qud3RPdmVybGF5cy5sZWZ0T3ZlcmxheS5jbG9uZS53dFRhYmxlLmhvbGRlci5wYXJlbnROb2RlKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ3RvcC1sZWZ0LWNvcm5lcic6XG4gICAgICBjc3NUcmFuc2Zvcm1PZmZzZXQgPSBnZXRDc3NUcmFuc2Zvcm0odGhpcy5pbnN0YW5jZS52aWV3Lnd0Lnd0T3ZlcmxheXMudG9wTGVmdENvcm5lck92ZXJsYXkuY2xvbmUud3RUYWJsZS5ob2xkZXIucGFyZW50Tm9kZSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdib3R0b20tbGVmdC1jb3JuZXInOlxuICAgICAgY3NzVHJhbnNmb3JtT2Zmc2V0ID0gZ2V0Q3NzVHJhbnNmb3JtKHRoaXMuaW5zdGFuY2Uudmlldy53dC53dE92ZXJsYXlzLmJvdHRvbUxlZnRDb3JuZXJPdmVybGF5LmNsb25lLnd0VGFibGUuaG9sZGVyLnBhcmVudE5vZGUpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnYm90dG9tJzpcbiAgICAgIGNzc1RyYW5zZm9ybU9mZnNldCA9IGdldENzc1RyYW5zZm9ybSh0aGlzLmluc3RhbmNlLnZpZXcud3Qud3RPdmVybGF5cy5ib3R0b21PdmVybGF5LmNsb25lLnd0VGFibGUuaG9sZGVyLnBhcmVudE5vZGUpO1xuICAgICAgYnJlYWs7XG4gIH1cbiAgaWYgKHRoaXMuaW5zdGFuY2UuZ2V0U2VsZWN0ZWQoKVswXSA9PT0gMCkge1xuICAgIGVkaXRUb3AgKz0gMTtcbiAgfVxuICBpZiAodGhpcy5pbnN0YW5jZS5nZXRTZWxlY3RlZCgpWzFdID09PSAwKSB7XG4gICAgZWRpdExlZnQgKz0gMTtcbiAgfVxuICB2YXIgc2VsZWN0U3R5bGUgPSB0aGlzLnNlbGVjdC5zdHlsZTtcbiAgaWYgKGNzc1RyYW5zZm9ybU9mZnNldCAmJiBjc3NUcmFuc2Zvcm1PZmZzZXQgIT0gLTEpIHtcbiAgICBzZWxlY3RTdHlsZVtjc3NUcmFuc2Zvcm1PZmZzZXRbMF1dID0gY3NzVHJhbnNmb3JtT2Zmc2V0WzFdO1xuICB9IGVsc2Uge1xuICAgIHJlc2V0Q3NzVHJhbnNmb3JtKHRoaXMuc2VsZWN0KTtcbiAgfVxuICB2YXIgY2VsbENvbXB1dGVkU3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKHRoaXMuVEQpO1xuICBpZiAocGFyc2VJbnQoY2VsbENvbXB1dGVkU3R5bGUuYm9yZGVyVG9wV2lkdGgsIDEwKSA+IDApIHtcbiAgICBoZWlnaHQgLT0gMTtcbiAgfVxuICBpZiAocGFyc2VJbnQoY2VsbENvbXB1dGVkU3R5bGUuYm9yZGVyTGVmdFdpZHRoLCAxMCkgPiAwKSB7XG4gICAgd2lkdGggLT0gMTtcbiAgfVxuICBzZWxlY3RTdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyAncHgnO1xuICBzZWxlY3RTdHlsZS5taW5XaWR0aCA9IHdpZHRoICsgJ3B4JztcbiAgc2VsZWN0U3R5bGUudG9wID0gZWRpdFRvcCArICdweCc7XG4gIHNlbGVjdFN0eWxlLmxlZnQgPSBlZGl0TGVmdCArICdweCc7XG4gIHNlbGVjdFN0eWxlLm1hcmdpbiA9ICcwcHgnO1xufTtcblNlbGVjdEVkaXRvci5wcm90b3R5cGUuZ2V0RWRpdGVkQ2VsbCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgZWRpdG9yU2VjdGlvbiA9IHRoaXMuY2hlY2tFZGl0b3JTZWN0aW9uKCksXG4gICAgICBlZGl0ZWRDZWxsO1xuICBzd2l0Y2ggKGVkaXRvclNlY3Rpb24pIHtcbiAgICBjYXNlICd0b3AnOlxuICAgICAgZWRpdGVkQ2VsbCA9IHRoaXMuaW5zdGFuY2Uudmlldy53dC53dE92ZXJsYXlzLnRvcE92ZXJsYXkuY2xvbmUud3RUYWJsZS5nZXRDZWxsKHtcbiAgICAgICAgcm93OiB0aGlzLnJvdyxcbiAgICAgICAgY29sOiB0aGlzLmNvbFxuICAgICAgfSk7XG4gICAgICB0aGlzLnNlbGVjdC5zdHlsZS56SW5kZXggPSAxMDE7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdjb3JuZXInOlxuICAgICAgZWRpdGVkQ2VsbCA9IHRoaXMuaW5zdGFuY2Uudmlldy53dC53dE92ZXJsYXlzLnRvcExlZnRDb3JuZXJPdmVybGF5LmNsb25lLnd0VGFibGUuZ2V0Q2VsbCh7XG4gICAgICAgIHJvdzogdGhpcy5yb3csXG4gICAgICAgIGNvbDogdGhpcy5jb2xcbiAgICAgIH0pO1xuICAgICAgdGhpcy5zZWxlY3Quc3R5bGUuekluZGV4ID0gMTAzO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnbGVmdCc6XG4gICAgICBlZGl0ZWRDZWxsID0gdGhpcy5pbnN0YW5jZS52aWV3Lnd0Lnd0T3ZlcmxheXMubGVmdE92ZXJsYXkuY2xvbmUud3RUYWJsZS5nZXRDZWxsKHtcbiAgICAgICAgcm93OiB0aGlzLnJvdyxcbiAgICAgICAgY29sOiB0aGlzLmNvbFxuICAgICAgfSk7XG4gICAgICB0aGlzLnNlbGVjdC5zdHlsZS56SW5kZXggPSAxMDI7XG4gICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgZWRpdGVkQ2VsbCA9IHRoaXMuaW5zdGFuY2UuZ2V0Q2VsbCh0aGlzLnJvdywgdGhpcy5jb2wpO1xuICAgICAgdGhpcy5zZWxlY3Quc3R5bGUuekluZGV4ID0gJyc7XG4gICAgICBicmVhaztcbiAgfVxuICByZXR1cm4gZWRpdGVkQ2VsbCAhPSAtMSAmJiBlZGl0ZWRDZWxsICE9IC0yID8gZWRpdGVkQ2VsbCA6IHZvaWQgMDtcbn07XG47XG5yZWdpc3RlckVkaXRvcignc2VsZWN0JywgU2VsZWN0RWRpdG9yKTtcblxuLy8jIFxufSx7XCJfYmFzZUVkaXRvclwiOjMxLFwiYnJvd3NlclwiOjI0LFwiZWRpdG9yc1wiOjMwLFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwiaGVscGVycy9kb20vZXZlbnRcIjo0OCxcImhlbHBlcnMvdW5pY29kZVwiOjU2fV0sNDE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIFRleHRFZGl0b3I6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFRleHRFZGl0b3I7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fYXV0b1Jlc2l6ZV9fLFxuICAgICRfX185NV9iYXNlRWRpdG9yX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fLFxuICAgICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X187XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19fNDZfXzQ2X180N19icm93c2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19icm93c2VyX199KS5kZWZhdWx0O1xudmFyICRfXzEgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLFxuICAgIGFkZENsYXNzID0gJF9fMS5hZGRDbGFzcyxcbiAgICBnZXRDYXJldFBvc2l0aW9uID0gJF9fMS5nZXRDYXJldFBvc2l0aW9uLFxuICAgIGdldENvbXB1dGVkU3R5bGUgPSAkX18xLmdldENvbXB1dGVkU3R5bGUsXG4gICAgZ2V0Q3NzVHJhbnNmb3JtID0gJF9fMS5nZXRDc3NUcmFuc2Zvcm0sXG4gICAgZ2V0U2Nyb2xsYWJsZUVsZW1lbnQgPSAkX18xLmdldFNjcm9sbGFibGVFbGVtZW50LFxuICAgIGdldFNjcm9sbGJhcldpZHRoID0gJF9fMS5nZXRTY3JvbGxiYXJXaWR0aCxcbiAgICBpbm5lcldpZHRoID0gJF9fMS5pbm5lcldpZHRoLFxuICAgIG9mZnNldCA9ICRfXzEub2Zmc2V0LFxuICAgIHJlc2V0Q3NzVHJhbnNmb3JtID0gJF9fMS5yZXNldENzc1RyYW5zZm9ybSxcbiAgICBzZXRDYXJldFBvc2l0aW9uID0gJF9fMS5zZXRDYXJldFBvc2l0aW9uLFxuICAgIGhhc1ZlcnRpY2FsU2Nyb2xsYmFyID0gJF9fMS5oYXNWZXJ0aWNhbFNjcm9sbGJhcixcbiAgICBoYXNIb3Jpem9udGFsU2Nyb2xsYmFyID0gJF9fMS5oYXNIb3Jpem9udGFsU2Nyb2xsYmFyO1xudmFyIGF1dG9SZXNpemUgPSAoJF9fYXV0b1Jlc2l6ZV9fID0gX2RlcmVxXyhcImF1dG9SZXNpemVcIiksICRfX2F1dG9SZXNpemVfXyAmJiAkX19hdXRvUmVzaXplX18uX19lc01vZHVsZSAmJiAkX19hdXRvUmVzaXplX18gfHwge2RlZmF1bHQ6ICRfX2F1dG9SZXNpemVfX30pLmRlZmF1bHQ7XG52YXIgQmFzZUVkaXRvciA9ICgkX19fOTVfYmFzZUVkaXRvcl9fID0gX2RlcmVxXyhcIl9iYXNlRWRpdG9yXCIpLCAkX19fOTVfYmFzZUVkaXRvcl9fICYmICRfX185NV9iYXNlRWRpdG9yX18uX19lc01vZHVsZSAmJiAkX19fOTVfYmFzZUVkaXRvcl9fIHx8IHtkZWZhdWx0OiAkX19fOTVfYmFzZUVkaXRvcl9ffSkuQmFzZUVkaXRvcjtcbnZhciBldmVudE1hbmFnZXJPYmplY3QgPSAoJF9fXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gPSBfZGVyZXFfKFwiZXZlbnRNYW5hZ2VyXCIpLCAkX19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyAmJiAkX19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfX30pLmV2ZW50TWFuYWdlcjtcbnZhciAkX181ID0gKCRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXyA9IF9kZXJlcV8oXCJlZGl0b3JzXCIpLCAkX19fNDZfXzQ2X180N19lZGl0b3JzX18gJiYgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19lZGl0b3JzX199KSxcbiAgICBnZXRFZGl0b3IgPSAkX181LmdldEVkaXRvcixcbiAgICByZWdpc3RlckVkaXRvciA9ICRfXzUucmVnaXN0ZXJFZGl0b3I7XG52YXIgS0VZX0NPREVTID0gKCRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9fID0gX2RlcmVxXyhcImhlbHBlcnMvdW5pY29kZVwiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX18gJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX199KS5LRVlfQ09ERVM7XG52YXIgJF9fNyA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2V2ZW50XCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9ffSksXG4gICAgc3RvcFByb3BhZ2F0aW9uID0gJF9fNy5zdG9wUHJvcGFnYXRpb24sXG4gICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uID0gJF9fNy5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24sXG4gICAgaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSAkX183LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkO1xudmFyIFRleHRFZGl0b3IgPSBCYXNlRWRpdG9yLnByb3RvdHlwZS5leHRlbmQoKTtcblRleHRFZGl0b3IucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHRoYXQgPSB0aGlzO1xuICB0aGlzLmNyZWF0ZUVsZW1lbnRzKCk7XG4gIHRoaXMuZXZlbnRNYW5hZ2VyID0gZXZlbnRNYW5hZ2VyT2JqZWN0KHRoaXMpO1xuICB0aGlzLmJpbmRFdmVudHMoKTtcbiAgdGhpcy5hdXRvUmVzaXplID0gYXV0b1Jlc2l6ZSgpO1xuICB0aGlzLmluc3RhbmNlLmFkZEhvb2soJ2FmdGVyRGVzdHJveScsIGZ1bmN0aW9uKCkge1xuICAgIHRoYXQuZGVzdHJveSgpO1xuICB9KTtcbn07XG5UZXh0RWRpdG9yLnByb3RvdHlwZS5nZXRWYWx1ZSA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5URVhUQVJFQS52YWx1ZTtcbn07XG5UZXh0RWRpdG9yLnByb3RvdHlwZS5zZXRWYWx1ZSA9IGZ1bmN0aW9uKG5ld1ZhbHVlKSB7XG4gIHRoaXMuVEVYVEFSRUEudmFsdWUgPSBuZXdWYWx1ZTtcbn07XG52YXIgb25CZWZvcmVLZXlEb3duID0gZnVuY3Rpb24gb25CZWZvcmVLZXlEb3duKGV2ZW50KSB7XG4gIHZhciBpbnN0YW5jZSA9IHRoaXMsXG4gICAgICB0aGF0ID0gaW5zdGFuY2UuZ2V0QWN0aXZlRWRpdG9yKCksXG4gICAgICBjdHJsRG93bjtcbiAgY3RybERvd24gPSAoZXZlbnQuY3RybEtleSB8fCBldmVudC5tZXRhS2V5KSAmJiAhZXZlbnQuYWx0S2V5O1xuICBpZiAoZXZlbnQudGFyZ2V0ICE9PSB0aGF0LlRFWFRBUkVBIHx8IGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKGV2ZW50KSkge1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMTcgfHwgZXZlbnQua2V5Q29kZSA9PT0gMjI0IHx8IGV2ZW50LmtleUNvZGUgPT09IDkxIHx8IGV2ZW50LmtleUNvZGUgPT09IDkzKSB7XG4gICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKGV2ZW50KTtcbiAgICByZXR1cm47XG4gIH1cbiAgc3dpdGNoIChldmVudC5rZXlDb2RlKSB7XG4gICAgY2FzZSBLRVlfQ09ERVMuQVJST1dfUklHSFQ6XG4gICAgICBpZiAodGhhdC5pc0luRnVsbEVkaXRNb2RlKCkpIHtcbiAgICAgICAgaWYgKCghdGhhdC5pc1dhaXRpbmcoKSAmJiAhdGhhdC5hbGxvd0tleUV2ZW50UHJvcGFnYXRpb24pIHx8ICghdGhhdC5pc1dhaXRpbmcoKSAmJiB0aGF0LmFsbG93S2V5RXZlbnRQcm9wYWdhdGlvbiAmJiAhdGhhdC5hbGxvd0tleUV2ZW50UHJvcGFnYXRpb24oZXZlbnQua2V5Q29kZSkpKSB7XG4gICAgICAgICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBLRVlfQ09ERVMuQVJST1dfTEVGVDpcbiAgICAgIGlmICh0aGF0LmlzSW5GdWxsRWRpdE1vZGUoKSkge1xuICAgICAgICBpZiAoKCF0aGF0LmlzV2FpdGluZygpICYmICF0aGF0LmFsbG93S2V5RXZlbnRQcm9wYWdhdGlvbikgfHwgKCF0aGF0LmlzV2FpdGluZygpICYmIHRoYXQuYWxsb3dLZXlFdmVudFByb3BhZ2F0aW9uICYmICF0aGF0LmFsbG93S2V5RXZlbnRQcm9wYWdhdGlvbihldmVudC5rZXlDb2RlKSkpIHtcbiAgICAgICAgICBzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oZXZlbnQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICBjYXNlIEtFWV9DT0RFUy5BUlJPV19VUDpcbiAgICBjYXNlIEtFWV9DT0RFUy5BUlJPV19ET1dOOlxuICAgICAgaWYgKHRoYXQuaXNJbkZ1bGxFZGl0TW9kZSgpKSB7XG4gICAgICAgIGlmICgoIXRoYXQuaXNXYWl0aW5nKCkgJiYgIXRoYXQuYWxsb3dLZXlFdmVudFByb3BhZ2F0aW9uKSB8fCAoIXRoYXQuaXNXYWl0aW5nKCkgJiYgdGhhdC5hbGxvd0tleUV2ZW50UHJvcGFnYXRpb24gJiYgIXRoYXQuYWxsb3dLZXlFdmVudFByb3BhZ2F0aW9uKGV2ZW50LmtleUNvZGUpKSkge1xuICAgICAgICAgIHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbihldmVudCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgS0VZX0NPREVTLkVOVEVSOlxuICAgICAgdmFyIHNlbGVjdGVkID0gdGhhdC5pbnN0YW5jZS5nZXRTZWxlY3RlZCgpO1xuICAgICAgdmFyIGlzTXVsdGlwbGVTZWxlY3Rpb24gPSAhKHNlbGVjdGVkWzBdID09PSBzZWxlY3RlZFsyXSAmJiBzZWxlY3RlZFsxXSA9PT0gc2VsZWN0ZWRbM10pO1xuICAgICAgaWYgKChjdHJsRG93biAmJiAhaXNNdWx0aXBsZVNlbGVjdGlvbikgfHwgZXZlbnQuYWx0S2V5KSB7XG4gICAgICAgIGlmICh0aGF0LmlzT3BlbmVkKCkpIHtcbiAgICAgICAgICB2YXIgY2FyZXRQb3NpdGlvbiA9IGdldENhcmV0UG9zaXRpb24odGhhdC5URVhUQVJFQSksXG4gICAgICAgICAgICAgIHZhbHVlID0gdGhhdC5nZXRWYWx1ZSgpO1xuICAgICAgICAgIHZhciBuZXdWYWx1ZSA9IHZhbHVlLnNsaWNlKDAsIGNhcmV0UG9zaXRpb24pICsgJ1xcbicgKyB2YWx1ZS5zbGljZShjYXJldFBvc2l0aW9uKTtcbiAgICAgICAgICB0aGF0LnNldFZhbHVlKG5ld1ZhbHVlKTtcbiAgICAgICAgICBzZXRDYXJldFBvc2l0aW9uKHRoYXQuVEVYVEFSRUEsIGNhcmV0UG9zaXRpb24gKyAxKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGF0LmJlZ2luRWRpdGluZyh0aGF0Lm9yaWdpbmFsVmFsdWUgKyAnXFxuJyk7XG4gICAgICAgIH1cbiAgICAgICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKGV2ZW50KTtcbiAgICAgIH1cbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlIEtFWV9DT0RFUy5BOlxuICAgIGNhc2UgS0VZX0NPREVTLlg6XG4gICAgY2FzZSBLRVlfQ09ERVMuQzpcbiAgICBjYXNlIEtFWV9DT0RFUy5WOlxuICAgICAgaWYgKGN0cmxEb3duKSB7XG4gICAgICAgIHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbihldmVudCk7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICBjYXNlIEtFWV9DT0RFUy5CQUNLU1BBQ0U6XG4gICAgY2FzZSBLRVlfQ09ERVMuREVMRVRFOlxuICAgIGNhc2UgS0VZX0NPREVTLkhPTUU6XG4gICAgY2FzZSBLRVlfQ09ERVMuRU5EOlxuICAgICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKGV2ZW50KTtcbiAgICAgIGJyZWFrO1xuICB9XG4gIGlmIChbS0VZX0NPREVTLkFSUk9XX1VQLCBLRVlfQ09ERVMuQVJST1dfUklHSFQsIEtFWV9DT0RFUy5BUlJPV19ET1dOLCBLRVlfQ09ERVMuQVJST1dfTEVGVF0uaW5kZXhPZihldmVudC5rZXlDb2RlKSA9PT0gLTEpIHtcbiAgICB0aGF0LmF1dG9SZXNpemUucmVzaXplKFN0cmluZy5mcm9tQ2hhckNvZGUoZXZlbnQua2V5Q29kZSkpO1xuICB9XG59O1xuVGV4dEVkaXRvci5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnJlZnJlc2hEaW1lbnNpb25zKCk7XG4gIHRoaXMuaW5zdGFuY2UuYWRkSG9vaygnYmVmb3JlS2V5RG93bicsIG9uQmVmb3JlS2V5RG93bik7XG59O1xuVGV4dEVkaXRvci5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbih0ZE91dHNpZGUpIHtcbiAgdGhpcy50ZXh0YXJlYVBhcmVudFN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gIHRoaXMuYXV0b1Jlc2l6ZS51bk9ic2VydmUoKTtcbiAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IHRoaXMuVEVYVEFSRUEpIHtcbiAgICB0aGlzLmluc3RhbmNlLmxpc3RlbigpO1xuICB9XG4gIHRoaXMuaW5zdGFuY2UucmVtb3ZlSG9vaygnYmVmb3JlS2V5RG93bicsIG9uQmVmb3JlS2V5RG93bik7XG59O1xuVGV4dEVkaXRvci5wcm90b3R5cGUuZm9jdXMgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5URVhUQVJFQS5mb2N1cygpO1xuICBzZXRDYXJldFBvc2l0aW9uKHRoaXMuVEVYVEFSRUEsIHRoaXMuVEVYVEFSRUEudmFsdWUubGVuZ3RoKTtcbn07XG5UZXh0RWRpdG9yLnByb3RvdHlwZS5jcmVhdGVFbGVtZW50cyA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLlRFWFRBUkVBID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnVEVYVEFSRUEnKTtcbiAgYWRkQ2xhc3ModGhpcy5URVhUQVJFQSwgJ2hhbmRzb250YWJsZUlucHV0Jyk7XG4gIHRoaXMudGV4dGFyZWFTdHlsZSA9IHRoaXMuVEVYVEFSRUEuc3R5bGU7XG4gIHRoaXMudGV4dGFyZWFTdHlsZS53aWR0aCA9IDA7XG4gIHRoaXMudGV4dGFyZWFTdHlsZS5oZWlnaHQgPSAwO1xuICB0aGlzLlRFWFRBUkVBX1BBUkVOVCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xuICBhZGRDbGFzcyh0aGlzLlRFWFRBUkVBX1BBUkVOVCwgJ2hhbmRzb250YWJsZUlucHV0SG9sZGVyJyk7XG4gIHRoaXMudGV4dGFyZWFQYXJlbnRTdHlsZSA9IHRoaXMuVEVYVEFSRUFfUEFSRU5ULnN0eWxlO1xuICB0aGlzLnRleHRhcmVhUGFyZW50U3R5bGUudG9wID0gMDtcbiAgdGhpcy50ZXh0YXJlYVBhcmVudFN0eWxlLmxlZnQgPSAwO1xuICB0aGlzLnRleHRhcmVhUGFyZW50U3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgdGhpcy5URVhUQVJFQV9QQVJFTlQuYXBwZW5kQ2hpbGQodGhpcy5URVhUQVJFQSk7XG4gIHRoaXMuaW5zdGFuY2Uucm9vdEVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5URVhUQVJFQV9QQVJFTlQpO1xuICB2YXIgdGhhdCA9IHRoaXM7XG4gIHRoaXMuaW5zdGFuY2UuX3JlZ2lzdGVyVGltZW91dChzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgIHRoYXQucmVmcmVzaERpbWVuc2lvbnMoKTtcbiAgfSwgMCkpO1xufTtcblRleHRFZGl0b3IucHJvdG90eXBlLmdldEVkaXRlZENlbGwgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGVkaXRvclNlY3Rpb24gPSB0aGlzLmNoZWNrRWRpdG9yU2VjdGlvbigpLFxuICAgICAgZWRpdGVkQ2VsbDtcbiAgc3dpdGNoIChlZGl0b3JTZWN0aW9uKSB7XG4gICAgY2FzZSAndG9wJzpcbiAgICAgIGVkaXRlZENlbGwgPSB0aGlzLmluc3RhbmNlLnZpZXcud3Qud3RPdmVybGF5cy50b3BPdmVybGF5LmNsb25lLnd0VGFibGUuZ2V0Q2VsbCh7XG4gICAgICAgIHJvdzogdGhpcy5yb3csXG4gICAgICAgIGNvbDogdGhpcy5jb2xcbiAgICAgIH0pO1xuICAgICAgdGhpcy50ZXh0YXJlYVBhcmVudFN0eWxlLnpJbmRleCA9IDEwMTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ3RvcC1sZWZ0LWNvcm5lcic6XG4gICAgICBlZGl0ZWRDZWxsID0gdGhpcy5pbnN0YW5jZS52aWV3Lnd0Lnd0T3ZlcmxheXMudG9wTGVmdENvcm5lck92ZXJsYXkuY2xvbmUud3RUYWJsZS5nZXRDZWxsKHtcbiAgICAgICAgcm93OiB0aGlzLnJvdyxcbiAgICAgICAgY29sOiB0aGlzLmNvbFxuICAgICAgfSk7XG4gICAgICB0aGlzLnRleHRhcmVhUGFyZW50U3R5bGUuekluZGV4ID0gMTAzO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnYm90dG9tLWxlZnQtY29ybmVyJzpcbiAgICAgIGVkaXRlZENlbGwgPSB0aGlzLmluc3RhbmNlLnZpZXcud3Qud3RPdmVybGF5cy5ib3R0b21MZWZ0Q29ybmVyT3ZlcmxheS5jbG9uZS53dFRhYmxlLmdldENlbGwoe1xuICAgICAgICByb3c6IHRoaXMucm93LFxuICAgICAgICBjb2w6IHRoaXMuY29sXG4gICAgICB9KTtcbiAgICAgIHRoaXMudGV4dGFyZWFQYXJlbnRTdHlsZS56SW5kZXggPSAxMDM7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdsZWZ0JzpcbiAgICAgIGVkaXRlZENlbGwgPSB0aGlzLmluc3RhbmNlLnZpZXcud3Qud3RPdmVybGF5cy5sZWZ0T3ZlcmxheS5jbG9uZS53dFRhYmxlLmdldENlbGwoe1xuICAgICAgICByb3c6IHRoaXMucm93LFxuICAgICAgICBjb2w6IHRoaXMuY29sXG4gICAgICB9KTtcbiAgICAgIHRoaXMudGV4dGFyZWFQYXJlbnRTdHlsZS56SW5kZXggPSAxMDI7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdib3R0b20nOlxuICAgICAgZWRpdGVkQ2VsbCA9IHRoaXMuaW5zdGFuY2Uudmlldy53dC53dE92ZXJsYXlzLmJvdHRvbU92ZXJsYXkuY2xvbmUud3RUYWJsZS5nZXRDZWxsKHtcbiAgICAgICAgcm93OiB0aGlzLnJvdyxcbiAgICAgICAgY29sOiB0aGlzLmNvbFxuICAgICAgfSk7XG4gICAgICB0aGlzLnRleHRhcmVhUGFyZW50U3R5bGUuekluZGV4ID0gMTAyO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIGVkaXRlZENlbGwgPSB0aGlzLmluc3RhbmNlLmdldENlbGwodGhpcy5yb3csIHRoaXMuY29sKTtcbiAgICAgIHRoaXMudGV4dGFyZWFQYXJlbnRTdHlsZS56SW5kZXggPSAnJztcbiAgICAgIGJyZWFrO1xuICB9XG4gIHJldHVybiBlZGl0ZWRDZWxsICE9IC0xICYmIGVkaXRlZENlbGwgIT0gLTIgPyBlZGl0ZWRDZWxsIDogdm9pZCAwO1xufTtcblRleHRFZGl0b3IucHJvdG90eXBlLnJlZnJlc2hWYWx1ZSA9IGZ1bmN0aW9uKCkge1xuICB2YXIgc291cmNlRGF0YSA9IHRoaXMuaW5zdGFuY2UuZ2V0U291cmNlRGF0YUF0Q2VsbCh0aGlzLnJvdywgdGhpcy5wcm9wKTtcbiAgdGhpcy5vcmlnaW5hbFZhbHVlID0gc291cmNlRGF0YTtcbiAgdGhpcy5zZXRWYWx1ZShzb3VyY2VEYXRhKTtcbiAgdGhpcy5yZWZyZXNoRGltZW5zaW9ucygpO1xufTtcblRleHRFZGl0b3IucHJvdG90eXBlLnJlZnJlc2hEaW1lbnNpb25zID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0aGlzLnN0YXRlICE9PSBIYW5kc29udGFibGUuRWRpdG9yU3RhdGUuRURJVElORykge1xuICAgIHJldHVybjtcbiAgfVxuICB0aGlzLlREID0gdGhpcy5nZXRFZGl0ZWRDZWxsKCk7XG4gIGlmICghdGhpcy5URCkge1xuICAgIHRoaXMuY2xvc2UodHJ1ZSk7XG4gICAgcmV0dXJuO1xuICB9XG4gIHZhciBjdXJyZW50T2Zmc2V0ID0gb2Zmc2V0KHRoaXMuVEQpLFxuICAgICAgY29udGFpbmVyT2Zmc2V0ID0gb2Zmc2V0KHRoaXMuaW5zdGFuY2Uucm9vdEVsZW1lbnQpLFxuICAgICAgc2Nyb2xsYWJsZUNvbnRhaW5lciA9IGdldFNjcm9sbGFibGVFbGVtZW50KHRoaXMuVEQpLFxuICAgICAgdG90YWxSb3dzQ291bnQgPSB0aGlzLmluc3RhbmNlLmNvdW50Um93cygpLFxuICAgICAgZWRpdFRvcE1vZGlmaWVyID0gY3VycmVudE9mZnNldC50b3AgPT09IGNvbnRhaW5lck9mZnNldC50b3AgPyAwIDogMSxcbiAgICAgIGVkaXRUb3AgPSBjdXJyZW50T2Zmc2V0LnRvcCAtIGNvbnRhaW5lck9mZnNldC50b3AgLSBlZGl0VG9wTW9kaWZpZXIgLSAoc2Nyb2xsYWJsZUNvbnRhaW5lci5zY3JvbGxUb3AgfHwgMCksXG4gICAgICBlZGl0TGVmdCA9IGN1cnJlbnRPZmZzZXQubGVmdCAtIGNvbnRhaW5lck9mZnNldC5sZWZ0IC0gMSAtIChzY3JvbGxhYmxlQ29udGFpbmVyLnNjcm9sbExlZnQgfHwgMCksXG4gICAgICBzZXR0aW5ncyA9IHRoaXMuaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKSxcbiAgICAgIHJvd0hlYWRlcnNDb3VudCA9IHRoaXMuaW5zdGFuY2UuaGFzUm93SGVhZGVycygpLFxuICAgICAgY29sSGVhZGVyc0NvdW50ID0gdGhpcy5pbnN0YW5jZS5oYXNDb2xIZWFkZXJzKCksXG4gICAgICBlZGl0b3JTZWN0aW9uID0gdGhpcy5jaGVja0VkaXRvclNlY3Rpb24oKSxcbiAgICAgIGJhY2tncm91bmRDb2xvciA9IHRoaXMuVEQuc3R5bGUuYmFja2dyb3VuZENvbG9yLFxuICAgICAgY3NzVHJhbnNmb3JtT2Zmc2V0O1xuICBzd2l0Y2ggKGVkaXRvclNlY3Rpb24pIHtcbiAgICBjYXNlICd0b3AnOlxuICAgICAgY3NzVHJhbnNmb3JtT2Zmc2V0ID0gZ2V0Q3NzVHJhbnNmb3JtKHRoaXMuaW5zdGFuY2Uudmlldy53dC53dE92ZXJsYXlzLnRvcE92ZXJsYXkuY2xvbmUud3RUYWJsZS5ob2xkZXIucGFyZW50Tm9kZSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdsZWZ0JzpcbiAgICAgIGNzc1RyYW5zZm9ybU9mZnNldCA9IGdldENzc1RyYW5zZm9ybSh0aGlzLmluc3RhbmNlLnZpZXcud3Qud3RPdmVybGF5cy5sZWZ0T3ZlcmxheS5jbG9uZS53dFRhYmxlLmhvbGRlci5wYXJlbnROb2RlKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ3RvcC1sZWZ0LWNvcm5lcic6XG4gICAgICBjc3NUcmFuc2Zvcm1PZmZzZXQgPSBnZXRDc3NUcmFuc2Zvcm0odGhpcy5pbnN0YW5jZS52aWV3Lnd0Lnd0T3ZlcmxheXMudG9wTGVmdENvcm5lck92ZXJsYXkuY2xvbmUud3RUYWJsZS5ob2xkZXIucGFyZW50Tm9kZSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdib3R0b20tbGVmdC1jb3JuZXInOlxuICAgICAgY3NzVHJhbnNmb3JtT2Zmc2V0ID0gZ2V0Q3NzVHJhbnNmb3JtKHRoaXMuaW5zdGFuY2Uudmlldy53dC53dE92ZXJsYXlzLmJvdHRvbUxlZnRDb3JuZXJPdmVybGF5LmNsb25lLnd0VGFibGUuaG9sZGVyLnBhcmVudE5vZGUpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnYm90dG9tJzpcbiAgICAgIGNzc1RyYW5zZm9ybU9mZnNldCA9IGdldENzc1RyYW5zZm9ybSh0aGlzLmluc3RhbmNlLnZpZXcud3Qud3RPdmVybGF5cy5ib3R0b21PdmVybGF5LmNsb25lLnd0VGFibGUuaG9sZGVyLnBhcmVudE5vZGUpO1xuICAgICAgYnJlYWs7XG4gIH1cbiAgaWYgKGNvbEhlYWRlcnNDb3VudCAmJiB0aGlzLmluc3RhbmNlLmdldFNlbGVjdGVkKClbMF0gPT09IDAgfHwgKHNldHRpbmdzLmZpeGVkUm93c0JvdHRvbSAmJiB0aGlzLmluc3RhbmNlLmdldFNlbGVjdGVkKClbMF0gPT09IHRvdGFsUm93c0NvdW50IC0gc2V0dGluZ3MuZml4ZWRSb3dzQm90dG9tKSkge1xuICAgIGVkaXRUb3AgKz0gMTtcbiAgfVxuICBpZiAodGhpcy5pbnN0YW5jZS5nZXRTZWxlY3RlZCgpWzFdID09PSAwKSB7XG4gICAgZWRpdExlZnQgKz0gMTtcbiAgfVxuICBpZiAoY3NzVHJhbnNmb3JtT2Zmc2V0ICYmIGNzc1RyYW5zZm9ybU9mZnNldCAhPSAtMSkge1xuICAgIHRoaXMudGV4dGFyZWFQYXJlbnRTdHlsZVtjc3NUcmFuc2Zvcm1PZmZzZXRbMF1dID0gY3NzVHJhbnNmb3JtT2Zmc2V0WzFdO1xuICB9IGVsc2Uge1xuICAgIHJlc2V0Q3NzVHJhbnNmb3JtKHRoaXMuVEVYVEFSRUFfUEFSRU5UKTtcbiAgfVxuICB0aGlzLnRleHRhcmVhUGFyZW50U3R5bGUudG9wID0gZWRpdFRvcCArICdweCc7XG4gIHRoaXMudGV4dGFyZWFQYXJlbnRTdHlsZS5sZWZ0ID0gZWRpdExlZnQgKyAncHgnO1xuICB2YXIgZmlyc3RSb3dPZmZzZXQgPSB0aGlzLmluc3RhbmNlLnZpZXcud3Qud3RWaWV3cG9ydC5yb3dzUmVuZGVyQ2FsY3VsYXRvci5zdGFydFBvc2l0aW9uO1xuICB2YXIgZmlyc3RDb2x1bW5PZmZzZXQgPSB0aGlzLmluc3RhbmNlLnZpZXcud3Qud3RWaWV3cG9ydC5jb2x1bW5zUmVuZGVyQ2FsY3VsYXRvci5zdGFydFBvc2l0aW9uO1xuICB2YXIgaG9yaXpvbnRhbFNjcm9sbFBvc2l0aW9uID0gdGhpcy5pbnN0YW5jZS52aWV3Lnd0Lnd0T3ZlcmxheXMubGVmdE92ZXJsYXkuZ2V0U2Nyb2xsUG9zaXRpb24oKTtcbiAgdmFyIHZlcnRpY2FsU2Nyb2xsUG9zaXRpb24gPSB0aGlzLmluc3RhbmNlLnZpZXcud3Qud3RPdmVybGF5cy50b3BPdmVybGF5LmdldFNjcm9sbFBvc2l0aW9uKCk7XG4gIHZhciBzY3JvbGxiYXJXaWR0aCA9IGdldFNjcm9sbGJhcldpZHRoKCk7XG4gIHZhciBjZWxsVG9wT2Zmc2V0ID0gdGhpcy5URC5vZmZzZXRUb3AgKyBmaXJzdFJvd09mZnNldCAtIHZlcnRpY2FsU2Nyb2xsUG9zaXRpb247XG4gIHZhciBjZWxsTGVmdE9mZnNldCA9IHRoaXMuVEQub2Zmc2V0TGVmdCArIGZpcnN0Q29sdW1uT2Zmc2V0IC0gaG9yaXpvbnRhbFNjcm9sbFBvc2l0aW9uO1xuICB2YXIgd2lkdGggPSBpbm5lcldpZHRoKHRoaXMuVEQpIC0gODtcbiAgdmFyIGFjdHVhbFZlcnRpY2FsU2Nyb2xsYmFyV2lkdGggPSBoYXNWZXJ0aWNhbFNjcm9sbGJhcihzY3JvbGxhYmxlQ29udGFpbmVyKSA/IHNjcm9sbGJhcldpZHRoIDogMDtcbiAgdmFyIGFjdHVhbEhvcml6b250YWxTY3JvbGxiYXJXaWR0aCA9IGhhc0hvcml6b250YWxTY3JvbGxiYXIoc2Nyb2xsYWJsZUNvbnRhaW5lcikgPyBzY3JvbGxiYXJXaWR0aCA6IDA7XG4gIHZhciBtYXhXaWR0aCA9IHRoaXMuaW5zdGFuY2Uudmlldy5tYXhpbXVtVmlzaWJsZUVsZW1lbnRXaWR0aChjZWxsTGVmdE9mZnNldCkgLSA5IC0gYWN0dWFsVmVydGljYWxTY3JvbGxiYXJXaWR0aDtcbiAgdmFyIGhlaWdodCA9IHRoaXMuVEQuc2Nyb2xsSGVpZ2h0ICsgMTtcbiAgdmFyIG1heEhlaWdodCA9IE1hdGgubWF4KHRoaXMuaW5zdGFuY2Uudmlldy5tYXhpbXVtVmlzaWJsZUVsZW1lbnRIZWlnaHQoY2VsbFRvcE9mZnNldCkgLSBhY3R1YWxIb3Jpem9udGFsU2Nyb2xsYmFyV2lkdGgsIDIzKTtcbiAgdmFyIGNlbGxDb21wdXRlZFN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLlREKTtcbiAgdGhpcy5URVhUQVJFQS5zdHlsZS5mb250U2l6ZSA9IGNlbGxDb21wdXRlZFN0eWxlLmZvbnRTaXplO1xuICB0aGlzLlRFWFRBUkVBLnN0eWxlLmZvbnRGYW1pbHkgPSBjZWxsQ29tcHV0ZWRTdHlsZS5mb250RmFtaWx5O1xuICB0aGlzLlRFWFRBUkVBLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICcnO1xuICB0aGlzLlRFWFRBUkVBLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGJhY2tncm91bmRDb2xvciA/IGJhY2tncm91bmRDb2xvciA6IGdldENvbXB1dGVkU3R5bGUodGhpcy5URVhUQVJFQSkuYmFja2dyb3VuZENvbG9yO1xuICB0aGlzLmF1dG9SZXNpemUuaW5pdCh0aGlzLlRFWFRBUkVBLCB7XG4gICAgbWluSGVpZ2h0OiBNYXRoLm1pbihoZWlnaHQsIG1heEhlaWdodCksXG4gICAgbWF4SGVpZ2h0OiBtYXhIZWlnaHQsXG4gICAgbWluV2lkdGg6IE1hdGgubWluKHdpZHRoLCBtYXhXaWR0aCksXG4gICAgbWF4V2lkdGg6IG1heFdpZHRoXG4gIH0sIHRydWUpO1xuICB0aGlzLnRleHRhcmVhUGFyZW50U3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG59O1xuVGV4dEVkaXRvci5wcm90b3R5cGUuYmluZEV2ZW50cyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgZWRpdG9yID0gdGhpcztcbiAgdGhpcy5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLlRFWFRBUkVBLCAnY3V0JywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBzdG9wUHJvcGFnYXRpb24oZXZlbnQpO1xuICB9KTtcbiAgdGhpcy5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLlRFWFRBUkVBLCAncGFzdGUnLCBmdW5jdGlvbihldmVudCkge1xuICAgIHN0b3BQcm9wYWdhdGlvbihldmVudCk7XG4gIH0pO1xuICB0aGlzLmluc3RhbmNlLmFkZEhvb2soJ2FmdGVyU2Nyb2xsSG9yaXpvbnRhbGx5JywgZnVuY3Rpb24oKSB7XG4gICAgZWRpdG9yLnJlZnJlc2hEaW1lbnNpb25zKCk7XG4gIH0pO1xuICB0aGlzLmluc3RhbmNlLmFkZEhvb2soJ2FmdGVyU2Nyb2xsVmVydGljYWxseScsIGZ1bmN0aW9uKCkge1xuICAgIGVkaXRvci5yZWZyZXNoRGltZW5zaW9ucygpO1xuICB9KTtcbiAgdGhpcy5pbnN0YW5jZS5hZGRIb29rKCdhZnRlckNvbHVtblJlc2l6ZScsIGZ1bmN0aW9uKCkge1xuICAgIGVkaXRvci5yZWZyZXNoRGltZW5zaW9ucygpO1xuICAgIGVkaXRvci5mb2N1cygpO1xuICB9KTtcbiAgdGhpcy5pbnN0YW5jZS5hZGRIb29rKCdhZnRlclJvd1Jlc2l6ZScsIGZ1bmN0aW9uKCkge1xuICAgIGVkaXRvci5yZWZyZXNoRGltZW5zaW9ucygpO1xuICAgIGVkaXRvci5mb2N1cygpO1xuICB9KTtcbiAgdGhpcy5pbnN0YW5jZS5hZGRIb29rKCdhZnRlckRlc3Ryb3knLCBmdW5jdGlvbigpIHtcbiAgICBlZGl0b3IuZXZlbnRNYW5hZ2VyLmRlc3Ryb3koKTtcbiAgfSk7XG59O1xuVGV4dEVkaXRvci5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmV2ZW50TWFuYWdlci5kZXN0cm95KCk7XG59O1xuO1xucmVnaXN0ZXJFZGl0b3IoJ3RleHQnLCBUZXh0RWRpdG9yKTtcblxuLy8jIFxufSx7XCJfYmFzZUVkaXRvclwiOjMxLFwiYXV0b1Jlc2l6ZVwiOlwiYXV0b1Jlc2l6ZVwiLFwiYnJvd3NlclwiOjI0LFwiZWRpdG9yc1wiOjMwLFwiZXZlbnRNYW5hZ2VyXCI6NDIsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJoZWxwZXJzL2RvbS9ldmVudFwiOjQ4LFwiaGVscGVycy91bmljb2RlXCI6NTZ9XSw0MjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgRXZlbnRNYW5hZ2VyOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBFdmVudE1hbmFnZXI7XG4gICAgfX0sXG4gIGV2ZW50TWFuYWdlcjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZXZlbnRNYW5hZ2VyO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19icm93c2VyX18sXG4gICAgJF9faGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLFxuICAgICRfX2hlbHBlcnNfNDdfZmVhdHVyZV9fLFxuICAgICRfX2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X187XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19icm93c2VyX18gJiYgJF9fYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19icm93c2VyX199KS5kZWZhdWx0O1xudmFyICRfXzEgPSAoJF9faGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLFxuICAgIHBvbHltZXJXcmFwID0gJF9fMS5wb2x5bWVyV3JhcCxcbiAgICBjbG9zZXN0ID0gJF9fMS5jbG9zZXN0O1xudmFyIGlzV2ViQ29tcG9uZW50U3VwcG9ydGVkTmF0aXZlbHkgPSAoJF9faGVscGVyc180N19mZWF0dXJlX18gPSBfZGVyZXFfKFwiaGVscGVycy9mZWF0dXJlXCIpLCAkX19oZWxwZXJzXzQ3X2ZlYXR1cmVfXyAmJiAkX19oZWxwZXJzXzQ3X2ZlYXR1cmVfXy5fX2VzTW9kdWxlICYmICRfX2hlbHBlcnNfNDdfZmVhdHVyZV9fIHx8IHtkZWZhdWx0OiAkX19oZWxwZXJzXzQ3X2ZlYXR1cmVfX30pLmlzV2ViQ29tcG9uZW50U3VwcG9ydGVkTmF0aXZlbHk7XG52YXIgX3N0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiA9ICgkX19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2V2ZW50XCIpLCAkX19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fICYmICRfX2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fIHx8IHtkZWZhdWx0OiAkX19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9ffSkuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uO1xudmFyIEV2ZW50TWFuYWdlciA9IGZ1bmN0aW9uIEV2ZW50TWFuYWdlcigpIHtcbiAgdmFyIGNvbnRleHQgPSBhcmd1bWVudHNbMF0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzBdIDogbnVsbDtcbiAgdGhpcy5jb250ZXh0ID0gY29udGV4dCB8fCB0aGlzO1xuICBpZiAoIXRoaXMuY29udGV4dC5ldmVudExpc3RlbmVycykge1xuICAgIHRoaXMuY29udGV4dC5ldmVudExpc3RlbmVycyA9IFtdO1xuICB9XG59O1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoRXZlbnRNYW5hZ2VyLCB7XG4gIGFkZEV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uKGVsZW1lbnQsIGV2ZW50TmFtZSwgY2FsbGJhY2spIHtcbiAgICB2YXIgJF9fNCA9IHRoaXM7XG4gICAgdmFyIGNvbnRleHQgPSB0aGlzLmNvbnRleHQ7XG4gICAgZnVuY3Rpb24gY2FsbGJhY2tQcm94eShldmVudCkge1xuICAgICAgZXZlbnQgPSBleHRlbmRFdmVudChjb250ZXh0LCBldmVudCk7XG4gICAgICBjYWxsYmFjay5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICB9XG4gICAgdGhpcy5jb250ZXh0LmV2ZW50TGlzdGVuZXJzLnB1c2goe1xuICAgICAgZWxlbWVudDogZWxlbWVudCxcbiAgICAgIGV2ZW50OiBldmVudE5hbWUsXG4gICAgICBjYWxsYmFjazogY2FsbGJhY2ssXG4gICAgICBjYWxsYmFja1Byb3h5OiBjYWxsYmFja1Byb3h5XG4gICAgfSk7XG4gICAgaWYgKHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKSB7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBjYWxsYmFja1Byb3h5LCBmYWxzZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsZW1lbnQuYXR0YWNoRXZlbnQoJ29uJyArIGV2ZW50TmFtZSwgY2FsbGJhY2tQcm94eSk7XG4gICAgfVxuICAgIEhhbmRzb250YWJsZS5jb3VudEV2ZW50TWFuYWdlckxpc3RlbmVycysrO1xuICAgIHJldHVybiAoZnVuY3Rpb24oKSB7XG4gICAgICAkX180LnJlbW92ZUV2ZW50TGlzdGVuZXIoZWxlbWVudCwgZXZlbnROYW1lLCBjYWxsYmFjayk7XG4gICAgfSk7XG4gIH0sXG4gIHJlbW92ZUV2ZW50TGlzdGVuZXI6IGZ1bmN0aW9uKGVsZW1lbnQsIGV2ZW50TmFtZSwgY2FsbGJhY2spIHtcbiAgICB2YXIgbGVuID0gdGhpcy5jb250ZXh0LmV2ZW50TGlzdGVuZXJzLmxlbmd0aDtcbiAgICB2YXIgdG1wRXZlbnQ7XG4gICAgd2hpbGUgKGxlbi0tKSB7XG4gICAgICB0bXBFdmVudCA9IHRoaXMuY29udGV4dC5ldmVudExpc3RlbmVyc1tsZW5dO1xuICAgICAgaWYgKHRtcEV2ZW50LmV2ZW50ID09IGV2ZW50TmFtZSAmJiB0bXBFdmVudC5lbGVtZW50ID09IGVsZW1lbnQpIHtcbiAgICAgICAgaWYgKGNhbGxiYWNrICYmIGNhbGxiYWNrICE9IHRtcEV2ZW50LmNhbGxiYWNrKSB7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb250ZXh0LmV2ZW50TGlzdGVuZXJzLnNwbGljZShsZW4sIDEpO1xuICAgICAgICBpZiAodG1wRXZlbnQuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKSB7XG4gICAgICAgICAgdG1wRXZlbnQuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKHRtcEV2ZW50LmV2ZW50LCB0bXBFdmVudC5jYWxsYmFja1Byb3h5LCBmYWxzZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdG1wRXZlbnQuZWxlbWVudC5kZXRhY2hFdmVudCgnb24nICsgdG1wRXZlbnQuZXZlbnQsIHRtcEV2ZW50LmNhbGxiYWNrUHJveHkpO1xuICAgICAgICB9XG4gICAgICAgIEhhbmRzb250YWJsZS5jb3VudEV2ZW50TWFuYWdlckxpc3RlbmVycy0tO1xuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgY2xlYXJFdmVudHM6IGZ1bmN0aW9uKCkge1xuICAgIGlmICghdGhpcy5jb250ZXh0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBsZW4gPSB0aGlzLmNvbnRleHQuZXZlbnRMaXN0ZW5lcnMubGVuZ3RoO1xuICAgIHdoaWxlIChsZW4tLSkge1xuICAgICAgdmFyIGV2ZW50ID0gdGhpcy5jb250ZXh0LmV2ZW50TGlzdGVuZXJzW2xlbl07XG4gICAgICBpZiAoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LmVsZW1lbnQsIGV2ZW50LmV2ZW50LCBldmVudC5jYWxsYmFjayk7XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBjbGVhcjogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5jbGVhckV2ZW50cygpO1xuICB9LFxuICBkZXN0cm95OiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmNsZWFyRXZlbnRzKCk7XG4gICAgdGhpcy5jb250ZXh0ID0gbnVsbDtcbiAgfSxcbiAgZmlyZUV2ZW50OiBmdW5jdGlvbihlbGVtZW50LCBldmVudE5hbWUpIHtcbiAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgICBjYW5jZWxhYmxlOiAoZXZlbnROYW1lICE9PSAnbW91c2Vtb3ZlJyksXG4gICAgICB2aWV3OiB3aW5kb3csXG4gICAgICBkZXRhaWw6IDAsXG4gICAgICBzY3JlZW5YOiAwLFxuICAgICAgc2NyZWVuWTogMCxcbiAgICAgIGNsaWVudFg6IDEsXG4gICAgICBjbGllbnRZOiAxLFxuICAgICAgY3RybEtleTogZmFsc2UsXG4gICAgICBhbHRLZXk6IGZhbHNlLFxuICAgICAgc2hpZnRLZXk6IGZhbHNlLFxuICAgICAgbWV0YUtleTogZmFsc2UsXG4gICAgICBidXR0b246IDAsXG4gICAgICByZWxhdGVkVGFyZ2V0OiB1bmRlZmluZWRcbiAgICB9O1xuICAgIHZhciBldmVudDtcbiAgICBpZiAoZG9jdW1lbnQuY3JlYXRlRXZlbnQpIHtcbiAgICAgIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ01vdXNlRXZlbnRzJyk7XG4gICAgICBldmVudC5pbml0TW91c2VFdmVudChldmVudE5hbWUsIG9wdGlvbnMuYnViYmxlcywgb3B0aW9ucy5jYW5jZWxhYmxlLCBvcHRpb25zLnZpZXcsIG9wdGlvbnMuZGV0YWlsLCBvcHRpb25zLnNjcmVlblgsIG9wdGlvbnMuc2NyZWVuWSwgb3B0aW9ucy5jbGllbnRYLCBvcHRpb25zLmNsaWVudFksIG9wdGlvbnMuY3RybEtleSwgb3B0aW9ucy5hbHRLZXksIG9wdGlvbnMuc2hpZnRLZXksIG9wdGlvbnMubWV0YUtleSwgb3B0aW9ucy5idXR0b24sIG9wdGlvbnMucmVsYXRlZFRhcmdldCB8fCBkb2N1bWVudC5ib2R5LnBhcmVudE5vZGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50T2JqZWN0KCk7XG4gICAgfVxuICAgIGlmIChlbGVtZW50LmRpc3BhdGNoRXZlbnQpIHtcbiAgICAgIGVsZW1lbnQuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsZW1lbnQuZmlyZUV2ZW50KCdvbicgKyBldmVudE5hbWUsIGV2ZW50KTtcbiAgICB9XG4gIH1cbn0sIHt9KTtcbmZ1bmN0aW9uIGV4dGVuZEV2ZW50KGNvbnRleHQsIGV2ZW50KSB7XG4gIHZhciBjb21wb25lbnROYW1lID0gJ0hPVC1UQUJMRSc7XG4gIHZhciBpc0hvdFRhYmxlU3BvdHRlZDtcbiAgdmFyIGZyb21FbGVtZW50O1xuICB2YXIgcmVhbFRhcmdldDtcbiAgdmFyIHRhcmdldDtcbiAgdmFyIGxlbjtcbiAgdmFyIG5hdGl2ZVN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbjtcbiAgZXZlbnQuaXNUYXJnZXRXZWJDb21wb25lbnQgPSBmYWxzZTtcbiAgZXZlbnQucmVhbFRhcmdldCA9IGV2ZW50LnRhcmdldDtcbiAgbmF0aXZlU3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uID0gZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uO1xuICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24gPSBmdW5jdGlvbigpIHtcbiAgICBuYXRpdmVTdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24uYXBwbHkodGhpcyk7XG4gICAgX3N0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbih0aGlzKTtcbiAgfTtcbiAgaWYgKCFIYW5kc29udGFibGUuZXZlbnRNYW5hZ2VyLmlzSG90VGFibGVFbnYpIHtcbiAgICByZXR1cm4gZXZlbnQ7XG4gIH1cbiAgZXZlbnQgPSBwb2x5bWVyV3JhcChldmVudCk7XG4gIGxlbiA9IGV2ZW50LnBhdGggPyBldmVudC5wYXRoLmxlbmd0aCA6IDA7XG4gIHdoaWxlIChsZW4tLSkge1xuICAgIGlmIChldmVudC5wYXRoW2xlbl0ubm9kZU5hbWUgPT09IGNvbXBvbmVudE5hbWUpIHtcbiAgICAgIGlzSG90VGFibGVTcG90dGVkID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKGlzSG90VGFibGVTcG90dGVkICYmIGV2ZW50LnBhdGhbbGVuXS5zaGFkb3dSb290KSB7XG4gICAgICB0YXJnZXQgPSBldmVudC5wYXRoW2xlbl07XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgaWYgKGxlbiA9PT0gMCAmJiAhdGFyZ2V0KSB7XG4gICAgICB0YXJnZXQgPSBldmVudC5wYXRoW2xlbl07XG4gICAgfVxuICB9XG4gIGlmICghdGFyZ2V0KSB7XG4gICAgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICB9XG4gIGV2ZW50LmlzVGFyZ2V0V2ViQ29tcG9uZW50ID0gdHJ1ZTtcbiAgaWYgKGlzV2ViQ29tcG9uZW50U3VwcG9ydGVkTmF0aXZlbHkoKSkge1xuICAgIGV2ZW50LnJlYWxUYXJnZXQgPSBldmVudC5zcmNFbGVtZW50IHx8IGV2ZW50LnRvRWxlbWVudDtcbiAgfSBlbHNlIGlmIChjb250ZXh0IGluc3RhbmNlb2YgSGFuZHNvbnRhYmxlLkNvcmUgfHwgY29udGV4dCBpbnN0YW5jZW9mIFdhbGtvbnRhYmxlKSB7XG4gICAgaWYgKGNvbnRleHQgaW5zdGFuY2VvZiBIYW5kc29udGFibGUuQ29yZSkge1xuICAgICAgZnJvbUVsZW1lbnQgPSBjb250ZXh0LnZpZXcgPyBjb250ZXh0LnZpZXcud3Qud3RUYWJsZS5UQUJMRSA6IG51bGw7XG4gICAgfSBlbHNlIGlmIChjb250ZXh0IGluc3RhbmNlb2YgV2Fsa29udGFibGUpIHtcbiAgICAgIGZyb21FbGVtZW50ID0gY29udGV4dC53dFRhYmxlLlRBQkxFLnBhcmVudE5vZGUucGFyZW50Tm9kZTtcbiAgICB9XG4gICAgcmVhbFRhcmdldCA9IGNsb3Nlc3QoZXZlbnQudGFyZ2V0LCBbY29tcG9uZW50TmFtZV0sIGZyb21FbGVtZW50KTtcbiAgICBpZiAocmVhbFRhcmdldCkge1xuICAgICAgZXZlbnQucmVhbFRhcmdldCA9IGZyb21FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY29tcG9uZW50TmFtZSkgfHwgZXZlbnQudGFyZ2V0O1xuICAgIH0gZWxzZSB7XG4gICAgICBldmVudC5yZWFsVGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICAgIH1cbiAgfVxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXZlbnQsICd0YXJnZXQnLCB7XG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBwb2x5bWVyV3JhcCh0YXJnZXQpO1xuICAgIH0sXG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBjb25maWd1cmFibGU6IHRydWVcbiAgfSk7XG4gIHJldHVybiBldmVudDtcbn1cbjtcbkhhbmRzb250YWJsZS5jb3VudEV2ZW50TWFuYWdlckxpc3RlbmVycyA9IDA7XG5IYW5kc29udGFibGUuZXZlbnRNYW5hZ2VyID0gZXZlbnRNYW5hZ2VyO1xuZnVuY3Rpb24gZXZlbnRNYW5hZ2VyKGNvbnRleHQpIHtcbiAgcmV0dXJuIG5ldyBFdmVudE1hbmFnZXIoY29udGV4dCk7XG59XG5cbi8vIyBcbn0se1wiYnJvd3NlclwiOjI0LFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwiaGVscGVycy9kb20vZXZlbnRcIjo0OCxcImhlbHBlcnMvZmVhdHVyZVwiOjQ5fV0sNDM6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIHRvMmRBcnJheToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdG8yZEFycmF5O1xuICAgIH19LFxuICBleHRlbmRBcnJheToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZXh0ZW5kQXJyYXk7XG4gICAgfX0sXG4gIHBpdm90OiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBwaXZvdDtcbiAgICB9fSxcbiAgYXJyYXlSZWR1Y2U6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGFycmF5UmVkdWNlO1xuICAgIH19LFxuICBhcnJheUZpbHRlcjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gYXJyYXlGaWx0ZXI7XG4gICAgfX0sXG4gIGFycmF5TWFwOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBhcnJheU1hcDtcbiAgICB9fSxcbiAgYXJyYXlFYWNoOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBhcnJheUVhY2g7XG4gICAgfX0sXG4gIGFycmF5U3VtOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBhcnJheVN1bTtcbiAgICB9fSxcbiAgYXJyYXlNYXg6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGFycmF5TWF4O1xuICAgIH19LFxuICBhcnJheU1pbjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gYXJyYXlNaW47XG4gICAgfX0sXG4gIGFycmF5QXZnOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBhcnJheUF2ZztcbiAgICB9fSxcbiAgYXJyYXlGbGF0dGVuOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBhcnJheUZsYXR0ZW47XG4gICAgfX0sXG4gIGFycmF5VW5pcXVlOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBhcnJheVVuaXF1ZTtcbiAgICB9fSxcbiAgYXJyYXlJbmNsdWRlczoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gYXJyYXlJbmNsdWRlcztcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG5mdW5jdGlvbiB0bzJkQXJyYXkoYXJyKSB7XG4gIHZhciBpID0gMCxcbiAgICAgIGlsZW4gPSBhcnIubGVuZ3RoO1xuICB3aGlsZSAoaSA8IGlsZW4pIHtcbiAgICBhcnJbaV0gPSBbYXJyW2ldXTtcbiAgICBpKys7XG4gIH1cbn1cbmZ1bmN0aW9uIGV4dGVuZEFycmF5KGFyciwgZXh0ZW5zaW9uKSB7XG4gIHZhciBpID0gMCxcbiAgICAgIGlsZW4gPSBleHRlbnNpb24ubGVuZ3RoO1xuICB3aGlsZSAoaSA8IGlsZW4pIHtcbiAgICBhcnIucHVzaChleHRlbnNpb25baV0pO1xuICAgIGkrKztcbiAgfVxufVxuZnVuY3Rpb24gcGl2b3QoYXJyKSB7XG4gIHZhciBwaXZvdGVkQXJyID0gW107XG4gIGlmICghYXJyIHx8IGFyci5sZW5ndGggPT09IDAgfHwgIWFyclswXSB8fCBhcnJbMF0ubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIHBpdm90ZWRBcnI7XG4gIH1cbiAgdmFyIHJvd0NvdW50ID0gYXJyLmxlbmd0aDtcbiAgdmFyIGNvbENvdW50ID0gYXJyWzBdLmxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCByb3dDb3VudDsgaSsrKSB7XG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBjb2xDb3VudDsgaisrKSB7XG4gICAgICBpZiAoIXBpdm90ZWRBcnJbal0pIHtcbiAgICAgICAgcGl2b3RlZEFycltqXSA9IFtdO1xuICAgICAgfVxuICAgICAgcGl2b3RlZEFycltqXVtpXSA9IGFycltpXVtqXTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBpdm90ZWRBcnI7XG59XG5mdW5jdGlvbiBhcnJheVJlZHVjZShhcnJheSwgaXRlcmF0ZWUsIGFjY3VtdWxhdG9yLCBpbml0RnJvbUFycmF5KSB7XG4gIHZhciBpbmRleCA9IC0xLFxuICAgICAgbGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xuICBpZiAoaW5pdEZyb21BcnJheSAmJiBsZW5ndGgpIHtcbiAgICBhY2N1bXVsYXRvciA9IGFycmF5WysraW5kZXhdO1xuICB9XG4gIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgYWNjdW11bGF0b3IgPSBpdGVyYXRlZShhY2N1bXVsYXRvciwgYXJyYXlbaW5kZXhdLCBpbmRleCwgYXJyYXkpO1xuICB9XG4gIHJldHVybiBhY2N1bXVsYXRvcjtcbn1cbmZ1bmN0aW9uIGFycmF5RmlsdGVyKGFycmF5LCBwcmVkaWNhdGUpIHtcbiAgdmFyIGluZGV4ID0gLTEsXG4gICAgICBsZW5ndGggPSBhcnJheS5sZW5ndGgsXG4gICAgICByZXNJbmRleCA9IC0xLFxuICAgICAgcmVzdWx0ID0gW107XG4gIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgdmFyIHZhbHVlID0gYXJyYXlbaW5kZXhdO1xuICAgIGlmIChwcmVkaWNhdGUodmFsdWUsIGluZGV4LCBhcnJheSkpIHtcbiAgICAgIHJlc3VsdFsrK3Jlc0luZGV4XSA9IHZhbHVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gYXJyYXlNYXAoYXJyYXksIGl0ZXJhdGVlKSB7XG4gIHZhciBpbmRleCA9IC0xLFxuICAgICAgbGVuZ3RoID0gYXJyYXkubGVuZ3RoLFxuICAgICAgcmVzSW5kZXggPSAtMSxcbiAgICAgIHJlc3VsdCA9IFtdO1xuICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgIHZhciB2YWx1ZSA9IGFycmF5W2luZGV4XTtcbiAgICByZXN1bHRbKytyZXNJbmRleF0gPSBpdGVyYXRlZSh2YWx1ZSwgaW5kZXgsIGFycmF5KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gYXJyYXlFYWNoKGFycmF5LCBpdGVyYXRlZSkge1xuICB2YXIgaW5kZXggPSAtMSxcbiAgICAgIGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcbiAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICBpZiAoaXRlcmF0ZWUoYXJyYXlbaW5kZXhdLCBpbmRleCwgYXJyYXkpID09PSBmYWxzZSkge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG4gIHJldHVybiBhcnJheTtcbn1cbmZ1bmN0aW9uIGFycmF5U3VtKGFycmF5KSB7XG4gIHJldHVybiBhcnJheVJlZHVjZShhcnJheSwgKGZ1bmN0aW9uKGEsIGIpIHtcbiAgICByZXR1cm4gKGEgKyBiKTtcbiAgfSksIDApO1xufVxuZnVuY3Rpb24gYXJyYXlNYXgoYXJyYXkpIHtcbiAgcmV0dXJuIGFycmF5UmVkdWNlKGFycmF5LCAoZnVuY3Rpb24oYSwgYikge1xuICAgIHJldHVybiAoYSA+IGIgPyBhIDogYik7XG4gIH0pLCBBcnJheS5pc0FycmF5KGFycmF5KSA/IGFycmF5WzBdIDogdm9pZCAwKTtcbn1cbmZ1bmN0aW9uIGFycmF5TWluKGFycmF5KSB7XG4gIHJldHVybiBhcnJheVJlZHVjZShhcnJheSwgKGZ1bmN0aW9uKGEsIGIpIHtcbiAgICByZXR1cm4gKGEgPCBiID8gYSA6IGIpO1xuICB9KSwgQXJyYXkuaXNBcnJheShhcnJheSkgPyBhcnJheVswXSA6IHZvaWQgMCk7XG59XG5mdW5jdGlvbiBhcnJheUF2ZyhhcnJheSkge1xuICBpZiAoIWFycmF5Lmxlbmd0aCkge1xuICAgIHJldHVybiAwO1xuICB9XG4gIHJldHVybiBhcnJheVN1bShhcnJheSkgLyBhcnJheS5sZW5ndGg7XG59XG5mdW5jdGlvbiBhcnJheUZsYXR0ZW4oYXJyYXkpIHtcbiAgcmV0dXJuIGFycmF5UmVkdWNlKGFycmF5LCAoZnVuY3Rpb24oaW5pdGlhbCwgdmFsdWUpIHtcbiAgICByZXR1cm4gaW5pdGlhbC5jb25jYXQoQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyBhcnJheUZsYXR0ZW4odmFsdWUpIDogdmFsdWUpO1xuICB9KSwgW10pO1xufVxuZnVuY3Rpb24gYXJyYXlVbmlxdWUoYXJyYXkpIHtcbiAgdmFyIHVuaXF1ZSA9IFtdO1xuICBhcnJheUVhY2goYXJyYXksIChmdW5jdGlvbih2YWx1ZSkge1xuICAgIGlmICh1bmlxdWUuaW5kZXhPZih2YWx1ZSkgPT09IC0xKSB7XG4gICAgICB1bmlxdWUucHVzaCh2YWx1ZSk7XG4gICAgfVxuICB9KSk7XG4gIHJldHVybiB1bmlxdWU7XG59XG5mdW5jdGlvbiBhcnJheUluY2x1ZGVzKGFycmF5LCBzZWFyY2hFbGVtZW50LCBmcm9tSW5kZXgpIHtcbiAgaWYgKGFycmF5ID09IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdcImFycmF5XCIgaXMgbnVsbCBvciBub3QgZGVmaW5lZCcpO1xuICB9XG4gIHZhciBvID0gT2JqZWN0KGFycmF5KTtcbiAgdmFyIGxlbiA9IG8ubGVuZ3RoID4+PiAwO1xuICBpZiAobGVuID09PSAwKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHZhciBuID0gZnJvbUluZGV4IHwgMDtcbiAgdmFyIGsgPSBNYXRoLm1heChuID49IDAgPyBuIDogbGVuIC0gTWF0aC5hYnMobiksIDApO1xuICB3aGlsZSAoayA8IGxlbikge1xuICAgIGlmIChvW2tdID09PSBzZWFyY2hFbGVtZW50KSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaysrO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuLy8jIFxufSx7fV0sNDQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIGlzSUU4OiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBpc0lFODtcbiAgICB9fSxcbiAgaXNJRTk6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGlzSUU5O1xuICAgIH19LFxuICBpc1NhZmFyaToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gaXNTYWZhcmk7XG4gICAgfX0sXG4gIGlzQ2hyb21lOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBpc0Nocm9tZTtcbiAgICB9fSxcbiAgaXNNb2JpbGVCcm93c2VyOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBpc01vYmlsZUJyb3dzZXI7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyIF9pc0lFOCA9ICEoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJ3Rlc3QnKS50ZXh0Q29udGVudCk7XG5mdW5jdGlvbiBpc0lFOCgpIHtcbiAgcmV0dXJuIF9pc0lFODtcbn1cbnZhciBfaXNJRTkgPSAhIShkb2N1bWVudC5kb2N1bWVudE1vZGUpO1xuZnVuY3Rpb24gaXNJRTkoKSB7XG4gIHJldHVybiBfaXNJRTk7XG59XG52YXIgX2lzU2FmYXJpID0gKC9TYWZhcmkvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkgJiYgL0FwcGxlIENvbXB1dGVyLy50ZXN0KG5hdmlnYXRvci52ZW5kb3IpKTtcbmZ1bmN0aW9uIGlzU2FmYXJpKCkge1xuICByZXR1cm4gX2lzU2FmYXJpO1xufVxudmFyIF9pc0Nocm9tZSA9ICgvQ2hyb21lLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpICYmIC9Hb29nbGUvLnRlc3QobmF2aWdhdG9yLnZlbmRvcikpO1xuZnVuY3Rpb24gaXNDaHJvbWUoKSB7XG4gIHJldHVybiBfaXNDaHJvbWU7XG59XG5mdW5jdGlvbiBpc01vYmlsZUJyb3dzZXIodXNlckFnZW50KSB7XG4gIGlmICghdXNlckFnZW50KSB7XG4gICAgdXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcbiAgfVxuICByZXR1cm4gKC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdCh1c2VyQWdlbnQpKTtcbn1cblxuLy8jIFxufSx7fV0sNDU6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIHNwcmVhZHNoZWV0Q29sdW1uTGFiZWw6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHNwcmVhZHNoZWV0Q29sdW1uTGFiZWw7XG4gICAgfX0sXG4gIHNwcmVhZHNoZWV0Q29sdW1uSW5kZXg6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHNwcmVhZHNoZWV0Q29sdW1uSW5kZXg7XG4gICAgfX0sXG4gIGNyZWF0ZVNwcmVhZHNoZWV0RGF0YToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gY3JlYXRlU3ByZWFkc2hlZXREYXRhO1xuICAgIH19LFxuICBjcmVhdGVTcHJlYWRzaGVldE9iamVjdERhdGE6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGNyZWF0ZVNwcmVhZHNoZWV0T2JqZWN0RGF0YTtcbiAgICB9fSxcbiAgY3JlYXRlRW1wdHlTcHJlYWRzaGVldERhdGE6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGNyZWF0ZUVtcHR5U3ByZWFkc2hlZXREYXRhO1xuICAgIH19LFxuICB0cmFuc2xhdGVSb3dzVG9Db2x1bW5zOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0cmFuc2xhdGVSb3dzVG9Db2x1bW5zO1xuICAgIH19LFxuICBjZWxsTWV0aG9kTG9va3VwRmFjdG9yeToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gY2VsbE1ldGhvZExvb2t1cEZhY3Rvcnk7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19vYmplY3RfXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyAmJiAkX19fNDZfXzQ2X180N19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgZ2V0UHJvdG90eXBlT2YgPSAoJF9fb2JqZWN0X18gPSBfZGVyZXFfKFwib2JqZWN0XCIpLCAkX19vYmplY3RfXyAmJiAkX19vYmplY3RfXy5fX2VzTW9kdWxlICYmICRfX29iamVjdF9fIHx8IHtkZWZhdWx0OiAkX19vYmplY3RfX30pLmdldFByb3RvdHlwZU9mO1xudmFyIENPTFVNTl9MQUJFTF9CQVNFID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaJztcbnZhciBDT0xVTU5fTEFCRUxfQkFTRV9MRU5HVEggPSBDT0xVTU5fTEFCRUxfQkFTRS5sZW5ndGg7XG5mdW5jdGlvbiBzcHJlYWRzaGVldENvbHVtbkxhYmVsKGluZGV4KSB7XG4gIHZhciBkaXZpZGVuZCA9IGluZGV4ICsgMTtcbiAgdmFyIGNvbHVtbkxhYmVsID0gJyc7XG4gIHZhciBtb2R1bG87XG4gIHdoaWxlIChkaXZpZGVuZCA+IDApIHtcbiAgICBtb2R1bG8gPSAoZGl2aWRlbmQgLSAxKSAlIENPTFVNTl9MQUJFTF9CQVNFX0xFTkdUSDtcbiAgICBjb2x1bW5MYWJlbCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoNjUgKyBtb2R1bG8pICsgY29sdW1uTGFiZWw7XG4gICAgZGl2aWRlbmQgPSBwYXJzZUludCgoZGl2aWRlbmQgLSBtb2R1bG8pIC8gQ09MVU1OX0xBQkVMX0JBU0VfTEVOR1RILCAxMCk7XG4gIH1cbiAgcmV0dXJuIGNvbHVtbkxhYmVsO1xufVxuZnVuY3Rpb24gc3ByZWFkc2hlZXRDb2x1bW5JbmRleChsYWJlbCkge1xuICB2YXIgcmVzdWx0ID0gMDtcbiAgaWYgKGxhYmVsKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsXG4gICAgICAgIGogPSBsYWJlbC5sZW5ndGggLSAxOyBpIDwgbGFiZWwubGVuZ3RoOyBpICs9IDEsIGogLT0gMSkge1xuICAgICAgcmVzdWx0ICs9IE1hdGgucG93KENPTFVNTl9MQUJFTF9CQVNFX0xFTkdUSCwgaikgKiAoQ09MVU1OX0xBQkVMX0JBU0UuaW5kZXhPZihsYWJlbFtpXSkgKyAxKTtcbiAgICB9XG4gIH1cbiAgLS1yZXN1bHQ7XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBjcmVhdGVTcHJlYWRzaGVldERhdGEoKSB7XG4gIHZhciByb3dzID0gYXJndW1lbnRzWzBdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1swXSA6IDEwMDtcbiAgdmFyIGNvbHVtbnMgPSBhcmd1bWVudHNbMV0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzFdIDogNDtcbiAgdmFyIF9yb3dzID0gW10sXG4gICAgICBpLFxuICAgICAgajtcbiAgZm9yIChpID0gMDsgaSA8IHJvd3M7IGkrKykge1xuICAgIHZhciByb3cgPSBbXTtcbiAgICBmb3IgKGogPSAwOyBqIDwgY29sdW1uczsgaisrKSB7XG4gICAgICByb3cucHVzaChzcHJlYWRzaGVldENvbHVtbkxhYmVsKGopICsgKGkgKyAxKSk7XG4gICAgfVxuICAgIF9yb3dzLnB1c2gocm93KTtcbiAgfVxuICByZXR1cm4gX3Jvd3M7XG59XG5mdW5jdGlvbiBjcmVhdGVTcHJlYWRzaGVldE9iamVjdERhdGEoKSB7XG4gIHZhciByb3dzID0gYXJndW1lbnRzWzBdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1swXSA6IDEwMDtcbiAgdmFyIGNvbENvdW50ID0gYXJndW1lbnRzWzFdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1sxXSA6IDQ7XG4gIHZhciBfcm93cyA9IFtdLFxuICAgICAgaSxcbiAgICAgIGo7XG4gIGZvciAoaSA9IDA7IGkgPCByb3dzOyBpKyspIHtcbiAgICB2YXIgcm93ID0ge307XG4gICAgZm9yIChqID0gMDsgaiA8IGNvbENvdW50OyBqKyspIHtcbiAgICAgIHJvd1sncHJvcCcgKyBqXSA9IHNwcmVhZHNoZWV0Q29sdW1uTGFiZWwoaikgKyAoaSArIDEpO1xuICAgIH1cbiAgICBfcm93cy5wdXNoKHJvdyk7XG4gIH1cbiAgcmV0dXJuIF9yb3dzO1xufVxuZnVuY3Rpb24gY3JlYXRlRW1wdHlTcHJlYWRzaGVldERhdGEocm93cywgY29sdW1ucykge1xuICB2YXIgZGF0YSA9IFtdO1xuICB2YXIgcm93O1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHJvd3M7IGkrKykge1xuICAgIHJvdyA9IFtdO1xuICAgIGZvciAodmFyIGogPSAwOyBqIDwgY29sdW1uczsgaisrKSB7XG4gICAgICByb3cucHVzaCgnJyk7XG4gICAgfVxuICAgIGRhdGEucHVzaChyb3cpO1xuICB9XG4gIHJldHVybiBkYXRhO1xufVxuZnVuY3Rpb24gdHJhbnNsYXRlUm93c1RvQ29sdW1ucyhpbnB1dCkge1xuICB2YXIgaSxcbiAgICAgIGlsZW4sXG4gICAgICBqLFxuICAgICAgamxlbixcbiAgICAgIG91dHB1dCA9IFtdLFxuICAgICAgb2xlbiA9IDA7XG4gIGZvciAoaSA9IDAsIGlsZW4gPSBpbnB1dC5sZW5ndGg7IGkgPCBpbGVuOyBpKyspIHtcbiAgICBmb3IgKGogPSAwLCBqbGVuID0gaW5wdXRbaV0ubGVuZ3RoOyBqIDwgamxlbjsgaisrKSB7XG4gICAgICBpZiAoaiA9PSBvbGVuKSB7XG4gICAgICAgIG91dHB1dC5wdXNoKFtdKTtcbiAgICAgICAgb2xlbisrO1xuICAgICAgfVxuICAgICAgb3V0cHV0W2pdLnB1c2goaW5wdXRbaV1bal0pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gb3V0cHV0O1xufVxuZnVuY3Rpb24gY2VsbE1ldGhvZExvb2t1cEZhY3RvcnkobWV0aG9kTmFtZSwgYWxsb3dVbmRlZmluZWQpIHtcbiAgYWxsb3dVbmRlZmluZWQgPSB0eXBlb2YgYWxsb3dVbmRlZmluZWQgPT0gJ3VuZGVmaW5lZCcgPyB0cnVlIDogYWxsb3dVbmRlZmluZWQ7XG4gIHJldHVybiBmdW5jdGlvbiBjZWxsTWV0aG9kTG9va3VwKHJvdywgY29sKSB7XG4gICAgcmV0dXJuIChmdW5jdGlvbiBnZXRNZXRob2RGcm9tUHJvcGVydGllcyhwcm9wZXJ0aWVzKSB7XG4gICAgICBpZiAoIXByb3BlcnRpZXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSBlbHNlIGlmIChwcm9wZXJ0aWVzLmhhc093blByb3BlcnR5KG1ldGhvZE5hbWUpICYmIHByb3BlcnRpZXNbbWV0aG9kTmFtZV0gIT09IHZvaWQgMCkge1xuICAgICAgICByZXR1cm4gcHJvcGVydGllc1ttZXRob2ROYW1lXTtcbiAgICAgIH0gZWxzZSBpZiAocHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eSgndHlwZScpICYmIHByb3BlcnRpZXMudHlwZSkge1xuICAgICAgICB2YXIgdHlwZTtcbiAgICAgICAgaWYgKHR5cGVvZiBwcm9wZXJ0aWVzLnR5cGUgIT0gJ3N0cmluZycpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NlbGwgdHlwZSBtdXN0IGJlIGEgc3RyaW5nICcpO1xuICAgICAgICB9XG4gICAgICAgIHR5cGUgPSB0cmFuc2xhdGVUeXBlTmFtZVRvT2JqZWN0KHByb3BlcnRpZXMudHlwZSk7XG4gICAgICAgIGlmICh0eXBlLmhhc093blByb3BlcnR5KG1ldGhvZE5hbWUpKSB7XG4gICAgICAgICAgcmV0dXJuIHR5cGVbbWV0aG9kTmFtZV07XG4gICAgICAgIH0gZWxzZSBpZiAoYWxsb3dVbmRlZmluZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBnZXRNZXRob2RGcm9tUHJvcGVydGllcyhnZXRQcm90b3R5cGVPZihwcm9wZXJ0aWVzKSk7XG4gICAgfSkodHlwZW9mIHJvdyA9PSAnbnVtYmVyJyA/IHRoaXMuZ2V0Q2VsbE1ldGEocm93LCBjb2wpIDogcm93KTtcbiAgfTtcbiAgZnVuY3Rpb24gdHJhbnNsYXRlVHlwZU5hbWVUb09iamVjdCh0eXBlTmFtZSkge1xuICAgIHZhciB0eXBlID0gSGFuZHNvbnRhYmxlLmNlbGxUeXBlc1t0eXBlTmFtZV07XG4gICAgaWYgKHR5cGVvZiB0eXBlID09ICd1bmRlZmluZWQnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBkZWNsYXJlZCBjZWxsIHR5cGUgXCInICsgdHlwZU5hbWUgKyAnXCIgYXMgYSBzdHJpbmcgdGhhdCBpcyBub3QgbWFwcGVkIHRvIGEga25vd24gb2JqZWN0LiAnICsgJ0NlbGwgdHlwZSBtdXN0IGJlIGFuIG9iamVjdCBvciBhIHN0cmluZyBtYXBwZWQgdG8gYW4gb2JqZWN0IGluIEhhbmRzb250YWJsZS5jZWxsVHlwZXMnKTtcbiAgICB9XG4gICAgcmV0dXJuIHR5cGU7XG4gIH1cbn1cblxuLy8jIFxufSx7XCJicm93c2VyXCI6MjQsXCJvYmplY3RcIjo1M31dLDQ2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBnZXROb3JtYWxpemVkRGF0ZToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZ2V0Tm9ybWFsaXplZERhdGU7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xuZnVuY3Rpb24gZ2V0Tm9ybWFsaXplZERhdGUoZGF0ZVN0cmluZykge1xuICB2YXIgbmF0aXZlRGF0ZSA9IG5ldyBEYXRlKGRhdGVTdHJpbmcpO1xuICBpZiAoIWlzTmFOKG5ldyBEYXRlKGRhdGVTdHJpbmcgKyAnVDAwOjAwJykuZ2V0RGF0ZSgpKSkge1xuICAgIHJldHVybiBuZXcgRGF0ZShuYXRpdmVEYXRlLmdldFRpbWUoKSArIG5hdGl2ZURhdGUuZ2V0VGltZXpvbmVPZmZzZXQoKSAqIDYwMDAwKTtcbiAgfVxuICByZXR1cm4gbmF0aXZlRGF0ZTtcbn1cblxuLy8jIFxufSx7fV0sNDc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIGdldFBhcmVudDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZ2V0UGFyZW50O1xuICAgIH19LFxuICBjbG9zZXN0OiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBjbG9zZXN0O1xuICAgIH19LFxuICBjbG9zZXN0RG93bjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gY2xvc2VzdERvd247XG4gICAgfX0sXG4gIGlzQ2hpbGRPZjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gaXNDaGlsZE9mO1xuICAgIH19LFxuICBpc0NoaWxkT2ZXZWJDb21wb25lbnRUYWJsZToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gaXNDaGlsZE9mV2ViQ29tcG9uZW50VGFibGU7XG4gICAgfX0sXG4gIHBvbHltZXJXcmFwOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBwb2x5bWVyV3JhcDtcbiAgICB9fSxcbiAgcG9seW1lclVud3JhcDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gcG9seW1lclVud3JhcDtcbiAgICB9fSxcbiAgaW5kZXg6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGluZGV4O1xuICAgIH19LFxuICBvdmVybGF5Q29udGFpbnNFbGVtZW50OiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBvdmVybGF5Q29udGFpbnNFbGVtZW50O1xuICAgIH19LFxuICBoYXNDbGFzczoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gaGFzQ2xhc3M7XG4gICAgfX0sXG4gIGFkZENsYXNzOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBhZGRDbGFzcztcbiAgICB9fSxcbiAgcmVtb3ZlQ2xhc3M6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHJlbW92ZUNsYXNzO1xuICAgIH19LFxuICByZW1vdmVUZXh0Tm9kZXM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHJlbW92ZVRleHROb2RlcztcbiAgICB9fSxcbiAgZW1wdHk6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGVtcHR5O1xuICAgIH19LFxuICBIVE1MX0NIQVJBQ1RFUlM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIEhUTUxfQ0hBUkFDVEVSUztcbiAgICB9fSxcbiAgZmFzdElubmVySFRNTDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZmFzdElubmVySFRNTDtcbiAgICB9fSxcbiAgZmFzdElubmVyVGV4dDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZmFzdElubmVyVGV4dDtcbiAgICB9fSxcbiAgaXNWaXNpYmxlOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBpc1Zpc2libGU7XG4gICAgfX0sXG4gIG9mZnNldDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gb2Zmc2V0O1xuICAgIH19LFxuICBnZXRXaW5kb3dTY3JvbGxUb3A6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGdldFdpbmRvd1Njcm9sbFRvcDtcbiAgICB9fSxcbiAgZ2V0V2luZG93U2Nyb2xsTGVmdDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZ2V0V2luZG93U2Nyb2xsTGVmdDtcbiAgICB9fSxcbiAgZ2V0U2Nyb2xsVG9wOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBnZXRTY3JvbGxUb3A7XG4gICAgfX0sXG4gIGdldFNjcm9sbExlZnQ6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGdldFNjcm9sbExlZnQ7XG4gICAgfX0sXG4gIGdldFNjcm9sbGFibGVFbGVtZW50OiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBnZXRTY3JvbGxhYmxlRWxlbWVudDtcbiAgICB9fSxcbiAgZ2V0VHJpbW1pbmdDb250YWluZXI6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGdldFRyaW1taW5nQ29udGFpbmVyO1xuICAgIH19LFxuICBnZXRTdHlsZToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZ2V0U3R5bGU7XG4gICAgfX0sXG4gIGdldENvbXB1dGVkU3R5bGU6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGdldENvbXB1dGVkU3R5bGU7XG4gICAgfX0sXG4gIG91dGVyV2lkdGg6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIG91dGVyV2lkdGg7XG4gICAgfX0sXG4gIG91dGVySGVpZ2h0OiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBvdXRlckhlaWdodDtcbiAgICB9fSxcbiAgaW5uZXJIZWlnaHQ6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGlubmVySGVpZ2h0O1xuICAgIH19LFxuICBpbm5lcldpZHRoOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBpbm5lcldpZHRoO1xuICAgIH19LFxuICBhZGRFdmVudDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gYWRkRXZlbnQ7XG4gICAgfX0sXG4gIHJlbW92ZUV2ZW50OiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiByZW1vdmVFdmVudDtcbiAgICB9fSxcbiAgZ2V0Q2FyZXRQb3NpdGlvbjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZ2V0Q2FyZXRQb3NpdGlvbjtcbiAgICB9fSxcbiAgZ2V0U2VsZWN0aW9uRW5kUG9zaXRpb246IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGdldFNlbGVjdGlvbkVuZFBvc2l0aW9uO1xuICAgIH19LFxuICBnZXRTZWxlY3Rpb25UZXh0OiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBnZXRTZWxlY3Rpb25UZXh0O1xuICAgIH19LFxuICBzZXRDYXJldFBvc2l0aW9uOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzZXRDYXJldFBvc2l0aW9uO1xuICAgIH19LFxuICBnZXRTY3JvbGxiYXJXaWR0aDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZ2V0U2Nyb2xsYmFyV2lkdGg7XG4gICAgfX0sXG4gIGhhc1ZlcnRpY2FsU2Nyb2xsYmFyOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBoYXNWZXJ0aWNhbFNjcm9sbGJhcjtcbiAgICB9fSxcbiAgaGFzSG9yaXpvbnRhbFNjcm9sbGJhcjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gaGFzSG9yaXpvbnRhbFNjcm9sbGJhcjtcbiAgICB9fSxcbiAgc2V0T3ZlcmxheVBvc2l0aW9uOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzZXRPdmVybGF5UG9zaXRpb247XG4gICAgfX0sXG4gIGdldENzc1RyYW5zZm9ybToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZ2V0Q3NzVHJhbnNmb3JtO1xuICAgIH19LFxuICByZXNldENzc1RyYW5zZm9ybToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gcmVzZXRDc3NUcmFuc2Zvcm07XG4gICAgfX0sXG4gIGlzSW5wdXQ6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGlzSW5wdXQ7XG4gICAgfX0sXG4gIGlzT3V0c2lkZUlucHV0OiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBpc091dHNpZGVJbnB1dDtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2ZlYXR1cmVfXztcbnZhciAkX18wID0gKCRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCIuLi9icm93c2VyXCIpLCAkX19fNDZfXzQ2X180N19icm93c2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19icm93c2VyX199KSxcbiAgICBpc0lFOCA9ICRfXzAuaXNJRTgsXG4gICAgaXNJRTkgPSAkX18wLmlzSUU5LFxuICAgIGlzU2FmYXJpID0gJF9fMC5pc1NhZmFyaTtcbnZhciBoYXNDYXB0aW9uUHJvYmxlbSA9ICgkX19fNDZfXzQ2X180N19mZWF0dXJlX18gPSBfZGVyZXFfKFwiLi4vZmVhdHVyZVwiKSwgJF9fXzQ2X180Nl9fNDdfZmVhdHVyZV9fICYmICRfX180Nl9fNDZfXzQ3X2ZlYXR1cmVfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2ZlYXR1cmVfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfZmVhdHVyZV9ffSkuaGFzQ2FwdGlvblByb2JsZW07XG5mdW5jdGlvbiBnZXRQYXJlbnQoZWxlbWVudCkge1xuICB2YXIgbGV2ZWwgPSBhcmd1bWVudHNbMV0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzFdIDogMDtcbiAgdmFyIGl0ZXJhdGlvbiA9IC0xO1xuICB2YXIgcGFyZW50ID0gbnVsbDtcbiAgd2hpbGUgKGVsZW1lbnQgIT0gbnVsbCkge1xuICAgIGlmIChpdGVyYXRpb24gPT09IGxldmVsKSB7XG4gICAgICBwYXJlbnQgPSBlbGVtZW50O1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGlmIChlbGVtZW50Lmhvc3QgJiYgZWxlbWVudC5ub2RlVHlwZSA9PT0gTm9kZS5ET0NVTUVOVF9GUkFHTUVOVF9OT0RFKSB7XG4gICAgICBlbGVtZW50ID0gZWxlbWVudC5ob3N0O1xuICAgIH0gZWxzZSB7XG4gICAgICBpdGVyYXRpb24rKztcbiAgICAgIGVsZW1lbnQgPSBlbGVtZW50LnBhcmVudE5vZGU7XG4gICAgfVxuICB9XG4gIHJldHVybiBwYXJlbnQ7XG59XG5mdW5jdGlvbiBjbG9zZXN0KGVsZW1lbnQsIG5vZGVzLCB1bnRpbCkge1xuICB3aGlsZSAoZWxlbWVudCAhPSBudWxsICYmIGVsZW1lbnQgIT09IHVudGlsKSB7XG4gICAgaWYgKGVsZW1lbnQubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFICYmIChub2Rlcy5pbmRleE9mKGVsZW1lbnQubm9kZU5hbWUpID4gLTEgfHwgbm9kZXMuaW5kZXhPZihlbGVtZW50KSA+IC0xKSkge1xuICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgfVxuICAgIGlmIChlbGVtZW50Lmhvc3QgJiYgZWxlbWVudC5ub2RlVHlwZSA9PT0gTm9kZS5ET0NVTUVOVF9GUkFHTUVOVF9OT0RFKSB7XG4gICAgICBlbGVtZW50ID0gZWxlbWVudC5ob3N0O1xuICAgIH0gZWxzZSB7XG4gICAgICBlbGVtZW50ID0gZWxlbWVudC5wYXJlbnROb2RlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cbmZ1bmN0aW9uIGNsb3Nlc3REb3duKGVsZW1lbnQsIG5vZGVzLCB1bnRpbCkge1xuICB2YXIgbWF0Y2hlZCA9IFtdO1xuICB3aGlsZSAoZWxlbWVudCkge1xuICAgIGVsZW1lbnQgPSBjbG9zZXN0KGVsZW1lbnQsIG5vZGVzLCB1bnRpbCk7XG4gICAgaWYgKCFlbGVtZW50IHx8ICh1bnRpbCAmJiAhdW50aWwuY29udGFpbnMoZWxlbWVudCkpKSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgbWF0Y2hlZC5wdXNoKGVsZW1lbnQpO1xuICAgIGlmIChlbGVtZW50Lmhvc3QgJiYgZWxlbWVudC5ub2RlVHlwZSA9PT0gTm9kZS5ET0NVTUVOVF9GUkFHTUVOVF9OT0RFKSB7XG4gICAgICBlbGVtZW50ID0gZWxlbWVudC5ob3N0O1xuICAgIH0gZWxzZSB7XG4gICAgICBlbGVtZW50ID0gZWxlbWVudC5wYXJlbnROb2RlO1xuICAgIH1cbiAgfVxuICB2YXIgbGVuZ3RoID0gbWF0Y2hlZC5sZW5ndGg7XG4gIHJldHVybiBsZW5ndGggPyBtYXRjaGVkW2xlbmd0aCAtIDFdIDogbnVsbDtcbn1cbmZ1bmN0aW9uIGlzQ2hpbGRPZihjaGlsZCwgcGFyZW50KSB7XG4gIHZhciBub2RlID0gY2hpbGQucGFyZW50Tm9kZTtcbiAgdmFyIHF1ZXJpZWRQYXJlbnRzID0gW107XG4gIGlmICh0eXBlb2YgcGFyZW50ID09PSAnc3RyaW5nJykge1xuICAgIHF1ZXJpZWRQYXJlbnRzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChwYXJlbnQpLCAwKTtcbiAgfSBlbHNlIHtcbiAgICBxdWVyaWVkUGFyZW50cy5wdXNoKHBhcmVudCk7XG4gIH1cbiAgd2hpbGUgKG5vZGUgIT0gbnVsbCkge1xuICAgIGlmIChxdWVyaWVkUGFyZW50cy5pbmRleE9mKG5vZGUpID4gLTEpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGlzQ2hpbGRPZldlYkNvbXBvbmVudFRhYmxlKGVsZW1lbnQpIHtcbiAgdmFyIGhvdFRhYmxlTmFtZSA9ICdob3QtdGFibGUnLFxuICAgICAgcmVzdWx0ID0gZmFsc2UsXG4gICAgICBwYXJlbnROb2RlO1xuICBwYXJlbnROb2RlID0gcG9seW1lcldyYXAoZWxlbWVudCk7XG4gIGZ1bmN0aW9uIGlzSG90VGFibGUoZWxlbWVudCkge1xuICAgIHJldHVybiBlbGVtZW50Lm5vZGVUeXBlID09PSBOb2RlLkVMRU1FTlRfTk9ERSAmJiBlbGVtZW50Lm5vZGVOYW1lID09PSBob3RUYWJsZU5hbWUudG9VcHBlckNhc2UoKTtcbiAgfVxuICB3aGlsZSAocGFyZW50Tm9kZSAhPSBudWxsKSB7XG4gICAgaWYgKGlzSG90VGFibGUocGFyZW50Tm9kZSkpIHtcbiAgICAgIHJlc3VsdCA9IHRydWU7XG4gICAgICBicmVhaztcbiAgICB9IGVsc2UgaWYgKHBhcmVudE5vZGUuaG9zdCAmJiBwYXJlbnROb2RlLm5vZGVUeXBlID09PSBOb2RlLkRPQ1VNRU5UX0ZSQUdNRU5UX05PREUpIHtcbiAgICAgIHJlc3VsdCA9IGlzSG90VGFibGUocGFyZW50Tm9kZS5ob3N0KTtcbiAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBwYXJlbnROb2RlID0gcGFyZW50Tm9kZS5ob3N0O1xuICAgIH1cbiAgICBwYXJlbnROb2RlID0gcGFyZW50Tm9kZS5wYXJlbnROb2RlO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBwb2x5bWVyV3JhcChlbGVtZW50KSB7XG4gIHJldHVybiB0eXBlb2YgUG9seW1lciAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHdyYXAgPT09ICdmdW5jdGlvbicgPyB3cmFwKGVsZW1lbnQpIDogZWxlbWVudDtcbn1cbmZ1bmN0aW9uIHBvbHltZXJVbndyYXAoZWxlbWVudCkge1xuICByZXR1cm4gdHlwZW9mIFBvbHltZXIgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiB1bndyYXAgPT09ICdmdW5jdGlvbicgPyB1bndyYXAoZWxlbWVudCkgOiBlbGVtZW50O1xufVxuZnVuY3Rpb24gaW5kZXgoZWxlbWVudCkge1xuICB2YXIgaSA9IDA7XG4gIGlmIChlbGVtZW50LnByZXZpb3VzU2libGluZykge1xuICAgIHdoaWxlIChlbGVtZW50ID0gZWxlbWVudC5wcmV2aW91c1NpYmxpbmcpIHtcbiAgICAgICsraTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGk7XG59XG5mdW5jdGlvbiBvdmVybGF5Q29udGFpbnNFbGVtZW50KG92ZXJsYXlUeXBlLCBlbGVtZW50KSB7XG4gIHZhciBvdmVybGF5RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5odF9jbG9uZV8nICsgb3ZlcmxheVR5cGUpO1xuICByZXR1cm4gb3ZlcmxheUVsZW1lbnQgPyBvdmVybGF5RWxlbWVudC5jb250YWlucyhlbGVtZW50KSA6IG51bGw7XG59XG52YXIgY2xhc3NMaXN0U3VwcG9ydCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QgPyB0cnVlIDogZmFsc2U7XG52YXIgX2hhc0NsYXNzLFxuICAgIF9hZGRDbGFzcyxcbiAgICBfcmVtb3ZlQ2xhc3M7XG5mdW5jdGlvbiBmaWx0ZXJFbXB0eUNsYXNzTmFtZXMoY2xhc3NOYW1lcykge1xuICB2YXIgbGVuID0gMCxcbiAgICAgIHJlc3VsdCA9IFtdO1xuICBpZiAoIWNsYXNzTmFtZXMgfHwgIWNsYXNzTmFtZXMubGVuZ3RoKSB7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuICB3aGlsZSAoY2xhc3NOYW1lc1tsZW5dKSB7XG4gICAgcmVzdWx0LnB1c2goY2xhc3NOYW1lc1tsZW5dKTtcbiAgICBsZW4rKztcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuaWYgKGNsYXNzTGlzdFN1cHBvcnQpIHtcbiAgdmFyIGlzU3VwcG9ydE11bHRpcGxlQ2xhc3Nlc0FyZyA9IChmdW5jdGlvbigpIHtcbiAgICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgndGVzdCcsICd0ZXN0MicpO1xuICAgIHJldHVybiBlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygndGVzdDInKTtcbiAgfSgpKTtcbiAgX2hhc0NsYXNzID0gZnVuY3Rpb24gX2hhc0NsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICAgIGlmIChjbGFzc05hbWUgPT09ICcnKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiBlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpO1xuICB9O1xuICBfYWRkQ2xhc3MgPSBmdW5jdGlvbiBfYWRkQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKSB7XG4gICAgdmFyIGxlbiA9IDA7XG4gICAgaWYgKHR5cGVvZiBjbGFzc05hbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICBjbGFzc05hbWUgPSBjbGFzc05hbWUuc3BsaXQoJyAnKTtcbiAgICB9XG4gICAgY2xhc3NOYW1lID0gZmlsdGVyRW1wdHlDbGFzc05hbWVzKGNsYXNzTmFtZSk7XG4gICAgaWYgKGlzU3VwcG9ydE11bHRpcGxlQ2xhc3Nlc0FyZykge1xuICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkLmFwcGx5KGVsZW1lbnQuY2xhc3NMaXN0LCBjbGFzc05hbWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB3aGlsZSAoY2xhc3NOYW1lICYmIGNsYXNzTmFtZVtsZW5dKSB7XG4gICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChjbGFzc05hbWVbbGVuXSk7XG4gICAgICAgIGxlbisrO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgX3JlbW92ZUNsYXNzID0gZnVuY3Rpb24gX3JlbW92ZUNsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICAgIHZhciBsZW4gPSAwO1xuICAgIGlmICh0eXBlb2YgY2xhc3NOYW1lID09PSAnc3RyaW5nJykge1xuICAgICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lLnNwbGl0KCcgJyk7XG4gICAgfVxuICAgIGNsYXNzTmFtZSA9IGZpbHRlckVtcHR5Q2xhc3NOYW1lcyhjbGFzc05hbWUpO1xuICAgIGlmIChpc1N1cHBvcnRNdWx0aXBsZUNsYXNzZXNBcmcpIHtcbiAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZS5hcHBseShlbGVtZW50LmNsYXNzTGlzdCwgY2xhc3NOYW1lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2hpbGUgKGNsYXNzTmFtZSAmJiBjbGFzc05hbWVbbGVuXSkge1xuICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lW2xlbl0pO1xuICAgICAgICBsZW4rKztcbiAgICAgIH1cbiAgICB9XG4gIH07XG59IGVsc2Uge1xuICB2YXIgY3JlYXRlQ2xhc3NOYW1lUmVnRXhwID0gZnVuY3Rpb24gY3JlYXRlQ2xhc3NOYW1lUmVnRXhwKGNsYXNzTmFtZSkge1xuICAgIHJldHVybiBuZXcgUmVnRXhwKCcoXFxcXHN8XiknICsgY2xhc3NOYW1lICsgJyhcXFxcc3wkKScpO1xuICB9O1xuICBfaGFzQ2xhc3MgPSBmdW5jdGlvbiBfaGFzQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKSB7XG4gICAgcmV0dXJuIGVsZW1lbnQuY2xhc3NOYW1lLm1hdGNoKGNyZWF0ZUNsYXNzTmFtZVJlZ0V4cChjbGFzc05hbWUpKSA/IHRydWUgOiBmYWxzZTtcbiAgfTtcbiAgX2FkZENsYXNzID0gZnVuY3Rpb24gX2FkZENsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICAgIHZhciBsZW4gPSAwLFxuICAgICAgICBfY2xhc3NOYW1lID0gZWxlbWVudC5jbGFzc05hbWU7XG4gICAgaWYgKHR5cGVvZiBjbGFzc05hbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICBjbGFzc05hbWUgPSBjbGFzc05hbWUuc3BsaXQoJyAnKTtcbiAgICB9XG4gICAgaWYgKF9jbGFzc05hbWUgPT09ICcnKSB7XG4gICAgICBfY2xhc3NOYW1lID0gY2xhc3NOYW1lLmpvaW4oJyAnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2hpbGUgKGNsYXNzTmFtZSAmJiBjbGFzc05hbWVbbGVuXSkge1xuICAgICAgICBpZiAoIWNyZWF0ZUNsYXNzTmFtZVJlZ0V4cChjbGFzc05hbWVbbGVuXSkudGVzdChfY2xhc3NOYW1lKSkge1xuICAgICAgICAgIF9jbGFzc05hbWUgKz0gJyAnICsgY2xhc3NOYW1lW2xlbl07XG4gICAgICAgIH1cbiAgICAgICAgbGVuKys7XG4gICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnQuY2xhc3NOYW1lID0gX2NsYXNzTmFtZTtcbiAgfTtcbiAgX3JlbW92ZUNsYXNzID0gZnVuY3Rpb24gX3JlbW92ZUNsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICAgIHZhciBsZW4gPSAwLFxuICAgICAgICBfY2xhc3NOYW1lID0gZWxlbWVudC5jbGFzc05hbWU7XG4gICAgaWYgKHR5cGVvZiBjbGFzc05hbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICBjbGFzc05hbWUgPSBjbGFzc05hbWUuc3BsaXQoJyAnKTtcbiAgICB9XG4gICAgd2hpbGUgKGNsYXNzTmFtZSAmJiBjbGFzc05hbWVbbGVuXSkge1xuICAgICAgX2NsYXNzTmFtZSA9IF9jbGFzc05hbWUucmVwbGFjZShjcmVhdGVDbGFzc05hbWVSZWdFeHAoY2xhc3NOYW1lW2xlbl0pLCAnICcpLnRyaW0oKTtcbiAgICAgIGxlbisrO1xuICAgIH1cbiAgICBpZiAoZWxlbWVudC5jbGFzc05hbWUgIT09IF9jbGFzc05hbWUpIHtcbiAgICAgIGVsZW1lbnQuY2xhc3NOYW1lID0gX2NsYXNzTmFtZTtcbiAgICB9XG4gIH07XG59XG5mdW5jdGlvbiBoYXNDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpIHtcbiAgcmV0dXJuIF9oYXNDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpO1xufVxuZnVuY3Rpb24gYWRkQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKSB7XG4gIHJldHVybiBfYWRkQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKTtcbn1cbmZ1bmN0aW9uIHJlbW92ZUNsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICByZXR1cm4gX3JlbW92ZUNsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSk7XG59XG5mdW5jdGlvbiByZW1vdmVUZXh0Tm9kZXMoZWxlbWVudCwgcGFyZW50KSB7XG4gIGlmIChlbGVtZW50Lm5vZGVUeXBlID09PSAzKSB7XG4gICAgcGFyZW50LnJlbW92ZUNoaWxkKGVsZW1lbnQpO1xuICB9IGVsc2UgaWYgKFsnVEFCTEUnLCAnVEhFQUQnLCAnVEJPRFknLCAnVEZPT1QnLCAnVFInXS5pbmRleE9mKGVsZW1lbnQubm9kZU5hbWUpID4gLTEpIHtcbiAgICB2YXIgY2hpbGRzID0gZWxlbWVudC5jaGlsZE5vZGVzO1xuICAgIGZvciAodmFyIGkgPSBjaGlsZHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIHJlbW92ZVRleHROb2RlcyhjaGlsZHNbaV0sIGVsZW1lbnQpO1xuICAgIH1cbiAgfVxufVxuZnVuY3Rpb24gZW1wdHkoZWxlbWVudCkge1xuICB2YXIgY2hpbGQ7XG4gIHdoaWxlIChjaGlsZCA9IGVsZW1lbnQubGFzdENoaWxkKSB7XG4gICAgZWxlbWVudC5yZW1vdmVDaGlsZChjaGlsZCk7XG4gIH1cbn1cbnZhciBIVE1MX0NIQVJBQ1RFUlMgPSAvKDwoLiopPnwmKC4qKTspLztcbmZ1bmN0aW9uIGZhc3RJbm5lckhUTUwoZWxlbWVudCwgY29udGVudCkge1xuICBpZiAoSFRNTF9DSEFSQUNURVJTLnRlc3QoY29udGVudCkpIHtcbiAgICBlbGVtZW50LmlubmVySFRNTCA9IGNvbnRlbnQ7XG4gIH0gZWxzZSB7XG4gICAgZmFzdElubmVyVGV4dChlbGVtZW50LCBjb250ZW50KTtcbiAgfVxufVxudmFyIHRleHRDb250ZXh0U3VwcG9ydCA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCd0ZXN0JykudGV4dENvbnRlbnQgPyB0cnVlIDogZmFsc2U7XG5mdW5jdGlvbiBmYXN0SW5uZXJUZXh0KGVsZW1lbnQsIGNvbnRlbnQpIHtcbiAgdmFyIGNoaWxkID0gZWxlbWVudC5maXJzdENoaWxkO1xuICBpZiAoY2hpbGQgJiYgY2hpbGQubm9kZVR5cGUgPT09IDMgJiYgY2hpbGQubmV4dFNpYmxpbmcgPT09IG51bGwpIHtcbiAgICBpZiAodGV4dENvbnRleHRTdXBwb3J0KSB7XG4gICAgICBjaGlsZC50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNoaWxkLmRhdGEgPSBjb250ZW50O1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBlbXB0eShlbGVtZW50KTtcbiAgICBlbGVtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNvbnRlbnQpKTtcbiAgfVxufVxuZnVuY3Rpb24gaXNWaXNpYmxlKGVsZW0pIHtcbiAgdmFyIG5leHQgPSBlbGVtO1xuICB3aGlsZSAocG9seW1lclVud3JhcChuZXh0KSAhPT0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KSB7XG4gICAgaWYgKG5leHQgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9IGVsc2UgaWYgKG5leHQubm9kZVR5cGUgPT09IE5vZGUuRE9DVU1FTlRfRlJBR01FTlRfTk9ERSkge1xuICAgICAgaWYgKG5leHQuaG9zdCkge1xuICAgICAgICBpZiAobmV4dC5ob3N0LmltcGwpIHtcbiAgICAgICAgICByZXR1cm4gaXNWaXNpYmxlKG5leHQuaG9zdC5pbXBsKTtcbiAgICAgICAgfSBlbHNlIGlmIChuZXh0Lmhvc3QpIHtcbiAgICAgICAgICByZXR1cm4gaXNWaXNpYmxlKG5leHQuaG9zdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdMb3N0IGluIFdlYiBDb21wb25lbnRzIHdvcmxkJyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKG5leHQuc3R5bGUuZGlzcGxheSA9PT0gJ25vbmUnKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIG5leHQgPSBuZXh0LnBhcmVudE5vZGU7XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5mdW5jdGlvbiBvZmZzZXQoZWxlbSkge1xuICB2YXIgb2Zmc2V0TGVmdCxcbiAgICAgIG9mZnNldFRvcCxcbiAgICAgIGxhc3RFbGVtLFxuICAgICAgZG9jRWxlbSxcbiAgICAgIGJveDtcbiAgZG9jRWxlbSA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcbiAgaWYgKGhhc0NhcHRpb25Qcm9ibGVtKCkgJiYgZWxlbS5maXJzdENoaWxkICYmIGVsZW0uZmlyc3RDaGlsZC5ub2RlTmFtZSA9PT0gJ0NBUFRJT04nKSB7XG4gICAgYm94ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICByZXR1cm4ge1xuICAgICAgdG9wOiBib3gudG9wICsgKHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2NFbGVtLnNjcm9sbFRvcCkgLSAoZG9jRWxlbS5jbGllbnRUb3AgfHwgMCksXG4gICAgICBsZWZ0OiBib3gubGVmdCArICh3aW5kb3cucGFnZVhPZmZzZXQgfHwgZG9jRWxlbS5zY3JvbGxMZWZ0KSAtIChkb2NFbGVtLmNsaWVudExlZnQgfHwgMClcbiAgICB9O1xuICB9XG4gIG9mZnNldExlZnQgPSBlbGVtLm9mZnNldExlZnQ7XG4gIG9mZnNldFRvcCA9IGVsZW0ub2Zmc2V0VG9wO1xuICBsYXN0RWxlbSA9IGVsZW07XG4gIHdoaWxlIChlbGVtID0gZWxlbS5vZmZzZXRQYXJlbnQpIHtcbiAgICBpZiAoZWxlbSA9PT0gZG9jdW1lbnQuYm9keSkge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIG9mZnNldExlZnQgKz0gZWxlbS5vZmZzZXRMZWZ0O1xuICAgIG9mZnNldFRvcCArPSBlbGVtLm9mZnNldFRvcDtcbiAgICBsYXN0RWxlbSA9IGVsZW07XG4gIH1cbiAgaWYgKGxhc3RFbGVtICYmIGxhc3RFbGVtLnN0eWxlLnBvc2l0aW9uID09PSAnZml4ZWQnKSB7XG4gICAgb2Zmc2V0TGVmdCArPSB3aW5kb3cucGFnZVhPZmZzZXQgfHwgZG9jRWxlbS5zY3JvbGxMZWZ0O1xuICAgIG9mZnNldFRvcCArPSB3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jRWxlbS5zY3JvbGxUb3A7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBsZWZ0OiBvZmZzZXRMZWZ0LFxuICAgIHRvcDogb2Zmc2V0VG9wXG4gIH07XG59XG5mdW5jdGlvbiBnZXRXaW5kb3dTY3JvbGxUb3AoKSB7XG4gIHZhciByZXMgPSB3aW5kb3cuc2Nyb2xsWTtcbiAgaWYgKHJlcyA9PT0gdm9pZCAwKSB7XG4gICAgcmVzID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtcbiAgfVxuICByZXR1cm4gcmVzO1xufVxuZnVuY3Rpb24gZ2V0V2luZG93U2Nyb2xsTGVmdCgpIHtcbiAgdmFyIHJlcyA9IHdpbmRvdy5zY3JvbGxYO1xuICBpZiAocmVzID09PSB2b2lkIDApIHtcbiAgICByZXMgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdDtcbiAgfVxuICByZXR1cm4gcmVzO1xufVxuZnVuY3Rpb24gZ2V0U2Nyb2xsVG9wKGVsZW1lbnQpIHtcbiAgaWYgKGVsZW1lbnQgPT09IHdpbmRvdykge1xuICAgIHJldHVybiBnZXRXaW5kb3dTY3JvbGxUb3AoKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZWxlbWVudC5zY3JvbGxUb3A7XG4gIH1cbn1cbmZ1bmN0aW9uIGdldFNjcm9sbExlZnQoZWxlbWVudCkge1xuICBpZiAoZWxlbWVudCA9PT0gd2luZG93KSB7XG4gICAgcmV0dXJuIGdldFdpbmRvd1Njcm9sbExlZnQoKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZWxlbWVudC5zY3JvbGxMZWZ0O1xuICB9XG59XG5mdW5jdGlvbiBnZXRTY3JvbGxhYmxlRWxlbWVudChlbGVtZW50KSB7XG4gIHZhciBlbCA9IGVsZW1lbnQucGFyZW50Tm9kZSxcbiAgICAgIHByb3BzID0gWydhdXRvJywgJ3Njcm9sbCddLFxuICAgICAgb3ZlcmZsb3csXG4gICAgICBvdmVyZmxvd1gsXG4gICAgICBvdmVyZmxvd1ksXG4gICAgICBjb21wdXRlZFN0eWxlID0gJycsXG4gICAgICBjb21wdXRlZE92ZXJmbG93ID0gJycsXG4gICAgICBjb21wdXRlZE92ZXJmbG93WSA9ICcnLFxuICAgICAgY29tcHV0ZWRPdmVyZmxvd1ggPSAnJztcbiAgd2hpbGUgKGVsICYmIGVsLnN0eWxlICYmIGRvY3VtZW50LmJvZHkgIT09IGVsKSB7XG4gICAgb3ZlcmZsb3cgPSBlbC5zdHlsZS5vdmVyZmxvdztcbiAgICBvdmVyZmxvd1ggPSBlbC5zdHlsZS5vdmVyZmxvd1g7XG4gICAgb3ZlcmZsb3dZID0gZWwuc3R5bGUub3ZlcmZsb3dZO1xuICAgIGlmIChvdmVyZmxvdyA9PSAnc2Nyb2xsJyB8fCBvdmVyZmxvd1ggPT0gJ3Njcm9sbCcgfHwgb3ZlcmZsb3dZID09ICdzY3JvbGwnKSB7XG4gICAgICByZXR1cm4gZWw7XG4gICAgfSBlbHNlIGlmICh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSkge1xuICAgICAgY29tcHV0ZWRTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsKTtcbiAgICAgIGNvbXB1dGVkT3ZlcmZsb3cgPSBjb21wdXRlZFN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ292ZXJmbG93Jyk7XG4gICAgICBjb21wdXRlZE92ZXJmbG93WSA9IGNvbXB1dGVkU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnb3ZlcmZsb3cteScpO1xuICAgICAgY29tcHV0ZWRPdmVyZmxvd1ggPSBjb21wdXRlZFN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ292ZXJmbG93LXgnKTtcbiAgICAgIGlmIChjb21wdXRlZE92ZXJmbG93ID09PSAnc2Nyb2xsJyB8fCBjb21wdXRlZE92ZXJmbG93WCA9PT0gJ3Njcm9sbCcgfHwgY29tcHV0ZWRPdmVyZmxvd1kgPT09ICdzY3JvbGwnKSB7XG4gICAgICAgIHJldHVybiBlbDtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGVsLmNsaWVudEhlaWdodCA8PSBlbC5zY3JvbGxIZWlnaHQgJiYgKHByb3BzLmluZGV4T2Yob3ZlcmZsb3dZKSAhPT0gLTEgfHwgcHJvcHMuaW5kZXhPZihvdmVyZmxvdykgIT09IC0xIHx8IHByb3BzLmluZGV4T2YoY29tcHV0ZWRPdmVyZmxvdykgIT09IC0xIHx8IHByb3BzLmluZGV4T2YoY29tcHV0ZWRPdmVyZmxvd1kpICE9PSAtMSkpIHtcbiAgICAgIHJldHVybiBlbDtcbiAgICB9XG4gICAgaWYgKGVsLmNsaWVudFdpZHRoIDw9IGVsLnNjcm9sbFdpZHRoICYmIChwcm9wcy5pbmRleE9mKG92ZXJmbG93WCkgIT09IC0xIHx8IHByb3BzLmluZGV4T2Yob3ZlcmZsb3cpICE9PSAtMSB8fCBwcm9wcy5pbmRleE9mKGNvbXB1dGVkT3ZlcmZsb3cpICE9PSAtMSB8fCBwcm9wcy5pbmRleE9mKGNvbXB1dGVkT3ZlcmZsb3dYKSAhPT0gLTEpKSB7XG4gICAgICByZXR1cm4gZWw7XG4gICAgfVxuICAgIGVsID0gZWwucGFyZW50Tm9kZTtcbiAgfVxuICByZXR1cm4gd2luZG93O1xufVxuZnVuY3Rpb24gZ2V0VHJpbW1pbmdDb250YWluZXIoYmFzZSkge1xuICB2YXIgZWwgPSBiYXNlLnBhcmVudE5vZGU7XG4gIHdoaWxlIChlbCAmJiBlbC5zdHlsZSAmJiBkb2N1bWVudC5ib2R5ICE9PSBlbCkge1xuICAgIGlmIChlbC5zdHlsZS5vdmVyZmxvdyAhPT0gJ3Zpc2libGUnICYmIGVsLnN0eWxlLm92ZXJmbG93ICE9PSAnJykge1xuICAgICAgcmV0dXJuIGVsO1xuICAgIH0gZWxzZSBpZiAod2luZG93LmdldENvbXB1dGVkU3R5bGUpIHtcbiAgICAgIHZhciBjb21wdXRlZFN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWwpO1xuICAgICAgaWYgKGNvbXB1dGVkU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnb3ZlcmZsb3cnKSAhPT0gJ3Zpc2libGUnICYmIGNvbXB1dGVkU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnb3ZlcmZsb3cnKSAhPT0gJycpIHtcbiAgICAgICAgcmV0dXJuIGVsO1xuICAgICAgfVxuICAgIH1cbiAgICBlbCA9IGVsLnBhcmVudE5vZGU7XG4gIH1cbiAgcmV0dXJuIHdpbmRvdztcbn1cbmZ1bmN0aW9uIGdldFN0eWxlKGVsZW1lbnQsIHByb3ApIHtcbiAgaWYgKCFlbGVtZW50KSB7XG4gICAgcmV0dXJuO1xuICB9IGVsc2UgaWYgKGVsZW1lbnQgPT09IHdpbmRvdykge1xuICAgIGlmIChwcm9wID09PSAnd2lkdGgnKSB7XG4gICAgICByZXR1cm4gd2luZG93LmlubmVyV2lkdGggKyAncHgnO1xuICAgIH0gZWxzZSBpZiAocHJvcCA9PT0gJ2hlaWdodCcpIHtcbiAgICAgIHJldHVybiB3aW5kb3cuaW5uZXJIZWlnaHQgKyAncHgnO1xuICAgIH1cbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIHN0eWxlUHJvcCA9IGVsZW1lbnQuc3R5bGVbcHJvcF0sXG4gICAgICBjb21wdXRlZFN0eWxlO1xuICBpZiAoc3R5bGVQcm9wICE9PSAnJyAmJiBzdHlsZVByb3AgIT09IHZvaWQgMCkge1xuICAgIHJldHVybiBzdHlsZVByb3A7XG4gIH0gZWxzZSB7XG4gICAgY29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCk7XG4gICAgaWYgKGNvbXB1dGVkU3R5bGVbcHJvcF0gIT09ICcnICYmIGNvbXB1dGVkU3R5bGVbcHJvcF0gIT09IHZvaWQgMCkge1xuICAgICAgcmV0dXJuIGNvbXB1dGVkU3R5bGVbcHJvcF07XG4gICAgfVxuICAgIHJldHVybiB2b2lkIDA7XG4gIH1cbn1cbmZ1bmN0aW9uIGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCkge1xuICByZXR1cm4gZWxlbWVudC5jdXJyZW50U3R5bGUgfHwgZG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KTtcbn1cbmZ1bmN0aW9uIG91dGVyV2lkdGgoZWxlbWVudCkge1xuICByZXR1cm4gZWxlbWVudC5vZmZzZXRXaWR0aDtcbn1cbmZ1bmN0aW9uIG91dGVySGVpZ2h0KGVsZW0pIHtcbiAgaWYgKGhhc0NhcHRpb25Qcm9ibGVtKCkgJiYgZWxlbS5maXJzdENoaWxkICYmIGVsZW0uZmlyc3RDaGlsZC5ub2RlTmFtZSA9PT0gJ0NBUFRJT04nKSB7XG4gICAgcmV0dXJuIGVsZW0ub2Zmc2V0SGVpZ2h0ICsgZWxlbS5maXJzdENoaWxkLm9mZnNldEhlaWdodDtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZWxlbS5vZmZzZXRIZWlnaHQ7XG4gIH1cbn1cbmZ1bmN0aW9uIGlubmVySGVpZ2h0KGVsZW1lbnQpIHtcbiAgcmV0dXJuIGVsZW1lbnQuY2xpZW50SGVpZ2h0IHx8IGVsZW1lbnQuaW5uZXJIZWlnaHQ7XG59XG5mdW5jdGlvbiBpbm5lcldpZHRoKGVsZW1lbnQpIHtcbiAgcmV0dXJuIGVsZW1lbnQuY2xpZW50V2lkdGggfHwgZWxlbWVudC5pbm5lcldpZHRoO1xufVxuZnVuY3Rpb24gYWRkRXZlbnQoZWxlbWVudCwgZXZlbnQsIGNhbGxiYWNrKSB7XG4gIGlmICh3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcikge1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgY2FsbGJhY2ssIGZhbHNlKTtcbiAgfSBlbHNlIHtcbiAgICBlbGVtZW50LmF0dGFjaEV2ZW50KCdvbicgKyBldmVudCwgY2FsbGJhY2spO1xuICB9XG59XG5mdW5jdGlvbiByZW1vdmVFdmVudChlbGVtZW50LCBldmVudCwgY2FsbGJhY2spIHtcbiAgaWYgKHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKSB7XG4gICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBjYWxsYmFjaywgZmFsc2UpO1xuICB9IGVsc2Uge1xuICAgIGVsZW1lbnQuZGV0YWNoRXZlbnQoJ29uJyArIGV2ZW50LCBjYWxsYmFjayk7XG4gIH1cbn1cbmZ1bmN0aW9uIGdldENhcmV0UG9zaXRpb24oZWwpIHtcbiAgaWYgKGVsLnNlbGVjdGlvblN0YXJ0KSB7XG4gICAgcmV0dXJuIGVsLnNlbGVjdGlvblN0YXJ0O1xuICB9IGVsc2UgaWYgKGRvY3VtZW50LnNlbGVjdGlvbikge1xuICAgIGVsLmZvY3VzKCk7XG4gICAgdmFyIHIgPSBkb2N1bWVudC5zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKTtcbiAgICBpZiAociA9PSBudWxsKSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgdmFyIHJlID0gZWwuY3JlYXRlVGV4dFJhbmdlKCk7XG4gICAgdmFyIHJjID0gcmUuZHVwbGljYXRlKCk7XG4gICAgcmUubW92ZVRvQm9va21hcmsoci5nZXRCb29rbWFyaygpKTtcbiAgICByYy5zZXRFbmRQb2ludCgnRW5kVG9TdGFydCcsIHJlKTtcbiAgICByZXR1cm4gcmMudGV4dC5sZW5ndGg7XG4gIH1cbiAgcmV0dXJuIDA7XG59XG5mdW5jdGlvbiBnZXRTZWxlY3Rpb25FbmRQb3NpdGlvbihlbCkge1xuICBpZiAoZWwuc2VsZWN0aW9uRW5kKSB7XG4gICAgcmV0dXJuIGVsLnNlbGVjdGlvbkVuZDtcbiAgfSBlbHNlIGlmIChkb2N1bWVudC5zZWxlY3Rpb24pIHtcbiAgICB2YXIgciA9IGRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpO1xuICAgIGlmIChyID09IG51bGwpIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICB2YXIgcmUgPSBlbC5jcmVhdGVUZXh0UmFuZ2UoKTtcbiAgICByZXR1cm4gcmUudGV4dC5pbmRleE9mKHIudGV4dCkgKyByLnRleHQubGVuZ3RoO1xuICB9XG59XG5mdW5jdGlvbiBnZXRTZWxlY3Rpb25UZXh0KCkge1xuICB2YXIgdGV4dCA9ICcnO1xuICBpZiAod2luZG93LmdldFNlbGVjdGlvbikge1xuICAgIHRleHQgPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCkudG9TdHJpbmcoKTtcbiAgfSBlbHNlIGlmIChkb2N1bWVudC5zZWxlY3Rpb24gJiYgZG9jdW1lbnQuc2VsZWN0aW9uLnR5cGUgIT09ICdDb250cm9sJykge1xuICAgIHRleHQgPSBkb2N1bWVudC5zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKS50ZXh0O1xuICB9XG4gIHJldHVybiB0ZXh0O1xufVxuZnVuY3Rpb24gc2V0Q2FyZXRQb3NpdGlvbihlbGVtZW50LCBwb3MsIGVuZFBvcykge1xuICBpZiAoZW5kUG9zID09PSB2b2lkIDApIHtcbiAgICBlbmRQb3MgPSBwb3M7XG4gIH1cbiAgaWYgKGVsZW1lbnQuc2V0U2VsZWN0aW9uUmFuZ2UpIHtcbiAgICBlbGVtZW50LmZvY3VzKCk7XG4gICAgdHJ5IHtcbiAgICAgIGVsZW1lbnQuc2V0U2VsZWN0aW9uUmFuZ2UocG9zLCBlbmRQb3MpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgdmFyIGVsZW1lbnRQYXJlbnQgPSBlbGVtZW50LnBhcmVudE5vZGU7XG4gICAgICB2YXIgcGFyZW50RGlzcGxheVZhbHVlID0gZWxlbWVudFBhcmVudC5zdHlsZS5kaXNwbGF5O1xuICAgICAgZWxlbWVudFBhcmVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgIGVsZW1lbnQuc2V0U2VsZWN0aW9uUmFuZ2UocG9zLCBlbmRQb3MpO1xuICAgICAgZWxlbWVudFBhcmVudC5zdHlsZS5kaXNwbGF5ID0gcGFyZW50RGlzcGxheVZhbHVlO1xuICAgIH1cbiAgfSBlbHNlIGlmIChlbGVtZW50LmNyZWF0ZVRleHRSYW5nZSkge1xuICAgIHZhciByYW5nZSA9IGVsZW1lbnQuY3JlYXRlVGV4dFJhbmdlKCk7XG4gICAgcmFuZ2UuY29sbGFwc2UodHJ1ZSk7XG4gICAgcmFuZ2UubW92ZUVuZCgnY2hhcmFjdGVyJywgZW5kUG9zKTtcbiAgICByYW5nZS5tb3ZlU3RhcnQoJ2NoYXJhY3RlcicsIHBvcyk7XG4gICAgcmFuZ2Uuc2VsZWN0KCk7XG4gIH1cbn1cbnZhciBjYWNoZWRTY3JvbGxiYXJXaWR0aDtcbmZ1bmN0aW9uIHdhbGtvbnRhYmxlQ2FsY3VsYXRlU2Nyb2xsYmFyV2lkdGgoKSB7XG4gIHZhciBpbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBpbm5lci5zdHlsZS5oZWlnaHQgPSAnMjAwcHgnO1xuICBpbm5lci5zdHlsZS53aWR0aCA9ICcxMDAlJztcbiAgdmFyIG91dGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIG91dGVyLnN0eWxlLmJveFNpemluZyA9ICdjb250ZW50LWJveCc7XG4gIG91dGVyLnN0eWxlLmhlaWdodCA9ICcxNTBweCc7XG4gIG91dGVyLnN0eWxlLmxlZnQgPSAnMHB4JztcbiAgb3V0ZXIuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcbiAgb3V0ZXIuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICBvdXRlci5zdHlsZS50b3AgPSAnMHB4JztcbiAgb3V0ZXIuc3R5bGUud2lkdGggPSAnMjAwcHgnO1xuICBvdXRlci5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gIG91dGVyLmFwcGVuZENoaWxkKGlubmVyKTtcbiAgKGRvY3VtZW50LmJvZHkgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5hcHBlbmRDaGlsZChvdXRlcik7XG4gIHZhciB3MSA9IGlubmVyLm9mZnNldFdpZHRoO1xuICBvdXRlci5zdHlsZS5vdmVyZmxvdyA9ICdzY3JvbGwnO1xuICB2YXIgdzIgPSBpbm5lci5vZmZzZXRXaWR0aDtcbiAgaWYgKHcxID09IHcyKSB7XG4gICAgdzIgPSBvdXRlci5jbGllbnRXaWR0aDtcbiAgfVxuICAoZG9jdW1lbnQuYm9keSB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpLnJlbW92ZUNoaWxkKG91dGVyKTtcbiAgcmV0dXJuICh3MSAtIHcyKTtcbn1cbmZ1bmN0aW9uIGdldFNjcm9sbGJhcldpZHRoKCkge1xuICBpZiAoY2FjaGVkU2Nyb2xsYmFyV2lkdGggPT09IHZvaWQgMCkge1xuICAgIGNhY2hlZFNjcm9sbGJhcldpZHRoID0gd2Fsa29udGFibGVDYWxjdWxhdGVTY3JvbGxiYXJXaWR0aCgpO1xuICB9XG4gIHJldHVybiBjYWNoZWRTY3JvbGxiYXJXaWR0aDtcbn1cbmZ1bmN0aW9uIGhhc1ZlcnRpY2FsU2Nyb2xsYmFyKGVsZW1lbnQpIHtcbiAgcmV0dXJuIGVsZW1lbnQub2Zmc2V0V2lkdGggIT09IGVsZW1lbnQuY2xpZW50V2lkdGg7XG59XG5mdW5jdGlvbiBoYXNIb3Jpem9udGFsU2Nyb2xsYmFyKGVsZW1lbnQpIHtcbiAgcmV0dXJuIGVsZW1lbnQub2Zmc2V0SGVpZ2h0ICE9PSBlbGVtZW50LmNsaWVudEhlaWdodDtcbn1cbmZ1bmN0aW9uIHNldE92ZXJsYXlQb3NpdGlvbihvdmVybGF5RWxlbSwgbGVmdCwgdG9wKSB7XG4gIGlmIChpc0lFOCgpIHx8IGlzSUU5KCkpIHtcbiAgICBvdmVybGF5RWxlbS5zdHlsZS50b3AgPSB0b3A7XG4gICAgb3ZlcmxheUVsZW0uc3R5bGUubGVmdCA9IGxlZnQ7XG4gIH0gZWxzZSBpZiAoaXNTYWZhcmkoKSkge1xuICAgIG92ZXJsYXlFbGVtLnN0eWxlWyctd2Via2l0LXRyYW5zZm9ybSddID0gJ3RyYW5zbGF0ZTNkKCcgKyBsZWZ0ICsgJywnICsgdG9wICsgJywwKSc7XG4gIH0gZWxzZSB7XG4gICAgb3ZlcmxheUVsZW0uc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZTNkKCcgKyBsZWZ0ICsgJywnICsgdG9wICsgJywwKSc7XG4gIH1cbn1cbmZ1bmN0aW9uIGdldENzc1RyYW5zZm9ybShlbGVtZW50KSB7XG4gIHZhciB0cmFuc2Zvcm07XG4gIGlmIChlbGVtZW50LnN0eWxlLnRyYW5zZm9ybSAmJiAodHJhbnNmb3JtID0gZWxlbWVudC5zdHlsZS50cmFuc2Zvcm0pICE9PSAnJykge1xuICAgIHJldHVybiBbJ3RyYW5zZm9ybScsIHRyYW5zZm9ybV07XG4gIH0gZWxzZSBpZiAoZWxlbWVudC5zdHlsZVsnLXdlYmtpdC10cmFuc2Zvcm0nXSAmJiAodHJhbnNmb3JtID0gZWxlbWVudC5zdHlsZVsnLXdlYmtpdC10cmFuc2Zvcm0nXSkgIT09ICcnKSB7XG4gICAgcmV0dXJuIFsnLXdlYmtpdC10cmFuc2Zvcm0nLCB0cmFuc2Zvcm1dO1xuICB9XG4gIHJldHVybiAtMTtcbn1cbmZ1bmN0aW9uIHJlc2V0Q3NzVHJhbnNmb3JtKGVsZW1lbnQpIHtcbiAgaWYgKGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtICYmIGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtICE9PSAnJykge1xuICAgIGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJyc7XG4gIH0gZWxzZSBpZiAoZWxlbWVudC5zdHlsZVsnLXdlYmtpdC10cmFuc2Zvcm0nXSAmJiBlbGVtZW50LnN0eWxlWyctd2Via2l0LXRyYW5zZm9ybSddICE9PSAnJykge1xuICAgIGVsZW1lbnQuc3R5bGVbJy13ZWJraXQtdHJhbnNmb3JtJ10gPSAnJztcbiAgfVxufVxuZnVuY3Rpb24gaXNJbnB1dChlbGVtZW50KSB7XG4gIHZhciBpbnB1dHMgPSBbJ0lOUFVUJywgJ1NFTEVDVCcsICdURVhUQVJFQSddO1xuICByZXR1cm4gZWxlbWVudCAmJiAoaW5wdXRzLmluZGV4T2YoZWxlbWVudC5ub2RlTmFtZSkgPiAtMSB8fCBlbGVtZW50LmNvbnRlbnRFZGl0YWJsZSA9PT0gJ3RydWUnKTtcbn1cbmZ1bmN0aW9uIGlzT3V0c2lkZUlucHV0KGVsZW1lbnQpIHtcbiAgcmV0dXJuIGlzSW5wdXQoZWxlbWVudCkgJiYgZWxlbWVudC5jbGFzc05hbWUuaW5kZXhPZignaGFuZHNvbnRhYmxlSW5wdXQnKSA9PSAtMSAmJiBlbGVtZW50LmNsYXNzTmFtZS5pbmRleE9mKCdjb3B5UGFzdGUnKSA9PSAtMTtcbn1cblxuLy8jIFxufSx7XCIuLi9icm93c2VyXCI6NDQsXCIuLi9mZWF0dXJlXCI6NDl9XSw0ODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb247XG4gICAgfX0sXG4gIGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZDtcbiAgICB9fSxcbiAgc3RvcFByb3BhZ2F0aW9uOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzdG9wUHJvcGFnYXRpb247XG4gICAgfX0sXG4gIHBhZ2VYOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBwYWdlWDtcbiAgICB9fSxcbiAgcGFnZVk6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHBhZ2VZO1xuICAgIH19LFxuICBpc1JpZ2h0Q2xpY2s6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGlzUmlnaHRDbGljaztcbiAgICB9fSxcbiAgaXNMZWZ0Q2xpY2s6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGlzTGVmdENsaWNrO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19lbGVtZW50X187XG52YXIgJF9fMCA9ICgkX19lbGVtZW50X18gPSBfZGVyZXFfKFwiZWxlbWVudFwiKSwgJF9fZWxlbWVudF9fICYmICRfX2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fZWxlbWVudF9ffSksXG4gICAgZ2V0V2luZG93U2Nyb2xsVG9wID0gJF9fMC5nZXRXaW5kb3dTY3JvbGxUb3AsXG4gICAgZ2V0V2luZG93U2Nyb2xsTGVmdCA9ICRfXzAuZ2V0V2luZG93U2Nyb2xsTGVmdDtcbmZ1bmN0aW9uIHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbihldmVudCkge1xuICBldmVudC5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uRW5hYmxlZCA9IGZhbHNlO1xuICBldmVudC5jYW5jZWxCdWJibGUgPSB0cnVlO1xufVxuZnVuY3Rpb24gaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoZXZlbnQpIHtcbiAgcmV0dXJuIGV2ZW50LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25FbmFibGVkID09PSBmYWxzZTtcbn1cbmZ1bmN0aW9uIHN0b3BQcm9wYWdhdGlvbihldmVudCkge1xuICBpZiAodHlwZW9mIGV2ZW50LnN0b3BQcm9wYWdhdGlvbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICB9IGVsc2Uge1xuICAgIGV2ZW50LmNhbmNlbEJ1YmJsZSA9IHRydWU7XG4gIH1cbn1cbmZ1bmN0aW9uIHBhZ2VYKGV2ZW50KSB7XG4gIGlmIChldmVudC5wYWdlWCkge1xuICAgIHJldHVybiBldmVudC5wYWdlWDtcbiAgfVxuICByZXR1cm4gZXZlbnQuY2xpZW50WCArIGdldFdpbmRvd1Njcm9sbExlZnQoKTtcbn1cbmZ1bmN0aW9uIHBhZ2VZKGV2ZW50KSB7XG4gIGlmIChldmVudC5wYWdlWSkge1xuICAgIHJldHVybiBldmVudC5wYWdlWTtcbiAgfVxuICByZXR1cm4gZXZlbnQuY2xpZW50WSArIGdldFdpbmRvd1Njcm9sbFRvcCgpO1xufVxuZnVuY3Rpb24gaXNSaWdodENsaWNrKGV2ZW50KSB7XG4gIHJldHVybiBldmVudC5idXR0b24gPT09IDI7XG59XG5mdW5jdGlvbiBpc0xlZnRDbGljayhldmVudCkge1xuICByZXR1cm4gZXZlbnQuYnV0dG9uID09PSAwO1xufVxuXG4vLyMgXG59LHtcImVsZW1lbnRcIjo0N31dLDQ5OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICByZXF1ZXN0QW5pbWF0aW9uRnJhbWU6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHJlcXVlc3RBbmltYXRpb25GcmFtZTtcbiAgICB9fSxcbiAgY2FuY2VsQW5pbWF0aW9uRnJhbWU6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGNhbmNlbEFuaW1hdGlvbkZyYW1lO1xuICAgIH19LFxuICBpc1RvdWNoU3VwcG9ydGVkOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBpc1RvdWNoU3VwcG9ydGVkO1xuICAgIH19LFxuICBpc1dlYkNvbXBvbmVudFN1cHBvcnRlZE5hdGl2ZWx5OiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBpc1dlYkNvbXBvbmVudFN1cHBvcnRlZE5hdGl2ZWx5O1xuICAgIH19LFxuICBoYXNDYXB0aW9uUHJvYmxlbToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gaGFzQ2FwdGlvblByb2JsZW07XG4gICAgfX0sXG4gIGdldENvbXBhcmlzb25GdW5jdGlvbjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZ2V0Q29tcGFyaXNvbkZ1bmN0aW9uO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciBsYXN0VGltZSA9IDA7XG52YXIgdmVuZG9ycyA9IFsnbXMnLCAnbW96JywgJ3dlYmtpdCcsICdvJ107XG52YXIgX3JlcXVlc3RBbmltYXRpb25GcmFtZSA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU7XG52YXIgX2NhbmNlbEFuaW1hdGlvbkZyYW1lID0gd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lO1xuZm9yICh2YXIgeCA9IDA7IHggPCB2ZW5kb3JzLmxlbmd0aCAmJiAhX3JlcXVlc3RBbmltYXRpb25GcmFtZTsgKyt4KSB7XG4gIF9yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSB3aW5kb3dbdmVuZG9yc1t4XSArICdSZXF1ZXN0QW5pbWF0aW9uRnJhbWUnXTtcbiAgX2NhbmNlbEFuaW1hdGlvbkZyYW1lID0gd2luZG93W3ZlbmRvcnNbeF0gKyAnQ2FuY2VsQW5pbWF0aW9uRnJhbWUnXSB8fCB3aW5kb3dbdmVuZG9yc1t4XSArICdDYW5jZWxSZXF1ZXN0QW5pbWF0aW9uRnJhbWUnXTtcbn1cbmlmICghX3JlcXVlc3RBbmltYXRpb25GcmFtZSkge1xuICBfcmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICB2YXIgY3VyclRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICB2YXIgdGltZVRvQ2FsbCA9IE1hdGgubWF4KDAsIDE2IC0gKGN1cnJUaW1lIC0gbGFzdFRpbWUpKTtcbiAgICB2YXIgaWQgPSB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgIGNhbGxiYWNrKGN1cnJUaW1lICsgdGltZVRvQ2FsbCk7XG4gICAgfSwgdGltZVRvQ2FsbCk7XG4gICAgbGFzdFRpbWUgPSBjdXJyVGltZSArIHRpbWVUb0NhbGw7XG4gICAgcmV0dXJuIGlkO1xuICB9O1xufVxuaWYgKCFfY2FuY2VsQW5pbWF0aW9uRnJhbWUpIHtcbiAgX2NhbmNlbEFuaW1hdGlvbkZyYW1lID0gZnVuY3Rpb24oaWQpIHtcbiAgICBjbGVhclRpbWVvdXQoaWQpO1xuICB9O1xufVxuZnVuY3Rpb24gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGNhbGxiYWNrKSB7XG4gIHJldHVybiBfcmVxdWVzdEFuaW1hdGlvbkZyYW1lLmNhbGwod2luZG93LCBjYWxsYmFjayk7XG59XG5mdW5jdGlvbiBjYW5jZWxBbmltYXRpb25GcmFtZShpZCkge1xuICBfY2FuY2VsQW5pbWF0aW9uRnJhbWUuY2FsbCh3aW5kb3csIGlkKTtcbn1cbmZ1bmN0aW9uIGlzVG91Y2hTdXBwb3J0ZWQoKSB7XG4gIHJldHVybiAoJ29udG91Y2hzdGFydCcgaW4gd2luZG93KTtcbn1cbmZ1bmN0aW9uIGlzV2ViQ29tcG9uZW50U3VwcG9ydGVkTmF0aXZlbHkoKSB7XG4gIHZhciB0ZXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIHJldHVybiB0ZXN0LmNyZWF0ZVNoYWRvd1Jvb3QgJiYgdGVzdC5jcmVhdGVTaGFkb3dSb290LnRvU3RyaW5nKCkubWF0Y2goL1xcW25hdGl2ZSBjb2RlXFxdLykgPyB0cnVlIDogZmFsc2U7XG59XG52YXIgX2hhc0NhcHRpb25Qcm9ibGVtO1xuZnVuY3Rpb24gZGV0ZWN0Q2FwdGlvblByb2JsZW0oKSB7XG4gIHZhciBUQUJMRSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ1RBQkxFJyk7XG4gIFRBQkxFLnN0eWxlLmJvcmRlclNwYWNpbmcgPSAwO1xuICBUQUJMRS5zdHlsZS5ib3JkZXJXaWR0aCA9IDA7XG4gIFRBQkxFLnN0eWxlLnBhZGRpbmcgPSAwO1xuICB2YXIgVEJPRFkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdUQk9EWScpO1xuICBUQUJMRS5hcHBlbmRDaGlsZChUQk9EWSk7XG4gIFRCT0RZLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ1RSJykpO1xuICBUQk9EWS5maXJzdENoaWxkLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ1REJykpO1xuICBUQk9EWS5maXJzdENoaWxkLmZpcnN0Q2hpbGQuaW5uZXJIVE1MID0gJzx0cj48dGQ+dDxicj50PC90ZD48L3RyPic7XG4gIHZhciBDQVBUSU9OID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnQ0FQVElPTicpO1xuICBDQVBUSU9OLmlubmVySFRNTCA9ICdjPGJyPmM8YnI+Yzxicj5jJztcbiAgQ0FQVElPTi5zdHlsZS5wYWRkaW5nID0gMDtcbiAgQ0FQVElPTi5zdHlsZS5tYXJnaW4gPSAwO1xuICBUQUJMRS5pbnNlcnRCZWZvcmUoQ0FQVElPTiwgVEJPRFkpO1xuICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKFRBQkxFKTtcbiAgX2hhc0NhcHRpb25Qcm9ibGVtID0gKFRBQkxFLm9mZnNldEhlaWdodCA8IDIgKiBUQUJMRS5sYXN0Q2hpbGQub2Zmc2V0SGVpZ2h0KTtcbiAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChUQUJMRSk7XG59XG5mdW5jdGlvbiBoYXNDYXB0aW9uUHJvYmxlbSgpIHtcbiAgaWYgKF9oYXNDYXB0aW9uUHJvYmxlbSA9PT0gdm9pZCAwKSB7XG4gICAgZGV0ZWN0Q2FwdGlvblByb2JsZW0oKTtcbiAgfVxuICByZXR1cm4gX2hhc0NhcHRpb25Qcm9ibGVtO1xufVxudmFyIGNvbXBhcmlzb25GdW5jdGlvbjtcbmZ1bmN0aW9uIGdldENvbXBhcmlzb25GdW5jdGlvbihsYW5ndWFnZSkge1xuICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50c1sxXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMV0gOiB7fTtcbiAgaWYgKGNvbXBhcmlzb25GdW5jdGlvbikge1xuICAgIHJldHVybiBjb21wYXJpc29uRnVuY3Rpb247XG4gIH1cbiAgaWYgKHR5cGVvZiBJbnRsID09PSAnb2JqZWN0Jykge1xuICAgIGNvbXBhcmlzb25GdW5jdGlvbiA9IG5ldyBJbnRsLkNvbGxhdG9yKGxhbmd1YWdlLCBvcHRpb25zKS5jb21wYXJlO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBTdHJpbmcucHJvdG90eXBlLmxvY2FsZUNvbXBhcmUgPT09ICdmdW5jdGlvbicpIHtcbiAgICBjb21wYXJpc29uRnVuY3Rpb24gPSAoZnVuY3Rpb24oYSwgYikge1xuICAgICAgcmV0dXJuIChhICsgJycpLmxvY2FsZUNvbXBhcmUoYik7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgY29tcGFyaXNvbkZ1bmN0aW9uID0gKGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgIGlmIChhID09PSBiKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGEgPiBiID8gLTEgOiAxO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiBjb21wYXJpc29uRnVuY3Rpb247XG59XG5cbi8vIyBcbn0se31dLDUwOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBpc0Z1bmN0aW9uOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBpc0Z1bmN0aW9uO1xuICAgIH19LFxuICBwcm94eToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gcHJveHk7XG4gICAgfX0sXG4gIHRocm90dGxlOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aHJvdHRsZTtcbiAgICB9fSxcbiAgdGhyb3R0bGVBZnRlckhpdHM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRocm90dGxlQWZ0ZXJIaXRzO1xuICAgIH19LFxuICBkZWJvdW5jZToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZGVib3VuY2U7XG4gICAgfX0sXG4gIHBpcGU6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHBpcGU7XG4gICAgfX0sXG4gIHBhcnRpYWw6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHBhcnRpYWw7XG4gICAgfX0sXG4gIGN1cnJ5OiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBjdXJyeTtcbiAgICB9fSxcbiAgY3VycnlSaWdodDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gY3VycnlSaWdodDtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fYXJyYXlfXztcbnZhciBhcnJheVJlZHVjZSA9ICgkX19hcnJheV9fID0gX2RlcmVxXyhcImFycmF5XCIpLCAkX19hcnJheV9fICYmICRfX2FycmF5X18uX19lc01vZHVsZSAmJiAkX19hcnJheV9fIHx8IHtkZWZhdWx0OiAkX19hcnJheV9ffSkuYXJyYXlSZWR1Y2U7XG5mdW5jdGlvbiBpc0Z1bmN0aW9uKGZ1bmMpIHtcbiAgcmV0dXJuIHR5cGVvZiBmdW5jID09PSAnZnVuY3Rpb24nO1xufVxuZnVuY3Rpb24gcHJveHkoZnVuYywgY29udGV4dCkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJndW1lbnRzKTtcbiAgfTtcbn1cbmZ1bmN0aW9uIHRocm90dGxlKGZ1bmMpIHtcbiAgdmFyIHdhaXQgPSBhcmd1bWVudHNbMV0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzFdIDogMjAwO1xuICB2YXIgbGFzdENhbGxlZCA9IDA7XG4gIHZhciByZXN1bHQgPSB7bGFzdENhbGxUaHJvdHRsZWQ6IHRydWV9O1xuICB2YXIgbGFzdFRpbWVyID0gbnVsbDtcbiAgZnVuY3Rpb24gX3Rocm90dGxlKCkge1xuICAgIHZhciAkX18xID0gdGhpcztcbiAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICB2YXIgc3RhbXAgPSBEYXRlLm5vdygpO1xuICAgIHZhciBuZWVkQ2FsbCA9IGZhbHNlO1xuICAgIHJlc3VsdC5sYXN0Q2FsbFRocm90dGxlZCA9IHRydWU7XG4gICAgaWYgKCFsYXN0Q2FsbGVkKSB7XG4gICAgICBsYXN0Q2FsbGVkID0gc3RhbXA7XG4gICAgICBuZWVkQ2FsbCA9IHRydWU7XG4gICAgfVxuICAgIHZhciByZW1haW5pbmcgPSB3YWl0IC0gKHN0YW1wIC0gbGFzdENhbGxlZCk7XG4gICAgaWYgKG5lZWRDYWxsKSB7XG4gICAgICByZXN1bHQubGFzdENhbGxUaHJvdHRsZWQgPSBmYWxzZTtcbiAgICAgIGZ1bmMuYXBwbHkodGhpcywgYXJncyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChsYXN0VGltZXIpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KGxhc3RUaW1lcik7XG4gICAgICB9XG4gICAgICBsYXN0VGltZXIgPSBzZXRUaW1lb3V0KChmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzdWx0Lmxhc3RDYWxsVGhyb3R0bGVkID0gZmFsc2U7XG4gICAgICAgIGZ1bmMuYXBwbHkoJF9fMSwgYXJncyk7XG4gICAgICAgIGxhc3RDYWxsZWQgPSAwO1xuICAgICAgICBsYXN0VGltZXIgPSB2b2lkIDA7XG4gICAgICB9KSwgcmVtYWluaW5nKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuICByZXR1cm4gX3Rocm90dGxlO1xufVxuZnVuY3Rpb24gdGhyb3R0bGVBZnRlckhpdHMoZnVuYykge1xuICB2YXIgd2FpdCA9IGFyZ3VtZW50c1sxXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMV0gOiAyMDA7XG4gIHZhciBoaXRzID0gYXJndW1lbnRzWzJdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1syXSA6IDEwO1xuICB2YXIgZnVuY1Rocm90dGxlID0gdGhyb3R0bGUoZnVuYywgd2FpdCk7XG4gIHZhciByZW1haW5IaXRzID0gaGl0cztcbiAgZnVuY3Rpb24gX2NsZWFySGl0cygpIHtcbiAgICByZW1haW5IaXRzID0gaGl0cztcbiAgfVxuICBmdW5jdGlvbiBfdGhyb3R0bGVBZnRlckhpdHMoKSB7XG4gICAgaWYgKHJlbWFpbkhpdHMpIHtcbiAgICAgIHJlbWFpbkhpdHMtLTtcbiAgICAgIHJldHVybiBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuICAgIHJldHVybiBmdW5jVGhyb3R0bGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuICBfdGhyb3R0bGVBZnRlckhpdHMuY2xlYXJIaXRzID0gX2NsZWFySGl0cztcbiAgcmV0dXJuIF90aHJvdHRsZUFmdGVySGl0cztcbn1cbmZ1bmN0aW9uIGRlYm91bmNlKGZ1bmMpIHtcbiAgdmFyIHdhaXQgPSBhcmd1bWVudHNbMV0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzFdIDogMjAwO1xuICB2YXIgbGFzdFRpbWVyID0gbnVsbDtcbiAgdmFyIHJlc3VsdDtcbiAgZnVuY3Rpb24gX2RlYm91bmNlKCkge1xuICAgIHZhciAkX18xID0gdGhpcztcbiAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICBpZiAobGFzdFRpbWVyKSB7XG4gICAgICBjbGVhclRpbWVvdXQobGFzdFRpbWVyKTtcbiAgICB9XG4gICAgbGFzdFRpbWVyID0gc2V0VGltZW91dCgoZnVuY3Rpb24oKSB7XG4gICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KCRfXzEsIGFyZ3MpO1xuICAgIH0pLCB3YWl0KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG4gIHJldHVybiBfZGVib3VuY2U7XG59XG5mdW5jdGlvbiBwaXBlKCkge1xuICBmb3IgKHZhciBmdW5jdGlvbnMgPSBbXSxcbiAgICAgICRfXzIgPSAwOyAkX18yIDwgYXJndW1lbnRzLmxlbmd0aDsgJF9fMisrKVxuICAgIGZ1bmN0aW9uc1skX18yXSA9IGFyZ3VtZW50c1skX18yXTtcbiAgdmFyICRfXzUgPSBmdW5jdGlvbnMsXG4gICAgICBmaXJzdEZ1bmMgPSAkX181WzBdLFxuICAgICAgcmVzdEZ1bmMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCgkX181LCAxKTtcbiAgcmV0dXJuIGZ1bmN0aW9uIF9waXBlKCkge1xuICAgIHJldHVybiBhcnJheVJlZHVjZShyZXN0RnVuYywgKGZ1bmN0aW9uKGFjYywgZm4pIHtcbiAgICAgIHJldHVybiBmbihhY2MpO1xuICAgIH0pLCBmaXJzdEZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7XG4gIH07XG59XG5mdW5jdGlvbiBwYXJ0aWFsKGZ1bmMpIHtcbiAgZm9yICh2YXIgcGFyYW1zID0gW10sXG4gICAgICAkX18zID0gMTsgJF9fMyA8IGFyZ3VtZW50cy5sZW5ndGg7ICRfXzMrKylcbiAgICBwYXJhbXNbJF9fMyAtIDFdID0gYXJndW1lbnRzWyRfXzNdO1xuICByZXR1cm4gZnVuY3Rpb24gX3BhcnRpYWwoKSB7XG4gICAgZm9yICh2YXIgcmVzdFBhcmFtcyA9IFtdLFxuICAgICAgICAkX180ID0gMDsgJF9fNCA8IGFyZ3VtZW50cy5sZW5ndGg7ICRfXzQrKylcbiAgICAgIHJlc3RQYXJhbXNbJF9fNF0gPSBhcmd1bWVudHNbJF9fNF07XG4gICAgcmV0dXJuIGZ1bmMuYXBwbHkodGhpcywgcGFyYW1zLmNvbmNhdChyZXN0UGFyYW1zKSk7XG4gIH07XG59XG5mdW5jdGlvbiBjdXJyeShmdW5jKSB7XG4gIHZhciBhcmdzTGVuZ3RoID0gZnVuYy5sZW5ndGg7XG4gIGZ1bmN0aW9uIGdpdmVuKGFyZ3NTb0Zhcikge1xuICAgIHJldHVybiBmdW5jdGlvbiBfY3VycnkoKSB7XG4gICAgICBmb3IgKHZhciBwYXJhbXMgPSBbXSxcbiAgICAgICAgICAkX180ID0gMDsgJF9fNCA8IGFyZ3VtZW50cy5sZW5ndGg7ICRfXzQrKylcbiAgICAgICAgcGFyYW1zWyRfXzRdID0gYXJndW1lbnRzWyRfXzRdO1xuICAgICAgdmFyIHBhc3NlZEFyZ3NTb0ZhciA9IGFyZ3NTb0Zhci5jb25jYXQocGFyYW1zKTtcbiAgICAgIHZhciByZXN1bHQ7XG4gICAgICBpZiAocGFzc2VkQXJnc1NvRmFyLmxlbmd0aCA+PSBhcmdzTGVuZ3RoKSB7XG4gICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkodGhpcywgcGFzc2VkQXJnc1NvRmFyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCA9IGdpdmVuKHBhc3NlZEFyZ3NTb0Zhcik7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gIH1cbiAgcmV0dXJuIGdpdmVuKFtdKTtcbn1cbmZ1bmN0aW9uIGN1cnJ5UmlnaHQoZnVuYykge1xuICB2YXIgYXJnc0xlbmd0aCA9IGZ1bmMubGVuZ3RoO1xuICBmdW5jdGlvbiBnaXZlbihhcmdzU29GYXIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gX2N1cnJ5KCkge1xuICAgICAgZm9yICh2YXIgcGFyYW1zID0gW10sXG4gICAgICAgICAgJF9fNCA9IDA7ICRfXzQgPCBhcmd1bWVudHMubGVuZ3RoOyAkX180KyspXG4gICAgICAgIHBhcmFtc1skX180XSA9IGFyZ3VtZW50c1skX180XTtcbiAgICAgIHZhciBwYXNzZWRBcmdzU29GYXIgPSBhcmdzU29GYXIuY29uY2F0KHBhcmFtcy5yZXZlcnNlKCkpO1xuICAgICAgdmFyIHJlc3VsdDtcbiAgICAgIGlmIChwYXNzZWRBcmdzU29GYXIubGVuZ3RoID49IGFyZ3NMZW5ndGgpIHtcbiAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseSh0aGlzLCBwYXNzZWRBcmdzU29GYXIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gZ2l2ZW4ocGFzc2VkQXJnc1NvRmFyKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgfVxuICByZXR1cm4gZ2l2ZW4oW10pO1xufVxuXG4vLyMgXG59LHtcImFycmF5XCI6NDN9XSw1MTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgc3RyaW5naWZ5OiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzdHJpbmdpZnk7XG4gICAgfX0sXG4gIGlzRGVmaW5lZDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gaXNEZWZpbmVkO1xuICAgIH19LFxuICBpc1VuZGVmaW5lZDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gaXNVbmRlZmluZWQ7XG4gICAgfX0sXG4gIGlzRW1wdHk6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGlzRW1wdHk7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xuZnVuY3Rpb24gc3RyaW5naWZ5KHZhbHVlKSB7XG4gIHN3aXRjaCAodHlwZW9mIHZhbHVlKSB7XG4gICAgY2FzZSAnc3RyaW5nJzpcbiAgICBjYXNlICdudW1iZXInOlxuICAgICAgcmV0dXJuIHZhbHVlICsgJyc7XG4gICAgY2FzZSAnb2JqZWN0JzpcbiAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ3VuZGVmaW5lZCc6XG4gICAgICByZXR1cm4gJyc7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiB2YWx1ZS50b1N0cmluZygpO1xuICB9XG59XG5mdW5jdGlvbiBpc0RlZmluZWQodmFyaWFibGUpIHtcbiAgcmV0dXJuIHR5cGVvZiB2YXJpYWJsZSAhPT0gJ3VuZGVmaW5lZCc7XG59XG5mdW5jdGlvbiBpc1VuZGVmaW5lZCh2YXJpYWJsZSkge1xuICByZXR1cm4gdHlwZW9mIHZhcmlhYmxlID09PSAndW5kZWZpbmVkJztcbn1cbmZ1bmN0aW9uIGlzRW1wdHkodmFyaWFibGUpIHtcbiAgcmV0dXJuIHZhcmlhYmxlID09PSBudWxsIHx8IHZhcmlhYmxlID09PSAnJyB8fCBpc1VuZGVmaW5lZCh2YXJpYWJsZSk7XG59XG5cbi8vIyBcbn0se31dLDUyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBpc051bWVyaWM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGlzTnVtZXJpYztcbiAgICB9fSxcbiAgcmFuZ2VFYWNoOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiByYW5nZUVhY2g7XG4gICAgfX0sXG4gIHJhbmdlRWFjaFJldmVyc2U6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHJhbmdlRWFjaFJldmVyc2U7XG4gICAgfX0sXG4gIHZhbHVlQWNjb3JkaW5nUGVyY2VudDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdmFsdWVBY2NvcmRpbmdQZXJjZW50O1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbmZ1bmN0aW9uIGlzTnVtZXJpYyhuKSB7XG4gIHZhciB0ID0gdHlwZW9mIG47XG4gIHJldHVybiB0ID09ICdudW1iZXInID8gIWlzTmFOKG4pICYmIGlzRmluaXRlKG4pIDogdCA9PSAnc3RyaW5nJyA/ICFuLmxlbmd0aCA/IGZhbHNlIDogbi5sZW5ndGggPT0gMSA/IC9cXGQvLnRlc3QobikgOiAvXlxccypbKy1dP1xccyooPzooPzpcXGQrKD86XFwuXFxkKyk/KD86ZVsrLV0/XFxkKyk/KXwoPzoweFthLWZcXGRdKykpXFxzKiQvaS50ZXN0KG4pIDogdCA9PSAnb2JqZWN0JyA/ICEhbiAmJiB0eXBlb2Ygbi52YWx1ZU9mKCkgPT0gJ251bWJlcicgJiYgIShuIGluc3RhbmNlb2YgRGF0ZSkgOiBmYWxzZTtcbn1cbmZ1bmN0aW9uIHJhbmdlRWFjaChyYW5nZUZyb20sIHJhbmdlVG8sIGl0ZXJhdGVlKSB7XG4gIHZhciBpbmRleCA9IC0xO1xuICBpZiAodHlwZW9mIHJhbmdlVG8gPT09ICdmdW5jdGlvbicpIHtcbiAgICBpdGVyYXRlZSA9IHJhbmdlVG87XG4gICAgcmFuZ2VUbyA9IHJhbmdlRnJvbTtcbiAgfSBlbHNlIHtcbiAgICBpbmRleCA9IHJhbmdlRnJvbSAtIDE7XG4gIH1cbiAgd2hpbGUgKCsraW5kZXggPD0gcmFuZ2VUbykge1xuICAgIGlmIChpdGVyYXRlZShpbmRleCkgPT09IGZhbHNlKSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbn1cbmZ1bmN0aW9uIHJhbmdlRWFjaFJldmVyc2UocmFuZ2VGcm9tLCByYW5nZVRvLCBpdGVyYXRlZSkge1xuICB2YXIgaW5kZXggPSByYW5nZUZyb20gKyAxO1xuICBpZiAodHlwZW9mIHJhbmdlVG8gPT09ICdmdW5jdGlvbicpIHtcbiAgICBpdGVyYXRlZSA9IHJhbmdlVG87XG4gICAgcmFuZ2VUbyA9IDA7XG4gIH1cbiAgd2hpbGUgKC0taW5kZXggPj0gcmFuZ2VUbykge1xuICAgIGlmIChpdGVyYXRlZShpbmRleCkgPT09IGZhbHNlKSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbn1cbmZ1bmN0aW9uIHZhbHVlQWNjb3JkaW5nUGVyY2VudCh2YWx1ZSwgcGVyY2VudCkge1xuICBwZXJjZW50ID0gcGFyc2VJbnQocGVyY2VudC50b1N0cmluZygpLnJlcGxhY2UoJyUnLCAnJyksIDEwKTtcbiAgcGVyY2VudCA9IHBhcnNlSW50KHZhbHVlICogcGVyY2VudCAvIDEwMCk7XG4gIHJldHVybiBwZXJjZW50O1xufVxuXG4vLyMgXG59LHt9XSw1MzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgZHVja1NjaGVtYToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZHVja1NjaGVtYTtcbiAgICB9fSxcbiAgaW5oZXJpdDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gaW5oZXJpdDtcbiAgICB9fSxcbiAgZXh0ZW5kOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBleHRlbmQ7XG4gICAgfX0sXG4gIGRlZXBFeHRlbmQ6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGRlZXBFeHRlbmQ7XG4gICAgfX0sXG4gIGRlZXBDbG9uZToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZGVlcENsb25lO1xuICAgIH19LFxuICBjbG9uZToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gY2xvbmU7XG4gICAgfX0sXG4gIG1peGluOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBtaXhpbjtcbiAgICB9fSxcbiAgaXNPYmplY3RFcXVhbHM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGlzT2JqZWN0RXF1YWxzO1xuICAgIH19LFxuICBpc09iamVjdDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gaXNPYmplY3Q7XG4gICAgfX0sXG4gIGdldFByb3RvdHlwZU9mOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBnZXRQcm90b3R5cGVPZjtcbiAgICB9fSxcbiAgZGVmaW5lR2V0dGVyOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBkZWZpbmVHZXR0ZXI7XG4gICAgfX0sXG4gIG9iamVjdEVhY2g6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIG9iamVjdEVhY2g7XG4gICAgfX0sXG4gIGdldFByb3BlcnR5OiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBnZXRQcm9wZXJ0eTtcbiAgICB9fSxcbiAgZGVlcE9iamVjdFNpemU6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGRlZXBPYmplY3RTaXplO1xuICAgIH19LFxuICBjcmVhdGVPYmplY3RQcm9wTGlzdGVuZXI6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGNyZWF0ZU9iamVjdFByb3BMaXN0ZW5lcjtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fYXJyYXlfXztcbnZhciBhcnJheUVhY2ggPSAoJF9fYXJyYXlfXyA9IF9kZXJlcV8oXCJhcnJheVwiKSwgJF9fYXJyYXlfXyAmJiAkX19hcnJheV9fLl9fZXNNb2R1bGUgJiYgJF9fYXJyYXlfXyB8fCB7ZGVmYXVsdDogJF9fYXJyYXlfX30pLmFycmF5RWFjaDtcbmZ1bmN0aW9uIGR1Y2tTY2hlbWEob2JqZWN0KSB7XG4gIHZhciBzY2hlbWE7XG4gIGlmIChBcnJheS5pc0FycmF5KG9iamVjdCkpIHtcbiAgICBzY2hlbWEgPSBbXTtcbiAgfSBlbHNlIHtcbiAgICBzY2hlbWEgPSB7fTtcbiAgICBvYmplY3RFYWNoKG9iamVjdCwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgaWYgKGtleSA9PT0gJ19fY2hpbGRyZW4nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmICFBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICBzY2hlbWFba2V5XSA9IGR1Y2tTY2hlbWEodmFsdWUpO1xuICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICBpZiAodmFsdWUubGVuZ3RoICYmIHR5cGVvZiB2YWx1ZVswXSA9PT0gJ29iamVjdCcgJiYgIUFycmF5LmlzQXJyYXkodmFsdWVbMF0pKSB7XG4gICAgICAgICAgc2NoZW1hW2tleV0gPSBbZHVja1NjaGVtYSh2YWx1ZVswXSldO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNjaGVtYVtrZXldID0gW107XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNjaGVtYVtrZXldID0gbnVsbDtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gc2NoZW1hO1xufVxuZnVuY3Rpb24gaW5oZXJpdChDaGlsZCwgUGFyZW50KSB7XG4gIFBhcmVudC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBQYXJlbnQ7XG4gIENoaWxkLnByb3RvdHlwZSA9IG5ldyBQYXJlbnQoKTtcbiAgQ2hpbGQucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ2hpbGQ7XG4gIHJldHVybiBDaGlsZDtcbn1cbmZ1bmN0aW9uIGV4dGVuZCh0YXJnZXQsIGV4dGVuc2lvbikge1xuICBvYmplY3RFYWNoKGV4dGVuc2lvbiwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgIHRhcmdldFtrZXldID0gdmFsdWU7XG4gIH0pO1xuICByZXR1cm4gdGFyZ2V0O1xufVxuZnVuY3Rpb24gZGVlcEV4dGVuZCh0YXJnZXQsIGV4dGVuc2lvbikge1xuICBvYmplY3RFYWNoKGV4dGVuc2lvbiwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgIGlmIChleHRlbnNpb25ba2V5XSAmJiB0eXBlb2YgZXh0ZW5zaW9uW2tleV0gPT09ICdvYmplY3QnKSB7XG4gICAgICBpZiAoIXRhcmdldFtrZXldKSB7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGV4dGVuc2lvbltrZXldKSkge1xuICAgICAgICAgIHRhcmdldFtrZXldID0gW107XG4gICAgICAgIH0gZWxzZSBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGV4dGVuc2lvbltrZXldKSA9PT0gJ1tvYmplY3QgRGF0ZV0nKSB7XG4gICAgICAgICAgdGFyZ2V0W2tleV0gPSBleHRlbnNpb25ba2V5XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0YXJnZXRba2V5XSA9IHt9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBkZWVwRXh0ZW5kKHRhcmdldFtrZXldLCBleHRlbnNpb25ba2V5XSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRhcmdldFtrZXldID0gZXh0ZW5zaW9uW2tleV07XG4gICAgfVxuICB9KTtcbn1cbmZ1bmN0aW9uIGRlZXBDbG9uZShvYmopIHtcbiAgaWYgKHR5cGVvZiBvYmogPT09ICdvYmplY3QnKSB7XG4gICAgcmV0dXJuIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob2JqKSk7XG4gIH1cbiAgcmV0dXJuIG9iajtcbn1cbmZ1bmN0aW9uIGNsb25lKG9iamVjdCkge1xuICB2YXIgcmVzdWx0ID0ge307XG4gIG9iamVjdEVhY2gob2JqZWN0LCAoZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgIHJlc3VsdFtrZXldID0gdmFsdWU7XG4gIH0pKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIG1peGluKEJhc2UpIHtcbiAgZm9yICh2YXIgbWl4aW5zID0gW10sXG4gICAgICAkX18yID0gMTsgJF9fMiA8IGFyZ3VtZW50cy5sZW5ndGg7ICRfXzIrKylcbiAgICBtaXhpbnNbJF9fMiAtIDFdID0gYXJndW1lbnRzWyRfXzJdO1xuICBpZiAoIUJhc2UuTUlYSU5TKSB7XG4gICAgQmFzZS5NSVhJTlMgPSBbXTtcbiAgfVxuICBhcnJheUVhY2gobWl4aW5zLCAoZnVuY3Rpb24obWl4aW4pIHtcbiAgICBCYXNlLk1JWElOUy5wdXNoKG1peGluLk1JWElOX05BTUUpO1xuICAgIG9iamVjdEVhY2gobWl4aW4sIChmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICBpZiAoQmFzZS5wcm90b3R5cGVba2V5XSAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcigoXCJNaXhpbiBjb25mbGljdC4gUHJvcGVydHkgJ1wiICsga2V5ICsgXCInIGFscmVhZHkgZXhpc3QgYW5kIGNhbm5vdCBiZSBvdmVyd3JpdHRlbi5cIikpO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBCYXNlLnByb3RvdHlwZVtrZXldID0gdmFsdWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgZ2V0dGVyID0gZnVuY3Rpb24gX2dldHRlcihwcm9wZXJ0eU5hbWUsIGluaXRpYWxWYWx1ZSkge1xuICAgICAgICAgIHByb3BlcnR5TmFtZSA9ICdfJyArIHByb3BlcnR5TmFtZTtcbiAgICAgICAgICB2YXIgaW5pdFZhbHVlID0gKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgfHwgaXNPYmplY3QodmFsdWUpKSB7XG4gICAgICAgICAgICAgIHZhbHVlID0gZGVlcENsb25lKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAodGhpc1twcm9wZXJ0eU5hbWVdID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgICAgdGhpc1twcm9wZXJ0eU5hbWVdID0gaW5pdFZhbHVlKGluaXRpYWxWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpc1twcm9wZXJ0eU5hbWVdO1xuICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIHZhciBzZXR0ZXIgPSBmdW5jdGlvbiBfc2V0dGVyKHByb3BlcnR5TmFtZSkge1xuICAgICAgICAgIHByb3BlcnR5TmFtZSA9ICdfJyArIHByb3BlcnR5TmFtZTtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXNbcHJvcGVydHlOYW1lXSA9IHZhbHVlO1xuICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCYXNlLnByb3RvdHlwZSwga2V5LCB7XG4gICAgICAgICAgZ2V0OiBnZXR0ZXIoa2V5LCB2YWx1ZSksXG4gICAgICAgICAgc2V0OiBzZXR0ZXIoa2V5KSxcbiAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSkpO1xuICB9KSk7XG4gIHJldHVybiBCYXNlO1xufVxuZnVuY3Rpb24gaXNPYmplY3RFcXVhbHMob2JqZWN0MSwgb2JqZWN0Mikge1xuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkob2JqZWN0MSkgPT09IEpTT04uc3RyaW5naWZ5KG9iamVjdDIpO1xufVxuZnVuY3Rpb24gaXNPYmplY3Qob2JqKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSA9PSAnW29iamVjdCBPYmplY3RdJztcbn1cbmZ1bmN0aW9uIGdldFByb3RvdHlwZU9mKG9iaikge1xuICB2YXIgcHJvdG90eXBlO1xuICBpZiAodHlwZW9mIG9iai5fX3Byb3RvX18gPT0gJ29iamVjdCcpIHtcbiAgICBwcm90b3R5cGUgPSBvYmouX19wcm90b19fO1xuICB9IGVsc2Uge1xuICAgIHZhciBvbGRDb25zdHJ1Y3RvcixcbiAgICAgICAgY29uc3RydWN0b3IgPSBvYmouY29uc3RydWN0b3I7XG4gICAgaWYgKHR5cGVvZiBvYmouY29uc3RydWN0b3IgPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgb2xkQ29uc3RydWN0b3IgPSBjb25zdHJ1Y3RvcjtcbiAgICAgIGlmIChkZWxldGUgb2JqLmNvbnN0cnVjdG9yKSB7XG4gICAgICAgIGNvbnN0cnVjdG9yID0gb2JqLmNvbnN0cnVjdG9yO1xuICAgICAgICBvYmouY29uc3RydWN0b3IgPSBvbGRDb25zdHJ1Y3RvcjtcbiAgICAgIH1cbiAgICB9XG4gICAgcHJvdG90eXBlID0gY29uc3RydWN0b3IgPyBjb25zdHJ1Y3Rvci5wcm90b3R5cGUgOiBudWxsO1xuICB9XG4gIHJldHVybiBwcm90b3R5cGU7XG59XG5mdW5jdGlvbiBkZWZpbmVHZXR0ZXIob2JqZWN0LCBwcm9wZXJ0eSwgdmFsdWUsIG9wdGlvbnMpIHtcbiAgb3B0aW9ucy52YWx1ZSA9IHZhbHVlO1xuICBvcHRpb25zLndyaXRhYmxlID0gb3B0aW9ucy53cml0YWJsZSAhPT0gZmFsc2U7XG4gIG9wdGlvbnMuZW51bWVyYWJsZSA9IG9wdGlvbnMuZW51bWVyYWJsZSAhPT0gZmFsc2U7XG4gIG9wdGlvbnMuY29uZmlndXJhYmxlID0gb3B0aW9ucy5jb25maWd1cmFibGUgIT09IGZhbHNlO1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqZWN0LCBwcm9wZXJ0eSwgb3B0aW9ucyk7XG59XG5mdW5jdGlvbiBvYmplY3RFYWNoKG9iamVjdCwgaXRlcmF0ZWUpIHtcbiAgZm9yICh2YXIga2V5IGluIG9iamVjdCkge1xuICAgIGlmICghb2JqZWN0Lmhhc093blByb3BlcnR5IHx8IChvYmplY3QuaGFzT3duUHJvcGVydHkgJiYgb2JqZWN0Lmhhc093blByb3BlcnR5KGtleSkpKSB7XG4gICAgICBpZiAoaXRlcmF0ZWUob2JqZWN0W2tleV0sIGtleSwgb2JqZWN0KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBvYmplY3Q7XG59XG5mdW5jdGlvbiBnZXRQcm9wZXJ0eShvYmplY3QsIG5hbWUpIHtcbiAgdmFyIG5hbWVzID0gbmFtZS5zcGxpdCgnLicpO1xuICB2YXIgcmVzdWx0ID0gb2JqZWN0O1xuICBvYmplY3RFYWNoKG5hbWVzLCAoZnVuY3Rpb24obmFtZSkge1xuICAgIHJlc3VsdCA9IHJlc3VsdFtuYW1lXTtcbiAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIHtcbiAgICAgIHJlc3VsdCA9IHZvaWQgMDtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH0pKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGRlZXBPYmplY3RTaXplKG9iamVjdCkge1xuICBpZiAoIWlzT2JqZWN0KG9iamVjdCkpIHtcbiAgICByZXR1cm4gMDtcbiAgfVxuICB2YXIgcmVjdXJzT2JqTGVuID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgdmFyIHJlc3VsdCA9IDA7XG4gICAgaWYgKGlzT2JqZWN0KG9iaikpIHtcbiAgICAgIG9iamVjdEVhY2gob2JqLCAoZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgIHJlc3VsdCArPSByZWN1cnNPYmpMZW4oa2V5KTtcbiAgICAgIH0pKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0Kys7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG4gIHJldHVybiByZWN1cnNPYmpMZW4ob2JqZWN0KTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZU9iamVjdFByb3BMaXN0ZW5lcihkZWZhdWx0VmFsdWUpIHtcbiAgdmFyIHByb3BlcnR5VG9MaXN0ZW4gPSBhcmd1bWVudHNbMV0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzFdIDogJ3ZhbHVlJztcbiAgdmFyICRfXzE7XG4gIHZhciBwcml2YXRlUHJvcGVydHkgPSAoXCJfXCIgKyBwcm9wZXJ0eVRvTGlzdGVuKTtcbiAgdmFyIGhvbGRlciA9ICgkX18xID0ge30sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xLCBcIl90b3VjaGVkXCIsIHtcbiAgICB2YWx1ZTogZmFsc2UsXG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgd3JpdGFibGU6IHRydWVcbiAgfSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xLCBwcml2YXRlUHJvcGVydHksIHtcbiAgICB2YWx1ZTogZGVmYXVsdFZhbHVlLFxuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIHdyaXRhYmxlOiB0cnVlXG4gIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fMSwgXCJpc1RvdWNoZWRcIiwge1xuICAgIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLl90b3VjaGVkO1xuICAgIH0sXG4gICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgd3JpdGFibGU6IHRydWVcbiAgfSksICRfXzEpO1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoaG9sZGVyLCBwcm9wZXJ0eVRvTGlzdGVuLCB7XG4gICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzW3ByaXZhdGVQcm9wZXJ0eV07XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICB0aGlzLl90b3VjaGVkID0gdHJ1ZTtcbiAgICAgIHRoaXNbcHJpdmF0ZVByb3BlcnR5XSA9IHZhbHVlO1xuICAgIH0sXG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBjb25maWd1cmFibGU6IHRydWVcbiAgfSk7XG4gIHJldHVybiBob2xkZXI7XG59XG5cbi8vIyBcbn0se1wiYXJyYXlcIjo0M31dLDU0OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBjb2x1bW5GYWN0b3J5OiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBjb2x1bW5GYWN0b3J5O1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19vYmplY3RfXztcbnZhciBpbmhlcml0ID0gKCRfX29iamVjdF9fID0gX2RlcmVxXyhcIm9iamVjdFwiKSwgJF9fb2JqZWN0X18gJiYgJF9fb2JqZWN0X18uX19lc01vZHVsZSAmJiAkX19vYmplY3RfXyB8fCB7ZGVmYXVsdDogJF9fb2JqZWN0X199KS5pbmhlcml0O1xuZnVuY3Rpb24gY29sdW1uRmFjdG9yeShHcmlkU2V0dGluZ3MsIGNvbmZsaWN0TGlzdCkge1xuICBmdW5jdGlvbiBDb2x1bW5TZXR0aW5ncygpIHt9XG4gIDtcbiAgaW5oZXJpdChDb2x1bW5TZXR0aW5ncywgR3JpZFNldHRpbmdzKTtcbiAgZm9yICh2YXIgaSA9IDAsXG4gICAgICBsZW4gPSBjb25mbGljdExpc3QubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICBDb2x1bW5TZXR0aW5ncy5wcm90b3R5cGVbY29uZmxpY3RMaXN0W2ldXSA9IHZvaWQgMDtcbiAgfVxuICByZXR1cm4gQ29sdW1uU2V0dGluZ3M7XG59XG5cbi8vIyBcbn0se1wib2JqZWN0XCI6NTN9XSw1NTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgdG9VcHBlckNhc2VGaXJzdDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdG9VcHBlckNhc2VGaXJzdDtcbiAgICB9fSxcbiAgc3RhcnRzV2l0aDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gc3RhcnRzV2l0aDtcbiAgICB9fSxcbiAgZW5kc1dpdGg6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGVuZHNXaXRoO1xuICAgIH19LFxuICBlcXVhbHNJZ25vcmVDYXNlOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBlcXVhbHNJZ25vcmVDYXNlO1xuICAgIH19LFxuICByYW5kb21TdHJpbmc6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHJhbmRvbVN0cmluZztcbiAgICB9fSxcbiAgaXNQZXJjZW50VmFsdWU6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGlzUGVyY2VudFZhbHVlO1xuICAgIH19LFxuICBzdWJzdGl0dXRlOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzdWJzdGl0dXRlO1xuICAgIH19LFxuICBwYWRTdGFydDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gcGFkU3RhcnQ7XG4gICAgfX0sXG4gIHN0cmlwVGFnczoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gc3RyaXBUYWdzO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19taXhlZF9fLFxuICAgICRfX251bWJlcl9fO1xudmFyIHN0cmluZ2lmeSA9ICgkX19taXhlZF9fID0gX2RlcmVxXyhcIm1peGVkXCIpLCAkX19taXhlZF9fICYmICRfX21peGVkX18uX19lc01vZHVsZSAmJiAkX19taXhlZF9fIHx8IHtkZWZhdWx0OiAkX19taXhlZF9ffSkuc3RyaW5naWZ5O1xudmFyIHJhbmdlRWFjaCA9ICgkX19udW1iZXJfXyA9IF9kZXJlcV8oXCJudW1iZXJcIiksICRfX251bWJlcl9fICYmICRfX251bWJlcl9fLl9fZXNNb2R1bGUgJiYgJF9fbnVtYmVyX18gfHwge2RlZmF1bHQ6ICRfX251bWJlcl9ffSkucmFuZ2VFYWNoO1xuZnVuY3Rpb24gdG9VcHBlckNhc2VGaXJzdChzdHJpbmcpIHtcbiAgcmV0dXJuIHN0cmluZ1swXS50b1VwcGVyQ2FzZSgpICsgc3RyaW5nLnN1YnN0cigxKTtcbn1cbmZ1bmN0aW9uIHN0YXJ0c1dpdGgoc3RyaW5nLCBuZWVkbGUpIHtcbiAgdmFyIHJlc3VsdCA9IHRydWU7XG4gIHJhbmdlRWFjaChuZWVkbGUubGVuZ3RoIC0gMSwgKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgaWYgKHN0cmluZy5jaGFyQXQoaW5kZXgpICE9PSBuZWVkbGUuY2hhckF0KGluZGV4KSkge1xuICAgICAgcmVzdWx0ID0gZmFsc2U7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9KSk7XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBlbmRzV2l0aChzdHJpbmcsIG5lZWRsZSkge1xuICB2YXIgcmVzdWx0ID0gdHJ1ZTtcbiAgdmFyIG5lZWRsZUxlbmd0aCA9IG5lZWRsZS5sZW5ndGggLSAxO1xuICB2YXIgc3RyaW5nTGVuZ3RoID0gc3RyaW5nLmxlbmd0aCAtIDE7XG4gIHJhbmdlRWFjaChuZWVkbGVMZW5ndGgsIChmdW5jdGlvbihpbmRleCkge1xuICAgIHZhciBzdHJpbmdJbmRleCA9IHN0cmluZ0xlbmd0aCAtIGluZGV4O1xuICAgIHZhciBuZWVkbGVJbmRleCA9IG5lZWRsZUxlbmd0aCAtIGluZGV4O1xuICAgIGlmIChzdHJpbmcuY2hhckF0KHN0cmluZ0luZGV4KSAhPT0gbmVlZGxlLmNoYXJBdChuZWVkbGVJbmRleCkpIHtcbiAgICAgIHJlc3VsdCA9IGZhbHNlO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfSkpO1xuICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gZXF1YWxzSWdub3JlQ2FzZSgpIHtcbiAgZm9yICh2YXIgc3RyaW5ncyA9IFtdLFxuICAgICAgJF9fMiA9IDA7ICRfXzIgPCBhcmd1bWVudHMubGVuZ3RoOyAkX18yKyspXG4gICAgc3RyaW5nc1skX18yXSA9IGFyZ3VtZW50c1skX18yXTtcbiAgdmFyIHVuaXF1ZSA9IFtdO1xuICB2YXIgbGVuZ3RoID0gc3RyaW5ncy5sZW5ndGg7XG4gIHdoaWxlIChsZW5ndGgtLSkge1xuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdpZnkoc3RyaW5nc1tsZW5ndGhdKS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmICh1bmlxdWUuaW5kZXhPZihzdHJpbmcpID09PSAtMSkge1xuICAgICAgdW5pcXVlLnB1c2goc3RyaW5nKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHVuaXF1ZS5sZW5ndGggPT09IDE7XG59XG5mdW5jdGlvbiByYW5kb21TdHJpbmcoKSB7XG4gIGZ1bmN0aW9uIHM0KCkge1xuICAgIHJldHVybiBNYXRoLmZsb29yKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKS50b1N0cmluZygxNikuc3Vic3RyaW5nKDEpO1xuICB9XG4gIHJldHVybiBzNCgpICsgczQoKSArIHM0KCkgKyBzNCgpO1xufVxuZnVuY3Rpb24gaXNQZXJjZW50VmFsdWUodmFsdWUpIHtcbiAgcmV0dXJuIC9eKFswLTldWzAtOV0/XFwlJCl8KF4xMDBcXCUkKS8udGVzdCh2YWx1ZSk7XG59XG5mdW5jdGlvbiBzdWJzdGl0dXRlKHRlbXBsYXRlKSB7XG4gIHZhciB2YXJpYWJsZXMgPSBhcmd1bWVudHNbMV0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzFdIDoge307XG4gIHJldHVybiAodGVtcGxhdGUgKyAnJykucmVwbGFjZSgvKD86XFxcXCk/XFxbKFteXFxbXFxdXSspXS9nLCBmdW5jdGlvbihtYXRjaCwgbmFtZSkge1xuICAgIGlmIChtYXRjaC5jaGFyQXQoMCkgPT09ICdcXFxcJykge1xuICAgICAgcmV0dXJuIG1hdGNoLnN1YnN0cigxLCBtYXRjaC5sZW5ndGggLSAxKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhcmlhYmxlc1tuYW1lXSA9PT0gdm9pZCAwID8gJycgOiB2YXJpYWJsZXNbbmFtZV07XG4gIH0pO1xufVxuZnVuY3Rpb24gcGFkU3RhcnQoc3RyaW5nLCBtYXhMZW5ndGgpIHtcbiAgdmFyIGZpbGxTdHJpbmcgPSBhcmd1bWVudHNbMl0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzJdIDogJyAnO1xuICBzdHJpbmcgPSBzdHJpbmcgKyAnJztcbiAgaWYgKHN0cmluZy5sZW5ndGggPj0gbWF4TGVuZ3RoKSB7XG4gICAgcmV0dXJuIHN0cmluZztcbiAgfVxuICBmaWxsU3RyaW5nID0gU3RyaW5nKGZpbGxTdHJpbmcpO1xuICB2YXIgZmlsbFN0cmluZ0xlbmd0aCA9IGZpbGxTdHJpbmcubGVuZ3RoO1xuICBpZiAoIWZpbGxTdHJpbmdMZW5ndGgpIHtcbiAgICBmaWxsU3RyaW5nID0gJyAnO1xuICB9XG4gIHZhciBmaWxsTGVuID0gbWF4TGVuZ3RoIC0gc3RyaW5nLmxlbmd0aDtcbiAgdmFyIHRpbWVzVG9SZXBlYXQgPSBNYXRoLmNlaWwoZmlsbExlbiAvIGZpbGxTdHJpbmcubGVuZ3RoKTtcbiAgdmFyIHRydW5jYXRlZFN0cmluZyA9ICcnO1xuICByYW5nZUVhY2godGltZXNUb1JlcGVhdCwgKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgdHJ1bmNhdGVkU3RyaW5nICs9IGZpbGxTdHJpbmc7XG4gIH0pKTtcbiAgdHJ1bmNhdGVkU3RyaW5nID0gdHJ1bmNhdGVkU3RyaW5nLnNsaWNlKDAsIGZpbGxMZW4pO1xuICByZXR1cm4gdHJ1bmNhdGVkU3RyaW5nICsgc3RyaW5nO1xufVxuO1xudmFyIFNUUklQX1RBR1NfUkVHRVggPSAvPFxcLz9cXHcrXFwvPz58PFxcdytbXFxzfFxcL11bXj5dKj4vZ2k7XG5mdW5jdGlvbiBzdHJpcFRhZ3Moc3RyaW5nKSB7XG4gIHN0cmluZyA9IHN0cmluZyArICcnO1xuICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoU1RSSVBfVEFHU19SRUdFWCwgJycpO1xufVxuXG4vLyMgXG59LHtcIm1peGVkXCI6NTEsXCJudW1iZXJcIjo1Mn1dLDU2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBLRVlfQ09ERVM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIEtFWV9DT0RFUztcbiAgICB9fSxcbiAgaXNQcmludGFibGVDaGFyOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBpc1ByaW50YWJsZUNoYXI7XG4gICAgfX0sXG4gIGlzTWV0YUtleToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gaXNNZXRhS2V5O1xuICAgIH19LFxuICBpc0N0cmxLZXk6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGlzQ3RybEtleTtcbiAgICB9fSxcbiAgaXNLZXk6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGlzS2V5O1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19hcnJheV9fO1xudmFyIGFycmF5RWFjaCA9ICgkX19hcnJheV9fID0gX2RlcmVxXyhcImFycmF5XCIpLCAkX19hcnJheV9fICYmICRfX2FycmF5X18uX19lc01vZHVsZSAmJiAkX19hcnJheV9fIHx8IHtkZWZhdWx0OiAkX19hcnJheV9ffSkuYXJyYXlFYWNoO1xudmFyIEtFWV9DT0RFUyA9IHtcbiAgTU9VU0VfTEVGVDogMSxcbiAgTU9VU0VfUklHSFQ6IDMsXG4gIE1PVVNFX01JRERMRTogMixcbiAgQkFDS1NQQUNFOiA4LFxuICBDT01NQTogMTg4LFxuICBJTlNFUlQ6IDQ1LFxuICBERUxFVEU6IDQ2LFxuICBFTkQ6IDM1LFxuICBFTlRFUjogMTMsXG4gIEVTQ0FQRTogMjcsXG4gIENPTlRST0xfTEVGVDogOTEsXG4gIENPTU1BTkRfTEVGVDogMTcsXG4gIENPTU1BTkRfUklHSFQ6IDkzLFxuICBBTFQ6IDE4LFxuICBIT01FOiAzNixcbiAgUEFHRV9ET1dOOiAzNCxcbiAgUEFHRV9VUDogMzMsXG4gIFBFUklPRDogMTkwLFxuICBTUEFDRTogMzIsXG4gIFNISUZUOiAxNixcbiAgQ0FQU19MT0NLOiAyMCxcbiAgVEFCOiA5LFxuICBBUlJPV19SSUdIVDogMzksXG4gIEFSUk9XX0xFRlQ6IDM3LFxuICBBUlJPV19VUDogMzgsXG4gIEFSUk9XX0RPV046IDQwLFxuICBGMTogMTEyLFxuICBGMjogMTEzLFxuICBGMzogMTE0LFxuICBGNDogMTE1LFxuICBGNTogMTE2LFxuICBGNjogMTE3LFxuICBGNzogMTE4LFxuICBGODogMTE5LFxuICBGOTogMTIwLFxuICBGMTA6IDEyMSxcbiAgRjExOiAxMjIsXG4gIEYxMjogMTIzLFxuICBBOiA2NSxcbiAgWDogODgsXG4gIEM6IDY3LFxuICBWOiA4NlxufTtcbmZ1bmN0aW9uIGlzUHJpbnRhYmxlQ2hhcihrZXlDb2RlKSB7XG4gIHJldHVybiAoKGtleUNvZGUgPT0gMzIpIHx8IChrZXlDb2RlID49IDQ4ICYmIGtleUNvZGUgPD0gNTcpIHx8IChrZXlDb2RlID49IDk2ICYmIGtleUNvZGUgPD0gMTExKSB8fCAoa2V5Q29kZSA+PSAxODYgJiYga2V5Q29kZSA8PSAxOTIpIHx8IChrZXlDb2RlID49IDIxOSAmJiBrZXlDb2RlIDw9IDIyMikgfHwga2V5Q29kZSA+PSAyMjYgfHwgKGtleUNvZGUgPj0gNjUgJiYga2V5Q29kZSA8PSA5MCkpO1xufVxuZnVuY3Rpb24gaXNNZXRhS2V5KGtleUNvZGUpIHtcbiAgdmFyIG1ldGFLZXlzID0gW0tFWV9DT0RFUy5BUlJPV19ET1dOLCBLRVlfQ09ERVMuQVJST1dfVVAsIEtFWV9DT0RFUy5BUlJPV19MRUZULCBLRVlfQ09ERVMuQVJST1dfUklHSFQsIEtFWV9DT0RFUy5IT01FLCBLRVlfQ09ERVMuRU5ELCBLRVlfQ09ERVMuREVMRVRFLCBLRVlfQ09ERVMuQkFDS1NQQUNFLCBLRVlfQ09ERVMuRjEsIEtFWV9DT0RFUy5GMiwgS0VZX0NPREVTLkYzLCBLRVlfQ09ERVMuRjQsIEtFWV9DT0RFUy5GNSwgS0VZX0NPREVTLkY2LCBLRVlfQ09ERVMuRjcsIEtFWV9DT0RFUy5GOCwgS0VZX0NPREVTLkY5LCBLRVlfQ09ERVMuRjEwLCBLRVlfQ09ERVMuRjExLCBLRVlfQ09ERVMuRjEyLCBLRVlfQ09ERVMuVEFCLCBLRVlfQ09ERVMuUEFHRV9ET1dOLCBLRVlfQ09ERVMuUEFHRV9VUCwgS0VZX0NPREVTLkVOVEVSLCBLRVlfQ09ERVMuRVNDQVBFLCBLRVlfQ09ERVMuU0hJRlQsIEtFWV9DT0RFUy5DQVBTX0xPQ0ssIEtFWV9DT0RFUy5BTFRdO1xuICByZXR1cm4gbWV0YUtleXMuaW5kZXhPZihrZXlDb2RlKSAhPT0gLTE7XG59XG5mdW5jdGlvbiBpc0N0cmxLZXkoa2V5Q29kZSkge1xuICByZXR1cm4gW0tFWV9DT0RFUy5DT05UUk9MX0xFRlQsIDIyNCwgS0VZX0NPREVTLkNPTU1BTkRfTEVGVCwgS0VZX0NPREVTLkNPTU1BTkRfUklHSFRdLmluZGV4T2Yoa2V5Q29kZSkgIT09IC0xO1xufVxuZnVuY3Rpb24gaXNLZXkoa2V5Q29kZSwgYmFzZUNvZGUpIHtcbiAgdmFyIGtleXMgPSBiYXNlQ29kZS5zcGxpdCgnfCcpO1xuICB2YXIgcmVzdWx0ID0gZmFsc2U7XG4gIGFycmF5RWFjaChrZXlzLCBmdW5jdGlvbihrZXkpIHtcbiAgICBpZiAoa2V5Q29kZSA9PT0gS0VZX0NPREVTW2tleV0pIHtcbiAgICAgIHJlc3VsdCA9IHRydWU7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLy8jIFxufSx7XCJhcnJheVwiOjQzfV0sNTc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIGFycmF5TWFwcGVyOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBhcnJheU1hcHBlcjtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX187XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19fNDZfXzQ2X180N19icm93c2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19icm93c2VyX199KS5kZWZhdWx0O1xudmFyICRfXzEgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fID0gX2RlcmVxXyhcImhlbHBlcnMvYXJyYXlcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfX30pLFxuICAgIGFycmF5RWFjaCA9ICRfXzEuYXJyYXlFYWNoLFxuICAgIGFycmF5UmVkdWNlID0gJF9fMS5hcnJheVJlZHVjZSxcbiAgICBhcnJheU1hcCA9ICRfXzEuYXJyYXlNYXAsXG4gICAgYXJyYXlNYXggPSAkX18xLmFycmF5TWF4O1xudmFyIGRlZmluZUdldHRlciA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fID0gX2RlcmVxXyhcImhlbHBlcnMvb2JqZWN0XCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9ffSkuZGVmaW5lR2V0dGVyO1xudmFyIHJhbmdlRWFjaCA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X251bWJlcl9fID0gX2RlcmVxXyhcImhlbHBlcnMvbnVtYmVyXCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X251bWJlcl9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X251bWJlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X251bWJlcl9ffSkucmFuZ2VFYWNoO1xudmFyIE1JWElOX05BTUUgPSAnYXJyYXlNYXBwZXInO1xudmFyIGFycmF5TWFwcGVyID0ge1xuICBfYXJyYXlNYXA6IFtdLFxuICBnZXRWYWx1ZUJ5SW5kZXg6IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgdmFyIHZhbHVlO1xuICAgIHJldHVybiAodmFsdWUgPSB0aGlzLl9hcnJheU1hcFtpbmRleF0pID09PSB2b2lkIDAgPyBudWxsIDogdmFsdWU7XG4gIH0sXG4gIGdldEluZGV4QnlWYWx1ZTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICB2YXIgaW5kZXg7XG4gICAgcmV0dXJuIChpbmRleCA9IHRoaXMuX2FycmF5TWFwLmluZGV4T2YodmFsdWUpKSA9PT0gLTEgPyBudWxsIDogaW5kZXg7XG4gIH0sXG4gIGluc2VydEl0ZW1zOiBmdW5jdGlvbihpbmRleCkge1xuICAgIHZhciBhbW91bnQgPSBhcmd1bWVudHNbMV0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzFdIDogMTtcbiAgICB2YXIgJF9fNCA9IHRoaXM7XG4gICAgdmFyIG5ld0luZGV4ID0gYXJyYXlNYXgodGhpcy5fYXJyYXlNYXApICsgMTtcbiAgICB2YXIgYWRkZWRJdGVtcyA9IFtdO1xuICAgIHJhbmdlRWFjaChhbW91bnQgLSAxLCAoZnVuY3Rpb24oY291bnQpIHtcbiAgICAgIGFkZGVkSXRlbXMucHVzaCgkX180Ll9hcnJheU1hcC5zcGxpY2UoaW5kZXggKyBjb3VudCwgMCwgbmV3SW5kZXggKyBjb3VudCkpO1xuICAgIH0pKTtcbiAgICByZXR1cm4gYWRkZWRJdGVtcztcbiAgfSxcbiAgcmVtb3ZlSXRlbXM6IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgdmFyIGFtb3VudCA9IGFyZ3VtZW50c1sxXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMV0gOiAxO1xuICAgIHZhciAkX180ID0gdGhpcztcbiAgICB2YXIgcmVtb3ZlZEl0ZW1zID0gW107XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoaW5kZXgpKSB7XG4gICAgICB2YXIgbWFwQ29weSA9IFtdLmNvbmNhdCh0aGlzLl9hcnJheU1hcCk7XG4gICAgICBpbmRleC5zb3J0KChmdW5jdGlvbihhLCBiKSB7XG4gICAgICAgIHJldHVybiBiIC0gYTtcbiAgICAgIH0pKTtcbiAgICAgIHJlbW92ZWRJdGVtcyA9IGFycmF5UmVkdWNlKGluZGV4LCAoZnVuY3Rpb24oYWNjLCBpdGVtKSB7XG4gICAgICAgICRfXzQuX2FycmF5TWFwLnNwbGljZShpdGVtLCAxKTtcbiAgICAgICAgcmV0dXJuIGFjYy5jb25jYXQobWFwQ29weS5zbGljZShpdGVtLCBpdGVtICsgMSkpO1xuICAgICAgfSksIFtdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVtb3ZlZEl0ZW1zID0gdGhpcy5fYXJyYXlNYXAuc3BsaWNlKGluZGV4LCBhbW91bnQpO1xuICAgIH1cbiAgICByZXR1cm4gcmVtb3ZlZEl0ZW1zO1xuICB9LFxuICB1bnNoaWZ0SXRlbXM6IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgdmFyIGFtb3VudCA9IGFyZ3VtZW50c1sxXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMV0gOiAxO1xuICAgIHZhciByZW1vdmVkSXRlbXMgPSB0aGlzLnJlbW92ZUl0ZW1zKGluZGV4LCBhbW91bnQpO1xuICAgIGZ1bmN0aW9uIGNvdW50Um93U2hpZnQobG9naWNhbFJvdykge1xuICAgICAgcmV0dXJuIGFycmF5UmVkdWNlKHJlbW92ZWRJdGVtcywgKGZ1bmN0aW9uKGNvdW50LCByZW1vdmVkTG9naWNhbFJvdykge1xuICAgICAgICBpZiAobG9naWNhbFJvdyA+IHJlbW92ZWRMb2dpY2FsUm93KSB7XG4gICAgICAgICAgY291bnQrKztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY291bnQ7XG4gICAgICB9KSwgMCk7XG4gICAgfVxuICAgIHRoaXMuX2FycmF5TWFwID0gYXJyYXlNYXAodGhpcy5fYXJyYXlNYXAsIChmdW5jdGlvbihsb2dpY2FsUm93LCBwaHlzaWNhbFJvdykge1xuICAgICAgdmFyIHJvd1NoaWZ0ID0gY291bnRSb3dTaGlmdChsb2dpY2FsUm93KTtcbiAgICAgIGlmIChyb3dTaGlmdCkge1xuICAgICAgICBsb2dpY2FsUm93IC09IHJvd1NoaWZ0O1xuICAgICAgfVxuICAgICAgcmV0dXJuIGxvZ2ljYWxSb3c7XG4gICAgfSkpO1xuICB9LFxuICBzaGlmdEl0ZW1zOiBmdW5jdGlvbihpbmRleCkge1xuICAgIHZhciBhbW91bnQgPSBhcmd1bWVudHNbMV0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzFdIDogMTtcbiAgICB2YXIgJF9fNCA9IHRoaXM7XG4gICAgdGhpcy5fYXJyYXlNYXAgPSBhcnJheU1hcCh0aGlzLl9hcnJheU1hcCwgKGZ1bmN0aW9uKHJvdykge1xuICAgICAgaWYgKHJvdyA+PSBpbmRleCkge1xuICAgICAgICByb3cgKz0gYW1vdW50O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJvdztcbiAgICB9KSk7XG4gICAgcmFuZ2VFYWNoKGFtb3VudCAtIDEsIChmdW5jdGlvbihjb3VudCkge1xuICAgICAgJF9fNC5fYXJyYXlNYXAuc3BsaWNlKGluZGV4ICsgY291bnQsIDAsIGluZGV4ICsgY291bnQpO1xuICAgIH0pKTtcbiAgfSxcbiAgY2xlYXJNYXA6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuX2FycmF5TWFwLmxlbmd0aCA9IDA7XG4gIH1cbn07XG5kZWZpbmVHZXR0ZXIoYXJyYXlNYXBwZXIsICdNSVhJTl9OQU1FJywgTUlYSU5fTkFNRSwge1xuICB3cml0YWJsZTogZmFsc2UsXG4gIGVudW1lcmFibGU6IGZhbHNlXG59KTtcbjtcbkhhbmRzb250YWJsZS51dGlscy5hcnJheU1hcHBlciA9IGFycmF5TWFwcGVyO1xuXG4vLyMgXG59LHtcImJyb3dzZXJcIjoyNCxcImhlbHBlcnMvYXJyYXlcIjo0MyxcImhlbHBlcnMvbnVtYmVyXCI6NTIsXCJoZWxwZXJzL29iamVjdFwiOjUzfV0sNTg6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIGxvY2FsSG9va3M6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGxvY2FsSG9va3M7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyAmJiAkX19fNDZfXzQ2X180N19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgYXJyYXlFYWNoID0gKCRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2FycmF5XCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X199KS5hcnJheUVhY2g7XG52YXIgZGVmaW5lR2V0dGVyID0gKCRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gPSBfZGVyZXFfKFwiaGVscGVycy9vYmplY3RcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X199KS5kZWZpbmVHZXR0ZXI7XG52YXIgTUlYSU5fTkFNRSA9ICdsb2NhbEhvb2tzJztcbnZhciBsb2NhbEhvb2tzID0ge1xuICBfbG9jYWxIb29rczogT2JqZWN0LmNyZWF0ZShudWxsKSxcbiAgYWRkTG9jYWxIb29rOiBmdW5jdGlvbihrZXksIGNhbGxiYWNrKSB7XG4gICAgaWYgKCF0aGlzLl9sb2NhbEhvb2tzW2tleV0pIHtcbiAgICAgIHRoaXMuX2xvY2FsSG9va3Nba2V5XSA9IFtdO1xuICAgIH1cbiAgICB0aGlzLl9sb2NhbEhvb2tzW2tleV0ucHVzaChjYWxsYmFjayk7XG4gIH0sXG4gIHJ1bkxvY2FsSG9va3M6IGZ1bmN0aW9uKGtleSkge1xuICAgIGZvciAodmFyIHBhcmFtcyA9IFtdLFxuICAgICAgICAkX180ID0gMTsgJF9fNCA8IGFyZ3VtZW50cy5sZW5ndGg7ICRfXzQrKylcbiAgICAgIHBhcmFtc1skX180IC0gMV0gPSBhcmd1bWVudHNbJF9fNF07XG4gICAgdmFyICRfXzMgPSB0aGlzO1xuICAgIGlmICh0aGlzLl9sb2NhbEhvb2tzW2tleV0pIHtcbiAgICAgIGFycmF5RWFjaCh0aGlzLl9sb2NhbEhvb2tzW2tleV0sIChmdW5jdGlvbihjYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gY2FsbGJhY2suYXBwbHkoJF9fMywgcGFyYW1zKTtcbiAgICAgIH0pKTtcbiAgICB9XG4gIH0sXG4gIGNsZWFyTG9jYWxIb29rczogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5fbG9jYWxIb29rcyA9IHt9O1xuICB9XG59O1xuZGVmaW5lR2V0dGVyKGxvY2FsSG9va3MsICdNSVhJTl9OQU1FJywgTUlYSU5fTkFNRSwge1xuICB3cml0YWJsZTogZmFsc2UsXG4gIGVudW1lcmFibGU6IGZhbHNlXG59KTtcbjtcbkhhbmRzb250YWJsZS51dGlscy5sb2NhbEhvb2tzID0gbG9jYWxIb29rcztcblxuLy8jIFxufSx7XCJicm93c2VyXCI6MjQsXCJoZWxwZXJzL2FycmF5XCI6NDMsXCJoZWxwZXJzL29iamVjdFwiOjUzfV0sNTk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIE11bHRpTWFwOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBNdWx0aU1hcDtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG47XG53aW5kb3cuTXVsdGlNYXAgPSBNdWx0aU1hcDtcbmZ1bmN0aW9uIE11bHRpTWFwKCkge1xuICB2YXIgbWFwID0ge1xuICAgIGFycmF5TWFwOiBbXSxcbiAgICB3ZWFrTWFwOiBuZXcgV2Vha01hcCgpXG4gIH07XG4gIHJldHVybiB7XG4gICAgZ2V0OiBmdW5jdGlvbihrZXkpIHtcbiAgICAgIGlmIChjYW5CZUFuQXJyYXlNYXBLZXkoa2V5KSkge1xuICAgICAgICByZXR1cm4gbWFwLmFycmF5TWFwW2tleV07XG4gICAgICB9IGVsc2UgaWYgKGNhbkJlQVdlYWtNYXBLZXkoa2V5KSkge1xuICAgICAgICByZXR1cm4gbWFwLndlYWtNYXAuZ2V0KGtleSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAgIGlmIChjYW5CZUFuQXJyYXlNYXBLZXkoa2V5KSkge1xuICAgICAgICBtYXAuYXJyYXlNYXBba2V5XSA9IHZhbHVlO1xuICAgICAgfSBlbHNlIGlmIChjYW5CZUFXZWFrTWFwS2V5KGtleSkpIHtcbiAgICAgICAgbWFwLndlYWtNYXAuc2V0KGtleSwgdmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGtleSB0eXBlJyk7XG4gICAgICB9XG4gICAgfSxcbiAgICBkZWxldGU6IGZ1bmN0aW9uKGtleSkge1xuICAgICAgaWYgKGNhbkJlQW5BcnJheU1hcEtleShrZXkpKSB7XG4gICAgICAgIGRlbGV0ZSBtYXAuYXJyYXlNYXBba2V5XTtcbiAgICAgIH0gZWxzZSBpZiAoY2FuQmVBV2Vha01hcEtleShrZXkpKSB7XG4gICAgICAgIG1hcC53ZWFrTWFwLmRlbGV0ZShrZXkpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgZnVuY3Rpb24gY2FuQmVBbkFycmF5TWFwS2V5KG9iaikge1xuICAgIHJldHVybiBvYmogIT09IG51bGwgJiYgIWlzTmFOU3ltYm9sKG9iaikgJiYgKHR5cGVvZiBvYmogPT0gJ3N0cmluZycgfHwgdHlwZW9mIG9iaiA9PSAnbnVtYmVyJyk7XG4gIH1cbiAgZnVuY3Rpb24gY2FuQmVBV2Vha01hcEtleShvYmopIHtcbiAgICByZXR1cm4gb2JqICE9PSBudWxsICYmICh0eXBlb2Ygb2JqID09ICdvYmplY3QnIHx8IHR5cGVvZiBvYmogPT0gJ2Z1bmN0aW9uJyk7XG4gIH1cbiAgZnVuY3Rpb24gaXNOYU5TeW1ib2wob2JqKSB7XG4gICAgcmV0dXJuIG9iaiAhPT0gb2JqO1xuICB9XG59XG5cbi8vIyBcbn0se31dLDYwOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBIb29rczoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gSG9va3M7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX2hlbHBlcnNfNDdfYXJyYXlfXyxcbiAgICAkX19oZWxwZXJzXzQ3X29iamVjdF9fO1xudmFyIFJFR0lTVEVSRURfSE9PS1MgPSBbJ2FmdGVyQ2VsbE1ldGFSZXNldCcsICdhZnRlckNoYW5nZScsICdhZnRlckNoYW5nZXNPYnNlcnZlZCcsICdhZnRlckNvbnRleHRNZW51RGVmYXVsdE9wdGlvbnMnLCAnYmVmb3JlQ29udGV4dE1lbnVTZXRJdGVtcycsICdhZnRlckRyb3Bkb3duTWVudURlZmF1bHRPcHRpb25zJywgJ2JlZm9yZURyb3Bkb3duTWVudVNldEl0ZW1zJywgJ2FmdGVyQ29udGV4dE1lbnVIaWRlJywgJ2FmdGVyQ29udGV4dE1lbnVTaG93JywgJ2FmdGVyQ29weUxpbWl0JywgJ2JlZm9yZUNyZWF0ZUNvbCcsICdhZnRlckNyZWF0ZUNvbCcsICdiZWZvcmVDcmVhdGVSb3cnLCAnYWZ0ZXJDcmVhdGVSb3cnLCAnYWZ0ZXJEZXNlbGVjdCcsICdhZnRlckRlc3Ryb3knLCAnYWZ0ZXJEb2N1bWVudEtleURvd24nLCAnYWZ0ZXJHZXRDZWxsTWV0YScsICdhZnRlckdldENvbEhlYWRlcicsICdhZnRlckdldFJvd0hlYWRlcicsICdhZnRlckluaXQnLCAnYWZ0ZXJMb2FkRGF0YScsICdhZnRlck1vbWVudHVtU2Nyb2xsJywgJ2FmdGVyT25DZWxsQ29ybmVyTW91c2VEb3duJywgJ2FmdGVyT25DZWxsQ29ybmVyRGJsQ2xpY2snLCAnYWZ0ZXJPbkNlbGxNb3VzZURvd24nLCAnYWZ0ZXJPbkNlbGxNb3VzZU92ZXInLCAnYWZ0ZXJPbkNlbGxNb3VzZU91dCcsICdhZnRlclJlbW92ZUNvbCcsICdhZnRlclJlbW92ZVJvdycsICdhZnRlclJlbmRlcicsICdiZWZvcmVSZW5kZXJlcicsICdhZnRlclJlbmRlcmVyJywgJ2FmdGVyU2Nyb2xsSG9yaXpvbnRhbGx5JywgJ2FmdGVyU2Nyb2xsVmVydGljYWxseScsICdhZnRlclNlbGVjdGlvbicsICdhZnRlclNlbGVjdGlvbkJ5UHJvcCcsICdhZnRlclNlbGVjdGlvbkVuZCcsICdhZnRlclNlbGVjdGlvbkVuZEJ5UHJvcCcsICdhZnRlclNldENlbGxNZXRhJywgJ2FmdGVyU2V0RGF0YUF0Q2VsbCcsICdhZnRlclNldERhdGFBdFJvd1Byb3AnLCAnYWZ0ZXJVcGRhdGVTZXR0aW5ncycsICdhZnRlclZhbGlkYXRlJywgJ2JlZm9yZUF1dG9maWxsJywgJ2JlZm9yZUNlbGxBbGlnbm1lbnQnLCAnYmVmb3JlQ2hhbmdlJywgJ2JlZm9yZUNoYW5nZVJlbmRlcicsICdiZWZvcmVEcmF3Qm9yZGVycycsICdiZWZvcmVHZXRDZWxsTWV0YScsICdiZWZvcmVJbml0JywgJ2JlZm9yZUluaXRXYWxrb250YWJsZScsICdiZWZvcmVLZXlEb3duJywgJ2JlZm9yZU9uQ2VsbE1vdXNlRG93bicsICdiZWZvcmVPbkNlbGxNb3VzZU92ZXInLCAnYmVmb3JlT25DZWxsTW91c2VPdXQnLCAnYmVmb3JlUmVtb3ZlQ29sJywgJ2JlZm9yZVJlbW92ZVJvdycsICdiZWZvcmVSZW5kZXInLCAnYmVmb3JlU2V0UmFuZ2VTdGFydCcsICdiZWZvcmVTZXRSYW5nZUVuZCcsICdiZWZvcmVUb3VjaFNjcm9sbCcsICdiZWZvcmVWYWxpZGF0ZScsICdiZWZvcmVWYWx1ZVJlbmRlcicsICdjb25zdHJ1Y3QnLCAnaW5pdCcsICdtb2RpZnlDb2wnLCAndW5tb2RpZnlDb2wnLCAndW5tb2RpZnlSb3cnLCAnbW9kaWZ5Q29sSGVhZGVyJywgJ21vZGlmeUNvbFdpZHRoJywgJ21vZGlmeVJvdycsICdtb2RpZnlSb3dIZWFkZXInLCAnbW9kaWZ5Um93SGVpZ2h0JywgJ21vZGlmeURhdGEnLCAnbW9kaWZ5Um93RGF0YScsICdwZXJzaXN0ZW50U3RhdGVMb2FkJywgJ3BlcnNpc3RlbnRTdGF0ZVJlc2V0JywgJ3BlcnNpc3RlbnRTdGF0ZVNhdmUnLCAnYmVmb3JlQ29sdW1uU29ydCcsICdhZnRlckNvbHVtblNvcnQnLCAnbW9kaWZ5QXV0b2ZpbGxSYW5nZScsICdtb2RpZnlDb3B5YWJsZVJhbmdlJywgJ2JlZm9yZUN1dCcsICdhZnRlckN1dCcsICdiZWZvcmVDb3B5JywgJ2FmdGVyQ29weScsICdiZWZvcmVQYXN0ZScsICdhZnRlclBhc3RlJywgJ2JlZm9yZUNvbHVtbk1vdmUnLCAnYWZ0ZXJDb2x1bW5Nb3ZlJywgJ2JlZm9yZVJvd01vdmUnLCAnYWZ0ZXJSb3dNb3ZlJywgJ2JlZm9yZUNvbHVtblJlc2l6ZScsICdhZnRlckNvbHVtblJlc2l6ZScsICdiZWZvcmVSb3dSZXNpemUnLCAnYWZ0ZXJSb3dSZXNpemUnLCAnYWZ0ZXJHZXRDb2x1bW5IZWFkZXJSZW5kZXJlcnMnLCAnYWZ0ZXJHZXRSb3dIZWFkZXJSZW5kZXJlcnMnLCAnYmVmb3JlU3RyZXRjaGluZ0NvbHVtbldpZHRoJywgJ2JlZm9yZUZpbHRlcicsICdhZnRlckZpbHRlcicsICdtb2RpZnlDb2x1bW5IZWFkZXJIZWlnaHQnLCAnYmVmb3JlVW5kbycsICdhZnRlclVuZG8nLCAnYmVmb3JlUmVkbycsICdhZnRlclJlZG8nLCAnbW9kaWZ5Um93SGVhZGVyV2lkdGgnLCAnYmVmb3JlQXV0b2ZpbGxJbnNpZGVQb3B1bGF0ZScsICdtb2RpZnlUcmFuc2Zvcm1TdGFydCcsICdtb2RpZnlUcmFuc2Zvcm1FbmQnLCAnYWZ0ZXJNb2RpZnlUcmFuc2Zvcm1TdGFydCcsICdhZnRlck1vZGlmeVRyYW5zZm9ybUVuZCcsICdiZWZvcmVWYWx1ZVJlbmRlcicsICdhZnRlclZpZXdwb3J0Um93Q2FsY3VsYXRvck92ZXJyaWRlJywgJ2FmdGVyVmlld3BvcnRDb2x1bW5DYWxjdWxhdG9yT3ZlcnJpZGUnLCAnYWZ0ZXJQbHVnaW5zSW5pdGlhbGl6ZWQnLCAnbWFudWFsUm93SGVpZ2h0cycsICdza2lwTGVuZ3RoQ2FjaGUnLCAnYWZ0ZXJUcmltUm93JywgJ2FmdGVyVW50cmltUm93JywgJ2FmdGVyRHJvcGRvd25NZW51U2hvdycsICdhZnRlckRyb3Bkb3duTWVudUhpZGUnLCAnaGlkZGVuUm93JywgJ2hpZGRlbkNvbHVtbicsICdiZWZvcmVBZGRDaGlsZCcsICdhZnRlckFkZENoaWxkJywgJ2JlZm9yZURldGFjaENoaWxkJywgJ2FmdGVyRGV0YWNoQ2hpbGQnLCAnYWZ0ZXJCZWdpbkVkaXRpbmcnXTtcbnZhciBhcnJheUVhY2ggPSAoJF9faGVscGVyc180N19hcnJheV9fID0gX2RlcmVxXyhcImhlbHBlcnMvYXJyYXlcIiksICRfX2hlbHBlcnNfNDdfYXJyYXlfXyAmJiAkX19oZWxwZXJzXzQ3X2FycmF5X18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X2FycmF5X18gfHwge2RlZmF1bHQ6ICRfX2hlbHBlcnNfNDdfYXJyYXlfX30pLmFycmF5RWFjaDtcbnZhciBvYmplY3RFYWNoID0gKCRfX2hlbHBlcnNfNDdfb2JqZWN0X18gPSBfZGVyZXFfKFwiaGVscGVycy9vYmplY3RcIiksICRfX2hlbHBlcnNfNDdfb2JqZWN0X18gJiYgJF9faGVscGVyc180N19vYmplY3RfXy5fX2VzTW9kdWxlICYmICRfX2hlbHBlcnNfNDdfb2JqZWN0X18gfHwge2RlZmF1bHQ6ICRfX2hlbHBlcnNfNDdfb2JqZWN0X199KS5vYmplY3RFYWNoO1xudmFyIEhvb2tzID0gZnVuY3Rpb24gSG9va3MoKSB7XG4gIHRoaXMuZ2xvYmFsQnVja2V0ID0gdGhpcy5jcmVhdGVFbXB0eUJ1Y2tldCgpO1xufTtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKEhvb2tzLCB7XG4gIGNyZWF0ZUVtcHR5QnVja2V0OiBmdW5jdGlvbigpIHtcbiAgICB2YXIgYnVja2V0ID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICBhcnJheUVhY2goUkVHSVNURVJFRF9IT09LUywgKGZ1bmN0aW9uKGhvb2spIHtcbiAgICAgIHJldHVybiAoYnVja2V0W2hvb2tdID0gW10pO1xuICAgIH0pKTtcbiAgICByZXR1cm4gYnVja2V0O1xuICB9LFxuICBnZXRCdWNrZXQ6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBjb250ZXh0ID0gYXJndW1lbnRzWzBdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1swXSA6IG51bGw7XG4gICAgaWYgKGNvbnRleHQpIHtcbiAgICAgIGlmICghY29udGV4dC5wbHVnaW5Ib29rQnVja2V0KSB7XG4gICAgICAgIGNvbnRleHQucGx1Z2luSG9va0J1Y2tldCA9IHRoaXMuY3JlYXRlRW1wdHlCdWNrZXQoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBjb250ZXh0LnBsdWdpbkhvb2tCdWNrZXQ7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmdsb2JhbEJ1Y2tldDtcbiAgfSxcbiAgYWRkOiBmdW5jdGlvbihrZXksIGNhbGxiYWNrKSB7XG4gICAgdmFyIGNvbnRleHQgPSBhcmd1bWVudHNbMl0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzJdIDogbnVsbDtcbiAgICB2YXIgJF9fMiA9IHRoaXM7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoY2FsbGJhY2spKSB7XG4gICAgICBhcnJheUVhY2goY2FsbGJhY2ssIChmdW5jdGlvbihjKSB7XG4gICAgICAgIHJldHVybiAkX18yLmFkZChrZXksIGMsIGNvbnRleHQpO1xuICAgICAgfSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgYnVja2V0ID0gdGhpcy5nZXRCdWNrZXQoY29udGV4dCk7XG4gICAgICBpZiAodHlwZW9mIGJ1Y2tldFtrZXldID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICB0aGlzLnJlZ2lzdGVyKGtleSk7XG4gICAgICAgIGJ1Y2tldFtrZXldID0gW107XG4gICAgICB9XG4gICAgICBjYWxsYmFjay5za2lwID0gZmFsc2U7XG4gICAgICBpZiAoYnVja2V0W2tleV0uaW5kZXhPZihjYWxsYmFjaykgPT09IC0xKSB7XG4gICAgICAgIHZhciBmb3VuZEluaXRpYWxIb29rID0gZmFsc2U7XG4gICAgICAgIGlmIChjYWxsYmFjay5pbml0aWFsSG9vaykge1xuICAgICAgICAgIGFycmF5RWFjaChidWNrZXRba2V5XSwgKGZ1bmN0aW9uKGNiLCBpKSB7XG4gICAgICAgICAgICBpZiAoY2IuaW5pdGlhbEhvb2spIHtcbiAgICAgICAgICAgICAgYnVja2V0W2tleV1baV0gPSBjYWxsYmFjaztcbiAgICAgICAgICAgICAgZm91bmRJbml0aWFsSG9vayA9IHRydWU7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFmb3VuZEluaXRpYWxIb29rKSB7XG4gICAgICAgICAgYnVja2V0W2tleV0ucHVzaChjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIG9uY2U6IGZ1bmN0aW9uKGtleSwgY2FsbGJhY2spIHtcbiAgICB2YXIgY29udGV4dCA9IGFyZ3VtZW50c1syXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMl0gOiBudWxsO1xuICAgIHZhciAkX18yID0gdGhpcztcbiAgICBpZiAoQXJyYXkuaXNBcnJheShjYWxsYmFjaykpIHtcbiAgICAgIGFycmF5RWFjaChjYWxsYmFjaywgKGZ1bmN0aW9uKGMpIHtcbiAgICAgICAgcmV0dXJuICRfXzIub25jZShrZXksIGMsIGNvbnRleHQpO1xuICAgICAgfSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjYWxsYmFjay5ydW5PbmNlID0gdHJ1ZTtcbiAgICAgIHRoaXMuYWRkKGtleSwgY2FsbGJhY2ssIGNvbnRleHQpO1xuICAgIH1cbiAgfSxcbiAgcmVtb3ZlOiBmdW5jdGlvbihrZXksIGNhbGxiYWNrKSB7XG4gICAgdmFyIGNvbnRleHQgPSBhcmd1bWVudHNbMl0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzJdIDogbnVsbDtcbiAgICB2YXIgYnVja2V0ID0gdGhpcy5nZXRCdWNrZXQoY29udGV4dCk7XG4gICAgaWYgKHR5cGVvZiBidWNrZXRba2V5XSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGlmIChidWNrZXRba2V5XS5pbmRleE9mKGNhbGxiYWNrKSA+PSAwKSB7XG4gICAgICAgIGNhbGxiYWNrLnNraXAgPSB0cnVlO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9LFxuICBoYXM6IGZ1bmN0aW9uKGtleSkge1xuICAgIHZhciBjb250ZXh0ID0gYXJndW1lbnRzWzFdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1sxXSA6IG51bGw7XG4gICAgdmFyIGJ1Y2tldCA9IHRoaXMuZ2V0QnVja2V0KGNvbnRleHQpO1xuICAgIHJldHVybiBidWNrZXRba2V5XSAhPT0gdm9pZCAwICYmIGJ1Y2tldFtrZXldLmxlbmd0aCA/IHRydWUgOiBmYWxzZTtcbiAgfSxcbiAgcnVuOiBmdW5jdGlvbihjb250ZXh0LCBrZXksIHAxLCBwMiwgcDMsIHA0LCBwNSwgcDYpIHtcbiAgICB7XG4gICAgICB2YXIgZ2xvYmFsSGFuZGxlcnMgPSB0aGlzLmdsb2JhbEJ1Y2tldFtrZXldO1xuICAgICAgdmFyIGluZGV4ID0gLTE7XG4gICAgICB2YXIgbGVuZ3RoID0gZ2xvYmFsSGFuZGxlcnMgPyBnbG9iYWxIYW5kbGVycy5sZW5ndGggOiAwO1xuICAgICAgaWYgKGxlbmd0aCkge1xuICAgICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICAgIGlmICghZ2xvYmFsSGFuZGxlcnNbaW5kZXhdIHx8IGdsb2JhbEhhbmRsZXJzW2luZGV4XS5za2lwKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHJlcyA9IGdsb2JhbEhhbmRsZXJzW2luZGV4XS5jYWxsKGNvbnRleHQsIHAxLCBwMiwgcDMsIHA0LCBwNSwgcDYpO1xuICAgICAgICAgIGlmIChyZXMgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgcDEgPSByZXM7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChnbG9iYWxIYW5kbGVyc1tpbmRleF0gJiYgZ2xvYmFsSGFuZGxlcnNbaW5kZXhdLnJ1bk9uY2UpIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlKGtleSwgZ2xvYmFsSGFuZGxlcnNbaW5kZXhdKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAge1xuICAgICAgdmFyIGxvY2FsSGFuZGxlcnMgPSB0aGlzLmdldEJ1Y2tldChjb250ZXh0KVtrZXldO1xuICAgICAgdmFyIGluZGV4JF9fNCA9IC0xO1xuICAgICAgdmFyIGxlbmd0aCRfXzUgPSBsb2NhbEhhbmRsZXJzID8gbG9jYWxIYW5kbGVycy5sZW5ndGggOiAwO1xuICAgICAgaWYgKGxlbmd0aCRfXzUpIHtcbiAgICAgICAgd2hpbGUgKCsraW5kZXgkX180IDwgbGVuZ3RoJF9fNSkge1xuICAgICAgICAgIGlmICghbG9jYWxIYW5kbGVyc1tpbmRleCRfXzRdIHx8IGxvY2FsSGFuZGxlcnNbaW5kZXgkX180XS5za2lwKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHJlcyRfXzYgPSBsb2NhbEhhbmRsZXJzW2luZGV4JF9fNF0uY2FsbChjb250ZXh0LCBwMSwgcDIsIHAzLCBwNCwgcDUsIHA2KTtcbiAgICAgICAgICBpZiAocmVzJF9fNiAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBwMSA9IHJlcyRfXzY7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChsb2NhbEhhbmRsZXJzW2luZGV4JF9fNF0gJiYgbG9jYWxIYW5kbGVyc1tpbmRleCRfXzRdLnJ1bk9uY2UpIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlKGtleSwgbG9jYWxIYW5kbGVyc1tpbmRleCRfXzRdLCBjb250ZXh0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHAxO1xuICB9LFxuICBkZXN0cm95OiBmdW5jdGlvbigpIHtcbiAgICB2YXIgY29udGV4dCA9IGFyZ3VtZW50c1swXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMF0gOiBudWxsO1xuICAgIG9iamVjdEVhY2godGhpcy5nZXRCdWNrZXQoY29udGV4dCksIChmdW5jdGlvbih2YWx1ZSwga2V5LCBidWNrZXQpIHtcbiAgICAgIHJldHVybiAoYnVja2V0W2tleV0ubGVuZ3RoID0gMCk7XG4gICAgfSkpO1xuICB9LFxuICByZWdpc3RlcjogZnVuY3Rpb24oa2V5KSB7XG4gICAgaWYgKCF0aGlzLmlzUmVnaXN0ZXJlZChrZXkpKSB7XG4gICAgICBSRUdJU1RFUkVEX0hPT0tTLnB1c2goa2V5KTtcbiAgICB9XG4gIH0sXG4gIGRlcmVnaXN0ZXI6IGZ1bmN0aW9uKGtleSkge1xuICAgIGlmICh0aGlzLmlzUmVnaXN0ZXJlZChrZXkpKSB7XG4gICAgICBSRUdJU1RFUkVEX0hPT0tTLnNwbGljZShSRUdJU1RFUkVEX0hPT0tTLmluZGV4T2Yoa2V5KSwgMSk7XG4gICAgfVxuICB9LFxuICBpc1JlZ2lzdGVyZWQ6IGZ1bmN0aW9uKGtleSkge1xuICAgIHJldHVybiBSRUdJU1RFUkVEX0hPT0tTLmluZGV4T2Yoa2V5KSA+PSAwO1xuICB9LFxuICBnZXRSZWdpc3RlcmVkOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gUkVHSVNURVJFRF9IT09LUztcbiAgfVxufSwge30pO1xuO1xuXG4vLyMgXG59LHtcImhlbHBlcnMvYXJyYXlcIjo0MyxcImhlbHBlcnMvb2JqZWN0XCI6NTN9XSw2MTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgcmVnaXN0ZXJQbHVnaW46IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHJlZ2lzdGVyUGx1Z2luO1xuICAgIH19LFxuICBnZXRQbHVnaW46IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGdldFBsdWdpbjtcbiAgICB9fSxcbiAgZ2V0UmVnaXN0cmVkUGx1Z2luTmFtZXM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGdldFJlZ2lzdHJlZFBsdWdpbk5hbWVzO1xuICAgIH19LFxuICBnZXRQbHVnaW5OYW1lOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBnZXRQbHVnaW5OYW1lO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19icm93c2VyX18sXG4gICAgJF9faGVscGVyc180N19vYmplY3RfXyxcbiAgICAkX19oZWxwZXJzXzQ3X3N0cmluZ19fO1xudmFyIEhhbmRzb250YWJsZSA9ICgkX19icm93c2VyX18gPSBfZGVyZXFfKFwiYnJvd3NlclwiKSwgJF9fYnJvd3Nlcl9fICYmICRfX2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fYnJvd3Nlcl9ffSkuZGVmYXVsdDtcbnZhciBvYmplY3RFYWNoID0gKCRfX2hlbHBlcnNfNDdfb2JqZWN0X18gPSBfZGVyZXFfKFwiaGVscGVycy9vYmplY3RcIiksICRfX2hlbHBlcnNfNDdfb2JqZWN0X18gJiYgJF9faGVscGVyc180N19vYmplY3RfXy5fX2VzTW9kdWxlICYmICRfX2hlbHBlcnNfNDdfb2JqZWN0X18gfHwge2RlZmF1bHQ6ICRfX2hlbHBlcnNfNDdfb2JqZWN0X199KS5vYmplY3RFYWNoO1xudmFyIHRvVXBwZXJDYXNlRmlyc3QgPSAoJF9faGVscGVyc180N19zdHJpbmdfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL3N0cmluZ1wiKSwgJF9faGVscGVyc180N19zdHJpbmdfXyAmJiAkX19oZWxwZXJzXzQ3X3N0cmluZ19fLl9fZXNNb2R1bGUgJiYgJF9faGVscGVyc180N19zdHJpbmdfXyB8fCB7ZGVmYXVsdDogJF9faGVscGVyc180N19zdHJpbmdfX30pLnRvVXBwZXJDYXNlRmlyc3Q7XG52YXIgcmVnaXN0ZXJlZFBsdWdpbnMgPSBuZXcgV2Vha01hcCgpO1xuZnVuY3Rpb24gcmVnaXN0ZXJQbHVnaW4ocGx1Z2luTmFtZSwgUGx1Z2luQ2xhc3MpIHtcbiAgcGx1Z2luTmFtZSA9IHRvVXBwZXJDYXNlRmlyc3QocGx1Z2luTmFtZSk7XG4gIEhhbmRzb250YWJsZS5wbHVnaW5zW3BsdWdpbk5hbWVdID0gUGx1Z2luQ2xhc3M7XG4gIEhhbmRzb250YWJsZS5ob29rcy5hZGQoJ2NvbnN0cnVjdCcsIGZ1bmN0aW9uKCkge1xuICAgIHZhciBob2xkZXI7XG4gICAgaWYgKCFyZWdpc3RlcmVkUGx1Z2lucy5oYXModGhpcykpIHtcbiAgICAgIHJlZ2lzdGVyZWRQbHVnaW5zLnNldCh0aGlzLCB7fSk7XG4gICAgfVxuICAgIGhvbGRlciA9IHJlZ2lzdGVyZWRQbHVnaW5zLmdldCh0aGlzKTtcbiAgICBpZiAoIWhvbGRlcltwbHVnaW5OYW1lXSkge1xuICAgICAgaG9sZGVyW3BsdWdpbk5hbWVdID0gbmV3IFBsdWdpbkNsYXNzKHRoaXMpO1xuICAgIH1cbiAgfSk7XG4gIEhhbmRzb250YWJsZS5ob29rcy5hZGQoJ2FmdGVyRGVzdHJveScsIGZ1bmN0aW9uKCkge1xuICAgIGlmIChyZWdpc3RlcmVkUGx1Z2lucy5oYXModGhpcykpIHtcbiAgICAgIHZhciBwbHVnaW5zSG9sZGVyID0gcmVnaXN0ZXJlZFBsdWdpbnMuZ2V0KHRoaXMpO1xuICAgICAgb2JqZWN0RWFjaChwbHVnaW5zSG9sZGVyLCAoZnVuY3Rpb24ocGx1Z2luKSB7XG4gICAgICAgIHJldHVybiBwbHVnaW4uZGVzdHJveSgpO1xuICAgICAgfSkpO1xuICAgICAgcmVnaXN0ZXJlZFBsdWdpbnMuZGVsZXRlKHRoaXMpO1xuICAgIH1cbiAgfSk7XG59XG5mdW5jdGlvbiBnZXRQbHVnaW4oaW5zdGFuY2UsIHBsdWdpbk5hbWUpIHtcbiAgaWYgKHR5cGVvZiBwbHVnaW5OYW1lICE9ICdzdHJpbmcnKSB7XG4gICAgdGhyb3cgRXJyb3IoJ09ubHkgc3RyaW5ncyBjYW4gYmUgcGFzc2VkIGFzIFwicGx1Z2luXCIgcGFyYW1ldGVyJyk7XG4gIH1cbiAgdmFyIF9wbHVnaW5OYW1lID0gdG9VcHBlckNhc2VGaXJzdChwbHVnaW5OYW1lKTtcbiAgaWYgKCFyZWdpc3RlcmVkUGx1Z2lucy5oYXMoaW5zdGFuY2UpIHx8ICFyZWdpc3RlcmVkUGx1Z2lucy5nZXQoaW5zdGFuY2UpW19wbHVnaW5OYW1lXSkge1xuICAgIHJldHVybiB2b2lkIDA7XG4gIH1cbiAgcmV0dXJuIHJlZ2lzdGVyZWRQbHVnaW5zLmdldChpbnN0YW5jZSlbX3BsdWdpbk5hbWVdO1xufVxuZnVuY3Rpb24gZ2V0UmVnaXN0cmVkUGx1Z2luTmFtZXMoaG90SW5zdGFuY2UpIHtcbiAgcmV0dXJuIHJlZ2lzdGVyZWRQbHVnaW5zLmhhcyhob3RJbnN0YW5jZSkgPyBPYmplY3Qua2V5cyhyZWdpc3RlcmVkUGx1Z2lucy5nZXQoaG90SW5zdGFuY2UpKSA6IFtdO1xufVxuZnVuY3Rpb24gZ2V0UGx1Z2luTmFtZShob3RJbnN0YW5jZSwgcGx1Z2luKSB7XG4gIHZhciBwbHVnaW5OYW1lID0gbnVsbDtcbiAgaWYgKHJlZ2lzdGVyZWRQbHVnaW5zLmhhcyhob3RJbnN0YW5jZSkpIHtcbiAgICBvYmplY3RFYWNoKHJlZ2lzdGVyZWRQbHVnaW5zLmdldChob3RJbnN0YW5jZSksIChmdW5jdGlvbihwbHVnaW5JbnN0YW5jZSwgbmFtZSkge1xuICAgICAgaWYgKHBsdWdpbkluc3RhbmNlID09PSBwbHVnaW4pIHtcbiAgICAgICAgcGx1Z2luTmFtZSA9IG5hbWU7XG4gICAgICB9XG4gICAgfSkpO1xuICB9XG4gIHJldHVybiBwbHVnaW5OYW1lO1xufVxuO1xuXG4vLyMgXG59LHtcImJyb3dzZXJcIjoyNCxcImhlbHBlcnMvb2JqZWN0XCI6NTMsXCJoZWxwZXJzL3N0cmluZ1wiOjU1fV0sNjI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIGRlZmF1bHQ6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICRfX2RlZmF1bHQ7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyxcbiAgICAkX19fNDZfXzQ2X180N191dGlsc180N19yZWNvcmRUcmFuc2xhdG9yX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfcGx1Z2luc19fO1xudmFyIEhhbmRzb250YWJsZSA9ICgkX19fNDZfXzQ2X180N19icm93c2VyX18gPSBfZGVyZXFfKFwiYnJvd3NlclwiKSwgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9ffSkuZGVmYXVsdDtcbnZhciAkX18xID0gKCRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gPSBfZGVyZXFfKFwiaGVscGVycy9vYmplY3RcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X199KSxcbiAgICBkZWZpbmVHZXR0ZXIgPSAkX18xLmRlZmluZUdldHRlcixcbiAgICBvYmplY3RFYWNoID0gJF9fMS5vYmplY3RFYWNoO1xudmFyIGFycmF5RWFjaCA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gPSBfZGVyZXFfKFwiaGVscGVycy9hcnJheVwiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9ffSkuYXJyYXlFYWNoO1xudmFyICRfXzMgPSAoJF9fXzQ2X180Nl9fNDdfdXRpbHNfNDdfcmVjb3JkVHJhbnNsYXRvcl9fID0gX2RlcmVxXyhcInV0aWxzL3JlY29yZFRyYW5zbGF0b3JcIiksICRfX180Nl9fNDZfXzQ3X3V0aWxzXzQ3X3JlY29yZFRyYW5zbGF0b3JfXyAmJiAkX19fNDZfXzQ2X180N191dGlsc180N19yZWNvcmRUcmFuc2xhdG9yX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N191dGlsc180N19yZWNvcmRUcmFuc2xhdG9yX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X3V0aWxzXzQ3X3JlY29yZFRyYW5zbGF0b3JfX30pLFxuICAgIHJlZ2lzdGVySWRlbnRpdHkgPSAkX18zLnJlZ2lzdGVySWRlbnRpdHksXG4gICAgZ2V0VHJhbnNsYXRvciA9ICRfXzMuZ2V0VHJhbnNsYXRvcjtcbnZhciAkX180ID0gKCRfX180Nl9fNDZfXzQ3X3BsdWdpbnNfXyA9IF9kZXJlcV8oXCJwbHVnaW5zXCIpLCAkX19fNDZfXzQ2X180N19wbHVnaW5zX18gJiYgJF9fXzQ2X180Nl9fNDdfcGx1Z2luc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfcGx1Z2luc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19wbHVnaW5zX199KSxcbiAgICBnZXRSZWdpc3RyZWRQbHVnaW5OYW1lcyA9ICRfXzQuZ2V0UmVnaXN0cmVkUGx1Z2luTmFtZXMsXG4gICAgZ2V0UGx1Z2luTmFtZSA9ICRfXzQuZ2V0UGx1Z2luTmFtZTtcbnZhciBwcml2YXRlUG9vbCA9IG5ldyBXZWFrTWFwKCk7XG52YXIgaW5pdGlhbGl6ZWRQbHVnaW5zID0gbnVsbDtcbnZhciBCYXNlUGx1Z2luID0gZnVuY3Rpb24gQmFzZVBsdWdpbihob3RJbnN0YW5jZSkge1xuICB2YXIgJF9fNSA9IHRoaXM7XG4gIGRlZmluZUdldHRlcih0aGlzLCAnaG90JywgaG90SW5zdGFuY2UsIHt3cml0YWJsZTogZmFsc2V9KTtcbiAgZGVmaW5lR2V0dGVyKHRoaXMsICd0JywgZ2V0VHJhbnNsYXRvcihob3RJbnN0YW5jZSksIHt3cml0YWJsZTogZmFsc2V9KTtcbiAgcHJpdmF0ZVBvb2wuc2V0KHRoaXMsIHtob29rczoge319KTtcbiAgaW5pdGlhbGl6ZWRQbHVnaW5zID0gbnVsbDtcbiAgdGhpcy5wbHVnaW5OYW1lID0gbnVsbDtcbiAgdGhpcy5wbHVnaW5zSW5pdGlhbGl6ZWRDYWxsYmFja3MgPSBbXTtcbiAgdGhpcy5pc1BsdWdpbnNSZWFkeSA9IGZhbHNlO1xuICB0aGlzLmVuYWJsZWQgPSBmYWxzZTtcbiAgdGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuICB0aGlzLmhvdC5hZGRIb29rKCdhZnRlclBsdWdpbnNJbml0aWFsaXplZCcsIChmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJF9fNS5vbkFmdGVyUGx1Z2luc0luaXRpYWxpemVkKCk7XG4gIH0pKTtcbiAgdGhpcy5ob3QuYWRkSG9vaygnYWZ0ZXJVcGRhdGVTZXR0aW5ncycsIChmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJF9fNS5vblVwZGF0ZVNldHRpbmdzKCk7XG4gIH0pKTtcbiAgdGhpcy5ob3QuYWRkSG9vaygnYmVmb3JlSW5pdCcsIChmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJF9fNS5pbml0KCk7XG4gIH0pKTtcbn07XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShCYXNlUGx1Z2luLCB7XG4gIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucGx1Z2luTmFtZSA9IGdldFBsdWdpbk5hbWUodGhpcy5ob3QsIHRoaXMpO1xuICAgIGlmICh0aGlzLmlzRW5hYmxlZCAmJiB0aGlzLmlzRW5hYmxlZCgpKSB7XG4gICAgICB0aGlzLmVuYWJsZVBsdWdpbigpO1xuICAgIH1cbiAgICBpZiAoIWluaXRpYWxpemVkUGx1Z2lucykge1xuICAgICAgaW5pdGlhbGl6ZWRQbHVnaW5zID0gZ2V0UmVnaXN0cmVkUGx1Z2luTmFtZXModGhpcy5ob3QpO1xuICAgIH1cbiAgICBpZiAoaW5pdGlhbGl6ZWRQbHVnaW5zLmluZGV4T2YodGhpcy5wbHVnaW5OYW1lKSA+PSAwKSB7XG4gICAgICBpbml0aWFsaXplZFBsdWdpbnMuc3BsaWNlKGluaXRpYWxpemVkUGx1Z2lucy5pbmRleE9mKHRoaXMucGx1Z2luTmFtZSksIDEpO1xuICAgIH1cbiAgICBpZiAoIWluaXRpYWxpemVkUGx1Z2lucy5sZW5ndGgpIHtcbiAgICAgIHRoaXMuaG90LnJ1bkhvb2tzKCdhZnRlclBsdWdpbnNJbml0aWFsaXplZCcpO1xuICAgIH1cbiAgICB0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcbiAgfSxcbiAgZW5hYmxlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmVuYWJsZWQgPSB0cnVlO1xuICB9LFxuICBkaXNhYmxlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5ldmVudE1hbmFnZXIpIHtcbiAgICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmNsZWFyKCk7XG4gICAgfVxuICAgIHRoaXMuY2xlYXJIb29rcygpO1xuICAgIHRoaXMuZW5hYmxlZCA9IGZhbHNlO1xuICB9LFxuICBhZGRIb29rOiBmdW5jdGlvbihuYW1lLCBjYWxsYmFjaykge1xuICAgIHZhciBob29rcyA9IHByaXZhdGVQb29sLmdldCh0aGlzKS5ob29rc1tuYW1lXSA9IChwcml2YXRlUG9vbC5nZXQodGhpcykuaG9va3NbbmFtZV0gfHwgW10pO1xuICAgIHRoaXMuaG90LmFkZEhvb2sobmFtZSwgY2FsbGJhY2spO1xuICAgIGhvb2tzLnB1c2goY2FsbGJhY2spO1xuICAgIHByaXZhdGVQb29sLmdldCh0aGlzKS5ob29rc1tuYW1lXSA9IGhvb2tzO1xuICB9LFxuICByZW1vdmVIb29rczogZnVuY3Rpb24obmFtZSkge1xuICAgIHZhciAkX181ID0gdGhpcztcbiAgICBhcnJheUVhY2gocHJpdmF0ZVBvb2wuZ2V0KHRoaXMpLmhvb2tzW25hbWVdIHx8IFtdLCAoZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICAgICRfXzUuaG90LnJlbW92ZUhvb2sobmFtZSwgY2FsbGJhY2spO1xuICAgIH0pKTtcbiAgfSxcbiAgY2xlYXJIb29rczogZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzUgPSB0aGlzO1xuICAgIHZhciBob29rcyA9IHByaXZhdGVQb29sLmdldCh0aGlzKS5ob29rcztcbiAgICBvYmplY3RFYWNoKGhvb2tzLCAoZnVuY3Rpb24oY2FsbGJhY2tzLCBuYW1lKSB7XG4gICAgICByZXR1cm4gJF9fNS5yZW1vdmVIb29rcyhuYW1lKTtcbiAgICB9KSk7XG4gICAgaG9va3MubGVuZ3RoID0gMDtcbiAgfSxcbiAgY2FsbE9uUGx1Z2luc1JlYWR5OiBmdW5jdGlvbihjYWxsYmFjaykge1xuICAgIGlmICh0aGlzLmlzUGx1Z2luc1JlYWR5KSB7XG4gICAgICBjYWxsYmFjaygpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnBsdWdpbnNJbml0aWFsaXplZENhbGxiYWNrcy5wdXNoKGNhbGxiYWNrKTtcbiAgICB9XG4gIH0sXG4gIG9uQWZ0ZXJQbHVnaW5zSW5pdGlhbGl6ZWQ6IGZ1bmN0aW9uKCkge1xuICAgIGFycmF5RWFjaCh0aGlzLnBsdWdpbnNJbml0aWFsaXplZENhbGxiYWNrcywgKGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgICByZXR1cm4gY2FsbGJhY2soKTtcbiAgICB9KSk7XG4gICAgdGhpcy5wbHVnaW5zSW5pdGlhbGl6ZWRDYWxsYmFja3MubGVuZ3RoID0gMDtcbiAgICB0aGlzLmlzUGx1Z2luc1JlYWR5ID0gdHJ1ZTtcbiAgfSxcbiAgb25VcGRhdGVTZXR0aW5nczogZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuaXNFbmFibGVkKSB7XG4gICAgICBpZiAodGhpcy5lbmFibGVkICYmICF0aGlzLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgIHRoaXMuZGlzYWJsZVBsdWdpbigpO1xuICAgICAgfVxuICAgICAgaWYgKCF0aGlzLmVuYWJsZWQgJiYgdGhpcy5pc0VuYWJsZWQoKSkge1xuICAgICAgICB0aGlzLmVuYWJsZVBsdWdpbigpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuZW5hYmxlZCAmJiB0aGlzLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgIHRoaXMudXBkYXRlUGx1Z2luKCk7XG4gICAgICB9XG4gICAgfVxuICB9LFxuICB1cGRhdGVQbHVnaW46IGZ1bmN0aW9uKCkge30sXG4gIGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX181ID0gdGhpcztcbiAgICBpZiAodGhpcy5ldmVudE1hbmFnZXIpIHtcbiAgICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmRlc3Ryb3koKTtcbiAgICB9XG4gICAgdGhpcy5jbGVhckhvb2tzKCk7XG4gICAgb2JqZWN0RWFjaCh0aGlzLCAoZnVuY3Rpb24odmFsdWUsIHByb3BlcnR5KSB7XG4gICAgICBpZiAocHJvcGVydHkgIT09ICdob3QnICYmIHByb3BlcnR5ICE9PSAndCcpIHtcbiAgICAgICAgJF9fNVtwcm9wZXJ0eV0gPSBudWxsO1xuICAgICAgfVxuICAgIH0pKTtcbiAgICBkZWxldGUgdGhpcy50O1xuICAgIGRlbGV0ZSB0aGlzLmhvdDtcbiAgfVxufSwge30pO1xudmFyICRfX2RlZmF1bHQgPSBCYXNlUGx1Z2luO1xuSGFuZHNvbnRhYmxlLnBsdWdpbnMuQmFzZVBsdWdpbiA9IEJhc2VQbHVnaW47XG5cbi8vIyBcbn0se1wiYnJvd3NlclwiOjI0LFwiaGVscGVycy9hcnJheVwiOjQzLFwiaGVscGVycy9vYmplY3RcIjo1MyxcInBsdWdpbnNcIjo2MSxcInV0aWxzL3JlY29yZFRyYW5zbGF0b3JcIjoxMzB9XSw2MzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgQXV0b0NvbHVtblNpemU6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIEF1dG9Db2x1bW5TaXplO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2ZlYXR1cmVfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfdXRpbHNfNDdfZ2hvc3RUYWJsZV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfdXRpbHNfNDdfc2FtcGxlc0dlbmVyYXRvcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfc3RyaW5nX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NhbGN1bGF0b3JfNDdfdmlld3BvcnRDb2x1bW5zX187XG52YXIgQmFzZVBsdWdpbiA9ICgkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fID0gX2RlcmVxXyhcIl9iYXNlXCIpLCAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fICYmICRfX180Nl9fNDZfXzQ3X185NV9iYXNlX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9ffSkuZGVmYXVsdDtcbnZhciAkX18xID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2FycmF5XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X199KSxcbiAgICBhcnJheUVhY2ggPSAkX18xLmFycmF5RWFjaCxcbiAgICBhcnJheUZpbHRlciA9ICRfXzEuYXJyYXlGaWx0ZXIsXG4gICAgYXJyYXlSZWR1Y2UgPSAkX18xLmFycmF5UmVkdWNlLFxuICAgIGFycmF5TWFwID0gJF9fMS5hcnJheU1hcDtcbnZhciAkX18yID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZmVhdHVyZV9fID0gX2RlcmVxXyhcImhlbHBlcnMvZmVhdHVyZVwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19mZWF0dXJlX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19mZWF0dXJlX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2ZlYXR1cmVfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19mZWF0dXJlX199KSxcbiAgICBjYW5jZWxBbmltYXRpb25GcmFtZSA9ICRfXzIuY2FuY2VsQW5pbWF0aW9uRnJhbWUsXG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gJF9fMi5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU7XG52YXIgaXNWaXNpYmxlID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9lbGVtZW50XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X199KS5pc1Zpc2libGU7XG52YXIgR2hvc3RUYWJsZSA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N191dGlsc180N19naG9zdFRhYmxlX18gPSBfZGVyZXFfKFwidXRpbHMvZ2hvc3RUYWJsZVwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfdXRpbHNfNDdfZ2hvc3RUYWJsZV9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3V0aWxzXzQ3X2dob3N0VGFibGVfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3V0aWxzXzQ3X2dob3N0VGFibGVfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfdXRpbHNfNDdfZ2hvc3RUYWJsZV9ffSkuR2hvc3RUYWJsZTtcbnZhciAkX181ID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gPSBfZGVyZXFfKFwiaGVscGVycy9vYmplY3RcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X199KSxcbiAgICBpc09iamVjdCA9ICRfXzUuaXNPYmplY3QsXG4gICAgb2JqZWN0RWFjaCA9ICRfXzUub2JqZWN0RWFjaDtcbnZhciAkX182ID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gPSBfZGVyZXFfKFwiaGVscGVycy9udW1iZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX199KSxcbiAgICB2YWx1ZUFjY29yZGluZ1BlcmNlbnQgPSAkX182LnZhbHVlQWNjb3JkaW5nUGVyY2VudCxcbiAgICByYW5nZUVhY2ggPSAkX182LnJhbmdlRWFjaDtcbnZhciByZWdpc3RlclBsdWdpbiA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gPSBfZGVyZXFfKFwicGx1Z2luc1wiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19ffSkucmVnaXN0ZXJQbHVnaW47XG52YXIgU2FtcGxlc0dlbmVyYXRvciA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N191dGlsc180N19zYW1wbGVzR2VuZXJhdG9yX18gPSBfZGVyZXFfKFwidXRpbHMvc2FtcGxlc0dlbmVyYXRvclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfdXRpbHNfNDdfc2FtcGxlc0dlbmVyYXRvcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3V0aWxzXzQ3X3NhbXBsZXNHZW5lcmF0b3JfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3V0aWxzXzQ3X3NhbXBsZXNHZW5lcmF0b3JfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfdXRpbHNfNDdfc2FtcGxlc0dlbmVyYXRvcl9ffSkuU2FtcGxlc0dlbmVyYXRvcjtcbnZhciBpc1BlcmNlbnRWYWx1ZSA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3N0cmluZ19fID0gX2RlcmVxXyhcImhlbHBlcnMvc3RyaW5nXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3N0cmluZ19fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfc3RyaW5nX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3N0cmluZ19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3N0cmluZ19ffSkuaXNQZXJjZW50VmFsdWU7XG52YXIgV2Fsa29udGFibGVWaWV3cG9ydENvbHVtbnNDYWxjdWxhdG9yID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jYWxjdWxhdG9yXzQ3X3ZpZXdwb3J0Q29sdW1uc19fID0gX2RlcmVxXyhcIjNyZHBhcnR5L3dhbGtvbnRhYmxlL3NyYy9jYWxjdWxhdG9yL3ZpZXdwb3J0Q29sdW1uc1wiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NhbGN1bGF0b3JfNDdfdmlld3BvcnRDb2x1bW5zX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NhbGN1bGF0b3JfNDdfdmlld3BvcnRDb2x1bW5zX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2FsY3VsYXRvcl80N192aWV3cG9ydENvbHVtbnNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NhbGN1bGF0b3JfNDdfdmlld3BvcnRDb2x1bW5zX199KS5XYWxrb250YWJsZVZpZXdwb3J0Q29sdW1uc0NhbGN1bGF0b3I7XG52YXIgcHJpdmF0ZVBvb2wgPSBuZXcgV2Vha01hcCgpO1xudmFyIEF1dG9Db2x1bW5TaXplID0gZnVuY3Rpb24gQXV0b0NvbHVtblNpemUoaG90SW5zdGFuY2UpIHtcbiAgdmFyICRfXzExID0gdGhpcztcbiAgJHRyYWNldXJSdW50aW1lLnN1cGVyQ29uc3RydWN0b3IoJEF1dG9Db2x1bW5TaXplKS5jYWxsKHRoaXMsIGhvdEluc3RhbmNlKTtcbiAgcHJpdmF0ZVBvb2wuc2V0KHRoaXMsIHtjYWNoZWRDb2x1bW5IZWFkZXJzOiBbXX0pO1xuICB0aGlzLndpZHRocyA9IFtdO1xuICB0aGlzLmdob3N0VGFibGUgPSBuZXcgR2hvc3RUYWJsZSh0aGlzLmhvdCk7XG4gIHRoaXMuc2FtcGxlc0dlbmVyYXRvciA9IG5ldyBTYW1wbGVzR2VuZXJhdG9yKChmdW5jdGlvbihyb3csIGNvbCkge1xuICAgIHJldHVybiAkX18xMS5ob3QuZ2V0RGF0YUF0Q2VsbChyb3csIGNvbCk7XG4gIH0pKTtcbiAgdGhpcy5maXJzdENhbGN1bGF0aW9uID0gdHJ1ZTtcbiAgdGhpcy5pblByb2dyZXNzID0gZmFsc2U7XG4gIHRoaXMuYWRkSG9vaygnYmVmb3JlQ29sdW1uUmVzaXplJywgKGZ1bmN0aW9uKGNvbCwgc2l6ZSwgaXNEYmxDbGljaykge1xuICAgIHJldHVybiAkX18xMS5vbkJlZm9yZUNvbHVtblJlc2l6ZShjb2wsIHNpemUsIGlzRGJsQ2xpY2spO1xuICB9KSk7XG59O1xudmFyICRBdXRvQ29sdW1uU2l6ZSA9IEF1dG9Db2x1bW5TaXplO1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoQXV0b0NvbHVtblNpemUsIHtcbiAgaXNFbmFibGVkOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5ob3QuZ2V0U2V0dGluZ3MoKS5hdXRvQ29sdW1uU2l6ZSAhPT0gZmFsc2UgJiYgIXRoaXMuaG90LmdldFNldHRpbmdzKCkuY29sV2lkdGhzO1xuICB9LFxuICBlbmFibGVQbHVnaW46IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX18xMSA9IHRoaXM7XG4gICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgc2V0dGluZyA9IHRoaXMuaG90LmdldFNldHRpbmdzKCkuYXV0b0NvbHVtblNpemU7XG4gICAgaWYgKHNldHRpbmcgJiYgc2V0dGluZy51c2VIZWFkZXJzICE9IG51bGwpIHtcbiAgICAgIHRoaXMuZ2hvc3RUYWJsZS5zZXRTZXR0aW5nKCd1c2VIZWFkZXJzJywgc2V0dGluZy51c2VIZWFkZXJzKTtcbiAgICB9XG4gICAgdGhpcy5hZGRIb29rKCdhZnRlckxvYWREYXRhJywgKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICRfXzExLm9uQWZ0ZXJMb2FkRGF0YSgpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ2JlZm9yZUNoYW5nZScsIChmdW5jdGlvbihjaGFuZ2VzKSB7XG4gICAgICByZXR1cm4gJF9fMTEub25CZWZvcmVDaGFuZ2UoY2hhbmdlcyk7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygnYmVmb3JlUmVuZGVyJywgKGZ1bmN0aW9uKGZvcmNlKSB7XG4gICAgICByZXR1cm4gJF9fMTEub25CZWZvcmVSZW5kZXIoZm9yY2UpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ21vZGlmeUNvbFdpZHRoJywgKGZ1bmN0aW9uKHdpZHRoLCBjb2wpIHtcbiAgICAgIHJldHVybiAkX18xMS5nZXRDb2x1bW5XaWR0aChjb2wsIHdpZHRoKTtcbiAgICB9KSk7XG4gICAgdGhpcy5hZGRIb29rKCdhZnRlckluaXQnLCAoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fMTEub25BZnRlckluaXQoKTtcbiAgICB9KSk7XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICRBdXRvQ29sdW1uU2l6ZS5wcm90b3R5cGUsIFwiZW5hYmxlUGx1Z2luXCIpLmNhbGwodGhpcyk7XG4gIH0sXG4gIHVwZGF0ZVBsdWdpbjogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNoYW5nZWRDb2x1bW5zID0gdGhpcy5maW5kQ29sdW1uc1doZXJlSGVhZGVyV2FzQ2hhbmdlZCgpO1xuICAgIGlmIChjaGFuZ2VkQ29sdW1ucy5sZW5ndGgpIHtcbiAgICAgIHRoaXMuY2xlYXJDYWNoZShjaGFuZ2VkQ29sdW1ucyk7XG4gICAgfVxuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkQXV0b0NvbHVtblNpemUucHJvdG90eXBlLCBcInVwZGF0ZVBsdWdpblwiKS5jYWxsKHRoaXMpO1xuICB9LFxuICBkaXNhYmxlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJEF1dG9Db2x1bW5TaXplLnByb3RvdHlwZSwgXCJkaXNhYmxlUGx1Z2luXCIpLmNhbGwodGhpcyk7XG4gIH0sXG4gIGNhbGN1bGF0ZUNvbHVtbnNXaWR0aDogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNvbFJhbmdlID0gYXJndW1lbnRzWzBdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1swXSA6IHtcbiAgICAgIGZyb206IDAsXG4gICAgICB0bzogdGhpcy5ob3QuY291bnRDb2xzKCkgLSAxXG4gICAgfTtcbiAgICB2YXIgcm93UmFuZ2UgPSBhcmd1bWVudHNbMV0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzFdIDoge1xuICAgICAgZnJvbTogMCxcbiAgICAgIHRvOiB0aGlzLmhvdC5jb3VudFJvd3MoKSAtIDFcbiAgICB9O1xuICAgIHZhciBmb3JjZSA9IGFyZ3VtZW50c1syXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMl0gOiBmYWxzZTtcbiAgICB2YXIgJF9fMTEgPSB0aGlzO1xuICAgIGlmICh0eXBlb2YgY29sUmFuZ2UgPT09ICdudW1iZXInKSB7XG4gICAgICBjb2xSYW5nZSA9IHtcbiAgICAgICAgZnJvbTogY29sUmFuZ2UsXG4gICAgICAgIHRvOiBjb2xSYW5nZVxuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiByb3dSYW5nZSA9PT0gJ251bWJlcicpIHtcbiAgICAgIHJvd1JhbmdlID0ge1xuICAgICAgICBmcm9tOiByb3dSYW5nZSxcbiAgICAgICAgdG86IHJvd1JhbmdlXG4gICAgICB9O1xuICAgIH1cbiAgICByYW5nZUVhY2goY29sUmFuZ2UuZnJvbSwgY29sUmFuZ2UudG8sIChmdW5jdGlvbihjb2wpIHtcbiAgICAgIGlmIChmb3JjZSB8fCAoJF9fMTEud2lkdGhzW2NvbF0gPT09IHZvaWQgMCAmJiAhJF9fMTEuaG90Ll9nZXRDb2xXaWR0aEZyb21TZXR0aW5ncyhjb2wpKSkge1xuICAgICAgICB2YXIgc2FtcGxlcyA9ICRfXzExLnNhbXBsZXNHZW5lcmF0b3IuZ2VuZXJhdGVDb2x1bW5TYW1wbGVzKGNvbCwgcm93UmFuZ2UpO1xuICAgICAgICBzYW1wbGVzLmZvckVhY2goKGZ1bmN0aW9uKHNhbXBsZSwgY29sKSB7XG4gICAgICAgICAgcmV0dXJuICRfXzExLmdob3N0VGFibGUuYWRkQ29sdW1uKGNvbCwgc2FtcGxlKTtcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgIH0pKTtcbiAgICBpZiAodGhpcy5naG9zdFRhYmxlLmNvbHVtbnMubGVuZ3RoKSB7XG4gICAgICB0aGlzLmdob3N0VGFibGUuZ2V0V2lkdGhzKChmdW5jdGlvbihjb2wsIHdpZHRoKSB7XG4gICAgICAgIHJldHVybiAkX18xMS53aWR0aHNbY29sXSA9IHdpZHRoO1xuICAgICAgfSkpO1xuICAgICAgdGhpcy5naG9zdFRhYmxlLmNsZWFuKCk7XG4gICAgfVxuICB9LFxuICBjYWxjdWxhdGVBbGxDb2x1bW5zV2lkdGg6IGZ1bmN0aW9uKCkge1xuICAgIHZhciByb3dSYW5nZSA9IGFyZ3VtZW50c1swXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMF0gOiB7XG4gICAgICBmcm9tOiAwLFxuICAgICAgdG86IHRoaXMuaG90LmNvdW50Um93cygpIC0gMVxuICAgIH07XG4gICAgdmFyICRfXzExID0gdGhpcztcbiAgICB2YXIgY3VycmVudCA9IDA7XG4gICAgdmFyIGxlbmd0aCA9IHRoaXMuaG90LmNvdW50Q29scygpIC0gMTtcbiAgICB2YXIgdGltZXIgPSBudWxsO1xuICAgIHRoaXMuaW5Qcm9ncmVzcyA9IHRydWU7XG4gICAgdmFyIGxvb3AgPSAoZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoISRfXzExLmhvdCkge1xuICAgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZSh0aW1lcik7XG4gICAgICAgICRfXzExLmluUHJvZ3Jlc3MgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgJF9fMTEuY2FsY3VsYXRlQ29sdW1uc1dpZHRoKHtcbiAgICAgICAgZnJvbTogY3VycmVudCxcbiAgICAgICAgdG86IE1hdGgubWluKGN1cnJlbnQgKyAkQXV0b0NvbHVtblNpemUuQ0FMQ1VMQVRJT05fU1RFUCwgbGVuZ3RoKVxuICAgICAgfSwgcm93UmFuZ2UpO1xuICAgICAgY3VycmVudCA9IGN1cnJlbnQgKyAkQXV0b0NvbHVtblNpemUuQ0FMQ1VMQVRJT05fU1RFUCArIDE7XG4gICAgICBpZiAoY3VycmVudCA8IGxlbmd0aCkge1xuICAgICAgICB0aW1lciA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRpbWVyKTtcbiAgICAgICAgJF9fMTEuaW5Qcm9ncmVzcyA9IGZhbHNlO1xuICAgICAgICAkX18xMS5ob3Qudmlldy53dC53dE92ZXJsYXlzLmFkanVzdEVsZW1lbnRzU2l6ZSh0cnVlKTtcbiAgICAgICAgaWYgKCRfXzExLmhvdC52aWV3Lnd0Lnd0T3ZlcmxheXMubGVmdE92ZXJsYXkubmVlZEZ1bGxSZW5kZXIpIHtcbiAgICAgICAgICAkX18xMS5ob3Qudmlldy53dC53dE92ZXJsYXlzLmxlZnRPdmVybGF5LmNsb25lLmRyYXcoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIGlmICh0aGlzLmZpcnN0Q2FsY3VsYXRpb24gJiYgdGhpcy5nZXRTeW5jQ2FsY3VsYXRpb25MaW1pdCgpKSB7XG4gICAgICB0aGlzLmNhbGN1bGF0ZUNvbHVtbnNXaWR0aCh7XG4gICAgICAgIGZyb206IDAsXG4gICAgICAgIHRvOiB0aGlzLmdldFN5bmNDYWxjdWxhdGlvbkxpbWl0KClcbiAgICAgIH0sIHJvd1JhbmdlKTtcbiAgICAgIHRoaXMuZmlyc3RDYWxjdWxhdGlvbiA9IGZhbHNlO1xuICAgICAgY3VycmVudCA9IHRoaXMuZ2V0U3luY0NhbGN1bGF0aW9uTGltaXQoKSArIDE7XG4gICAgfVxuICAgIGlmIChjdXJyZW50IDwgbGVuZ3RoKSB7XG4gICAgICBsb29wKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaW5Qcm9ncmVzcyA9IGZhbHNlO1xuICAgIH1cbiAgfSxcbiAgc2V0U2FtcGxpbmdPcHRpb25zOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2V0dGluZyA9IHRoaXMuaG90LmdldFNldHRpbmdzKCkuYXV0b0NvbHVtblNpemU7XG4gICAgdmFyIHNhbXBsaW5nUmF0aW8gPSBzZXR0aW5nICYmIHNldHRpbmcuaGFzT3duUHJvcGVydHkoJ3NhbXBsaW5nUmF0aW8nKSA/IHRoaXMuaG90LmdldFNldHRpbmdzKCkuYXV0b0NvbHVtblNpemUuc2FtcGxpbmdSYXRpbyA6IHZvaWQgMDtcbiAgICB2YXIgYWxsb3dTYW1wbGVEdXBsaWNhdGVzID0gc2V0dGluZyAmJiBzZXR0aW5nLmhhc093blByb3BlcnR5KCdhbGxvd1NhbXBsZUR1cGxpY2F0ZXMnKSA/IHRoaXMuaG90LmdldFNldHRpbmdzKCkuYXV0b0NvbHVtblNpemUuYWxsb3dTYW1wbGVEdXBsaWNhdGVzIDogdm9pZCAwO1xuICAgIGlmIChzYW1wbGluZ1JhdGlvICYmICFpc05hTihzYW1wbGluZ1JhdGlvKSkge1xuICAgICAgdGhpcy5zYW1wbGVzR2VuZXJhdG9yLnNldFNhbXBsZUNvdW50KHBhcnNlSW50KHNhbXBsaW5nUmF0aW8sIDEwKSk7XG4gICAgfVxuICAgIGlmIChhbGxvd1NhbXBsZUR1cGxpY2F0ZXMpIHtcbiAgICAgIHRoaXMuc2FtcGxlc0dlbmVyYXRvci5zZXRBbGxvd0R1cGxpY2F0ZXMoYWxsb3dTYW1wbGVEdXBsaWNhdGVzKTtcbiAgICB9XG4gIH0sXG4gIHJlY2FsY3VsYXRlQWxsQ29sdW1uc1dpZHRoOiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5ob3QudmlldyAmJiBpc1Zpc2libGUodGhpcy5ob3Qudmlldy53dC53dFRhYmxlLlRBQkxFKSkge1xuICAgICAgdGhpcy5jbGVhckNhY2hlKCk7XG4gICAgICB0aGlzLmNhbGN1bGF0ZUFsbENvbHVtbnNXaWR0aCgpO1xuICAgIH1cbiAgfSxcbiAgZ2V0U3luY0NhbGN1bGF0aW9uTGltaXQ6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBsaW1pdCA9ICRBdXRvQ29sdW1uU2l6ZS5TWU5DX0NBTENVTEFUSU9OX0xJTUlUO1xuICAgIHZhciBjb2xzTGltaXQgPSB0aGlzLmhvdC5jb3VudENvbHMoKSAtIDE7XG4gICAgaWYgKGlzT2JqZWN0KHRoaXMuaG90LmdldFNldHRpbmdzKCkuYXV0b0NvbHVtblNpemUpKSB7XG4gICAgICBsaW1pdCA9IHRoaXMuaG90LmdldFNldHRpbmdzKCkuYXV0b0NvbHVtblNpemUuc3luY0xpbWl0O1xuICAgICAgaWYgKGlzUGVyY2VudFZhbHVlKGxpbWl0KSkge1xuICAgICAgICBsaW1pdCA9IHZhbHVlQWNjb3JkaW5nUGVyY2VudChjb2xzTGltaXQsIGxpbWl0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxpbWl0ID0gbGltaXQgPj4gMDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIE1hdGgubWluKGxpbWl0LCBjb2xzTGltaXQpO1xuICB9LFxuICBnZXRDb2x1bW5XaWR0aDogZnVuY3Rpb24oY29sKSB7XG4gICAgdmFyIGRlZmF1bHRXaWR0aCA9IGFyZ3VtZW50c1sxXTtcbiAgICB2YXIga2VlcE1pbmltdW0gPSBhcmd1bWVudHNbMl0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzJdIDogdHJ1ZTtcbiAgICB2YXIgd2lkdGggPSBkZWZhdWx0V2lkdGg7XG4gICAgaWYgKHdpZHRoID09PSB2b2lkIDApIHtcbiAgICAgIHdpZHRoID0gdGhpcy53aWR0aHNbY29sXTtcbiAgICAgIGlmIChrZWVwTWluaW11bSAmJiB0eXBlb2Ygd2lkdGggPT09ICdudW1iZXInKSB7XG4gICAgICAgIHdpZHRoID0gTWF0aC5tYXgod2lkdGgsIFdhbGtvbnRhYmxlVmlld3BvcnRDb2x1bW5zQ2FsY3VsYXRvci5ERUZBVUxUX1dJRFRIKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHdpZHRoO1xuICB9LFxuICBnZXRGaXJzdFZpc2libGVDb2x1bW46IGZ1bmN0aW9uKCkge1xuICAgIHZhciB3b3QgPSB0aGlzLmhvdC52aWV3Lnd0O1xuICAgIGlmICh3b3Qud3RWaWV3cG9ydC5jb2x1bW5zVmlzaWJsZUNhbGN1bGF0b3IpIHtcbiAgICAgIHJldHVybiB3b3Qud3RUYWJsZS5nZXRGaXJzdFZpc2libGVDb2x1bW4oKTtcbiAgICB9XG4gICAgaWYgKHdvdC53dFZpZXdwb3J0LmNvbHVtbnNSZW5kZXJDYWxjdWxhdG9yKSB7XG4gICAgICByZXR1cm4gd290Lnd0VGFibGUuZ2V0Rmlyc3RSZW5kZXJlZENvbHVtbigpO1xuICAgIH1cbiAgICByZXR1cm4gLTE7XG4gIH0sXG4gIGdldExhc3RWaXNpYmxlQ29sdW1uOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgd290ID0gdGhpcy5ob3Qudmlldy53dDtcbiAgICBpZiAod290Lnd0Vmlld3BvcnQuY29sdW1uc1Zpc2libGVDYWxjdWxhdG9yKSB7XG4gICAgICByZXR1cm4gd290Lnd0VGFibGUuZ2V0TGFzdFZpc2libGVDb2x1bW4oKTtcbiAgICB9XG4gICAgaWYgKHdvdC53dFZpZXdwb3J0LmNvbHVtbnNSZW5kZXJDYWxjdWxhdG9yKSB7XG4gICAgICByZXR1cm4gd290Lnd0VGFibGUuZ2V0TGFzdFJlbmRlcmVkQ29sdW1uKCk7XG4gICAgfVxuICAgIHJldHVybiAtMTtcbiAgfSxcbiAgZmluZENvbHVtbnNXaGVyZUhlYWRlcldhc0NoYW5nZWQ6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBjb2x1bW5IZWFkZXJzID0gdGhpcy5ob3QuZ2V0Q29sSGVhZGVyKCk7XG4gICAgdmFyIGNhY2hlZENvbHVtbkhlYWRlcnMgPSBwcml2YXRlUG9vbC5nZXQodGhpcykuY2FjaGVkQ29sdW1uSGVhZGVycztcbiAgICB2YXIgY2hhbmdlZENvbHVtbnMgPSBhcnJheVJlZHVjZShjb2x1bW5IZWFkZXJzLCAoZnVuY3Rpb24oYWNjLCBjb2x1bW5UaXRsZSwgcGh5c2ljYWxDb2x1bW4pIHtcbiAgICAgIHZhciBjYWNoZWRDb2x1bW5zTGVuZ3RoID0gY2FjaGVkQ29sdW1uSGVhZGVycy5sZW5ndGg7XG4gICAgICBpZiAoY2FjaGVkQ29sdW1uc0xlbmd0aCAtIDEgPCBwaHlzaWNhbENvbHVtbiB8fCBjYWNoZWRDb2x1bW5IZWFkZXJzW3BoeXNpY2FsQ29sdW1uXSAhPT0gY29sdW1uVGl0bGUpIHtcbiAgICAgICAgYWNjLnB1c2gocGh5c2ljYWxDb2x1bW4pO1xuICAgICAgfVxuICAgICAgaWYgKGNhY2hlZENvbHVtbnNMZW5ndGggLSAxIDwgcGh5c2ljYWxDb2x1bW4pIHtcbiAgICAgICAgY2FjaGVkQ29sdW1uSGVhZGVycy5wdXNoKGNvbHVtblRpdGxlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNhY2hlZENvbHVtbkhlYWRlcnNbcGh5c2ljYWxDb2x1bW5dID0gY29sdW1uVGl0bGU7XG4gICAgICB9XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH0pLCBbXSk7XG4gICAgcmV0dXJuIGNoYW5nZWRDb2x1bW5zO1xuICB9LFxuICBjbGVhckNhY2hlOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgY29sdW1ucyA9IGFyZ3VtZW50c1swXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMF0gOiBbXTtcbiAgICB2YXIgJF9fMTEgPSB0aGlzO1xuICAgIGlmIChjb2x1bW5zLmxlbmd0aCkge1xuICAgICAgYXJyYXlFYWNoKGNvbHVtbnMsIChmdW5jdGlvbihwaHlzaWNhbEluZGV4KSB7XG4gICAgICAgIHJldHVybiAkX18xMS53aWR0aHNbcGh5c2ljYWxJbmRleF0gPSB2b2lkIDA7XG4gICAgICB9KSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMud2lkdGhzLmxlbmd0aCA9IDA7XG4gICAgfVxuICB9LFxuICBpc05lZWRSZWNhbGN1bGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGFycmF5RmlsdGVyKHRoaXMud2lkdGhzLCAoZnVuY3Rpb24oaXRlbSkge1xuICAgICAgcmV0dXJuIChpdGVtID09PSB2b2lkIDApO1xuICAgIH0pKS5sZW5ndGggPyB0cnVlIDogZmFsc2U7XG4gIH0sXG4gIG9uQmVmb3JlUmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgZm9yY2UgPSB0aGlzLmhvdC5yZW5kZXJDYWxsO1xuICAgIHZhciByb3dzQ291bnQgPSB0aGlzLmhvdC5jb3VudFJvd3MoKTtcbiAgICBpZiAoIXJvd3NDb3VudCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmNhbGN1bGF0ZUNvbHVtbnNXaWR0aCh7XG4gICAgICBmcm9tOiB0aGlzLmdldEZpcnN0VmlzaWJsZUNvbHVtbigpLFxuICAgICAgdG86IHRoaXMuZ2V0TGFzdFZpc2libGVDb2x1bW4oKVxuICAgIH0sIHZvaWQgMCwgZm9yY2UpO1xuICAgIGlmICh0aGlzLmlzTmVlZFJlY2FsY3VsYXRlKCkgJiYgIXRoaXMuaW5Qcm9ncmVzcykge1xuICAgICAgdGhpcy5jYWxjdWxhdGVBbGxDb2x1bW5zV2lkdGgoKTtcbiAgICB9XG4gIH0sXG4gIG9uQWZ0ZXJMb2FkRGF0YTogZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzExID0gdGhpcztcbiAgICBpZiAodGhpcy5ob3Qudmlldykge1xuICAgICAgdGhpcy5yZWNhbGN1bGF0ZUFsbENvbHVtbnNXaWR0aCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZXRUaW1lb3V0KChmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCRfXzExLmhvdCkge1xuICAgICAgICAgICRfXzExLnJlY2FsY3VsYXRlQWxsQ29sdW1uc1dpZHRoKCk7XG4gICAgICAgIH1cbiAgICAgIH0pLCAwKTtcbiAgICB9XG4gIH0sXG4gIG9uQmVmb3JlQ2hhbmdlOiBmdW5jdGlvbihjaGFuZ2VzKSB7XG4gICAgdmFyICRfXzExID0gdGhpcztcbiAgICB2YXIgY2hhbmdlZENvbHVtbnMgPSBhcnJheU1hcChjaGFuZ2VzLCAoZnVuY3Rpb24oJF9fMTMpIHtcbiAgICAgIHZhciAkX18xNCA9ICRfXzEzLFxuICAgICAgICAgIHJvdyA9ICRfXzE0WzBdLFxuICAgICAgICAgIGNvbHVtbiA9ICRfXzE0WzFdO1xuICAgICAgcmV0dXJuICRfXzExLmhvdC5wcm9wVG9Db2woY29sdW1uKTtcbiAgICB9KSk7XG4gICAgdGhpcy5jbGVhckNhY2hlKGNoYW5nZWRDb2x1bW5zKTtcbiAgfSxcbiAgb25CZWZvcmVDb2x1bW5SZXNpemU6IGZ1bmN0aW9uKGNvbCwgc2l6ZSwgaXNEYmxDbGljaykge1xuICAgIGlmIChpc0RibENsaWNrKSB7XG4gICAgICB0aGlzLmNhbGN1bGF0ZUNvbHVtbnNXaWR0aChjb2wsIHZvaWQgMCwgdHJ1ZSk7XG4gICAgICBzaXplID0gdGhpcy5nZXRDb2x1bW5XaWR0aChjb2wsIHZvaWQgMCwgZmFsc2UpO1xuICAgIH1cbiAgICByZXR1cm4gc2l6ZTtcbiAgfSxcbiAgb25BZnRlckluaXQ6IGZ1bmN0aW9uKCkge1xuICAgIHByaXZhdGVQb29sLmdldCh0aGlzKS5jYWNoZWRDb2x1bW5IZWFkZXJzID0gdGhpcy5ob3QuZ2V0Q29sSGVhZGVyKCk7XG4gIH0sXG4gIGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuZ2hvc3RUYWJsZS5jbGVhbigpO1xuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkQXV0b0NvbHVtblNpemUucHJvdG90eXBlLCBcImRlc3Ryb3lcIikuY2FsbCh0aGlzKTtcbiAgfVxufSwge1xuICBnZXQgQ0FMQ1VMQVRJT05fU1RFUCgpIHtcbiAgICByZXR1cm4gNTA7XG4gIH0sXG4gIGdldCBTWU5DX0NBTENVTEFUSU9OX0xJTUlUKCkge1xuICAgIHJldHVybiA1MDtcbiAgfVxufSwgQmFzZVBsdWdpbik7XG47XG5yZWdpc3RlclBsdWdpbignYXV0b0NvbHVtblNpemUnLCBBdXRvQ29sdW1uU2l6ZSk7XG5cbi8vIyBcbn0se1wiM3JkcGFydHkvd2Fsa29udGFibGUvc3JjL2NhbGN1bGF0b3Ivdmlld3BvcnRDb2x1bW5zXCI6NCxcIl9iYXNlXCI6NjIsXCJoZWxwZXJzL2FycmF5XCI6NDMsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJoZWxwZXJzL2ZlYXR1cmVcIjo0OSxcImhlbHBlcnMvbnVtYmVyXCI6NTIsXCJoZWxwZXJzL29iamVjdFwiOjUzLFwiaGVscGVycy9zdHJpbmdcIjo1NSxcInBsdWdpbnNcIjo2MSxcInV0aWxzL2dob3N0VGFibGVcIjoxMjgsXCJ1dGlscy9zYW1wbGVzR2VuZXJhdG9yXCI6MTMxfV0sNjQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIEF1dG9Sb3dTaXplOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBBdXRvUm93U2l6ZTtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19mZWF0dXJlX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3V0aWxzXzQ3X2dob3N0VGFibGVfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3V0aWxzXzQ3X3NhbXBsZXNHZW5lcmF0b3JfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3N0cmluZ19fO1xudmFyIEJhc2VQbHVnaW4gPSAoJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfXyA9IF9kZXJlcV8oXCJfYmFzZVwiKSwgJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfXyAmJiAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfX30pLmRlZmF1bHQ7XG52YXIgJF9fMSA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gPSBfZGVyZXFfKFwiaGVscGVycy9hcnJheVwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9ffSksXG4gICAgYXJyYXlFYWNoID0gJF9fMS5hcnJheUVhY2gsXG4gICAgYXJyYXlGaWx0ZXIgPSAkX18xLmFycmF5RmlsdGVyO1xudmFyICRfXzIgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19mZWF0dXJlX18gPSBfZGVyZXFfKFwiaGVscGVycy9mZWF0dXJlXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2ZlYXR1cmVfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2ZlYXR1cmVfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZmVhdHVyZV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2ZlYXR1cmVfX30pLFxuICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lID0gJF9fMi5jYW5jZWxBbmltYXRpb25GcmFtZSxcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSAkX18yLnJlcXVlc3RBbmltYXRpb25GcmFtZTtcbnZhciBpc1Zpc2libGUgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLmlzVmlzaWJsZTtcbnZhciBHaG9zdFRhYmxlID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3V0aWxzXzQ3X2dob3N0VGFibGVfXyA9IF9kZXJlcV8oXCJ1dGlscy9naG9zdFRhYmxlXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N191dGlsc180N19naG9zdFRhYmxlX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfdXRpbHNfNDdfZ2hvc3RUYWJsZV9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfdXRpbHNfNDdfZ2hvc3RUYWJsZV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N191dGlsc180N19naG9zdFRhYmxlX199KS5HaG9zdFRhYmxlO1xudmFyICRfXzUgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL29iamVjdFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfX30pLFxuICAgIGlzT2JqZWN0ID0gJF9fNS5pc09iamVjdCxcbiAgICBvYmplY3RFYWNoID0gJF9fNS5vYmplY3RFYWNoO1xudmFyICRfXzYgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL251bWJlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X251bWJlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfX30pLFxuICAgIHZhbHVlQWNjb3JkaW5nUGVyY2VudCA9ICRfXzYudmFsdWVBY2NvcmRpbmdQZXJjZW50LFxuICAgIHJhbmdlRWFjaCA9ICRfXzYucmFuZ2VFYWNoO1xudmFyIHJlZ2lzdGVyUGx1Z2luID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyA9IF9kZXJlcV8oXCJwbHVnaW5zXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX199KS5yZWdpc3RlclBsdWdpbjtcbnZhciBTYW1wbGVzR2VuZXJhdG9yID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3V0aWxzXzQ3X3NhbXBsZXNHZW5lcmF0b3JfXyA9IF9kZXJlcV8oXCJ1dGlscy9zYW1wbGVzR2VuZXJhdG9yXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N191dGlsc180N19zYW1wbGVzR2VuZXJhdG9yX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfdXRpbHNfNDdfc2FtcGxlc0dlbmVyYXRvcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfdXRpbHNfNDdfc2FtcGxlc0dlbmVyYXRvcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N191dGlsc180N19zYW1wbGVzR2VuZXJhdG9yX199KS5TYW1wbGVzR2VuZXJhdG9yO1xudmFyIGlzUGVyY2VudFZhbHVlID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfc3RyaW5nX18gPSBfZGVyZXFfKFwiaGVscGVycy9zdHJpbmdcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfc3RyaW5nX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19zdHJpbmdfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfc3RyaW5nX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfc3RyaW5nX199KS5pc1BlcmNlbnRWYWx1ZTtcbnZhciBBdXRvUm93U2l6ZSA9IGZ1bmN0aW9uIEF1dG9Sb3dTaXplKGhvdEluc3RhbmNlKSB7XG4gIHZhciAkX18xMCA9IHRoaXM7XG4gICR0cmFjZXVyUnVudGltZS5zdXBlckNvbnN0cnVjdG9yKCRBdXRvUm93U2l6ZSkuY2FsbCh0aGlzLCBob3RJbnN0YW5jZSk7XG4gIHRoaXMuaGVpZ2h0cyA9IFtdO1xuICB0aGlzLmdob3N0VGFibGUgPSBuZXcgR2hvc3RUYWJsZSh0aGlzLmhvdCk7XG4gIHRoaXMuc2FtcGxlc0dlbmVyYXRvciA9IG5ldyBTYW1wbGVzR2VuZXJhdG9yKChmdW5jdGlvbihyb3csIGNvbCkge1xuICAgIGlmIChyb3cgPj0gMCkge1xuICAgICAgcmV0dXJuICRfXzEwLmhvdC5nZXREYXRhQXRDZWxsKHJvdywgY29sKTtcbiAgICB9IGVsc2UgaWYgKHJvdyA9PT0gLTEpIHtcbiAgICAgIHJldHVybiAkX18xMC5ob3QuZ2V0Q29sSGVhZGVyKGNvbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfSkpO1xuICB0aGlzLmZpcnN0Q2FsY3VsYXRpb24gPSB0cnVlO1xuICB0aGlzLmluUHJvZ3Jlc3MgPSBmYWxzZTtcbiAgdGhpcy5hZGRIb29rKCdiZWZvcmVSb3dSZXNpemUnLCAoZnVuY3Rpb24ocm93LCBzaXplLCBpc0RibENsaWNrKSB7XG4gICAgcmV0dXJuICRfXzEwLm9uQmVmb3JlUm93UmVzaXplKHJvdywgc2l6ZSwgaXNEYmxDbGljayk7XG4gIH0pKTtcbn07XG52YXIgJEF1dG9Sb3dTaXplID0gQXV0b1Jvd1NpemU7XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShBdXRvUm93U2l6ZSwge1xuICBpc0VuYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmhvdC5nZXRTZXR0aW5ncygpLmF1dG9Sb3dTaXplID09PSB0cnVlIHx8IGlzT2JqZWN0KHRoaXMuaG90LmdldFNldHRpbmdzKCkuYXV0b1Jvd1NpemUpO1xuICB9LFxuICBlbmFibGVQbHVnaW46IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX18xMCA9IHRoaXM7XG4gICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnNldFNhbXBsaW5nT3B0aW9ucygpO1xuICAgIHRoaXMuYWRkSG9vaygnYWZ0ZXJMb2FkRGF0YScsIChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX18xMC5vbkFmdGVyTG9hZERhdGEoKTtcbiAgICB9KSk7XG4gICAgdGhpcy5hZGRIb29rKCdiZWZvcmVDaGFuZ2UnLCAoZnVuY3Rpb24oY2hhbmdlcykge1xuICAgICAgcmV0dXJuICRfXzEwLm9uQmVmb3JlQ2hhbmdlKGNoYW5nZXMpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ2JlZm9yZUNvbHVtbk1vdmUnLCAoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fMTAucmVjYWxjdWxhdGVBbGxSb3dzSGVpZ2h0KCk7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygnYmVmb3JlQ29sdW1uUmVzaXplJywgKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICRfXzEwLnJlY2FsY3VsYXRlQWxsUm93c0hlaWdodCgpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ2JlZm9yZUNvbHVtblNvcnQnLCAoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fMTAuY2xlYXJDYWNoZSgpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ2JlZm9yZVJlbmRlcicsIChmdW5jdGlvbihmb3JjZSkge1xuICAgICAgcmV0dXJuICRfXzEwLm9uQmVmb3JlUmVuZGVyKGZvcmNlKTtcbiAgICB9KSk7XG4gICAgdGhpcy5hZGRIb29rKCdiZWZvcmVSb3dNb3ZlJywgKGZ1bmN0aW9uKHJvd1N0YXJ0LCByb3dFbmQpIHtcbiAgICAgIHJldHVybiAkX18xMC5vbkJlZm9yZVJvd01vdmUocm93U3RhcnQsIHJvd0VuZCk7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygnbW9kaWZ5Um93SGVpZ2h0JywgKGZ1bmN0aW9uKGhlaWdodCwgcm93KSB7XG4gICAgICByZXR1cm4gJF9fMTAuZ2V0Um93SGVpZ2h0KHJvdywgaGVpZ2h0KTtcbiAgICB9KSk7XG4gICAgdGhpcy5hZGRIb29rKCdtb2RpZnlDb2x1bW5IZWFkZXJIZWlnaHQnLCAoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fMTAuZ2V0Q29sdW1uSGVhZGVySGVpZ2h0KCk7XG4gICAgfSkpO1xuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkQXV0b1Jvd1NpemUucHJvdG90eXBlLCBcImVuYWJsZVBsdWdpblwiKS5jYWxsKHRoaXMpO1xuICB9LFxuICBkaXNhYmxlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJEF1dG9Sb3dTaXplLnByb3RvdHlwZSwgXCJkaXNhYmxlUGx1Z2luXCIpLmNhbGwodGhpcyk7XG4gIH0sXG4gIGNhbGN1bGF0ZVJvd3NIZWlnaHQ6IGZ1bmN0aW9uKCkge1xuICAgIHZhciByb3dSYW5nZSA9IGFyZ3VtZW50c1swXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMF0gOiB7XG4gICAgICBmcm9tOiAwLFxuICAgICAgdG86IHRoaXMuaG90LmNvdW50Um93cygpIC0gMVxuICAgIH07XG4gICAgdmFyIGNvbFJhbmdlID0gYXJndW1lbnRzWzFdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1sxXSA6IHtcbiAgICAgIGZyb206IDAsXG4gICAgICB0bzogdGhpcy5ob3QuY291bnRDb2xzKCkgLSAxXG4gICAgfTtcbiAgICB2YXIgZm9yY2UgPSBhcmd1bWVudHNbMl0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzJdIDogZmFsc2U7XG4gICAgdmFyICRfXzEwID0gdGhpcztcbiAgICBpZiAodHlwZW9mIHJvd1JhbmdlID09PSAnbnVtYmVyJykge1xuICAgICAgcm93UmFuZ2UgPSB7XG4gICAgICAgIGZyb206IHJvd1JhbmdlLFxuICAgICAgICB0bzogcm93UmFuZ2VcbiAgICAgIH07XG4gICAgfVxuICAgIGlmICh0eXBlb2YgY29sUmFuZ2UgPT09ICdudW1iZXInKSB7XG4gICAgICBjb2xSYW5nZSA9IHtcbiAgICAgICAgZnJvbTogY29sUmFuZ2UsXG4gICAgICAgIHRvOiBjb2xSYW5nZVxuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKHRoaXMuaG90LmdldENvbEhlYWRlcigwKSAhPT0gbnVsbCkge1xuICAgICAgdmFyIHNhbXBsZXMgPSB0aGlzLnNhbXBsZXNHZW5lcmF0b3IuZ2VuZXJhdGVSb3dTYW1wbGVzKC0xLCBjb2xSYW5nZSk7XG4gICAgICB0aGlzLmdob3N0VGFibGUuYWRkQ29sdW1uSGVhZGVyc1JvdyhzYW1wbGVzLmdldCgtMSkpO1xuICAgIH1cbiAgICByYW5nZUVhY2gocm93UmFuZ2UuZnJvbSwgcm93UmFuZ2UudG8sIChmdW5jdGlvbihyb3cpIHtcbiAgICAgIGlmIChmb3JjZSB8fCAkX18xMC5oZWlnaHRzW3Jvd10gPT09IHZvaWQgMCkge1xuICAgICAgICB2YXIgc2FtcGxlcyA9ICRfXzEwLnNhbXBsZXNHZW5lcmF0b3IuZ2VuZXJhdGVSb3dTYW1wbGVzKHJvdywgY29sUmFuZ2UpO1xuICAgICAgICBzYW1wbGVzLmZvckVhY2goKGZ1bmN0aW9uKHNhbXBsZSwgcm93KSB7XG4gICAgICAgICAgcmV0dXJuICRfXzEwLmdob3N0VGFibGUuYWRkUm93KHJvdywgc2FtcGxlKTtcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgIH0pKTtcbiAgICBpZiAodGhpcy5naG9zdFRhYmxlLnJvd3MubGVuZ3RoKSB7XG4gICAgICB0aGlzLmdob3N0VGFibGUuZ2V0SGVpZ2h0cygoZnVuY3Rpb24ocm93LCBoZWlnaHQpIHtcbiAgICAgICAgcmV0dXJuICRfXzEwLmhlaWdodHNbcm93XSA9IGhlaWdodDtcbiAgICAgIH0pKTtcbiAgICAgIHRoaXMuZ2hvc3RUYWJsZS5jbGVhbigpO1xuICAgIH1cbiAgfSxcbiAgY2FsY3VsYXRlQWxsUm93c0hlaWdodDogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNvbFJhbmdlID0gYXJndW1lbnRzWzBdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1swXSA6IHtcbiAgICAgIGZyb206IDAsXG4gICAgICB0bzogdGhpcy5ob3QuY291bnRDb2xzKCkgLSAxXG4gICAgfTtcbiAgICB2YXIgJF9fMTAgPSB0aGlzO1xuICAgIHZhciBjdXJyZW50ID0gMDtcbiAgICB2YXIgbGVuZ3RoID0gdGhpcy5ob3QuY291bnRSb3dzKCkgLSAxO1xuICAgIHZhciB0aW1lciA9IG51bGw7XG4gICAgdGhpcy5pblByb2dyZXNzID0gdHJ1ZTtcbiAgICB2YXIgbG9vcCA9IChmdW5jdGlvbigpIHtcbiAgICAgIGlmICghJF9fMTAuaG90KSB7XG4gICAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRpbWVyKTtcbiAgICAgICAgJF9fMTAuaW5Qcm9ncmVzcyA9IGZhbHNlO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAkX18xMC5jYWxjdWxhdGVSb3dzSGVpZ2h0KHtcbiAgICAgICAgZnJvbTogY3VycmVudCxcbiAgICAgICAgdG86IE1hdGgubWluKGN1cnJlbnQgKyAkQXV0b1Jvd1NpemUuQ0FMQ1VMQVRJT05fU1RFUCwgbGVuZ3RoKVxuICAgICAgfSwgY29sUmFuZ2UpO1xuICAgICAgY3VycmVudCA9IGN1cnJlbnQgKyAkQXV0b1Jvd1NpemUuQ0FMQ1VMQVRJT05fU1RFUCArIDE7XG4gICAgICBpZiAoY3VycmVudCA8IGxlbmd0aCkge1xuICAgICAgICB0aW1lciA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRpbWVyKTtcbiAgICAgICAgJF9fMTAuaW5Qcm9ncmVzcyA9IGZhbHNlO1xuICAgICAgICAkX18xMC5ob3Qudmlldy53dC53dE92ZXJsYXlzLmFkanVzdEVsZW1lbnRzU2l6ZSh0cnVlKTtcbiAgICAgICAgaWYgKCRfXzEwLmhvdC52aWV3Lnd0Lnd0T3ZlcmxheXMubGVmdE92ZXJsYXkubmVlZEZ1bGxSZW5kZXIpIHtcbiAgICAgICAgICAkX18xMC5ob3Qudmlldy53dC53dE92ZXJsYXlzLmxlZnRPdmVybGF5LmNsb25lLmRyYXcoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIGlmICh0aGlzLmZpcnN0Q2FsY3VsYXRpb24gJiYgdGhpcy5nZXRTeW5jQ2FsY3VsYXRpb25MaW1pdCgpKSB7XG4gICAgICB0aGlzLmNhbGN1bGF0ZVJvd3NIZWlnaHQoe1xuICAgICAgICBmcm9tOiAwLFxuICAgICAgICB0bzogdGhpcy5nZXRTeW5jQ2FsY3VsYXRpb25MaW1pdCgpXG4gICAgICB9LCBjb2xSYW5nZSk7XG4gICAgICB0aGlzLmZpcnN0Q2FsY3VsYXRpb24gPSBmYWxzZTtcbiAgICAgIGN1cnJlbnQgPSB0aGlzLmdldFN5bmNDYWxjdWxhdGlvbkxpbWl0KCkgKyAxO1xuICAgIH1cbiAgICBpZiAoY3VycmVudCA8IGxlbmd0aCkge1xuICAgICAgbG9vcCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmluUHJvZ3Jlc3MgPSBmYWxzZTtcbiAgICAgIHRoaXMuaG90LnZpZXcud3Qud3RPdmVybGF5cy5hZGp1c3RFbGVtZW50c1NpemUoZmFsc2UpO1xuICAgIH1cbiAgfSxcbiAgc2V0U2FtcGxpbmdPcHRpb25zOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2V0dGluZyA9IHRoaXMuaG90LmdldFNldHRpbmdzKCkuYXV0b1Jvd1NpemU7XG4gICAgdmFyIHNhbXBsaW5nUmF0aW8gPSBzZXR0aW5nICYmIHNldHRpbmcuaGFzT3duUHJvcGVydHkoJ3NhbXBsaW5nUmF0aW8nKSA/IHRoaXMuaG90LmdldFNldHRpbmdzKCkuYXV0b1Jvd1NpemUuc2FtcGxpbmdSYXRpbyA6IHZvaWQgMDtcbiAgICB2YXIgYWxsb3dTYW1wbGVEdXBsaWNhdGVzID0gc2V0dGluZyAmJiBzZXR0aW5nLmhhc093blByb3BlcnR5KCdhbGxvd1NhbXBsZUR1cGxpY2F0ZXMnKSA/IHRoaXMuaG90LmdldFNldHRpbmdzKCkuYXV0b1Jvd1NpemUuYWxsb3dTYW1wbGVEdXBsaWNhdGVzIDogdm9pZCAwO1xuICAgIGlmIChzYW1wbGluZ1JhdGlvICYmICFpc05hTihzYW1wbGluZ1JhdGlvKSkge1xuICAgICAgdGhpcy5zYW1wbGVzR2VuZXJhdG9yLnNldFNhbXBsZUNvdW50KHBhcnNlSW50KHNhbXBsaW5nUmF0aW8sIDEwKSk7XG4gICAgfVxuICAgIGlmIChhbGxvd1NhbXBsZUR1cGxpY2F0ZXMpIHtcbiAgICAgIHRoaXMuc2FtcGxlc0dlbmVyYXRvci5zZXRBbGxvd0R1cGxpY2F0ZXMoYWxsb3dTYW1wbGVEdXBsaWNhdGVzKTtcbiAgICB9XG4gIH0sXG4gIHJlY2FsY3VsYXRlQWxsUm93c0hlaWdodDogZnVuY3Rpb24oKSB7XG4gICAgaWYgKGlzVmlzaWJsZSh0aGlzLmhvdC52aWV3Lnd0Lnd0VGFibGUuVEFCTEUpKSB7XG4gICAgICB0aGlzLmNsZWFyQ2FjaGUoKTtcbiAgICAgIHRoaXMuY2FsY3VsYXRlQWxsUm93c0hlaWdodCgpO1xuICAgIH1cbiAgfSxcbiAgZ2V0U3luY0NhbGN1bGF0aW9uTGltaXQ6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBsaW1pdCA9ICRBdXRvUm93U2l6ZS5TWU5DX0NBTENVTEFUSU9OX0xJTUlUO1xuICAgIHZhciByb3dzTGltaXQgPSB0aGlzLmhvdC5jb3VudFJvd3MoKSAtIDE7XG4gICAgaWYgKGlzT2JqZWN0KHRoaXMuaG90LmdldFNldHRpbmdzKCkuYXV0b1Jvd1NpemUpKSB7XG4gICAgICBsaW1pdCA9IHRoaXMuaG90LmdldFNldHRpbmdzKCkuYXV0b1Jvd1NpemUuc3luY0xpbWl0O1xuICAgICAgaWYgKGlzUGVyY2VudFZhbHVlKGxpbWl0KSkge1xuICAgICAgICBsaW1pdCA9IHZhbHVlQWNjb3JkaW5nUGVyY2VudChyb3dzTGltaXQsIGxpbWl0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxpbWl0ID0gbGltaXQgPj4gMDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIE1hdGgubWluKGxpbWl0LCByb3dzTGltaXQpO1xuICB9LFxuICBnZXRSb3dIZWlnaHQ6IGZ1bmN0aW9uKHJvdykge1xuICAgIHZhciBkZWZhdWx0SGVpZ2h0ID0gYXJndW1lbnRzWzFdO1xuICAgIHZhciBoZWlnaHQgPSBkZWZhdWx0SGVpZ2h0O1xuICAgIGlmICh0aGlzLmhlaWdodHNbcm93XSAhPT0gdm9pZCAwICYmIHRoaXMuaGVpZ2h0c1tyb3ddID4gKGRlZmF1bHRIZWlnaHQgfHwgMCkpIHtcbiAgICAgIGhlaWdodCA9IHRoaXMuaGVpZ2h0c1tyb3ddO1xuICAgIH1cbiAgICByZXR1cm4gaGVpZ2h0O1xuICB9LFxuICBnZXRDb2x1bW5IZWFkZXJIZWlnaHQ6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmhlaWdodHNbLTFdO1xuICB9LFxuICBnZXRGaXJzdFZpc2libGVSb3c6IGZ1bmN0aW9uKCkge1xuICAgIHZhciB3b3QgPSB0aGlzLmhvdC52aWV3Lnd0O1xuICAgIGlmICh3b3Qud3RWaWV3cG9ydC5yb3dzVmlzaWJsZUNhbGN1bGF0b3IpIHtcbiAgICAgIHJldHVybiB3b3Qud3RUYWJsZS5nZXRGaXJzdFZpc2libGVSb3coKTtcbiAgICB9XG4gICAgaWYgKHdvdC53dFZpZXdwb3J0LnJvd3NSZW5kZXJDYWxjdWxhdG9yKSB7XG4gICAgICByZXR1cm4gd290Lnd0VGFibGUuZ2V0Rmlyc3RSZW5kZXJlZFJvdygpO1xuICAgIH1cbiAgICByZXR1cm4gLTE7XG4gIH0sXG4gIGdldExhc3RWaXNpYmxlUm93OiBmdW5jdGlvbigpIHtcbiAgICB2YXIgd290ID0gdGhpcy5ob3Qudmlldy53dDtcbiAgICBpZiAod290Lnd0Vmlld3BvcnQucm93c1Zpc2libGVDYWxjdWxhdG9yKSB7XG4gICAgICByZXR1cm4gd290Lnd0VGFibGUuZ2V0TGFzdFZpc2libGVSb3coKTtcbiAgICB9XG4gICAgaWYgKHdvdC53dFZpZXdwb3J0LnJvd3NSZW5kZXJDYWxjdWxhdG9yKSB7XG4gICAgICByZXR1cm4gd290Lnd0VGFibGUuZ2V0TGFzdFJlbmRlcmVkUm93KCk7XG4gICAgfVxuICAgIHJldHVybiAtMTtcbiAgfSxcbiAgY2xlYXJDYWNoZTogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5oZWlnaHRzLmxlbmd0aCA9IDA7XG4gICAgdGhpcy5oZWlnaHRzWy0xXSA9IHZvaWQgMDtcbiAgfSxcbiAgY2xlYXJDYWNoZUJ5UmFuZ2U6IGZ1bmN0aW9uKHJhbmdlKSB7XG4gICAgdmFyICRfXzEwID0gdGhpcztcbiAgICBpZiAodHlwZW9mIHJhbmdlID09PSAnbnVtYmVyJykge1xuICAgICAgcmFuZ2UgPSB7XG4gICAgICAgIGZyb206IHJhbmdlLFxuICAgICAgICB0bzogcmFuZ2VcbiAgICAgIH07XG4gICAgfVxuICAgIHJhbmdlRWFjaChNYXRoLm1pbihyYW5nZS5mcm9tLCByYW5nZS50byksIE1hdGgubWF4KHJhbmdlLmZyb20sIHJhbmdlLnRvKSwgKGZ1bmN0aW9uKHJvdykge1xuICAgICAgcmV0dXJuICRfXzEwLmhlaWdodHNbcm93XSA9IHZvaWQgMDtcbiAgICB9KSk7XG4gIH0sXG4gIGlzTmVlZFJlY2FsY3VsYXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gYXJyYXlGaWx0ZXIodGhpcy5oZWlnaHRzLCAoZnVuY3Rpb24oaXRlbSkge1xuICAgICAgcmV0dXJuIChpdGVtID09PSB2b2lkIDApO1xuICAgIH0pKS5sZW5ndGggPyB0cnVlIDogZmFsc2U7XG4gIH0sXG4gIG9uQmVmb3JlUmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgZm9yY2UgPSB0aGlzLmhvdC5yZW5kZXJDYWxsO1xuICAgIHRoaXMuY2FsY3VsYXRlUm93c0hlaWdodCh7XG4gICAgICBmcm9tOiB0aGlzLmdldEZpcnN0VmlzaWJsZVJvdygpLFxuICAgICAgdG86IHRoaXMuZ2V0TGFzdFZpc2libGVSb3coKVxuICAgIH0sIHZvaWQgMCwgZm9yY2UpO1xuICAgIHZhciBmaXhlZFJvd3NCb3R0b20gPSB0aGlzLmhvdC5nZXRTZXR0aW5ncygpLmZpeGVkUm93c0JvdHRvbTtcbiAgICBpZiAoZml4ZWRSb3dzQm90dG9tKSB7XG4gICAgICB2YXIgdG90YWxSb3dzID0gdGhpcy5ob3QuY291bnRSb3dzKCkgLSAxO1xuICAgICAgdGhpcy5jYWxjdWxhdGVSb3dzSGVpZ2h0KHtcbiAgICAgICAgZnJvbTogdG90YWxSb3dzIC0gZml4ZWRSb3dzQm90dG9tLFxuICAgICAgICB0bzogdG90YWxSb3dzXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKHRoaXMuaXNOZWVkUmVjYWxjdWxhdGUoKSAmJiAhdGhpcy5pblByb2dyZXNzKSB7XG4gICAgICB0aGlzLmNhbGN1bGF0ZUFsbFJvd3NIZWlnaHQoKTtcbiAgICB9XG4gIH0sXG4gIG9uQmVmb3JlUm93TW92ZTogZnVuY3Rpb24oZnJvbSwgdG8pIHtcbiAgICB0aGlzLmNsZWFyQ2FjaGVCeVJhbmdlKHtcbiAgICAgIGZyb206IGZyb20sXG4gICAgICB0bzogdG9cbiAgICB9KTtcbiAgICB0aGlzLmNhbGN1bGF0ZUFsbFJvd3NIZWlnaHQoKTtcbiAgfSxcbiAgb25CZWZvcmVSb3dSZXNpemU6IGZ1bmN0aW9uKHJvdywgc2l6ZSwgaXNEYmxDbGljaykge1xuICAgIGlmIChpc0RibENsaWNrKSB7XG4gICAgICB0aGlzLmNhbGN1bGF0ZVJvd3NIZWlnaHQocm93LCB2b2lkIDAsIHRydWUpO1xuICAgICAgc2l6ZSA9IHRoaXMuZ2V0Um93SGVpZ2h0KHJvdyk7XG4gICAgfVxuICAgIHJldHVybiBzaXplO1xuICB9LFxuICBvbkFmdGVyTG9hZERhdGE6IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX18xMCA9IHRoaXM7XG4gICAgaWYgKHRoaXMuaG90LnZpZXcpIHtcbiAgICAgIHRoaXMucmVjYWxjdWxhdGVBbGxSb3dzSGVpZ2h0KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNldFRpbWVvdXQoKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoJF9fMTAuaG90KSB7XG4gICAgICAgICAgJF9fMTAucmVjYWxjdWxhdGVBbGxSb3dzSGVpZ2h0KCk7XG4gICAgICAgIH1cbiAgICAgIH0pLCAwKTtcbiAgICB9XG4gIH0sXG4gIG9uQmVmb3JlQ2hhbmdlOiBmdW5jdGlvbihjaGFuZ2VzKSB7XG4gICAgdmFyIHJhbmdlID0gbnVsbDtcbiAgICBpZiAoY2hhbmdlcy5sZW5ndGggPT09IDEpIHtcbiAgICAgIHJhbmdlID0gY2hhbmdlc1swXVswXTtcbiAgICB9IGVsc2UgaWYgKGNoYW5nZXMubGVuZ3RoID4gMSkge1xuICAgICAgcmFuZ2UgPSB7XG4gICAgICAgIGZyb206IGNoYW5nZXNbMF1bMF0sXG4gICAgICAgIHRvOiBjaGFuZ2VzW2NoYW5nZXMubGVuZ3RoIC0gMV1bMF1cbiAgICAgIH07XG4gICAgfVxuICAgIGlmIChyYW5nZSAhPT0gbnVsbCkge1xuICAgICAgdGhpcy5jbGVhckNhY2hlQnlSYW5nZShyYW5nZSk7XG4gICAgfVxuICB9LFxuICBkZXN0cm95OiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmdob3N0VGFibGUuY2xlYW4oKTtcbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJEF1dG9Sb3dTaXplLnByb3RvdHlwZSwgXCJkZXN0cm95XCIpLmNhbGwodGhpcyk7XG4gIH1cbn0sIHtcbiAgZ2V0IENBTENVTEFUSU9OX1NURVAoKSB7XG4gICAgcmV0dXJuIDUwO1xuICB9LFxuICBnZXQgU1lOQ19DQUxDVUxBVElPTl9MSU1JVCgpIHtcbiAgICByZXR1cm4gNTAwO1xuICB9XG59LCBCYXNlUGx1Z2luKTtcbjtcbnJlZ2lzdGVyUGx1Z2luKCdhdXRvUm93U2l6ZScsIEF1dG9Sb3dTaXplKTtcblxuLy8jIFxufSx7XCJfYmFzZVwiOjYyLFwiaGVscGVycy9hcnJheVwiOjQzLFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwiaGVscGVycy9mZWF0dXJlXCI6NDksXCJoZWxwZXJzL251bWJlclwiOjUyLFwiaGVscGVycy9vYmplY3RcIjo1MyxcImhlbHBlcnMvc3RyaW5nXCI6NTUsXCJwbHVnaW5zXCI6NjEsXCJ1dGlscy9naG9zdFRhYmxlXCI6MTI4LFwidXRpbHMvc2FtcGxlc0dlbmVyYXRvclwiOjEzMX1dLDY1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBBdXRvZmlsbDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gQXV0b2ZpbGw7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X185NV9iYXNlX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19fLFxuICAgICRfX3V0aWxzX187XG52YXIgQmFzZVBsdWdpbiA9ICgkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fID0gX2RlcmVxXyhcIl9iYXNlXCIpLCAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fICYmICRfX180Nl9fNDZfXzQ3X185NV9iYXNlX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9ffSkuZGVmYXVsdDtcbnZhciBIYW5kc29udGFibGUgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgYXJyYXlJbmNsdWRlcyA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gPSBfZGVyZXFfKFwiaGVscGVycy9hcnJheVwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9ffSkuYXJyYXlJbmNsdWRlcztcbnZhciAkX18zID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9lbGVtZW50XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X199KSxcbiAgICBvZmZzZXQgPSAkX18zLm9mZnNldCxcbiAgICBvdXRlckhlaWdodCA9ICRfXzMub3V0ZXJIZWlnaHQsXG4gICAgb3V0ZXJXaWR0aCA9ICRfXzMub3V0ZXJXaWR0aDtcbnZhciBldmVudE1hbmFnZXJPYmplY3QgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gPSBfZGVyZXFfKFwiZXZlbnRNYW5hZ2VyXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfX30pLmV2ZW50TWFuYWdlcjtcbnZhciByZWdpc3RlclBsdWdpbiA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gPSBfZGVyZXFfKFwicGx1Z2luc1wiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19ffSkucmVnaXN0ZXJQbHVnaW47XG52YXIgV2Fsa29udGFibGVDZWxsQ29vcmRzID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19fID0gX2RlcmVxXyhcIjNyZHBhcnR5L3dhbGtvbnRhYmxlL3NyYy9jZWxsL2Nvb3Jkc1wiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2VsbF80N19jb29yZHNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX199KS5XYWxrb250YWJsZUNlbGxDb29yZHM7XG52YXIgJF9fNyA9ICgkX191dGlsc19fID0gX2RlcmVxXyhcInV0aWxzXCIpLCAkX191dGlsc19fICYmICRfX3V0aWxzX18uX19lc01vZHVsZSAmJiAkX191dGlsc19fIHx8IHtkZWZhdWx0OiAkX191dGlsc19ffSksXG4gICAgZ2V0RGVsdGFzID0gJF9fNy5nZXREZWx0YXMsXG4gICAgZ2V0RHJhZ0RpcmVjdGlvbkFuZFJhbmdlID0gJF9fNy5nZXREcmFnRGlyZWN0aW9uQW5kUmFuZ2UsXG4gICAgRElSRUNUSU9OUyA9ICRfXzcuRElSRUNUSU9OUyxcbiAgICBnZXRNYXBwZWRGaWxsSGFuZGxlU2V0dGluZyA9ICRfXzcuZ2V0TWFwcGVkRmlsbEhhbmRsZVNldHRpbmc7XG52YXIgSU5TRVJUX1JPV19BTFRFUl9BQ1RJT05fTkFNRSA9ICdpbnNlcnRfcm93JztcbnZhciBJTlRFUlZBTF9GT1JfQURESU5HX1JPVyA9IDIwMDtcbnZhciBBdXRvZmlsbCA9IGZ1bmN0aW9uIEF1dG9maWxsKGhvdEluc3RhbmNlKSB7XG4gICR0cmFjZXVyUnVudGltZS5zdXBlckNvbnN0cnVjdG9yKCRBdXRvZmlsbCkuY2FsbCh0aGlzLCBob3RJbnN0YW5jZSk7XG4gIHRoaXMuZXZlbnRNYW5hZ2VyID0gZXZlbnRNYW5hZ2VyT2JqZWN0KHRoaXMpO1xuICB0aGlzLmFkZGluZ1N0YXJ0ZWQgPSBmYWxzZTtcbiAgdGhpcy5tb3VzZURvd25PbkNlbGxDb3JuZXIgPSBmYWxzZTtcbiAgdGhpcy5tb3VzZURyYWdPdXRzaWRlID0gZmFsc2U7XG4gIHRoaXMuaGFuZGxlRHJhZ2dlZENlbGxzID0gMDtcbiAgdGhpcy5kaXJlY3Rpb25zID0gW107XG4gIHRoaXMuYXV0b0luc2VydFJvdyA9IGZhbHNlO1xufTtcbnZhciAkQXV0b2ZpbGwgPSBBdXRvZmlsbDtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKEF1dG9maWxsLCB7XG4gIGlzRW5hYmxlZDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuaG90LmdldFNldHRpbmdzKCkuZmlsbEhhbmRsZTtcbiAgfSxcbiAgZW5hYmxlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fOCA9IHRoaXM7XG4gICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLm1hcFNldHRpbmdzKCk7XG4gICAgdGhpcy5yZWdpc3RlckV2ZW50cygpO1xuICAgIHRoaXMuYWRkSG9vaygnYWZ0ZXJPbkNlbGxDb3JuZXJNb3VzZURvd24nLCAoZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHJldHVybiAkX184Lm9uQWZ0ZXJDZWxsQ29ybmVyTW91c2VEb3duKGV2ZW50KTtcbiAgICB9KSk7XG4gICAgdGhpcy5hZGRIb29rKCdhZnRlck9uQ2VsbENvcm5lckRibENsaWNrJywgKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICByZXR1cm4gJF9fOC5vbkNlbGxDb3JuZXJEYmxDbGljayhldmVudCk7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygnYmVmb3JlT25DZWxsTW91c2VPdmVyJywgKGZ1bmN0aW9uKGV2ZW50LCBjb29yZHMsIFREKSB7XG4gICAgICByZXR1cm4gJF9fOC5vbkJlZm9yZUNlbGxNb3VzZU92ZXIoY29vcmRzKTtcbiAgICB9KSk7XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICRBdXRvZmlsbC5wcm90b3R5cGUsIFwiZW5hYmxlUGx1Z2luXCIpLmNhbGwodGhpcyk7XG4gIH0sXG4gIHVwZGF0ZVBsdWdpbjogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5kaXNhYmxlUGx1Z2luKCk7XG4gICAgdGhpcy5lbmFibGVQbHVnaW4oKTtcbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJEF1dG9maWxsLnByb3RvdHlwZSwgXCJ1cGRhdGVQbHVnaW5cIikuY2FsbCh0aGlzKTtcbiAgfSxcbiAgZGlzYWJsZVBsdWdpbjogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5jbGVhck1hcHBlZFNldHRpbmdzKCk7XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICRBdXRvZmlsbC5wcm90b3R5cGUsIFwiZGlzYWJsZVBsdWdpblwiKS5jYWxsKHRoaXMpO1xuICB9LFxuICBnZXRTZWxlY3Rpb25EYXRhOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsUmFuZ2UgPSB7XG4gICAgICBmcm9tOiB0aGlzLmhvdC5nZXRTZWxlY3RlZFJhbmdlKCkuZnJvbSxcbiAgICAgIHRvOiB0aGlzLmhvdC5nZXRTZWxlY3RlZFJhbmdlKCkudG9cbiAgICB9O1xuICAgIHJldHVybiB0aGlzLmhvdC5nZXREYXRhKHNlbFJhbmdlLmZyb20ucm93LCBzZWxSYW5nZS5mcm9tLmNvbCwgc2VsUmFuZ2UudG8ucm93LCBzZWxSYW5nZS50by5jb2wpO1xuICB9LFxuICBmaWxsSW46IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLmhvdC52aWV3Lnd0LnNlbGVjdGlvbnMuZmlsbC5pc0VtcHR5KCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGNvcm5lcnNPZlNlbGVjdGlvbkFuZERyYWdBcmVhcyA9IHRoaXMuaG90LnZpZXcud3Quc2VsZWN0aW9ucy5maWxsLmdldENvcm5lcnMoKTtcbiAgICB0aGlzLnJlc2V0U2VsZWN0aW9uT2ZEcmFnZ2VkQXJlYSgpO1xuICAgIHZhciBjb3JuZXJzT2ZTZWxlY3RlZENlbGxzID0gdGhpcy5nZXRDb3JuZXJzT2ZTZWxlY3RlZENlbGxzKCk7XG4gICAgdmFyICRfXzEwID0gZ2V0RHJhZ0RpcmVjdGlvbkFuZFJhbmdlKGNvcm5lcnNPZlNlbGVjdGVkQ2VsbHMsIGNvcm5lcnNPZlNlbGVjdGlvbkFuZERyYWdBcmVhcyksXG4gICAgICAgIGRpcmVjdGlvbk9mRHJhZyA9ICRfXzEwLmRpcmVjdGlvbk9mRHJhZyxcbiAgICAgICAgc3RhcnRPZkRyYWdDb29yZHMgPSAkX18xMC5zdGFydE9mRHJhZ0Nvb3JkcyxcbiAgICAgICAgZW5kT2ZEcmFnQ29vcmRzID0gJF9fMTAuZW5kT2ZEcmFnQ29vcmRzO1xuICAgIHRoaXMuaG90LnJ1bkhvb2tzKCdtb2RpZnlBdXRvZmlsbFJhbmdlJywgY29ybmVyc09mU2VsZWN0ZWRDZWxscywgY29ybmVyc09mU2VsZWN0aW9uQW5kRHJhZ0FyZWFzKTtcbiAgICBpZiAoc3RhcnRPZkRyYWdDb29yZHMgJiYgc3RhcnRPZkRyYWdDb29yZHMucm93ID4gLTEgJiYgc3RhcnRPZkRyYWdDb29yZHMuY29sID4gLTEpIHtcbiAgICAgIHZhciBzZWxlY3Rpb25EYXRhID0gdGhpcy5nZXRTZWxlY3Rpb25EYXRhKCk7XG4gICAgICB2YXIgZGVsdGFzID0gZ2V0RGVsdGFzKHN0YXJ0T2ZEcmFnQ29vcmRzLCBlbmRPZkRyYWdDb29yZHMsIHNlbGVjdGlvbkRhdGEsIGRpcmVjdGlvbk9mRHJhZyk7XG4gICAgICB0aGlzLmhvdC5ydW5Ib29rcygnYmVmb3JlQXV0b2ZpbGwnLCBzdGFydE9mRHJhZ0Nvb3JkcywgZW5kT2ZEcmFnQ29vcmRzLCBzZWxlY3Rpb25EYXRhKTtcbiAgICAgIHRoaXMuaG90LnBvcHVsYXRlRnJvbUFycmF5KHN0YXJ0T2ZEcmFnQ29vcmRzLnJvdywgc3RhcnRPZkRyYWdDb29yZHMuY29sLCBzZWxlY3Rpb25EYXRhLCBlbmRPZkRyYWdDb29yZHMucm93LCBlbmRPZkRyYWdDb29yZHMuY29sLCAodGhpcy5wbHVnaW5OYW1lICsgXCIuZmlsbFwiKSwgbnVsbCwgZGlyZWN0aW9uT2ZEcmFnLCBkZWx0YXMpO1xuICAgICAgdGhpcy5zZXRTZWxlY3Rpb24oY29ybmVyc09mU2VsZWN0aW9uQW5kRHJhZ0FyZWFzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5ob3Quc2VsZWN0aW9uLnJlZnJlc2hCb3JkZXJzKCk7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9LFxuICByZWR1Y2VTZWxlY3Rpb25BcmVhSWZOZWVkZWQ6IGZ1bmN0aW9uKGNvb3Jkcykge1xuICAgIGlmIChjb29yZHMucm93IDwgMCkge1xuICAgICAgY29vcmRzLnJvdyA9IDA7XG4gICAgfVxuICAgIGlmIChjb29yZHMuY29sIDwgMCkge1xuICAgICAgY29vcmRzLmNvbCA9IDA7XG4gICAgfVxuICAgIHJldHVybiBjb29yZHM7XG4gIH0sXG4gIGdldENvb3Jkc09mRHJhZ0FuZERyb3BCb3JkZXJzOiBmdW5jdGlvbihjb29yZHNPZlNlbGVjdGlvbikge1xuICAgIHZhciB0b3BMZWZ0Q29ybmVyID0gdGhpcy5ob3QuZ2V0U2VsZWN0ZWRSYW5nZSgpLmdldFRvcExlZnRDb3JuZXIoKTtcbiAgICB2YXIgYm90dG9tUmlnaHRDb3JuZXIgPSB0aGlzLmhvdC5nZXRTZWxlY3RlZFJhbmdlKCkuZ2V0Qm90dG9tUmlnaHRDb3JuZXIoKTtcbiAgICB2YXIgY29vcmRzO1xuICAgIGlmIChhcnJheUluY2x1ZGVzKHRoaXMuZGlyZWN0aW9ucywgRElSRUNUSU9OUy52ZXJ0aWNhbCkgJiYgKGJvdHRvbVJpZ2h0Q29ybmVyLnJvdyA8IGNvb3Jkc09mU2VsZWN0aW9uLnJvdyB8fCB0b3BMZWZ0Q29ybmVyLnJvdyA+IGNvb3Jkc09mU2VsZWN0aW9uLnJvdykpIHtcbiAgICAgIGNvb3JkcyA9IG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoY29vcmRzT2ZTZWxlY3Rpb24ucm93LCBib3R0b21SaWdodENvcm5lci5jb2wpO1xuICAgIH0gZWxzZSBpZiAoYXJyYXlJbmNsdWRlcyh0aGlzLmRpcmVjdGlvbnMsIERJUkVDVElPTlMuaG9yaXpvbnRhbCkpIHtcbiAgICAgIGNvb3JkcyA9IG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoYm90dG9tUmlnaHRDb3JuZXIucm93LCBjb29yZHNPZlNlbGVjdGlvbi5jb2wpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnJlZHVjZVNlbGVjdGlvbkFyZWFJZk5lZWRlZChjb29yZHMpO1xuICB9LFxuICBzaG93Qm9yZGVyOiBmdW5jdGlvbihjb29yZHNPZlNlbGVjdGlvbikge1xuICAgIHZhciBjb29yZHNPZkRyYWdBbmREcm9wQm9yZGVycyA9IHRoaXMuZ2V0Q29vcmRzT2ZEcmFnQW5kRHJvcEJvcmRlcnMoY29vcmRzT2ZTZWxlY3Rpb24pO1xuICAgIGlmIChjb29yZHNPZkRyYWdBbmREcm9wQm9yZGVycykge1xuICAgICAgdGhpcy5yZWRyYXdCb3JkZXJzKGNvb3Jkc09mRHJhZ0FuZERyb3BCb3JkZXJzKTtcbiAgICB9XG4gIH0sXG4gIGFkZFJvdzogZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzggPSB0aGlzO1xuICAgIHRoaXMuaG90Ll9yZWdpc3RlclRpbWVvdXQoc2V0VGltZW91dCgoZnVuY3Rpb24oKSB7XG4gICAgICAkX184LmhvdC5hbHRlcihJTlNFUlRfUk9XX0FMVEVSX0FDVElPTl9OQU1FLCB2b2lkIDAsIDEsICgkX184LnBsdWdpbk5hbWUgKyBcIi5maWxsXCIpKTtcbiAgICAgICRfXzguYWRkaW5nU3RhcnRlZCA9IGZhbHNlO1xuICAgIH0pLCBJTlRFUlZBTF9GT1JfQURESU5HX1JPVykpO1xuICB9LFxuICBhZGROZXdSb3dJZk5lZWRlZDogZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuaG90LnZpZXcud3Quc2VsZWN0aW9ucy5maWxsLmNlbGxSYW5nZSAmJiB0aGlzLmFkZGluZ1N0YXJ0ZWQgPT09IGZhbHNlICYmIHRoaXMuYXV0b0luc2VydFJvdykge1xuICAgICAgdmFyIGNvcm5lcnNPZlNlbGVjdGVkQ2VsbHMgPSB0aGlzLmhvdC5nZXRTZWxlY3RlZCgpO1xuICAgICAgdmFyIGNvcm5lcnNPZlNlbGVjdGVkRHJhZ0FyZWEgPSB0aGlzLmhvdC52aWV3Lnd0LnNlbGVjdGlvbnMuZmlsbC5nZXRDb3JuZXJzKCk7XG4gICAgICB2YXIgbnJPZlRhYmxlUm93cyA9IHRoaXMuaG90LmNvdW50Um93cygpO1xuICAgICAgaWYgKGNvcm5lcnNPZlNlbGVjdGVkQ2VsbHNbMl0gPCBuck9mVGFibGVSb3dzIC0gMSAmJiBjb3JuZXJzT2ZTZWxlY3RlZERyYWdBcmVhWzJdID09PSBuck9mVGFibGVSb3dzIC0gMSkge1xuICAgICAgICB0aGlzLmFkZGluZ1N0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmFkZFJvdygpO1xuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgZ2V0Q29ybmVyc09mU2VsZWN0ZWRDZWxsczogZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuaG90LnNlbGVjdGlvbi5pc011bHRpcGxlKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLmhvdC52aWV3Lnd0LnNlbGVjdGlvbnMuYXJlYS5nZXRDb3JuZXJzKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmhvdC52aWV3Lnd0LnNlbGVjdGlvbnMuY3VycmVudC5nZXRDb3JuZXJzKCk7XG4gICAgfVxuICB9LFxuICBnZXRJbmRleE9mTGFzdEFkamFjZW50RmlsbGVkSW5Sb3c6IGZ1bmN0aW9uKGNvcm5lcnNPZlNlbGVjdGVkQ2VsbHMpIHtcbiAgICB2YXIgZGF0YSA9IHRoaXMuaG90LmdldERhdGEoKTtcbiAgICB2YXIgbnJPZlRhYmxlUm93cyA9IHRoaXMuaG90LmNvdW50Um93cygpO1xuICAgIHZhciBsYXN0RmlsbGVkSW5Sb3dJbmRleDtcbiAgICBmb3IgKHZhciByb3dJbmRleCA9IGNvcm5lcnNPZlNlbGVjdGVkQ2VsbHNbMl0gKyAxOyByb3dJbmRleCA8IG5yT2ZUYWJsZVJvd3M7IHJvd0luZGV4KyspIHtcbiAgICAgIGZvciAodmFyIGNvbHVtbkluZGV4ID0gY29ybmVyc09mU2VsZWN0ZWRDZWxsc1sxXTsgY29sdW1uSW5kZXggPD0gY29ybmVyc09mU2VsZWN0ZWRDZWxsc1szXTsgY29sdW1uSW5kZXgrKykge1xuICAgICAgICB2YXIgZGF0YUluQ2VsbCA9IGRhdGFbcm93SW5kZXhdW2NvbHVtbkluZGV4XTtcbiAgICAgICAgaWYgKGRhdGFJbkNlbGwpIHtcbiAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHZhciBkYXRhSW5OZXh0TGVmdENlbGwgPSBkYXRhW3Jvd0luZGV4XVtjb3JuZXJzT2ZTZWxlY3RlZENlbGxzWzFdIC0gMV07XG4gICAgICB2YXIgZGF0YUluTmV4dFJpZ2h0Q2VsbCA9IGRhdGFbcm93SW5kZXhdW2Nvcm5lcnNPZlNlbGVjdGVkQ2VsbHNbM10gKyAxXTtcbiAgICAgIGlmICghIWRhdGFJbk5leHRMZWZ0Q2VsbCB8fCAhIWRhdGFJbk5leHRSaWdodENlbGwpIHtcbiAgICAgICAgbGFzdEZpbGxlZEluUm93SW5kZXggPSByb3dJbmRleDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGxhc3RGaWxsZWRJblJvd0luZGV4O1xuICB9LFxuICBhZGRTZWxlY3Rpb25Gcm9tU3RhcnRBcmVhVG9TcGVjaWZpY1Jvd0luZGV4OiBmdW5jdGlvbihzZWxlY3RTdGFydEFyZWEsIHJvd0luZGV4KSB7XG4gICAgdGhpcy5ob3Qudmlldy53dC5zZWxlY3Rpb25zLmZpbGwuY2xlYXIoKTtcbiAgICB0aGlzLmhvdC52aWV3Lnd0LnNlbGVjdGlvbnMuZmlsbC5hZGQobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhzZWxlY3RTdGFydEFyZWFbMF0sIHNlbGVjdFN0YXJ0QXJlYVsxXSkpO1xuICAgIHRoaXMuaG90LnZpZXcud3Quc2VsZWN0aW9ucy5maWxsLmFkZChuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHJvd0luZGV4LCBzZWxlY3RTdGFydEFyZWFbM10pKTtcbiAgfSxcbiAgc2V0U2VsZWN0aW9uOiBmdW5jdGlvbihjb3JuZXJzT2ZBcmVhKSB7XG4gICAgdGhpcy5ob3Quc2VsZWN0aW9uLnNldFJhbmdlU3RhcnQobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3Jkcyhjb3JuZXJzT2ZBcmVhWzBdLCBjb3JuZXJzT2ZBcmVhWzFdKSk7XG4gICAgdGhpcy5ob3Quc2VsZWN0aW9uLnNldFJhbmdlRW5kKG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoY29ybmVyc09mQXJlYVsyXSwgY29ybmVyc09mQXJlYVszXSkpO1xuICB9LFxuICBzZWxlY3RBZGphY2VudDogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNvcm5lcnNPZlNlbGVjdGVkQ2VsbHMgPSB0aGlzLmdldENvcm5lcnNPZlNlbGVjdGVkQ2VsbHMoKTtcbiAgICB2YXIgbGFzdEZpbGxlZEluUm93SW5kZXggPSB0aGlzLmdldEluZGV4T2ZMYXN0QWRqYWNlbnRGaWxsZWRJblJvdyhjb3JuZXJzT2ZTZWxlY3RlZENlbGxzKTtcbiAgICBpZiAobGFzdEZpbGxlZEluUm93SW5kZXggPT09IC0xKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYWRkU2VsZWN0aW9uRnJvbVN0YXJ0QXJlYVRvU3BlY2lmaWNSb3dJbmRleChjb3JuZXJzT2ZTZWxlY3RlZENlbGxzLCBsYXN0RmlsbGVkSW5Sb3dJbmRleCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH0sXG4gIHJlc2V0U2VsZWN0aW9uT2ZEcmFnZ2VkQXJlYTogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5oYW5kbGVEcmFnZ2VkQ2VsbHMgPSAwO1xuICAgIHRoaXMuaG90LnZpZXcud3Quc2VsZWN0aW9ucy5maWxsLmNsZWFyKCk7XG4gIH0sXG4gIHJlZHJhd0JvcmRlcnM6IGZ1bmN0aW9uKGNvb3Jkcykge1xuICAgIHRoaXMuaG90LnZpZXcud3Quc2VsZWN0aW9ucy5maWxsLmNsZWFyKCk7XG4gICAgdGhpcy5ob3Qudmlldy53dC5zZWxlY3Rpb25zLmZpbGwuYWRkKHRoaXMuaG90LmdldFNlbGVjdGVkUmFuZ2UoKS5mcm9tKTtcbiAgICB0aGlzLmhvdC52aWV3Lnd0LnNlbGVjdGlvbnMuZmlsbC5hZGQodGhpcy5ob3QuZ2V0U2VsZWN0ZWRSYW5nZSgpLnRvKTtcbiAgICB0aGlzLmhvdC52aWV3Lnd0LnNlbGVjdGlvbnMuZmlsbC5hZGQoY29vcmRzKTtcbiAgICB0aGlzLmhvdC52aWV3LnJlbmRlcigpO1xuICB9LFxuICBnZXRJZk1vdXNlV2FzRHJhZ2dlZE91dHNpZGU6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIHRhYmxlQm90dG9tID0gb2Zmc2V0KHRoaXMuaG90LnRhYmxlKS50b3AgLSAod2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3ApICsgb3V0ZXJIZWlnaHQodGhpcy5ob3QudGFibGUpO1xuICAgIHZhciB0YWJsZVJpZ2h0ID0gb2Zmc2V0KHRoaXMuaG90LnRhYmxlKS5sZWZ0IC0gKHdpbmRvdy5wYWdlWE9mZnNldCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdCkgKyBvdXRlcldpZHRoKHRoaXMuaG90LnRhYmxlKTtcbiAgICByZXR1cm4gZXZlbnQuY2xpZW50WSA+IHRhYmxlQm90dG9tICYmIGV2ZW50LmNsaWVudFggPD0gdGFibGVSaWdodDtcbiAgfSxcbiAgcmVnaXN0ZXJFdmVudHM6IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX184ID0gdGhpcztcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgJ21vdXNldXAnLCAoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fOC5vbk1vdXNlVXAoKTtcbiAgICB9KSk7XG4gICAgdGhpcy5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsICdtb3VzZW1vdmUnLCAoZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHJldHVybiAkX184Lm9uTW91c2VNb3ZlKGV2ZW50KTtcbiAgICB9KSk7XG4gIH0sXG4gIG9uQ2VsbENvcm5lckRibENsaWNrOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZWN0aW9uQXBwbGllZCA9IHRoaXMuc2VsZWN0QWRqYWNlbnQoKTtcbiAgICBpZiAoc2VsZWN0aW9uQXBwbGllZCkge1xuICAgICAgdGhpcy5maWxsSW4oKTtcbiAgICB9XG4gIH0sXG4gIG9uQWZ0ZXJDZWxsQ29ybmVyTW91c2VEb3duOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmhhbmRsZURyYWdnZWRDZWxscyA9IDE7XG4gICAgdGhpcy5tb3VzZURvd25PbkNlbGxDb3JuZXIgPSB0cnVlO1xuICB9LFxuICBvbkJlZm9yZUNlbGxNb3VzZU92ZXI6IGZ1bmN0aW9uKGNvb3Jkcykge1xuICAgIGlmICh0aGlzLm1vdXNlRG93bk9uQ2VsbENvcm5lciAmJiAhdGhpcy5ob3Qudmlldy5pc01vdXNlRG93bigpICYmIHRoaXMuaGFuZGxlRHJhZ2dlZENlbGxzKSB7XG4gICAgICB0aGlzLmhhbmRsZURyYWdnZWRDZWxscysrO1xuICAgICAgdGhpcy5zaG93Qm9yZGVyKGNvb3Jkcyk7XG4gICAgICB0aGlzLmFkZE5ld1Jvd0lmTmVlZGVkKCk7XG4gICAgfVxuICB9LFxuICBvbk1vdXNlVXA6IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLmhhbmRsZURyYWdnZWRDZWxscykge1xuICAgICAgaWYgKHRoaXMuaGFuZGxlRHJhZ2dlZENlbGxzID4gMSkge1xuICAgICAgICB0aGlzLmZpbGxJbigpO1xuICAgICAgfVxuICAgICAgdGhpcy5oYW5kbGVEcmFnZ2VkQ2VsbHMgPSAwO1xuICAgICAgdGhpcy5tb3VzZURvd25PbkNlbGxDb3JuZXIgPSBmYWxzZTtcbiAgICB9XG4gIH0sXG4gIG9uTW91c2VNb3ZlOiBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciBtb3VzZVdhc0RyYWdnZWRPdXRzaWRlID0gdGhpcy5nZXRJZk1vdXNlV2FzRHJhZ2dlZE91dHNpZGUoZXZlbnQpO1xuICAgIGlmICh0aGlzLmFkZGluZ1N0YXJ0ZWQgPT09IGZhbHNlICYmIHRoaXMuaGFuZGxlRHJhZ2dlZENlbGxzID4gMCAmJiBtb3VzZVdhc0RyYWdnZWRPdXRzaWRlKSB7XG4gICAgICB0aGlzLm1vdXNlRHJhZ091dHNpZGUgPSB0cnVlO1xuICAgICAgdGhpcy5hZGRpbmdTdGFydGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5tb3VzZURyYWdPdXRzaWRlID0gZmFsc2U7XG4gICAgfVxuICAgIGlmICh0aGlzLm1vdXNlRHJhZ091dHNpZGUgJiYgdGhpcy5hdXRvSW5zZXJ0Um93KSB7XG4gICAgICB0aGlzLmFkZFJvdygpO1xuICAgIH1cbiAgfSxcbiAgY2xlYXJNYXBwZWRTZXR0aW5nczogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5kaXJlY3Rpb25zLmxlbmd0aCA9IDA7XG4gICAgdGhpcy5hdXRvSW5zZXJ0Um93ID0gZmFsc2U7XG4gIH0sXG4gIG1hcFNldHRpbmdzOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgbWFwcGVkU2V0dGluZ3MgPSBnZXRNYXBwZWRGaWxsSGFuZGxlU2V0dGluZyh0aGlzLmhvdC5nZXRTZXR0aW5ncygpLmZpbGxIYW5kbGUpO1xuICAgIHRoaXMuZGlyZWN0aW9ucyA9IG1hcHBlZFNldHRpbmdzLmRpcmVjdGlvbnM7XG4gICAgdGhpcy5hdXRvSW5zZXJ0Um93ID0gbWFwcGVkU2V0dGluZ3MuYXV0b0luc2VydFJvdztcbiAgfSxcbiAgZGVzdHJveTogZnVuY3Rpb24oKSB7XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICRBdXRvZmlsbC5wcm90b3R5cGUsIFwiZGVzdHJveVwiKS5jYWxsKHRoaXMpO1xuICB9XG59LCB7fSwgQmFzZVBsdWdpbik7XG47XG5yZWdpc3RlclBsdWdpbignYXV0b2ZpbGwnLCBBdXRvZmlsbCk7XG5IYW5kc29udGFibGUuaG9va3MucmVnaXN0ZXIoJ21vZGlmeUF1dG9maWxsUmFuZ2UnKTtcbkhhbmRzb250YWJsZS5ob29rcy5yZWdpc3RlcignYmVmb3JlQXV0b2ZpbGwnKTtcblxuLy8jIFxufSx7XCIzcmRwYXJ0eS93YWxrb250YWJsZS9zcmMvY2VsbC9jb29yZHNcIjo2LFwiX2Jhc2VcIjo2MixcImJyb3dzZXJcIjoyNCxcImV2ZW50TWFuYWdlclwiOjQyLFwiaGVscGVycy9hcnJheVwiOjQzLFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwicGx1Z2luc1wiOjYxLFwidXRpbHNcIjo2Nn1dLDY2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBESVJFQ1RJT05TOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBESVJFQ1RJT05TO1xuICAgIH19LFxuICBnZXREZWx0YXM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGdldERlbHRhcztcbiAgICB9fSxcbiAgZ2V0RHJhZ0RpcmVjdGlvbkFuZFJhbmdlOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBnZXREcmFnRGlyZWN0aW9uQW5kUmFuZ2U7XG4gICAgfX0sXG4gIGdldE1hcHBlZEZpbGxIYW5kbGVTZXR0aW5nOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBnZXRNYXBwZWRGaWxsSGFuZGxlU2V0dGluZztcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX187XG52YXIgaXNPYmplY3QgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL29iamVjdFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfX30pLmlzT2JqZWN0O1xudmFyIGlzRGVmaW5lZCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX18gPSBfZGVyZXFfKFwiaGVscGVycy9taXhlZFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19taXhlZF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbWl4ZWRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbWl4ZWRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19taXhlZF9ffSkuaXNEZWZpbmVkO1xudmFyIERJUkVDVElPTlMgPSB7XG4gIGhvcml6b250YWw6ICdob3Jpem9udGFsJyxcbiAgdmVydGljYWw6ICd2ZXJ0aWNhbCdcbn07XG5mdW5jdGlvbiBnZXREZWx0YXMoc3RhcnQsIGVuZCwgZGF0YSwgZGlyZWN0aW9uKSB7XG4gIHZhciByb3dzTGVuZ3RoID0gZGF0YS5sZW5ndGg7XG4gIHZhciBjb2x1bW5zTGVuZ3RoID0gZGF0YSA/IGRhdGFbMF0ubGVuZ3RoIDogMDtcbiAgdmFyIGRlbHRhcyA9IFtdO1xuICB2YXIgZGlmZlJvdyA9IGVuZC5yb3cgLSBzdGFydC5yb3c7XG4gIHZhciBkaWZmQ29sID0gZW5kLmNvbCAtIHN0YXJ0LmNvbDtcbiAgaWYgKFsnZG93bicsICd1cCddLmluZGV4T2YoZGlyZWN0aW9uKSAhPT0gLTEpIHtcbiAgICB2YXIgYXJyID0gW107XG4gICAgZm9yICh2YXIgY29sID0gMDsgY29sIDw9IGRpZmZDb2w7IGNvbCsrKSB7XG4gICAgICB2YXIgc3RhcnRWYWx1ZSA9IHBhcnNlSW50KGRhdGFbMF1bY29sXSwgMTApO1xuICAgICAgdmFyIGVuZFZhbHVlID0gcGFyc2VJbnQoZGF0YVtyb3dzTGVuZ3RoIC0gMV1bY29sXSwgMTApO1xuICAgICAgdmFyIGRlbHRhID0gKGRpcmVjdGlvbiA9PT0gJ2Rvd24nID8gKGVuZFZhbHVlIC0gc3RhcnRWYWx1ZSkgOiAoc3RhcnRWYWx1ZSAtIGVuZFZhbHVlKSkgLyAocm93c0xlbmd0aCAtIDEpIHx8IDA7XG4gICAgICBhcnIucHVzaChkZWx0YSk7XG4gICAgfVxuICAgIGRlbHRhcy5wdXNoKGFycik7XG4gIH1cbiAgaWYgKFsncmlnaHQnLCAnbGVmdCddLmluZGV4T2YoZGlyZWN0aW9uKSAhPT0gLTEpIHtcbiAgICBmb3IgKHZhciByb3cgPSAwOyByb3cgPD0gZGlmZlJvdzsgcm93KyspIHtcbiAgICAgIHZhciBzdGFydFZhbHVlJF9fMiA9IHBhcnNlSW50KGRhdGFbcm93XVswXSwgMTApO1xuICAgICAgdmFyIGVuZFZhbHVlJF9fMyA9IHBhcnNlSW50KGRhdGFbcm93XVtjb2x1bW5zTGVuZ3RoIC0gMV0sIDEwKTtcbiAgICAgIHZhciBkZWx0YSRfXzQgPSAoZGlyZWN0aW9uID09PSAncmlnaHQnID8gKGVuZFZhbHVlJF9fMyAtIHN0YXJ0VmFsdWUkX18yKSA6IChzdGFydFZhbHVlJF9fMiAtIGVuZFZhbHVlJF9fMykpIC8gKGNvbHVtbnNMZW5ndGggLSAxKSB8fCAwO1xuICAgICAgZGVsdGFzLnB1c2goW2RlbHRhJF9fNF0pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZGVsdGFzO1xufVxuZnVuY3Rpb24gZ2V0RHJhZ0RpcmVjdGlvbkFuZFJhbmdlKHN0YXJ0U2VsZWN0aW9uLCBlbmRTZWxlY3Rpb24pIHtcbiAgdmFyIHN0YXJ0T2ZEcmFnQ29vcmRzLFxuICAgICAgZW5kT2ZEcmFnQ29vcmRzLFxuICAgICAgZGlyZWN0aW9uT2ZEcmFnO1xuICBpZiAoZW5kU2VsZWN0aW9uWzBdID09PSBzdGFydFNlbGVjdGlvblswXSAmJiBlbmRTZWxlY3Rpb25bMV0gPCBzdGFydFNlbGVjdGlvblsxXSkge1xuICAgIGRpcmVjdGlvbk9mRHJhZyA9ICdsZWZ0JztcbiAgICBzdGFydE9mRHJhZ0Nvb3JkcyA9IG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoZW5kU2VsZWN0aW9uWzBdLCBlbmRTZWxlY3Rpb25bMV0pO1xuICAgIGVuZE9mRHJhZ0Nvb3JkcyA9IG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoZW5kU2VsZWN0aW9uWzJdLCBzdGFydFNlbGVjdGlvblsxXSAtIDEpO1xuICB9IGVsc2UgaWYgKGVuZFNlbGVjdGlvblswXSA9PT0gc3RhcnRTZWxlY3Rpb25bMF0gJiYgZW5kU2VsZWN0aW9uWzNdID4gc3RhcnRTZWxlY3Rpb25bM10pIHtcbiAgICBkaXJlY3Rpb25PZkRyYWcgPSAncmlnaHQnO1xuICAgIHN0YXJ0T2ZEcmFnQ29vcmRzID0gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhlbmRTZWxlY3Rpb25bMF0sIHN0YXJ0U2VsZWN0aW9uWzNdICsgMSk7XG4gICAgZW5kT2ZEcmFnQ29vcmRzID0gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhlbmRTZWxlY3Rpb25bMl0sIGVuZFNlbGVjdGlvblszXSk7XG4gIH0gZWxzZSBpZiAoZW5kU2VsZWN0aW9uWzBdIDwgc3RhcnRTZWxlY3Rpb25bMF0gJiYgZW5kU2VsZWN0aW9uWzFdID09PSBzdGFydFNlbGVjdGlvblsxXSkge1xuICAgIGRpcmVjdGlvbk9mRHJhZyA9ICd1cCc7XG4gICAgc3RhcnRPZkRyYWdDb29yZHMgPSBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKGVuZFNlbGVjdGlvblswXSwgZW5kU2VsZWN0aW9uWzFdKTtcbiAgICBlbmRPZkRyYWdDb29yZHMgPSBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHN0YXJ0U2VsZWN0aW9uWzBdIC0gMSwgZW5kU2VsZWN0aW9uWzNdKTtcbiAgfSBlbHNlIGlmIChlbmRTZWxlY3Rpb25bMl0gPiBzdGFydFNlbGVjdGlvblsyXSAmJiBlbmRTZWxlY3Rpb25bMV0gPT09IHN0YXJ0U2VsZWN0aW9uWzFdKSB7XG4gICAgZGlyZWN0aW9uT2ZEcmFnID0gJ2Rvd24nO1xuICAgIHN0YXJ0T2ZEcmFnQ29vcmRzID0gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhzdGFydFNlbGVjdGlvblsyXSArIDEsIGVuZFNlbGVjdGlvblsxXSk7XG4gICAgZW5kT2ZEcmFnQ29vcmRzID0gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhlbmRTZWxlY3Rpb25bMl0sIGVuZFNlbGVjdGlvblszXSk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBkaXJlY3Rpb25PZkRyYWc6IGRpcmVjdGlvbk9mRHJhZyxcbiAgICBzdGFydE9mRHJhZ0Nvb3Jkczogc3RhcnRPZkRyYWdDb29yZHMsXG4gICAgZW5kT2ZEcmFnQ29vcmRzOiBlbmRPZkRyYWdDb29yZHNcbiAgfTtcbn1cbmZ1bmN0aW9uIGdldE1hcHBlZEZpbGxIYW5kbGVTZXR0aW5nKGZpbGxIYW5kbGUpIHtcbiAgdmFyIG1hcHBlZFNldHRpbmdzID0ge307XG4gIGlmIChmaWxsSGFuZGxlID09PSB0cnVlKSB7XG4gICAgbWFwcGVkU2V0dGluZ3MuZGlyZWN0aW9ucyA9IE9iamVjdC5rZXlzKERJUkVDVElPTlMpO1xuICAgIG1hcHBlZFNldHRpbmdzLmF1dG9JbnNlcnRSb3cgPSB0cnVlO1xuICB9IGVsc2UgaWYgKGlzT2JqZWN0KGZpbGxIYW5kbGUpKSB7XG4gICAgaWYgKGlzRGVmaW5lZChmaWxsSGFuZGxlLmF1dG9JbnNlcnRSb3cpKSB7XG4gICAgICBpZiAoZmlsbEhhbmRsZS5kaXJlY3Rpb24gPT09IERJUkVDVElPTlMuaG9yaXpvbnRhbCkge1xuICAgICAgICBtYXBwZWRTZXR0aW5ncy5hdXRvSW5zZXJ0Um93ID0gZmFsc2U7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtYXBwZWRTZXR0aW5ncy5hdXRvSW5zZXJ0Um93ID0gZmlsbEhhbmRsZS5hdXRvSW5zZXJ0Um93O1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBtYXBwZWRTZXR0aW5ncy5hdXRvSW5zZXJ0Um93ID0gZmFsc2U7XG4gICAgfVxuICAgIGlmIChpc0RlZmluZWQoZmlsbEhhbmRsZS5kaXJlY3Rpb24pKSB7XG4gICAgICBtYXBwZWRTZXR0aW5ncy5kaXJlY3Rpb25zID0gW2ZpbGxIYW5kbGUuZGlyZWN0aW9uXTtcbiAgICB9IGVsc2Uge1xuICAgICAgbWFwcGVkU2V0dGluZ3MuZGlyZWN0aW9ucyA9IE9iamVjdC5rZXlzKERJUkVDVElPTlMpO1xuICAgIH1cbiAgfSBlbHNlIGlmICh0eXBlb2YgZmlsbEhhbmRsZSA9PT0gJ3N0cmluZycpIHtcbiAgICBtYXBwZWRTZXR0aW5ncy5kaXJlY3Rpb25zID0gW2ZpbGxIYW5kbGVdO1xuICAgIG1hcHBlZFNldHRpbmdzLmF1dG9JbnNlcnRSb3cgPSB0cnVlO1xuICB9IGVsc2Uge1xuICAgIG1hcHBlZFNldHRpbmdzLmRpcmVjdGlvbnMgPSBbXTtcbiAgICBtYXBwZWRTZXR0aW5ncy5hdXRvSW5zZXJ0Um93ID0gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIG1hcHBlZFNldHRpbmdzO1xufVxuXG4vLyMgXG59LHtcImhlbHBlcnMvbWl4ZWRcIjo1MSxcImhlbHBlcnMvb2JqZWN0XCI6NTN9XSw2NzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgQ29sdW1uU29ydGluZzoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gQ29sdW1uU29ydGluZztcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLFxuICAgICRfX21vbWVudF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19taXhlZF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X185NV9iYXNlX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3V0aWxzXzQ3X3NvcnRpbmdBbGdvcml0aG1zXzQ3X21lcmdlU29ydF9fO1xudmFyIEhhbmRzb250YWJsZSA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gPSBfZGVyZXFfKFwiYnJvd3NlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9ffSkuZGVmYXVsdDtcbnZhciBtb21lbnQgPSAoJF9fbW9tZW50X18gPSBfZGVyZXFfKFwibW9tZW50XCIpLCAkX19tb21lbnRfXyAmJiAkX19tb21lbnRfXy5fX2VzTW9kdWxlICYmICRfX21vbWVudF9fIHx8IHtkZWZhdWx0OiAkX19tb21lbnRfX30pLmRlZmF1bHQ7XG52YXIgJF9fMiA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSksXG4gICAgYWRkQ2xhc3MgPSAkX18yLmFkZENsYXNzLFxuICAgIGhhc0NsYXNzID0gJF9fMi5oYXNDbGFzcyxcbiAgICByZW1vdmVDbGFzcyA9ICRfXzIucmVtb3ZlQ2xhc3M7XG52YXIgJF9fMyA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gPSBfZGVyZXFfKFwiaGVscGVycy9hcnJheVwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9ffSksXG4gICAgYXJyYXlNYXAgPSAkX18zLmFycmF5TWFwLFxuICAgIGFycmF5UmVkdWNlID0gJF9fMy5hcnJheVJlZHVjZTtcbnZhciBpc0VtcHR5ID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbWl4ZWRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL21peGVkXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19taXhlZF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19taXhlZF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX199KS5pc0VtcHR5O1xudmFyIEJhc2VQbHVnaW4gPSAoJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfXyA9IF9kZXJlcV8oXCJfYmFzZVwiKSwgJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfXyAmJiAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfX30pLmRlZmF1bHQ7XG52YXIgcmVnaXN0ZXJQbHVnaW4gPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fID0gX2RlcmVxXyhcInBsdWdpbnNcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfX30pLnJlZ2lzdGVyUGx1Z2luO1xudmFyIG1lcmdlU29ydCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N191dGlsc180N19zb3J0aW5nQWxnb3JpdGhtc180N19tZXJnZVNvcnRfXyA9IF9kZXJlcV8oXCJ1dGlscy9zb3J0aW5nQWxnb3JpdGhtcy9tZXJnZVNvcnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3V0aWxzXzQ3X3NvcnRpbmdBbGdvcml0aG1zXzQ3X21lcmdlU29ydF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3V0aWxzXzQ3X3NvcnRpbmdBbGdvcml0aG1zXzQ3X21lcmdlU29ydF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfdXRpbHNfNDdfc29ydGluZ0FsZ29yaXRobXNfNDdfbWVyZ2VTb3J0X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3V0aWxzXzQ3X3NvcnRpbmdBbGdvcml0aG1zXzQ3X21lcmdlU29ydF9ffSkubWVyZ2VTb3J0O1xuSGFuZHNvbnRhYmxlLmhvb2tzLnJlZ2lzdGVyKCdiZWZvcmVDb2x1bW5Tb3J0Jyk7XG5IYW5kc29udGFibGUuaG9va3MucmVnaXN0ZXIoJ2FmdGVyQ29sdW1uU29ydCcpO1xudmFyIENvbHVtblNvcnRpbmcgPSBmdW5jdGlvbiBDb2x1bW5Tb3J0aW5nKGhvdEluc3RhbmNlKSB7XG4gICR0cmFjZXVyUnVudGltZS5zdXBlckNvbnN0cnVjdG9yKCRDb2x1bW5Tb3J0aW5nKS5jYWxsKHRoaXMsIGhvdEluc3RhbmNlKTtcbiAgdGhpcy5zb3J0SW5kaWNhdG9ycyA9IFtdO1xuICB0aGlzLmxhc3RTb3J0ZWRDb2x1bW4gPSBudWxsO1xuICB0aGlzLnNvcnRFbXB0eUNlbGxzID0gZmFsc2U7XG59O1xudmFyICRDb2x1bW5Tb3J0aW5nID0gQ29sdW1uU29ydGluZztcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKENvbHVtblNvcnRpbmcsIHtcbiAgaXNFbmFibGVkOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gISEodGhpcy5ob3QuZ2V0U2V0dGluZ3MoKS5jb2x1bW5Tb3J0aW5nKTtcbiAgfSxcbiAgZW5hYmxlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fOCA9IHRoaXM7XG4gICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnNldFBsdWdpbk9wdGlvbnMoKTtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIHRoaXMuaG90LnNvcnRJbmRleCA9IFtdO1xuICAgIHRoaXMuaG90LnNvcnQgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcbiAgICAgIHJldHVybiBfdGhpcy5zb3J0QnlDb2x1bW4uYXBwbHkoX3RoaXMsIGFyZ3MpO1xuICAgIH07XG4gICAgaWYgKHR5cGVvZiB0aGlzLmhvdC5nZXRTZXR0aW5ncygpLm9ic2VydmVDaGFuZ2VzID09PSAndW5kZWZpbmVkJykge1xuICAgICAgdGhpcy5lbmFibGVPYnNlcnZlQ2hhbmdlc1BsdWdpbigpO1xuICAgIH1cbiAgICB0aGlzLmFkZEhvb2soJ2FmdGVyVHJpbVJvdycsIChmdW5jdGlvbihyb3cpIHtcbiAgICAgIHJldHVybiAkX184LnNvcnQoKTtcbiAgICB9KSk7XG4gICAgdGhpcy5hZGRIb29rKCdhZnRlclVudHJpbVJvdycsIChmdW5jdGlvbihyb3cpIHtcbiAgICAgIHJldHVybiAkX184LnNvcnQoKTtcbiAgICB9KSk7XG4gICAgdGhpcy5hZGRIb29rKCdtb2RpZnlSb3cnLCAoZnVuY3Rpb24ocm93KSB7XG4gICAgICByZXR1cm4gJF9fOC50cmFuc2xhdGVSb3cocm93KTtcbiAgICB9KSk7XG4gICAgdGhpcy5hZGRIb29rKCd1bm1vZGlmeVJvdycsIChmdW5jdGlvbihyb3cpIHtcbiAgICAgIHJldHVybiAkX184LnVudHJhbnNsYXRlUm93KHJvdyk7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygnYWZ0ZXJVcGRhdGVTZXR0aW5ncycsIChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX184Lm9uQWZ0ZXJVcGRhdGVTZXR0aW5ncygpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ2FmdGVyR2V0Q29sSGVhZGVyJywgKGZ1bmN0aW9uKGNvbCwgVEgpIHtcbiAgICAgIHJldHVybiAkX184LmdldENvbEhlYWRlcihjb2wsIFRIKTtcbiAgICB9KSk7XG4gICAgdGhpcy5hZGRIb29rKCdhZnRlck9uQ2VsbE1vdXNlRG93bicsIChmdW5jdGlvbihldmVudCwgdGFyZ2V0KSB7XG4gICAgICByZXR1cm4gJF9fOC5vbkFmdGVyT25DZWxsTW91c2VEb3duKGV2ZW50LCB0YXJnZXQpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ2FmdGVyQ3JlYXRlUm93JywgZnVuY3Rpb24oKSB7XG4gICAgICBfdGhpcy5hZnRlckNyZWF0ZVJvdy5hcHBseShfdGhpcywgYXJndW1lbnRzKTtcbiAgICB9KTtcbiAgICB0aGlzLmFkZEhvb2soJ2FmdGVyUmVtb3ZlUm93JywgZnVuY3Rpb24oKSB7XG4gICAgICBfdGhpcy5hZnRlclJlbW92ZVJvdy5hcHBseShfdGhpcywgYXJndW1lbnRzKTtcbiAgICB9KTtcbiAgICB0aGlzLmFkZEhvb2soJ2FmdGVySW5pdCcsIChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX184LnNvcnRCeVNldHRpbmdzKCk7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygnYWZ0ZXJMb2FkRGF0YScsIChmdW5jdGlvbigpIHtcbiAgICAgICRfXzguaG90LnNvcnRJbmRleCA9IFtdO1xuICAgICAgaWYgKCRfXzguaG90LnZpZXcpIHtcbiAgICAgICAgJF9fOC5zb3J0QnlTZXR0aW5ncygpO1xuICAgICAgfVxuICAgIH0pKTtcbiAgICBpZiAodGhpcy5ob3Qudmlldykge1xuICAgICAgdGhpcy5zb3J0QnlTZXR0aW5ncygpO1xuICAgIH1cbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJENvbHVtblNvcnRpbmcucHJvdG90eXBlLCBcImVuYWJsZVBsdWdpblwiKS5jYWxsKHRoaXMpO1xuICB9LFxuICBkaXNhYmxlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmhvdC5zb3J0ID0gdm9pZCAwO1xuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkQ29sdW1uU29ydGluZy5wcm90b3R5cGUsIFwiZGlzYWJsZVBsdWdpblwiKS5jYWxsKHRoaXMpO1xuICB9LFxuICBvbkFmdGVyVXBkYXRlU2V0dGluZ3M6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc29ydEJ5U2V0dGluZ3MoKTtcbiAgfSxcbiAgc29ydEJ5U2V0dGluZ3M6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzb3J0aW5nU2V0dGluZ3MgPSB0aGlzLmhvdC5nZXRTZXR0aW5ncygpLmNvbHVtblNvcnRpbmc7XG4gICAgdmFyIGxvYWRlZFNvcnRpbmdTdGF0ZSA9IHRoaXMubG9hZFNvcnRpbmdTdGF0ZSgpO1xuICAgIHZhciBzb3J0aW5nQ29sdW1uO1xuICAgIHZhciBzb3J0aW5nT3JkZXI7XG4gICAgaWYgKHR5cGVvZiBsb2FkZWRTb3J0aW5nU3RhdGUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBzb3J0aW5nQ29sdW1uID0gc29ydGluZ1NldHRpbmdzLmNvbHVtbjtcbiAgICAgIHNvcnRpbmdPcmRlciA9IHNvcnRpbmdTZXR0aW5ncy5zb3J0T3JkZXI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNvcnRpbmdDb2x1bW4gPSBsb2FkZWRTb3J0aW5nU3RhdGUuc29ydENvbHVtbjtcbiAgICAgIHNvcnRpbmdPcmRlciA9IGxvYWRlZFNvcnRpbmdTdGF0ZS5zb3J0T3JkZXI7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygc29ydGluZ0NvbHVtbiA9PT0gJ251bWJlcicpIHtcbiAgICAgIHRoaXMubGFzdFNvcnRlZENvbHVtbiA9IHNvcnRpbmdDb2x1bW47XG4gICAgICB0aGlzLnNvcnRCeUNvbHVtbihzb3J0aW5nQ29sdW1uLCBzb3J0aW5nT3JkZXIpO1xuICAgIH1cbiAgfSxcbiAgc2V0U29ydGluZ0NvbHVtbjogZnVuY3Rpb24oY29sLCBvcmRlcikge1xuICAgIGlmICh0eXBlb2YgY29sID09ICd1bmRlZmluZWQnKSB7XG4gICAgICB0aGlzLmhvdC5zb3J0Q29sdW1uID0gdm9pZCAwO1xuICAgICAgdGhpcy5ob3Quc29ydE9yZGVyID0gdm9pZCAwO1xuICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSBpZiAodGhpcy5ob3Quc29ydENvbHVtbiA9PT0gY29sICYmIHR5cGVvZiBvcmRlciA9PSAndW5kZWZpbmVkJykge1xuICAgICAgaWYgKHRoaXMuaG90LnNvcnRPcmRlciA9PT0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5ob3Quc29ydE9yZGVyID0gdm9pZCAwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5ob3Quc29ydE9yZGVyID0gIXRoaXMuaG90LnNvcnRPcmRlcjtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5ob3Quc29ydE9yZGVyID0gdHlwZW9mIG9yZGVyID09PSAndW5kZWZpbmVkJyA/IHRydWUgOiBvcmRlcjtcbiAgICB9XG4gICAgdGhpcy5ob3Quc29ydENvbHVtbiA9IGNvbDtcbiAgfSxcbiAgc29ydEJ5Q29sdW1uOiBmdW5jdGlvbihjb2wsIG9yZGVyKSB7XG4gICAgdGhpcy5zZXRTb3J0aW5nQ29sdW1uKGNvbCwgb3JkZXIpO1xuICAgIGlmICh0eXBlb2YgdGhpcy5ob3Quc29ydENvbHVtbiA9PSAndW5kZWZpbmVkJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgYWxsb3dTb3J0aW5nID0gSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bih0aGlzLmhvdCwgJ2JlZm9yZUNvbHVtblNvcnQnLCB0aGlzLmhvdC5zb3J0Q29sdW1uLCB0aGlzLmhvdC5zb3J0T3JkZXIpO1xuICAgIGlmIChhbGxvd1NvcnRpbmcgIT09IGZhbHNlKSB7XG4gICAgICB0aGlzLnNvcnQoKTtcbiAgICB9XG4gICAgdGhpcy51cGRhdGVPcmRlckNsYXNzKCk7XG4gICAgdGhpcy51cGRhdGVTb3J0SW5kaWNhdG9yKCk7XG4gICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bih0aGlzLmhvdCwgJ2FmdGVyQ29sdW1uU29ydCcsIHRoaXMuaG90LnNvcnRDb2x1bW4sIHRoaXMuaG90LnNvcnRPcmRlcik7XG4gICAgdGhpcy5ob3QucmVuZGVyKCk7XG4gICAgdGhpcy5zYXZlU29ydGluZ1N0YXRlKCk7XG4gIH0sXG4gIHNhdmVTb3J0aW5nU3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzb3J0aW5nU3RhdGUgPSB7fTtcbiAgICBpZiAodHlwZW9mIHRoaXMuaG90LnNvcnRDb2x1bW4gIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHNvcnRpbmdTdGF0ZS5zb3J0Q29sdW1uID0gdGhpcy5ob3Quc29ydENvbHVtbjtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiB0aGlzLmhvdC5zb3J0T3JkZXIgIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHNvcnRpbmdTdGF0ZS5zb3J0T3JkZXIgPSB0aGlzLmhvdC5zb3J0T3JkZXI7XG4gICAgfVxuICAgIGlmIChzb3J0aW5nU3RhdGUuaGFzT3duUHJvcGVydHkoJ3NvcnRDb2x1bW4nKSB8fCBzb3J0aW5nU3RhdGUuaGFzT3duUHJvcGVydHkoJ3NvcnRPcmRlcicpKSB7XG4gICAgICBIYW5kc29udGFibGUuaG9va3MucnVuKHRoaXMuaG90LCAncGVyc2lzdGVudFN0YXRlU2F2ZScsICdjb2x1bW5Tb3J0aW5nJywgc29ydGluZ1N0YXRlKTtcbiAgICB9XG4gIH0sXG4gIGxvYWRTb3J0aW5nU3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzdG9yZWRTdGF0ZSA9IHt9O1xuICAgIEhhbmRzb250YWJsZS5ob29rcy5ydW4odGhpcy5ob3QsICdwZXJzaXN0ZW50U3RhdGVMb2FkJywgJ2NvbHVtblNvcnRpbmcnLCBzdG9yZWRTdGF0ZSk7XG4gICAgcmV0dXJuIHN0b3JlZFN0YXRlLnZhbHVlO1xuICB9LFxuICB1cGRhdGVPcmRlckNsYXNzOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgb3JkZXJDbGFzcztcbiAgICBpZiAodGhpcy5ob3Quc29ydE9yZGVyID09PSB0cnVlKSB7XG4gICAgICBvcmRlckNsYXNzID0gJ2FzY2VuZGluZyc7XG4gICAgfSBlbHNlIGlmICh0aGlzLmhvdC5zb3J0T3JkZXIgPT09IGZhbHNlKSB7XG4gICAgICBvcmRlckNsYXNzID0gJ2Rlc2NlbmRpbmcnO1xuICAgIH1cbiAgICB0aGlzLnNvcnRPcmRlckNsYXNzID0gb3JkZXJDbGFzcztcbiAgfSxcbiAgZW5hYmxlT2JzZXJ2ZUNoYW5nZXNQbHVnaW46IGZ1bmN0aW9uKCkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgdGhpcy5ob3QuX3JlZ2lzdGVyVGltZW91dChzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgX3RoaXMuaG90LnVwZGF0ZVNldHRpbmdzKHtvYnNlcnZlQ2hhbmdlczogdHJ1ZX0pO1xuICAgIH0sIDApKTtcbiAgfSxcbiAgZGVmYXVsdFNvcnQ6IGZ1bmN0aW9uKHNvcnRPcmRlciwgY29sdW1uTWV0YSkge1xuICAgIHJldHVybiBmdW5jdGlvbihhLCBiKSB7XG4gICAgICBpZiAodHlwZW9mIGFbMV0gPT0gJ3N0cmluZycpIHtcbiAgICAgICAgYVsxXSA9IGFbMV0udG9Mb3dlckNhc2UoKTtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgYlsxXSA9PSAnc3RyaW5nJykge1xuICAgICAgICBiWzFdID0gYlsxXS50b0xvd2VyQ2FzZSgpO1xuICAgICAgfVxuICAgICAgaWYgKGFbMV0gPT09IGJbMV0pIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9XG4gICAgICBpZiAoaXNFbXB0eShhWzFdKSkge1xuICAgICAgICBpZiAoaXNFbXB0eShiWzFdKSkge1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb2x1bW5NZXRhLmNvbHVtblNvcnRpbmcuc29ydEVtcHR5Q2VsbHMpIHtcbiAgICAgICAgICByZXR1cm4gc29ydE9yZGVyID8gLTEgOiAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAxO1xuICAgICAgfVxuICAgICAgaWYgKGlzRW1wdHkoYlsxXSkpIHtcbiAgICAgICAgaWYgKGlzRW1wdHkoYVsxXSkpIHtcbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29sdW1uTWV0YS5jb2x1bW5Tb3J0aW5nLnNvcnRFbXB0eUNlbGxzKSB7XG4gICAgICAgICAgcmV0dXJuIHNvcnRPcmRlciA/IDEgOiAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgICB9XG4gICAgICBpZiAoaXNOYU4oYVsxXSkgJiYgIWlzTmFOKGJbMV0pKSB7XG4gICAgICAgIHJldHVybiBzb3J0T3JkZXIgPyAxIDogLTE7XG4gICAgICB9IGVsc2UgaWYgKCFpc05hTihhWzFdKSAmJiBpc05hTihiWzFdKSkge1xuICAgICAgICByZXR1cm4gc29ydE9yZGVyID8gLTEgOiAxO1xuICAgICAgfSBlbHNlIGlmICghKGlzTmFOKGFbMV0pIHx8IGlzTmFOKGJbMV0pKSkge1xuICAgICAgICBhWzFdID0gcGFyc2VGbG9hdChhWzFdKTtcbiAgICAgICAgYlsxXSA9IHBhcnNlRmxvYXQoYlsxXSk7XG4gICAgICB9XG4gICAgICBpZiAoYVsxXSA8IGJbMV0pIHtcbiAgICAgICAgcmV0dXJuIHNvcnRPcmRlciA/IC0xIDogMTtcbiAgICAgIH1cbiAgICAgIGlmIChhWzFdID4gYlsxXSkge1xuICAgICAgICByZXR1cm4gc29ydE9yZGVyID8gMSA6IC0xO1xuICAgICAgfVxuICAgICAgcmV0dXJuIDA7XG4gICAgfTtcbiAgfSxcbiAgZGF0ZVNvcnQ6IGZ1bmN0aW9uKHNvcnRPcmRlciwgY29sdW1uTWV0YSkge1xuICAgIHJldHVybiBmdW5jdGlvbihhLCBiKSB7XG4gICAgICBpZiAoYVsxXSA9PT0gYlsxXSkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICAgIH1cbiAgICAgIGlmIChpc0VtcHR5KGFbMV0pKSB7XG4gICAgICAgIGlmIChpc0VtcHR5KGJbMV0pKSB7XG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbHVtbk1ldGEuY29sdW1uU29ydGluZy5zb3J0RW1wdHlDZWxscykge1xuICAgICAgICAgIHJldHVybiBzb3J0T3JkZXIgPyAtMSA6IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDE7XG4gICAgICB9XG4gICAgICBpZiAoaXNFbXB0eShiWzFdKSkge1xuICAgICAgICBpZiAoaXNFbXB0eShhWzFdKSkge1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb2x1bW5NZXRhLmNvbHVtblNvcnRpbmcuc29ydEVtcHR5Q2VsbHMpIHtcbiAgICAgICAgICByZXR1cm4gc29ydE9yZGVyID8gMSA6IC0xO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICAgIH1cbiAgICAgIHZhciBhRGF0ZSA9IG1vbWVudChhWzFdLCBjb2x1bW5NZXRhLmRhdGVGb3JtYXQpO1xuICAgICAgdmFyIGJEYXRlID0gbW9tZW50KGJbMV0sIGNvbHVtbk1ldGEuZGF0ZUZvcm1hdCk7XG4gICAgICBpZiAoIWFEYXRlLmlzVmFsaWQoKSkge1xuICAgICAgICByZXR1cm4gMTtcbiAgICAgIH1cbiAgICAgIGlmICghYkRhdGUuaXNWYWxpZCgpKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICAgIH1cbiAgICAgIGlmIChiRGF0ZS5pc0FmdGVyKGFEYXRlKSkge1xuICAgICAgICByZXR1cm4gc29ydE9yZGVyID8gLTEgOiAxO1xuICAgICAgfVxuICAgICAgaWYgKGJEYXRlLmlzQmVmb3JlKGFEYXRlKSkge1xuICAgICAgICByZXR1cm4gc29ydE9yZGVyID8gMSA6IC0xO1xuICAgICAgfVxuICAgICAgcmV0dXJuIDA7XG4gICAgfTtcbiAgfSxcbiAgbnVtZXJpY1NvcnQ6IGZ1bmN0aW9uKHNvcnRPcmRlciwgY29sdW1uTWV0YSkge1xuICAgIHJldHVybiBmdW5jdGlvbihhLCBiKSB7XG4gICAgICB2YXIgcGFyc2VkQSA9IHBhcnNlRmxvYXQoYVsxXSk7XG4gICAgICB2YXIgcGFyc2VkQiA9IHBhcnNlRmxvYXQoYlsxXSk7XG4gICAgICBpZiAocGFyc2VkQSA9PT0gcGFyc2VkQiB8fCAoaXNOYU4ocGFyc2VkQSkgJiYgaXNOYU4ocGFyc2VkQikpKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgICAgfVxuICAgICAgaWYgKGNvbHVtbk1ldGEuY29sdW1uU29ydGluZy5zb3J0RW1wdHlDZWxscykge1xuICAgICAgICBpZiAoaXNFbXB0eShhWzFdKSkge1xuICAgICAgICAgIHJldHVybiBzb3J0T3JkZXIgPyAtMSA6IDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzRW1wdHkoYlsxXSkpIHtcbiAgICAgICAgICByZXR1cm4gc29ydE9yZGVyID8gMSA6IC0xO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoaXNOYU4ocGFyc2VkQSkpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgICB9XG4gICAgICBpZiAoaXNOYU4ocGFyc2VkQikpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgfVxuICAgICAgaWYgKHBhcnNlZEEgPCBwYXJzZWRCKSB7XG4gICAgICAgIHJldHVybiBzb3J0T3JkZXIgPyAtMSA6IDE7XG4gICAgICB9IGVsc2UgaWYgKHBhcnNlZEEgPiBwYXJzZWRCKSB7XG4gICAgICAgIHJldHVybiBzb3J0T3JkZXIgPyAxIDogLTE7XG4gICAgICB9XG4gICAgICByZXR1cm4gMDtcbiAgICB9O1xuICB9LFxuICBzb3J0OiBmdW5jdGlvbigpIHtcbiAgICBpZiAodHlwZW9mIHRoaXMuaG90LnNvcnRPcmRlciA9PSAndW5kZWZpbmVkJykge1xuICAgICAgdGhpcy5ob3Quc29ydEluZGV4Lmxlbmd0aCA9IDA7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBjb2xNZXRhID0gdGhpcy5ob3QuZ2V0Q2VsbE1ldGEoMCwgdGhpcy5ob3Quc29ydENvbHVtbik7XG4gICAgdmFyIGVtcHR5Um93cyA9IHRoaXMuaG90LmNvdW50RW1wdHlSb3dzKCk7XG4gICAgdmFyIHNvcnRGdW5jdGlvbjtcbiAgICB2YXIgbnJPZlJvd3M7XG4gICAgdGhpcy5ob3Quc29ydGluZ0VuYWJsZWQgPSBmYWxzZTtcbiAgICB0aGlzLmhvdC5zb3J0SW5kZXgubGVuZ3RoID0gMDtcbiAgICBpZiAodHlwZW9mIGNvbE1ldGEuY29sdW1uU29ydGluZy5zb3J0RW1wdHlDZWxscyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGNvbE1ldGEuY29sdW1uU29ydGluZyA9IHtzb3J0RW1wdHlDZWxsczogdGhpcy5zb3J0RW1wdHlDZWxsc307XG4gICAgfVxuICAgIGlmICh0aGlzLmhvdC5nZXRTZXR0aW5ncygpLm1heFJvd3MgPT09IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSkge1xuICAgICAgbnJPZlJvd3MgPSB0aGlzLmhvdC5jb3VudFJvd3MoKSAtIHRoaXMuaG90LmdldFNldHRpbmdzKCkubWluU3BhcmVSb3dzO1xuICAgIH0gZWxzZSB7XG4gICAgICBuck9mUm93cyA9IHRoaXMuaG90LmNvdW50Um93cygpIC0gZW1wdHlSb3dzO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMCxcbiAgICAgICAgaWxlbiA9IG5yT2ZSb3dzOyBpIDwgaWxlbjsgaSsrKSB7XG4gICAgICB0aGlzLmhvdC5zb3J0SW5kZXgucHVzaChbaSwgdGhpcy5ob3QuZ2V0RGF0YUF0Q2VsbChpLCB0aGlzLmhvdC5zb3J0Q29sdW1uKV0pO1xuICAgIH1cbiAgICBpZiAoY29sTWV0YS5zb3J0RnVuY3Rpb24pIHtcbiAgICAgIHNvcnRGdW5jdGlvbiA9IGNvbE1ldGEuc29ydEZ1bmN0aW9uO1xuICAgIH0gZWxzZSB7XG4gICAgICBzd2l0Y2ggKGNvbE1ldGEudHlwZSkge1xuICAgICAgICBjYXNlICdkYXRlJzpcbiAgICAgICAgICBzb3J0RnVuY3Rpb24gPSB0aGlzLmRhdGVTb3J0O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdudW1lcmljJzpcbiAgICAgICAgICBzb3J0RnVuY3Rpb24gPSB0aGlzLm51bWVyaWNTb3J0O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHNvcnRGdW5jdGlvbiA9IHRoaXMuZGVmYXVsdFNvcnQ7XG4gICAgICB9XG4gICAgfVxuICAgIG1lcmdlU29ydCh0aGlzLmhvdC5zb3J0SW5kZXgsIHNvcnRGdW5jdGlvbih0aGlzLmhvdC5zb3J0T3JkZXIsIGNvbE1ldGEpKTtcbiAgICBmb3IgKHZhciBpJF9fMTAgPSB0aGlzLmhvdC5zb3J0SW5kZXgubGVuZ3RoOyBpJF9fMTAgPCB0aGlzLmhvdC5jb3VudFJvd3MoKTsgaSRfXzEwKyspIHtcbiAgICAgIHRoaXMuaG90LnNvcnRJbmRleC5wdXNoKFtpJF9fMTAsIHRoaXMuaG90LmdldERhdGFBdENlbGwoaSRfXzEwLCB0aGlzLmhvdC5zb3J0Q29sdW1uKV0pO1xuICAgIH1cbiAgICB0aGlzLmhvdC5zb3J0aW5nRW5hYmxlZCA9IHRydWU7XG4gIH0sXG4gIHVwZGF0ZVNvcnRJbmRpY2F0b3I6IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0eXBlb2YgdGhpcy5ob3Quc29ydE9yZGVyID09ICd1bmRlZmluZWQnKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBjb2xNZXRhID0gdGhpcy5ob3QuZ2V0Q2VsbE1ldGEoMCwgdGhpcy5ob3Quc29ydENvbHVtbik7XG4gICAgdGhpcy5zb3J0SW5kaWNhdG9yc1t0aGlzLmhvdC5zb3J0Q29sdW1uXSA9IGNvbE1ldGEuc29ydEluZGljYXRvcjtcbiAgfSxcbiAgdHJhbnNsYXRlUm93OiBmdW5jdGlvbihyb3cpIHtcbiAgICBpZiAodGhpcy5ob3Quc29ydGluZ0VuYWJsZWQgJiYgKHR5cGVvZiB0aGlzLmhvdC5zb3J0T3JkZXIgIT09ICd1bmRlZmluZWQnKSAmJiB0aGlzLmhvdC5zb3J0SW5kZXggJiYgdGhpcy5ob3Quc29ydEluZGV4Lmxlbmd0aCAmJiB0aGlzLmhvdC5zb3J0SW5kZXhbcm93XSkge1xuICAgICAgcmV0dXJuIHRoaXMuaG90LnNvcnRJbmRleFtyb3ddWzBdO1xuICAgIH1cbiAgICByZXR1cm4gcm93O1xuICB9LFxuICB1bnRyYW5zbGF0ZVJvdzogZnVuY3Rpb24ocm93KSB7XG4gICAgaWYgKHRoaXMuaG90LnNvcnRpbmdFbmFibGVkICYmIHRoaXMuaG90LnNvcnRJbmRleCAmJiB0aGlzLmhvdC5zb3J0SW5kZXgubGVuZ3RoKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuaG90LnNvcnRJbmRleC5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAodGhpcy5ob3Quc29ydEluZGV4W2ldWzBdID09IHJvdykge1xuICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBnZXRDb2xIZWFkZXI6IGZ1bmN0aW9uKGNvbCwgVEgpIHtcbiAgICBpZiAoY29sIDwgMCB8fCAhVEgucGFyZW50Tm9kZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgaGVhZGVyTGluayA9IFRILnF1ZXJ5U2VsZWN0b3IoJy5jb2xIZWFkZXInKTtcbiAgICB2YXIgY29sc3BhbiA9IFRILmdldEF0dHJpYnV0ZSgnY29sc3BhbicpO1xuICAgIHZhciBUUnMgPSBUSC5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2hpbGROb2RlcztcbiAgICB2YXIgaGVhZGVyTGV2ZWwgPSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKFRScywgVEgucGFyZW50Tm9kZSk7XG4gICAgaGVhZGVyTGV2ZWwgPSBoZWFkZXJMZXZlbCAtIFRScy5sZW5ndGg7XG4gICAgaWYgKCFoZWFkZXJMaW5rKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0aGlzLmhvdC5nZXRTZXR0aW5ncygpLmNvbHVtblNvcnRpbmcgJiYgY29sID49IDAgJiYgaGVhZGVyTGV2ZWwgPT09IC0xKSB7XG4gICAgICBhZGRDbGFzcyhoZWFkZXJMaW5rLCAnY29sdW1uU29ydGluZycpO1xuICAgIH1cbiAgICByZW1vdmVDbGFzcyhoZWFkZXJMaW5rLCAnZGVzY2VuZGluZycpO1xuICAgIHJlbW92ZUNsYXNzKGhlYWRlckxpbmssICdhc2NlbmRpbmcnKTtcbiAgICBpZiAodGhpcy5zb3J0SW5kaWNhdG9yc1tjb2xdKSB7XG4gICAgICBpZiAoY29sID09PSB0aGlzLmhvdC5zb3J0Q29sdW1uKSB7XG4gICAgICAgIGlmICh0aGlzLnNvcnRPcmRlckNsYXNzID09PSAnYXNjZW5kaW5nJykge1xuICAgICAgICAgIGFkZENsYXNzKGhlYWRlckxpbmssICdhc2NlbmRpbmcnKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNvcnRPcmRlckNsYXNzID09PSAnZGVzY2VuZGluZycpIHtcbiAgICAgICAgICBhZGRDbGFzcyhoZWFkZXJMaW5rLCAnZGVzY2VuZGluZycpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBpc1NvcnRlZDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB0aGlzLmhvdC5zb3J0Q29sdW1uICE9ICd1bmRlZmluZWQnO1xuICB9LFxuICBhZnRlckNyZWF0ZVJvdzogZnVuY3Rpb24oaW5kZXgsIGFtb3VudCkge1xuICAgIGlmICghdGhpcy5pc1NvcnRlZCgpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ob3Quc29ydEluZGV4Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5ob3Quc29ydEluZGV4W2ldWzBdID49IGluZGV4KSB7XG4gICAgICAgIHRoaXMuaG90LnNvcnRJbmRleFtpXVswXSArPSBhbW91bnQ7XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW1vdW50OyBpKyspIHtcbiAgICAgIHRoaXMuaG90LnNvcnRJbmRleC5zcGxpY2UoaW5kZXggKyBpLCAwLCBbaW5kZXggKyBpLCB0aGlzLmhvdC5nZXRTb3VyY2VEYXRhKClbaW5kZXggKyBpXVt0aGlzLmhvdC5zb3J0Q29sdW1uICsgdGhpcy5ob3QuY29sT2Zmc2V0KCldXSk7XG4gICAgfVxuICAgIHRoaXMuc2F2ZVNvcnRpbmdTdGF0ZSgpO1xuICB9LFxuICBhZnRlclJlbW92ZVJvdzogZnVuY3Rpb24oaW5kZXgsIGFtb3VudCkge1xuICAgIGlmICghdGhpcy5pc1NvcnRlZCgpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciByZW1vdmVkUm93cyA9IHRoaXMuaG90LnNvcnRJbmRleC5zcGxpY2UoaW5kZXgsIGFtb3VudCk7XG4gICAgcmVtb3ZlZFJvd3MgPSBhcnJheU1hcChyZW1vdmVkUm93cywgKGZ1bmN0aW9uKHJvdykge1xuICAgICAgcmV0dXJuIHJvd1swXTtcbiAgICB9KSk7XG4gICAgZnVuY3Rpb24gY291bnRSb3dTaGlmdChsb2dpY2FsUm93KSB7XG4gICAgICByZXR1cm4gYXJyYXlSZWR1Y2UocmVtb3ZlZFJvd3MsIChmdW5jdGlvbihjb3VudCwgcmVtb3ZlZExvZ2ljYWxSb3cpIHtcbiAgICAgICAgaWYgKGxvZ2ljYWxSb3cgPiByZW1vdmVkTG9naWNhbFJvdykge1xuICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgICAgfSksIDApO1xuICAgIH1cbiAgICB0aGlzLmhvdC5zb3J0SW5kZXggPSBhcnJheU1hcCh0aGlzLmhvdC5zb3J0SW5kZXgsIChmdW5jdGlvbihsb2dpY2FsUm93LCBwaHlzaWNhbFJvdykge1xuICAgICAgdmFyIHJvd1NoaWZ0ID0gY291bnRSb3dTaGlmdChsb2dpY2FsUm93WzBdKTtcbiAgICAgIGlmIChyb3dTaGlmdCkge1xuICAgICAgICBsb2dpY2FsUm93WzBdIC09IHJvd1NoaWZ0O1xuICAgICAgfVxuICAgICAgcmV0dXJuIGxvZ2ljYWxSb3c7XG4gICAgfSkpO1xuICAgIHRoaXMuc2F2ZVNvcnRpbmdTdGF0ZSgpO1xuICB9LFxuICBzZXRQbHVnaW5PcHRpb25zOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgY29sdW1uU29ydGluZyA9IHRoaXMuaG90LmdldFNldHRpbmdzKCkuY29sdW1uU29ydGluZztcbiAgICBpZiAodHlwZW9mIGNvbHVtblNvcnRpbmcgPT09ICdvYmplY3QnKSB7XG4gICAgICB0aGlzLnNvcnRFbXB0eUNlbGxzID0gY29sdW1uU29ydGluZy5zb3J0RW1wdHlDZWxscyB8fCBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zb3J0RW1wdHlDZWxscyA9IGZhbHNlO1xuICAgIH1cbiAgfSxcbiAgb25BZnRlck9uQ2VsbE1vdXNlRG93bjogZnVuY3Rpb24oZXZlbnQsIGNvb3Jkcykge1xuICAgIGlmIChjb29yZHMucm93ID4gLTEpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGhhc0NsYXNzKGV2ZW50LnJlYWxUYXJnZXQsICdjb2x1bW5Tb3J0aW5nJykpIHtcbiAgICAgIGlmIChjb29yZHMuY29sICE9PSB0aGlzLmxhc3RTb3J0ZWRDb2x1bW4pIHtcbiAgICAgICAgdGhpcy5ob3Quc29ydE9yZGVyID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHRoaXMubGFzdFNvcnRlZENvbHVtbiA9IGNvb3Jkcy5jb2w7XG4gICAgICB0aGlzLnNvcnRCeUNvbHVtbihjb29yZHMuY29sKTtcbiAgICB9XG4gIH1cbn0sIHt9LCBCYXNlUGx1Z2luKTtcbjtcbnJlZ2lzdGVyUGx1Z2luKCdjb2x1bW5Tb3J0aW5nJywgQ29sdW1uU29ydGluZyk7XG5cbi8vIyBcbn0se1wiX2Jhc2VcIjo2MixcImJyb3dzZXJcIjoyNCxcImhlbHBlcnMvYXJyYXlcIjo0MyxcImhlbHBlcnMvZG9tL2VsZW1lbnRcIjo0NyxcImhlbHBlcnMvbWl4ZWRcIjo1MSxcIm1vbWVudFwiOlwibW9tZW50XCIsXCJwbHVnaW5zXCI6NjEsXCJ1dGlscy9zb3J0aW5nQWxnb3JpdGhtcy9tZXJnZVNvcnRcIjoxMzJ9XSw2ODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgQ29tbWVudEVkaXRvcjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gQ29tbWVudEVkaXRvcjtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fO1xudmFyIGFkZENsYXNzID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9lbGVtZW50XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X199KS5hZGRDbGFzcztcbnZhciBDb21tZW50RWRpdG9yID0gZnVuY3Rpb24gQ29tbWVudEVkaXRvcigpIHtcbiAgdGhpcy5lZGl0b3IgPSB0aGlzLmNyZWF0ZUVkaXRvcigpO1xuICB0aGlzLmVkaXRvclN0eWxlID0gdGhpcy5lZGl0b3Iuc3R5bGU7XG4gIHRoaXMuaGlkZGVuID0gdHJ1ZTtcbiAgdGhpcy5oaWRlKCk7XG59O1xudmFyICRDb21tZW50RWRpdG9yID0gQ29tbWVudEVkaXRvcjtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKENvbW1lbnRFZGl0b3IsIHtcbiAgc2V0UG9zaXRpb246IGZ1bmN0aW9uKHgsIHkpIHtcbiAgICB0aGlzLmVkaXRvclN0eWxlLmxlZnQgPSB4ICsgJ3B4JztcbiAgICB0aGlzLmVkaXRvclN0eWxlLnRvcCA9IHkgKyAncHgnO1xuICB9LFxuICBzZXRTaXplOiBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0KSB7XG4gICAgaWYgKHdpZHRoICYmIGhlaWdodCkge1xuICAgICAgdmFyIGlucHV0ID0gdGhpcy5nZXRJbnB1dEVsZW1lbnQoKTtcbiAgICAgIGlucHV0LnN0eWxlLndpZHRoID0gd2lkdGggKyAncHgnO1xuICAgICAgaW5wdXQuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgJ3B4JztcbiAgICB9XG4gIH0sXG4gIHJlc2V0U2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGlucHV0ID0gdGhpcy5nZXRJbnB1dEVsZW1lbnQoKTtcbiAgICBpbnB1dC5zdHlsZS53aWR0aCA9ICcnO1xuICAgIGlucHV0LnN0eWxlLmhlaWdodCA9ICcnO1xuICB9LFxuICBzZXRSZWFkT25seVN0YXRlOiBmdW5jdGlvbihzdGF0ZSkge1xuICAgIHZhciBpbnB1dCA9IHRoaXMuZ2V0SW5wdXRFbGVtZW50KCk7XG4gICAgaW5wdXQucmVhZE9ubHkgPSBzdGF0ZTtcbiAgfSxcbiAgc2hvdzogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5lZGl0b3JTdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICB0aGlzLmhpZGRlbiA9IGZhbHNlO1xuICB9LFxuICBoaWRlOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmVkaXRvclN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgdGhpcy5oaWRkZW4gPSB0cnVlO1xuICB9LFxuICBpc1Zpc2libGU6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmVkaXRvclN0eWxlLmRpc3BsYXkgPT09ICdibG9jayc7XG4gIH0sXG4gIHNldFZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgdmFsdWUgPSBhcmd1bWVudHNbMF0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzBdIDogJyc7XG4gICAgdmFsdWUgPSB2YWx1ZSB8fCAnJztcbiAgICB0aGlzLmdldElucHV0RWxlbWVudCgpLnZhbHVlID0gdmFsdWU7XG4gIH0sXG4gIGdldFZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRJbnB1dEVsZW1lbnQoKS52YWx1ZTtcbiAgfSxcbiAgaXNGb2N1c2VkOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gdGhpcy5nZXRJbnB1dEVsZW1lbnQoKTtcbiAgfSxcbiAgZm9jdXM6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuZ2V0SW5wdXRFbGVtZW50KCkuZm9jdXMoKTtcbiAgfSxcbiAgY3JlYXRlRWRpdG9yOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicgKyAkQ29tbWVudEVkaXRvci5DTEFTU19FRElUT1JfQ09OVEFJTkVSKTtcbiAgICB2YXIgZWRpdG9yO1xuICAgIHZhciB0ZXh0QXJlYTtcbiAgICBpZiAoIWNvbnRhaW5lcikge1xuICAgICAgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBhZGRDbGFzcyhjb250YWluZXIsICRDb21tZW50RWRpdG9yLkNMQVNTX0VESVRPUl9DT05UQUlORVIpO1xuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuICAgIH1cbiAgICBlZGl0b3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBhZGRDbGFzcyhlZGl0b3IsICRDb21tZW50RWRpdG9yLkNMQVNTX0VESVRPUik7XG4gICAgdGV4dEFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpO1xuICAgIGFkZENsYXNzKHRleHRBcmVhLCAkQ29tbWVudEVkaXRvci5DTEFTU19JTlBVVCk7XG4gICAgZWRpdG9yLmFwcGVuZENoaWxkKHRleHRBcmVhKTtcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoZWRpdG9yKTtcbiAgICByZXR1cm4gZWRpdG9yO1xuICB9LFxuICBnZXRJbnB1dEVsZW1lbnQ6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmVkaXRvci5xdWVyeVNlbGVjdG9yKCcuJyArICRDb21tZW50RWRpdG9yLkNMQVNTX0lOUFVUKTtcbiAgfSxcbiAgZGVzdHJveTogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5lZGl0b3IucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmVkaXRvcik7XG4gICAgdGhpcy5lZGl0b3IgPSBudWxsO1xuICAgIHRoaXMuZWRpdG9yU3R5bGUgPSBudWxsO1xuICB9XG59LCB7XG4gIGdldCBDTEFTU19FRElUT1JfQ09OVEFJTkVSKCkge1xuICAgIHJldHVybiAnaHRDb21tZW50c0NvbnRhaW5lcic7XG4gIH0sXG4gIGdldCBDTEFTU19FRElUT1IoKSB7XG4gICAgcmV0dXJuICdodENvbW1lbnRzJztcbiAgfSxcbiAgZ2V0IENMQVNTX0lOUFVUKCkge1xuICAgIHJldHVybiAnaHRDb21tZW50VGV4dEFyZWEnO1xuICB9LFxuICBnZXQgQ0xBU1NfQ0VMTCgpIHtcbiAgICByZXR1cm4gJ2h0Q29tbWVudENlbGwnO1xuICB9XG59KTtcbjtcblxuLy8jIFxufSx7XCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDd9XSw2OTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbnZhciAkX18xMztcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgQ29tbWVudHM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIENvbW1lbnRzO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19mdW5jdGlvbl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyxcbiAgICAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fLFxuICAgICRfX2NvbW1lbnRFZGl0b3JfXyxcbiAgICAkX19fNDZfXzQ2X180N19jb250ZXh0TWVudV80N191dGlsc19fO1xudmFyIEhhbmRzb250YWJsZSA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gPSBfZGVyZXFfKFwiYnJvd3NlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9ffSkuZGVmYXVsdDtcbnZhciAkX18xID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9lbGVtZW50XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X199KSxcbiAgICBhZGRDbGFzcyA9ICRfXzEuYWRkQ2xhc3MsXG4gICAgY2xvc2VzdCA9ICRfXzEuY2xvc2VzdCxcbiAgICBpc0NoaWxkT2YgPSAkX18xLmlzQ2hpbGRPZixcbiAgICBoYXNDbGFzcyA9ICRfXzEuaGFzQ2xhc3MsXG4gICAgb2Zmc2V0ID0gJF9fMS5vZmZzZXQsXG4gICAgb3V0ZXJXaWR0aCA9ICRfXzEub3V0ZXJXaWR0aCxcbiAgICBvdXRlckhlaWdodCA9ICRfXzEub3V0ZXJIZWlnaHQsXG4gICAgZ2V0U2Nyb2xsYWJsZUVsZW1lbnQgPSAkX18xLmdldFNjcm9sbGFibGVFbGVtZW50O1xudmFyICRfXzIgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL29iamVjdFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfX30pLFxuICAgIGRlZXBDbG9uZSA9ICRfXzIuZGVlcENsb25lLFxuICAgIGRlZXBFeHRlbmQgPSAkX18yLmRlZXBFeHRlbmQ7XG52YXIgZGVib3VuY2UgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19mdW5jdGlvbl9fID0gX2RlcmVxXyhcImhlbHBlcnMvZnVuY3Rpb25cIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZnVuY3Rpb25fXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Z1bmN0aW9uX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Z1bmN0aW9uX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZnVuY3Rpb25fX30pLmRlYm91bmNlO1xudmFyIEV2ZW50TWFuYWdlciA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyA9IF9kZXJlcV8oXCJldmVudE1hbmFnZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9ffSkuRXZlbnRNYW5hZ2VyO1xudmFyIFdhbGtvbnRhYmxlQ2VsbENvb3JkcyA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2VsbF80N19jb29yZHNfXyA9IF9kZXJlcV8oXCIzcmRwYXJ0eS93YWxrb250YWJsZS9zcmMvY2VsbC9jb29yZHNcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19ffSkuV2Fsa29udGFibGVDZWxsQ29vcmRzO1xudmFyIHJlZ2lzdGVyUGx1Z2luID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyA9IF9kZXJlcV8oXCJwbHVnaW5zXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX199KS5yZWdpc3RlclBsdWdpbjtcbnZhciBCYXNlUGx1Z2luID0gKCRfX180Nl9fNDZfXzQ3X185NV9iYXNlX18gPSBfZGVyZXFfKFwiX2Jhc2VcIiksICRfX180Nl9fNDZfXzQ3X185NV9iYXNlX18gJiYgJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X185NV9iYXNlX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X185NV9iYXNlX199KS5kZWZhdWx0O1xudmFyIENvbW1lbnRFZGl0b3IgPSAoJF9fY29tbWVudEVkaXRvcl9fID0gX2RlcmVxXyhcImNvbW1lbnRFZGl0b3JcIiksICRfX2NvbW1lbnRFZGl0b3JfXyAmJiAkX19jb21tZW50RWRpdG9yX18uX19lc01vZHVsZSAmJiAkX19jb21tZW50RWRpdG9yX18gfHwge2RlZmF1bHQ6ICRfX2NvbW1lbnRFZGl0b3JfX30pLkNvbW1lbnRFZGl0b3I7XG52YXIgJF9fOSA9ICgkX19fNDZfXzQ2X180N19jb250ZXh0TWVudV80N191dGlsc19fID0gX2RlcmVxXyhcImNvbnRleHRNZW51L3V0aWxzXCIpLCAkX19fNDZfXzQ2X180N19jb250ZXh0TWVudV80N191dGlsc19fICYmICRfX180Nl9fNDZfXzQ3X2NvbnRleHRNZW51XzQ3X3V0aWxzX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19jb250ZXh0TWVudV80N191dGlsc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19jb250ZXh0TWVudV80N191dGlsc19ffSksXG4gICAgY2hlY2tTZWxlY3Rpb25Db25zaXN0ZW5jeSA9ICRfXzkuY2hlY2tTZWxlY3Rpb25Db25zaXN0ZW5jeSxcbiAgICBtYXJrTGFiZWxBc1NlbGVjdGVkID0gJF9fOS5tYXJrTGFiZWxBc1NlbGVjdGVkO1xudmFyIHByaXZhdGVQb29sID0gbmV3IFdlYWtNYXAoKTtcbnZhciBNRVRBX0NPTU1FTlQgPSAnY29tbWVudCc7XG52YXIgTUVUQV9DT01NRU5UX1ZBTFVFID0gJ3ZhbHVlJztcbnZhciBNRVRBX1NUWUxFID0gJ3N0eWxlJztcbnZhciBNRVRBX1JFQURPTkxZID0gJ3JlYWRPbmx5JztcbnZhciBDb21tZW50cyA9IGZ1bmN0aW9uIENvbW1lbnRzKGhvdEluc3RhbmNlKSB7XG4gICR0cmFjZXVyUnVudGltZS5zdXBlckNvbnN0cnVjdG9yKCRDb21tZW50cykuY2FsbCh0aGlzLCBob3RJbnN0YW5jZSk7XG4gIHRoaXMuZWRpdG9yID0gbnVsbDtcbiAgdGhpcy5ldmVudE1hbmFnZXIgPSBudWxsO1xuICB0aGlzLnJhbmdlID0ge307XG4gIHRoaXMubW91c2VEb3duID0gZmFsc2U7XG4gIHRoaXMuY29udGV4dE1lbnVFdmVudCA9IGZhbHNlO1xuICB0aGlzLnRpbWVyID0gbnVsbDtcbiAgdGhpcy5kaXNwbGF5RGVsYXkgPSAyNTA7XG4gIHByaXZhdGVQb29sLnNldCh0aGlzLCB7XG4gICAgdGVtcEVkaXRvckRpbWVuc2lvbnM6IHt9LFxuICAgIGNlbGxCZWxvd0N1cnNvcjogbnVsbFxuICB9KTtcbn07XG52YXIgJENvbW1lbnRzID0gQ29tbWVudHM7XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShDb21tZW50cywgKCRfXzEzID0ge30sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgXCJpc0VuYWJsZWRcIiwge1xuICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuICEhdGhpcy5ob3QuZ2V0U2V0dGluZ3MoKS5jb21tZW50cztcbiAgfSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgXCJlbmFibGVQbHVnaW5cIiwge1xuICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzEwID0gdGhpcztcbiAgICBpZiAodGhpcy5lbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICghdGhpcy5lZGl0b3IpIHtcbiAgICAgIHRoaXMuZWRpdG9yID0gbmV3IENvbW1lbnRFZGl0b3IoKTtcbiAgICB9XG4gICAgaWYgKCF0aGlzLmV2ZW50TWFuYWdlcikge1xuICAgICAgdGhpcy5ldmVudE1hbmFnZXIgPSBuZXcgRXZlbnRNYW5hZ2VyKHRoaXMpO1xuICAgIH1cbiAgICB0aGlzLmFkZEhvb2soJ2FmdGVyQ29udGV4dE1lbnVEZWZhdWx0T3B0aW9ucycsIChmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICByZXR1cm4gJF9fMTAuYWRkVG9Db250ZXh0TWVudShvcHRpb25zKTtcbiAgICB9KSk7XG4gICAgdGhpcy5hZGRIb29rKCdhZnRlclJlbmRlcmVyJywgKGZ1bmN0aW9uKFRELCByb3csIGNvbCwgcHJvcCwgdmFsdWUsIGNlbGxQcm9wZXJ0aWVzKSB7XG4gICAgICByZXR1cm4gJF9fMTAub25BZnRlclJlbmRlcmVyKFRELCBjZWxsUHJvcGVydGllcyk7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygnYWZ0ZXJTY3JvbGxIb3Jpem9udGFsbHknLCAoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fMTAuaGlkZSgpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ2FmdGVyU2Nyb2xsVmVydGljYWxseScsIChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX18xMC5oaWRlKCk7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygnYWZ0ZXJCZWdpbkVkaXRpbmcnLCAoZnVuY3Rpb24oYXJncykge1xuICAgICAgcmV0dXJuICRfXzEwLm9uQWZ0ZXJCZWdpbkVkaXRpbmcoYXJncyk7XG4gICAgfSkpO1xuICAgIHRoaXMucmVnaXN0ZXJMaXN0ZW5lcnMoKTtcbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJENvbW1lbnRzLnByb3RvdHlwZSwgXCJlbmFibGVQbHVnaW5cIikuY2FsbCh0aGlzKTtcbiAgfSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgXCJkaXNhYmxlUGx1Z2luXCIsIHtcbiAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkQ29tbWVudHMucHJvdG90eXBlLCBcImRpc2FibGVQbHVnaW5cIikuY2FsbCh0aGlzKTtcbiAgfSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgXCJyZWdpc3Rlckxpc3RlbmVyc1wiLCB7XG4gIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fMTAgPSB0aGlzO1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQsICdtb3VzZW92ZXInLCAoZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHJldHVybiAkX18xMC5vbk1vdXNlT3ZlcihldmVudCk7XG4gICAgfSkpO1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQsICdtb3VzZWRvd24nLCAoZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHJldHVybiAkX18xMC5vbk1vdXNlRG93bihldmVudCk7XG4gICAgfSkpO1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQsICdtb3VzZXVwJywgKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICByZXR1cm4gJF9fMTAub25Nb3VzZVVwKGV2ZW50KTtcbiAgICB9KSk7XG4gICAgdGhpcy5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLmVkaXRvci5nZXRJbnB1dEVsZW1lbnQoKSwgJ2JsdXInLCAoZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHJldHVybiAkX18xMC5vbkVkaXRvckJsdXIoZXZlbnQpO1xuICAgIH0pKTtcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKHRoaXMuZWRpdG9yLmdldElucHV0RWxlbWVudCgpLCAnbW91c2Vkb3duJywgKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICByZXR1cm4gJF9fMTAub25FZGl0b3JNb3VzZURvd24oZXZlbnQpO1xuICAgIH0pKTtcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKHRoaXMuZWRpdG9yLmdldElucHV0RWxlbWVudCgpLCAnbW91c2V1cCcsIChmdW5jdGlvbihldmVudCkge1xuICAgICAgcmV0dXJuICRfXzEwLm9uRWRpdG9yTW91c2VVcChldmVudCk7XG4gICAgfSkpO1xuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBcInNldFJhbmdlXCIsIHtcbiAgdmFsdWU6IGZ1bmN0aW9uKHJhbmdlKSB7XG4gICAgdGhpcy5yYW5nZSA9IHJhbmdlO1xuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBcImNsZWFyUmFuZ2VcIiwge1xuICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5yYW5nZSA9IHt9O1xuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBcInRhcmdldElzQ2VsbFdpdGhDb21tZW50XCIsIHtcbiAgdmFsdWU6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIGNsb3Nlc3RDZWxsID0gY2xvc2VzdChldmVudC50YXJnZXQsICdURCcsICdUQk9EWScpO1xuICAgIHJldHVybiBjbG9zZXN0Q2VsbCAmJiBoYXNDbGFzcyhjbG9zZXN0Q2VsbCwgJ2h0Q29tbWVudENlbGwnKSAmJiBjbG9zZXN0KGNsb3Nlc3RDZWxsLCBbdGhpcy5ob3Qucm9vdEVsZW1lbnRdKSA/IHRydWUgOiBmYWxzZTtcbiAgfSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgXCJ0YXJnZXRJc0NvbW1lbnRUZXh0QXJlYVwiLCB7XG4gIHZhbHVlOiBmdW5jdGlvbihldmVudCkge1xuICAgIHJldHVybiB0aGlzLmVkaXRvci5nZXRJbnB1dEVsZW1lbnQoKSA9PT0gZXZlbnQudGFyZ2V0O1xuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBcInNldENvbW1lbnRcIiwge1xuICB2YWx1ZTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICB2YXIgJF9fMTM7XG4gICAgaWYgKCF0aGlzLnJhbmdlLmZyb20pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQmVmb3JlIHVzaW5nIHRoaXMgbWV0aG9kLCBmaXJzdCBzZXQgY2VsbCByYW5nZSAoaG90LmdldFBsdWdpbihcImNvbW1lbnRcIikuc2V0UmFuZ2UoKSknKTtcbiAgICB9XG4gICAgdmFyIGVkaXRvclZhbHVlID0gdGhpcy5lZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICB2YXIgY29tbWVudCA9ICcnO1xuICAgIGlmICh2YWx1ZSAhPSBudWxsKSB7XG4gICAgICBjb21tZW50ID0gdmFsdWU7XG4gICAgfSBlbHNlIGlmIChlZGl0b3JWYWx1ZSAhPSBudWxsKSB7XG4gICAgICBjb21tZW50ID0gZWRpdG9yVmFsdWU7XG4gICAgfVxuICAgIHZhciByb3cgPSB0aGlzLnJhbmdlLmZyb20ucm93O1xuICAgIHZhciBjb2wgPSB0aGlzLnJhbmdlLmZyb20uY29sO1xuICAgIHRoaXMudXBkYXRlQ29tbWVudE1ldGEocm93LCBjb2wsICgkX18xMyA9IHt9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fMTMsIE1FVEFfQ09NTUVOVF9WQUxVRSwge1xuICAgICAgdmFsdWU6IGNvbW1lbnQsXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWVcbiAgICB9KSwgJF9fMTMpKTtcbiAgICB0aGlzLmhvdC5yZW5kZXIoKTtcbiAgfSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgXCJzZXRDb21tZW50QXRDZWxsXCIsIHtcbiAgdmFsdWU6IGZ1bmN0aW9uKHJvdywgY29sLCB2YWx1ZSkge1xuICAgIHRoaXMuc2V0UmFuZ2Uoe2Zyb206IG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMocm93LCBjb2wpfSk7XG4gICAgdGhpcy5zZXRDb21tZW50KHZhbHVlKTtcbiAgfSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgXCJyZW1vdmVDb21tZW50XCIsIHtcbiAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBmb3JjZVJlbmRlciA9IGFyZ3VtZW50c1swXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMF0gOiB0cnVlO1xuICAgIGlmICghdGhpcy5yYW5nZS5mcm9tKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0JlZm9yZSB1c2luZyB0aGlzIG1ldGhvZCwgZmlyc3Qgc2V0IGNlbGwgcmFuZ2UgKGhvdC5nZXRQbHVnaW4oXCJjb21tZW50XCIpLnNldFJhbmdlKCkpJyk7XG4gICAgfVxuICAgIHRoaXMuaG90LnNldENlbGxNZXRhKHRoaXMucmFuZ2UuZnJvbS5yb3csIHRoaXMucmFuZ2UuZnJvbS5jb2wsIE1FVEFfQ09NTUVOVCwgdm9pZCAwKTtcbiAgICBpZiAoZm9yY2VSZW5kZXIpIHtcbiAgICAgIHRoaXMuaG90LnJlbmRlcigpO1xuICAgIH1cbiAgICB0aGlzLmhpZGUoKTtcbiAgfSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgXCJyZW1vdmVDb21tZW50QXRDZWxsXCIsIHtcbiAgdmFsdWU6IGZ1bmN0aW9uKHJvdywgY29sKSB7XG4gICAgdmFyIGZvcmNlUmVuZGVyID0gYXJndW1lbnRzWzJdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1syXSA6IHRydWU7XG4gICAgdGhpcy5zZXRSYW5nZSh7ZnJvbTogbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3Jkcyhyb3csIGNvbCl9KTtcbiAgICB0aGlzLnJlbW92ZUNvbW1lbnQoZm9yY2VSZW5kZXIpO1xuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBcImdldENvbW1lbnRcIiwge1xuICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHJvdyA9IHRoaXMucmFuZ2UuZnJvbS5yb3c7XG4gICAgdmFyIGNvbHVtbiA9IHRoaXMucmFuZ2UuZnJvbS5jb2w7XG4gICAgcmV0dXJuIHRoaXMuZ2V0Q29tbWVudE1ldGEocm93LCBjb2x1bW4sIE1FVEFfQ09NTUVOVF9WQUxVRSk7XG4gIH0sXG4gIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgd3JpdGFibGU6IHRydWVcbn0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fMTMsIFwiZ2V0Q29tbWVudEF0Q2VsbFwiLCB7XG4gIHZhbHVlOiBmdW5jdGlvbihyb3csIGNvbHVtbikge1xuICAgIHJldHVybiB0aGlzLmdldENvbW1lbnRNZXRhKHJvdywgY29sdW1uLCBNRVRBX0NPTU1FTlRfVkFMVUUpO1xuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBcInNob3dcIiwge1xuICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgaWYgKCF0aGlzLnJhbmdlLmZyb20pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQmVmb3JlIHVzaW5nIHRoaXMgbWV0aG9kLCBmaXJzdCBzZXQgY2VsbCByYW5nZSAoaG90LmdldFBsdWdpbihcImNvbW1lbnRcIikuc2V0UmFuZ2UoKSknKTtcbiAgICB9XG4gICAgdmFyIG1ldGEgPSB0aGlzLmhvdC5nZXRDZWxsTWV0YSh0aGlzLnJhbmdlLmZyb20ucm93LCB0aGlzLnJhbmdlLmZyb20uY29sKTtcbiAgICB0aGlzLnJlZnJlc2hFZGl0b3IodHJ1ZSk7XG4gICAgdGhpcy5lZGl0b3Iuc2V0VmFsdWUobWV0YVtNRVRBX0NPTU1FTlRdID8gbWV0YVtNRVRBX0NPTU1FTlRdW01FVEFfQ09NTUVOVF9WQUxVRV0gOiBudWxsIHx8ICcnKTtcbiAgICBpZiAodGhpcy5lZGl0b3IuaGlkZGVuKSB7XG4gICAgICB0aGlzLmVkaXRvci5zaG93KCk7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBcInNob3dBdENlbGxcIiwge1xuICB2YWx1ZTogZnVuY3Rpb24ocm93LCBjb2wpIHtcbiAgICB0aGlzLnNldFJhbmdlKHtmcm9tOiBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHJvdywgY29sKX0pO1xuICAgIHJldHVybiB0aGlzLnNob3coKTtcbiAgfSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgXCJoaWRlXCIsIHtcbiAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgIGlmICghdGhpcy5lZGl0b3IuaGlkZGVuKSB7XG4gICAgICB0aGlzLmVkaXRvci5oaWRlKCk7XG4gICAgfVxuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBcInJlZnJlc2hFZGl0b3JcIiwge1xuICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGZvcmNlID0gYXJndW1lbnRzWzBdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1swXSA6IGZhbHNlO1xuICAgIGlmICghZm9yY2UgJiYgKCF0aGlzLnJhbmdlLmZyb20gfHwgIXRoaXMuZWRpdG9yLmlzVmlzaWJsZSgpKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgc2Nyb2xsYWJsZUVsZW1lbnQgPSBnZXRTY3JvbGxhYmxlRWxlbWVudCh0aGlzLmhvdC52aWV3Lnd0Lnd0VGFibGUuVEFCTEUpO1xuICAgIHZhciBURCA9IHRoaXMuaG90LnZpZXcud3Qud3RUYWJsZS5nZXRDZWxsKHRoaXMucmFuZ2UuZnJvbSk7XG4gICAgdmFyIHJvdyA9IHRoaXMucmFuZ2UuZnJvbS5yb3c7XG4gICAgdmFyIGNvbHVtbiA9IHRoaXMucmFuZ2UuZnJvbS5jb2w7XG4gICAgdmFyIGNlbGxPZmZzZXQgPSBvZmZzZXQoVEQpO1xuICAgIHZhciBsYXN0Q29sV2lkdGggPSB0aGlzLmhvdC52aWV3Lnd0Lnd0VGFibGUuZ2V0U3RyZXRjaGVkQ29sdW1uV2lkdGgoY29sdW1uKTtcbiAgICB2YXIgY2VsbFRvcE9mZnNldCA9IGNlbGxPZmZzZXQudG9wIDwgMCA/IDAgOiBjZWxsT2Zmc2V0LnRvcDtcbiAgICB2YXIgY2VsbExlZnRPZmZzZXQgPSBjZWxsT2Zmc2V0LmxlZnQ7XG4gICAgaWYgKHRoaXMuaG90LnZpZXcud3Qud3RWaWV3cG9ydC5oYXNWZXJ0aWNhbFNjcm9sbCgpICYmIHNjcm9sbGFibGVFbGVtZW50ICE9PSB3aW5kb3cpIHtcbiAgICAgIGNlbGxUb3BPZmZzZXQgPSBjZWxsVG9wT2Zmc2V0IC0gdGhpcy5ob3Qudmlldy53dC53dE92ZXJsYXlzLnRvcE92ZXJsYXkuZ2V0U2Nyb2xsUG9zaXRpb24oKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuaG90LnZpZXcud3Qud3RWaWV3cG9ydC5oYXNIb3Jpem9udGFsU2Nyb2xsKCkgJiYgc2Nyb2xsYWJsZUVsZW1lbnQgIT09IHdpbmRvdykge1xuICAgICAgY2VsbExlZnRPZmZzZXQgPSBjZWxsTGVmdE9mZnNldCAtIHRoaXMuaG90LnZpZXcud3Qud3RPdmVybGF5cy5sZWZ0T3ZlcmxheS5nZXRTY3JvbGxQb3NpdGlvbigpO1xuICAgIH1cbiAgICB2YXIgeCA9IGNlbGxMZWZ0T2Zmc2V0ICsgbGFzdENvbFdpZHRoO1xuICAgIHZhciB5ID0gY2VsbFRvcE9mZnNldDtcbiAgICB2YXIgY29tbWVudFN0eWxlID0gdGhpcy5nZXRDb21tZW50TWV0YShyb3csIGNvbHVtbiwgTUVUQV9TVFlMRSk7XG4gICAgdmFyIHJlYWRPbmx5ID0gdGhpcy5nZXRDb21tZW50TWV0YShyb3csIGNvbHVtbiwgTUVUQV9SRUFET05MWSk7XG4gICAgaWYgKGNvbW1lbnRTdHlsZSkge1xuICAgICAgdGhpcy5lZGl0b3Iuc2V0U2l6ZShjb21tZW50U3R5bGUud2lkdGgsIGNvbW1lbnRTdHlsZS5oZWlnaHQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVkaXRvci5yZXNldFNpemUoKTtcbiAgICB9XG4gICAgdGhpcy5lZGl0b3Iuc2V0UmVhZE9ubHlTdGF0ZShyZWFkT25seSk7XG4gICAgdGhpcy5lZGl0b3Iuc2V0UG9zaXRpb24oeCwgeSk7XG4gIH0sXG4gIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgd3JpdGFibGU6IHRydWVcbn0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fMTMsIFwiY2hlY2tTZWxlY3Rpb25Db21tZW50c0NvbnNpc3RlbmN5XCIsIHtcbiAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWxlY3RlZCA9IHRoaXMuaG90LmdldFNlbGVjdGVkUmFuZ2UoKTtcbiAgICBpZiAoIXNlbGVjdGVkKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBoYXNDb21tZW50ID0gZmFsc2U7XG4gICAgdmFyIGNlbGwgPSBzZWxlY3RlZC5mcm9tO1xuICAgIGlmICh0aGlzLmdldENvbW1lbnRNZXRhKGNlbGwucm93LCBjZWxsLmNvbCwgTUVUQV9DT01NRU5UX1ZBTFVFKSkge1xuICAgICAgaGFzQ29tbWVudCA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiBoYXNDb21tZW50O1xuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBcInVwZGF0ZUNvbW1lbnRNZXRhXCIsIHtcbiAgdmFsdWU6IGZ1bmN0aW9uKHJvdywgY29sdW1uLCBtZXRhT2JqZWN0KSB7XG4gICAgdmFyIG9sZENvbW1lbnQgPSB0aGlzLmhvdC5nZXRDZWxsTWV0YShyb3csIGNvbHVtbilbTUVUQV9DT01NRU5UXTtcbiAgICB2YXIgbmV3Q29tbWVudDtcbiAgICBpZiAob2xkQ29tbWVudCkge1xuICAgICAgbmV3Q29tbWVudCA9IGRlZXBDbG9uZShvbGRDb21tZW50KTtcbiAgICAgIGRlZXBFeHRlbmQobmV3Q29tbWVudCwgbWV0YU9iamVjdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5ld0NvbW1lbnQgPSBtZXRhT2JqZWN0O1xuICAgIH1cbiAgICB0aGlzLmhvdC5zZXRDZWxsTWV0YShyb3csIGNvbHVtbiwgTUVUQV9DT01NRU5ULCBuZXdDb21tZW50KTtcbiAgfSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgXCJnZXRDb21tZW50TWV0YVwiLCB7XG4gIHZhbHVlOiBmdW5jdGlvbihyb3csIGNvbHVtbiwgcHJvcGVydHkpIHtcbiAgICB2YXIgY2VsbE1ldGEgPSB0aGlzLmhvdC5nZXRDZWxsTWV0YShyb3csIGNvbHVtbik7XG4gICAgaWYgKCFjZWxsTWV0YVtNRVRBX0NPTU1FTlRdKSB7XG4gICAgICByZXR1cm4gdm9pZCAwO1xuICAgIH1cbiAgICByZXR1cm4gY2VsbE1ldGFbTUVUQV9DT01NRU5UXVtwcm9wZXJ0eV07XG4gIH0sXG4gIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgd3JpdGFibGU6IHRydWVcbn0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fMTMsIFwib25Nb3VzZURvd25cIiwge1xuICB2YWx1ZTogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB0aGlzLm1vdXNlRG93biA9IHRydWU7XG4gICAgaWYgKCF0aGlzLmhvdC52aWV3IHx8ICF0aGlzLmhvdC52aWV3Lnd0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICghdGhpcy5jb250ZXh0TWVudUV2ZW50ICYmICF0aGlzLnRhcmdldElzQ29tbWVudFRleHRBcmVhKGV2ZW50KSkge1xuICAgICAgdmFyIGV2ZW50Q2VsbCA9IGNsb3Nlc3QoZXZlbnQudGFyZ2V0LCAnVEQnLCAnVEJPRFknKTtcbiAgICAgIHZhciBjb29yZGluYXRlcyA9IG51bGw7XG4gICAgICBpZiAoZXZlbnRDZWxsKSB7XG4gICAgICAgIGNvb3JkaW5hdGVzID0gdGhpcy5ob3Qudmlldy53dC53dFRhYmxlLmdldENvb3JkcyhldmVudENlbGwpO1xuICAgICAgfVxuICAgICAgaWYgKCFldmVudENlbGwgfHwgKCh0aGlzLnJhbmdlLmZyb20gJiYgY29vcmRpbmF0ZXMpICYmICh0aGlzLnJhbmdlLmZyb20ucm93ICE9PSBjb29yZGluYXRlcy5yb3cgfHwgdGhpcy5yYW5nZS5mcm9tLmNvbCAhPT0gY29vcmRpbmF0ZXMuY29sKSkpIHtcbiAgICAgICAgdGhpcy5oaWRlKCk7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuY29udGV4dE1lbnVFdmVudCA9IGZhbHNlO1xuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBcIm9uTW91c2VPdmVyXCIsIHtcbiAgdmFsdWU6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyICRfXzEwID0gdGhpcztcbiAgICBpZiAodGhpcy5tb3VzZURvd24gfHwgdGhpcy5lZGl0b3IuaXNGb2N1c2VkKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHByaXYgPSBwcml2YXRlUG9vbC5nZXQodGhpcyk7XG4gICAgcHJpdi5jZWxsQmVsb3dDdXJzb3IgPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFkpO1xuICAgIGRlYm91bmNlKChmdW5jdGlvbigpIHtcbiAgICAgIGlmIChoYXNDbGFzcyhldmVudC50YXJnZXQsICd3dEJvcmRlcicpIHx8IHByaXYuY2VsbEJlbG93Q3Vyc29yICE9PSBldmVudC50YXJnZXQgfHwgISRfXzEwLmVkaXRvcikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoJF9fMTAudGFyZ2V0SXNDZWxsV2l0aENvbW1lbnQoZXZlbnQpKSB7XG4gICAgICAgIHZhciBjb29yZGluYXRlcyA9ICRfXzEwLmhvdC52aWV3Lnd0Lnd0VGFibGUuZ2V0Q29vcmRzKGV2ZW50LnRhcmdldCk7XG4gICAgICAgIHZhciByYW5nZSA9IHtmcm9tOiBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKGNvb3JkaW5hdGVzLnJvdywgY29vcmRpbmF0ZXMuY29sKX07XG4gICAgICAgICRfXzEwLnNldFJhbmdlKHJhbmdlKTtcbiAgICAgICAgJF9fMTAuc2hvdygpO1xuICAgICAgfSBlbHNlIGlmIChpc0NoaWxkT2YoZXZlbnQudGFyZ2V0LCBkb2N1bWVudCkgJiYgISRfXzEwLnRhcmdldElzQ29tbWVudFRleHRBcmVhKGV2ZW50KSAmJiAhJF9fMTAuZWRpdG9yLmlzRm9jdXNlZCgpKSB7XG4gICAgICAgICRfXzEwLmhpZGUoKTtcbiAgICAgIH1cbiAgICB9KSwgdGhpcy5kaXNwbGF5RGVsYXkpKCk7XG4gIH0sXG4gIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgd3JpdGFibGU6IHRydWVcbn0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fMTMsIFwib25Nb3VzZVVwXCIsIHtcbiAgdmFsdWU6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdGhpcy5tb3VzZURvd24gPSBmYWxzZTtcbiAgfSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgXCJvbkFmdGVyUmVuZGVyZXJcIiwge1xuICB2YWx1ZTogZnVuY3Rpb24oVEQsIGNlbGxQcm9wZXJ0aWVzKSB7XG4gICAgaWYgKGNlbGxQcm9wZXJ0aWVzW01FVEFfQ09NTUVOVF0gJiYgY2VsbFByb3BlcnRpZXNbTUVUQV9DT01NRU5UXVtNRVRBX0NPTU1FTlRfVkFMVUVdKSB7XG4gICAgICBhZGRDbGFzcyhURCwgY2VsbFByb3BlcnRpZXMuY29tbWVudGVkQ2VsbENsYXNzTmFtZSk7XG4gICAgfVxuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBcIm9uRWRpdG9yQmx1clwiLCB7XG4gIHZhbHVlOiBmdW5jdGlvbihldmVudCkge1xuICAgIHRoaXMuc2V0Q29tbWVudCgpO1xuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBcIm9uRWRpdG9yTW91c2VEb3duXCIsIHtcbiAgdmFsdWU6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIHByaXYgPSBwcml2YXRlUG9vbC5nZXQodGhpcyk7XG4gICAgcHJpdi50ZW1wRWRpdG9yRGltZW5zaW9ucyA9IHtcbiAgICAgIHdpZHRoOiBvdXRlcldpZHRoKGV2ZW50LnRhcmdldCksXG4gICAgICBoZWlnaHQ6IG91dGVySGVpZ2h0KGV2ZW50LnRhcmdldClcbiAgICB9O1xuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBcIm9uRWRpdG9yTW91c2VVcFwiLCB7XG4gIHZhbHVlOiBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciAkX18xMztcbiAgICB2YXIgcHJpdiA9IHByaXZhdGVQb29sLmdldCh0aGlzKTtcbiAgICB2YXIgY3VycmVudFdpZHRoID0gb3V0ZXJXaWR0aChldmVudC50YXJnZXQpO1xuICAgIHZhciBjdXJyZW50SGVpZ2h0ID0gb3V0ZXJIZWlnaHQoZXZlbnQudGFyZ2V0KTtcbiAgICBpZiAoY3VycmVudFdpZHRoICE9PSBwcml2LnRlbXBFZGl0b3JEaW1lbnNpb25zLndpZHRoICsgMSB8fCBjdXJyZW50SGVpZ2h0ICE9PSBwcml2LnRlbXBFZGl0b3JEaW1lbnNpb25zLmhlaWdodCArIDIpIHtcbiAgICAgIHRoaXMudXBkYXRlQ29tbWVudE1ldGEodGhpcy5yYW5nZS5mcm9tLnJvdywgdGhpcy5yYW5nZS5mcm9tLmNvbCwgKCRfXzEzID0ge30sIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgTUVUQV9TVFlMRSwge1xuICAgICAgICB2YWx1ZToge1xuICAgICAgICAgIHdpZHRoOiBjdXJyZW50V2lkdGgsXG4gICAgICAgICAgaGVpZ2h0OiBjdXJyZW50SGVpZ2h0XG4gICAgICAgIH0sXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgd3JpdGFibGU6IHRydWVcbiAgICAgIH0pLCAkX18xMykpO1xuICAgIH1cbiAgfSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgXCJvbkNvbnRleHRNZW51QWRkQ29tbWVudFwiLCB7XG4gIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fMTAgPSB0aGlzO1xuICAgIHZhciBjb29yZHMgPSB0aGlzLmhvdC5nZXRTZWxlY3RlZFJhbmdlKCk7XG4gICAgdGhpcy5jb250ZXh0TWVudUV2ZW50ID0gdHJ1ZTtcbiAgICB0aGlzLnNldFJhbmdlKHtmcm9tOiBjb29yZHMuZnJvbX0pO1xuICAgIHRoaXMuc2hvdygpO1xuICAgIHNldFRpbWVvdXQoKGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCRfXzEwLmhvdCkge1xuICAgICAgICAkX18xMC5ob3QuZGVzZWxlY3RDZWxsKCk7XG4gICAgICAgICRfXzEwLmVkaXRvci5mb2N1cygpO1xuICAgICAgfVxuICAgIH0pLCAxMCk7XG4gIH0sXG4gIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgd3JpdGFibGU6IHRydWVcbn0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fMTMsIFwib25Db250ZXh0TWVudVJlbW92ZUNvbW1lbnRcIiwge1xuICB2YWx1ZTogZnVuY3Rpb24oc2VsZWN0aW9uKSB7XG4gICAgdGhpcy5jb250ZXh0TWVudUV2ZW50ID0gdHJ1ZTtcbiAgICBmb3IgKHZhciBpID0gc2VsZWN0aW9uLnN0YXJ0LnJvdzsgaSA8PSBzZWxlY3Rpb24uZW5kLnJvdzsgaSsrKSB7XG4gICAgICBmb3IgKHZhciBqID0gc2VsZWN0aW9uLnN0YXJ0LmNvbDsgaiA8PSBzZWxlY3Rpb24uZW5kLmNvbDsgaisrKSB7XG4gICAgICAgIHRoaXMucmVtb3ZlQ29tbWVudEF0Q2VsbChpLCBqLCBmYWxzZSk7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuaG90LnJlbmRlcigpO1xuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBcIm9uQ29udGV4dE1lbnVNYWtlUmVhZE9ubHlcIiwge1xuICB2YWx1ZTogZnVuY3Rpb24oc2VsZWN0aW9uKSB7XG4gICAgdmFyICRfXzEzO1xuICAgIHRoaXMuY29udGV4dE1lbnVFdmVudCA9IHRydWU7XG4gICAgZm9yICh2YXIgaSA9IHNlbGVjdGlvbi5zdGFydC5yb3c7IGkgPD0gc2VsZWN0aW9uLmVuZC5yb3c7IGkrKykge1xuICAgICAgZm9yICh2YXIgaiA9IHNlbGVjdGlvbi5zdGFydC5jb2w7IGogPD0gc2VsZWN0aW9uLmVuZC5jb2w7IGorKykge1xuICAgICAgICB2YXIgY3VycmVudFN0YXRlID0gISF0aGlzLmdldENvbW1lbnRNZXRhKGksIGosIE1FVEFfUkVBRE9OTFkpO1xuICAgICAgICB0aGlzLnVwZGF0ZUNvbW1lbnRNZXRhKGksIGosICgkX18xMyA9IHt9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fMTMsIE1FVEFfUkVBRE9OTFksIHtcbiAgICAgICAgICB2YWx1ZTogIWN1cnJlbnRTdGF0ZSxcbiAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICB3cml0YWJsZTogdHJ1ZVxuICAgICAgICB9KSwgJF9fMTMpKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgd3JpdGFibGU6IHRydWVcbn0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fMTMsIFwiYWRkVG9Db250ZXh0TWVudVwiLCB7XG4gIHZhbHVlOiBmdW5jdGlvbihkZWZhdWx0T3B0aW9ucykge1xuICAgIHZhciAkX18xMCA9IHRoaXM7XG4gICAgZGVmYXVsdE9wdGlvbnMuaXRlbXMucHVzaChIYW5kc29udGFibGUucGx1Z2lucy5Db250ZXh0TWVudS5TRVBBUkFUT1IsIHtcbiAgICAgIGtleTogJ2NvbW1lbnRzQWRkRWRpdCcsXG4gICAgICBuYW1lOiAoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAkX18xMC5jaGVja1NlbGVjdGlvbkNvbW1lbnRzQ29uc2lzdGVuY3koKSA/ICdFZGl0IGNvbW1lbnQnIDogJ0FkZCBjb21tZW50JztcbiAgICAgIH0pLFxuICAgICAgY2FsbGJhY2s6IChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICRfXzEwLm9uQ29udGV4dE1lbnVBZGRDb21tZW50KCk7XG4gICAgICB9KSxcbiAgICAgIGRpc2FibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U2VsZWN0ZWQoKSAmJiAhdGhpcy5zZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIuY29ybmVyID8gZmFsc2UgOiB0cnVlO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogJ2NvbW1lbnRzUmVtb3ZlJyxcbiAgICAgIG5hbWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gJ0RlbGV0ZSBjb21tZW50JztcbiAgICAgIH0sXG4gICAgICBjYWxsYmFjazogKGZ1bmN0aW9uKGtleSwgc2VsZWN0aW9uKSB7XG4gICAgICAgIHJldHVybiAkX18xMC5vbkNvbnRleHRNZW51UmVtb3ZlQ29tbWVudChzZWxlY3Rpb24pO1xuICAgICAgfSksXG4gICAgICBkaXNhYmxlZDogKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gJF9fMTAuaG90LnNlbGVjdGlvbi5zZWxlY3RlZEhlYWRlci5jb3JuZXI7XG4gICAgICB9KVxuICAgIH0sIHtcbiAgICAgIGtleTogJ2NvbW1lbnRzUmVhZE9ubHknLFxuICAgICAgbmFtZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciAkX18xMSA9IHRoaXM7XG4gICAgICAgIHZhciBsYWJlbCA9ICdSZWFkIG9ubHkgY29tbWVudCc7XG4gICAgICAgIHZhciBoYXNQcm9wZXJ0eSA9IGNoZWNrU2VsZWN0aW9uQ29uc2lzdGVuY3kodGhpcy5nZXRTZWxlY3RlZFJhbmdlKCksIChmdW5jdGlvbihyb3csIGNvbCkge1xuICAgICAgICAgIHZhciByZWFkT25seVByb3BlcnR5ID0gJF9fMTEuZ2V0Q2VsbE1ldGEocm93LCBjb2wpW01FVEFfQ09NTUVOVF07XG4gICAgICAgICAgaWYgKHJlYWRPbmx5UHJvcGVydHkpIHtcbiAgICAgICAgICAgIHJlYWRPbmx5UHJvcGVydHkgPSByZWFkT25seVByb3BlcnR5W01FVEFfUkVBRE9OTFldO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAocmVhZE9ubHlQcm9wZXJ0eSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIGlmIChoYXNQcm9wZXJ0eSkge1xuICAgICAgICAgIGxhYmVsID0gbWFya0xhYmVsQXNTZWxlY3RlZChsYWJlbCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxhYmVsO1xuICAgICAgfSxcbiAgICAgIGNhbGxiYWNrOiAoZnVuY3Rpb24oa2V5LCBzZWxlY3Rpb24pIHtcbiAgICAgICAgcmV0dXJuICRfXzEwLm9uQ29udGV4dE1lbnVNYWtlUmVhZE9ubHkoc2VsZWN0aW9uKTtcbiAgICAgIH0pLFxuICAgICAgZGlzYWJsZWQ6IChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICRfXzEwLmhvdC5zZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIuY29ybmVyIHx8ICEkX18xMC5jaGVja1NlbGVjdGlvbkNvbW1lbnRzQ29uc2lzdGVuY3koKTtcbiAgICAgIH0pXG4gICAgfSk7XG4gIH0sXG4gIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgd3JpdGFibGU6IHRydWVcbn0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fMTMsIFwib25BZnRlckJlZ2luRWRpdGluZ1wiLCB7XG4gIHZhbHVlOiBmdW5jdGlvbihyb3csIGNvbHVtbikge1xuICAgIHRoaXMuaGlkZSgpO1xuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBcImRlc3Ryb3lcIiwge1xuICB2YWx1ZTogZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuZWRpdG9yKSB7XG4gICAgICB0aGlzLmVkaXRvci5kZXN0cm95KCk7XG4gICAgfVxuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkQ29tbWVudHMucHJvdG90eXBlLCBcImRlc3Ryb3lcIikuY2FsbCh0aGlzKTtcbiAgfSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksICRfXzEzKSwge30sIEJhc2VQbHVnaW4pO1xuO1xucmVnaXN0ZXJQbHVnaW4oJ2NvbW1lbnRzJywgQ29tbWVudHMpO1xuXG4vLyMgXG59LHtcIjNyZHBhcnR5L3dhbGtvbnRhYmxlL3NyYy9jZWxsL2Nvb3Jkc1wiOjYsXCJfYmFzZVwiOjYyLFwiYnJvd3NlclwiOjI0LFwiY29tbWVudEVkaXRvclwiOjY4LFwiY29udGV4dE1lbnUvdXRpbHNcIjo4OCxcImV2ZW50TWFuYWdlclwiOjQyLFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwiaGVscGVycy9mdW5jdGlvblwiOjUwLFwiaGVscGVycy9vYmplY3RcIjo1MyxcInBsdWdpbnNcIjo2MX1dLDcwOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBDb21tYW5kRXhlY3V0b3I6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIENvbW1hbmRFeGVjdXRvcjtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fO1xudmFyIGFycmF5RWFjaCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gPSBfZGVyZXFfKFwiaGVscGVycy9hcnJheVwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9ffSkuYXJyYXlFYWNoO1xudmFyIENvbW1hbmRFeGVjdXRvciA9IGZ1bmN0aW9uIENvbW1hbmRFeGVjdXRvcihob3RJbnN0YW5jZSkge1xuICB0aGlzLmhvdCA9IGhvdEluc3RhbmNlO1xuICB0aGlzLmNvbW1hbmRzID0ge307XG4gIHRoaXMuY29tbW9uQ2FsbGJhY2sgPSBudWxsO1xufTtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKENvbW1hbmRFeGVjdXRvciwge1xuICByZWdpc3RlckNvbW1hbmQ6IGZ1bmN0aW9uKG5hbWUsIGNvbW1hbmREZXNjcmlwdG9yKSB7XG4gICAgdGhpcy5jb21tYW5kc1tuYW1lXSA9IGNvbW1hbmREZXNjcmlwdG9yO1xuICB9LFxuICBzZXRDb21tb25DYWxsYmFjazogZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICB0aGlzLmNvbW1vbkNhbGxiYWNrID0gY2FsbGJhY2s7XG4gIH0sXG4gIGV4ZWN1dGU6IGZ1bmN0aW9uKGNvbW1hbmROYW1lKSB7XG4gICAgZm9yICh2YXIgcGFyYW1zID0gW10sXG4gICAgICAgICRfXzMgPSAxOyAkX18zIDwgYXJndW1lbnRzLmxlbmd0aDsgJF9fMysrKVxuICAgICAgcGFyYW1zWyRfXzMgLSAxXSA9IGFyZ3VtZW50c1skX18zXTtcbiAgICB2YXIgJF9fMSA9IHRoaXM7XG4gICAgdmFyIGNvbW1hbmRTcGxpdCA9IGNvbW1hbmROYW1lLnNwbGl0KCc6Jyk7XG4gICAgY29tbWFuZE5hbWUgPSBjb21tYW5kU3BsaXRbMF07XG4gICAgdmFyIHN1YkNvbW1hbmROYW1lID0gY29tbWFuZFNwbGl0Lmxlbmd0aCA9PT0gMiA/IGNvbW1hbmRTcGxpdFsxXSA6IG51bGw7XG4gICAgdmFyIGNvbW1hbmQgPSB0aGlzLmNvbW1hbmRzW2NvbW1hbmROYW1lXTtcbiAgICBpZiAoIWNvbW1hbmQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcigoXCJNZW51IGNvbW1hbmQgJ1wiICsgY29tbWFuZE5hbWUgKyBcIicgbm90IGV4aXN0cy5cIikpO1xuICAgIH1cbiAgICBpZiAoc3ViQ29tbWFuZE5hbWUgJiYgY29tbWFuZC5zdWJtZW51KSB7XG4gICAgICBjb21tYW5kID0gZmluZFN1YkNvbW1hbmQoc3ViQ29tbWFuZE5hbWUsIGNvbW1hbmQuc3VibWVudS5pdGVtcyk7XG4gICAgfVxuICAgIGlmIChjb21tYW5kLmRpc2FibGVkID09PSB0cnVlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0eXBlb2YgY29tbWFuZC5kaXNhYmxlZCA9PSAnZnVuY3Rpb24nICYmIGNvbW1hbmQuZGlzYWJsZWQuY2FsbCh0aGlzLmhvdCkgPT09IHRydWUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGNvbW1hbmQuaGFzT3duUHJvcGVydHkoJ3N1Ym1lbnUnKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgY2FsbGJhY2tzID0gW107XG4gICAgaWYgKHR5cGVvZiBjb21tYW5kLmNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBjYWxsYmFja3MucHVzaChjb21tYW5kLmNhbGxiYWNrKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiB0aGlzLmNvbW1vbkNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBjYWxsYmFja3MucHVzaCh0aGlzLmNvbW1vbkNhbGxiYWNrKTtcbiAgICB9XG4gICAgcGFyYW1zLnVuc2hpZnQoY29tbWFuZFNwbGl0LmpvaW4oJzonKSk7XG4gICAgYXJyYXlFYWNoKGNhbGxiYWNrcywgKGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgICByZXR1cm4gY2FsbGJhY2suYXBwbHkoJF9fMS5ob3QsIHBhcmFtcyk7XG4gICAgfSkpO1xuICB9XG59LCB7fSk7XG5mdW5jdGlvbiBmaW5kU3ViQ29tbWFuZChzdWJDb21tYW5kTmFtZSwgc3ViQ29tbWFuZHMpIHtcbiAgdmFyIGNvbW1hbmQ7XG4gIGFycmF5RWFjaChzdWJDb21tYW5kcywgKGZ1bmN0aW9uKGNtZCkge1xuICAgIHZhciBjbWRzID0gY21kLmtleSA/IGNtZC5rZXkuc3BsaXQoJzonKSA6IG51bGw7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoY21kcykgJiYgY21kc1sxXSA9PT0gc3ViQ29tbWFuZE5hbWUpIHtcbiAgICAgIGNvbW1hbmQgPSBjbWQ7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9KSk7XG4gIHJldHVybiBjb21tYW5kO1xufVxuO1xuXG4vLyMgXG59LHtcImhlbHBlcnMvYXJyYXlcIjo0M31dLDcxOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBDb250ZXh0TWVudToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gQ29udGV4dE1lbnU7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyxcbiAgICAkX19jb21tYW5kRXhlY3V0b3JfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9faXRlbXNGYWN0b3J5X18sXG4gICAgJF9fbWVudV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyxcbiAgICAkX19wcmVkZWZpbmVkSXRlbXNfXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgQmFzZVBsdWdpbiA9ICgkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fID0gX2RlcmVxXyhcIl9iYXNlXCIpLCAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fICYmICRfX180Nl9fNDZfXzQ3X185NV9iYXNlX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9ffSkuZGVmYXVsdDtcbnZhciBhcnJheUVhY2ggPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fID0gX2RlcmVxXyhcImhlbHBlcnMvYXJyYXlcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfX30pLmFycmF5RWFjaDtcbnZhciBDb21tYW5kRXhlY3V0b3IgPSAoJF9fY29tbWFuZEV4ZWN1dG9yX18gPSBfZGVyZXFfKFwiY29tbWFuZEV4ZWN1dG9yXCIpLCAkX19jb21tYW5kRXhlY3V0b3JfXyAmJiAkX19jb21tYW5kRXhlY3V0b3JfXy5fX2VzTW9kdWxlICYmICRfX2NvbW1hbmRFeGVjdXRvcl9fIHx8IHtkZWZhdWx0OiAkX19jb21tYW5kRXhlY3V0b3JfX30pLkNvbW1hbmRFeGVjdXRvcjtcbnZhciBFdmVudE1hbmFnZXIgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gPSBfZGVyZXFfKFwiZXZlbnRNYW5hZ2VyXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfX30pLkV2ZW50TWFuYWdlcjtcbnZhciBoYXNDbGFzcyA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSkuaGFzQ2xhc3M7XG52YXIgSXRlbXNGYWN0b3J5ID0gKCRfX2l0ZW1zRmFjdG9yeV9fID0gX2RlcmVxXyhcIml0ZW1zRmFjdG9yeVwiKSwgJF9faXRlbXNGYWN0b3J5X18gJiYgJF9faXRlbXNGYWN0b3J5X18uX19lc01vZHVsZSAmJiAkX19pdGVtc0ZhY3RvcnlfXyB8fCB7ZGVmYXVsdDogJF9faXRlbXNGYWN0b3J5X199KS5JdGVtc0ZhY3Rvcnk7XG52YXIgTWVudSA9ICgkX19tZW51X18gPSBfZGVyZXFfKFwibWVudVwiKSwgJF9fbWVudV9fICYmICRfX21lbnVfXy5fX2VzTW9kdWxlICYmICRfX21lbnVfXyB8fCB7ZGVmYXVsdDogJF9fbWVudV9ffSkuTWVudTtcbnZhciByZWdpc3RlclBsdWdpbiA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gPSBfZGVyZXFfKFwicGx1Z2luc1wiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19ffSkucmVnaXN0ZXJQbHVnaW47XG52YXIgJF9fOSA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2V2ZW50XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9ffSksXG4gICAgc3RvcFByb3BhZ2F0aW9uID0gJF9fOS5zdG9wUHJvcGFnYXRpb24sXG4gICAgcGFnZVggPSAkX185LnBhZ2VYLFxuICAgIHBhZ2VZID0gJF9fOS5wYWdlWTtcbnZhciAkX18xMCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSksXG4gICAgZ2V0V2luZG93U2Nyb2xsTGVmdCA9ICRfXzEwLmdldFdpbmRvd1Njcm9sbExlZnQsXG4gICAgZ2V0V2luZG93U2Nyb2xsVG9wID0gJF9fMTAuZ2V0V2luZG93U2Nyb2xsVG9wO1xudmFyICRfXzExID0gKCRfX3ByZWRlZmluZWRJdGVtc19fID0gX2RlcmVxXyhcInByZWRlZmluZWRJdGVtc1wiKSwgJF9fcHJlZGVmaW5lZEl0ZW1zX18gJiYgJF9fcHJlZGVmaW5lZEl0ZW1zX18uX19lc01vZHVsZSAmJiAkX19wcmVkZWZpbmVkSXRlbXNfXyB8fCB7ZGVmYXVsdDogJF9fcHJlZGVmaW5lZEl0ZW1zX199KSxcbiAgICBST1dfQUJPVkUgPSAkX18xMS5ST1dfQUJPVkUsXG4gICAgUk9XX0JFTE9XID0gJF9fMTEuUk9XX0JFTE9XLFxuICAgIENPTFVNTl9MRUZUID0gJF9fMTEuQ09MVU1OX0xFRlQsXG4gICAgQ09MVU1OX1JJR0hUID0gJF9fMTEuQ09MVU1OX1JJR0hULFxuICAgIFJFTU9WRV9ST1cgPSAkX18xMS5SRU1PVkVfUk9XLFxuICAgIFJFTU9WRV9DT0xVTU4gPSAkX18xMS5SRU1PVkVfQ09MVU1OLFxuICAgIFVORE8gPSAkX18xMS5VTkRPLFxuICAgIFJFRE8gPSAkX18xMS5SRURPLFxuICAgIFJFQURfT05MWSA9ICRfXzExLlJFQURfT05MWSxcbiAgICBBTElHTk1FTlQgPSAkX18xMS5BTElHTk1FTlQsXG4gICAgU0VQQVJBVE9SID0gJF9fMTEuU0VQQVJBVE9SO1xudmFyIENvbnRleHRNZW51ID0gZnVuY3Rpb24gQ29udGV4dE1lbnUoaG90SW5zdGFuY2UpIHtcbiAgJHRyYWNldXJSdW50aW1lLnN1cGVyQ29uc3RydWN0b3IoJENvbnRleHRNZW51KS5jYWxsKHRoaXMsIGhvdEluc3RhbmNlKTtcbiAgdGhpcy5ldmVudE1hbmFnZXIgPSBuZXcgRXZlbnRNYW5hZ2VyKHRoaXMpO1xuICB0aGlzLmNvbW1hbmRFeGVjdXRvciA9IG5ldyBDb21tYW5kRXhlY3V0b3IodGhpcy5ob3QpO1xuICB0aGlzLml0ZW1zRmFjdG9yeSA9IG51bGw7XG4gIHRoaXMubWVudSA9IG51bGw7XG59O1xudmFyICRDb250ZXh0TWVudSA9IENvbnRleHRNZW51O1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoQ29udGV4dE1lbnUsIHtcbiAgaXNFbmFibGVkOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5ob3QuZ2V0U2V0dGluZ3MoKS5jb250ZXh0TWVudTtcbiAgfSxcbiAgZW5hYmxlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fMTIgPSB0aGlzO1xuICAgIGlmICh0aGlzLmVuYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5pdGVtc0ZhY3RvcnkgPSBuZXcgSXRlbXNGYWN0b3J5KHRoaXMuaG90LCAkQ29udGV4dE1lbnUuREVGQVVMVF9JVEVNUyk7XG4gICAgdmFyIHNldHRpbmdzID0gdGhpcy5ob3QuZ2V0U2V0dGluZ3MoKS5jb250ZXh0TWVudTtcbiAgICB2YXIgcHJlZGVmaW5lZEl0ZW1zID0ge2l0ZW1zOiB0aGlzLml0ZW1zRmFjdG9yeS5nZXRJdGVtcyhzZXR0aW5ncyl9O1xuICAgIHRoaXMucmVnaXN0ZXJFdmVudHMoKTtcbiAgICBpZiAodHlwZW9mIHNldHRpbmdzLmNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICB0aGlzLmNvbW1hbmRFeGVjdXRvci5zZXRDb21tb25DYWxsYmFjayhzZXR0aW5ncy5jYWxsYmFjayk7XG4gICAgfVxuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkQ29udGV4dE1lbnUucHJvdG90eXBlLCBcImVuYWJsZVBsdWdpblwiKS5jYWxsKHRoaXMpO1xuICAgIHRoaXMuY2FsbE9uUGx1Z2luc1JlYWR5KChmdW5jdGlvbigpIHtcbiAgICAgICRfXzEyLmhvdC5ydW5Ib29rcygnYWZ0ZXJDb250ZXh0TWVudURlZmF1bHRPcHRpb25zJywgcHJlZGVmaW5lZEl0ZW1zKTtcbiAgICAgICRfXzEyLml0ZW1zRmFjdG9yeS5zZXRQcmVkZWZpbmVkSXRlbXMocHJlZGVmaW5lZEl0ZW1zLml0ZW1zKTtcbiAgICAgIHZhciBtZW51SXRlbXMgPSAkX18xMi5pdGVtc0ZhY3RvcnkuZ2V0SXRlbXMoc2V0dGluZ3MpO1xuICAgICAgJF9fMTIubWVudSA9IG5ldyBNZW51KCRfXzEyLmhvdCwge1xuICAgICAgICBjbGFzc05hbWU6ICdodENvbnRleHRNZW51JyxcbiAgICAgICAga2VlcEluVmlld3BvcnQ6IHRydWVcbiAgICAgIH0pO1xuICAgICAgJF9fMTIuaG90LnJ1bkhvb2tzKCdiZWZvcmVDb250ZXh0TWVudVNldEl0ZW1zJywgbWVudUl0ZW1zKTtcbiAgICAgICRfXzEyLm1lbnUuc2V0TWVudUl0ZW1zKG1lbnVJdGVtcyk7XG4gICAgICAkX18xMi5tZW51LmFkZExvY2FsSG9vaygnYWZ0ZXJPcGVuJywgKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gJF9fMTIub25NZW51QWZ0ZXJPcGVuKCk7XG4gICAgICB9KSk7XG4gICAgICAkX18xMi5tZW51LmFkZExvY2FsSG9vaygnYWZ0ZXJDbG9zZScsIChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICRfXzEyLm9uTWVudUFmdGVyQ2xvc2UoKTtcbiAgICAgIH0pKTtcbiAgICAgICRfXzEyLm1lbnUuYWRkTG9jYWxIb29rKCdleGVjdXRlQ29tbWFuZCcsIChmdW5jdGlvbigpIHtcbiAgICAgICAgZm9yICh2YXIgcGFyYW1zID0gW10sXG4gICAgICAgICAgICAkX18xNCA9IDA7ICRfXzE0IDwgYXJndW1lbnRzLmxlbmd0aDsgJF9fMTQrKylcbiAgICAgICAgICBwYXJhbXNbJF9fMTRdID0gYXJndW1lbnRzWyRfXzE0XTtcbiAgICAgICAgcmV0dXJuICRfXzEyLmV4ZWN1dGVDb21tYW5kLmFwcGx5KCRfXzEyLCBwYXJhbXMpO1xuICAgICAgfSkpO1xuICAgICAgYXJyYXlFYWNoKG1lbnVJdGVtcywgKGZ1bmN0aW9uKGNvbW1hbmQpIHtcbiAgICAgICAgcmV0dXJuICRfXzEyLmNvbW1hbmRFeGVjdXRvci5yZWdpc3RlckNvbW1hbmQoY29tbWFuZC5rZXksIGNvbW1hbmQpO1xuICAgICAgfSkpO1xuICAgIH0pKTtcbiAgfSxcbiAgdXBkYXRlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmRpc2FibGVQbHVnaW4oKTtcbiAgICB0aGlzLmVuYWJsZVBsdWdpbigpO1xuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkQ29udGV4dE1lbnUucHJvdG90eXBlLCBcInVwZGF0ZVBsdWdpblwiKS5jYWxsKHRoaXMpO1xuICB9LFxuICBkaXNhYmxlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmNsb3NlKCk7XG4gICAgaWYgKHRoaXMubWVudSkge1xuICAgICAgdGhpcy5tZW51LmRlc3Ryb3koKTtcbiAgICAgIHRoaXMubWVudSA9IG51bGw7XG4gICAgfVxuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkQ29udGV4dE1lbnUucHJvdG90eXBlLCBcImRpc2FibGVQbHVnaW5cIikuY2FsbCh0aGlzKTtcbiAgfSxcbiAgcmVnaXN0ZXJFdmVudHM6IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX18xMiA9IHRoaXM7XG4gICAgdGhpcy5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLmhvdC5yb290RWxlbWVudCwgJ2NvbnRleHRtZW51JywgKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICByZXR1cm4gJF9fMTIub25Db250ZXh0TWVudShldmVudCk7XG4gICAgfSkpO1xuICB9LFxuICBvcGVuOiBmdW5jdGlvbihldmVudCkge1xuICAgIGlmICghdGhpcy5tZW51KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMubWVudS5vcGVuKCk7XG4gICAgdGhpcy5tZW51LnNldFBvc2l0aW9uKHtcbiAgICAgIHRvcDogcGFyc2VJbnQocGFnZVkoZXZlbnQpLCAxMCkgLSBnZXRXaW5kb3dTY3JvbGxUb3AoKSxcbiAgICAgIGxlZnQ6IHBhcnNlSW50KHBhZ2VYKGV2ZW50KSwgMTApIC0gZ2V0V2luZG93U2Nyb2xsTGVmdCgpXG4gICAgfSk7XG4gICAgdGhpcy5tZW51LmhvdE1lbnUuaXNIb3RUYWJsZUVudiA9IHRoaXMuaG90LmlzSG90VGFibGVFbnY7XG4gICAgSGFuZHNvbnRhYmxlLmV2ZW50TWFuYWdlci5pc0hvdFRhYmxlRW52ID0gdGhpcy5ob3QuaXNIb3RUYWJsZUVudjtcbiAgfSxcbiAgY2xvc2U6IGZ1bmN0aW9uKCkge1xuICAgIGlmICghdGhpcy5tZW51KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMubWVudS5jbG9zZSgpO1xuICB9LFxuICBleGVjdXRlQ29tbWFuZDogZnVuY3Rpb24oKSB7XG4gICAgZm9yICh2YXIgcGFyYW1zID0gW10sXG4gICAgICAgICRfXzE0ID0gMDsgJF9fMTQgPCBhcmd1bWVudHMubGVuZ3RoOyAkX18xNCsrKVxuICAgICAgcGFyYW1zWyRfXzE0XSA9IGFyZ3VtZW50c1skX18xNF07XG4gICAgdGhpcy5jb21tYW5kRXhlY3V0b3IuZXhlY3V0ZS5hcHBseSh0aGlzLmNvbW1hbmRFeGVjdXRvciwgcGFyYW1zKTtcbiAgfSxcbiAgb25Db250ZXh0TWVudTogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgc2V0dGluZ3MgPSB0aGlzLmhvdC5nZXRTZXR0aW5ncygpO1xuICAgIHZhciBzaG93Um93SGVhZGVycyA9IHNldHRpbmdzLnJvd0hlYWRlcnM7XG4gICAgdmFyIHNob3dDb2xIZWFkZXJzID0gc2V0dGluZ3MuY29sSGVhZGVycztcbiAgICBmdW5jdGlvbiBpc1ZhbGlkRWxlbWVudChlbGVtZW50KSB7XG4gICAgICByZXR1cm4gZWxlbWVudC5ub2RlTmFtZSA9PT0gJ1REJyB8fCBlbGVtZW50LnBhcmVudE5vZGUubm9kZU5hbWUgPT09ICdURCc7XG4gICAgfVxuICAgIHZhciBlbGVtZW50ID0gZXZlbnQucmVhbFRhcmdldDtcbiAgICB0aGlzLmNsb3NlKCk7XG4gICAgaWYgKGhhc0NsYXNzKGVsZW1lbnQsICdoYW5kc29udGFibGVJbnB1dCcpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgc3RvcFByb3BhZ2F0aW9uKGV2ZW50KTtcbiAgICBpZiAoIShzaG93Um93SGVhZGVycyB8fCBzaG93Q29sSGVhZGVycykpIHtcbiAgICAgIGlmICghaXNWYWxpZEVsZW1lbnQoZWxlbWVudCkgJiYgIShoYXNDbGFzcyhlbGVtZW50LCAnY3VycmVudCcpICYmIGhhc0NsYXNzKGVsZW1lbnQsICd3dEJvcmRlcicpKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMub3BlbihldmVudCk7XG4gIH0sXG4gIG9uTWVudUFmdGVyT3BlbjogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5ob3QucnVuSG9va3MoJ2FmdGVyQ29udGV4dE1lbnVTaG93JywgdGhpcyk7XG4gIH0sXG4gIG9uTWVudUFmdGVyQ2xvc2U6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaG90Lmxpc3RlbigpO1xuICAgIHRoaXMuaG90LnJ1bkhvb2tzKCdhZnRlckNvbnRleHRNZW51SGlkZScsIHRoaXMpO1xuICB9LFxuICBkZXN0cm95OiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmNsb3NlKCk7XG4gICAgaWYgKHRoaXMubWVudSkge1xuICAgICAgdGhpcy5tZW51LmRlc3Ryb3koKTtcbiAgICB9XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICRDb250ZXh0TWVudS5wcm90b3R5cGUsIFwiZGVzdHJveVwiKS5jYWxsKHRoaXMpO1xuICB9XG59LCB7Z2V0IERFRkFVTFRfSVRFTVMoKSB7XG4gICAgcmV0dXJuIFtST1dfQUJPVkUsIFJPV19CRUxPVywgU0VQQVJBVE9SLCBDT0xVTU5fTEVGVCwgQ09MVU1OX1JJR0hULCBTRVBBUkFUT1IsIFJFTU9WRV9ST1csIFJFTU9WRV9DT0xVTU4sIFNFUEFSQVRPUiwgVU5ETywgUkVETywgU0VQQVJBVE9SLCBSRUFEX09OTFksIFNFUEFSQVRPUiwgQUxJR05NRU5UXTtcbiAgfX0sIEJhc2VQbHVnaW4pO1xuQ29udGV4dE1lbnUuU0VQQVJBVE9SID0ge25hbWU6IFNFUEFSQVRPUn07XG5IYW5kc29udGFibGUuaG9va3MucmVnaXN0ZXIoJ2FmdGVyQ29udGV4dE1lbnVEZWZhdWx0T3B0aW9ucycpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLnJlZ2lzdGVyKCdhZnRlckNvbnRleHRNZW51U2hvdycpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLnJlZ2lzdGVyKCdhZnRlckNvbnRleHRNZW51SGlkZScpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLnJlZ2lzdGVyKCdhZnRlckNvbnRleHRNZW51RXhlY3V0ZScpO1xuO1xucmVnaXN0ZXJQbHVnaW4oJ2NvbnRleHRNZW51JywgQ29udGV4dE1lbnUpO1xuXG4vLyMgXG59LHtcIl9iYXNlXCI6NjIsXCJicm93c2VyXCI6MjQsXCJjb21tYW5kRXhlY3V0b3JcIjo3MCxcImV2ZW50TWFuYWdlclwiOjQyLFwiaGVscGVycy9hcnJheVwiOjQzLFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwiaGVscGVycy9kb20vZXZlbnRcIjo0OCxcIml0ZW1zRmFjdG9yeVwiOjczLFwibWVudVwiOjc0LFwicGx1Z2luc1wiOjYxLFwicHJlZGVmaW5lZEl0ZW1zXCI6NzV9XSw3MjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgQ3Vyc29yOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBDdXJzb3I7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgJF9fMSA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSksXG4gICAgZ2V0V2luZG93U2Nyb2xsTGVmdCA9ICRfXzEuZ2V0V2luZG93U2Nyb2xsTGVmdCxcbiAgICBnZXRXaW5kb3dTY3JvbGxUb3AgPSAkX18xLmdldFdpbmRvd1Njcm9sbFRvcDtcbnZhciAkX18yID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZXZlbnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X199KSxcbiAgICBwYWdlWCA9ICRfXzIucGFnZVgsXG4gICAgcGFnZVkgPSAkX18yLnBhZ2VZO1xudmFyIEN1cnNvciA9IGZ1bmN0aW9uIEN1cnNvcihvYmplY3QpIHtcbiAgdmFyIHdpbmRvd1Njcm9sbFRvcCA9IGdldFdpbmRvd1Njcm9sbFRvcCgpO1xuICB2YXIgd2luZG93U2Nyb2xsTGVmdCA9IGdldFdpbmRvd1Njcm9sbExlZnQoKTtcbiAgdmFyIHRvcCxcbiAgICAgIHRvcFJlbGF0aXZlO1xuICB2YXIgbGVmdCxcbiAgICAgIGxlZnRSZWxhdGl2ZTtcbiAgdmFyIGNlbGxIZWlnaHQsXG4gICAgICBjZWxsV2lkdGg7XG4gIHRoaXMudHlwZSA9IHRoaXMuZ2V0U291cmNlVHlwZShvYmplY3QpO1xuICBpZiAodGhpcy50eXBlID09PSAnbGl0ZXJhbCcpIHtcbiAgICB0b3AgPSBwYXJzZUludChvYmplY3QudG9wLCAxMCk7XG4gICAgbGVmdCA9IHBhcnNlSW50KG9iamVjdC5sZWZ0LCAxMCk7XG4gICAgY2VsbEhlaWdodCA9IG9iamVjdC5oZWlnaHQgfHwgMDtcbiAgICBjZWxsV2lkdGggPSBvYmplY3Qud2lkdGggfHwgMDtcbiAgICB0b3BSZWxhdGl2ZSA9IHRvcDtcbiAgICBsZWZ0UmVsYXRpdmUgPSBsZWZ0O1xuICAgIHRvcCA9IHRvcCArIHdpbmRvd1Njcm9sbFRvcDtcbiAgICBsZWZ0ID0gbGVmdCArIHdpbmRvd1Njcm9sbExlZnQ7XG4gIH0gZWxzZSBpZiAodGhpcy50eXBlID09PSAnZXZlbnQnKSB7XG4gICAgdG9wID0gcGFyc2VJbnQocGFnZVkob2JqZWN0KSwgMTApO1xuICAgIGxlZnQgPSBwYXJzZUludChwYWdlWChvYmplY3QpLCAxMCk7XG4gICAgY2VsbEhlaWdodCA9IG9iamVjdC50YXJnZXQuY2xpZW50SGVpZ2h0O1xuICAgIGNlbGxXaWR0aCA9IG9iamVjdC50YXJnZXQuY2xpZW50V2lkdGg7XG4gICAgdG9wUmVsYXRpdmUgPSB0b3AgLSB3aW5kb3dTY3JvbGxUb3A7XG4gICAgbGVmdFJlbGF0aXZlID0gbGVmdCAtIHdpbmRvd1Njcm9sbExlZnQ7XG4gIH1cbiAgdGhpcy50b3AgPSB0b3A7XG4gIHRoaXMudG9wUmVsYXRpdmUgPSB0b3BSZWxhdGl2ZTtcbiAgdGhpcy5sZWZ0ID0gbGVmdDtcbiAgdGhpcy5sZWZ0UmVsYXRpdmUgPSBsZWZ0UmVsYXRpdmU7XG4gIHRoaXMuc2Nyb2xsVG9wID0gd2luZG93U2Nyb2xsVG9wO1xuICB0aGlzLnNjcm9sbExlZnQgPSB3aW5kb3dTY3JvbGxMZWZ0O1xuICB0aGlzLmNlbGxIZWlnaHQgPSBjZWxsSGVpZ2h0O1xuICB0aGlzLmNlbGxXaWR0aCA9IGNlbGxXaWR0aDtcbn07XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShDdXJzb3IsIHtcbiAgZ2V0U291cmNlVHlwZTogZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgdmFyIHR5cGUgPSAnbGl0ZXJhbCc7XG4gICAgaWYgKG9iamVjdCBpbnN0YW5jZW9mIEV2ZW50KSB7XG4gICAgICB0eXBlID0gJ2V2ZW50JztcbiAgICB9XG4gICAgcmV0dXJuIHR5cGU7XG4gIH0sXG4gIGZpdHNBYm92ZTogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIHJldHVybiB0aGlzLnRvcFJlbGF0aXZlID49IGVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xuICB9LFxuICBmaXRzQmVsb3c6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICB2YXIgdmlld3BvcnRIZWlnaHQgPSBhcmd1bWVudHNbMV0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzFdIDogd2luZG93LmlubmVySGVpZ2h0O1xuICAgIHJldHVybiB0aGlzLnRvcFJlbGF0aXZlICsgZWxlbWVudC5vZmZzZXRIZWlnaHQgPD0gdmlld3BvcnRIZWlnaHQ7XG4gIH0sXG4gIGZpdHNPblJpZ2h0OiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgdmFyIHZpZXdwb3J0V2lkdGggPSBhcmd1bWVudHNbMV0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzFdIDogd2luZG93LmlubmVyV2lkdGg7XG4gICAgcmV0dXJuIHRoaXMubGVmdFJlbGF0aXZlICsgdGhpcy5jZWxsV2lkdGggKyBlbGVtZW50Lm9mZnNldFdpZHRoIDw9IHZpZXdwb3J0V2lkdGg7XG4gIH0sXG4gIGZpdHNPbkxlZnQ6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICByZXR1cm4gdGhpcy5sZWZ0UmVsYXRpdmUgPj0gZWxlbWVudC5vZmZzZXRXaWR0aDtcbiAgfVxufSwge30pO1xuO1xuSGFuZHNvbnRhYmxlLnBsdWdpbnMudXRpbHMgPSBIYW5kc29udGFibGUucGx1Z2lucy51dGlscyB8fCB7fTtcbkhhbmRzb250YWJsZS5wbHVnaW5zLnV0aWxzLkN1cnNvciA9IEN1cnNvcjtcblxuLy8jIFxufSx7XCJicm93c2VyXCI6MjQsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJoZWxwZXJzL2RvbS9ldmVudFwiOjQ4fV0sNzM6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIEl0ZW1zRmFjdG9yeToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gSXRlbXNGYWN0b3J5O1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyxcbiAgICAkX19wcmVkZWZpbmVkSXRlbXNfXztcbnZhciAkX18wID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gPSBfZGVyZXFfKFwiaGVscGVycy9vYmplY3RcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X199KSxcbiAgICBvYmplY3RFYWNoID0gJF9fMC5vYmplY3RFYWNoLFxuICAgIGlzT2JqZWN0ID0gJF9fMC5pc09iamVjdCxcbiAgICBleHRlbmQgPSAkX18wLmV4dGVuZDtcbnZhciBhcnJheUVhY2ggPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fID0gX2RlcmVxXyhcImhlbHBlcnMvYXJyYXlcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfX30pLmFycmF5RWFjaDtcbnZhciAkX18yID0gKCRfX3ByZWRlZmluZWRJdGVtc19fID0gX2RlcmVxXyhcInByZWRlZmluZWRJdGVtc1wiKSwgJF9fcHJlZGVmaW5lZEl0ZW1zX18gJiYgJF9fcHJlZGVmaW5lZEl0ZW1zX18uX19lc01vZHVsZSAmJiAkX19wcmVkZWZpbmVkSXRlbXNfXyB8fCB7ZGVmYXVsdDogJF9fcHJlZGVmaW5lZEl0ZW1zX199KSxcbiAgICBTRVBBUkFUT1IgPSAkX18yLlNFUEFSQVRPUixcbiAgICBJVEVNUyA9ICRfXzIuSVRFTVMsXG4gICAgcHJlZGVmaW5lZEl0ZW1zID0gJF9fMi5wcmVkZWZpbmVkSXRlbXM7XG52YXIgSXRlbXNGYWN0b3J5ID0gZnVuY3Rpb24gSXRlbXNGYWN0b3J5KGhvdEluc3RhbmNlKSB7XG4gIHZhciBvcmRlclBhdHRlcm4gPSBhcmd1bWVudHNbMV0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzFdIDogbnVsbDtcbiAgdGhpcy5ob3QgPSBob3RJbnN0YW5jZTtcbiAgdGhpcy5wcmVkZWZpbmVkSXRlbXMgPSBwcmVkZWZpbmVkSXRlbXMoKTtcbiAgdGhpcy5kZWZhdWx0T3JkZXJQYXR0ZXJuID0gb3JkZXJQYXR0ZXJuO1xufTtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKEl0ZW1zRmFjdG9yeSwge1xuICBzZXRQcmVkZWZpbmVkSXRlbXM6IGZ1bmN0aW9uKHByZWRlZmluZWRJdGVtcykge1xuICAgIHZhciAkX18zID0gdGhpcztcbiAgICB2YXIgaXRlbXMgPSB7fTtcbiAgICB0aGlzLmRlZmF1bHRPcmRlclBhdHRlcm4ubGVuZ3RoID0gMDtcbiAgICBvYmplY3RFYWNoKHByZWRlZmluZWRJdGVtcywgKGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgIHZhciBtZW51SXRlbUtleSA9ICcnO1xuICAgICAgaWYgKHZhbHVlLm5hbWUgPT09IFNFUEFSQVRPUikge1xuICAgICAgICBpdGVtc1tTRVBBUkFUT1JdID0gdmFsdWU7XG4gICAgICAgIG1lbnVJdGVtS2V5ID0gU0VQQVJBVE9SO1xuICAgICAgfSBlbHNlIGlmIChpc05hTihwYXJzZUludChrZXksIDEwKSkpIHtcbiAgICAgICAgdmFsdWUua2V5ID0gdmFsdWUua2V5ID09PSB2b2lkIDAgPyBrZXkgOiB2YWx1ZS5rZXk7XG4gICAgICAgIGl0ZW1zW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgbWVudUl0ZW1LZXkgPSB2YWx1ZS5rZXk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpdGVtc1t2YWx1ZS5rZXldID0gdmFsdWU7XG4gICAgICAgIG1lbnVJdGVtS2V5ID0gdmFsdWUua2V5O1xuICAgICAgfVxuICAgICAgJF9fMy5kZWZhdWx0T3JkZXJQYXR0ZXJuLnB1c2gobWVudUl0ZW1LZXkpO1xuICAgIH0pKTtcbiAgICB0aGlzLnByZWRlZmluZWRJdGVtcyA9IGl0ZW1zO1xuICB9LFxuICBnZXRJdGVtczogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHBhdHRlcm4gPSBhcmd1bWVudHNbMF0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzBdIDogbnVsbDtcbiAgICByZXR1cm4gZ2V0SXRlbXMocGF0dGVybiwgdGhpcy5kZWZhdWx0T3JkZXJQYXR0ZXJuLCB0aGlzLnByZWRlZmluZWRJdGVtcyk7XG4gIH1cbn0sIHt9KTtcbmZ1bmN0aW9uIGdldEl0ZW1zKCkge1xuICB2YXIgcGF0dGVybiA9IGFyZ3VtZW50c1swXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMF0gOiBudWxsO1xuICB2YXIgZGVmYXVsdFBhdHRlcm4gPSBhcmd1bWVudHNbMV0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzFdIDogW107XG4gIHZhciBpdGVtcyA9IGFyZ3VtZW50c1syXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMl0gOiB7fTtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICBpZiAocGF0dGVybiAmJiBwYXR0ZXJuLml0ZW1zKSB7XG4gICAgcGF0dGVybiA9IHBhdHRlcm4uaXRlbXM7XG4gIH0gZWxzZSBpZiAoIUFycmF5LmlzQXJyYXkocGF0dGVybikpIHtcbiAgICBwYXR0ZXJuID0gZGVmYXVsdFBhdHRlcm47XG4gIH1cbiAgaWYgKGlzT2JqZWN0KHBhdHRlcm4pKSB7XG4gICAgb2JqZWN0RWFjaChwYXR0ZXJuLCAoZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgdmFyIGl0ZW0gPSBpdGVtc1t0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnID8gdmFsdWUgOiBrZXldO1xuICAgICAgaWYgKCFpdGVtKSB7XG4gICAgICAgIGl0ZW0gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIGlmIChpc09iamVjdCh2YWx1ZSkpIHtcbiAgICAgICAgZXh0ZW5kKGl0ZW0sIHZhbHVlKTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGl0ZW0gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGl0ZW0gPSB7bmFtZTogaXRlbX07XG4gICAgICB9XG4gICAgICBpZiAoaXRlbS5rZXkgPT09IHZvaWQgMCkge1xuICAgICAgICBpdGVtLmtleSA9IGtleTtcbiAgICAgIH1cbiAgICAgIHJlc3VsdC5wdXNoKGl0ZW0pO1xuICAgIH0pKTtcbiAgfSBlbHNlIHtcbiAgICBhcnJheUVhY2gocGF0dGVybiwgKGZ1bmN0aW9uKG5hbWUsIGtleSkge1xuICAgICAgdmFyIGl0ZW0gPSBpdGVtc1tuYW1lXTtcbiAgICAgIGlmICghaXRlbSAmJiBJVEVNUy5pbmRleE9mKG5hbWUpID49IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKCFpdGVtKSB7XG4gICAgICAgIGl0ZW0gPSB7XG4gICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICBrZXk6IGtleSArICcnXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBpZiAoaXNPYmplY3QobmFtZSkpIHtcbiAgICAgICAgZXh0ZW5kKGl0ZW0sIG5hbWUpO1xuICAgICAgfVxuICAgICAgaWYgKGl0ZW0ua2V5ID09PSB2b2lkIDApIHtcbiAgICAgICAgaXRlbS5rZXkgPSBrZXk7XG4gICAgICB9XG4gICAgICByZXN1bHQucHVzaChpdGVtKTtcbiAgICB9KSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbjtcblxuLy8jIFxufSx7XCJoZWxwZXJzL2FycmF5XCI6NDMsXCJoZWxwZXJzL29iamVjdFwiOjUzLFwicHJlZGVmaW5lZEl0ZW1zXCI6NzV9XSw3NDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgTWVudToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gTWVudTtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18sXG4gICAgJF9fY3Vyc29yX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Z1bmN0aW9uX18sXG4gICAgJF9fdXRpbHNfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19taXhpbnNfNDdfbG9jYWxIb29rc19fLFxuICAgICRfX3ByZWRlZmluZWRJdGVtc19fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X187XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX199KS5kZWZhdWx0O1xudmFyICRfXzEgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLFxuICAgIGFkZENsYXNzID0gJF9fMS5hZGRDbGFzcyxcbiAgICBlbXB0eSA9ICRfXzEuZW1wdHksXG4gICAgZmFzdElubmVySFRNTCA9ICRfXzEuZmFzdElubmVySFRNTCxcbiAgICBnZXRTY3JvbGxiYXJXaWR0aCA9ICRfXzEuZ2V0U2Nyb2xsYmFyV2lkdGgsXG4gICAgaXNDaGlsZE9mID0gJF9fMS5pc0NoaWxkT2YsXG4gICAgcmVtb3ZlQ2xhc3MgPSAkX18xLnJlbW92ZUNsYXNzO1xudmFyICRfXzIgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fID0gX2RlcmVxXyhcImhlbHBlcnMvYXJyYXlcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfX30pLFxuICAgIGFycmF5RWFjaCA9ICRfXzIuYXJyYXlFYWNoLFxuICAgIGFycmF5RmlsdGVyID0gJF9fMi5hcnJheUZpbHRlcixcbiAgICBhcnJheVJlZHVjZSA9ICRfXzIuYXJyYXlSZWR1Y2U7XG52YXIgQ3Vyc29yID0gKCRfX2N1cnNvcl9fID0gX2RlcmVxXyhcImN1cnNvclwiKSwgJF9fY3Vyc29yX18gJiYgJF9fY3Vyc29yX18uX19lc01vZHVsZSAmJiAkX19jdXJzb3JfXyB8fCB7ZGVmYXVsdDogJF9fY3Vyc29yX199KS5DdXJzb3I7XG52YXIgRXZlbnRNYW5hZ2VyID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fID0gX2RlcmVxXyhcImV2ZW50TWFuYWdlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX199KS5FdmVudE1hbmFnZXI7XG52YXIgbWl4aW4gPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL29iamVjdFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfX30pLm1peGluO1xudmFyIGRlYm91bmNlID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZnVuY3Rpb25fXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2Z1bmN0aW9uXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Z1bmN0aW9uX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19mdW5jdGlvbl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19mdW5jdGlvbl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Z1bmN0aW9uX199KS5kZWJvdW5jZTtcbnZhciAkX183ID0gKCRfX3V0aWxzX18gPSBfZGVyZXFfKFwidXRpbHNcIiksICRfX3V0aWxzX18gJiYgJF9fdXRpbHNfXy5fX2VzTW9kdWxlICYmICRfX3V0aWxzX18gfHwge2RlZmF1bHQ6ICRfX3V0aWxzX199KSxcbiAgICBmaWx0ZXJTZXBhcmF0b3JzID0gJF9fNy5maWx0ZXJTZXBhcmF0b3JzLFxuICAgIGhhc1N1Yk1lbnUgPSAkX183Lmhhc1N1Yk1lbnUsXG4gICAgaXNEaXNhYmxlZCA9ICRfXzcuaXNEaXNhYmxlZCxcbiAgICBpc0l0ZW1IaWRkZW4gPSAkX183LmlzSXRlbUhpZGRlbixcbiAgICBpc1NlcGFyYXRvciA9ICRfXzcuaXNTZXBhcmF0b3IsXG4gICAgaXNTZWxlY3Rpb25EaXNhYmxlZCA9ICRfXzcuaXNTZWxlY3Rpb25EaXNhYmxlZCxcbiAgICBub3JtYWxpemVTZWxlY3Rpb24gPSAkX183Lm5vcm1hbGl6ZVNlbGVjdGlvbjtcbnZhciBLRVlfQ09ERVMgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX18gPSBfZGVyZXFfKFwiaGVscGVycy91bmljb2RlXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfX30pLktFWV9DT0RFUztcbnZhciBsb2NhbEhvb2tzID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X21peGluc180N19sb2NhbEhvb2tzX18gPSBfZGVyZXFfKFwibWl4aW5zL2xvY2FsSG9va3NcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X21peGluc180N19sb2NhbEhvb2tzX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfbWl4aW5zXzQ3X2xvY2FsSG9va3NfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X21peGluc180N19sb2NhbEhvb2tzX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X21peGluc180N19sb2NhbEhvb2tzX199KS5sb2NhbEhvb2tzO1xudmFyIFNFUEFSQVRPUiA9ICgkX19wcmVkZWZpbmVkSXRlbXNfXyA9IF9kZXJlcV8oXCJwcmVkZWZpbmVkSXRlbXNcIiksICRfX3ByZWRlZmluZWRJdGVtc19fICYmICRfX3ByZWRlZmluZWRJdGVtc19fLl9fZXNNb2R1bGUgJiYgJF9fcHJlZGVmaW5lZEl0ZW1zX18gfHwge2RlZmF1bHQ6ICRfX3ByZWRlZmluZWRJdGVtc19ffSkuU0VQQVJBVE9SO1xudmFyIHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2V2ZW50XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9ffSkuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uO1xudmFyIE1lbnUgPSBmdW5jdGlvbiBNZW51KGhvdEluc3RhbmNlLCBvcHRpb25zKSB7XG4gIHRoaXMuaG90ID0gaG90SW5zdGFuY2U7XG4gIHRoaXMub3B0aW9ucyA9IG9wdGlvbnMgfHwge1xuICAgIHBhcmVudDogbnVsbCxcbiAgICBuYW1lOiBudWxsLFxuICAgIGNsYXNzTmFtZTogJycsXG4gICAga2VlcEluVmlld3BvcnQ6IHRydWUsXG4gICAgc3RhbmRhbG9uZTogZmFsc2VcbiAgfTtcbiAgdGhpcy5ldmVudE1hbmFnZXIgPSBuZXcgRXZlbnRNYW5hZ2VyKHRoaXMpO1xuICB0aGlzLmNvbnRhaW5lciA9IHRoaXMuY3JlYXRlQ29udGFpbmVyKHRoaXMub3B0aW9ucy5uYW1lKTtcbiAgdGhpcy5ob3RNZW51ID0gbnVsbDtcbiAgdGhpcy5ob3RTdWJNZW51cyA9IHt9O1xuICB0aGlzLnBhcmVudE1lbnUgPSB0aGlzLm9wdGlvbnMucGFyZW50IHx8IG51bGw7XG4gIHRoaXMubWVudUl0ZW1zID0gbnVsbDtcbiAgdGhpcy5vcmlnT3V0c2lkZUNsaWNrRGVzZWxlY3RzID0gbnVsbDtcbiAgdGhpcy5rZXlFdmVudCA9IGZhbHNlO1xuICB0aGlzLm9mZnNldCA9IHtcbiAgICBhYm92ZTogMCxcbiAgICBiZWxvdzogMCxcbiAgICBsZWZ0OiAwLFxuICAgIHJpZ2h0OiAwXG4gIH07XG4gIHRoaXMuX2FmdGVyU2Nyb2xsQ2FsbGJhY2sgPSBudWxsO1xuICB0aGlzLnJlZ2lzdGVyRXZlbnRzKCk7XG59O1xudmFyICRNZW51ID0gTWVudTtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKE1lbnUsIHtcbiAgcmVnaXN0ZXJFdmVudHM6IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX18xMiA9IHRoaXM7XG4gICAgdGhpcy5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsICdtb3VzZWRvd24nLCAoZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHJldHVybiAkX18xMi5vbkRvY3VtZW50TW91c2VEb3duKGV2ZW50KTtcbiAgICB9KSk7XG4gIH0sXG4gIHNldE1lbnVJdGVtczogZnVuY3Rpb24obWVudUl0ZW1zKSB7XG4gICAgdGhpcy5tZW51SXRlbXMgPSBtZW51SXRlbXM7XG4gIH0sXG4gIHNldE9mZnNldDogZnVuY3Rpb24oYXJlYSkge1xuICAgIHZhciBvZmZzZXQgPSBhcmd1bWVudHNbMV0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzFdIDogMDtcbiAgICB0aGlzLm9mZnNldFthcmVhXSA9IG9mZnNldDtcbiAgfSxcbiAgaXNTdWJNZW51OiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5wYXJlbnRNZW51ICE9PSBudWxsO1xuICB9LFxuICBvcGVuOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fMTIgPSB0aGlzO1xuICAgIHRoaXMuY29udGFpbmVyLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTtcbiAgICB0aGlzLmNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICB2YXIgZGVsYXllZE9wZW5TdWJNZW51ID0gZGVib3VuY2UoKGZ1bmN0aW9uKHJvdykge1xuICAgICAgcmV0dXJuICRfXzEyLm9wZW5TdWJNZW51KHJvdyk7XG4gICAgfSksIDMwMCk7XG4gICAgdmFyIGZpbHRlcmVkSXRlbXMgPSBhcnJheUZpbHRlcih0aGlzLm1lbnVJdGVtcywgKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIHJldHVybiBpc0l0ZW1IaWRkZW4oaXRlbSwgJF9fMTIuaG90KTtcbiAgICB9KSk7XG4gICAgZmlsdGVyZWRJdGVtcyA9IGZpbHRlclNlcGFyYXRvcnMoZmlsdGVyZWRJdGVtcywgU0VQQVJBVE9SKTtcbiAgICB2YXIgc2V0dGluZ3MgPSB7XG4gICAgICBkYXRhOiBmaWx0ZXJlZEl0ZW1zLFxuICAgICAgY29sSGVhZGVyczogZmFsc2UsXG4gICAgICBjb2xXaWR0aHM6IFsyMDBdLFxuICAgICAgYXV0b1Jvd1NpemU6IGZhbHNlLFxuICAgICAgcmVhZE9ubHk6IHRydWUsXG4gICAgICBjb3B5UGFzdGU6IGZhbHNlLFxuICAgICAgY29sdW1uczogW3tcbiAgICAgICAgZGF0YTogJ25hbWUnLFxuICAgICAgICByZW5kZXJlcjogKGZ1bmN0aW9uKGhvdCwgVEQsIHJvdywgY29sLCBwcm9wLCB2YWx1ZSkge1xuICAgICAgICAgIHJldHVybiAkX18xMi5tZW51SXRlbVJlbmRlcmVyKGhvdCwgVEQsIHJvdywgY29sLCBwcm9wLCB2YWx1ZSk7XG4gICAgICAgIH0pXG4gICAgICB9XSxcbiAgICAgIHJlbmRlckFsbFJvd3M6IHRydWUsXG4gICAgICBmcmFnbWVudFNlbGVjdGlvbjogJ2NlbGwnLFxuICAgICAgZGlzYWJsZVZpc3VhbFNlbGVjdGlvbjogJ2FyZWEnLFxuICAgICAgYmVmb3JlS2V5RG93bjogKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIHJldHVybiAkX18xMi5vbkJlZm9yZUtleURvd24oZXZlbnQpO1xuICAgICAgfSksXG4gICAgICBhZnRlck9uQ2VsbE1vdXNlT3ZlcjogKGZ1bmN0aW9uKGV2ZW50LCBjb29yZHMsIFREKSB7XG4gICAgICAgIGlmICgkX18xMi5pc0FsbFN1Yk1lbnVzQ2xvc2VkKCkpIHtcbiAgICAgICAgICBkZWxheWVkT3BlblN1Yk1lbnUoY29vcmRzLnJvdyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgJF9fMTIub3BlblN1Yk1lbnUoY29vcmRzLnJvdyk7XG4gICAgICAgIH1cbiAgICAgIH0pLFxuICAgICAgcm93SGVpZ2h0czogKGZ1bmN0aW9uKHJvdykge1xuICAgICAgICByZXR1cm4gZmlsdGVyZWRJdGVtc1tyb3ddLm5hbWUgPT09IFNFUEFSQVRPUiA/IDEgOiAyMztcbiAgICAgIH0pXG4gICAgfTtcbiAgICB0aGlzLm9yaWdPdXRzaWRlQ2xpY2tEZXNlbGVjdHMgPSB0aGlzLmhvdC5nZXRTZXR0aW5ncygpLm91dHNpZGVDbGlja0Rlc2VsZWN0cztcbiAgICB0aGlzLmhvdC5nZXRTZXR0aW5ncygpLm91dHNpZGVDbGlja0Rlc2VsZWN0cyA9IGZhbHNlO1xuICAgIHRoaXMuaG90TWVudSA9IG5ldyBIYW5kc29udGFibGUuQ29yZSh0aGlzLmNvbnRhaW5lciwgc2V0dGluZ3MpO1xuICAgIHRoaXMuaG90TWVudS5hZGRIb29rKCdhZnRlckluaXQnLCAoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fMTIub25BZnRlckluaXQoKTtcbiAgICB9KSk7XG4gICAgdGhpcy5ob3RNZW51LmFkZEhvb2soJ2FmdGVyU2VsZWN0aW9uJywgKGZ1bmN0aW9uKHIsIGMsIHIyLCBjMiwgcHJldmVudFNjcm9sbGluZykge1xuICAgICAgcmV0dXJuICRfXzEyLm9uQWZ0ZXJTZWxlY3Rpb24ociwgYywgcjIsIGMyLCBwcmV2ZW50U2Nyb2xsaW5nKTtcbiAgICB9KSk7XG4gICAgdGhpcy5ob3RNZW51LmluaXQoKTtcbiAgICB0aGlzLmhvdE1lbnUubGlzdGVuKCk7XG4gICAgdGhpcy5ibG9ja01haW5UYWJsZUNhbGxiYWNrcygpO1xuICAgIHRoaXMucnVuTG9jYWxIb29rcygnYWZ0ZXJPcGVuJyk7XG4gIH0sXG4gIGNsb3NlOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgY2xvc2VQYXJlbnQgPSBhcmd1bWVudHNbMF0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzBdIDogZmFsc2U7XG4gICAgaWYgKCF0aGlzLmlzT3BlbmVkKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGNsb3NlUGFyZW50ICYmIHRoaXMucGFyZW50TWVudSkge1xuICAgICAgdGhpcy5wYXJlbnRNZW51LmNsb3NlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY2xvc2VBbGxTdWJNZW51cygpO1xuICAgICAgdGhpcy5jb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgIHRoaXMucmVsZWFzZU1haW5UYWJsZUNhbGxiYWNrcygpO1xuICAgICAgdGhpcy5ob3RNZW51LmRlc3Ryb3koKTtcbiAgICAgIHRoaXMuaG90TWVudSA9IG51bGw7XG4gICAgICB0aGlzLmhvdC5nZXRTZXR0aW5ncygpLm91dHNpZGVDbGlja0Rlc2VsZWN0cyA9IHRoaXMub3JpZ091dHNpZGVDbGlja0Rlc2VsZWN0cztcbiAgICAgIHRoaXMucnVuTG9jYWxIb29rcygnYWZ0ZXJDbG9zZScpO1xuICAgICAgaWYgKHRoaXMucGFyZW50TWVudSkge1xuICAgICAgICB0aGlzLnBhcmVudE1lbnUuaG90TWVudS5saXN0ZW4oKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIG9wZW5TdWJNZW51OiBmdW5jdGlvbihyb3cpIHtcbiAgICBpZiAoIXRoaXMuaG90TWVudSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgY2VsbCA9IHRoaXMuaG90TWVudS5nZXRDZWxsKHJvdywgMCk7XG4gICAgdGhpcy5jbG9zZUFsbFN1Yk1lbnVzKCk7XG4gICAgaWYgKCFjZWxsIHx8ICFoYXNTdWJNZW51KGNlbGwpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBkYXRhSXRlbSA9IHRoaXMuaG90TWVudS5nZXRTb3VyY2VEYXRhQXRSb3cocm93KTtcbiAgICB2YXIgc3ViTWVudSA9IG5ldyAkTWVudSh0aGlzLmhvdCwge1xuICAgICAgcGFyZW50OiB0aGlzLFxuICAgICAgbmFtZTogZGF0YUl0ZW0ubmFtZSxcbiAgICAgIGNsYXNzTmFtZTogdGhpcy5vcHRpb25zLmNsYXNzTmFtZSxcbiAgICAgIGtlZXBJblZpZXdwb3J0OiB0cnVlXG4gICAgfSk7XG4gICAgc3ViTWVudS5zZXRNZW51SXRlbXMoZGF0YUl0ZW0uc3VibWVudS5pdGVtcyk7XG4gICAgc3ViTWVudS5vcGVuKCk7XG4gICAgc3ViTWVudS5zZXRQb3NpdGlvbihjZWxsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKTtcbiAgICB0aGlzLmhvdFN1Yk1lbnVzW2RhdGFJdGVtLmtleV0gPSBzdWJNZW51O1xuICAgIHJldHVybiBzdWJNZW51O1xuICB9LFxuICBjbG9zZVN1Yk1lbnU6IGZ1bmN0aW9uKHJvdykge1xuICAgIHZhciBkYXRhSXRlbSA9IHRoaXMuaG90TWVudS5nZXRTb3VyY2VEYXRhQXRSb3cocm93KTtcbiAgICB2YXIgbWVudXMgPSB0aGlzLmhvdFN1Yk1lbnVzW2RhdGFJdGVtLmtleV07XG4gICAgaWYgKG1lbnVzKSB7XG4gICAgICBtZW51cy5kZXN0cm95KCk7XG4gICAgICBkZWxldGUgdGhpcy5ob3RTdWJNZW51c1tkYXRhSXRlbS5rZXldO1xuICAgIH1cbiAgfSxcbiAgY2xvc2VBbGxTdWJNZW51czogZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzEyID0gdGhpcztcbiAgICBhcnJheUVhY2godGhpcy5ob3RNZW51LmdldERhdGEoKSwgKGZ1bmN0aW9uKHZhbHVlLCByb3cpIHtcbiAgICAgIHJldHVybiAkX18xMi5jbG9zZVN1Yk1lbnUocm93KTtcbiAgICB9KSk7XG4gIH0sXG4gIGlzQWxsU3ViTWVudXNDbG9zZWQ6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLmhvdFN1Yk1lbnVzKS5sZW5ndGggPT09IDA7XG4gIH0sXG4gIGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuY2xlYXJMb2NhbEhvb2tzKCk7XG4gICAgdGhpcy5jbG9zZSgpO1xuICAgIHRoaXMucGFyZW50TWVudSA9IG51bGw7XG4gICAgdGhpcy5ldmVudE1hbmFnZXIuZGVzdHJveSgpO1xuICB9LFxuICBpc09wZW5lZDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuaG90TWVudSAhPT0gbnVsbDtcbiAgfSxcbiAgZXhlY3V0ZUNvbW1hbmQ6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKCF0aGlzLmlzT3BlbmVkKCkgfHwgIXRoaXMuaG90TWVudS5nZXRTZWxlY3RlZCgpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBzZWxlY3RlZEl0ZW0gPSB0aGlzLmhvdE1lbnUuZ2V0U291cmNlRGF0YUF0Um93KHRoaXMuaG90TWVudS5nZXRTZWxlY3RlZCgpWzBdKTtcbiAgICB0aGlzLnJ1bkxvY2FsSG9va3MoJ3NlbGVjdCcsIHNlbGVjdGVkSXRlbSwgZXZlbnQpO1xuICAgIGlmIChzZWxlY3RlZEl0ZW0uaXNDb21tYW5kID09PSBmYWxzZSB8fCBzZWxlY3RlZEl0ZW0ubmFtZSA9PT0gU0VQQVJBVE9SKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBzZWxSYW5nZSA9IHRoaXMuaG90LmdldFNlbGVjdGVkUmFuZ2UoKTtcbiAgICB2YXIgbm9ybWFsaXplZFNlbGVjdGlvbiA9IHNlbFJhbmdlID8gbm9ybWFsaXplU2VsZWN0aW9uKHNlbFJhbmdlKSA6IHt9O1xuICAgIHZhciBhdXRvQ2xvc2UgPSB0cnVlO1xuICAgIGlmIChzZWxlY3RlZEl0ZW0uZGlzYWJsZWQgPT09IHRydWUgfHwgKHR5cGVvZiBzZWxlY3RlZEl0ZW0uZGlzYWJsZWQgPT09ICdmdW5jdGlvbicgJiYgc2VsZWN0ZWRJdGVtLmRpc2FibGVkLmNhbGwodGhpcy5ob3QpID09PSB0cnVlKSB8fCBzZWxlY3RlZEl0ZW0uc3VibWVudSkge1xuICAgICAgYXV0b0Nsb3NlID0gZmFsc2U7XG4gICAgfVxuICAgIHRoaXMucnVuTG9jYWxIb29rcygnZXhlY3V0ZUNvbW1hbmQnLCBzZWxlY3RlZEl0ZW0ua2V5LCBub3JtYWxpemVkU2VsZWN0aW9uLCBldmVudCk7XG4gICAgaWYgKHRoaXMuaXNTdWJNZW51KCkpIHtcbiAgICAgIHRoaXMucGFyZW50TWVudS5ydW5Mb2NhbEhvb2tzKCdleGVjdXRlQ29tbWFuZCcsIHNlbGVjdGVkSXRlbS5rZXksIG5vcm1hbGl6ZWRTZWxlY3Rpb24sIGV2ZW50KTtcbiAgICB9XG4gICAgaWYgKGF1dG9DbG9zZSkge1xuICAgICAgdGhpcy5jbG9zZSh0cnVlKTtcbiAgICB9XG4gIH0sXG4gIHNldFBvc2l0aW9uOiBmdW5jdGlvbihjb29yZHMpIHtcbiAgICB2YXIgY3Vyc29yID0gbmV3IEN1cnNvcihjb29yZHMpO1xuICAgIGlmICh0aGlzLm9wdGlvbnMua2VlcEluVmlld3BvcnQpIHtcbiAgICAgIGlmIChjdXJzb3IuZml0c0JlbG93KHRoaXMuY29udGFpbmVyKSkge1xuICAgICAgICB0aGlzLnNldFBvc2l0aW9uQmVsb3dDdXJzb3IoY3Vyc29yKTtcbiAgICAgIH0gZWxzZSBpZiAoY3Vyc29yLmZpdHNBYm92ZSh0aGlzLmNvbnRhaW5lcikpIHtcbiAgICAgICAgdGhpcy5zZXRQb3NpdGlvbkFib3ZlQ3Vyc29yKGN1cnNvcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnNldFBvc2l0aW9uQmVsb3dDdXJzb3IoY3Vyc29yKTtcbiAgICAgIH1cbiAgICAgIGlmIChjdXJzb3IuZml0c09uUmlnaHQodGhpcy5jb250YWluZXIpKSB7XG4gICAgICAgIHRoaXMuc2V0UG9zaXRpb25PblJpZ2h0T2ZDdXJzb3IoY3Vyc29yKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc2V0UG9zaXRpb25PbkxlZnRPZkN1cnNvcihjdXJzb3IpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNldFBvc2l0aW9uQmVsb3dDdXJzb3IoY3Vyc29yKTtcbiAgICAgIHRoaXMuc2V0UG9zaXRpb25PblJpZ2h0T2ZDdXJzb3IoY3Vyc29yKTtcbiAgICB9XG4gIH0sXG4gIHNldFBvc2l0aW9uQWJvdmVDdXJzb3I6IGZ1bmN0aW9uKGN1cnNvcikge1xuICAgIHZhciB0b3AgPSB0aGlzLm9mZnNldC5hYm92ZSArIGN1cnNvci50b3AgLSB0aGlzLmNvbnRhaW5lci5vZmZzZXRIZWlnaHQ7XG4gICAgaWYgKHRoaXMuaXNTdWJNZW51KCkpIHtcbiAgICAgIHRvcCA9IGN1cnNvci50b3AgKyBjdXJzb3IuY2VsbEhlaWdodCAtIHRoaXMuY29udGFpbmVyLm9mZnNldEhlaWdodCArIDM7XG4gICAgfVxuICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLnRvcCA9IHRvcCArICdweCc7XG4gIH0sXG4gIHNldFBvc2l0aW9uQmVsb3dDdXJzb3I6IGZ1bmN0aW9uKGN1cnNvcikge1xuICAgIHZhciB0b3AgPSB0aGlzLm9mZnNldC5iZWxvdyArIGN1cnNvci50b3A7XG4gICAgaWYgKHRoaXMuaXNTdWJNZW51KCkpIHtcbiAgICAgIHRvcCA9IGN1cnNvci50b3AgLSAxO1xuICAgIH1cbiAgICB0aGlzLmNvbnRhaW5lci5zdHlsZS50b3AgPSB0b3AgKyAncHgnO1xuICB9LFxuICBzZXRQb3NpdGlvbk9uUmlnaHRPZkN1cnNvcjogZnVuY3Rpb24oY3Vyc29yKSB7XG4gICAgdmFyIGxlZnQ7XG4gICAgaWYgKHRoaXMuaXNTdWJNZW51KCkpIHtcbiAgICAgIGxlZnQgPSAxICsgY3Vyc29yLmxlZnQgKyBjdXJzb3IuY2VsbFdpZHRoO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZWZ0ID0gdGhpcy5vZmZzZXQucmlnaHQgKyAxICsgY3Vyc29yLmxlZnQ7XG4gICAgfVxuICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLmxlZnQgPSBsZWZ0ICsgJ3B4JztcbiAgfSxcbiAgc2V0UG9zaXRpb25PbkxlZnRPZkN1cnNvcjogZnVuY3Rpb24oY3Vyc29yKSB7XG4gICAgdmFyIGxlZnQgPSB0aGlzLm9mZnNldC5sZWZ0ICsgY3Vyc29yLmxlZnQgLSB0aGlzLmNvbnRhaW5lci5vZmZzZXRXaWR0aCArIGdldFNjcm9sbGJhcldpZHRoKCkgKyA0O1xuICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLmxlZnQgPSBsZWZ0ICsgJ3B4JztcbiAgfSxcbiAgc2VsZWN0Rmlyc3RDZWxsOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgY2VsbCA9IHRoaXMuaG90TWVudS5nZXRDZWxsKDAsIDApO1xuICAgIGlmIChpc1NlcGFyYXRvcihjZWxsKSB8fCBpc0Rpc2FibGVkKGNlbGwpIHx8IGlzU2VsZWN0aW9uRGlzYWJsZWQoY2VsbCkpIHtcbiAgICAgIHRoaXMuc2VsZWN0TmV4dENlbGwoMCwgMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaG90TWVudS5zZWxlY3RDZWxsKDAsIDApO1xuICAgIH1cbiAgfSxcbiAgc2VsZWN0TGFzdENlbGw6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBsYXN0Um93ID0gdGhpcy5ob3RNZW51LmNvdW50Um93cygpIC0gMTtcbiAgICB2YXIgY2VsbCA9IHRoaXMuaG90TWVudS5nZXRDZWxsKGxhc3RSb3csIDApO1xuICAgIGlmIChpc1NlcGFyYXRvcihjZWxsKSB8fCBpc0Rpc2FibGVkKGNlbGwpIHx8IGlzU2VsZWN0aW9uRGlzYWJsZWQoY2VsbCkpIHtcbiAgICAgIHRoaXMuc2VsZWN0UHJldkNlbGwobGFzdFJvdywgMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaG90TWVudS5zZWxlY3RDZWxsKGxhc3RSb3csIDApO1xuICAgIH1cbiAgfSxcbiAgc2VsZWN0TmV4dENlbGw6IGZ1bmN0aW9uKHJvdywgY29sKSB7XG4gICAgdmFyIG5leHRSb3cgPSByb3cgKyAxO1xuICAgIHZhciBjZWxsID0gbmV4dFJvdyA8IHRoaXMuaG90TWVudS5jb3VudFJvd3MoKSA/IHRoaXMuaG90TWVudS5nZXRDZWxsKG5leHRSb3csIGNvbCkgOiBudWxsO1xuICAgIGlmICghY2VsbCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoaXNTZXBhcmF0b3IoY2VsbCkgfHwgaXNEaXNhYmxlZChjZWxsKSB8fCBpc1NlbGVjdGlvbkRpc2FibGVkKGNlbGwpKSB7XG4gICAgICB0aGlzLnNlbGVjdE5leHRDZWxsKG5leHRSb3csIGNvbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaG90TWVudS5zZWxlY3RDZWxsKG5leHRSb3csIGNvbCk7XG4gICAgfVxuICB9LFxuICBzZWxlY3RQcmV2Q2VsbDogZnVuY3Rpb24ocm93LCBjb2wpIHtcbiAgICB2YXIgcHJldlJvdyA9IHJvdyAtIDE7XG4gICAgdmFyIGNlbGwgPSBwcmV2Um93ID49IDAgPyB0aGlzLmhvdE1lbnUuZ2V0Q2VsbChwcmV2Um93LCBjb2wpIDogbnVsbDtcbiAgICBpZiAoIWNlbGwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGlzU2VwYXJhdG9yKGNlbGwpIHx8IGlzRGlzYWJsZWQoY2VsbCkgfHwgaXNTZWxlY3Rpb25EaXNhYmxlZChjZWxsKSkge1xuICAgICAgdGhpcy5zZWxlY3RQcmV2Q2VsbChwcmV2Um93LCBjb2wpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmhvdE1lbnUuc2VsZWN0Q2VsbChwcmV2Um93LCBjb2wpO1xuICAgIH1cbiAgfSxcbiAgbWVudUl0ZW1SZW5kZXJlcjogZnVuY3Rpb24oaG90LCBURCwgcm93LCBjb2wsIHByb3AsIHZhbHVlKSB7XG4gICAgdmFyICRfXzEyID0gdGhpcztcbiAgICB2YXIgaXRlbSA9IGhvdC5nZXRTb3VyY2VEYXRhQXRSb3cocm93KTtcbiAgICB2YXIgd3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHZhciBpc1N1Yk1lbnUgPSAoZnVuY3Rpb24oaXRlbSkge1xuICAgICAgcmV0dXJuIGl0ZW0uaGFzT3duUHJvcGVydHkoJ3N1Ym1lbnUnKTtcbiAgICB9KTtcbiAgICB2YXIgaXRlbUlzU2VwYXJhdG9yID0gKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIHJldHVybiBuZXcgUmVnRXhwKFNFUEFSQVRPUiwgJ2knKS50ZXN0KGl0ZW0ubmFtZSk7XG4gICAgfSk7XG4gICAgdmFyIGl0ZW1Jc0Rpc2FibGVkID0gKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIHJldHVybiBpdGVtLmRpc2FibGVkID09PSB0cnVlIHx8ICh0eXBlb2YgaXRlbS5kaXNhYmxlZCA9PSAnZnVuY3Rpb24nICYmIGl0ZW0uZGlzYWJsZWQuY2FsbCgkX18xMi5ob3QpID09PSB0cnVlKTtcbiAgICB9KTtcbiAgICB2YXIgaXRlbUlzU2VsZWN0aW9uRGlzYWJsZWQgPSAoZnVuY3Rpb24oaXRlbSkge1xuICAgICAgcmV0dXJuIGl0ZW0uZGlzYWJsZVNlbGVjdGlvbjtcbiAgICB9KTtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICB2YWx1ZSA9IHZhbHVlLmNhbGwodGhpcy5ob3QpO1xuICAgIH1cbiAgICBlbXB0eShURCk7XG4gICAgYWRkQ2xhc3Mod3JhcHBlciwgJ2h0SXRlbVdyYXBwZXInKTtcbiAgICBURC5hcHBlbmRDaGlsZCh3cmFwcGVyKTtcbiAgICBpZiAoaXRlbUlzU2VwYXJhdG9yKGl0ZW0pKSB7XG4gICAgICBhZGRDbGFzcyhURCwgJ2h0U2VwYXJhdG9yJyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgaXRlbS5yZW5kZXJlciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgYWRkQ2xhc3MoVEQsICdodEN1c3RvbU1lbnVSZW5kZXJlcicpO1xuICAgICAgVEQuYXBwZW5kQ2hpbGQoaXRlbS5yZW5kZXJlcihob3QsIHdyYXBwZXIsIHJvdywgY29sLCBwcm9wLCB2YWx1ZSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmYXN0SW5uZXJIVE1MKHdyYXBwZXIsIHZhbHVlKTtcbiAgICB9XG4gICAgaWYgKGl0ZW1Jc0Rpc2FibGVkKGl0ZW0pKSB7XG4gICAgICBhZGRDbGFzcyhURCwgJ2h0RGlzYWJsZWQnKTtcbiAgICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoVEQsICdtb3VzZWVudGVyJywgKGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gaG90LmRlc2VsZWN0Q2VsbCgpO1xuICAgICAgfSkpO1xuICAgIH0gZWxzZSBpZiAoaXRlbUlzU2VsZWN0aW9uRGlzYWJsZWQoaXRlbSkpIHtcbiAgICAgIGFkZENsYXNzKFRELCAnaHRTZWxlY3Rpb25EaXNhYmxlZCcpO1xuICAgICAgdGhpcy5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihURCwgJ21vdXNlZW50ZXInLCAoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBob3QuZGVzZWxlY3RDZWxsKCk7XG4gICAgICB9KSk7XG4gICAgfSBlbHNlIGlmIChpc1N1Yk1lbnUoaXRlbSkpIHtcbiAgICAgIGFkZENsYXNzKFRELCAnaHRTdWJtZW51Jyk7XG4gICAgICBpZiAoaXRlbUlzU2VsZWN0aW9uRGlzYWJsZWQoaXRlbSkpIHtcbiAgICAgICAgdGhpcy5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihURCwgJ21vdXNlZW50ZXInLCAoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGhvdC5kZXNlbGVjdENlbGwoKTtcbiAgICAgICAgfSkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihURCwgJ21vdXNlZW50ZXInLCAoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGhvdC5zZWxlY3RDZWxsKHJvdywgY29sLCB2b2lkIDAsIHZvaWQgMCwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZW1vdmVDbGFzcyhURCwgJ2h0U3VibWVudScpO1xuICAgICAgcmVtb3ZlQ2xhc3MoVEQsICdodERpc2FibGVkJyk7XG4gICAgICBpZiAoaXRlbUlzU2VsZWN0aW9uRGlzYWJsZWQoaXRlbSkpIHtcbiAgICAgICAgdGhpcy5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihURCwgJ21vdXNlZW50ZXInLCAoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGhvdC5kZXNlbGVjdENlbGwoKTtcbiAgICAgICAgfSkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihURCwgJ21vdXNlZW50ZXInLCAoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGhvdC5zZWxlY3RDZWxsKHJvdywgY29sLCB2b2lkIDAsIHZvaWQgMCwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgY3JlYXRlQ29udGFpbmVyOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgbmFtZSA9IGFyZ3VtZW50c1swXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMF0gOiBudWxsO1xuICAgIGlmIChuYW1lKSB7XG4gICAgICBuYW1lID0gbmFtZS5yZXBsYWNlKC9bXkEtejAtOV0vZywgJ18nKTtcbiAgICAgIG5hbWUgPSB0aGlzLm9wdGlvbnMuY2xhc3NOYW1lICsgJ1N1Yl8nICsgbmFtZTtcbiAgICB9XG4gICAgdmFyIGNvbnRhaW5lcjtcbiAgICBpZiAobmFtZSkge1xuICAgICAgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLicgKyB0aGlzLm9wdGlvbnMuY2xhc3NOYW1lICsgJy4nICsgbmFtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGhpcy5vcHRpb25zLmNsYXNzTmFtZSk7XG4gICAgfVxuICAgIGlmICghY29udGFpbmVyKSB7XG4gICAgICBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIGFkZENsYXNzKGNvbnRhaW5lciwgJ2h0TWVudSAnICsgdGhpcy5vcHRpb25zLmNsYXNzTmFtZSk7XG4gICAgICBpZiAobmFtZSkge1xuICAgICAgICBhZGRDbGFzcyhjb250YWluZXIsIG5hbWUpO1xuICAgICAgfVxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXS5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuICAgIH1cbiAgICByZXR1cm4gY29udGFpbmVyO1xuICB9LFxuICBibG9ja01haW5UYWJsZUNhbGxiYWNrczogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5fYWZ0ZXJTY3JvbGxDYWxsYmFjayA9IGZ1bmN0aW9uKCkge307XG4gICAgdGhpcy5ob3QuYWRkSG9vaygnYWZ0ZXJTY3JvbGxWZXJ0aWNhbGx5JywgdGhpcy5fYWZ0ZXJTY3JvbGxDYWxsYmFjayk7XG4gICAgdGhpcy5ob3QuYWRkSG9vaygnYWZ0ZXJTY3JvbGxIb3Jpem9udGFsbHknLCB0aGlzLl9hZnRlclNjcm9sbENhbGxiYWNrKTtcbiAgfSxcbiAgcmVsZWFzZU1haW5UYWJsZUNhbGxiYWNrczogZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuX2FmdGVyU2Nyb2xsQ2FsbGJhY2spIHtcbiAgICAgIHRoaXMuaG90LnJlbW92ZUhvb2soJ2FmdGVyU2Nyb2xsVmVydGljYWxseScsIHRoaXMuX2FmdGVyU2Nyb2xsQ2FsbGJhY2spO1xuICAgICAgdGhpcy5ob3QucmVtb3ZlSG9vaygnYWZ0ZXJTY3JvbGxIb3Jpem9udGFsbHknLCB0aGlzLl9hZnRlclNjcm9sbENhbGxiYWNrKTtcbiAgICAgIHRoaXMuX2FmdGVyU2Nyb2xsQ2FsbGJhY2sgPSBudWxsO1xuICAgIH1cbiAgfSxcbiAgb25CZWZvcmVLZXlEb3duOiBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciBzZWxlY3Rpb24gPSB0aGlzLmhvdE1lbnUuZ2V0U2VsZWN0ZWQoKTtcbiAgICB2YXIgc3RvcEV2ZW50ID0gZmFsc2U7XG4gICAgdGhpcy5rZXlFdmVudCA9IHRydWU7XG4gICAgc3dpdGNoIChldmVudC5rZXlDb2RlKSB7XG4gICAgICBjYXNlIEtFWV9DT0RFUy5FU0NBUEU6XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgc3RvcEV2ZW50ID0gdHJ1ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEtFWV9DT0RFUy5FTlRFUjpcbiAgICAgICAgaWYgKHNlbGVjdGlvbikge1xuICAgICAgICAgIGlmICh0aGlzLmhvdE1lbnUuZ2V0U291cmNlRGF0YUF0Um93KHNlbGVjdGlvblswXSkuc3VibWVudSkge1xuICAgICAgICAgICAgc3RvcEV2ZW50ID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5leGVjdXRlQ29tbWFuZChldmVudCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKHRydWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgS0VZX0NPREVTLkFSUk9XX0RPV046XG4gICAgICAgIGlmIChzZWxlY3Rpb24pIHtcbiAgICAgICAgICB0aGlzLnNlbGVjdE5leHRDZWxsKHNlbGVjdGlvblswXSwgc2VsZWN0aW9uWzFdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnNlbGVjdEZpcnN0Q2VsbCgpO1xuICAgICAgICB9XG4gICAgICAgIHN0b3BFdmVudCA9IHRydWU7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBLRVlfQ09ERVMuQVJST1dfVVA6XG4gICAgICAgIGlmIChzZWxlY3Rpb24pIHtcbiAgICAgICAgICB0aGlzLnNlbGVjdFByZXZDZWxsKHNlbGVjdGlvblswXSwgc2VsZWN0aW9uWzFdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnNlbGVjdExhc3RDZWxsKCk7XG4gICAgICAgIH1cbiAgICAgICAgc3RvcEV2ZW50ID0gdHJ1ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEtFWV9DT0RFUy5BUlJPV19SSUdIVDpcbiAgICAgICAgaWYgKHNlbGVjdGlvbikge1xuICAgICAgICAgIHZhciBtZW51ID0gdGhpcy5vcGVuU3ViTWVudShzZWxlY3Rpb25bMF0pO1xuICAgICAgICAgIGlmIChtZW51KSB7XG4gICAgICAgICAgICBtZW51LnNlbGVjdEZpcnN0Q2VsbCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzdG9wRXZlbnQgPSB0cnVlO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgS0VZX0NPREVTLkFSUk9XX0xFRlQ6XG4gICAgICAgIGlmIChzZWxlY3Rpb24gJiYgdGhpcy5pc1N1Yk1lbnUoKSkge1xuICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICBpZiAodGhpcy5wYXJlbnRNZW51KSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudE1lbnUuaG90TWVudS5saXN0ZW4oKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgc3RvcEV2ZW50ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICB9XG4gICAgaWYgKHN0b3BFdmVudCkge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbihldmVudCk7XG4gICAgfVxuICAgIHRoaXMua2V5RXZlbnQgPSBmYWxzZTtcbiAgfSxcbiAgb25BZnRlckluaXQ6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBkYXRhID0gdGhpcy5ob3RNZW51LmdldFNldHRpbmdzKCkuZGF0YTtcbiAgICB2YXIgaGlkZXJTdHlsZSA9IHRoaXMuaG90TWVudS52aWV3Lnd0Lnd0VGFibGUuaGlkZXIuc3R5bGU7XG4gICAgdmFyIGhvbGRlclN0eWxlID0gdGhpcy5ob3RNZW51LnZpZXcud3Qud3RUYWJsZS5ob2xkZXIuc3R5bGU7XG4gICAgdmFyIGN1cnJlbnRIaWRlcldpZHRoID0gcGFyc2VJbnQoaGlkZXJTdHlsZS53aWR0aCwgMTApO1xuICAgIHZhciByZWFsSGVpZ2h0ID0gYXJyYXlSZWR1Y2UoZGF0YSwgKGZ1bmN0aW9uKGFjY3VtdWxhdG9yLCB2YWx1ZSkge1xuICAgICAgcmV0dXJuIGFjY3VtdWxhdG9yICsgKHZhbHVlLm5hbWUgPT09IFNFUEFSQVRPUiA/IDEgOiAyNik7XG4gICAgfSksIDApO1xuICAgIGhvbGRlclN0eWxlLndpZHRoID0gY3VycmVudEhpZGVyV2lkdGggKyAyMiArICdweCc7XG4gICAgaG9sZGVyU3R5bGUuaGVpZ2h0ID0gcmVhbEhlaWdodCArIDQgKyAncHgnO1xuICAgIGhpZGVyU3R5bGUuaGVpZ2h0ID0gaG9sZGVyU3R5bGUuaGVpZ2h0O1xuICB9LFxuICBvbkFmdGVyU2VsZWN0aW9uOiBmdW5jdGlvbihyLCBjLCByMiwgYzIsIHByZXZlbnRTY3JvbGxpbmcpIHtcbiAgICBpZiAodGhpcy5rZXlFdmVudCA9PT0gZmFsc2UpIHtcbiAgICAgIHByZXZlbnRTY3JvbGxpbmcudmFsdWUgPSB0cnVlO1xuICAgIH1cbiAgfSxcbiAgb25Eb2N1bWVudE1vdXNlRG93bjogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAoIXRoaXMuaXNPcGVuZWQoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodGhpcy5jb250YWluZXIgJiYgaXNDaGlsZE9mKGV2ZW50LnRhcmdldCwgdGhpcy5jb250YWluZXIpKSB7XG4gICAgICB0aGlzLmV4ZWN1dGVDb21tYW5kKGV2ZW50KTtcbiAgICB9XG4gICAgaWYgKHRoaXMub3B0aW9ucy5zdGFuZGFsb25lICYmIHRoaXMuaG90TWVudSAmJiAhaXNDaGlsZE9mKGV2ZW50LnRhcmdldCwgdGhpcy5ob3RNZW51LnJvb3RFbGVtZW50KSkge1xuICAgICAgdGhpcy5jbG9zZSh0cnVlKTtcbiAgICB9IGVsc2UgaWYgKCh0aGlzLmlzQWxsU3ViTWVudXNDbG9zZWQoKSB8fCB0aGlzLmlzU3ViTWVudSgpKSAmJiAoIWlzQ2hpbGRPZihldmVudC50YXJnZXQsICcuaHRNZW51JykgJiYgaXNDaGlsZE9mKGV2ZW50LnRhcmdldCwgZG9jdW1lbnQpKSkge1xuICAgICAgdGhpcy5jbG9zZSh0cnVlKTtcbiAgICB9XG4gIH1cbn0sIHt9KTtcbm1peGluKE1lbnUsIGxvY2FsSG9va3MpO1xuO1xuXG4vLyMgXG59LHtcImJyb3dzZXJcIjoyNCxcImN1cnNvclwiOjcyLFwiZXZlbnRNYW5hZ2VyXCI6NDIsXCJoZWxwZXJzL2FycmF5XCI6NDMsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJoZWxwZXJzL2RvbS9ldmVudFwiOjQ4LFwiaGVscGVycy9mdW5jdGlvblwiOjUwLFwiaGVscGVycy9vYmplY3RcIjo1MyxcImhlbHBlcnMvdW5pY29kZVwiOjU2LFwibWl4aW5zL2xvY2FsSG9va3NcIjo1OCxcInByZWRlZmluZWRJdGVtc1wiOjc1LFwidXRpbHNcIjo4OH1dLDc1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xudmFyICRfXzEzO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBBTElHTk1FTlQ6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICRfX3ByZWRlZmluZWRJdGVtc180N19hbGlnbm1lbnRfXy5LRVk7XG4gICAgfX0sXG4gIENMRUFSX0NPTFVNTjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NsZWFyQ29sdW1uX18uS0VZO1xuICAgIH19LFxuICBDT0xVTU5fTEVGVDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NvbHVtbkxlZnRfXy5LRVk7XG4gICAgfX0sXG4gIENPTFVNTl9SSUdIVDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NvbHVtblJpZ2h0X18uS0VZO1xuICAgIH19LFxuICBSRUFEX09OTFk6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICRfX3ByZWRlZmluZWRJdGVtc180N19yZWFkT25seV9fLktFWTtcbiAgICB9fSxcbiAgUkVETzoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlZG9fXy5LRVk7XG4gICAgfX0sXG4gIFJFTU9WRV9DT0xVTU46IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICRfX3ByZWRlZmluZWRJdGVtc180N19yZW1vdmVDb2x1bW5fXy5LRVk7XG4gICAgfX0sXG4gIFJFTU9WRV9ST1c6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICRfX3ByZWRlZmluZWRJdGVtc180N19yZW1vdmVSb3dfXy5LRVk7XG4gICAgfX0sXG4gIFJPV19BQk9WRToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3Jvd0Fib3ZlX18uS0VZO1xuICAgIH19LFxuICBST1dfQkVMT1c6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICRfX3ByZWRlZmluZWRJdGVtc180N19yb3dCZWxvd19fLktFWTtcbiAgICB9fSxcbiAgU0VQQVJBVE9SOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfc2VwYXJhdG9yX18uS0VZO1xuICAgIH19LFxuICBVTkRPOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfdW5kb19fLktFWTtcbiAgICB9fSxcbiAgSVRFTVM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIElURU1TO1xuICAgIH19LFxuICBwcmVkZWZpbmVkSXRlbXM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHByZWRlZmluZWRJdGVtcztcbiAgICB9fSxcbiAgYWRkSXRlbToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gYWRkSXRlbTtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyxcbiAgICAkX19wcmVkZWZpbmVkSXRlbXNfNDdfYWxpZ25tZW50X18sXG4gICAgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NsZWFyQ29sdW1uX18sXG4gICAgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NvbHVtbkxlZnRfXyxcbiAgICAkX19wcmVkZWZpbmVkSXRlbXNfNDdfY29sdW1uUmlnaHRfXyxcbiAgICAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcmVhZE9ubHlfXyxcbiAgICAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcmVkb19fLFxuICAgICRfX3ByZWRlZmluZWRJdGVtc180N19yZW1vdmVDb2x1bW5fXyxcbiAgICAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcmVtb3ZlUm93X18sXG4gICAgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3Jvd0Fib3ZlX18sXG4gICAgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3Jvd0JlbG93X18sXG4gICAgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3NlcGFyYXRvcl9fLFxuICAgICRfX3ByZWRlZmluZWRJdGVtc180N191bmRvX18sXG4gICAgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2FsaWdubWVudF9fLFxuICAgICRfX3ByZWRlZmluZWRJdGVtc180N19jbGVhckNvbHVtbl9fLFxuICAgICRfX3ByZWRlZmluZWRJdGVtc180N19jb2x1bW5MZWZ0X18sXG4gICAgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NvbHVtblJpZ2h0X18sXG4gICAgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlYWRPbmx5X18sXG4gICAgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlZG9fXyxcbiAgICAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcmVtb3ZlQ29sdW1uX18sXG4gICAgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlbW92ZVJvd19fLFxuICAgICRfX3ByZWRlZmluZWRJdGVtc180N19yb3dBYm92ZV9fLFxuICAgICRfX3ByZWRlZmluZWRJdGVtc180N19yb3dCZWxvd19fLFxuICAgICRfX3ByZWRlZmluZWRJdGVtc180N19zZXBhcmF0b3JfXyxcbiAgICAkX19wcmVkZWZpbmVkSXRlbXNfNDdfdW5kb19fO1xudmFyIG9iamVjdEVhY2ggPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL29iamVjdFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfX30pLm9iamVjdEVhY2g7XG52YXIgJF9fMSA9ICgkX19wcmVkZWZpbmVkSXRlbXNfNDdfYWxpZ25tZW50X18gPSBfZGVyZXFfKFwicHJlZGVmaW5lZEl0ZW1zL2FsaWdubWVudFwiKSwgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2FsaWdubWVudF9fICYmICRfX3ByZWRlZmluZWRJdGVtc180N19hbGlnbm1lbnRfXy5fX2VzTW9kdWxlICYmICRfX3ByZWRlZmluZWRJdGVtc180N19hbGlnbm1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2FsaWdubWVudF9ffSksXG4gICAgYWxpZ25tZW50SXRlbSA9ICRfXzEuYWxpZ25tZW50SXRlbSxcbiAgICBBTElHTk1FTlQgPSAkX18xLktFWTtcbnZhciAkX18yID0gKCRfX3ByZWRlZmluZWRJdGVtc180N19jbGVhckNvbHVtbl9fID0gX2RlcmVxXyhcInByZWRlZmluZWRJdGVtcy9jbGVhckNvbHVtblwiKSwgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NsZWFyQ29sdW1uX18gJiYgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NsZWFyQ29sdW1uX18uX19lc01vZHVsZSAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfY2xlYXJDb2x1bW5fXyB8fCB7ZGVmYXVsdDogJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NsZWFyQ29sdW1uX199KSxcbiAgICBjbGVhckNvbHVtbkl0ZW0gPSAkX18yLmNsZWFyQ29sdW1uSXRlbSxcbiAgICBDTEVBUl9DT0xVTU4gPSAkX18yLktFWTtcbnZhciAkX18zID0gKCRfX3ByZWRlZmluZWRJdGVtc180N19jb2x1bW5MZWZ0X18gPSBfZGVyZXFfKFwicHJlZGVmaW5lZEl0ZW1zL2NvbHVtbkxlZnRcIiksICRfX3ByZWRlZmluZWRJdGVtc180N19jb2x1bW5MZWZ0X18gJiYgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NvbHVtbkxlZnRfXy5fX2VzTW9kdWxlICYmICRfX3ByZWRlZmluZWRJdGVtc180N19jb2x1bW5MZWZ0X18gfHwge2RlZmF1bHQ6ICRfX3ByZWRlZmluZWRJdGVtc180N19jb2x1bW5MZWZ0X199KSxcbiAgICBjb2x1bW5MZWZ0SXRlbSA9ICRfXzMuY29sdW1uTGVmdEl0ZW0sXG4gICAgQ09MVU1OX0xFRlQgPSAkX18zLktFWTtcbnZhciAkX180ID0gKCRfX3ByZWRlZmluZWRJdGVtc180N19jb2x1bW5SaWdodF9fID0gX2RlcmVxXyhcInByZWRlZmluZWRJdGVtcy9jb2x1bW5SaWdodFwiKSwgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NvbHVtblJpZ2h0X18gJiYgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NvbHVtblJpZ2h0X18uX19lc01vZHVsZSAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfY29sdW1uUmlnaHRfXyB8fCB7ZGVmYXVsdDogJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NvbHVtblJpZ2h0X199KSxcbiAgICBjb2x1bW5SaWdodEl0ZW0gPSAkX180LmNvbHVtblJpZ2h0SXRlbSxcbiAgICBDT0xVTU5fUklHSFQgPSAkX180LktFWTtcbnZhciAkX181ID0gKCRfX3ByZWRlZmluZWRJdGVtc180N19yZWFkT25seV9fID0gX2RlcmVxXyhcInByZWRlZmluZWRJdGVtcy9yZWFkT25seVwiKSwgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlYWRPbmx5X18gJiYgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlYWRPbmx5X18uX19lc01vZHVsZSAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcmVhZE9ubHlfXyB8fCB7ZGVmYXVsdDogJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlYWRPbmx5X199KSxcbiAgICByZWFkT25seUl0ZW0gPSAkX181LnJlYWRPbmx5SXRlbSxcbiAgICBSRUFEX09OTFkgPSAkX181LktFWTtcbnZhciAkX182ID0gKCRfX3ByZWRlZmluZWRJdGVtc180N19yZWRvX18gPSBfZGVyZXFfKFwicHJlZGVmaW5lZEl0ZW1zL3JlZG9cIiksICRfX3ByZWRlZmluZWRJdGVtc180N19yZWRvX18gJiYgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlZG9fXy5fX2VzTW9kdWxlICYmICRfX3ByZWRlZmluZWRJdGVtc180N19yZWRvX18gfHwge2RlZmF1bHQ6ICRfX3ByZWRlZmluZWRJdGVtc180N19yZWRvX199KSxcbiAgICByZWRvSXRlbSA9ICRfXzYucmVkb0l0ZW0sXG4gICAgUkVETyA9ICRfXzYuS0VZO1xudmFyICRfXzcgPSAoJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlbW92ZUNvbHVtbl9fID0gX2RlcmVxXyhcInByZWRlZmluZWRJdGVtcy9yZW1vdmVDb2x1bW5cIiksICRfX3ByZWRlZmluZWRJdGVtc180N19yZW1vdmVDb2x1bW5fXyAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcmVtb3ZlQ29sdW1uX18uX19lc01vZHVsZSAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcmVtb3ZlQ29sdW1uX18gfHwge2RlZmF1bHQ6ICRfX3ByZWRlZmluZWRJdGVtc180N19yZW1vdmVDb2x1bW5fX30pLFxuICAgIHJlbW92ZUNvbHVtbkl0ZW0gPSAkX183LnJlbW92ZUNvbHVtbkl0ZW0sXG4gICAgUkVNT1ZFX0NPTFVNTiA9ICRfXzcuS0VZO1xudmFyICRfXzggPSAoJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlbW92ZVJvd19fID0gX2RlcmVxXyhcInByZWRlZmluZWRJdGVtcy9yZW1vdmVSb3dcIiksICRfX3ByZWRlZmluZWRJdGVtc180N19yZW1vdmVSb3dfXyAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcmVtb3ZlUm93X18uX19lc01vZHVsZSAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcmVtb3ZlUm93X18gfHwge2RlZmF1bHQ6ICRfX3ByZWRlZmluZWRJdGVtc180N19yZW1vdmVSb3dfX30pLFxuICAgIHJlbW92ZVJvd0l0ZW0gPSAkX184LnJlbW92ZVJvd0l0ZW0sXG4gICAgUkVNT1ZFX1JPVyA9ICRfXzguS0VZO1xudmFyICRfXzkgPSAoJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3Jvd0Fib3ZlX18gPSBfZGVyZXFfKFwicHJlZGVmaW5lZEl0ZW1zL3Jvd0Fib3ZlXCIpLCAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcm93QWJvdmVfXyAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcm93QWJvdmVfXy5fX2VzTW9kdWxlICYmICRfX3ByZWRlZmluZWRJdGVtc180N19yb3dBYm92ZV9fIHx8IHtkZWZhdWx0OiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcm93QWJvdmVfX30pLFxuICAgIHJvd0Fib3ZlSXRlbSA9ICRfXzkucm93QWJvdmVJdGVtLFxuICAgIFJPV19BQk9WRSA9ICRfXzkuS0VZO1xudmFyICRfXzEwID0gKCRfX3ByZWRlZmluZWRJdGVtc180N19yb3dCZWxvd19fID0gX2RlcmVxXyhcInByZWRlZmluZWRJdGVtcy9yb3dCZWxvd1wiKSwgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3Jvd0JlbG93X18gJiYgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3Jvd0JlbG93X18uX19lc01vZHVsZSAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcm93QmVsb3dfXyB8fCB7ZGVmYXVsdDogJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3Jvd0JlbG93X199KSxcbiAgICByb3dCZWxvd0l0ZW0gPSAkX18xMC5yb3dCZWxvd0l0ZW0sXG4gICAgUk9XX0JFTE9XID0gJF9fMTAuS0VZO1xudmFyICRfXzExID0gKCRfX3ByZWRlZmluZWRJdGVtc180N19zZXBhcmF0b3JfXyA9IF9kZXJlcV8oXCJwcmVkZWZpbmVkSXRlbXMvc2VwYXJhdG9yXCIpLCAkX19wcmVkZWZpbmVkSXRlbXNfNDdfc2VwYXJhdG9yX18gJiYgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3NlcGFyYXRvcl9fLl9fZXNNb2R1bGUgJiYgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3NlcGFyYXRvcl9fIHx8IHtkZWZhdWx0OiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfc2VwYXJhdG9yX199KSxcbiAgICBzZXBhcmF0b3JJdGVtID0gJF9fMTEuc2VwYXJhdG9ySXRlbSxcbiAgICBTRVBBUkFUT1IgPSAkX18xMS5LRVk7XG52YXIgJF9fMTIgPSAoJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3VuZG9fXyA9IF9kZXJlcV8oXCJwcmVkZWZpbmVkSXRlbXMvdW5kb1wiKSwgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3VuZG9fXyAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfdW5kb19fLl9fZXNNb2R1bGUgJiYgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3VuZG9fXyB8fCB7ZGVmYXVsdDogJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3VuZG9fX30pLFxuICAgIHVuZG9JdGVtID0gJF9fMTIudW5kb0l0ZW0sXG4gICAgVU5ETyA9ICRfXzEyLktFWTtcbnZhciAkX19wcmVkZWZpbmVkSXRlbXNfNDdfYWxpZ25tZW50X18gPSAoJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2FsaWdubWVudF9fID0gX2RlcmVxXyhcInByZWRlZmluZWRJdGVtcy9hbGlnbm1lbnRcIiksICRfX3ByZWRlZmluZWRJdGVtc180N19hbGlnbm1lbnRfXyAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfYWxpZ25tZW50X18uX19lc01vZHVsZSAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfYWxpZ25tZW50X18gfHwge2RlZmF1bHQ6ICRfX3ByZWRlZmluZWRJdGVtc180N19hbGlnbm1lbnRfX30pO1xudmFyICRfX3ByZWRlZmluZWRJdGVtc180N19jbGVhckNvbHVtbl9fID0gKCRfX3ByZWRlZmluZWRJdGVtc180N19jbGVhckNvbHVtbl9fID0gX2RlcmVxXyhcInByZWRlZmluZWRJdGVtcy9jbGVhckNvbHVtblwiKSwgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NsZWFyQ29sdW1uX18gJiYgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NsZWFyQ29sdW1uX18uX19lc01vZHVsZSAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfY2xlYXJDb2x1bW5fXyB8fCB7ZGVmYXVsdDogJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NsZWFyQ29sdW1uX199KTtcbnZhciAkX19wcmVkZWZpbmVkSXRlbXNfNDdfY29sdW1uTGVmdF9fID0gKCRfX3ByZWRlZmluZWRJdGVtc180N19jb2x1bW5MZWZ0X18gPSBfZGVyZXFfKFwicHJlZGVmaW5lZEl0ZW1zL2NvbHVtbkxlZnRcIiksICRfX3ByZWRlZmluZWRJdGVtc180N19jb2x1bW5MZWZ0X18gJiYgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NvbHVtbkxlZnRfXy5fX2VzTW9kdWxlICYmICRfX3ByZWRlZmluZWRJdGVtc180N19jb2x1bW5MZWZ0X18gfHwge2RlZmF1bHQ6ICRfX3ByZWRlZmluZWRJdGVtc180N19jb2x1bW5MZWZ0X199KTtcbnZhciAkX19wcmVkZWZpbmVkSXRlbXNfNDdfY29sdW1uUmlnaHRfXyA9ICgkX19wcmVkZWZpbmVkSXRlbXNfNDdfY29sdW1uUmlnaHRfXyA9IF9kZXJlcV8oXCJwcmVkZWZpbmVkSXRlbXMvY29sdW1uUmlnaHRcIiksICRfX3ByZWRlZmluZWRJdGVtc180N19jb2x1bW5SaWdodF9fICYmICRfX3ByZWRlZmluZWRJdGVtc180N19jb2x1bW5SaWdodF9fLl9fZXNNb2R1bGUgJiYgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X2NvbHVtblJpZ2h0X18gfHwge2RlZmF1bHQ6ICRfX3ByZWRlZmluZWRJdGVtc180N19jb2x1bW5SaWdodF9ffSk7XG52YXIgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlYWRPbmx5X18gPSAoJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlYWRPbmx5X18gPSBfZGVyZXFfKFwicHJlZGVmaW5lZEl0ZW1zL3JlYWRPbmx5XCIpLCAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcmVhZE9ubHlfXyAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcmVhZE9ubHlfXy5fX2VzTW9kdWxlICYmICRfX3ByZWRlZmluZWRJdGVtc180N19yZWFkT25seV9fIHx8IHtkZWZhdWx0OiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcmVhZE9ubHlfX30pO1xudmFyICRfX3ByZWRlZmluZWRJdGVtc180N19yZWRvX18gPSAoJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlZG9fXyA9IF9kZXJlcV8oXCJwcmVkZWZpbmVkSXRlbXMvcmVkb1wiKSwgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlZG9fXyAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcmVkb19fLl9fZXNNb2R1bGUgJiYgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlZG9fXyB8fCB7ZGVmYXVsdDogJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlZG9fX30pO1xudmFyICRfX3ByZWRlZmluZWRJdGVtc180N19yZW1vdmVDb2x1bW5fXyA9ICgkX19wcmVkZWZpbmVkSXRlbXNfNDdfcmVtb3ZlQ29sdW1uX18gPSBfZGVyZXFfKFwicHJlZGVmaW5lZEl0ZW1zL3JlbW92ZUNvbHVtblwiKSwgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlbW92ZUNvbHVtbl9fICYmICRfX3ByZWRlZmluZWRJdGVtc180N19yZW1vdmVDb2x1bW5fXy5fX2VzTW9kdWxlICYmICRfX3ByZWRlZmluZWRJdGVtc180N19yZW1vdmVDb2x1bW5fXyB8fCB7ZGVmYXVsdDogJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlbW92ZUNvbHVtbl9ffSk7XG52YXIgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlbW92ZVJvd19fID0gKCRfX3ByZWRlZmluZWRJdGVtc180N19yZW1vdmVSb3dfXyA9IF9kZXJlcV8oXCJwcmVkZWZpbmVkSXRlbXMvcmVtb3ZlUm93XCIpLCAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcmVtb3ZlUm93X18gJiYgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlbW92ZVJvd19fLl9fZXNNb2R1bGUgJiYgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3JlbW92ZVJvd19fIHx8IHtkZWZhdWx0OiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcmVtb3ZlUm93X199KTtcbnZhciAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcm93QWJvdmVfXyA9ICgkX19wcmVkZWZpbmVkSXRlbXNfNDdfcm93QWJvdmVfXyA9IF9kZXJlcV8oXCJwcmVkZWZpbmVkSXRlbXMvcm93QWJvdmVcIiksICRfX3ByZWRlZmluZWRJdGVtc180N19yb3dBYm92ZV9fICYmICRfX3ByZWRlZmluZWRJdGVtc180N19yb3dBYm92ZV9fLl9fZXNNb2R1bGUgJiYgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3Jvd0Fib3ZlX18gfHwge2RlZmF1bHQ6ICRfX3ByZWRlZmluZWRJdGVtc180N19yb3dBYm92ZV9ffSk7XG52YXIgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3Jvd0JlbG93X18gPSAoJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3Jvd0JlbG93X18gPSBfZGVyZXFfKFwicHJlZGVmaW5lZEl0ZW1zL3Jvd0JlbG93XCIpLCAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcm93QmVsb3dfXyAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcm93QmVsb3dfXy5fX2VzTW9kdWxlICYmICRfX3ByZWRlZmluZWRJdGVtc180N19yb3dCZWxvd19fIHx8IHtkZWZhdWx0OiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfcm93QmVsb3dfX30pO1xudmFyICRfX3ByZWRlZmluZWRJdGVtc180N19zZXBhcmF0b3JfXyA9ICgkX19wcmVkZWZpbmVkSXRlbXNfNDdfc2VwYXJhdG9yX18gPSBfZGVyZXFfKFwicHJlZGVmaW5lZEl0ZW1zL3NlcGFyYXRvclwiKSwgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3NlcGFyYXRvcl9fICYmICRfX3ByZWRlZmluZWRJdGVtc180N19zZXBhcmF0b3JfXy5fX2VzTW9kdWxlICYmICRfX3ByZWRlZmluZWRJdGVtc180N19zZXBhcmF0b3JfXyB8fCB7ZGVmYXVsdDogJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3NlcGFyYXRvcl9ffSk7XG52YXIgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3VuZG9fXyA9ICgkX19wcmVkZWZpbmVkSXRlbXNfNDdfdW5kb19fID0gX2RlcmVxXyhcInByZWRlZmluZWRJdGVtcy91bmRvXCIpLCAkX19wcmVkZWZpbmVkSXRlbXNfNDdfdW5kb19fICYmICRfX3ByZWRlZmluZWRJdGVtc180N191bmRvX18uX19lc01vZHVsZSAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfdW5kb19fIHx8IHtkZWZhdWx0OiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfdW5kb19ffSk7XG52YXIgSVRFTVMgPSBbUk9XX0FCT1ZFLCBST1dfQkVMT1csIENPTFVNTl9MRUZULCBDT0xVTU5fUklHSFQsIENMRUFSX0NPTFVNTiwgUkVNT1ZFX1JPVywgUkVNT1ZFX0NPTFVNTiwgVU5ETywgUkVETywgUkVBRF9PTkxZLCBBTElHTk1FTlQsIFNFUEFSQVRPUl07XG52YXIgX3ByZWRlZmluZWRJdGVtcyA9ICgkX18xMyA9IHt9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fMTMsIFNFUEFSQVRPUiwge1xuICB2YWx1ZTogc2VwYXJhdG9ySXRlbSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgUk9XX0FCT1ZFLCB7XG4gIHZhbHVlOiByb3dBYm92ZUl0ZW0sXG4gIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgd3JpdGFibGU6IHRydWVcbn0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fMTMsIFJPV19CRUxPVywge1xuICB2YWx1ZTogcm93QmVsb3dJdGVtLFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBDT0xVTU5fTEVGVCwge1xuICB2YWx1ZTogY29sdW1uTGVmdEl0ZW0sXG4gIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgd3JpdGFibGU6IHRydWVcbn0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fMTMsIENPTFVNTl9SSUdIVCwge1xuICB2YWx1ZTogY29sdW1uUmlnaHRJdGVtLFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBDTEVBUl9DT0xVTU4sIHtcbiAgdmFsdWU6IGNsZWFyQ29sdW1uSXRlbSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgUkVNT1ZFX1JPVywge1xuICB2YWx1ZTogcmVtb3ZlUm93SXRlbSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgUkVNT1ZFX0NPTFVNTiwge1xuICB2YWx1ZTogcmVtb3ZlQ29sdW1uSXRlbSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgVU5ETywge1xuICB2YWx1ZTogdW5kb0l0ZW0sXG4gIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgd3JpdGFibGU6IHRydWVcbn0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fMTMsIFJFRE8sIHtcbiAgdmFsdWU6IHJlZG9JdGVtLFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzEzLCBSRUFEX09OTFksIHtcbiAgdmFsdWU6IHJlYWRPbmx5SXRlbSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX18xMywgQUxJR05NRU5ULCB7XG4gIHZhbHVlOiBhbGlnbm1lbnRJdGVtLFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgJF9fMTMpO1xuZnVuY3Rpb24gcHJlZGVmaW5lZEl0ZW1zKCkge1xuICB2YXIgaXRlbXMgPSB7fTtcbiAgb2JqZWN0RWFjaChfcHJlZGVmaW5lZEl0ZW1zLCAoZnVuY3Rpb24oaXRlbUZhY3RvcnksIGtleSkge1xuICAgIHJldHVybiBpdGVtc1trZXldID0gaXRlbUZhY3RvcnkoKTtcbiAgfSkpO1xuICByZXR1cm4gaXRlbXM7XG59XG5mdW5jdGlvbiBhZGRJdGVtKGtleSwgaXRlbSkge1xuICBpZiAoSVRFTVMuaW5kZXhPZihrZXkpID09PSAtMSkge1xuICAgIF9wcmVkZWZpbmVkSXRlbXNba2V5XSA9IGl0ZW07XG4gIH1cbn1cblxuLy8jIFxufSx7XCJoZWxwZXJzL29iamVjdFwiOjUzLFwicHJlZGVmaW5lZEl0ZW1zL2FsaWdubWVudFwiOjc2LFwicHJlZGVmaW5lZEl0ZW1zL2NsZWFyQ29sdW1uXCI6NzcsXCJwcmVkZWZpbmVkSXRlbXMvY29sdW1uTGVmdFwiOjc4LFwicHJlZGVmaW5lZEl0ZW1zL2NvbHVtblJpZ2h0XCI6NzksXCJwcmVkZWZpbmVkSXRlbXMvcmVhZE9ubHlcIjo4MCxcInByZWRlZmluZWRJdGVtcy9yZWRvXCI6ODEsXCJwcmVkZWZpbmVkSXRlbXMvcmVtb3ZlQ29sdW1uXCI6ODIsXCJwcmVkZWZpbmVkSXRlbXMvcmVtb3ZlUm93XCI6ODMsXCJwcmVkZWZpbmVkSXRlbXMvcm93QWJvdmVcIjo4NCxcInByZWRlZmluZWRJdGVtcy9yb3dCZWxvd1wiOjg1LFwicHJlZGVmaW5lZEl0ZW1zL3NlcGFyYXRvclwiOjg2LFwicHJlZGVmaW5lZEl0ZW1zL3VuZG9cIjo4N31dLDc2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBLRVk6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIEtFWTtcbiAgICB9fSxcbiAgYWxpZ25tZW50SXRlbToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gYWxpZ25tZW50SXRlbTtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfdXRpbHNfXyxcbiAgICAkX19zZXBhcmF0b3JfXztcbnZhciAkX18wID0gKCRfX180Nl9fNDZfXzQ3X3V0aWxzX18gPSBfZGVyZXFfKFwidXRpbHNcIiksICRfX180Nl9fNDZfXzQ3X3V0aWxzX18gJiYgJF9fXzQ2X180Nl9fNDdfdXRpbHNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X3V0aWxzX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X3V0aWxzX199KSxcbiAgICBhbGlnbiA9ICRfXzAuYWxpZ24sXG4gICAgZ2V0QWxpZ25tZW50Q2xhc3NlcyA9ICRfXzAuZ2V0QWxpZ25tZW50Q2xhc3NlcyxcbiAgICBjaGVja1NlbGVjdGlvbkNvbnNpc3RlbmN5ID0gJF9fMC5jaGVja1NlbGVjdGlvbkNvbnNpc3RlbmN5LFxuICAgIG1hcmtMYWJlbEFzU2VsZWN0ZWQgPSAkX18wLm1hcmtMYWJlbEFzU2VsZWN0ZWQ7XG52YXIgU0VQQVJBVE9SID0gKCRfX3NlcGFyYXRvcl9fID0gX2RlcmVxXyhcInNlcGFyYXRvclwiKSwgJF9fc2VwYXJhdG9yX18gJiYgJF9fc2VwYXJhdG9yX18uX19lc01vZHVsZSAmJiAkX19zZXBhcmF0b3JfXyB8fCB7ZGVmYXVsdDogJF9fc2VwYXJhdG9yX199KS5LRVk7XG52YXIgS0VZID0gJ2FsaWdubWVudCc7XG5mdW5jdGlvbiBhbGlnbm1lbnRJdGVtKCkge1xuICByZXR1cm4ge1xuICAgIGtleTogS0VZLFxuICAgIG5hbWU6ICdBbGlnbm1lbnQnLFxuICAgIGRpc2FibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldFNlbGVjdGVkUmFuZ2UoKSAmJiAhdGhpcy5zZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIuY29ybmVyID8gZmFsc2UgOiB0cnVlO1xuICAgIH0sXG4gICAgc3VibWVudToge2l0ZW1zOiBbe1xuICAgICAgICBrZXk6IChLRVkgKyBcIjpsZWZ0XCIpLFxuICAgICAgICBuYW1lOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgJF9fMiA9IHRoaXM7XG4gICAgICAgICAgdmFyIGxhYmVsID0gJ0xlZnQnO1xuICAgICAgICAgIHZhciBoYXNDbGFzcyA9IGNoZWNrU2VsZWN0aW9uQ29uc2lzdGVuY3kodGhpcy5nZXRTZWxlY3RlZFJhbmdlKCksIChmdW5jdGlvbihyb3csIGNvbCkge1xuICAgICAgICAgICAgdmFyIGNsYXNzTmFtZSA9ICRfXzIuZ2V0Q2VsbE1ldGEocm93LCBjb2wpLmNsYXNzTmFtZTtcbiAgICAgICAgICAgIGlmIChjbGFzc05hbWUgJiYgY2xhc3NOYW1lLmluZGV4T2YoJ2h0TGVmdCcpICE9PSAtMSkge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KSk7XG4gICAgICAgICAgaWYgKGhhc0NsYXNzKSB7XG4gICAgICAgICAgICBsYWJlbCA9IG1hcmtMYWJlbEFzU2VsZWN0ZWQobGFiZWwpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgICAgIH0sXG4gICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgJF9fMiA9IHRoaXM7XG4gICAgICAgICAgdmFyIHJhbmdlID0gdGhpcy5nZXRTZWxlY3RlZFJhbmdlKCk7XG4gICAgICAgICAgdmFyIHN0YXRlQmVmb3JlID0gZ2V0QWxpZ25tZW50Q2xhc3NlcyhyYW5nZSwgKGZ1bmN0aW9uKHJvdywgY29sKSB7XG4gICAgICAgICAgICByZXR1cm4gJF9fMi5nZXRDZWxsTWV0YShyb3csIGNvbCkuY2xhc3NOYW1lO1xuICAgICAgICAgIH0pKTtcbiAgICAgICAgICB2YXIgdHlwZSA9ICdob3Jpem9udGFsJztcbiAgICAgICAgICB2YXIgYWxpZ25tZW50ID0gJ2h0TGVmdCc7XG4gICAgICAgICAgdGhpcy5ydW5Ib29rcygnYmVmb3JlQ2VsbEFsaWdubWVudCcsIHN0YXRlQmVmb3JlLCByYW5nZSwgdHlwZSwgYWxpZ25tZW50KTtcbiAgICAgICAgICBhbGlnbihyYW5nZSwgdHlwZSwgYWxpZ25tZW50LCAoZnVuY3Rpb24ocm93LCBjb2wpIHtcbiAgICAgICAgICAgIHJldHVybiAkX18yLmdldENlbGxNZXRhKHJvdywgY29sKTtcbiAgICAgICAgICB9KSwgKGZ1bmN0aW9uKHJvdywgY29sLCBrZXksIHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gJF9fMi5zZXRDZWxsTWV0YShyb3csIGNvbCwga2V5LCB2YWx1ZSk7XG4gICAgICAgICAgfSkpO1xuICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGRpc2FibGVkOiBmYWxzZVxuICAgICAgfSwge1xuICAgICAgICBrZXk6IChLRVkgKyBcIjpjZW50ZXJcIiksXG4gICAgICAgIG5hbWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciAkX18yID0gdGhpcztcbiAgICAgICAgICB2YXIgbGFiZWwgPSAnQ2VudGVyJztcbiAgICAgICAgICB2YXIgaGFzQ2xhc3MgPSBjaGVja1NlbGVjdGlvbkNvbnNpc3RlbmN5KHRoaXMuZ2V0U2VsZWN0ZWRSYW5nZSgpLCAoZnVuY3Rpb24ocm93LCBjb2wpIHtcbiAgICAgICAgICAgIHZhciBjbGFzc05hbWUgPSAkX18yLmdldENlbGxNZXRhKHJvdywgY29sKS5jbGFzc05hbWU7XG4gICAgICAgICAgICBpZiAoY2xhc3NOYW1lICYmIGNsYXNzTmFtZS5pbmRleE9mKCdodENlbnRlcicpICE9PSAtMSkge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KSk7XG4gICAgICAgICAgaWYgKGhhc0NsYXNzKSB7XG4gICAgICAgICAgICBsYWJlbCA9IG1hcmtMYWJlbEFzU2VsZWN0ZWQobGFiZWwpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgICAgIH0sXG4gICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgJF9fMiA9IHRoaXM7XG4gICAgICAgICAgdmFyIHJhbmdlID0gdGhpcy5nZXRTZWxlY3RlZFJhbmdlKCk7XG4gICAgICAgICAgdmFyIHN0YXRlQmVmb3JlID0gZ2V0QWxpZ25tZW50Q2xhc3NlcyhyYW5nZSwgKGZ1bmN0aW9uKHJvdywgY29sKSB7XG4gICAgICAgICAgICByZXR1cm4gJF9fMi5nZXRDZWxsTWV0YShyb3csIGNvbCkuY2xhc3NOYW1lO1xuICAgICAgICAgIH0pKTtcbiAgICAgICAgICB2YXIgdHlwZSA9ICdob3Jpem9udGFsJztcbiAgICAgICAgICB2YXIgYWxpZ25tZW50ID0gJ2h0Q2VudGVyJztcbiAgICAgICAgICB0aGlzLnJ1bkhvb2tzKCdiZWZvcmVDZWxsQWxpZ25tZW50Jywgc3RhdGVCZWZvcmUsIHJhbmdlLCB0eXBlLCBhbGlnbm1lbnQpO1xuICAgICAgICAgIGFsaWduKHJhbmdlLCB0eXBlLCBhbGlnbm1lbnQsIChmdW5jdGlvbihyb3csIGNvbCkge1xuICAgICAgICAgICAgcmV0dXJuICRfXzIuZ2V0Q2VsbE1ldGEocm93LCBjb2wpO1xuICAgICAgICAgIH0pLCAoZnVuY3Rpb24ocm93LCBjb2wsIGtleSwgdmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiAkX18yLnNldENlbGxNZXRhKHJvdywgY29sLCBrZXksIHZhbHVlKTtcbiAgICAgICAgICB9KSk7XG4gICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgfSxcbiAgICAgICAgZGlzYWJsZWQ6IGZhbHNlXG4gICAgICB9LCB7XG4gICAgICAgIGtleTogKEtFWSArIFwiOnJpZ2h0XCIpLFxuICAgICAgICBuYW1lOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgJF9fMiA9IHRoaXM7XG4gICAgICAgICAgdmFyIGxhYmVsID0gJ1JpZ2h0JztcbiAgICAgICAgICB2YXIgaGFzQ2xhc3MgPSBjaGVja1NlbGVjdGlvbkNvbnNpc3RlbmN5KHRoaXMuZ2V0U2VsZWN0ZWRSYW5nZSgpLCAoZnVuY3Rpb24ocm93LCBjb2wpIHtcbiAgICAgICAgICAgIHZhciBjbGFzc05hbWUgPSAkX18yLmdldENlbGxNZXRhKHJvdywgY29sKS5jbGFzc05hbWU7XG4gICAgICAgICAgICBpZiAoY2xhc3NOYW1lICYmIGNsYXNzTmFtZS5pbmRleE9mKCdodFJpZ2h0JykgIT09IC0xKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pKTtcbiAgICAgICAgICBpZiAoaGFzQ2xhc3MpIHtcbiAgICAgICAgICAgIGxhYmVsID0gbWFya0xhYmVsQXNTZWxlY3RlZChsYWJlbCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBsYWJlbDtcbiAgICAgICAgfSxcbiAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciAkX18yID0gdGhpcztcbiAgICAgICAgICB2YXIgcmFuZ2UgPSB0aGlzLmdldFNlbGVjdGVkUmFuZ2UoKTtcbiAgICAgICAgICB2YXIgc3RhdGVCZWZvcmUgPSBnZXRBbGlnbm1lbnRDbGFzc2VzKHJhbmdlLCAoZnVuY3Rpb24ocm93LCBjb2wpIHtcbiAgICAgICAgICAgIHJldHVybiAkX18yLmdldENlbGxNZXRhKHJvdywgY29sKS5jbGFzc05hbWU7XG4gICAgICAgICAgfSkpO1xuICAgICAgICAgIHZhciB0eXBlID0gJ2hvcml6b250YWwnO1xuICAgICAgICAgIHZhciBhbGlnbm1lbnQgPSAnaHRSaWdodCc7XG4gICAgICAgICAgdGhpcy5ydW5Ib29rcygnYmVmb3JlQ2VsbEFsaWdubWVudCcsIHN0YXRlQmVmb3JlLCByYW5nZSwgdHlwZSwgYWxpZ25tZW50KTtcbiAgICAgICAgICBhbGlnbihyYW5nZSwgdHlwZSwgYWxpZ25tZW50LCAoZnVuY3Rpb24ocm93LCBjb2wpIHtcbiAgICAgICAgICAgIHJldHVybiAkX18yLmdldENlbGxNZXRhKHJvdywgY29sKTtcbiAgICAgICAgICB9KSwgKGZ1bmN0aW9uKHJvdywgY29sLCBrZXksIHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gJF9fMi5zZXRDZWxsTWV0YShyb3csIGNvbCwga2V5LCB2YWx1ZSk7XG4gICAgICAgICAgfSkpO1xuICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGRpc2FibGVkOiBmYWxzZVxuICAgICAgfSwge1xuICAgICAgICBrZXk6IChLRVkgKyBcIjpqdXN0aWZ5XCIpLFxuICAgICAgICBuYW1lOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgJF9fMiA9IHRoaXM7XG4gICAgICAgICAgdmFyIGxhYmVsID0gJ0p1c3RpZnknO1xuICAgICAgICAgIHZhciBoYXNDbGFzcyA9IGNoZWNrU2VsZWN0aW9uQ29uc2lzdGVuY3kodGhpcy5nZXRTZWxlY3RlZFJhbmdlKCksIChmdW5jdGlvbihyb3csIGNvbCkge1xuICAgICAgICAgICAgdmFyIGNsYXNzTmFtZSA9ICRfXzIuZ2V0Q2VsbE1ldGEocm93LCBjb2wpLmNsYXNzTmFtZTtcbiAgICAgICAgICAgIGlmIChjbGFzc05hbWUgJiYgY2xhc3NOYW1lLmluZGV4T2YoJ2h0SnVzdGlmeScpICE9PSAtMSkge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KSk7XG4gICAgICAgICAgaWYgKGhhc0NsYXNzKSB7XG4gICAgICAgICAgICBsYWJlbCA9IG1hcmtMYWJlbEFzU2VsZWN0ZWQobGFiZWwpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgICAgIH0sXG4gICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgJF9fMiA9IHRoaXM7XG4gICAgICAgICAgdmFyIHJhbmdlID0gdGhpcy5nZXRTZWxlY3RlZFJhbmdlKCk7XG4gICAgICAgICAgdmFyIHN0YXRlQmVmb3JlID0gZ2V0QWxpZ25tZW50Q2xhc3NlcyhyYW5nZSwgKGZ1bmN0aW9uKHJvdywgY29sKSB7XG4gICAgICAgICAgICByZXR1cm4gJF9fMi5nZXRDZWxsTWV0YShyb3csIGNvbCkuY2xhc3NOYW1lO1xuICAgICAgICAgIH0pKTtcbiAgICAgICAgICB2YXIgdHlwZSA9ICdob3Jpem9udGFsJztcbiAgICAgICAgICB2YXIgYWxpZ25tZW50ID0gJ2h0SnVzdGlmeSc7XG4gICAgICAgICAgdGhpcy5ydW5Ib29rcygnYmVmb3JlQ2VsbEFsaWdubWVudCcsIHN0YXRlQmVmb3JlLCByYW5nZSwgdHlwZSwgYWxpZ25tZW50KTtcbiAgICAgICAgICBhbGlnbihyYW5nZSwgdHlwZSwgYWxpZ25tZW50LCAoZnVuY3Rpb24ocm93LCBjb2wpIHtcbiAgICAgICAgICAgIHJldHVybiAkX18yLmdldENlbGxNZXRhKHJvdywgY29sKTtcbiAgICAgICAgICB9KSwgKGZ1bmN0aW9uKHJvdywgY29sLCBrZXksIHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gJF9fMi5zZXRDZWxsTWV0YShyb3csIGNvbCwga2V5LCB2YWx1ZSk7XG4gICAgICAgICAgfSkpO1xuICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGRpc2FibGVkOiBmYWxzZVxuICAgICAgfSwge25hbWU6IFNFUEFSQVRPUn0sIHtcbiAgICAgICAga2V5OiAoS0VZICsgXCI6dG9wXCIpLFxuICAgICAgICBuYW1lOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgJF9fMiA9IHRoaXM7XG4gICAgICAgICAgdmFyIGxhYmVsID0gJ1RvcCc7XG4gICAgICAgICAgdmFyIGhhc0NsYXNzID0gY2hlY2tTZWxlY3Rpb25Db25zaXN0ZW5jeSh0aGlzLmdldFNlbGVjdGVkUmFuZ2UoKSwgKGZ1bmN0aW9uKHJvdywgY29sKSB7XG4gICAgICAgICAgICB2YXIgY2xhc3NOYW1lID0gJF9fMi5nZXRDZWxsTWV0YShyb3csIGNvbCkuY2xhc3NOYW1lO1xuICAgICAgICAgICAgaWYgKGNsYXNzTmFtZSAmJiBjbGFzc05hbWUuaW5kZXhPZignaHRUb3AnKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSkpO1xuICAgICAgICAgIGlmIChoYXNDbGFzcykge1xuICAgICAgICAgICAgbGFiZWwgPSBtYXJrTGFiZWxBc1NlbGVjdGVkKGxhYmVsKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGxhYmVsO1xuICAgICAgICB9LFxuICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyICRfXzIgPSB0aGlzO1xuICAgICAgICAgIHZhciByYW5nZSA9IHRoaXMuZ2V0U2VsZWN0ZWRSYW5nZSgpO1xuICAgICAgICAgIHZhciBzdGF0ZUJlZm9yZSA9IGdldEFsaWdubWVudENsYXNzZXMocmFuZ2UsIChmdW5jdGlvbihyb3csIGNvbCkge1xuICAgICAgICAgICAgcmV0dXJuICRfXzIuZ2V0Q2VsbE1ldGEocm93LCBjb2wpLmNsYXNzTmFtZTtcbiAgICAgICAgICB9KSk7XG4gICAgICAgICAgdmFyIHR5cGUgPSAndmVydGljYWwnO1xuICAgICAgICAgIHZhciBhbGlnbm1lbnQgPSAnaHRUb3AnO1xuICAgICAgICAgIHRoaXMucnVuSG9va3MoJ2JlZm9yZUNlbGxBbGlnbm1lbnQnLCBzdGF0ZUJlZm9yZSwgcmFuZ2UsIHR5cGUsIGFsaWdubWVudCk7XG4gICAgICAgICAgYWxpZ24ocmFuZ2UsIHR5cGUsIGFsaWdubWVudCwgKGZ1bmN0aW9uKHJvdywgY29sKSB7XG4gICAgICAgICAgICByZXR1cm4gJF9fMi5nZXRDZWxsTWV0YShyb3csIGNvbCk7XG4gICAgICAgICAgfSksIChmdW5jdGlvbihyb3csIGNvbCwga2V5LCB2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuICRfXzIuc2V0Q2VsbE1ldGEocm93LCBjb2wsIGtleSwgdmFsdWUpO1xuICAgICAgICAgIH0pKTtcbiAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9LFxuICAgICAgICBkaXNhYmxlZDogZmFsc2VcbiAgICAgIH0sIHtcbiAgICAgICAga2V5OiAoS0VZICsgXCI6bWlkZGxlXCIpLFxuICAgICAgICBuYW1lOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgJF9fMiA9IHRoaXM7XG4gICAgICAgICAgdmFyIGxhYmVsID0gJ01pZGRsZSc7XG4gICAgICAgICAgdmFyIGhhc0NsYXNzID0gY2hlY2tTZWxlY3Rpb25Db25zaXN0ZW5jeSh0aGlzLmdldFNlbGVjdGVkUmFuZ2UoKSwgKGZ1bmN0aW9uKHJvdywgY29sKSB7XG4gICAgICAgICAgICB2YXIgY2xhc3NOYW1lID0gJF9fMi5nZXRDZWxsTWV0YShyb3csIGNvbCkuY2xhc3NOYW1lO1xuICAgICAgICAgICAgaWYgKGNsYXNzTmFtZSAmJiBjbGFzc05hbWUuaW5kZXhPZignaHRNaWRkbGUnKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSkpO1xuICAgICAgICAgIGlmIChoYXNDbGFzcykge1xuICAgICAgICAgICAgbGFiZWwgPSBtYXJrTGFiZWxBc1NlbGVjdGVkKGxhYmVsKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGxhYmVsO1xuICAgICAgICB9LFxuICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyICRfXzIgPSB0aGlzO1xuICAgICAgICAgIHZhciByYW5nZSA9IHRoaXMuZ2V0U2VsZWN0ZWRSYW5nZSgpO1xuICAgICAgICAgIHZhciBzdGF0ZUJlZm9yZSA9IGdldEFsaWdubWVudENsYXNzZXMocmFuZ2UsIChmdW5jdGlvbihyb3csIGNvbCkge1xuICAgICAgICAgICAgcmV0dXJuICRfXzIuZ2V0Q2VsbE1ldGEocm93LCBjb2wpLmNsYXNzTmFtZTtcbiAgICAgICAgICB9KSk7XG4gICAgICAgICAgdmFyIHR5cGUgPSAndmVydGljYWwnO1xuICAgICAgICAgIHZhciBhbGlnbm1lbnQgPSAnaHRNaWRkbGUnO1xuICAgICAgICAgIHRoaXMucnVuSG9va3MoJ2JlZm9yZUNlbGxBbGlnbm1lbnQnLCBzdGF0ZUJlZm9yZSwgcmFuZ2UsIHR5cGUsIGFsaWdubWVudCk7XG4gICAgICAgICAgYWxpZ24ocmFuZ2UsIHR5cGUsIGFsaWdubWVudCwgKGZ1bmN0aW9uKHJvdywgY29sKSB7XG4gICAgICAgICAgICByZXR1cm4gJF9fMi5nZXRDZWxsTWV0YShyb3csIGNvbCk7XG4gICAgICAgICAgfSksIChmdW5jdGlvbihyb3csIGNvbCwga2V5LCB2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuICRfXzIuc2V0Q2VsbE1ldGEocm93LCBjb2wsIGtleSwgdmFsdWUpO1xuICAgICAgICAgIH0pKTtcbiAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9LFxuICAgICAgICBkaXNhYmxlZDogZmFsc2VcbiAgICAgIH0sIHtcbiAgICAgICAga2V5OiAoS0VZICsgXCI6Ym90dG9tXCIpLFxuICAgICAgICBuYW1lOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgJF9fMiA9IHRoaXM7XG4gICAgICAgICAgdmFyIGxhYmVsID0gJ0JvdHRvbSc7XG4gICAgICAgICAgdmFyIGhhc0NsYXNzID0gY2hlY2tTZWxlY3Rpb25Db25zaXN0ZW5jeSh0aGlzLmdldFNlbGVjdGVkUmFuZ2UoKSwgKGZ1bmN0aW9uKHJvdywgY29sKSB7XG4gICAgICAgICAgICB2YXIgY2xhc3NOYW1lID0gJF9fMi5nZXRDZWxsTWV0YShyb3csIGNvbCkuY2xhc3NOYW1lO1xuICAgICAgICAgICAgaWYgKGNsYXNzTmFtZSAmJiBjbGFzc05hbWUuaW5kZXhPZignaHRCb3R0b20nKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSkpO1xuICAgICAgICAgIGlmIChoYXNDbGFzcykge1xuICAgICAgICAgICAgbGFiZWwgPSBtYXJrTGFiZWxBc1NlbGVjdGVkKGxhYmVsKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGxhYmVsO1xuICAgICAgICB9LFxuICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyICRfXzIgPSB0aGlzO1xuICAgICAgICAgIHZhciByYW5nZSA9IHRoaXMuZ2V0U2VsZWN0ZWRSYW5nZSgpO1xuICAgICAgICAgIHZhciBzdGF0ZUJlZm9yZSA9IGdldEFsaWdubWVudENsYXNzZXMocmFuZ2UsIChmdW5jdGlvbihyb3csIGNvbCkge1xuICAgICAgICAgICAgcmV0dXJuICRfXzIuZ2V0Q2VsbE1ldGEocm93LCBjb2wpLmNsYXNzTmFtZTtcbiAgICAgICAgICB9KSk7XG4gICAgICAgICAgdmFyIHR5cGUgPSAndmVydGljYWwnO1xuICAgICAgICAgIHZhciBhbGlnbm1lbnQgPSAnaHRCb3R0b20nO1xuICAgICAgICAgIHRoaXMucnVuSG9va3MoJ2JlZm9yZUNlbGxBbGlnbm1lbnQnLCBzdGF0ZUJlZm9yZSwgcmFuZ2UsIHR5cGUsIGFsaWdubWVudCk7XG4gICAgICAgICAgYWxpZ24ocmFuZ2UsIHR5cGUsIGFsaWdubWVudCwgKGZ1bmN0aW9uKHJvdywgY29sKSB7XG4gICAgICAgICAgICByZXR1cm4gJF9fMi5nZXRDZWxsTWV0YShyb3csIGNvbCk7XG4gICAgICAgICAgfSksIChmdW5jdGlvbihyb3csIGNvbCwga2V5LCB2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuICRfXzIuc2V0Q2VsbE1ldGEocm93LCBjb2wsIGtleSwgdmFsdWUpO1xuICAgICAgICAgIH0pKTtcbiAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9LFxuICAgICAgICBkaXNhYmxlZDogZmFsc2VcbiAgICAgIH1dfVxuICB9O1xufVxuXG4vLyMgXG59LHtcInNlcGFyYXRvclwiOjg2LFwidXRpbHNcIjo4OH1dLDc3OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBLRVk6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIEtFWTtcbiAgICB9fSxcbiAgY2xlYXJDb2x1bW5JdGVtOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBjbGVhckNvbHVtbkl0ZW07XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X3V0aWxzX187XG52YXIgZ2V0VmFsaWRTZWxlY3Rpb24gPSAoJF9fXzQ2X180Nl9fNDdfdXRpbHNfXyA9IF9kZXJlcV8oXCJ1dGlsc1wiKSwgJF9fXzQ2X180Nl9fNDdfdXRpbHNfXyAmJiAkX19fNDZfXzQ2X180N191dGlsc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfdXRpbHNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfdXRpbHNfX30pLmdldFZhbGlkU2VsZWN0aW9uO1xudmFyIEtFWSA9ICdjbGVhcl9jb2x1bW4nO1xuZnVuY3Rpb24gY2xlYXJDb2x1bW5JdGVtKCkge1xuICByZXR1cm4ge1xuICAgIGtleTogS0VZLFxuICAgIG5hbWU6ICdDbGVhciBjb2x1bW4nLFxuICAgIGNhbGxiYWNrOiBmdW5jdGlvbihrZXksIHNlbGVjdGlvbikge1xuICAgICAgdmFyIGNvbHVtbiA9IHNlbGVjdGlvbi5zdGFydC5jb2w7XG4gICAgICBpZiAodGhpcy5jb3VudFJvd3MoKSkge1xuICAgICAgICB0aGlzLnBvcHVsYXRlRnJvbUFycmF5KDAsIGNvbHVtbiwgW1tudWxsXV0sIE1hdGgubWF4KHNlbGVjdGlvbi5zdGFydC5yb3csIHNlbGVjdGlvbi5lbmQucm93KSwgY29sdW1uLCAnQ29udGV4dE1lbnUuY2xlYXJDb2x1bW4nKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGRpc2FibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzZWxlY3RlZCA9IGdldFZhbGlkU2VsZWN0aW9uKHRoaXMpO1xuICAgICAgaWYgKCFzZWxlY3RlZCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHZhciBlbnRpcmVSb3dTZWxlY3Rpb24gPSBbc2VsZWN0ZWRbMF0sIDAsIHNlbGVjdGVkWzBdLCB0aGlzLmNvdW50Q29scygpIC0gMV07XG4gICAgICB2YXIgcm93U2VsZWN0ZWQgPSBlbnRpcmVSb3dTZWxlY3Rpb24uam9pbignLCcpID09IHNlbGVjdGVkLmpvaW4oJywnKTtcbiAgICAgIHJldHVybiBzZWxlY3RlZFsxXSA8IDAgfHwgdGhpcy5jb3VudENvbHMoKSA+PSB0aGlzLmdldFNldHRpbmdzKCkubWF4Q29scyB8fCByb3dTZWxlY3RlZDtcbiAgICB9XG4gIH07XG59XG5cbi8vIyBcbn0se1widXRpbHNcIjo4OH1dLDc4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBLRVk6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIEtFWTtcbiAgICB9fSxcbiAgY29sdW1uTGVmdEl0ZW06IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGNvbHVtbkxlZnRJdGVtO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N191dGlsc19fO1xudmFyIGdldFZhbGlkU2VsZWN0aW9uID0gKCRfX180Nl9fNDZfXzQ3X3V0aWxzX18gPSBfZGVyZXFfKFwidXRpbHNcIiksICRfX180Nl9fNDZfXzQ3X3V0aWxzX18gJiYgJF9fXzQ2X180Nl9fNDdfdXRpbHNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X3V0aWxzX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X3V0aWxzX199KS5nZXRWYWxpZFNlbGVjdGlvbjtcbnZhciBLRVkgPSAnY29sX2xlZnQnO1xuZnVuY3Rpb24gY29sdW1uTGVmdEl0ZW0oKSB7XG4gIHJldHVybiB7XG4gICAga2V5OiBLRVksXG4gICAgbmFtZTogJ0luc2VydCBjb2x1bW4gb24gdGhlIGxlZnQnLFxuICAgIGNhbGxiYWNrOiBmdW5jdGlvbihrZXksIHNlbGVjdGlvbikge1xuICAgICAgdGhpcy5hbHRlcignaW5zZXJ0X2NvbCcsIHNlbGVjdGlvbi5zdGFydC5jb2wsIDEsICdDb250ZXh0TWVudS5jb2x1bW5MZWZ0Jyk7XG4gICAgfSxcbiAgICBkaXNhYmxlZDogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc2VsZWN0ZWQgPSBnZXRWYWxpZFNlbGVjdGlvbih0aGlzKTtcbiAgICAgIGlmICghc2VsZWN0ZWQpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICBpZiAoIXRoaXMuaXNDb2x1bW5Nb2RpZmljYXRpb25BbGxvd2VkKCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICB2YXIgZW50aXJlUm93U2VsZWN0aW9uID0gW3NlbGVjdGVkWzBdLCAwLCBzZWxlY3RlZFswXSwgdGhpcy5jb3VudENvbHMoKSAtIDFdO1xuICAgICAgdmFyIHJvd1NlbGVjdGVkID0gZW50aXJlUm93U2VsZWN0aW9uLmpvaW4oJywnKSA9PSBzZWxlY3RlZC5qb2luKCcsJyk7XG4gICAgICB2YXIgb25seU9uZUNvbHVtbiA9IHRoaXMuY291bnRDb2xzKCkgPT09IDE7XG4gICAgICByZXR1cm4gc2VsZWN0ZWRbMV0gPCAwIHx8IHRoaXMuY291bnRDb2xzKCkgPj0gdGhpcy5nZXRTZXR0aW5ncygpLm1heENvbHMgfHwgKCFvbmx5T25lQ29sdW1uICYmIHJvd1NlbGVjdGVkKTtcbiAgICB9LFxuICAgIGhpZGRlbjogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gIXRoaXMuZ2V0U2V0dGluZ3MoKS5hbGxvd0luc2VydENvbHVtbjtcbiAgICB9XG4gIH07XG59XG5cbi8vIyBcbn0se1widXRpbHNcIjo4OH1dLDc5OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBLRVk6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIEtFWTtcbiAgICB9fSxcbiAgY29sdW1uUmlnaHRJdGVtOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBjb2x1bW5SaWdodEl0ZW07XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X3V0aWxzX187XG52YXIgZ2V0VmFsaWRTZWxlY3Rpb24gPSAoJF9fXzQ2X180Nl9fNDdfdXRpbHNfXyA9IF9kZXJlcV8oXCJ1dGlsc1wiKSwgJF9fXzQ2X180Nl9fNDdfdXRpbHNfXyAmJiAkX19fNDZfXzQ2X180N191dGlsc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfdXRpbHNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfdXRpbHNfX30pLmdldFZhbGlkU2VsZWN0aW9uO1xudmFyIEtFWSA9ICdjb2xfcmlnaHQnO1xuZnVuY3Rpb24gY29sdW1uUmlnaHRJdGVtKCkge1xuICByZXR1cm4ge1xuICAgIGtleTogS0VZLFxuICAgIG5hbWU6ICdJbnNlcnQgY29sdW1uIG9uIHRoZSByaWdodCcsXG4gICAgY2FsbGJhY2s6IGZ1bmN0aW9uKGtleSwgc2VsZWN0aW9uKSB7XG4gICAgICB0aGlzLmFsdGVyKCdpbnNlcnRfY29sJywgc2VsZWN0aW9uLmVuZC5jb2wgKyAxLCAxLCAnQ29udGV4dE1lbnUuY29sdW1uUmlnaHQnKTtcbiAgICB9LFxuICAgIGRpc2FibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzZWxlY3RlZCA9IGdldFZhbGlkU2VsZWN0aW9uKHRoaXMpO1xuICAgICAgaWYgKCFzZWxlY3RlZCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmICghdGhpcy5pc0NvbHVtbk1vZGlmaWNhdGlvbkFsbG93ZWQoKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHZhciBlbnRpcmVSb3dTZWxlY3Rpb24gPSBbc2VsZWN0ZWRbMF0sIDAsIHNlbGVjdGVkWzBdLCB0aGlzLmNvdW50Q29scygpIC0gMV07XG4gICAgICB2YXIgcm93U2VsZWN0ZWQgPSBlbnRpcmVSb3dTZWxlY3Rpb24uam9pbignLCcpID09IHNlbGVjdGVkLmpvaW4oJywnKTtcbiAgICAgIHZhciBvbmx5T25lQ29sdW1uID0gdGhpcy5jb3VudENvbHMoKSA9PT0gMTtcbiAgICAgIHJldHVybiBzZWxlY3RlZFsxXSA8IDAgfHwgdGhpcy5jb3VudENvbHMoKSA+PSB0aGlzLmdldFNldHRpbmdzKCkubWF4Q29scyB8fCAoIW9ubHlPbmVDb2x1bW4gJiYgcm93U2VsZWN0ZWQpO1xuICAgIH0sXG4gICAgaGlkZGVuOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAhdGhpcy5nZXRTZXR0aW5ncygpLmFsbG93SW5zZXJ0Q29sdW1uO1xuICAgIH1cbiAgfTtcbn1cblxuLy8jIFxufSx7XCJ1dGlsc1wiOjg4fV0sODA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIEtFWToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gS0VZO1xuICAgIH19LFxuICByZWFkT25seUl0ZW06IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHJlYWRPbmx5SXRlbTtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfdXRpbHNfXztcbnZhciAkX18wID0gKCRfX180Nl9fNDZfXzQ3X3V0aWxzX18gPSBfZGVyZXFfKFwidXRpbHNcIiksICRfX180Nl9fNDZfXzQ3X3V0aWxzX18gJiYgJF9fXzQ2X180Nl9fNDdfdXRpbHNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X3V0aWxzX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X3V0aWxzX199KSxcbiAgICBjaGVja1NlbGVjdGlvbkNvbnNpc3RlbmN5ID0gJF9fMC5jaGVja1NlbGVjdGlvbkNvbnNpc3RlbmN5LFxuICAgIG1hcmtMYWJlbEFzU2VsZWN0ZWQgPSAkX18wLm1hcmtMYWJlbEFzU2VsZWN0ZWQ7XG52YXIgS0VZID0gJ21ha2VfcmVhZF9vbmx5JztcbmZ1bmN0aW9uIHJlYWRPbmx5SXRlbSgpIHtcbiAgcmV0dXJuIHtcbiAgICBrZXk6IEtFWSxcbiAgICBuYW1lOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciAkX18xID0gdGhpcztcbiAgICAgIHZhciBsYWJlbCA9ICdSZWFkIG9ubHknO1xuICAgICAgdmFyIGF0TGVhc3RPbmVSZWFkT25seSA9IGNoZWNrU2VsZWN0aW9uQ29uc2lzdGVuY3kodGhpcy5nZXRTZWxlY3RlZFJhbmdlKCksIChmdW5jdGlvbihyb3csIGNvbCkge1xuICAgICAgICByZXR1cm4gJF9fMS5nZXRDZWxsTWV0YShyb3csIGNvbCkucmVhZE9ubHk7XG4gICAgICB9KSk7XG4gICAgICBpZiAoYXRMZWFzdE9uZVJlYWRPbmx5KSB7XG4gICAgICAgIGxhYmVsID0gbWFya0xhYmVsQXNTZWxlY3RlZChsYWJlbCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbGFiZWw7XG4gICAgfSxcbiAgICBjYWxsYmFjazogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgJF9fMSA9IHRoaXM7XG4gICAgICB2YXIgcmFuZ2UgPSB0aGlzLmdldFNlbGVjdGVkUmFuZ2UoKTtcbiAgICAgIHZhciBhdExlYXN0T25lUmVhZE9ubHkgPSBjaGVja1NlbGVjdGlvbkNvbnNpc3RlbmN5KHJhbmdlLCAoZnVuY3Rpb24ocm93LCBjb2wpIHtcbiAgICAgICAgcmV0dXJuICRfXzEuZ2V0Q2VsbE1ldGEocm93LCBjb2wpLnJlYWRPbmx5O1xuICAgICAgfSkpO1xuICAgICAgcmFuZ2UuZm9yQWxsKChmdW5jdGlvbihyb3csIGNvbCkge1xuICAgICAgICAkX18xLnNldENlbGxNZXRhKHJvdywgY29sLCAncmVhZE9ubHknLCBhdExlYXN0T25lUmVhZE9ubHkgPyBmYWxzZSA6IHRydWUpO1xuICAgICAgfSkpO1xuICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9LFxuICAgIGRpc2FibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldFNlbGVjdGVkUmFuZ2UoKSAmJiAhdGhpcy5zZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIuY29ybmVyID8gZmFsc2UgOiB0cnVlO1xuICAgIH1cbiAgfTtcbn1cblxuLy8jIFxufSx7XCJ1dGlsc1wiOjg4fV0sODE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIEtFWToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gS0VZO1xuICAgIH19LFxuICByZWRvSXRlbToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gcmVkb0l0ZW07XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyIEtFWSA9ICdyZWRvJztcbmZ1bmN0aW9uIHJlZG9JdGVtKCkge1xuICByZXR1cm4ge1xuICAgIGtleTogS0VZLFxuICAgIG5hbWU6ICdSZWRvJyxcbiAgICBjYWxsYmFjazogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLnJlZG8oKTtcbiAgICB9LFxuICAgIGRpc2FibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLnVuZG9SZWRvICYmICF0aGlzLnVuZG9SZWRvLmlzUmVkb0F2YWlsYWJsZSgpO1xuICAgIH1cbiAgfTtcbn1cblxuLy8jIFxufSx7fV0sODI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIEtFWToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gS0VZO1xuICAgIH19LFxuICByZW1vdmVDb2x1bW5JdGVtOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiByZW1vdmVDb2x1bW5JdGVtO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N191dGlsc19fO1xudmFyIGdldFZhbGlkU2VsZWN0aW9uID0gKCRfX180Nl9fNDZfXzQ3X3V0aWxzX18gPSBfZGVyZXFfKFwidXRpbHNcIiksICRfX180Nl9fNDZfXzQ3X3V0aWxzX18gJiYgJF9fXzQ2X180Nl9fNDdfdXRpbHNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X3V0aWxzX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X3V0aWxzX199KS5nZXRWYWxpZFNlbGVjdGlvbjtcbnZhciBLRVkgPSAncmVtb3ZlX2NvbCc7XG5mdW5jdGlvbiByZW1vdmVDb2x1bW5JdGVtKCkge1xuICByZXR1cm4ge1xuICAgIGtleTogS0VZLFxuICAgIG5hbWU6ICdSZW1vdmUgY29sdW1uJyxcbiAgICBjYWxsYmFjazogZnVuY3Rpb24oa2V5LCBzZWxlY3Rpb24pIHtcbiAgICAgIHZhciBhbW91bnQgPSBzZWxlY3Rpb24uZW5kLmNvbCAtIHNlbGVjdGlvbi5zdGFydC5jb2wgKyAxO1xuICAgICAgdGhpcy5hbHRlcigncmVtb3ZlX2NvbCcsIHNlbGVjdGlvbi5zdGFydC5jb2wsIGFtb3VudCwgJ0NvbnRleHRNZW51LnJlbW92ZUNvbHVtbicpO1xuICAgIH0sXG4gICAgZGlzYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHNlbGVjdGVkID0gZ2V0VmFsaWRTZWxlY3Rpb24odGhpcyk7XG4gICAgICB2YXIgdG90YWxDb2x1bW5zID0gdGhpcy5jb3VudENvbHMoKTtcbiAgICAgIHJldHVybiAhc2VsZWN0ZWQgfHwgdGhpcy5zZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIucm93cyB8fCB0aGlzLnNlbGVjdGlvbi5zZWxlY3RlZEhlYWRlci5jb3JuZXIgfHwgIXRoaXMuaXNDb2x1bW5Nb2RpZmljYXRpb25BbGxvd2VkKCkgfHwgIXRvdGFsQ29sdW1ucztcbiAgICB9LFxuICAgIGhpZGRlbjogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gIXRoaXMuZ2V0U2V0dGluZ3MoKS5hbGxvd1JlbW92ZUNvbHVtbjtcbiAgICB9XG4gIH07XG59XG5cbi8vIyBcbn0se1widXRpbHNcIjo4OH1dLDgzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBLRVk6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIEtFWTtcbiAgICB9fSxcbiAgcmVtb3ZlUm93SXRlbToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gcmVtb3ZlUm93SXRlbTtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfdXRpbHNfXztcbnZhciBnZXRWYWxpZFNlbGVjdGlvbiA9ICgkX19fNDZfXzQ2X180N191dGlsc19fID0gX2RlcmVxXyhcInV0aWxzXCIpLCAkX19fNDZfXzQ2X180N191dGlsc19fICYmICRfX180Nl9fNDZfXzQ3X3V0aWxzX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N191dGlsc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N191dGlsc19ffSkuZ2V0VmFsaWRTZWxlY3Rpb247XG52YXIgS0VZID0gJ3JlbW92ZV9yb3cnO1xuZnVuY3Rpb24gcmVtb3ZlUm93SXRlbSgpIHtcbiAgcmV0dXJuIHtcbiAgICBrZXk6IEtFWSxcbiAgICBuYW1lOiAnUmVtb3ZlIHJvdycsXG4gICAgY2FsbGJhY2s6IGZ1bmN0aW9uKGtleSwgc2VsZWN0aW9uKSB7XG4gICAgICB2YXIgYW1vdW50ID0gc2VsZWN0aW9uLmVuZC5yb3cgLSBzZWxlY3Rpb24uc3RhcnQucm93ICsgMTtcbiAgICAgIHRoaXMuYWx0ZXIoJ3JlbW92ZV9yb3cnLCBzZWxlY3Rpb24uc3RhcnQucm93LCBhbW91bnQsICdDb250ZXh0TWVudS5yZW1vdmVSb3cnKTtcbiAgICB9LFxuICAgIGRpc2FibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzZWxlY3RlZCA9IGdldFZhbGlkU2VsZWN0aW9uKHRoaXMpO1xuICAgICAgdmFyIHRvdGFsUm93cyA9IHRoaXMuY291bnRSb3dzKCk7XG4gICAgICByZXR1cm4gIXNlbGVjdGVkIHx8IHRoaXMuc2VsZWN0aW9uLnNlbGVjdGVkSGVhZGVyLmNvbHMgfHwgdGhpcy5zZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIuY29ybmVyIHx8ICF0b3RhbFJvd3M7XG4gICAgfSxcbiAgICBoaWRkZW46IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICF0aGlzLmdldFNldHRpbmdzKCkuYWxsb3dSZW1vdmVSb3c7XG4gICAgfVxuICB9O1xufVxuXG4vLyMgXG59LHtcInV0aWxzXCI6ODh9XSw4NDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgS0VZOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBLRVk7XG4gICAgfX0sXG4gIHJvd0Fib3ZlSXRlbToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gcm93QWJvdmVJdGVtO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N191dGlsc19fO1xudmFyIGdldFZhbGlkU2VsZWN0aW9uID0gKCRfX180Nl9fNDZfXzQ3X3V0aWxzX18gPSBfZGVyZXFfKFwidXRpbHNcIiksICRfX180Nl9fNDZfXzQ3X3V0aWxzX18gJiYgJF9fXzQ2X180Nl9fNDdfdXRpbHNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X3V0aWxzX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X3V0aWxzX199KS5nZXRWYWxpZFNlbGVjdGlvbjtcbnZhciBLRVkgPSAncm93X2Fib3ZlJztcbmZ1bmN0aW9uIHJvd0Fib3ZlSXRlbSgpIHtcbiAgcmV0dXJuIHtcbiAgICBrZXk6IEtFWSxcbiAgICBuYW1lOiAnSW5zZXJ0IHJvdyBhYm92ZScsXG4gICAgY2FsbGJhY2s6IGZ1bmN0aW9uKGtleSwgc2VsZWN0aW9uKSB7XG4gICAgICB0aGlzLmFsdGVyKCdpbnNlcnRfcm93Jywgc2VsZWN0aW9uLnN0YXJ0LnJvdywgMSwgJ0NvbnRleHRNZW51LnJvd0Fib3ZlJyk7XG4gICAgfSxcbiAgICBkaXNhYmxlZDogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc2VsZWN0ZWQgPSBnZXRWYWxpZFNlbGVjdGlvbih0aGlzKTtcbiAgICAgIHJldHVybiAhc2VsZWN0ZWQgfHwgdGhpcy5zZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIuY29scyB8fCB0aGlzLmNvdW50Um93cygpID49IHRoaXMuZ2V0U2V0dGluZ3MoKS5tYXhSb3dzO1xuICAgIH0sXG4gICAgaGlkZGVuOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAhdGhpcy5nZXRTZXR0aW5ncygpLmFsbG93SW5zZXJ0Um93O1xuICAgIH1cbiAgfTtcbn1cblxuLy8jIFxufSx7XCJ1dGlsc1wiOjg4fV0sODU6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIEtFWToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gS0VZO1xuICAgIH19LFxuICByb3dCZWxvd0l0ZW06IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHJvd0JlbG93SXRlbTtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfdXRpbHNfXztcbnZhciBnZXRWYWxpZFNlbGVjdGlvbiA9ICgkX19fNDZfXzQ2X180N191dGlsc19fID0gX2RlcmVxXyhcInV0aWxzXCIpLCAkX19fNDZfXzQ2X180N191dGlsc19fICYmICRfX180Nl9fNDZfXzQ3X3V0aWxzX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N191dGlsc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N191dGlsc19ffSkuZ2V0VmFsaWRTZWxlY3Rpb247XG52YXIgS0VZID0gJ3Jvd19iZWxvdyc7XG5mdW5jdGlvbiByb3dCZWxvd0l0ZW0oKSB7XG4gIHJldHVybiB7XG4gICAga2V5OiBLRVksXG4gICAgbmFtZTogJ0luc2VydCByb3cgYmVsb3cnLFxuICAgIGNhbGxiYWNrOiBmdW5jdGlvbihrZXksIHNlbGVjdGlvbikge1xuICAgICAgdGhpcy5hbHRlcignaW5zZXJ0X3JvdycsIHNlbGVjdGlvbi5lbmQucm93ICsgMSwgMSwgJ0NvbnRleHRNZW51LnJvd0JlbG93Jyk7XG4gICAgfSxcbiAgICBkaXNhYmxlZDogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc2VsZWN0ZWQgPSBnZXRWYWxpZFNlbGVjdGlvbih0aGlzKTtcbiAgICAgIHJldHVybiAhc2VsZWN0ZWQgfHwgdGhpcy5zZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIuY29scyB8fCB0aGlzLmNvdW50Um93cygpID49IHRoaXMuZ2V0U2V0dGluZ3MoKS5tYXhSb3dzO1xuICAgIH0sXG4gICAgaGlkZGVuOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAhdGhpcy5nZXRTZXR0aW5ncygpLmFsbG93SW5zZXJ0Um93O1xuICAgIH1cbiAgfTtcbn1cblxuLy8jIFxufSx7XCJ1dGlsc1wiOjg4fV0sODY6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIEtFWToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gS0VZO1xuICAgIH19LFxuICBzZXBhcmF0b3JJdGVtOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBzZXBhcmF0b3JJdGVtO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciBLRVkgPSAnLS0tLS0tLS0tJztcbmZ1bmN0aW9uIHNlcGFyYXRvckl0ZW0oKSB7XG4gIHJldHVybiB7bmFtZTogS0VZfTtcbn1cblxuLy8jIFxufSx7fV0sODc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIEtFWToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gS0VZO1xuICAgIH19LFxuICB1bmRvSXRlbToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdW5kb0l0ZW07XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyIEtFWSA9ICd1bmRvJztcbmZ1bmN0aW9uIHVuZG9JdGVtKCkge1xuICByZXR1cm4ge1xuICAgIGtleTogS0VZLFxuICAgIG5hbWU6ICdVbmRvJyxcbiAgICBjYWxsYmFjazogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLnVuZG8oKTtcbiAgICB9LFxuICAgIGRpc2FibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLnVuZG9SZWRvICYmICF0aGlzLnVuZG9SZWRvLmlzVW5kb0F2YWlsYWJsZSgpO1xuICAgIH1cbiAgfTtcbn1cblxuLy8jIFxufSx7fV0sODg6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIG5vcm1hbGl6ZVNlbGVjdGlvbjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbm9ybWFsaXplU2VsZWN0aW9uO1xuICAgIH19LFxuICBpc1NlcGFyYXRvcjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gaXNTZXBhcmF0b3I7XG4gICAgfX0sXG4gIGhhc1N1Yk1lbnU6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGhhc1N1Yk1lbnU7XG4gICAgfX0sXG4gIGlzRGlzYWJsZWQ6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGlzRGlzYWJsZWQ7XG4gICAgfX0sXG4gIGlzU2VsZWN0aW9uRGlzYWJsZWQ6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGlzU2VsZWN0aW9uRGlzYWJsZWQ7XG4gICAgfX0sXG4gIGdldFZhbGlkU2VsZWN0aW9uOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBnZXRWYWxpZFNlbGVjdGlvbjtcbiAgICB9fSxcbiAgcHJlcGFyZVZlcnRpY2FsQWxpZ25DbGFzczoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gcHJlcGFyZVZlcnRpY2FsQWxpZ25DbGFzcztcbiAgICB9fSxcbiAgcHJlcGFyZUhvcml6b250YWxBbGlnbkNsYXNzOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBwcmVwYXJlSG9yaXpvbnRhbEFsaWduQ2xhc3M7XG4gICAgfX0sXG4gIGdldEFsaWdubWVudENsYXNzZXM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGdldEFsaWdubWVudENsYXNzZXM7XG4gICAgfX0sXG4gIGFsaWduOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBhbGlnbjtcbiAgICB9fSxcbiAgY2hlY2tTZWxlY3Rpb25Db25zaXN0ZW5jeToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gY2hlY2tTZWxlY3Rpb25Db25zaXN0ZW5jeTtcbiAgICB9fSxcbiAgbWFya0xhYmVsQXNTZWxlY3RlZDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbWFya0xhYmVsQXNTZWxlY3RlZDtcbiAgICB9fSxcbiAgaXNJdGVtSGlkZGVuOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBpc0l0ZW1IaWRkZW47XG4gICAgfX0sXG4gIGZpbHRlclNlcGFyYXRvcnM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGZpbHRlclNlcGFyYXRvcnM7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3NlcGFyYXRvcl9fO1xudmFyIGFycmF5RWFjaCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gPSBfZGVyZXFfKFwiaGVscGVycy9hcnJheVwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9ffSkuYXJyYXlFYWNoO1xudmFyIGhhc0NsYXNzID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9lbGVtZW50XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X199KS5oYXNDbGFzcztcbnZhciBTRVBBUkFUT1IgPSAoJF9fcHJlZGVmaW5lZEl0ZW1zXzQ3X3NlcGFyYXRvcl9fID0gX2RlcmVxXyhcInByZWRlZmluZWRJdGVtcy9zZXBhcmF0b3JcIiksICRfX3ByZWRlZmluZWRJdGVtc180N19zZXBhcmF0b3JfXyAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfc2VwYXJhdG9yX18uX19lc01vZHVsZSAmJiAkX19wcmVkZWZpbmVkSXRlbXNfNDdfc2VwYXJhdG9yX18gfHwge2RlZmF1bHQ6ICRfX3ByZWRlZmluZWRJdGVtc180N19zZXBhcmF0b3JfX30pLktFWTtcbmZ1bmN0aW9uIG5vcm1hbGl6ZVNlbGVjdGlvbihzZWxSYW5nZSkge1xuICByZXR1cm4ge1xuICAgIHN0YXJ0OiBzZWxSYW5nZS5nZXRUb3BMZWZ0Q29ybmVyKCksXG4gICAgZW5kOiBzZWxSYW5nZS5nZXRCb3R0b21SaWdodENvcm5lcigpXG4gIH07XG59XG5mdW5jdGlvbiBpc1NlcGFyYXRvcihjZWxsKSB7XG4gIHJldHVybiBoYXNDbGFzcyhjZWxsLCAnaHRTZXBhcmF0b3InKTtcbn1cbmZ1bmN0aW9uIGhhc1N1Yk1lbnUoY2VsbCkge1xuICByZXR1cm4gaGFzQ2xhc3MoY2VsbCwgJ2h0U3VibWVudScpO1xufVxuZnVuY3Rpb24gaXNEaXNhYmxlZChjZWxsKSB7XG4gIHJldHVybiBoYXNDbGFzcyhjZWxsLCAnaHREaXNhYmxlZCcpO1xufVxuZnVuY3Rpb24gaXNTZWxlY3Rpb25EaXNhYmxlZChjZWxsKSB7XG4gIHJldHVybiBoYXNDbGFzcyhjZWxsLCAnaHRTZWxlY3Rpb25EaXNhYmxlZCcpO1xufVxuZnVuY3Rpb24gZ2V0VmFsaWRTZWxlY3Rpb24oaG90KSB7XG4gIHZhciBzZWxlY3RlZCA9IGhvdC5nZXRTZWxlY3RlZCgpO1xuICBpZiAoIXNlbGVjdGVkKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgaWYgKHNlbGVjdGVkWzBdIDwgMCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIHJldHVybiBzZWxlY3RlZDtcbn1cbmZ1bmN0aW9uIHByZXBhcmVWZXJ0aWNhbEFsaWduQ2xhc3MoY2xhc3NOYW1lLCBhbGlnbm1lbnQpIHtcbiAgaWYgKGNsYXNzTmFtZS5pbmRleE9mKGFsaWdubWVudCkgIT0gLTEpIHtcbiAgICByZXR1cm4gY2xhc3NOYW1lO1xuICB9XG4gIGNsYXNzTmFtZSA9IGNsYXNzTmFtZS5yZXBsYWNlKCdodFRvcCcsICcnKS5yZXBsYWNlKCdodE1pZGRsZScsICcnKS5yZXBsYWNlKCdodEJvdHRvbScsICcnKS5yZXBsYWNlKCcgICcsICcnKTtcbiAgY2xhc3NOYW1lICs9ICcgJyArIGFsaWdubWVudDtcbiAgcmV0dXJuIGNsYXNzTmFtZTtcbn1cbmZ1bmN0aW9uIHByZXBhcmVIb3Jpem9udGFsQWxpZ25DbGFzcyhjbGFzc05hbWUsIGFsaWdubWVudCkge1xuICBpZiAoY2xhc3NOYW1lLmluZGV4T2YoYWxpZ25tZW50KSAhPSAtMSkge1xuICAgIHJldHVybiBjbGFzc05hbWU7XG4gIH1cbiAgY2xhc3NOYW1lID0gY2xhc3NOYW1lLnJlcGxhY2UoJ2h0TGVmdCcsICcnKS5yZXBsYWNlKCdodENlbnRlcicsICcnKS5yZXBsYWNlKCdodFJpZ2h0JywgJycpLnJlcGxhY2UoJ2h0SnVzdGlmeScsICcnKS5yZXBsYWNlKCcgICcsICcnKTtcbiAgY2xhc3NOYW1lICs9ICcgJyArIGFsaWdubWVudDtcbiAgcmV0dXJuIGNsYXNzTmFtZTtcbn1cbmZ1bmN0aW9uIGdldEFsaWdubWVudENsYXNzZXMocmFuZ2UsIGNhbGxiYWNrKSB7XG4gIHZhciBjbGFzc2VzID0ge307XG4gIGZvciAodmFyIHJvdyA9IHJhbmdlLmZyb20ucm93OyByb3cgPD0gcmFuZ2UudG8ucm93OyByb3crKykge1xuICAgIGZvciAodmFyIGNvbCA9IHJhbmdlLmZyb20uY29sOyBjb2wgPD0gcmFuZ2UudG8uY29sOyBjb2wrKykge1xuICAgICAgaWYgKCFjbGFzc2VzW3Jvd10pIHtcbiAgICAgICAgY2xhc3Nlc1tyb3ddID0gW107XG4gICAgICB9XG4gICAgICBjbGFzc2VzW3Jvd11bY29sXSA9IGNhbGxiYWNrKHJvdywgY29sKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGNsYXNzZXM7XG59XG5mdW5jdGlvbiBhbGlnbihyYW5nZSwgdHlwZSwgYWxpZ25tZW50LCBjZWxsRGVzY3JpcHRvciwgcHJvcGVydHlTZXR0ZXIpIHtcbiAgaWYgKHJhbmdlLmZyb20ucm93ID09IHJhbmdlLnRvLnJvdyAmJiByYW5nZS5mcm9tLmNvbCA9PSByYW5nZS50by5jb2wpIHtcbiAgICBhcHBseUFsaWduQ2xhc3NOYW1lKHJhbmdlLmZyb20ucm93LCByYW5nZS5mcm9tLmNvbCwgdHlwZSwgYWxpZ25tZW50LCBjZWxsRGVzY3JpcHRvciwgcHJvcGVydHlTZXR0ZXIpO1xuICB9IGVsc2Uge1xuICAgIGZvciAodmFyIHJvdyA9IHJhbmdlLmZyb20ucm93OyByb3cgPD0gcmFuZ2UudG8ucm93OyByb3crKykge1xuICAgICAgZm9yICh2YXIgY29sID0gcmFuZ2UuZnJvbS5jb2w7IGNvbCA8PSByYW5nZS50by5jb2w7IGNvbCsrKSB7XG4gICAgICAgIGFwcGx5QWxpZ25DbGFzc05hbWUocm93LCBjb2wsIHR5cGUsIGFsaWdubWVudCwgY2VsbERlc2NyaXB0b3IsIHByb3BlcnR5U2V0dGVyKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbmZ1bmN0aW9uIGFwcGx5QWxpZ25DbGFzc05hbWUocm93LCBjb2wsIHR5cGUsIGFsaWdubWVudCwgY2VsbERlc2NyaXB0b3IsIHByb3BlcnR5U2V0dGVyKSB7XG4gIHZhciBjZWxsTWV0YSA9IGNlbGxEZXNjcmlwdG9yKHJvdywgY29sKTtcbiAgdmFyIGNsYXNzTmFtZSA9IGFsaWdubWVudDtcbiAgaWYgKGNlbGxNZXRhLmNsYXNzTmFtZSkge1xuICAgIGlmICh0eXBlID09PSAndmVydGljYWwnKSB7XG4gICAgICBjbGFzc05hbWUgPSBwcmVwYXJlVmVydGljYWxBbGlnbkNsYXNzKGNlbGxNZXRhLmNsYXNzTmFtZSwgYWxpZ25tZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2xhc3NOYW1lID0gcHJlcGFyZUhvcml6b250YWxBbGlnbkNsYXNzKGNlbGxNZXRhLmNsYXNzTmFtZSwgYWxpZ25tZW50KTtcbiAgICB9XG4gIH1cbiAgcHJvcGVydHlTZXR0ZXIocm93LCBjb2wsICdjbGFzc05hbWUnLCBjbGFzc05hbWUpO1xufVxuZnVuY3Rpb24gY2hlY2tTZWxlY3Rpb25Db25zaXN0ZW5jeShyYW5nZSwgY29tcGFyYXRvcikge1xuICB2YXIgcmVzdWx0ID0gZmFsc2U7XG4gIGlmIChyYW5nZSkge1xuICAgIHJhbmdlLmZvckFsbChmdW5jdGlvbihyb3csIGNvbCkge1xuICAgICAgaWYgKGNvbXBhcmF0b3Iocm93LCBjb2wpKSB7XG4gICAgICAgIHJlc3VsdCA9IHRydWU7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gbWFya0xhYmVsQXNTZWxlY3RlZChsYWJlbCkge1xuICByZXR1cm4gJzxzcGFuIGNsYXNzPVwic2VsZWN0ZWRcIj4nICsgU3RyaW5nLmZyb21DaGFyQ29kZSgxMDAwMykgKyAnPC9zcGFuPicgKyBsYWJlbDtcbn1cbmZ1bmN0aW9uIGlzSXRlbUhpZGRlbihpdGVtLCBpbnN0YW5jZSkge1xuICByZXR1cm4gIWl0ZW0uaGlkZGVuIHx8ICEodHlwZW9mIGl0ZW0uaGlkZGVuID09ICdmdW5jdGlvbicgJiYgaXRlbS5oaWRkZW4uY2FsbChpbnN0YW5jZSkpO1xufVxuZnVuY3Rpb24gc2hpZnRTZXBhcmF0b3JzKGl0ZW1zLCBzZXBhcmF0b3IpIHtcbiAgdmFyIHJlc3VsdCA9IGl0ZW1zLnNsaWNlKDApO1xuICBmb3IgKHZhciBpID0gMDsgaSA8IHJlc3VsdC5sZW5ndGg7ICkge1xuICAgIGlmIChyZXN1bHRbaV0ubmFtZSA9PT0gc2VwYXJhdG9yKSB7XG4gICAgICByZXN1bHQuc2hpZnQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBwb3BTZXBhcmF0b3JzKGl0ZW1zLCBzZXBhcmF0b3IpIHtcbiAgdmFyIHJlc3VsdCA9IGl0ZW1zLnNsaWNlKDApO1xuICByZXN1bHQucmV2ZXJzZSgpO1xuICByZXN1bHQgPSBzaGlmdFNlcGFyYXRvcnMocmVzdWx0LCBzZXBhcmF0b3IpO1xuICByZXN1bHQucmV2ZXJzZSgpO1xuICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gcmVtb3ZlRHVwbGljYXRlZFNlcGFyYXRvcnMoaXRlbXMpIHtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICBhcnJheUVhY2goaXRlbXMsIChmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHtcbiAgICBpZiAoaW5kZXggPiAwKSB7XG4gICAgICBpZiAocmVzdWx0W3Jlc3VsdC5sZW5ndGggLSAxXS5uYW1lICE9PSB2YWx1ZS5uYW1lKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0LnB1c2godmFsdWUpO1xuICAgIH1cbiAgfSkpO1xuICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gZmlsdGVyU2VwYXJhdG9ycyhpdGVtcykge1xuICB2YXIgc2VwYXJhdG9yID0gYXJndW1lbnRzWzFdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1sxXSA6IFNFUEFSQVRPUjtcbiAgdmFyIHJlc3VsdCA9IGl0ZW1zLnNsaWNlKDApO1xuICByZXN1bHQgPSBzaGlmdFNlcGFyYXRvcnMocmVzdWx0LCBzZXBhcmF0b3IpO1xuICByZXN1bHQgPSBwb3BTZXBhcmF0b3JzKHJlc3VsdCwgc2VwYXJhdG9yKTtcbiAgcmVzdWx0ID0gcmVtb3ZlRHVwbGljYXRlZFNlcGFyYXRvcnMocmVzdWx0KTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLy8jIFxufSx7XCJoZWxwZXJzL2FycmF5XCI6NDMsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJwcmVkZWZpbmVkSXRlbXMvc2VwYXJhdG9yXCI6ODZ9XSw4OTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgQ29udGV4dE1lbnVDb3B5UGFzdGU6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIENvbnRleHRNZW51Q29weVBhc3RlO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fLFxuICAgICRfX3plcm9jbGlwYm9hcmRfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyxcbiAgICAkX19fNDZfXzQ2X180N19jb250ZXh0TWVudV80N19wcmVkZWZpbmVkSXRlbXNfXztcbnZhciBCYXNlUGx1Z2luID0gKCRfX180Nl9fNDZfXzQ3X185NV9iYXNlX18gPSBfZGVyZXFfKFwiX2Jhc2VcIiksICRfX180Nl9fNDZfXzQ3X185NV9iYXNlX18gJiYgJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X185NV9iYXNlX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X185NV9iYXNlX199KS5kZWZhdWx0O1xudmFyIFplcm9DbGlwYm9hcmQgPSAoJF9femVyb2NsaXBib2FyZF9fID0gX2RlcmVxXyhcInplcm9jbGlwYm9hcmRcIiksICRfX3plcm9jbGlwYm9hcmRfXyAmJiAkX196ZXJvY2xpcGJvYXJkX18uX19lc01vZHVsZSAmJiAkX196ZXJvY2xpcGJvYXJkX18gfHwge2RlZmF1bHQ6ICRfX3plcm9jbGlwYm9hcmRfX30pLmRlZmF1bHQ7XG52YXIgcmVtb3ZlQ2xhc3MgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLnJlbW92ZUNsYXNzO1xudmFyIGFycmF5RWFjaCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gPSBfZGVyZXFfKFwiaGVscGVycy9hcnJheVwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9ffSkuYXJyYXlFYWNoO1xudmFyIEV2ZW50TWFuYWdlciA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyA9IF9kZXJlcV8oXCJldmVudE1hbmFnZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9ffSkuRXZlbnRNYW5hZ2VyO1xudmFyIHJlZ2lzdGVyUGx1Z2luID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyA9IF9kZXJlcV8oXCJwbHVnaW5zXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX199KS5yZWdpc3RlclBsdWdpbjtcbnZhciBTRVBBUkFUT1IgPSAoJF9fXzQ2X180Nl9fNDdfY29udGV4dE1lbnVfNDdfcHJlZGVmaW5lZEl0ZW1zX18gPSBfZGVyZXFfKFwiY29udGV4dE1lbnUvcHJlZGVmaW5lZEl0ZW1zXCIpLCAkX19fNDZfXzQ2X180N19jb250ZXh0TWVudV80N19wcmVkZWZpbmVkSXRlbXNfXyAmJiAkX19fNDZfXzQ2X180N19jb250ZXh0TWVudV80N19wcmVkZWZpbmVkSXRlbXNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2NvbnRleHRNZW51XzQ3X3ByZWRlZmluZWRJdGVtc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19jb250ZXh0TWVudV80N19wcmVkZWZpbmVkSXRlbXNfX30pLlNFUEFSQVRPUjtcbnZhciBDb250ZXh0TWVudUNvcHlQYXN0ZSA9IGZ1bmN0aW9uIENvbnRleHRNZW51Q29weVBhc3RlKGhvdEluc3RhbmNlKSB7XG4gICR0cmFjZXVyUnVudGltZS5zdXBlckNvbnN0cnVjdG9yKCRDb250ZXh0TWVudUNvcHlQYXN0ZSkuY2FsbCh0aGlzLCBob3RJbnN0YW5jZSk7XG4gIHRoaXMuZXZlbnRNYW5hZ2VyID0gbmV3IEV2ZW50TWFuYWdlcih0aGlzKTtcbiAgdGhpcy5zd2ZQYXRoID0gbnVsbDtcbiAgdGhpcy5vdXRzaWRlQ2xpY2tEZXNlbGVjdHNDYWNoZSA9IG51bGw7XG59O1xudmFyICRDb250ZXh0TWVudUNvcHlQYXN0ZSA9IENvbnRleHRNZW51Q29weVBhc3RlO1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoQ29udGV4dE1lbnVDb3B5UGFzdGUsIHtcbiAgaXNFbmFibGVkOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5ob3QuZ2V0U2V0dGluZ3MoKS5jb250ZXh0TWVudUNvcHlQYXN0ZTtcbiAgfSxcbiAgZW5hYmxlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fNyA9IHRoaXM7XG4gICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHRoaXMuaG90LmdldFNldHRpbmdzKCkuY29udGV4dE1lbnVDb3B5UGFzdGUgPT09ICdvYmplY3QnKSB7XG4gICAgICB0aGlzLnN3ZlBhdGggPSB0aGlzLmhvdC5nZXRTZXR0aW5ncygpLmNvbnRleHRNZW51Q29weVBhc3RlLnN3ZlBhdGg7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgWmVyb0NsaXBib2FyZCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1RvIGJlIGFibGUgdG8gdXNlIHRoZSBDb3B5L1Bhc3RlIGZlYXR1cmUgZnJvbSB0aGUgY29udGV4dCBtZW51LCB5b3UgbmVlZCB0byBtYW51YWxseSBpbmNsdWRlIFplcm9DbGlwYm9hcmQuanMgZmlsZSB0byB5b3VyIHdlYnNpdGUuJyk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBuZXcgQWN0aXZlWE9iamVjdCgnU2hvY2t3YXZlRmxhc2guU2hvY2t3YXZlRmxhc2gnKTtcbiAgICB9IGNhdGNoIChleGNlcHRpb24pIHtcbiAgICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yLm1pbWVUeXBlc1snYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2gnXSA9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdUbyBiZSBhYmxlIHRvIHVzZSB0aGUgQ29weS9QYXN0ZSBmZWF0dXJlIGZyb20gdGhlIGNvbnRleHQgbWVudSwgeW91ciBicm93c2VyIG5lZWRzIHRvIGhhdmUgRmxhc2ggUGx1Z2luIGluc3RhbGxlZC4nKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHRoaXMuc3dmUGF0aCkge1xuICAgICAgWmVyb0NsaXBib2FyZC5jb25maWcoe3N3ZlBhdGg6IHRoaXMuc3dmUGF0aH0pO1xuICAgIH1cbiAgICB0aGlzLmhvdC5hZGRIb29rKCdhZnRlckNvbnRleHRNZW51U2hvdycsIChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX183Lm9uQWZ0ZXJDb250ZXh0TWVudVNob3coKTtcbiAgICB9KSk7XG4gICAgdGhpcy5ob3QuYWRkSG9vaygnYWZ0ZXJDb250ZXh0TWVudURlZmF1bHRPcHRpb25zJywgKGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgIHJldHVybiAkX183Lm9uQWZ0ZXJDb250ZXh0TWVudURlZmF1bHRPcHRpb25zKG9wdGlvbnMpO1xuICAgIH0pKTtcbiAgICB0aGlzLnJlZ2lzdGVyRXZlbnRzKCk7XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICRDb250ZXh0TWVudUNvcHlQYXN0ZS5wcm90b3R5cGUsIFwiZW5hYmxlUGx1Z2luXCIpLmNhbGwodGhpcyk7XG4gIH0sXG4gIGRpc2FibGVQbHVnaW46IGZ1bmN0aW9uKCkge1xuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkQ29udGV4dE1lbnVDb3B5UGFzdGUucHJvdG90eXBlLCBcImRpc2FibGVQbHVnaW5cIikuY2FsbCh0aGlzKTtcbiAgfSxcbiAgcmVnaXN0ZXJFdmVudHM6IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX183ID0gdGhpcztcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKGRvY3VtZW50LCAnbW91c2VlbnRlcicsIChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX183LnJlbW92ZUN1cnJlbnRDbGFzcygpO1xuICAgIH0pKTtcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKGRvY3VtZW50LCAnbW91c2VsZWF2ZScsIChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX183LnJlbW92ZVplcm9DbGlwYm9hcmRDbGFzcygpO1xuICAgIH0pKTtcbiAgfSxcbiAgZ2V0Q29weVZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmhvdC5jb3B5UGFzdGUuc2V0Q29weWFibGVUZXh0KCk7XG4gICAgdGhpcy5ob3QuY29weVBhc3RlLmNvcHlQYXN0ZUluc3RhbmNlLnRyaWdnZXJDb3B5KCk7XG4gICAgcmV0dXJuIHRoaXMuaG90LmNvcHlQYXN0ZS5jb3B5UGFzdGVJbnN0YW5jZS5lbFRleHRhcmVhLnZhbHVlO1xuICB9LFxuICBvbkFmdGVyQ29udGV4dE1lbnVEZWZhdWx0T3B0aW9uczogZnVuY3Rpb24oZGVmYXVsdE9wdGlvbnMpIHtcbiAgICBkZWZhdWx0T3B0aW9ucy5pdGVtcy51bnNoaWZ0KHtcbiAgICAgIGtleTogJ2NvcHknLFxuICAgICAgbmFtZTogJ0NvcHknLFxuICAgICAgZGlzYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIuY29ybmVyO1xuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGtleTogJ3Bhc3RlJyxcbiAgICAgIG5hbWU6ICdQYXN0ZScsXG4gICAgICBjYWxsYmFjazogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuY29weVBhc3RlLnRyaWdnZXJQYXN0ZSgpO1xuICAgICAgfSxcbiAgICAgIGRpc2FibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0aW9uLnNlbGVjdGVkSGVhZGVyLmNvcm5lcjtcbiAgICAgIH1cbiAgICB9LCB7bmFtZTogU0VQQVJBVE9SfSk7XG4gIH0sXG4gIG9uQWZ0ZXJDb250ZXh0TWVudVNob3c6IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX183ID0gdGhpcztcbiAgICB2YXIgY29udGV4dE1lbnUgPSB0aGlzLmhvdC5nZXRQbHVnaW4oJ2NvbnRleHRNZW51Jyk7XG4gICAgdmFyIGRhdGEgPSBjb250ZXh0TWVudS5tZW51LmhvdE1lbnUuZ2V0U291cmNlRGF0YSgpO1xuICAgIGFycmF5RWFjaChkYXRhLCAoZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHtcbiAgICAgIGlmIChpdGVtLmtleSA9PT0gJ2NvcHknKSB7XG4gICAgICAgIHZhciB6ZXJvQ2xpcGJvYXJkSW5zdGFuY2UgPSBuZXcgWmVyb0NsaXBib2FyZChjb250ZXh0TWVudS5tZW51LmhvdE1lbnUuZ2V0Q2VsbChpbmRleCwgMCkpO1xuICAgICAgICB6ZXJvQ2xpcGJvYXJkSW5zdGFuY2Uub2ZmKCk7XG4gICAgICAgIHplcm9DbGlwYm9hcmRJbnN0YW5jZS5vbignY29weScsIChmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgIHZhciBjbGlwYm9hcmQgPSBldmVudC5jbGlwYm9hcmREYXRhO1xuICAgICAgICAgIGNsaXBib2FyZC5zZXREYXRhKCd0ZXh0L3BsYWluJywgJF9fNy5nZXRDb3B5VmFsdWUoKSk7XG4gICAgICAgICAgJF9fNy5ob3QuZ2V0U2V0dGluZ3MoKS5vdXRzaWRlQ2xpY2tEZXNlbGVjdHMgPSAkX183Lm91dHNpZGVDbGlja0Rlc2VsZWN0c0NhY2hlO1xuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9KSk7XG4gIH0sXG4gIHJlbW92ZUN1cnJlbnRDbGFzczogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNvbnRleHRNZW51ID0gdGhpcy5ob3QuZ2V0UGx1Z2luKCdjb250ZXh0TWVudScpO1xuICAgIGlmICghY29udGV4dE1lbnUuZW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoY29udGV4dE1lbnUubWVudS5pc09wZW5lZCgpKSB7XG4gICAgICB2YXIgZWxlbWVudCA9IGNvbnRleHRNZW51Lm1lbnUuaG90TWVudS5yb290RWxlbWVudC5xdWVyeVNlbGVjdG9yKCd0ZC5jdXJyZW50Jyk7XG4gICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICByZW1vdmVDbGFzcyhlbGVtZW50LCAnY3VycmVudCcpO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLm91dHNpZGVDbGlja0Rlc2VsZWN0c0NhY2hlID0gdGhpcy5ob3QuZ2V0U2V0dGluZ3MoKS5vdXRzaWRlQ2xpY2tEZXNlbGVjdHM7XG4gICAgdGhpcy5ob3QuZ2V0U2V0dGluZ3MoKS5vdXRzaWRlQ2xpY2tEZXNlbGVjdHMgPSBmYWxzZTtcbiAgfSxcbiAgcmVtb3ZlWmVyb0NsaXBib2FyZENsYXNzOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgY29udGV4dE1lbnUgPSB0aGlzLmhvdC5nZXRQbHVnaW4oJ2NvbnRleHRNZW51Jyk7XG4gICAgaWYgKCFjb250ZXh0TWVudS5lbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChjb250ZXh0TWVudS5tZW51LmlzT3BlbmVkKCkpIHtcbiAgICAgIHZhciBlbGVtZW50ID0gY29udGV4dE1lbnUubWVudS5ob3RNZW51LnJvb3RFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3RkLnplcm9jbGlwYm9hcmQtaXMtaG92ZXInKTtcbiAgICAgIGlmIChlbGVtZW50KSB7XG4gICAgICAgIHJlbW92ZUNsYXNzKGVsZW1lbnQsICd6ZXJvY2xpcGJvYXJkLWlzLWhvdmVyJyk7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuaG90LmdldFNldHRpbmdzKCkub3V0c2lkZUNsaWNrRGVzZWxlY3RzID0gdGhpcy5vdXRzaWRlQ2xpY2tEZXNlbGVjdHNDYWNoZTtcbiAgfVxufSwge30sIEJhc2VQbHVnaW4pO1xuO1xucmVnaXN0ZXJQbHVnaW4oJ2NvbnRleHRNZW51Q29weVBhc3RlJywgQ29udGV4dE1lbnVDb3B5UGFzdGUpO1xuXG4vLyMgXG59LHtcIl9iYXNlXCI6NjIsXCJjb250ZXh0TWVudS9wcmVkZWZpbmVkSXRlbXNcIjo3NSxcImV2ZW50TWFuYWdlclwiOjQyLFwiaGVscGVycy9hcnJheVwiOjQzLFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwicGx1Z2luc1wiOjYxLFwiemVyb2NsaXBib2FyZFwiOlwiemVyb2NsaXBib2FyZFwifV0sOTA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIENvcHlQYXN0ZVBsdWdpbjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gQ29weVBhc3RlUGx1Z2luO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18sXG4gICAgJF9fY29weVBhc3RlX18sXG4gICAgJF9fU2hlZXRDbGlwX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19mdW5jdGlvbl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X3JhbmdlX187XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX199KS5kZWZhdWx0O1xudmFyIGNvcHlQYXN0ZSA9ICgkX19jb3B5UGFzdGVfXyA9IF9kZXJlcV8oXCJjb3B5UGFzdGVcIiksICRfX2NvcHlQYXN0ZV9fICYmICRfX2NvcHlQYXN0ZV9fLl9fZXNNb2R1bGUgJiYgJF9fY29weVBhc3RlX18gfHwge2RlZmF1bHQ6ICRfX2NvcHlQYXN0ZV9ffSkuZGVmYXVsdDtcbnZhciBTaGVldENsaXAgPSAoJF9fU2hlZXRDbGlwX18gPSBfZGVyZXFfKFwiU2hlZXRDbGlwXCIpLCAkX19TaGVldENsaXBfXyAmJiAkX19TaGVldENsaXBfXy5fX2VzTW9kdWxlICYmICRfX1NoZWV0Q2xpcF9fIHx8IHtkZWZhdWx0OiAkX19TaGVldENsaXBfX30pLmRlZmF1bHQ7XG52YXIgJF9fMyA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL3VuaWNvZGVcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9ffSksXG4gICAgS0VZX0NPREVTID0gJF9fMy5LRVlfQ09ERVMsXG4gICAgaXNDdHJsS2V5ID0gJF9fMy5pc0N0cmxLZXk7XG52YXIgYXJyYXlFYWNoID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2FycmF5XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X199KS5hcnJheUVhY2g7XG52YXIgcmFuZ2VFYWNoID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gPSBfZGVyZXFfKFwiaGVscGVycy9udW1iZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX199KS5yYW5nZUVhY2g7XG52YXIgJF9fNiA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2V2ZW50XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9ffSksXG4gICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uID0gJF9fNi5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24sXG4gICAgaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSAkX182LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkO1xudmFyIGdldFNlbGVjdGlvblRleHQgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLmdldFNlbGVjdGlvblRleHQ7XG52YXIgcHJveHkgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19mdW5jdGlvbl9fID0gX2RlcmVxXyhcImhlbHBlcnMvZnVuY3Rpb25cIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZnVuY3Rpb25fXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Z1bmN0aW9uX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Z1bmN0aW9uX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZnVuY3Rpb25fX30pLnByb3h5O1xudmFyIFdhbGtvbnRhYmxlQ2VsbENvb3JkcyA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2VsbF80N19jb29yZHNfXyA9IF9kZXJlcV8oXCIzcmRwYXJ0eS93YWxrb250YWJsZS9zcmMvY2VsbC9jb29yZHNcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19ffSkuV2Fsa29udGFibGVDZWxsQ29vcmRzO1xudmFyIFdhbGtvbnRhYmxlQ2VsbFJhbmdlID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X3JhbmdlX18gPSBfZGVyZXFfKFwiM3JkcGFydHkvd2Fsa29udGFibGUvc3JjL2NlbGwvcmFuZ2VcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X3JhbmdlX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfcmFuZ2VfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X3JhbmdlX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X3JhbmdlX199KS5XYWxrb250YWJsZUNlbGxSYW5nZTtcbmZ1bmN0aW9uIENvcHlQYXN0ZVBsdWdpbihpbnN0YW5jZSkge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuICB0aGlzLmNvcHlQYXN0ZUluc3RhbmNlID0gY29weVBhc3RlKCk7XG4gIHRoaXMuY29weVBhc3RlSW5zdGFuY2Uub25DdXQob25DdXQpO1xuICB0aGlzLmNvcHlQYXN0ZUluc3RhbmNlLnRyaWdnZXJDb3B5ID0gY2FsbENvcHlBY3Rpb247XG4gIHRoaXMuY29weVBhc3RlSW5zdGFuY2Uub25QYXN0ZShvblBhc3RlKTtcbiAgdGhpcy5vblBhc3RlID0gb25QYXN0ZTtcbiAgdGhpcy5jb3B5YWJsZVJhbmdlcyA9IFtdO1xuICBpbnN0YW5jZS5hZGRIb29rKCdiZWZvcmVLZXlEb3duJywgb25CZWZvcmVLZXlEb3duKTtcbiAgZnVuY3Rpb24gb25DdXQoKSB7XG4gICAgaWYgKCFpbnN0YW5jZS5pc0xpc3RlbmluZygpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGNhbGxDdXRBY3Rpb24oKSB7XG4gICAgdmFyIHJhbmdlZERhdGEgPSBfdGhpcy5nZXRSYW5nZWREYXRhKF90aGlzLmNvcHlhYmxlUmFuZ2VzKTtcbiAgICBpZiAoaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5mcmFnbWVudFNlbGVjdGlvbiAmJiAoU2hlZXRDbGlwLnN0cmluZ2lmeShyYW5nZWREYXRhKSAhPSBnZXRTZWxlY3Rpb25UZXh0KCkpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBhbGxvd0N1dHRpbmdPdXQgPSAhIWluc3RhbmNlLnJ1bkhvb2tzKCdiZWZvcmVDdXQnLCByYW5nZWREYXRhLCBfdGhpcy5jb3B5YWJsZVJhbmdlcyk7XG4gICAgaWYgKGFsbG93Q3V0dGluZ091dCkge1xuICAgICAgaW5zdGFuY2UuY29weVBhc3RlLmNvcHlQYXN0ZUluc3RhbmNlLmNvcHlhYmxlKFNoZWV0Q2xpcC5zdHJpbmdpZnkocmFuZ2VkRGF0YSkpO1xuICAgICAgaW5zdGFuY2Uuc2VsZWN0aW9uLmVtcHR5KCk7XG4gICAgICBpbnN0YW5jZS5ydW5Ib29rcygnYWZ0ZXJDdXQnLCByYW5nZWREYXRhLCBfdGhpcy5jb3B5YWJsZVJhbmdlcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGluc3RhbmNlLmNvcHlQYXN0ZS5jb3B5UGFzdGVJbnN0YW5jZS5jb3B5YWJsZSgnJyk7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGNhbGxDb3B5QWN0aW9uKCkge1xuICAgIGlmICghaW5zdGFuY2UuaXNMaXN0ZW5pbmcoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgcmFuZ2VkRGF0YSA9IF90aGlzLmdldFJhbmdlZERhdGEoX3RoaXMuY29weWFibGVSYW5nZXMpO1xuICAgIGlmIChpbnN0YW5jZS5nZXRTZXR0aW5ncygpLmZyYWdtZW50U2VsZWN0aW9uICYmIChTaGVldENsaXAuc3RyaW5naWZ5KHJhbmdlZERhdGEpICE9IGdldFNlbGVjdGlvblRleHQoKSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGFsbG93Q29weWluZyA9ICEhaW5zdGFuY2UucnVuSG9va3MoJ2JlZm9yZUNvcHknLCByYW5nZWREYXRhLCBfdGhpcy5jb3B5YWJsZVJhbmdlcyk7XG4gICAgaWYgKGFsbG93Q29weWluZykge1xuICAgICAgaW5zdGFuY2UuY29weVBhc3RlLmNvcHlQYXN0ZUluc3RhbmNlLmNvcHlhYmxlKFNoZWV0Q2xpcC5zdHJpbmdpZnkocmFuZ2VkRGF0YSkpO1xuICAgICAgaW5zdGFuY2UucnVuSG9va3MoJ2FmdGVyQ29weScsIHJhbmdlZERhdGEsIF90aGlzLmNvcHlhYmxlUmFuZ2VzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaW5zdGFuY2UuY29weVBhc3RlLmNvcHlQYXN0ZUluc3RhbmNlLmNvcHlhYmxlKCcnKTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gb25QYXN0ZShzdHIpIHtcbiAgICB2YXIgaW5wdXQsXG4gICAgICAgIGlucHV0QXJyYXksXG4gICAgICAgIHNlbGVjdGVkLFxuICAgICAgICBjb29yZHNGcm9tLFxuICAgICAgICBjb29yZHNUbyxcbiAgICAgICAgY2VsbFJhbmdlLFxuICAgICAgICB0b3BMZWZ0Q29ybmVyLFxuICAgICAgICBib3R0b21SaWdodENvcm5lcixcbiAgICAgICAgYXJlYVN0YXJ0LFxuICAgICAgICBhcmVhRW5kO1xuICAgIGlmICghaW5zdGFuY2UuaXNMaXN0ZW5pbmcoKSB8fCAhaW5zdGFuY2Uuc2VsZWN0aW9uLmlzU2VsZWN0ZWQoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpbnB1dCA9IHN0cjtcbiAgICBpbnB1dEFycmF5ID0gU2hlZXRDbGlwLnBhcnNlKGlucHV0KTtcbiAgICBzZWxlY3RlZCA9IGluc3RhbmNlLmdldFNlbGVjdGVkKCk7XG4gICAgY29vcmRzRnJvbSA9IG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoc2VsZWN0ZWRbMF0sIHNlbGVjdGVkWzFdKTtcbiAgICBjb29yZHNUbyA9IG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoc2VsZWN0ZWRbMl0sIHNlbGVjdGVkWzNdKTtcbiAgICBjZWxsUmFuZ2UgPSBuZXcgV2Fsa29udGFibGVDZWxsUmFuZ2UoY29vcmRzRnJvbSwgY29vcmRzRnJvbSwgY29vcmRzVG8pO1xuICAgIHRvcExlZnRDb3JuZXIgPSBjZWxsUmFuZ2UuZ2V0VG9wTGVmdENvcm5lcigpO1xuICAgIGJvdHRvbVJpZ2h0Q29ybmVyID0gY2VsbFJhbmdlLmdldEJvdHRvbVJpZ2h0Q29ybmVyKCk7XG4gICAgYXJlYVN0YXJ0ID0gdG9wTGVmdENvcm5lcjtcbiAgICBhcmVhRW5kID0gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhNYXRoLm1heChib3R0b21SaWdodENvcm5lci5yb3csIGlucHV0QXJyYXkubGVuZ3RoIC0gMSArIHRvcExlZnRDb3JuZXIucm93KSwgTWF0aC5tYXgoYm90dG9tUmlnaHRDb3JuZXIuY29sLCBpbnB1dEFycmF5WzBdLmxlbmd0aCAtIDEgKyB0b3BMZWZ0Q29ybmVyLmNvbCkpO1xuICAgIHZhciBpc1NlbFJvd0FyZWFDb3ZlcklucHV0VmFsdWUgPSBjb29yZHNUby5yb3cgLSBjb29yZHNGcm9tLnJvdyA+PSBpbnB1dEFycmF5Lmxlbmd0aCAtIDE7XG4gICAgdmFyIGlzU2VsQ29sQXJlYUNvdmVySW5wdXRWYWx1ZSA9IGNvb3Jkc1RvLmNvbCAtIGNvb3Jkc0Zyb20uY29sID49IGlucHV0QXJyYXlbMF0ubGVuZ3RoIC0gMTtcbiAgICBpbnN0YW5jZS5hZGRIb29rT25jZSgnYWZ0ZXJDaGFuZ2UnLCAoZnVuY3Rpb24oY2hhbmdlcywgc291cmNlKSB7XG4gICAgICB2YXIgY2hhbmdlc0xlbmd0aCA9IGNoYW5nZXMgPyBjaGFuZ2VzLmxlbmd0aCA6IDA7XG4gICAgICBpZiAoY2hhbmdlc0xlbmd0aCkge1xuICAgICAgICB2YXIgb2Zmc2V0ID0ge1xuICAgICAgICAgIHJvdzogMCxcbiAgICAgICAgICBjb2w6IDBcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGhpZ2hlc3RDb2x1bW5JbmRleCA9IC0xO1xuICAgICAgICBhcnJheUVhY2goY2hhbmdlcywgKGZ1bmN0aW9uKGNoYW5nZSwgaW5kZXgpIHtcbiAgICAgICAgICB2YXIgbmV4dENoYW5nZSA9IGNoYW5nZXNMZW5ndGggPiBpbmRleCArIDEgPyBjaGFuZ2VzW2luZGV4ICsgMV0gOiBudWxsO1xuICAgICAgICAgIGlmIChuZXh0Q2hhbmdlKSB7XG4gICAgICAgICAgICBpZiAoIWlzU2VsUm93QXJlYUNvdmVySW5wdXRWYWx1ZSkge1xuICAgICAgICAgICAgICBvZmZzZXQucm93ID0gb2Zmc2V0LnJvdyArIE1hdGgubWF4KG5leHRDaGFuZ2VbMF0gLSBjaGFuZ2VbMF0gLSAxLCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaXNTZWxDb2xBcmVhQ292ZXJJbnB1dFZhbHVlICYmIGNoYW5nZVsxXSA+IGhpZ2hlc3RDb2x1bW5JbmRleCkge1xuICAgICAgICAgICAgICBoaWdoZXN0Q29sdW1uSW5kZXggPSBjaGFuZ2VbMV07XG4gICAgICAgICAgICAgIG9mZnNldC5jb2wgPSBvZmZzZXQuY29sICsgTWF0aC5tYXgobmV4dENoYW5nZVsxXSAtIGNoYW5nZVsxXSAtIDEsIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICBpbnN0YW5jZS5zZWxlY3RDZWxsKGFyZWFTdGFydC5yb3csIGFyZWFTdGFydC5jb2wsIGFyZWFFbmQucm93ICsgb2Zmc2V0LnJvdywgYXJlYUVuZC5jb2wgKyBvZmZzZXQuY29sKTtcbiAgICAgIH1cbiAgICB9KSk7XG4gICAgdmFyIGFsbG93UGFzdGluZyA9ICEhaW5zdGFuY2UucnVuSG9va3MoJ2JlZm9yZVBhc3RlJywgaW5wdXRBcnJheSwgX3RoaXMuY29weWFibGVSYW5nZXMpO1xuICAgIGlmIChhbGxvd1Bhc3RpbmcpIHtcbiAgICAgIGluc3RhbmNlLnBvcHVsYXRlRnJvbUFycmF5KGFyZWFTdGFydC5yb3csIGFyZWFTdGFydC5jb2wsIGlucHV0QXJyYXksIGFyZWFFbmQucm93LCBhcmVhRW5kLmNvbCwgJ0NvcHlQYXN0ZS5wYXN0ZScsIGluc3RhbmNlLmdldFNldHRpbmdzKCkucGFzdGVNb2RlKTtcbiAgICAgIGluc3RhbmNlLnJ1bkhvb2tzKCdhZnRlclBhc3RlJywgaW5wdXRBcnJheSwgX3RoaXMuY29weWFibGVSYW5nZXMpO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBvbkJlZm9yZUtleURvd24oZXZlbnQpIHtcbiAgICBpZiAoIWluc3RhbmNlLmdldFNlbGVjdGVkKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGluc3RhbmNlLmdldEFjdGl2ZUVkaXRvcigpICYmIGluc3RhbmNlLmdldEFjdGl2ZUVkaXRvcigpLmlzT3BlbmVkKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKGV2ZW50KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoaXNDdHJsS2V5KGV2ZW50LmtleUNvZGUpKSB7XG4gICAgICBpZiAoaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5mcmFnbWVudFNlbGVjdGlvbiAmJiBnZXRTZWxlY3Rpb25UZXh0KCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgX3RoaXMuc2V0Q29weWFibGVUZXh0KCk7XG4gICAgICBzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oZXZlbnQpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgY3RybERvd24gPSAoZXZlbnQuY3RybEtleSB8fCBldmVudC5tZXRhS2V5KSAmJiAhZXZlbnQuYWx0S2V5O1xuICAgIGlmIChjdHJsRG93bikge1xuICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT0gS0VZX0NPREVTLkEpIHtcbiAgICAgICAgaW5zdGFuY2UuX3JlZ2lzdGVyVGltZW91dChzZXRUaW1lb3V0KHByb3h5KF90aGlzLnNldENvcHlhYmxlVGV4dCwgX3RoaXMpLCAwKSk7XG4gICAgICB9XG4gICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PSBLRVlfQ09ERVMuWCkge1xuICAgICAgICBjYWxsQ3V0QWN0aW9uKCk7XG4gICAgICB9XG4gICAgICBpZiAoZXZlbnQua2V5Q29kZSA9PSBLRVlfQ09ERVMuQykge1xuICAgICAgICBjYWxsQ29weUFjdGlvbigpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICB0aGlzLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5jb3B5UGFzdGVJbnN0YW5jZSkge1xuICAgICAgdGhpcy5jb3B5UGFzdGVJbnN0YW5jZS5yZW1vdmVDYWxsYmFjayhvbkN1dCk7XG4gICAgICB0aGlzLmNvcHlQYXN0ZUluc3RhbmNlLnJlbW92ZUNhbGxiYWNrKG9uUGFzdGUpO1xuICAgICAgdGhpcy5jb3B5UGFzdGVJbnN0YW5jZS5kZXN0cm95KCk7XG4gICAgICB0aGlzLmNvcHlQYXN0ZUluc3RhbmNlID0gbnVsbDtcbiAgICB9XG4gICAgaW5zdGFuY2UucmVtb3ZlSG9vaygnYmVmb3JlS2V5RG93bicsIG9uQmVmb3JlS2V5RG93bik7XG4gIH07XG4gIGluc3RhbmNlLmFkZEhvb2soJ2FmdGVyRGVzdHJveScsIHByb3h5KHRoaXMuZGVzdHJveSwgdGhpcykpO1xuICB0aGlzLnRyaWdnZXJQYXN0ZSA9IHByb3h5KHRoaXMuY29weVBhc3RlSW5zdGFuY2UudHJpZ2dlclBhc3RlLCB0aGlzLmNvcHlQYXN0ZUluc3RhbmNlKTtcbiAgdGhpcy50cmlnZ2VyQ3V0ID0gcHJveHkodGhpcy5jb3B5UGFzdGVJbnN0YW5jZS50cmlnZ2VyQ3V0LCB0aGlzLmNvcHlQYXN0ZUluc3RhbmNlKTtcbiAgdGhpcy5zZXRDb3B5YWJsZVRleHQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgc2V0dGluZ3MgPSBpbnN0YW5jZS5nZXRTZXR0aW5ncygpO1xuICAgIHZhciBjb3B5Um93c0xpbWl0ID0gc2V0dGluZ3MuY29weVJvd3NMaW1pdDtcbiAgICB2YXIgY29weUNvbHNMaW1pdCA9IHNldHRpbmdzLmNvcHlDb2xzTGltaXQ7XG4gICAgdmFyIHNlbFJhbmdlID0gaW5zdGFuY2UuZ2V0U2VsZWN0ZWRSYW5nZSgpO1xuICAgIHZhciB0b3BMZWZ0ID0gc2VsUmFuZ2UuZ2V0VG9wTGVmdENvcm5lcigpO1xuICAgIHZhciBib3R0b21SaWdodCA9IHNlbFJhbmdlLmdldEJvdHRvbVJpZ2h0Q29ybmVyKCk7XG4gICAgdmFyIHN0YXJ0Um93ID0gdG9wTGVmdC5yb3c7XG4gICAgdmFyIHN0YXJ0Q29sID0gdG9wTGVmdC5jb2w7XG4gICAgdmFyIGVuZFJvdyA9IGJvdHRvbVJpZ2h0LnJvdztcbiAgICB2YXIgZW5kQ29sID0gYm90dG9tUmlnaHQuY29sO1xuICAgIHZhciBmaW5hbEVuZFJvdyA9IE1hdGgubWluKGVuZFJvdywgc3RhcnRSb3cgKyBjb3B5Um93c0xpbWl0IC0gMSk7XG4gICAgdmFyIGZpbmFsRW5kQ29sID0gTWF0aC5taW4oZW5kQ29sLCBzdGFydENvbCArIGNvcHlDb2xzTGltaXQgLSAxKTtcbiAgICB0aGlzLmNvcHlhYmxlUmFuZ2VzLmxlbmd0aCA9IDA7XG4gICAgdGhpcy5jb3B5YWJsZVJhbmdlcy5wdXNoKHtcbiAgICAgIHN0YXJ0Um93OiBzdGFydFJvdyxcbiAgICAgIHN0YXJ0Q29sOiBzdGFydENvbCxcbiAgICAgIGVuZFJvdzogZmluYWxFbmRSb3csXG4gICAgICBlbmRDb2w6IGZpbmFsRW5kQ29sXG4gICAgfSk7XG4gICAgdGhpcy5jb3B5YWJsZVJhbmdlcyA9IGluc3RhbmNlLnJ1bkhvb2tzKCdtb2RpZnlDb3B5YWJsZVJhbmdlJywgdGhpcy5jb3B5YWJsZVJhbmdlcyk7XG4gICAgdmFyIGNvcHlhYmxlRGF0YSA9IHRoaXMuZ2V0UmFuZ2VkQ29weWFibGVEYXRhKHRoaXMuY29weWFibGVSYW5nZXMpO1xuICAgIGluc3RhbmNlLmNvcHlQYXN0ZS5jb3B5UGFzdGVJbnN0YW5jZS5jb3B5YWJsZShjb3B5YWJsZURhdGEpO1xuICAgIGlmIChlbmRSb3cgIT09IGZpbmFsRW5kUm93IHx8IGVuZENvbCAhPT0gZmluYWxFbmRDb2wpIHtcbiAgICAgIEhhbmRzb250YWJsZS5ob29rcy5ydW4oaW5zdGFuY2UsICdhZnRlckNvcHlMaW1pdCcsIGVuZFJvdyAtIHN0YXJ0Um93ICsgMSwgZW5kQ29sIC0gc3RhcnRDb2wgKyAxLCBjb3B5Um93c0xpbWl0LCBjb3B5Q29sc0xpbWl0KTtcbiAgICB9XG4gIH07XG4gIHRoaXMuZ2V0UmFuZ2VkQ29weWFibGVEYXRhID0gZnVuY3Rpb24ocmFuZ2VzKSB7XG4gICAgdmFyIGRhdGFTZXQgPSBbXTtcbiAgICB2YXIgY29weWFibGVSb3dzID0gW107XG4gICAgdmFyIGNvcHlhYmxlQ29sdW1ucyA9IFtdO1xuICAgIGFycmF5RWFjaChyYW5nZXMsIChmdW5jdGlvbihyYW5nZSkge1xuICAgICAgcmFuZ2VFYWNoKHJhbmdlLnN0YXJ0Um93LCByYW5nZS5lbmRSb3csIChmdW5jdGlvbihyb3cpIHtcbiAgICAgICAgaWYgKGNvcHlhYmxlUm93cy5pbmRleE9mKHJvdykgPT09IC0xKSB7XG4gICAgICAgICAgY29weWFibGVSb3dzLnB1c2gocm93KTtcbiAgICAgICAgfVxuICAgICAgfSkpO1xuICAgICAgcmFuZ2VFYWNoKHJhbmdlLnN0YXJ0Q29sLCByYW5nZS5lbmRDb2wsIChmdW5jdGlvbihjb2x1bW4pIHtcbiAgICAgICAgaWYgKGNvcHlhYmxlQ29sdW1ucy5pbmRleE9mKGNvbHVtbikgPT09IC0xKSB7XG4gICAgICAgICAgY29weWFibGVDb2x1bW5zLnB1c2goY29sdW1uKTtcbiAgICAgICAgfVxuICAgICAgfSkpO1xuICAgIH0pKTtcbiAgICBhcnJheUVhY2goY29weWFibGVSb3dzLCAoZnVuY3Rpb24ocm93KSB7XG4gICAgICB2YXIgcm93U2V0ID0gW107XG4gICAgICBhcnJheUVhY2goY29weWFibGVDb2x1bW5zLCAoZnVuY3Rpb24oY29sdW1uKSB7XG4gICAgICAgIHJvd1NldC5wdXNoKGluc3RhbmNlLmdldENvcHlhYmxlRGF0YShyb3csIGNvbHVtbikpO1xuICAgICAgfSkpO1xuICAgICAgZGF0YVNldC5wdXNoKHJvd1NldCk7XG4gICAgfSkpO1xuICAgIHJldHVybiBTaGVldENsaXAuc3RyaW5naWZ5KGRhdGFTZXQpO1xuICB9O1xuICB0aGlzLmdldFJhbmdlZERhdGEgPSBmdW5jdGlvbihyYW5nZXMpIHtcbiAgICB2YXIgZGF0YVNldCA9IFtdO1xuICAgIHZhciBjb3B5YWJsZVJvd3MgPSBbXTtcbiAgICB2YXIgY29weWFibGVDb2x1bW5zID0gW107XG4gICAgYXJyYXlFYWNoKHJhbmdlcywgKGZ1bmN0aW9uKHJhbmdlKSB7XG4gICAgICByYW5nZUVhY2gocmFuZ2Uuc3RhcnRSb3csIHJhbmdlLmVuZFJvdywgKGZ1bmN0aW9uKHJvdykge1xuICAgICAgICBpZiAoY29weWFibGVSb3dzLmluZGV4T2Yocm93KSA9PT0gLTEpIHtcbiAgICAgICAgICBjb3B5YWJsZVJvd3MucHVzaChyb3cpO1xuICAgICAgICB9XG4gICAgICB9KSk7XG4gICAgICByYW5nZUVhY2gocmFuZ2Uuc3RhcnRDb2wsIHJhbmdlLmVuZENvbCwgKGZ1bmN0aW9uKGNvbHVtbikge1xuICAgICAgICBpZiAoY29weWFibGVDb2x1bW5zLmluZGV4T2YoY29sdW1uKSA9PT0gLTEpIHtcbiAgICAgICAgICBjb3B5YWJsZUNvbHVtbnMucHVzaChjb2x1bW4pO1xuICAgICAgICB9XG4gICAgICB9KSk7XG4gICAgfSkpO1xuICAgIGFycmF5RWFjaChjb3B5YWJsZVJvd3MsIChmdW5jdGlvbihyb3cpIHtcbiAgICAgIHZhciByb3dTZXQgPSBbXTtcbiAgICAgIGFycmF5RWFjaChjb3B5YWJsZUNvbHVtbnMsIChmdW5jdGlvbihjb2x1bW4pIHtcbiAgICAgICAgcm93U2V0LnB1c2goaW5zdGFuY2UuZ2V0Q29weWFibGVEYXRhKHJvdywgY29sdW1uKSk7XG4gICAgICB9KSk7XG4gICAgICBkYXRhU2V0LnB1c2gocm93U2V0KTtcbiAgICB9KSk7XG4gICAgcmV0dXJuIGRhdGFTZXQ7XG4gIH07XG59XG5mdW5jdGlvbiBpbml0KCkge1xuICB2YXIgaW5zdGFuY2UgPSB0aGlzLFxuICAgICAgcGx1Z2luRW5hYmxlZCA9IGluc3RhbmNlLmdldFNldHRpbmdzKCkuY29weVBhc3RlICE9PSBmYWxzZTtcbiAgaWYgKHBsdWdpbkVuYWJsZWQgJiYgIWluc3RhbmNlLmNvcHlQYXN0ZSkge1xuICAgIGluc3RhbmNlLmNvcHlQYXN0ZSA9IG5ldyBDb3B5UGFzdGVQbHVnaW4oaW5zdGFuY2UpO1xuICB9IGVsc2UgaWYgKCFwbHVnaW5FbmFibGVkICYmIGluc3RhbmNlLmNvcHlQYXN0ZSkge1xuICAgIGluc3RhbmNlLmNvcHlQYXN0ZS5kZXN0cm95KCk7XG4gICAgaW5zdGFuY2UuY29weVBhc3RlID0gbnVsbDtcbiAgfVxufVxuSGFuZHNvbnRhYmxlLmhvb2tzLmFkZCgnYWZ0ZXJJbml0JywgaW5pdCk7XG5IYW5kc29udGFibGUuaG9va3MuYWRkKCdhZnRlclVwZGF0ZVNldHRpbmdzJywgaW5pdCk7XG5IYW5kc29udGFibGUuaG9va3MucmVnaXN0ZXIoJ2FmdGVyQ29weUxpbWl0Jyk7XG5IYW5kc29udGFibGUuaG9va3MucmVnaXN0ZXIoJ21vZGlmeUNvcHlhYmxlUmFuZ2UnKTtcbkhhbmRzb250YWJsZS5ob29rcy5yZWdpc3RlcignYmVmb3JlQ3V0Jyk7XG5IYW5kc29udGFibGUuaG9va3MucmVnaXN0ZXIoJ2FmdGVyQ3V0Jyk7XG5IYW5kc29udGFibGUuaG9va3MucmVnaXN0ZXIoJ2JlZm9yZVBhc3RlJyk7XG5IYW5kc29udGFibGUuaG9va3MucmVnaXN0ZXIoJ2FmdGVyUGFzdGUnKTtcbkhhbmRzb250YWJsZS5ob29rcy5yZWdpc3RlcignYmVmb3JlQ29weScpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLnJlZ2lzdGVyKCdhZnRlckNvcHknKTtcbjtcblxuLy8jIFxufSx7XCIzcmRwYXJ0eS93YWxrb250YWJsZS9zcmMvY2VsbC9jb29yZHNcIjo2LFwiM3JkcGFydHkvd2Fsa29udGFibGUvc3JjL2NlbGwvcmFuZ2VcIjo3LFwiU2hlZXRDbGlwXCI6XCJTaGVldENsaXBcIixcImJyb3dzZXJcIjoyNCxcImNvcHlQYXN0ZVwiOlwiY29weVBhc3RlXCIsXCJoZWxwZXJzL2FycmF5XCI6NDMsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJoZWxwZXJzL2RvbS9ldmVudFwiOjQ4LFwiaGVscGVycy9mdW5jdGlvblwiOjUwLFwiaGVscGVycy9udW1iZXJcIjo1MixcImhlbHBlcnMvdW5pY29kZVwiOjU2fV0sOTE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2VsbF80N19yYW5nZV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19zZWxlY3Rpb25fXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgcmVnaXN0ZXJQbHVnaW4gPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fID0gX2RlcmVxXyhcInBsdWdpbnNcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfX30pLnJlZ2lzdGVyUGx1Z2luO1xudmFyIFdhbGtvbnRhYmxlQ2VsbFJhbmdlID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X3JhbmdlX18gPSBfZGVyZXFfKFwiM3JkcGFydHkvd2Fsa29udGFibGUvc3JjL2NlbGwvcmFuZ2VcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X3JhbmdlX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfcmFuZ2VfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X3JhbmdlX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X3JhbmdlX199KS5XYWxrb250YWJsZUNlbGxSYW5nZTtcbnZhciBXYWxrb250YWJsZVNlbGVjdGlvbiA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfc2VsZWN0aW9uX18gPSBfZGVyZXFfKFwiM3JkcGFydHkvd2Fsa29udGFibGUvc3JjL3NlbGVjdGlvblwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X3NlbGVjdGlvbl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19zZWxlY3Rpb25fXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19zZWxlY3Rpb25fXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X3NlbGVjdGlvbl9ffSkuV2Fsa29udGFibGVTZWxlY3Rpb247XG5mdW5jdGlvbiBDdXN0b21Cb3JkZXJzKCkge31cbnZhciBpbnN0YW5jZTtcbnZhciBjaGVja0VuYWJsZSA9IGZ1bmN0aW9uKGN1c3RvbUJvcmRlcnMpIHtcbiAgaWYgKHR5cGVvZiBjdXN0b21Cb3JkZXJzID09PSAnYm9vbGVhbicpIHtcbiAgICBpZiAoY3VzdG9tQm9yZGVycyA9PT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIGlmICh0eXBlb2YgY3VzdG9tQm9yZGVycyA9PT0gJ29iamVjdCcpIHtcbiAgICBpZiAoY3VzdG9tQm9yZGVycy5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufTtcbnZhciBpbml0ID0gZnVuY3Rpb24oKSB7XG4gIGlmIChjaGVja0VuYWJsZSh0aGlzLmdldFNldHRpbmdzKCkuY3VzdG9tQm9yZGVycykpIHtcbiAgICBpZiAoIXRoaXMuY3VzdG9tQm9yZGVycykge1xuICAgICAgaW5zdGFuY2UgPSB0aGlzO1xuICAgICAgdGhpcy5jdXN0b21Cb3JkZXJzID0gbmV3IEN1c3RvbUJvcmRlcnMoKTtcbiAgICB9XG4gIH1cbn07XG52YXIgZ2V0U2V0dGluZ0luZGV4ID0gZnVuY3Rpb24oY2xhc3NOYW1lKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgaW5zdGFuY2Uudmlldy53dC5zZWxlY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKGluc3RhbmNlLnZpZXcud3Quc2VsZWN0aW9uc1tpXS5zZXR0aW5ncy5jbGFzc05hbWUgPT0gY2xhc3NOYW1lKSB7XG4gICAgICByZXR1cm4gaTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIC0xO1xufTtcbnZhciBpbnNlcnRCb3JkZXJJbnRvU2V0dGluZ3MgPSBmdW5jdGlvbihib3JkZXIpIHtcbiAgdmFyIGNvb3JkaW5hdGVzID0ge1xuICAgIHJvdzogYm9yZGVyLnJvdyxcbiAgICBjb2w6IGJvcmRlci5jb2xcbiAgfTtcbiAgdmFyIHNlbGVjdGlvbiA9IG5ldyBXYWxrb250YWJsZVNlbGVjdGlvbihib3JkZXIsIG5ldyBXYWxrb250YWJsZUNlbGxSYW5nZShjb29yZGluYXRlcywgY29vcmRpbmF0ZXMsIGNvb3JkaW5hdGVzKSk7XG4gIHZhciBpbmRleCA9IGdldFNldHRpbmdJbmRleChib3JkZXIuY2xhc3NOYW1lKTtcbiAgaWYgKGluZGV4ID49IDApIHtcbiAgICBpbnN0YW5jZS52aWV3Lnd0LnNlbGVjdGlvbnNbaW5kZXhdID0gc2VsZWN0aW9uO1xuICB9IGVsc2Uge1xuICAgIGluc3RhbmNlLnZpZXcud3Quc2VsZWN0aW9ucy5wdXNoKHNlbGVjdGlvbik7XG4gIH1cbn07XG52YXIgcHJlcGFyZUJvcmRlckZyb21DdXN0b21BZGRlZCA9IGZ1bmN0aW9uKHJvdywgY29sLCBib3JkZXJPYmopIHtcbiAgdmFyIGJvcmRlciA9IGNyZWF0ZUVtcHR5Qm9yZGVycyhyb3csIGNvbCk7XG4gIGJvcmRlciA9IGV4dGVuZERlZmF1bHRCb3JkZXIoYm9yZGVyLCBib3JkZXJPYmopO1xuICB0aGlzLnNldENlbGxNZXRhKHJvdywgY29sLCAnYm9yZGVycycsIGJvcmRlcik7XG4gIGluc2VydEJvcmRlckludG9TZXR0aW5ncyhib3JkZXIpO1xufTtcbnZhciBwcmVwYXJlQm9yZGVyRnJvbUN1c3RvbUFkZGVkUmFuZ2UgPSBmdW5jdGlvbihyb3dPYmopIHtcbiAgdmFyIHJhbmdlID0gcm93T2JqLnJhbmdlO1xuICBmb3IgKHZhciByb3cgPSByYW5nZS5mcm9tLnJvdzsgcm93IDw9IHJhbmdlLnRvLnJvdzsgcm93KyspIHtcbiAgICBmb3IgKHZhciBjb2wgPSByYW5nZS5mcm9tLmNvbDsgY29sIDw9IHJhbmdlLnRvLmNvbDsgY29sKyspIHtcbiAgICAgIHZhciBib3JkZXIgPSBjcmVhdGVFbXB0eUJvcmRlcnMocm93LCBjb2wpO1xuICAgICAgdmFyIGFkZCA9IDA7XG4gICAgICBpZiAocm93ID09IHJhbmdlLmZyb20ucm93KSB7XG4gICAgICAgIGFkZCsrO1xuICAgICAgICBpZiAocm93T2JqLmhhc093blByb3BlcnR5KCd0b3AnKSkge1xuICAgICAgICAgIGJvcmRlci50b3AgPSByb3dPYmoudG9wO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAocm93ID09IHJhbmdlLnRvLnJvdykge1xuICAgICAgICBhZGQrKztcbiAgICAgICAgaWYgKHJvd09iai5oYXNPd25Qcm9wZXJ0eSgnYm90dG9tJykpIHtcbiAgICAgICAgICBib3JkZXIuYm90dG9tID0gcm93T2JqLmJvdHRvbTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGNvbCA9PSByYW5nZS5mcm9tLmNvbCkge1xuICAgICAgICBhZGQrKztcbiAgICAgICAgaWYgKHJvd09iai5oYXNPd25Qcm9wZXJ0eSgnbGVmdCcpKSB7XG4gICAgICAgICAgYm9yZGVyLmxlZnQgPSByb3dPYmoubGVmdDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGNvbCA9PSByYW5nZS50by5jb2wpIHtcbiAgICAgICAgYWRkKys7XG4gICAgICAgIGlmIChyb3dPYmouaGFzT3duUHJvcGVydHkoJ3JpZ2h0JykpIHtcbiAgICAgICAgICBib3JkZXIucmlnaHQgPSByb3dPYmoucmlnaHQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChhZGQgPiAwKSB7XG4gICAgICAgIHRoaXMuc2V0Q2VsbE1ldGEocm93LCBjb2wsICdib3JkZXJzJywgYm9yZGVyKTtcbiAgICAgICAgaW5zZXJ0Qm9yZGVySW50b1NldHRpbmdzKGJvcmRlcik7XG4gICAgICB9XG4gICAgfVxuICB9XG59O1xudmFyIGNyZWF0ZUNsYXNzTmFtZSA9IGZ1bmN0aW9uKHJvdywgY29sKSB7XG4gIHJldHVybiAnYm9yZGVyX3JvdycgKyByb3cgKyAnY29sJyArIGNvbDtcbn07XG52YXIgY3JlYXRlRGVmYXVsdEN1c3RvbUJvcmRlciA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4ge1xuICAgIHdpZHRoOiAxLFxuICAgIGNvbG9yOiAnIzAwMCdcbiAgfTtcbn07XG52YXIgY3JlYXRlU2luZ2xlRW1wdHlCb3JkZXIgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHtoaWRlOiB0cnVlfTtcbn07XG52YXIgY3JlYXRlRGVmYXVsdEh0Qm9yZGVyID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB7XG4gICAgd2lkdGg6IDEsXG4gICAgY29sb3I6ICcjMDAwJyxcbiAgICBjb3JuZXJWaXNpYmxlOiBmYWxzZVxuICB9O1xufTtcbnZhciBjcmVhdGVFbXB0eUJvcmRlcnMgPSBmdW5jdGlvbihyb3csIGNvbCkge1xuICByZXR1cm4ge1xuICAgIGNsYXNzTmFtZTogY3JlYXRlQ2xhc3NOYW1lKHJvdywgY29sKSxcbiAgICBib3JkZXI6IGNyZWF0ZURlZmF1bHRIdEJvcmRlcigpLFxuICAgIHJvdzogcm93LFxuICAgIGNvbDogY29sLFxuICAgIHRvcDogY3JlYXRlU2luZ2xlRW1wdHlCb3JkZXIoKSxcbiAgICByaWdodDogY3JlYXRlU2luZ2xlRW1wdHlCb3JkZXIoKSxcbiAgICBib3R0b206IGNyZWF0ZVNpbmdsZUVtcHR5Qm9yZGVyKCksXG4gICAgbGVmdDogY3JlYXRlU2luZ2xlRW1wdHlCb3JkZXIoKVxuICB9O1xufTtcbnZhciBleHRlbmREZWZhdWx0Qm9yZGVyID0gZnVuY3Rpb24oZGVmYXVsdEJvcmRlciwgY3VzdG9tQm9yZGVyKSB7XG4gIGlmIChjdXN0b21Cb3JkZXIuaGFzT3duUHJvcGVydHkoJ2JvcmRlcicpKSB7XG4gICAgZGVmYXVsdEJvcmRlci5ib3JkZXIgPSBjdXN0b21Cb3JkZXIuYm9yZGVyO1xuICB9XG4gIGlmIChjdXN0b21Cb3JkZXIuaGFzT3duUHJvcGVydHkoJ3RvcCcpKSB7XG4gICAgZGVmYXVsdEJvcmRlci50b3AgPSBjdXN0b21Cb3JkZXIudG9wO1xuICB9XG4gIGlmIChjdXN0b21Cb3JkZXIuaGFzT3duUHJvcGVydHkoJ3JpZ2h0JykpIHtcbiAgICBkZWZhdWx0Qm9yZGVyLnJpZ2h0ID0gY3VzdG9tQm9yZGVyLnJpZ2h0O1xuICB9XG4gIGlmIChjdXN0b21Cb3JkZXIuaGFzT3duUHJvcGVydHkoJ2JvdHRvbScpKSB7XG4gICAgZGVmYXVsdEJvcmRlci5ib3R0b20gPSBjdXN0b21Cb3JkZXIuYm90dG9tO1xuICB9XG4gIGlmIChjdXN0b21Cb3JkZXIuaGFzT3duUHJvcGVydHkoJ2xlZnQnKSkge1xuICAgIGRlZmF1bHRCb3JkZXIubGVmdCA9IGN1c3RvbUJvcmRlci5sZWZ0O1xuICB9XG4gIHJldHVybiBkZWZhdWx0Qm9yZGVyO1xufTtcbnZhciByZW1vdmVCb3JkZXJzRnJvbURvbSA9IGZ1bmN0aW9uKGJvcmRlckNsYXNzTmFtZSkge1xuICB2YXIgYm9yZGVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy4nICsgYm9yZGVyQ2xhc3NOYW1lKTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBib3JkZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKGJvcmRlcnNbaV0pIHtcbiAgICAgIGlmIChib3JkZXJzW2ldLm5vZGVOYW1lICE9ICdURCcpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IGJvcmRlcnNbaV0ucGFyZW50Tm9kZTtcbiAgICAgICAgaWYgKHBhcmVudC5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgcGFyZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQocGFyZW50KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufTtcbnZhciByZW1vdmVBbGxCb3JkZXJzID0gZnVuY3Rpb24ocm93LCBjb2wpIHtcbiAgdmFyIGJvcmRlckNsYXNzTmFtZSA9IGNyZWF0ZUNsYXNzTmFtZShyb3csIGNvbCk7XG4gIHJlbW92ZUJvcmRlcnNGcm9tRG9tKGJvcmRlckNsYXNzTmFtZSk7XG4gIHRoaXMucmVtb3ZlQ2VsbE1ldGEocm93LCBjb2wsICdib3JkZXJzJyk7XG59O1xudmFyIHNldEJvcmRlciA9IGZ1bmN0aW9uKHJvdywgY29sLCBwbGFjZSwgcmVtb3ZlKSB7XG4gIHZhciBib3JkZXJzTWV0YSA9IHRoaXMuZ2V0Q2VsbE1ldGEocm93LCBjb2wpLmJvcmRlcnM7XG4gIGlmICghYm9yZGVyc01ldGEgfHwgYm9yZGVyc01ldGEuYm9yZGVyID09IHVuZGVmaW5lZCkge1xuICAgIGJvcmRlcnNNZXRhID0gY3JlYXRlRW1wdHlCb3JkZXJzKHJvdywgY29sKTtcbiAgfVxuICBpZiAocmVtb3ZlKSB7XG4gICAgYm9yZGVyc01ldGFbcGxhY2VdID0gY3JlYXRlU2luZ2xlRW1wdHlCb3JkZXIoKTtcbiAgfSBlbHNlIHtcbiAgICBib3JkZXJzTWV0YVtwbGFjZV0gPSBjcmVhdGVEZWZhdWx0Q3VzdG9tQm9yZGVyKCk7XG4gIH1cbiAgdGhpcy5zZXRDZWxsTWV0YShyb3csIGNvbCwgJ2JvcmRlcnMnLCBib3JkZXJzTWV0YSk7XG4gIHZhciBib3JkZXJDbGFzc05hbWUgPSBjcmVhdGVDbGFzc05hbWUocm93LCBjb2wpO1xuICByZW1vdmVCb3JkZXJzRnJvbURvbShib3JkZXJDbGFzc05hbWUpO1xuICBpbnNlcnRCb3JkZXJJbnRvU2V0dGluZ3MoYm9yZGVyc01ldGEpO1xuICB0aGlzLnJlbmRlcigpO1xufTtcbnZhciBwcmVwYXJlQm9yZGVyID0gZnVuY3Rpb24ocmFuZ2UsIHBsYWNlLCByZW1vdmUpIHtcbiAgaWYgKHJhbmdlLmZyb20ucm93ID09IHJhbmdlLnRvLnJvdyAmJiByYW5nZS5mcm9tLmNvbCA9PSByYW5nZS50by5jb2wpIHtcbiAgICBpZiAocGxhY2UgPT0gJ25vQm9yZGVycycpIHtcbiAgICAgIHJlbW92ZUFsbEJvcmRlcnMuY2FsbCh0aGlzLCByYW5nZS5mcm9tLnJvdywgcmFuZ2UuZnJvbS5jb2wpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZXRCb3JkZXIuY2FsbCh0aGlzLCByYW5nZS5mcm9tLnJvdywgcmFuZ2UuZnJvbS5jb2wsIHBsYWNlLCByZW1vdmUpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBzd2l0Y2ggKHBsYWNlKSB7XG4gICAgICBjYXNlICdub0JvcmRlcnMnOlxuICAgICAgICBmb3IgKHZhciBjb2x1bW4gPSByYW5nZS5mcm9tLmNvbDsgY29sdW1uIDw9IHJhbmdlLnRvLmNvbDsgY29sdW1uKyspIHtcbiAgICAgICAgICBmb3IgKHZhciByb3cgPSByYW5nZS5mcm9tLnJvdzsgcm93IDw9IHJhbmdlLnRvLnJvdzsgcm93KyspIHtcbiAgICAgICAgICAgIHJlbW92ZUFsbEJvcmRlcnMuY2FsbCh0aGlzLCByb3csIGNvbHVtbik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAndG9wJzpcbiAgICAgICAgZm9yICh2YXIgdG9wQ29sID0gcmFuZ2UuZnJvbS5jb2w7IHRvcENvbCA8PSByYW5nZS50by5jb2w7IHRvcENvbCsrKSB7XG4gICAgICAgICAgc2V0Qm9yZGVyLmNhbGwodGhpcywgcmFuZ2UuZnJvbS5yb3csIHRvcENvbCwgcGxhY2UsIHJlbW92ZSk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdyaWdodCc6XG4gICAgICAgIGZvciAodmFyIHJvd1JpZ2h0ID0gcmFuZ2UuZnJvbS5yb3c7IHJvd1JpZ2h0IDw9IHJhbmdlLnRvLnJvdzsgcm93UmlnaHQrKykge1xuICAgICAgICAgIHNldEJvcmRlci5jYWxsKHRoaXMsIHJvd1JpZ2h0LCByYW5nZS50by5jb2wsIHBsYWNlKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2JvdHRvbSc6XG4gICAgICAgIGZvciAodmFyIGJvdHRvbUNvbCA9IHJhbmdlLmZyb20uY29sOyBib3R0b21Db2wgPD0gcmFuZ2UudG8uY29sOyBib3R0b21Db2wrKykge1xuICAgICAgICAgIHNldEJvcmRlci5jYWxsKHRoaXMsIHJhbmdlLnRvLnJvdywgYm90dG9tQ29sLCBwbGFjZSk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdsZWZ0JzpcbiAgICAgICAgZm9yICh2YXIgcm93TGVmdCA9IHJhbmdlLmZyb20ucm93OyByb3dMZWZ0IDw9IHJhbmdlLnRvLnJvdzsgcm93TGVmdCsrKSB7XG4gICAgICAgICAgc2V0Qm9yZGVyLmNhbGwodGhpcywgcm93TGVmdCwgcmFuZ2UuZnJvbS5jb2wsIHBsYWNlKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cbn07XG52YXIgY2hlY2tTZWxlY3Rpb25Cb3JkZXJzID0gZnVuY3Rpb24oaG90LCBkaXJlY3Rpb24pIHtcbiAgdmFyIGF0TGVhc3RPbmVIYXNCb3JkZXIgPSBmYWxzZTtcbiAgaG90LmdldFNlbGVjdGVkUmFuZ2UoKS5mb3JBbGwoZnVuY3Rpb24ociwgYykge1xuICAgIHZhciBtZXRhQm9yZGVycyA9IGhvdC5nZXRDZWxsTWV0YShyLCBjKS5ib3JkZXJzO1xuICAgIGlmIChtZXRhQm9yZGVycykge1xuICAgICAgaWYgKGRpcmVjdGlvbikge1xuICAgICAgICBpZiAoIW1ldGFCb3JkZXJzW2RpcmVjdGlvbl0uaGFzT3duUHJvcGVydHkoJ2hpZGUnKSkge1xuICAgICAgICAgIGF0TGVhc3RPbmVIYXNCb3JkZXIgPSB0cnVlO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXRMZWFzdE9uZUhhc0JvcmRlciA9IHRydWU7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICByZXR1cm4gYXRMZWFzdE9uZUhhc0JvcmRlcjtcbn07XG52YXIgbWFya1NlbGVjdGVkID0gZnVuY3Rpb24obGFiZWwpIHtcbiAgcmV0dXJuICc8c3BhbiBjbGFzcz1cInNlbGVjdGVkXCI+JyArIFN0cmluZy5mcm9tQ2hhckNvZGUoMTAwMDMpICsgJzwvc3Bhbj4nICsgbGFiZWw7XG59O1xudmFyIGFkZEJvcmRlcnNPcHRpb25zVG9Db250ZXh0TWVudSA9IGZ1bmN0aW9uKGRlZmF1bHRPcHRpb25zKSB7XG4gIGlmICghdGhpcy5nZXRTZXR0aW5ncygpLmN1c3RvbUJvcmRlcnMpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgZGVmYXVsdE9wdGlvbnMuaXRlbXMucHVzaChIYW5kc29udGFibGUucGx1Z2lucy5Db250ZXh0TWVudS5TRVBBUkFUT1IpO1xuICBkZWZhdWx0T3B0aW9ucy5pdGVtcy5wdXNoKHtcbiAgICBrZXk6ICdib3JkZXJzJyxcbiAgICBuYW1lOiAnQm9yZGVycycsXG4gICAgZGlzYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0aW9uLnNlbGVjdGVkSGVhZGVyLmNvcm5lcjtcbiAgICB9LFxuICAgIHN1Ym1lbnU6IHtpdGVtczogW3tcbiAgICAgICAga2V5OiAnYm9yZGVyczp0b3AnLFxuICAgICAgICBuYW1lOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgbGFiZWwgPSAnVG9wJztcbiAgICAgICAgICB2YXIgaGFzQm9yZGVyID0gY2hlY2tTZWxlY3Rpb25Cb3JkZXJzKHRoaXMsICd0b3AnKTtcbiAgICAgICAgICBpZiAoaGFzQm9yZGVyKSB7XG4gICAgICAgICAgICBsYWJlbCA9IG1hcmtTZWxlY3RlZChsYWJlbCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBsYWJlbDtcbiAgICAgICAgfSxcbiAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBoYXNCb3JkZXIgPSBjaGVja1NlbGVjdGlvbkJvcmRlcnModGhpcywgJ3RvcCcpO1xuICAgICAgICAgIHByZXBhcmVCb3JkZXIuY2FsbCh0aGlzLCB0aGlzLmdldFNlbGVjdGVkUmFuZ2UoKSwgJ3RvcCcsIGhhc0JvcmRlcik7XG4gICAgICAgIH1cbiAgICAgIH0sIHtcbiAgICAgICAga2V5OiAnYm9yZGVyczpyaWdodCcsXG4gICAgICAgIG5hbWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBsYWJlbCA9ICdSaWdodCc7XG4gICAgICAgICAgdmFyIGhhc0JvcmRlciA9IGNoZWNrU2VsZWN0aW9uQm9yZGVycyh0aGlzLCAncmlnaHQnKTtcbiAgICAgICAgICBpZiAoaGFzQm9yZGVyKSB7XG4gICAgICAgICAgICBsYWJlbCA9IG1hcmtTZWxlY3RlZChsYWJlbCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBsYWJlbDtcbiAgICAgICAgfSxcbiAgICAgICAgY2FsbGJhY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBoYXNCb3JkZXIgPSBjaGVja1NlbGVjdGlvbkJvcmRlcnModGhpcywgJ3JpZ2h0Jyk7XG4gICAgICAgICAgcHJlcGFyZUJvcmRlci5jYWxsKHRoaXMsIHRoaXMuZ2V0U2VsZWN0ZWRSYW5nZSgpLCAncmlnaHQnLCBoYXNCb3JkZXIpO1xuICAgICAgICB9XG4gICAgICB9LCB7XG4gICAgICAgIGtleTogJ2JvcmRlcnM6Ym90dG9tJyxcbiAgICAgICAgbmFtZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdmFyIGxhYmVsID0gJ0JvdHRvbSc7XG4gICAgICAgICAgdmFyIGhhc0JvcmRlciA9IGNoZWNrU2VsZWN0aW9uQm9yZGVycyh0aGlzLCAnYm90dG9tJyk7XG4gICAgICAgICAgaWYgKGhhc0JvcmRlcikge1xuICAgICAgICAgICAgbGFiZWwgPSBtYXJrU2VsZWN0ZWQobGFiZWwpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgICAgIH0sXG4gICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgaGFzQm9yZGVyID0gY2hlY2tTZWxlY3Rpb25Cb3JkZXJzKHRoaXMsICdib3R0b20nKTtcbiAgICAgICAgICBwcmVwYXJlQm9yZGVyLmNhbGwodGhpcywgdGhpcy5nZXRTZWxlY3RlZFJhbmdlKCksICdib3R0b20nLCBoYXNCb3JkZXIpO1xuICAgICAgICB9XG4gICAgICB9LCB7XG4gICAgICAgIGtleTogJ2JvcmRlcnM6bGVmdCcsXG4gICAgICAgIG5hbWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBsYWJlbCA9ICdMZWZ0JztcbiAgICAgICAgICB2YXIgaGFzQm9yZGVyID0gY2hlY2tTZWxlY3Rpb25Cb3JkZXJzKHRoaXMsICdsZWZ0Jyk7XG4gICAgICAgICAgaWYgKGhhc0JvcmRlcikge1xuICAgICAgICAgICAgbGFiZWwgPSBtYXJrU2VsZWN0ZWQobGFiZWwpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgICAgIH0sXG4gICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgaGFzQm9yZGVyID0gY2hlY2tTZWxlY3Rpb25Cb3JkZXJzKHRoaXMsICdsZWZ0Jyk7XG4gICAgICAgICAgcHJlcGFyZUJvcmRlci5jYWxsKHRoaXMsIHRoaXMuZ2V0U2VsZWN0ZWRSYW5nZSgpLCAnbGVmdCcsIGhhc0JvcmRlcik7XG4gICAgICAgIH1cbiAgICAgIH0sIHtcbiAgICAgICAga2V5OiAnYm9yZGVyczpub19ib3JkZXJzJyxcbiAgICAgICAgbmFtZTogJ1JlbW92ZSBib3JkZXIocyknLFxuICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcHJlcGFyZUJvcmRlci5jYWxsKHRoaXMsIHRoaXMuZ2V0U2VsZWN0ZWRSYW5nZSgpLCAnbm9Cb3JkZXJzJyk7XG4gICAgICAgIH0sXG4gICAgICAgIGRpc2FibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gIWNoZWNrU2VsZWN0aW9uQm9yZGVycyh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgfV19XG4gIH0pO1xufTtcbkhhbmRzb250YWJsZS5ob29rcy5hZGQoJ2JlZm9yZUluaXQnLCBpbml0KTtcbkhhbmRzb250YWJsZS5ob29rcy5hZGQoJ2FmdGVyQ29udGV4dE1lbnVEZWZhdWx0T3B0aW9ucycsIGFkZEJvcmRlcnNPcHRpb25zVG9Db250ZXh0TWVudSk7XG5IYW5kc29udGFibGUuaG9va3MuYWRkKCdhZnRlckluaXQnLCBmdW5jdGlvbigpIHtcbiAgdmFyIGN1c3RvbUJvcmRlcnMgPSB0aGlzLmdldFNldHRpbmdzKCkuY3VzdG9tQm9yZGVycztcbiAgaWYgKGN1c3RvbUJvcmRlcnMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGN1c3RvbUJvcmRlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChjdXN0b21Cb3JkZXJzW2ldLnJhbmdlKSB7XG4gICAgICAgIHByZXBhcmVCb3JkZXJGcm9tQ3VzdG9tQWRkZWRSYW5nZS5jYWxsKHRoaXMsIGN1c3RvbUJvcmRlcnNbaV0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcHJlcGFyZUJvcmRlckZyb21DdXN0b21BZGRlZC5jYWxsKHRoaXMsIGN1c3RvbUJvcmRlcnNbaV0ucm93LCBjdXN0b21Cb3JkZXJzW2ldLmNvbCwgY3VzdG9tQm9yZGVyc1tpXSk7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMucmVuZGVyKCk7XG4gICAgdGhpcy52aWV3Lnd0LmRyYXcodHJ1ZSk7XG4gIH1cbn0pO1xuSGFuZHNvbnRhYmxlLkN1c3RvbUJvcmRlcnMgPSBDdXN0b21Cb3JkZXJzO1xuXG4vLyMgXG59LHtcIjNyZHBhcnR5L3dhbGtvbnRhYmxlL3NyYy9jZWxsL3JhbmdlXCI6NyxcIjNyZHBhcnR5L3dhbGtvbnRhYmxlL3NyYy9zZWxlY3Rpb25cIjoxOSxcImJyb3dzZXJcIjoyNCxcInBsdWdpbnNcIjo2MX1dLDkyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBEcmFnVG9TY3JvbGw6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIERyYWdUb1Njcm9sbDtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgZXZlbnRNYW5hZ2VyT2JqZWN0ID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fID0gX2RlcmVxXyhcImV2ZW50TWFuYWdlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX199KS5ldmVudE1hbmFnZXI7XG52YXIgcmVnaXN0ZXJQbHVnaW4gPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fID0gX2RlcmVxXyhcInBsdWdpbnNcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfX30pLnJlZ2lzdGVyUGx1Z2luO1xuO1xuSGFuZHNvbnRhYmxlLnBsdWdpbnMuRHJhZ1RvU2Nyb2xsID0gRHJhZ1RvU2Nyb2xsO1xuZnVuY3Rpb24gRHJhZ1RvU2Nyb2xsKCkge1xuICB0aGlzLmJvdW5kYXJpZXMgPSBudWxsO1xuICB0aGlzLmNhbGxiYWNrID0gbnVsbDtcbn1cbkRyYWdUb1Njcm9sbC5wcm90b3R5cGUuc2V0Qm91bmRhcmllcyA9IGZ1bmN0aW9uKGJvdW5kYXJpZXMpIHtcbiAgdGhpcy5ib3VuZGFyaWVzID0gYm91bmRhcmllcztcbn07XG5EcmFnVG9TY3JvbGwucHJvdG90eXBlLnNldENhbGxiYWNrID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgdGhpcy5jYWxsYmFjayA9IGNhbGxiYWNrO1xufTtcbkRyYWdUb1Njcm9sbC5wcm90b3R5cGUuY2hlY2sgPSBmdW5jdGlvbih4LCB5KSB7XG4gIHZhciBkaWZmWCA9IDA7XG4gIHZhciBkaWZmWSA9IDA7XG4gIGlmICh5IDwgdGhpcy5ib3VuZGFyaWVzLnRvcCkge1xuICAgIGRpZmZZID0geSAtIHRoaXMuYm91bmRhcmllcy50b3A7XG4gIH0gZWxzZSBpZiAoeSA+IHRoaXMuYm91bmRhcmllcy5ib3R0b20pIHtcbiAgICBkaWZmWSA9IHkgLSB0aGlzLmJvdW5kYXJpZXMuYm90dG9tO1xuICB9XG4gIGlmICh4IDwgdGhpcy5ib3VuZGFyaWVzLmxlZnQpIHtcbiAgICBkaWZmWCA9IHggLSB0aGlzLmJvdW5kYXJpZXMubGVmdDtcbiAgfSBlbHNlIGlmICh4ID4gdGhpcy5ib3VuZGFyaWVzLnJpZ2h0KSB7XG4gICAgZGlmZlggPSB4IC0gdGhpcy5ib3VuZGFyaWVzLnJpZ2h0O1xuICB9XG4gIHRoaXMuY2FsbGJhY2soZGlmZlgsIGRpZmZZKTtcbn07XG52YXIgZHJhZ1RvU2Nyb2xsO1xudmFyIGluc3RhbmNlO1xudmFyIHNldHVwTGlzdGVuaW5nID0gZnVuY3Rpb24oaW5zdGFuY2UpIHtcbiAgaW5zdGFuY2UuZHJhZ1RvU2Nyb2xsTGlzdGVuaW5nID0gZmFsc2U7XG4gIHZhciBzY3JvbGxIYW5kbGVyID0gaW5zdGFuY2Uudmlldy53dC53dFRhYmxlLmhvbGRlcjtcbiAgZHJhZ1RvU2Nyb2xsID0gbmV3IERyYWdUb1Njcm9sbCgpO1xuICBpZiAoc2Nyb2xsSGFuZGxlciA9PT0gd2luZG93KSB7XG4gICAgcmV0dXJuO1xuICB9IGVsc2Uge1xuICAgIGRyYWdUb1Njcm9sbC5zZXRCb3VuZGFyaWVzKHNjcm9sbEhhbmRsZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkpO1xuICB9XG4gIGRyYWdUb1Njcm9sbC5zZXRDYWxsYmFjayhmdW5jdGlvbihzY3JvbGxYLCBzY3JvbGxZKSB7XG4gICAgaWYgKHNjcm9sbFggPCAwKSB7XG4gICAgICBzY3JvbGxIYW5kbGVyLnNjcm9sbExlZnQgLT0gNTA7XG4gICAgfSBlbHNlIGlmIChzY3JvbGxYID4gMCkge1xuICAgICAgc2Nyb2xsSGFuZGxlci5zY3JvbGxMZWZ0ICs9IDUwO1xuICAgIH1cbiAgICBpZiAoc2Nyb2xsWSA8IDApIHtcbiAgICAgIHNjcm9sbEhhbmRsZXIuc2Nyb2xsVG9wIC09IDIwO1xuICAgIH0gZWxzZSBpZiAoc2Nyb2xsWSA+IDApIHtcbiAgICAgIHNjcm9sbEhhbmRsZXIuc2Nyb2xsVG9wICs9IDIwO1xuICAgIH1cbiAgfSk7XG4gIGluc3RhbmNlLmRyYWdUb1Njcm9sbExpc3RlbmluZyA9IHRydWU7XG59O1xuSGFuZHNvbnRhYmxlLmhvb2tzLmFkZCgnYWZ0ZXJJbml0JywgZnVuY3Rpb24oKSB7XG4gIHZhciBpbnN0YW5jZSA9IHRoaXM7XG4gIHZhciBldmVudE1hbmFnZXIgPSBldmVudE1hbmFnZXJPYmplY3QodGhpcyk7XG4gIGV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKGRvY3VtZW50LCAnbW91c2V1cCcsIGZ1bmN0aW9uKCkge1xuICAgIGluc3RhbmNlLmRyYWdUb1Njcm9sbExpc3RlbmluZyA9IGZhbHNlO1xuICB9KTtcbiAgZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQsICdtb3VzZW1vdmUnLCBmdW5jdGlvbihldmVudCkge1xuICAgIGlmIChpbnN0YW5jZS5kcmFnVG9TY3JvbGxMaXN0ZW5pbmcpIHtcbiAgICAgIGRyYWdUb1Njcm9sbC5jaGVjayhldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZKTtcbiAgICB9XG4gIH0pO1xufSk7XG5IYW5kc29udGFibGUuaG9va3MuYWRkKCdhZnRlckRlc3Ryb3knLCBmdW5jdGlvbigpIHtcbiAgZXZlbnRNYW5hZ2VyT2JqZWN0KHRoaXMpLmNsZWFyKCk7XG59KTtcbkhhbmRzb250YWJsZS5ob29rcy5hZGQoJ2FmdGVyT25DZWxsTW91c2VEb3duJywgZnVuY3Rpb24oKSB7XG4gIHNldHVwTGlzdGVuaW5nKHRoaXMpO1xufSk7XG5IYW5kc29udGFibGUuaG9va3MuYWRkKCdhZnRlck9uQ2VsbENvcm5lck1vdXNlRG93bicsIGZ1bmN0aW9uKCkge1xuICBzZXR1cExpc3RlbmluZyh0aGlzKTtcbn0pO1xuSGFuZHNvbnRhYmxlLnBsdWdpbnMuRHJhZ1RvU2Nyb2xsID0gRHJhZ1RvU2Nyb2xsO1xuXG4vLyMgXG59LHtcImJyb3dzZXJcIjoyNCxcImV2ZW50TWFuYWdlclwiOjQyLFwicGx1Z2luc1wiOjYxfV0sOTM6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIGZyZWV6ZUNvbHVtbkl0ZW06IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGZyZWV6ZUNvbHVtbkl0ZW07XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xuZnVuY3Rpb24gZnJlZXplQ29sdW1uSXRlbShtYW51YWxDb2x1bW5GcmVlemVQbHVnaW4pIHtcbiAgcmV0dXJuIHtcbiAgICBrZXk6ICdmcmVlemVfY29sdW1uJyxcbiAgICBuYW1lOiAnRnJlZXplIHRoaXMgY29sdW1uJyxcbiAgICBjYWxsYmFjazogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc2VsZWN0ZWRDb2x1bW4gPSB0aGlzLmdldFNlbGVjdGVkUmFuZ2UoKS5mcm9tLmNvbDtcbiAgICAgIG1hbnVhbENvbHVtbkZyZWV6ZVBsdWdpbi5mcmVlemVDb2x1bW4oc2VsZWN0ZWRDb2x1bW4pO1xuICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgIHRoaXMudmlldy53dC53dE92ZXJsYXlzLmFkanVzdEVsZW1lbnRzU2l6ZSh0cnVlKTtcbiAgICB9LFxuICAgIGhpZGRlbjogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgc2VsZWN0aW9uID0gdGhpcy5nZXRTZWxlY3RlZFJhbmdlKCk7XG4gICAgICB2YXIgaGlkZSA9IGZhbHNlO1xuICAgICAgaWYgKHNlbGVjdGlvbiA9PT0gdm9pZCAwKSB7XG4gICAgICAgIGhpZGUgPSB0cnVlO1xuICAgICAgfSBlbHNlIGlmICgoc2VsZWN0aW9uLmZyb20uY29sICE9PSBzZWxlY3Rpb24udG8uY29sKSB8fCAoc2VsZWN0aW9uLmZyb20uY29sIDw9IHRoaXMuZ2V0U2V0dGluZ3MoKS5maXhlZENvbHVtbnNMZWZ0IC0gMSkpIHtcbiAgICAgICAgaGlkZSA9IHRydWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gaGlkZTtcbiAgICB9XG4gIH07XG59XG5cbi8vIyBcbn0se31dLDk0OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICB1bmZyZWV6ZUNvbHVtbkl0ZW06IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHVuZnJlZXplQ29sdW1uSXRlbTtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG5mdW5jdGlvbiB1bmZyZWV6ZUNvbHVtbkl0ZW0obWFudWFsQ29sdW1uRnJlZXplUGx1Z2luKSB7XG4gIHJldHVybiB7XG4gICAga2V5OiAndW5mcmVlemVfY29sdW1uJyxcbiAgICBuYW1lOiAnVW5mcmVlemUgdGhpcyBjb2x1bW4nLFxuICAgIGNhbGxiYWNrOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzZWxlY3RlZENvbHVtbiA9IHRoaXMuZ2V0U2VsZWN0ZWRSYW5nZSgpLmZyb20uY29sO1xuICAgICAgbWFudWFsQ29sdW1uRnJlZXplUGx1Z2luLnVuZnJlZXplQ29sdW1uKHNlbGVjdGVkQ29sdW1uKTtcbiAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICB0aGlzLnZpZXcud3Qud3RPdmVybGF5cy5hZGp1c3RFbGVtZW50c1NpemUodHJ1ZSk7XG4gICAgfSxcbiAgICBoaWRkZW46IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHNlbGVjdGlvbiA9IHRoaXMuZ2V0U2VsZWN0ZWRSYW5nZSgpO1xuICAgICAgdmFyIGhpZGUgPSBmYWxzZTtcbiAgICAgIGlmIChzZWxlY3Rpb24gPT09IHZvaWQgMCkge1xuICAgICAgICBoaWRlID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSBpZiAoKHNlbGVjdGlvbi5mcm9tLmNvbCAhPT0gc2VsZWN0aW9uLnRvLmNvbCkgfHwgc2VsZWN0aW9uLmZyb20uY29sID49IHRoaXMuZ2V0U2V0dGluZ3MoKS5maXhlZENvbHVtbnNMZWZ0KSB7XG4gICAgICAgIGhpZGUgPSB0cnVlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGhpZGU7XG4gICAgfVxuICB9O1xufVxuXG4vLyMgXG59LHt9XSw5NTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgTWFudWFsQ29sdW1uRnJlZXplOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBNYW51YWxDb2x1bW5GcmVlemU7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18sXG4gICAgJF9fY29udGV4dE1lbnVJdGVtXzQ3X2ZyZWV6ZUNvbHVtbl9fLFxuICAgICRfX2NvbnRleHRNZW51SXRlbV80N191bmZyZWV6ZUNvbHVtbl9fO1xudmFyIEhhbmRzb250YWJsZSA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gPSBfZGVyZXFfKFwiYnJvd3NlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9ffSkuZGVmYXVsdDtcbnZhciBCYXNlUGx1Z2luID0gKCRfX180Nl9fNDZfXzQ3X185NV9iYXNlX18gPSBfZGVyZXFfKFwiX2Jhc2VcIiksICRfX180Nl9fNDZfXzQ3X185NV9iYXNlX18gJiYgJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X185NV9iYXNlX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X185NV9iYXNlX199KS5kZWZhdWx0O1xudmFyIHJlZ2lzdGVyUGx1Z2luID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyA9IF9kZXJlcV8oXCJwbHVnaW5zXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX199KS5yZWdpc3RlclBsdWdpbjtcbnZhciBhcnJheUVhY2ggPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fID0gX2RlcmVxXyhcImhlbHBlcnMvYXJyYXlcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfX30pLmFycmF5RWFjaDtcbnZhciBmcmVlemVDb2x1bW5JdGVtID0gKCRfX2NvbnRleHRNZW51SXRlbV80N19mcmVlemVDb2x1bW5fXyA9IF9kZXJlcV8oXCJjb250ZXh0TWVudUl0ZW0vZnJlZXplQ29sdW1uXCIpLCAkX19jb250ZXh0TWVudUl0ZW1fNDdfZnJlZXplQ29sdW1uX18gJiYgJF9fY29udGV4dE1lbnVJdGVtXzQ3X2ZyZWV6ZUNvbHVtbl9fLl9fZXNNb2R1bGUgJiYgJF9fY29udGV4dE1lbnVJdGVtXzQ3X2ZyZWV6ZUNvbHVtbl9fIHx8IHtkZWZhdWx0OiAkX19jb250ZXh0TWVudUl0ZW1fNDdfZnJlZXplQ29sdW1uX199KS5mcmVlemVDb2x1bW5JdGVtO1xudmFyIHVuZnJlZXplQ29sdW1uSXRlbSA9ICgkX19jb250ZXh0TWVudUl0ZW1fNDdfdW5mcmVlemVDb2x1bW5fXyA9IF9kZXJlcV8oXCJjb250ZXh0TWVudUl0ZW0vdW5mcmVlemVDb2x1bW5cIiksICRfX2NvbnRleHRNZW51SXRlbV80N191bmZyZWV6ZUNvbHVtbl9fICYmICRfX2NvbnRleHRNZW51SXRlbV80N191bmZyZWV6ZUNvbHVtbl9fLl9fZXNNb2R1bGUgJiYgJF9fY29udGV4dE1lbnVJdGVtXzQ3X3VuZnJlZXplQ29sdW1uX18gfHwge2RlZmF1bHQ6ICRfX2NvbnRleHRNZW51SXRlbV80N191bmZyZWV6ZUNvbHVtbl9ffSkudW5mcmVlemVDb2x1bW5JdGVtO1xudmFyIHByaXZhdGVQb29sID0gbmV3IFdlYWtNYXAoKTtcbnZhciBNYW51YWxDb2x1bW5GcmVlemUgPSBmdW5jdGlvbiBNYW51YWxDb2x1bW5GcmVlemUoaG90SW5zdGFuY2UpIHtcbiAgJHRyYWNldXJSdW50aW1lLnN1cGVyQ29uc3RydWN0b3IoJE1hbnVhbENvbHVtbkZyZWV6ZSkuY2FsbCh0aGlzLCBob3RJbnN0YW5jZSk7XG4gIHByaXZhdGVQb29sLnNldCh0aGlzLCB7XG4gICAgbW92ZUJ5RnJlZXplOiBmYWxzZSxcbiAgICBhZnRlckZpcnN0VXNlOiBmYWxzZVxuICB9KTtcbiAgdGhpcy5mcm96ZW5Db2x1bW5zQmFzZVBvc2l0aW9ucyA9IFtdO1xuICB0aGlzLm1hbnVhbENvbHVtbk1vdmVQbHVnaW4gPSB2b2lkIDA7XG59O1xudmFyICRNYW51YWxDb2x1bW5GcmVlemUgPSBNYW51YWxDb2x1bW5GcmVlemU7XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShNYW51YWxDb2x1bW5GcmVlemUsIHtcbiAgaXNFbmFibGVkOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gISF0aGlzLmhvdC5nZXRTZXR0aW5ncygpLm1hbnVhbENvbHVtbkZyZWV6ZTtcbiAgfSxcbiAgZW5hYmxlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fNiA9IHRoaXM7XG4gICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmFkZEhvb2soJ2FmdGVyQ29udGV4dE1lbnVEZWZhdWx0T3B0aW9ucycsIChmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICByZXR1cm4gJF9fNi5hZGRDb250ZXh0TWVudUVudHJ5KG9wdGlvbnMpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ2FmdGVySW5pdCcsIChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX182Lm9uQWZ0ZXJJbml0KCk7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygnYmVmb3JlQ29sdW1uTW92ZScsIChmdW5jdGlvbihyb3dzLCB0YXJnZXQpIHtcbiAgICAgIHJldHVybiAkX182Lm9uQmVmb3JlQ29sdW1uTW92ZShyb3dzLCB0YXJnZXQpO1xuICAgIH0pKTtcbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJE1hbnVhbENvbHVtbkZyZWV6ZS5wcm90b3R5cGUsIFwiZW5hYmxlUGx1Z2luXCIpLmNhbGwodGhpcyk7XG4gIH0sXG4gIGRpc2FibGVQbHVnaW46IGZ1bmN0aW9uKCkge1xuICAgIHZhciBwcml2ID0gcHJpdmF0ZVBvb2wuZ2V0KHRoaXMpO1xuICAgIHByaXYuYWZ0ZXJGaXJzdFVzZSA9IGZhbHNlO1xuICAgIHByaXYubW92ZUJ5RnJlZXplID0gZmFsc2U7XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICRNYW51YWxDb2x1bW5GcmVlemUucHJvdG90eXBlLCBcImRpc2FibGVQbHVnaW5cIikuY2FsbCh0aGlzKTtcbiAgfSxcbiAgdXBkYXRlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmRpc2FibGVQbHVnaW4oKTtcbiAgICB0aGlzLmVuYWJsZVBsdWdpbigpO1xuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkTWFudWFsQ29sdW1uRnJlZXplLnByb3RvdHlwZSwgXCJ1cGRhdGVQbHVnaW5cIikuY2FsbCh0aGlzKTtcbiAgfSxcbiAgZnJlZXplQ29sdW1uOiBmdW5jdGlvbihjb2x1bW4pIHtcbiAgICB2YXIgcHJpdiA9IHByaXZhdGVQb29sLmdldCh0aGlzKTtcbiAgICB2YXIgc2V0dGluZ3MgPSB0aGlzLmhvdC5nZXRTZXR0aW5ncygpO1xuICAgIGlmICghcHJpdi5hZnRlckZpcnN0VXNlKSB7XG4gICAgICBwcml2LmFmdGVyRmlyc3RVc2UgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAoc2V0dGluZ3MuZml4ZWRDb2x1bW5zTGVmdCA9PT0gdGhpcy5ob3QuY291bnRDb2xzKCkgfHwgY29sdW1uIDw9IHNldHRpbmdzLmZpeGVkQ29sdW1uc0xlZnQgLSAxKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHByaXYubW92ZUJ5RnJlZXplID0gdHJ1ZTtcbiAgICBpZiAoY29sdW1uICE9PSB0aGlzLmdldE1vdmVQbHVnaW4oKS5jb2x1bW5zTWFwcGVyLmdldFZhbHVlQnlJbmRleChjb2x1bW4pKSB7XG4gICAgICB0aGlzLmZyb3plbkNvbHVtbnNCYXNlUG9zaXRpb25zW3NldHRpbmdzLmZpeGVkQ29sdW1uc0xlZnRdID0gY29sdW1uO1xuICAgIH1cbiAgICB0aGlzLmdldE1vdmVQbHVnaW4oKS5tb3ZlQ29sdW1uKGNvbHVtbiwgc2V0dGluZ3MuZml4ZWRDb2x1bW5zTGVmdCsrKTtcbiAgfSxcbiAgdW5mcmVlemVDb2x1bW46IGZ1bmN0aW9uKGNvbHVtbikge1xuICAgIHZhciBwcml2ID0gcHJpdmF0ZVBvb2wuZ2V0KHRoaXMpO1xuICAgIHZhciBzZXR0aW5ncyA9IHRoaXMuaG90LmdldFNldHRpbmdzKCk7XG4gICAgaWYgKCFwcml2LmFmdGVyRmlyc3RVc2UpIHtcbiAgICAgIHByaXYuYWZ0ZXJGaXJzdFVzZSA9IHRydWU7XG4gICAgfVxuICAgIGlmIChzZXR0aW5ncy5maXhlZENvbHVtbnNMZWZ0IDw9IDAgfHwgKGNvbHVtbiA+IHNldHRpbmdzLmZpeGVkQ29sdW1uc0xlZnQgLSAxKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgcmV0dXJuQ29sID0gdGhpcy5nZXRCZXN0Q29sdW1uUmV0dXJuUG9zaXRpb24oY29sdW1uKTtcbiAgICBwcml2Lm1vdmVCeUZyZWV6ZSA9IHRydWU7XG4gICAgc2V0dGluZ3MuZml4ZWRDb2x1bW5zTGVmdC0tO1xuICAgIHRoaXMuZ2V0TW92ZVBsdWdpbigpLm1vdmVDb2x1bW4oY29sdW1uLCByZXR1cm5Db2wgKyAxKTtcbiAgfSxcbiAgZ2V0TW92ZVBsdWdpbjogZnVuY3Rpb24oKSB7XG4gICAgaWYgKCF0aGlzLm1hbnVhbENvbHVtbk1vdmVQbHVnaW4pIHtcbiAgICAgIHRoaXMubWFudWFsQ29sdW1uTW92ZVBsdWdpbiA9IHRoaXMuaG90LmdldFBsdWdpbignbWFudWFsQ29sdW1uTW92ZScpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5tYW51YWxDb2x1bW5Nb3ZlUGx1Z2luO1xuICB9LFxuICBnZXRCZXN0Q29sdW1uUmV0dXJuUG9zaXRpb246IGZ1bmN0aW9uKGNvbHVtbikge1xuICAgIHZhciBtb3ZlUGx1Z2luID0gdGhpcy5nZXRNb3ZlUGx1Z2luKCk7XG4gICAgdmFyIHNldHRpbmdzID0gdGhpcy5ob3QuZ2V0U2V0dGluZ3MoKTtcbiAgICB2YXIgaSA9IHNldHRpbmdzLmZpeGVkQ29sdW1uc0xlZnQ7XG4gICAgdmFyIGogPSBtb3ZlUGx1Z2luLmNvbHVtbnNNYXBwZXIuZ2V0VmFsdWVCeUluZGV4KGkpO1xuICAgIHZhciBpbml0aWFsQ29sO1xuICAgIGlmICh0aGlzLmZyb3plbkNvbHVtbnNCYXNlUG9zaXRpb25zW2NvbHVtbl0gPT0gbnVsbCkge1xuICAgICAgaW5pdGlhbENvbCA9IG1vdmVQbHVnaW4uY29sdW1uc01hcHBlci5nZXRWYWx1ZUJ5SW5kZXgoY29sdW1uKTtcbiAgICAgIHdoaWxlIChqIDwgaW5pdGlhbENvbCkge1xuICAgICAgICBpKys7XG4gICAgICAgIGogPSBtb3ZlUGx1Z2luLmNvbHVtbnNNYXBwZXIuZ2V0VmFsdWVCeUluZGV4KGkpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpbml0aWFsQ29sID0gdGhpcy5mcm96ZW5Db2x1bW5zQmFzZVBvc2l0aW9uc1tjb2x1bW5dO1xuICAgICAgdGhpcy5mcm96ZW5Db2x1bW5zQmFzZVBvc2l0aW9uc1tjb2x1bW5dID0gdm9pZCAwO1xuICAgICAgd2hpbGUgKGogPD0gaW5pdGlhbENvbCkge1xuICAgICAgICBpKys7XG4gICAgICAgIGogPSBtb3ZlUGx1Z2luLmNvbHVtbnNNYXBwZXIuZ2V0VmFsdWVCeUluZGV4KGkpO1xuICAgICAgfVxuICAgICAgaSA9IGo7XG4gICAgfVxuICAgIHJldHVybiBpIC0gMTtcbiAgfSxcbiAgYWRkQ29udGV4dE1lbnVFbnRyeTogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgIG9wdGlvbnMuaXRlbXMucHVzaChIYW5kc29udGFibGUucGx1Z2lucy5Db250ZXh0TWVudS5TRVBBUkFUT1IsIGZyZWV6ZUNvbHVtbkl0ZW0odGhpcyksIHVuZnJlZXplQ29sdW1uSXRlbSh0aGlzKSk7XG4gIH0sXG4gIG9uQWZ0ZXJJbml0OiBmdW5jdGlvbigpIHtcbiAgICBpZiAoIXRoaXMuZ2V0TW92ZVBsdWdpbigpLmlzRW5hYmxlZCgpKSB7XG4gICAgICB0aGlzLmdldE1vdmVQbHVnaW4oKS5lbmFibGVQbHVnaW4oKTtcbiAgICB9XG4gIH0sXG4gIG9uQmVmb3JlQ29sdW1uTW92ZTogZnVuY3Rpb24ocm93cywgdGFyZ2V0KSB7XG4gICAgdmFyIHByaXYgPSBwcml2YXRlUG9vbC5nZXQodGhpcyk7XG4gICAgaWYgKHByaXYuYWZ0ZXJGaXJzdFVzZSAmJiAhcHJpdi5tb3ZlQnlGcmVlemUpIHtcbiAgICAgIHZhciBmcm96ZW5MZW4gPSB0aGlzLmhvdC5nZXRTZXR0aW5ncygpLmZpeGVkQ29sdW1uc0xlZnQ7XG4gICAgICB2YXIgZGlzYWxsb3dNb3ZpbmcgPSB0YXJnZXQgPCBmcm96ZW5MZW47XG4gICAgICBpZiAoIWRpc2FsbG93TW92aW5nKSB7XG4gICAgICAgIGFycmF5RWFjaChyb3dzLCAoZnVuY3Rpb24odmFsdWUsIGluZGV4LCBhcnJheSkge1xuICAgICAgICAgIGlmICh2YWx1ZSA8IGZyb3plbkxlbikge1xuICAgICAgICAgICAgZGlzYWxsb3dNb3ZpbmcgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgICAgaWYgKGRpc2FsbG93TW92aW5nKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHByaXYubW92ZUJ5RnJlZXplKSB7XG4gICAgICBwcml2Lm1vdmVCeUZyZWV6ZSA9IGZhbHNlO1xuICAgIH1cbiAgfSxcbiAgZGVzdHJveTogZnVuY3Rpb24oKSB7XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICRNYW51YWxDb2x1bW5GcmVlemUucHJvdG90eXBlLCBcImRlc3Ryb3lcIikuY2FsbCh0aGlzKTtcbiAgfVxufSwge30sIEJhc2VQbHVnaW4pO1xuO1xucmVnaXN0ZXJQbHVnaW4oJ21hbnVhbENvbHVtbkZyZWV6ZScsIE1hbnVhbENvbHVtbkZyZWV6ZSk7XG5cbi8vIyBcbn0se1wiX2Jhc2VcIjo2MixcImJyb3dzZXJcIjoyNCxcImNvbnRleHRNZW51SXRlbS9mcmVlemVDb2x1bW5cIjo5MyxcImNvbnRleHRNZW51SXRlbS91bmZyZWV6ZUNvbHVtblwiOjk0LFwiaGVscGVycy9hcnJheVwiOjQzLFwicGx1Z2luc1wiOjYxfV0sOTY6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIENvbHVtbnNNYXBwZXI6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIENvbHVtbnNNYXBwZXI7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19taXhpbnNfNDdfYXJyYXlNYXBwZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X251bWJlcl9fO1xudmFyIEhhbmRzb250YWJsZSA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gPSBfZGVyZXFfKFwiYnJvd3NlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9ffSkuZGVmYXVsdDtcbnZhciBhcnJheU1hcHBlciA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19taXhpbnNfNDdfYXJyYXlNYXBwZXJfXyA9IF9kZXJlcV8oXCJtaXhpbnMvYXJyYXlNYXBwZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X21peGluc180N19hcnJheU1hcHBlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X21peGluc180N19hcnJheU1hcHBlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfbWl4aW5zXzQ3X2FycmF5TWFwcGVyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X21peGluc180N19hcnJheU1hcHBlcl9ffSkuYXJyYXlNYXBwZXI7XG52YXIgYXJyYXlGaWx0ZXIgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fID0gX2RlcmVxXyhcImhlbHBlcnMvYXJyYXlcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfX30pLmFycmF5RmlsdGVyO1xudmFyIG1peGluID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gPSBfZGVyZXFfKFwiaGVscGVycy9vYmplY3RcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X199KS5taXhpbjtcbnZhciByYW5nZUVhY2ggPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL251bWJlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X251bWJlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfX30pLnJhbmdlRWFjaDtcbnZhciBDb2x1bW5zTWFwcGVyID0gZnVuY3Rpb24gQ29sdW1uc01hcHBlcihtYW51YWxDb2x1bW5Nb3ZlKSB7XG4gIHRoaXMubWFudWFsQ29sdW1uTW92ZSA9IG1hbnVhbENvbHVtbk1vdmU7XG59O1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoQ29sdW1uc01hcHBlciwge1xuICBjcmVhdGVNYXA6IGZ1bmN0aW9uKGxlbmd0aCkge1xuICAgIHZhciAkX181ID0gdGhpcztcbiAgICB2YXIgb3JpZ2luTGVuZ3RoID0gbGVuZ3RoID09PSB2b2lkIDAgPyB0aGlzLl9hcnJheU1hcC5sZW5ndGggOiBsZW5ndGg7XG4gICAgdGhpcy5fYXJyYXlNYXAubGVuZ3RoID0gMDtcbiAgICByYW5nZUVhY2gob3JpZ2luTGVuZ3RoIC0gMSwgKGZ1bmN0aW9uKGl0ZW1JbmRleCkge1xuICAgICAgJF9fNS5fYXJyYXlNYXBbaXRlbUluZGV4XSA9IGl0ZW1JbmRleDtcbiAgICB9KSk7XG4gIH0sXG4gIGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuX2FycmF5TWFwID0gbnVsbDtcbiAgfSxcbiAgbW92ZUNvbHVtbjogZnVuY3Rpb24oZnJvbSwgdG8pIHtcbiAgICB2YXIgaW5kZXhUb01vdmUgPSB0aGlzLl9hcnJheU1hcFtmcm9tXTtcbiAgICB0aGlzLl9hcnJheU1hcFtmcm9tXSA9IG51bGw7XG4gICAgdGhpcy5fYXJyYXlNYXAuc3BsaWNlKHRvLCAwLCBpbmRleFRvTW92ZSk7XG4gIH0sXG4gIGNsZWFyTnVsbDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5fYXJyYXlNYXAgPSBhcnJheUZpbHRlcih0aGlzLl9hcnJheU1hcCwgKGZ1bmN0aW9uKGkpIHtcbiAgICAgIHJldHVybiBpICE9PSBudWxsO1xuICAgIH0pKTtcbiAgfVxufSwge30pO1xubWl4aW4oQ29sdW1uc01hcHBlciwgYXJyYXlNYXBwZXIpO1xuO1xuSGFuZHNvbnRhYmxlLnV0aWxzLk1hbnVhbENvbHVtbk1vdmVDb2x1bW5zTWFwcGVyID0gQ29sdW1uc01hcHBlcjtcblxuLy8jIFxufSx7XCJicm93c2VyXCI6MjQsXCJoZWxwZXJzL2FycmF5XCI6NDMsXCJoZWxwZXJzL251bWJlclwiOjUyLFwiaGVscGVycy9vYmplY3RcIjo1MyxcIm1peGlucy9hcnJheU1hcHBlclwiOjU3fV0sOTc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIE1hbnVhbENvbHVtbk1vdmU6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIE1hbnVhbENvbHVtbk1vdmU7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X185NV9iYXNlXzQ2X2pzX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18sXG4gICAgJF9fY29sdW1uc01hcHBlcl9fLFxuICAgICRfX3VpXzQ3X2JhY2tsaWdodF9fLFxuICAgICRfX3VpXzQ3X2d1aWRlbGluZV9fO1xudmFyIEJhc2VQbHVnaW4gPSAoJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfNDZfanNfXyA9IF9kZXJlcV8oXCJfYmFzZS5qc1wiKSwgJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfNDZfanNfXyAmJiAkX19fNDZfXzQ2X180N19fOTVfYmFzZV80Nl9qc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfNDZfanNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfNDZfanNfX30pLmRlZmF1bHQ7XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX199KS5kZWZhdWx0O1xudmFyIGFycmF5RWFjaCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gPSBfZGVyZXFfKFwiaGVscGVycy9hcnJheVwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9ffSkuYXJyYXlFYWNoO1xudmFyICRfXzMgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLFxuICAgIGFkZENsYXNzID0gJF9fMy5hZGRDbGFzcyxcbiAgICByZW1vdmVDbGFzcyA9ICRfXzMucmVtb3ZlQ2xhc3MsXG4gICAgb2Zmc2V0ID0gJF9fMy5vZmZzZXQ7XG52YXIgcmFuZ2VFYWNoID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gPSBfZGVyZXFfKFwiaGVscGVycy9udW1iZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX199KS5yYW5nZUVhY2g7XG52YXIgZXZlbnRNYW5hZ2VyT2JqZWN0ID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fID0gX2RlcmVxXyhcImV2ZW50TWFuYWdlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX199KS5ldmVudE1hbmFnZXI7XG52YXIgcmVnaXN0ZXJQbHVnaW4gPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fID0gX2RlcmVxXyhcInBsdWdpbnNcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfX30pLnJlZ2lzdGVyUGx1Z2luO1xudmFyIENvbHVtbnNNYXBwZXIgPSAoJF9fY29sdW1uc01hcHBlcl9fID0gX2RlcmVxXyhcImNvbHVtbnNNYXBwZXJcIiksICRfX2NvbHVtbnNNYXBwZXJfXyAmJiAkX19jb2x1bW5zTWFwcGVyX18uX19lc01vZHVsZSAmJiAkX19jb2x1bW5zTWFwcGVyX18gfHwge2RlZmF1bHQ6ICRfX2NvbHVtbnNNYXBwZXJfX30pLkNvbHVtbnNNYXBwZXI7XG52YXIgQmFja2xpZ2h0VUkgPSAoJF9fdWlfNDdfYmFja2xpZ2h0X18gPSBfZGVyZXFfKFwidWkvYmFja2xpZ2h0XCIpLCAkX191aV80N19iYWNrbGlnaHRfXyAmJiAkX191aV80N19iYWNrbGlnaHRfXy5fX2VzTW9kdWxlICYmICRfX3VpXzQ3X2JhY2tsaWdodF9fIHx8IHtkZWZhdWx0OiAkX191aV80N19iYWNrbGlnaHRfX30pLkJhY2tsaWdodFVJO1xudmFyIEd1aWRlbGluZVVJID0gKCRfX3VpXzQ3X2d1aWRlbGluZV9fID0gX2RlcmVxXyhcInVpL2d1aWRlbGluZVwiKSwgJF9fdWlfNDdfZ3VpZGVsaW5lX18gJiYgJF9fdWlfNDdfZ3VpZGVsaW5lX18uX19lc01vZHVsZSAmJiAkX191aV80N19ndWlkZWxpbmVfXyB8fCB7ZGVmYXVsdDogJF9fdWlfNDdfZ3VpZGVsaW5lX199KS5HdWlkZWxpbmVVSTtcbnZhciBwcml2YXRlUG9vbCA9IG5ldyBXZWFrTWFwKCk7XG52YXIgQ1NTX1BMVUdJTiA9ICdodF9fbWFudWFsQ29sdW1uTW92ZSc7XG52YXIgQ1NTX1NIT1dfVUkgPSAnc2hvdy11aSc7XG52YXIgQ1NTX09OX01PVklORyA9ICdvbi1tb3ZpbmctLWNvbHVtbnMnO1xudmFyIENTU19BRlRFUl9TRUxFQ1RJT04gPSAnYWZ0ZXItc2VsZWN0aW9uLS1jb2x1bW5zJztcbnZhciBNYW51YWxDb2x1bW5Nb3ZlID0gZnVuY3Rpb24gTWFudWFsQ29sdW1uTW92ZShob3RJbnN0YW5jZSkge1xuICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJDb25zdHJ1Y3RvcigkTWFudWFsQ29sdW1uTW92ZSkuY2FsbCh0aGlzLCBob3RJbnN0YW5jZSk7XG4gIHByaXZhdGVQb29sLnNldCh0aGlzLCB7XG4gICAgY29sdW1uc1RvTW92ZTogW10sXG4gICAgY291bnRDb2xzOiAwLFxuICAgIGZpeGVkQ29sdW1uczogMCxcbiAgICBwcmVzc2VkOiB2b2lkIDAsXG4gICAgZGlzYWxsb3dNb3Zpbmc6IHZvaWQgMCxcbiAgICB0YXJnZXQ6IHtcbiAgICAgIGV2ZW50UGFnZVg6IHZvaWQgMCxcbiAgICAgIGNvb3Jkczogdm9pZCAwLFxuICAgICAgVEQ6IHZvaWQgMCxcbiAgICAgIGNvbDogdm9pZCAwXG4gICAgfVxuICB9KTtcbiAgdGhpcy5yZW1vdmVkQ29sdW1ucyA9IFtdO1xuICB0aGlzLmNvbHVtbnNNYXBwZXIgPSBuZXcgQ29sdW1uc01hcHBlcih0aGlzKTtcbiAgdGhpcy5ldmVudE1hbmFnZXIgPSBldmVudE1hbmFnZXJPYmplY3QodGhpcyk7XG4gIHRoaXMuYmFja2xpZ2h0ID0gbmV3IEJhY2tsaWdodFVJKGhvdEluc3RhbmNlKTtcbiAgdGhpcy5ndWlkZWxpbmUgPSBuZXcgR3VpZGVsaW5lVUkoaG90SW5zdGFuY2UpO1xufTtcbnZhciAkTWFudWFsQ29sdW1uTW92ZSA9IE1hbnVhbENvbHVtbk1vdmU7XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShNYW51YWxDb2x1bW5Nb3ZlLCB7XG4gIGlzRW5hYmxlZDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuICEhdGhpcy5ob3QuZ2V0U2V0dGluZ3MoKS5tYW51YWxDb2x1bW5Nb3ZlO1xuICB9LFxuICBlbmFibGVQbHVnaW46IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX18xMCA9IHRoaXM7XG4gICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmFkZEhvb2soJ2JlZm9yZU9uQ2VsbE1vdXNlRG93bicsIChmdW5jdGlvbihldmVudCwgY29vcmRzLCBURCwgYmxvY2tDYWxjdWxhdGlvbnMpIHtcbiAgICAgIHJldHVybiAkX18xMC5vbkJlZm9yZU9uQ2VsbE1vdXNlRG93bihldmVudCwgY29vcmRzLCBURCwgYmxvY2tDYWxjdWxhdGlvbnMpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ2JlZm9yZU9uQ2VsbE1vdXNlT3ZlcicsIChmdW5jdGlvbihldmVudCwgY29vcmRzLCBURCwgYmxvY2tDYWxjdWxhdGlvbnMpIHtcbiAgICAgIHJldHVybiAkX18xMC5vbkJlZm9yZU9uQ2VsbE1vdXNlT3ZlcihldmVudCwgY29vcmRzLCBURCwgYmxvY2tDYWxjdWxhdGlvbnMpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ2FmdGVyU2Nyb2xsVmVydGljYWxseScsIChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX18xMC5vbkFmdGVyU2Nyb2xsVmVydGljYWxseSgpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ21vZGlmeUNvbCcsIChmdW5jdGlvbihyb3csIHNvdXJjZSkge1xuICAgICAgcmV0dXJuICRfXzEwLm9uTW9kaWZ5Q29sKHJvdywgc291cmNlKTtcbiAgICB9KSk7XG4gICAgdGhpcy5hZGRIb29rKCdiZWZvcmVSZW1vdmVDb2wnLCAoZnVuY3Rpb24oaW5kZXgsIGFtb3VudCkge1xuICAgICAgcmV0dXJuICRfXzEwLm9uQmVmb3JlUmVtb3ZlQ29sKGluZGV4LCBhbW91bnQpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ2FmdGVyUmVtb3ZlQ29sJywgKGZ1bmN0aW9uKGluZGV4LCBhbW91bnQpIHtcbiAgICAgIHJldHVybiAkX18xMC5vbkFmdGVyUmVtb3ZlQ29sKGluZGV4LCBhbW91bnQpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ2FmdGVyQ3JlYXRlQ29sJywgKGZ1bmN0aW9uKGluZGV4LCBhbW91bnQpIHtcbiAgICAgIHJldHVybiAkX18xMC5vbkFmdGVyQ3JlYXRlQ29sKGluZGV4LCBhbW91bnQpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ2FmdGVyTG9hZERhdGEnLCAoZnVuY3Rpb24oZmlyc3RUaW1lKSB7XG4gICAgICByZXR1cm4gJF9fMTAub25BZnRlckxvYWREYXRhKGZpcnN0VGltZSk7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygndW5tb2RpZnlDb2wnLCAoZnVuY3Rpb24oY29sdW1uKSB7XG4gICAgICByZXR1cm4gJF9fMTAub25Vbm1vZGlmeUNvbChjb2x1bW4pO1xuICAgIH0pKTtcbiAgICB0aGlzLnJlZ2lzdGVyRXZlbnRzKCk7XG4gICAgYWRkQ2xhc3ModGhpcy5ob3Qucm9vdEVsZW1lbnQsIENTU19QTFVHSU4pO1xuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkTWFudWFsQ29sdW1uTW92ZS5wcm90b3R5cGUsIFwiZW5hYmxlUGx1Z2luXCIpLmNhbGwodGhpcyk7XG4gIH0sXG4gIHVwZGF0ZVBsdWdpbjogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5kaXNhYmxlUGx1Z2luKCk7XG4gICAgdGhpcy5lbmFibGVQbHVnaW4oKTtcbiAgICB0aGlzLm9uQWZ0ZXJQbHVnaW5zSW5pdGlhbGl6ZWQoKTtcbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJE1hbnVhbENvbHVtbk1vdmUucHJvdG90eXBlLCBcInVwZGF0ZVBsdWdpblwiKS5jYWxsKHRoaXMpO1xuICB9LFxuICBkaXNhYmxlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgcGx1Z2luU2V0dGluZ3MgPSB0aGlzLmhvdC5nZXRTZXR0aW5ncygpLm1hbnVhbENvbHVtbk1vdmU7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkocGx1Z2luU2V0dGluZ3MpKSB7XG4gICAgICB0aGlzLmNvbHVtbnNNYXBwZXIuY2xlYXJNYXAoKTtcbiAgICB9XG4gICAgcmVtb3ZlQ2xhc3ModGhpcy5ob3Qucm9vdEVsZW1lbnQsIENTU19QTFVHSU4pO1xuICAgIHRoaXMudW5yZWdpc3RlckV2ZW50cygpO1xuICAgIHRoaXMuYmFja2xpZ2h0LmRlc3Ryb3koKTtcbiAgICB0aGlzLmd1aWRlbGluZS5kZXN0cm95KCk7XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICRNYW51YWxDb2x1bW5Nb3ZlLnByb3RvdHlwZSwgXCJkaXNhYmxlUGx1Z2luXCIpLmNhbGwodGhpcyk7XG4gIH0sXG4gIG1vdmVDb2x1bW46IGZ1bmN0aW9uKGNvbHVtbiwgdGFyZ2V0KSB7XG4gICAgdGhpcy5tb3ZlQ29sdW1ucyhbY29sdW1uXSwgdGFyZ2V0KTtcbiAgfSxcbiAgbW92ZUNvbHVtbnM6IGZ1bmN0aW9uKGNvbHVtbnMsIHRhcmdldCkge1xuICAgIHZhciAkX18xMCA9IHRoaXM7XG4gICAgdmFyIHByaXYgPSBwcml2YXRlUG9vbC5nZXQodGhpcyk7XG4gICAgdmFyIGJlZm9yZUNvbHVtbkhvb2sgPSB0aGlzLmhvdC5ydW5Ib29rcygnYmVmb3JlQ29sdW1uTW92ZScsIGNvbHVtbnMsIHRhcmdldCk7XG4gICAgcHJpdi5kaXNhbGxvd01vdmluZyA9ICFiZWZvcmVDb2x1bW5Ib29rO1xuICAgIGlmIChiZWZvcmVDb2x1bW5Ib29rICE9PSBmYWxzZSkge1xuICAgICAgYXJyYXlFYWNoKGNvbHVtbnMsIChmdW5jdGlvbihjb2x1bW4sIGluZGV4LCBhcnJheSkge1xuICAgICAgICBhcnJheVtpbmRleF0gPSAkX18xMC5jb2x1bW5zTWFwcGVyLmdldFZhbHVlQnlJbmRleChjb2x1bW4pO1xuICAgICAgfSkpO1xuICAgICAgYXJyYXlFYWNoKGNvbHVtbnMsIChmdW5jdGlvbihjb2x1bW4sIGluZGV4KSB7XG4gICAgICAgIHZhciBhY3R1YWxQb3NpdGlvbiA9ICRfXzEwLmNvbHVtbnNNYXBwZXIuZ2V0SW5kZXhCeVZhbHVlKGNvbHVtbik7XG4gICAgICAgIGlmIChhY3R1YWxQb3NpdGlvbiAhPT0gdGFyZ2V0KSB7XG4gICAgICAgICAgJF9fMTAuY29sdW1uc01hcHBlci5tb3ZlQ29sdW1uKGFjdHVhbFBvc2l0aW9uLCB0YXJnZXQgKyBpbmRleCk7XG4gICAgICAgIH1cbiAgICAgIH0pKTtcbiAgICAgIHRoaXMuY29sdW1uc01hcHBlci5jbGVhck51bGwoKTtcbiAgICB9XG4gICAgdGhpcy5ob3QucnVuSG9va3MoJ2FmdGVyQ29sdW1uTW92ZScsIGNvbHVtbnMsIHRhcmdldCk7XG4gIH0sXG4gIGNoYW5nZVNlbGVjdGlvbjogZnVuY3Rpb24oc3RhcnRDb2x1bW4sIGVuZENvbHVtbikge1xuICAgIHZhciBzZWxlY3Rpb24gPSB0aGlzLmhvdC5zZWxlY3Rpb247XG4gICAgdmFyIGxhc3RSb3dJbmRleCA9IHRoaXMuaG90LmNvdW50Um93cygpIC0gMTtcbiAgICBzZWxlY3Rpb24uc2V0UmFuZ2VTdGFydE9ubHkobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcygwLCBzdGFydENvbHVtbikpO1xuICAgIHNlbGVjdGlvbi5zZXRSYW5nZUVuZChuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKGxhc3RSb3dJbmRleCwgZW5kQ29sdW1uKSwgZmFsc2UpO1xuICB9LFxuICBnZXRDb2x1bW5zV2lkdGg6IGZ1bmN0aW9uKGZyb20sIHRvKSB7XG4gICAgdmFyIHdpZHRoID0gMDtcbiAgICBmb3IgKHZhciBpID0gZnJvbTsgaSA8IHRvOyBpKyspIHtcbiAgICAgIHZhciBjb2x1bW5XaWR0aCA9IDA7XG4gICAgICBpZiAoaSA8IDApIHtcbiAgICAgICAgY29sdW1uV2lkdGggPSB0aGlzLmhvdC52aWV3Lnd0Lnd0VGFibGUuZ2V0Q29sdW1uV2lkdGgoaSkgfHwgMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbHVtbldpZHRoID0gdGhpcy5ob3Qudmlldy53dC53dFRhYmxlLmdldFN0cmV0Y2hlZENvbHVtbldpZHRoKGkpIHx8IDA7XG4gICAgICB9XG4gICAgICB3aWR0aCArPSBjb2x1bW5XaWR0aDtcbiAgICB9XG4gICAgcmV0dXJuIHdpZHRoO1xuICB9LFxuICBpbml0aWFsU2V0dGluZ3M6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBwbHVnaW5TZXR0aW5ncyA9IHRoaXMuaG90LmdldFNldHRpbmdzKCkubWFudWFsQ29sdW1uTW92ZTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShwbHVnaW5TZXR0aW5ncykpIHtcbiAgICAgIHRoaXMubW92ZUNvbHVtbnMocGx1Z2luU2V0dGluZ3MsIDApO1xuICAgIH0gZWxzZSBpZiAocGx1Z2luU2V0dGluZ3MgIT09IHZvaWQgMCkge1xuICAgICAgdGhpcy5wZXJzaXN0ZW50U3RhdGVMb2FkKCk7XG4gICAgfVxuICB9LFxuICBpc0ZpeGVkQ29sdW1uc0xlZnQ6IGZ1bmN0aW9uKGNvbHVtbikge1xuICAgIHJldHVybiBjb2x1bW4gPCB0aGlzLmhvdC5nZXRTZXR0aW5ncygpLmZpeGVkQ29sdW1uc0xlZnQ7XG4gIH0sXG4gIHBlcnNpc3RlbnRTdGF0ZVNhdmU6IGZ1bmN0aW9uKCkge1xuICAgIEhhbmRzb250YWJsZS5ob29rcy5ydW4odGhpcy5ob3QsICdwZXJzaXN0ZW50U3RhdGVTYXZlJywgJ21hbnVhbENvbHVtbk1vdmUnLCB0aGlzLmNvbHVtbnNNYXBwZXIuX2FycmF5TWFwKTtcbiAgfSxcbiAgcGVyc2lzdGVudFN0YXRlTG9hZDogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHN0b3JlZFN0YXRlID0ge307XG4gICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bih0aGlzLmhvdCwgJ3BlcnNpc3RlbnRTdGF0ZUxvYWQnLCAnbWFudWFsQ29sdW1uTW92ZScsIHN0b3JlZFN0YXRlKTtcbiAgICBpZiAoc3RvcmVkU3RhdGUudmFsdWUpIHtcbiAgICAgIHRoaXMuY29sdW1uc01hcHBlci5fYXJyYXlNYXAgPSBzdG9yZWRTdGF0ZS52YWx1ZTtcbiAgICB9XG4gIH0sXG4gIHByZXBhcmVDb2x1bW5zVG9Nb3Zpbmc6IGZ1bmN0aW9uKHN0YXJ0LCBlbmQpIHtcbiAgICB2YXIgc2VsZWN0ZWRDb2x1bW5zID0gW107XG4gICAgcmFuZ2VFYWNoKHN0YXJ0LCBlbmQsIChmdW5jdGlvbihpKSB7XG4gICAgICBzZWxlY3RlZENvbHVtbnMucHVzaChpKTtcbiAgICB9KSk7XG4gICAgcmV0dXJuIHNlbGVjdGVkQ29sdW1ucztcbiAgfSxcbiAgcmVmcmVzaFBvc2l0aW9uczogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHByaXYgPSBwcml2YXRlUG9vbC5nZXQodGhpcyk7XG4gICAgdmFyIGZpcnN0VmlzaWJsZSA9IHRoaXMuaG90LnZpZXcud3Qud3RUYWJsZS5nZXRGaXJzdFZpc2libGVDb2x1bW4oKTtcbiAgICB2YXIgbGFzdFZpc2libGUgPSB0aGlzLmhvdC52aWV3Lnd0Lnd0VGFibGUuZ2V0TGFzdFZpc2libGVDb2x1bW4oKTtcbiAgICB2YXIgd3RUYWJsZSA9IHRoaXMuaG90LnZpZXcud3Qud3RUYWJsZTtcbiAgICB2YXIgc2Nyb2xsYWJsZUVsZW1lbnQgPSB0aGlzLmhvdC52aWV3Lnd0Lnd0T3ZlcmxheXMuc2Nyb2xsYWJsZUVsZW1lbnQ7XG4gICAgdmFyIHNjcm9sbExlZnQgPSB0eXBlb2Ygc2Nyb2xsYWJsZUVsZW1lbnQuc2Nyb2xsWCA9PT0gJ251bWJlcicgPyBzY3JvbGxhYmxlRWxlbWVudC5zY3JvbGxYIDogc2Nyb2xsYWJsZUVsZW1lbnQuc2Nyb2xsTGVmdDtcbiAgICB2YXIgdGRPZmZzZXRMZWZ0ID0gdGhpcy5ob3Qudmlldy5USEVBRC5vZmZzZXRMZWZ0ICsgdGhpcy5nZXRDb2x1bW5zV2lkdGgoMCwgcHJpdi5jb29yZHNDb2x1bW4pO1xuICAgIHZhciBtb3VzZU9mZnNldExlZnQgPSBwcml2LnRhcmdldC5ldmVudFBhZ2VYIC0gKHByaXYucm9vdEVsZW1lbnRPZmZzZXQgLSAoc2Nyb2xsYWJsZUVsZW1lbnQuc2Nyb2xsWCA9PT0gdm9pZCAwID8gc2Nyb2xsTGVmdCA6IDApKTtcbiAgICB2YXIgaGlkZXJXaWR0aCA9IHd0VGFibGUuaGlkZXIub2Zmc2V0V2lkdGg7XG4gICAgdmFyIHRib2R5T2Zmc2V0TGVmdCA9IHd0VGFibGUuVEJPRFkub2Zmc2V0TGVmdDtcbiAgICB2YXIgYmFja2xpZ2h0RWxlbU1hcmdpbkxlZnQgPSB0aGlzLmJhY2tsaWdodC5nZXRPZmZzZXQoKS5sZWZ0O1xuICAgIHZhciBiYWNrbGlnaHRFbGVtV2lkdGggPSB0aGlzLmJhY2tsaWdodC5nZXRTaXplKCkud2lkdGg7XG4gICAgdmFyIHJvd0hlYWRlcldpZHRoID0gMDtcbiAgICBpZiAoKHByaXYucm9vdEVsZW1lbnRPZmZzZXQgKyB3dFRhYmxlLmhvbGRlci5vZmZzZXRXaWR0aCArIHNjcm9sbExlZnQpIDwgcHJpdi50YXJnZXQuZXZlbnRQYWdlWCkge1xuICAgICAgaWYgKHByaXYuY29vcmRzQ29sdW1uIDwgcHJpdi5jb3VudENvbHMpIHtcbiAgICAgICAgcHJpdi5jb29yZHNDb2x1bW4rKztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHByaXYuaGFzUm93SGVhZGVycykge1xuICAgICAgcm93SGVhZGVyV2lkdGggPSB0aGlzLmhvdC52aWV3Lnd0Lnd0T3ZlcmxheXMubGVmdE92ZXJsYXkuY2xvbmUud3RUYWJsZS5nZXRDb2x1bW5IZWFkZXIoLTEpLm9mZnNldFdpZHRoO1xuICAgIH1cbiAgICBpZiAodGhpcy5pc0ZpeGVkQ29sdW1uc0xlZnQocHJpdi5jb29yZHNDb2x1bW4pKSB7XG4gICAgICB0ZE9mZnNldExlZnQgKz0gc2Nyb2xsTGVmdDtcbiAgICB9XG4gICAgdGRPZmZzZXRMZWZ0ICs9IHJvd0hlYWRlcldpZHRoO1xuICAgIGlmIChwcml2LmNvb3Jkc0NvbHVtbiA8IDApIHtcbiAgICAgIGlmIChwcml2LmZpeGVkQ29sdW1ucyA+IDApIHtcbiAgICAgICAgcHJpdi50YXJnZXQuY29sID0gMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHByaXYudGFyZ2V0LmNvbCA9IGZpcnN0VmlzaWJsZSA+IDAgPyBmaXJzdFZpc2libGUgLSAxIDogZmlyc3RWaXNpYmxlO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoKHByaXYudGFyZ2V0LlRELm9mZnNldFdpZHRoIC8gMiArIHRkT2Zmc2V0TGVmdCkgPD0gbW91c2VPZmZzZXRMZWZ0KSB7XG4gICAgICB2YXIgbmV3Q29vcmRzQ29sID0gcHJpdi5jb29yZHNDb2x1bW4gPj0gcHJpdi5jb3VudENvbHMgPyBwcml2LmNvdW50Q29scyAtIDEgOiBwcml2LmNvb3Jkc0NvbHVtbjtcbiAgICAgIHByaXYudGFyZ2V0LmNvbCA9IG5ld0Nvb3Jkc0NvbCArIDE7XG4gICAgICB0ZE9mZnNldExlZnQgKz0gcHJpdi50YXJnZXQuVEQub2Zmc2V0V2lkdGg7XG4gICAgICBpZiAocHJpdi50YXJnZXQuY29sID4gbGFzdFZpc2libGUpIHtcbiAgICAgICAgdGhpcy5ob3Quc2Nyb2xsVmlld3BvcnRUbyh2b2lkIDAsIGxhc3RWaXNpYmxlICsgMSwgdm9pZCAwLCB0cnVlKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcHJpdi50YXJnZXQuY29sID0gcHJpdi5jb29yZHNDb2x1bW47XG4gICAgICBpZiAocHJpdi50YXJnZXQuY29sIDw9IGZpcnN0VmlzaWJsZSAmJiBwcml2LnRhcmdldC5jb2wgPj0gcHJpdi5maXhlZENvbHVtbnMpIHtcbiAgICAgICAgdGhpcy5ob3Quc2Nyb2xsVmlld3BvcnRUbyh2b2lkIDAsIGZpcnN0VmlzaWJsZSAtIDEpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAocHJpdi50YXJnZXQuY29sIDw9IGZpcnN0VmlzaWJsZSAmJiBwcml2LnRhcmdldC5jb2wgPj0gcHJpdi5maXhlZENvbHVtbnMpIHtcbiAgICAgIHRoaXMuaG90LnNjcm9sbFZpZXdwb3J0VG8odm9pZCAwLCBmaXJzdFZpc2libGUgLSAxKTtcbiAgICB9XG4gICAgdmFyIGJhY2tsaWdodExlZnQgPSBtb3VzZU9mZnNldExlZnQ7XG4gICAgdmFyIGd1aWRlbGluZUxlZnQgPSB0ZE9mZnNldExlZnQ7XG4gICAgaWYgKG1vdXNlT2Zmc2V0TGVmdCArIGJhY2tsaWdodEVsZW1XaWR0aCArIGJhY2tsaWdodEVsZW1NYXJnaW5MZWZ0ID49IGhpZGVyV2lkdGgpIHtcbiAgICAgIGJhY2tsaWdodExlZnQgPSBoaWRlcldpZHRoIC0gYmFja2xpZ2h0RWxlbVdpZHRoIC0gYmFja2xpZ2h0RWxlbU1hcmdpbkxlZnQ7XG4gICAgfSBlbHNlIGlmIChtb3VzZU9mZnNldExlZnQgKyBiYWNrbGlnaHRFbGVtTWFyZ2luTGVmdCA8IHRib2R5T2Zmc2V0TGVmdCArIHJvd0hlYWRlcldpZHRoKSB7XG4gICAgICBiYWNrbGlnaHRMZWZ0ID0gdGJvZHlPZmZzZXRMZWZ0ICsgcm93SGVhZGVyV2lkdGggKyBNYXRoLmFicyhiYWNrbGlnaHRFbGVtTWFyZ2luTGVmdCk7XG4gICAgfVxuICAgIGlmICh0ZE9mZnNldExlZnQgPj0gaGlkZXJXaWR0aCAtIDEpIHtcbiAgICAgIGd1aWRlbGluZUxlZnQgPSBoaWRlcldpZHRoIC0gMTtcbiAgICB9IGVsc2UgaWYgKGd1aWRlbGluZUxlZnQgPT09IDApIHtcbiAgICAgIGd1aWRlbGluZUxlZnQgPSAxO1xuICAgIH0gZWxzZSBpZiAoc2Nyb2xsYWJsZUVsZW1lbnQuc2Nyb2xsWCAhPT0gdm9pZCAwICYmIHByaXYuY29vcmRzQ29sdW1uIDwgcHJpdi5maXhlZENvbHVtbnMpIHtcbiAgICAgIGd1aWRlbGluZUxlZnQgPSBndWlkZWxpbmVMZWZ0IC0gKChwcml2LnJvb3RFbGVtZW50T2Zmc2V0IDw9IHNjcm9sbGFibGVFbGVtZW50LnNjcm9sbFgpID8gcHJpdi5yb290RWxlbWVudE9mZnNldCA6IDApO1xuICAgIH1cbiAgICB0aGlzLmJhY2tsaWdodC5zZXRQb3NpdGlvbihudWxsLCBiYWNrbGlnaHRMZWZ0KTtcbiAgICB0aGlzLmd1aWRlbGluZS5zZXRQb3NpdGlvbihudWxsLCBndWlkZWxpbmVMZWZ0KTtcbiAgfSxcbiAgdXBkYXRlQ29sdW1uc01hcHBlcjogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNvdW50Q29scyA9IHRoaXMuaG90LmNvdW50U291cmNlQ29scygpO1xuICAgIHZhciBjb2x1bW5zTWFwcGVyTGVuID0gdGhpcy5jb2x1bW5zTWFwcGVyLl9hcnJheU1hcC5sZW5ndGg7XG4gICAgaWYgKGNvbHVtbnNNYXBwZXJMZW4gPT09IDApIHtcbiAgICAgIHRoaXMuY29sdW1uc01hcHBlci5jcmVhdGVNYXAoY291bnRDb2xzIHx8IHRoaXMuaG90LmdldFNldHRpbmdzKCkuc3RhcnRDb2xzKTtcbiAgICB9IGVsc2UgaWYgKGNvbHVtbnNNYXBwZXJMZW4gPCBjb3VudENvbHMpIHtcbiAgICAgIHZhciBkaWZmID0gY291bnRDb2xzIC0gY29sdW1uc01hcHBlckxlbjtcbiAgICAgIHRoaXMuY29sdW1uc01hcHBlci5pbnNlcnRJdGVtcyhjb2x1bW5zTWFwcGVyTGVuLCBkaWZmKTtcbiAgICB9IGVsc2UgaWYgKGNvbHVtbnNNYXBwZXJMZW4gPiBjb3VudENvbHMpIHtcbiAgICAgIHZhciBtYXhJbmRleCA9IGNvdW50Q29scyAtIDE7XG4gICAgICB2YXIgY29sdW1uc1RvUmVtb3ZlID0gW107XG4gICAgICBhcnJheUVhY2godGhpcy5jb2x1bW5zTWFwcGVyLl9hcnJheU1hcCwgKGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgYXJyYXkpIHtcbiAgICAgICAgaWYgKHZhbHVlID4gbWF4SW5kZXgpIHtcbiAgICAgICAgICBjb2x1bW5zVG9SZW1vdmUucHVzaChpbmRleCk7XG4gICAgICAgIH1cbiAgICAgIH0pKTtcbiAgICAgIHRoaXMuY29sdW1uc01hcHBlci5yZW1vdmVJdGVtcyhjb2x1bW5zVG9SZW1vdmUpO1xuICAgIH1cbiAgfSxcbiAgcmVnaXN0ZXJFdmVudHM6IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX18xMCA9IHRoaXM7XG4gICAgdGhpcy5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsICdtb3VzZW1vdmUnLCAoZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHJldHVybiAkX18xMC5vbk1vdXNlTW92ZShldmVudCk7XG4gICAgfSkpO1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCAnbW91c2V1cCcsIChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX18xMC5vbk1vdXNlVXAoKTtcbiAgICB9KSk7XG4gIH0sXG4gIHVucmVnaXN0ZXJFdmVudHM6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmNsZWFyKCk7XG4gIH0sXG4gIG9uQmVmb3JlT25DZWxsTW91c2VEb3duOiBmdW5jdGlvbihldmVudCwgY29vcmRzLCBURCwgYmxvY2tDYWxjdWxhdGlvbnMpIHtcbiAgICB2YXIgd3RUYWJsZSA9IHRoaXMuaG90LnZpZXcud3Qud3RUYWJsZTtcbiAgICB2YXIgaXNIZWFkZXJTZWxlY3Rpb24gPSB0aGlzLmhvdC5zZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIuY29scztcbiAgICB2YXIgc2VsZWN0aW9uID0gdGhpcy5ob3QuZ2V0U2VsZWN0ZWRSYW5nZSgpO1xuICAgIHZhciBwcml2ID0gcHJpdmF0ZVBvb2wuZ2V0KHRoaXMpO1xuICAgIHZhciBpc1NvcnRpbmdFbGVtZW50ID0gZXZlbnQucmVhbFRhcmdldC5jbGFzc05hbWUuaW5kZXhPZignY29sdW1uU29ydGluZycpID4gLTE7XG4gICAgaWYgKCFzZWxlY3Rpb24gfHwgIWlzSGVhZGVyU2VsZWN0aW9uIHx8IHByaXYucHJlc3NlZCB8fCBldmVudC5idXR0b24gIT09IDAgfHwgaXNTb3J0aW5nRWxlbWVudCkge1xuICAgICAgcHJpdi5wcmVzc2VkID0gZmFsc2U7XG4gICAgICBwcml2LmNvbHVtbnNUb01vdmUubGVuZ3RoID0gMDtcbiAgICAgIHJlbW92ZUNsYXNzKHRoaXMuaG90LnJvb3RFbGVtZW50LCBbQ1NTX09OX01PVklORywgQ1NTX1NIT1dfVUldKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGd1aWRlbGluZUlzTm90UmVhZHkgPSB0aGlzLmd1aWRlbGluZS5pc0J1aWx0KCkgJiYgIXRoaXMuZ3VpZGVsaW5lLmlzQXBwZW5kZWQoKTtcbiAgICB2YXIgYmFja2xpZ2h0SXNOb3RSZWFkeSA9IHRoaXMuYmFja2xpZ2h0LmlzQnVpbHQoKSAmJiAhdGhpcy5iYWNrbGlnaHQuaXNBcHBlbmRlZCgpO1xuICAgIGlmIChndWlkZWxpbmVJc05vdFJlYWR5ICYmIGJhY2tsaWdodElzTm90UmVhZHkpIHtcbiAgICAgIHRoaXMuZ3VpZGVsaW5lLmFwcGVuZFRvKHd0VGFibGUuaGlkZXIpO1xuICAgICAgdGhpcy5iYWNrbGlnaHQuYXBwZW5kVG8od3RUYWJsZS5oaWRlcik7XG4gICAgfVxuICAgIHZhciAkX18xMiA9IHNlbGVjdGlvbixcbiAgICAgICAgZnJvbSA9ICRfXzEyLmZyb20sXG4gICAgICAgIHRvID0gJF9fMTIudG87XG4gICAgdmFyIHN0YXJ0ID0gTWF0aC5taW4oZnJvbS5jb2wsIHRvLmNvbCk7XG4gICAgdmFyIGVuZCA9IE1hdGgubWF4KGZyb20uY29sLCB0by5jb2wpO1xuICAgIGlmIChjb29yZHMucm93IDwgMCAmJiAoY29vcmRzLmNvbCA+PSBzdGFydCAmJiBjb29yZHMuY29sIDw9IGVuZCkpIHtcbiAgICAgIGJsb2NrQ2FsY3VsYXRpb25zLmNvbHVtbiA9IHRydWU7XG4gICAgICBwcml2LnByZXNzZWQgPSB0cnVlO1xuICAgICAgcHJpdi50YXJnZXQuZXZlbnRQYWdlWCA9IGV2ZW50LnBhZ2VYO1xuICAgICAgcHJpdi5jb29yZHNDb2x1bW4gPSBjb29yZHMuY29sO1xuICAgICAgcHJpdi50YXJnZXQuVEQgPSBURDtcbiAgICAgIHByaXYudGFyZ2V0LmNvbCA9IGNvb3Jkcy5jb2w7XG4gICAgICBwcml2LmNvbHVtbnNUb01vdmUgPSB0aGlzLnByZXBhcmVDb2x1bW5zVG9Nb3Zpbmcoc3RhcnQsIGVuZCk7XG4gICAgICBwcml2Lmhhc1Jvd0hlYWRlcnMgPSAhIXRoaXMuaG90LmdldFNldHRpbmdzKCkucm93SGVhZGVycztcbiAgICAgIHByaXYuY291bnRDb2xzID0gdGhpcy5ob3QuY291bnRDb2xzKCk7XG4gICAgICBwcml2LmZpeGVkQ29sdW1ucyA9IHRoaXMuaG90LmdldFNldHRpbmdzKCkuZml4ZWRDb2x1bW5zTGVmdDtcbiAgICAgIHByaXYucm9vdEVsZW1lbnRPZmZzZXQgPSBvZmZzZXQodGhpcy5ob3Qucm9vdEVsZW1lbnQpLmxlZnQ7XG4gICAgICB2YXIgY291bnRDb2x1bW5zRnJvbSA9IHByaXYuaGFzUm93SGVhZGVycyA/IC0xIDogMDtcbiAgICAgIHZhciB0b3BQb3MgPSB3dFRhYmxlLmhvbGRlci5zY3JvbGxUb3AgKyB3dFRhYmxlLmdldENvbHVtbkhlYWRlckhlaWdodCgwKSArIDE7XG4gICAgICB2YXIgZml4ZWRDb2x1bW5zID0gY29vcmRzLmNvbCA8IHByaXYuZml4ZWRDb2x1bW5zO1xuICAgICAgdmFyIHNjcm9sbGFibGVFbGVtZW50ID0gdGhpcy5ob3Qudmlldy53dC53dE92ZXJsYXlzLnNjcm9sbGFibGVFbGVtZW50O1xuICAgICAgdmFyIHdyYXBwZXJJc1dpbmRvdyA9IHNjcm9sbGFibGVFbGVtZW50LnNjcm9sbFggPyBzY3JvbGxhYmxlRWxlbWVudC5zY3JvbGxYIC0gcHJpdi5yb290RWxlbWVudE9mZnNldCA6IDA7XG4gICAgICB2YXIgbW91c2VPZmZzZXQgPSBldmVudC5sYXllclggLSAoZml4ZWRDb2x1bW5zID8gd3JhcHBlcklzV2luZG93IDogMCk7XG4gICAgICB2YXIgbGVmdE9mZnNldCA9IE1hdGguYWJzKHRoaXMuZ2V0Q29sdW1uc1dpZHRoKHN0YXJ0LCBjb29yZHMuY29sKSArIG1vdXNlT2Zmc2V0KTtcbiAgICAgIHRoaXMuYmFja2xpZ2h0LnNldFBvc2l0aW9uKHRvcFBvcywgdGhpcy5nZXRDb2x1bW5zV2lkdGgoY291bnRDb2x1bW5zRnJvbSwgc3RhcnQpICsgbGVmdE9mZnNldCk7XG4gICAgICB0aGlzLmJhY2tsaWdodC5zZXRTaXplKHRoaXMuZ2V0Q29sdW1uc1dpZHRoKHN0YXJ0LCBlbmQgKyAxKSwgd3RUYWJsZS5oaWRlci5vZmZzZXRIZWlnaHQgLSB0b3BQb3MpO1xuICAgICAgdGhpcy5iYWNrbGlnaHQuc2V0T2Zmc2V0KG51bGwsIGxlZnRPZmZzZXQgKiAtMSk7XG4gICAgICBhZGRDbGFzcyh0aGlzLmhvdC5yb290RWxlbWVudCwgQ1NTX09OX01PVklORyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlbW92ZUNsYXNzKHRoaXMuaG90LnJvb3RFbGVtZW50LCBDU1NfQUZURVJfU0VMRUNUSU9OKTtcbiAgICAgIHByaXYucHJlc3NlZCA9IGZhbHNlO1xuICAgICAgcHJpdi5jb2x1bW5zVG9Nb3ZlLmxlbmd0aCA9IDA7XG4gICAgfVxuICB9LFxuICBvbk1vdXNlTW92ZTogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgcHJpdiA9IHByaXZhdGVQb29sLmdldCh0aGlzKTtcbiAgICBpZiAoIXByaXYucHJlc3NlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoZXZlbnQucmVhbFRhcmdldCA9PT0gdGhpcy5iYWNrbGlnaHQuZWxlbWVudCkge1xuICAgICAgdmFyIHdpZHRoID0gdGhpcy5iYWNrbGlnaHQuZ2V0U2l6ZSgpLndpZHRoO1xuICAgICAgdGhpcy5iYWNrbGlnaHQuc2V0U2l6ZSgwKTtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuYmFja2xpZ2h0LnNldFBvc2l0aW9uKHdpZHRoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBwcml2LnRhcmdldC5ldmVudFBhZ2VYID0gZXZlbnQucGFnZVg7XG4gICAgdGhpcy5yZWZyZXNoUG9zaXRpb25zKCk7XG4gIH0sXG4gIG9uQmVmb3JlT25DZWxsTW91c2VPdmVyOiBmdW5jdGlvbihldmVudCwgY29vcmRzLCBURCwgYmxvY2tDYWxjdWxhdGlvbnMpIHtcbiAgICB2YXIgc2VsZWN0ZWRSYW5nZSA9IHRoaXMuaG90LmdldFNlbGVjdGVkUmFuZ2UoKTtcbiAgICB2YXIgcHJpdiA9IHByaXZhdGVQb29sLmdldCh0aGlzKTtcbiAgICBpZiAoIXNlbGVjdGVkUmFuZ2UgfHwgIXByaXYucHJlc3NlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAocHJpdi5jb2x1bW5zVG9Nb3ZlLmluZGV4T2YoY29vcmRzLmNvbCkgPiAtMSkge1xuICAgICAgcmVtb3ZlQ2xhc3ModGhpcy5ob3Qucm9vdEVsZW1lbnQsIENTU19TSE9XX1VJKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYWRkQ2xhc3ModGhpcy5ob3Qucm9vdEVsZW1lbnQsIENTU19TSE9XX1VJKTtcbiAgICB9XG4gICAgYmxvY2tDYWxjdWxhdGlvbnMucm93ID0gdHJ1ZTtcbiAgICBibG9ja0NhbGN1bGF0aW9ucy5jb2x1bW4gPSB0cnVlO1xuICAgIGJsb2NrQ2FsY3VsYXRpb25zLmNlbGwgPSB0cnVlO1xuICAgIHByaXYuY29vcmRzQ29sdW1uID0gY29vcmRzLmNvbDtcbiAgICBwcml2LnRhcmdldC5URCA9IFREO1xuICB9LFxuICBvbk1vdXNlVXA6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBwcml2ID0gcHJpdmF0ZVBvb2wuZ2V0KHRoaXMpO1xuICAgIHByaXYuY29vcmRzQ29sdW1uID0gdm9pZCAwO1xuICAgIHByaXYucHJlc3NlZCA9IGZhbHNlO1xuICAgIHByaXYuYmFja2xpZ2h0V2lkdGggPSAwO1xuICAgIHJlbW92ZUNsYXNzKHRoaXMuaG90LnJvb3RFbGVtZW50LCBbQ1NTX09OX01PVklORywgQ1NTX1NIT1dfVUksIENTU19BRlRFUl9TRUxFQ1RJT05dKTtcbiAgICBpZiAodGhpcy5ob3Quc2VsZWN0aW9uLnNlbGVjdGVkSGVhZGVyLmNvbHMpIHtcbiAgICAgIGFkZENsYXNzKHRoaXMuaG90LnJvb3RFbGVtZW50LCBDU1NfQUZURVJfU0VMRUNUSU9OKTtcbiAgICB9XG4gICAgaWYgKHByaXYuY29sdW1uc1RvTW92ZS5sZW5ndGggPCAxIHx8IHByaXYudGFyZ2V0LmNvbCA9PT0gdm9pZCAwIHx8IHByaXYuY29sdW1uc1RvTW92ZS5pbmRleE9mKHByaXYudGFyZ2V0LmNvbCkgPiAtMSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLm1vdmVDb2x1bW5zKHByaXYuY29sdW1uc1RvTW92ZSwgcHJpdi50YXJnZXQuY29sKTtcbiAgICB0aGlzLnBlcnNpc3RlbnRTdGF0ZVNhdmUoKTtcbiAgICB0aGlzLmhvdC5yZW5kZXIoKTtcbiAgICB0aGlzLmhvdC52aWV3Lnd0Lnd0T3ZlcmxheXMuYWRqdXN0RWxlbWVudHNTaXplKHRydWUpO1xuICAgIGlmICghcHJpdi5kaXNhbGxvd01vdmluZykge1xuICAgICAgdmFyIHNlbGVjdGlvblN0YXJ0ID0gdGhpcy5jb2x1bW5zTWFwcGVyLmdldEluZGV4QnlWYWx1ZShwcml2LmNvbHVtbnNUb01vdmVbMF0pO1xuICAgICAgdmFyIHNlbGVjdGlvbkVuZCA9IHRoaXMuY29sdW1uc01hcHBlci5nZXRJbmRleEJ5VmFsdWUocHJpdi5jb2x1bW5zVG9Nb3ZlW3ByaXYuY29sdW1uc1RvTW92ZS5sZW5ndGggLSAxXSk7XG4gICAgICB0aGlzLmNoYW5nZVNlbGVjdGlvbihzZWxlY3Rpb25TdGFydCwgc2VsZWN0aW9uRW5kKTtcbiAgICB9XG4gICAgcHJpdi5jb2x1bW5zVG9Nb3ZlLmxlbmd0aCA9IDA7XG4gIH0sXG4gIG9uQWZ0ZXJTY3JvbGxWZXJ0aWNhbGx5OiBmdW5jdGlvbigpIHtcbiAgICB2YXIgd3RUYWJsZSA9IHRoaXMuaG90LnZpZXcud3Qud3RUYWJsZTtcbiAgICB2YXIgaGVhZGVySGVpZ2h0ID0gd3RUYWJsZS5nZXRDb2x1bW5IZWFkZXJIZWlnaHQoMCkgKyAxO1xuICAgIHZhciBzY3JvbGxUb3AgPSB3dFRhYmxlLmhvbGRlci5zY3JvbGxUb3A7XG4gICAgdmFyIHBvc1RvcCA9IGhlYWRlckhlaWdodCArIHNjcm9sbFRvcDtcbiAgICB0aGlzLmJhY2tsaWdodC5zZXRQb3NpdGlvbihwb3NUb3ApO1xuICAgIHRoaXMuYmFja2xpZ2h0LnNldFNpemUobnVsbCwgd3RUYWJsZS5oaWRlci5vZmZzZXRIZWlnaHQgLSBwb3NUb3ApO1xuICB9LFxuICBvbkFmdGVyQ3JlYXRlQ29sOiBmdW5jdGlvbihpbmRleCwgYW1vdW50KSB7XG4gICAgdGhpcy5jb2x1bW5zTWFwcGVyLnNoaWZ0SXRlbXMoaW5kZXgsIGFtb3VudCk7XG4gIH0sXG4gIG9uQmVmb3JlUmVtb3ZlQ29sOiBmdW5jdGlvbihpbmRleCwgYW1vdW50KSB7XG4gICAgdmFyICRfXzEwID0gdGhpcztcbiAgICB0aGlzLnJlbW92ZWRDb2x1bW5zLmxlbmd0aCA9IDA7XG4gICAgaWYgKGluZGV4ICE9PSBmYWxzZSkge1xuICAgICAgcmFuZ2VFYWNoKGluZGV4LCBpbmRleCArIGFtb3VudCAtIDEsIChmdW5jdGlvbihyZW1vdmVkSW5kZXgpIHtcbiAgICAgICAgJF9fMTAucmVtb3ZlZENvbHVtbnMucHVzaCgkX18xMC5ob3QucnVuSG9va3MoJ21vZGlmeUNvbCcsIHJlbW92ZWRJbmRleCwgJF9fMTAucGx1Z2luTmFtZSkpO1xuICAgICAgfSkpO1xuICAgIH1cbiAgfSxcbiAgb25BZnRlclJlbW92ZUNvbDogZnVuY3Rpb24oaW5kZXgsIGFtb3VudCkge1xuICAgIHRoaXMuY29sdW1uc01hcHBlci51bnNoaWZ0SXRlbXModGhpcy5yZW1vdmVkQ29sdW1ucyk7XG4gIH0sXG4gIG9uQWZ0ZXJMb2FkRGF0YTogZnVuY3Rpb24oZmlyc3RUaW1lKSB7XG4gICAgdGhpcy51cGRhdGVDb2x1bW5zTWFwcGVyKCk7XG4gIH0sXG4gIG9uTW9kaWZ5Q29sOiBmdW5jdGlvbihjb2x1bW4sIHNvdXJjZSkge1xuICAgIGlmIChzb3VyY2UgIT09IHRoaXMucGx1Z2luTmFtZSkge1xuICAgICAgdmFyIGNvbHVtbkluTWFwcGVyID0gdGhpcy5jb2x1bW5zTWFwcGVyLmdldFZhbHVlQnlJbmRleChjb2x1bW4pO1xuICAgICAgY29sdW1uID0gY29sdW1uSW5NYXBwZXIgPT09IG51bGwgPyBjb2x1bW4gOiBjb2x1bW5Jbk1hcHBlcjtcbiAgICB9XG4gICAgcmV0dXJuIGNvbHVtbjtcbiAgfSxcbiAgb25Vbm1vZGlmeUNvbDogZnVuY3Rpb24oY29sdW1uKSB7XG4gICAgdmFyIGluZGV4SW5NYXBwZXIgPSB0aGlzLmNvbHVtbnNNYXBwZXIuZ2V0SW5kZXhCeVZhbHVlKGNvbHVtbik7XG4gICAgcmV0dXJuIGluZGV4SW5NYXBwZXIgPT09IG51bGwgPyBjb2x1bW4gOiBpbmRleEluTWFwcGVyO1xuICB9LFxuICBvbkFmdGVyUGx1Z2luc0luaXRpYWxpemVkOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnVwZGF0ZUNvbHVtbnNNYXBwZXIoKTtcbiAgICB0aGlzLmluaXRpYWxTZXR0aW5ncygpO1xuICAgIHRoaXMuYmFja2xpZ2h0LmJ1aWxkKCk7XG4gICAgdGhpcy5ndWlkZWxpbmUuYnVpbGQoKTtcbiAgfSxcbiAgZGVzdHJveTogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5iYWNrbGlnaHQuZGVzdHJveSgpO1xuICAgIHRoaXMuZ3VpZGVsaW5lLmRlc3Ryb3koKTtcbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJE1hbnVhbENvbHVtbk1vdmUucHJvdG90eXBlLCBcImRlc3Ryb3lcIikuY2FsbCh0aGlzKTtcbiAgfVxufSwge30sIEJhc2VQbHVnaW4pO1xuO1xucmVnaXN0ZXJQbHVnaW4oJ01hbnVhbENvbHVtbk1vdmUnLCBNYW51YWxDb2x1bW5Nb3ZlKTtcbkhhbmRzb250YWJsZS5ob29rcy5yZWdpc3RlcignYmVmb3JlQ29sdW1uTW92ZScpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLnJlZ2lzdGVyKCdhZnRlckNvbHVtbk1vdmUnKTtcbkhhbmRzb250YWJsZS5ob29rcy5yZWdpc3RlcigndW5tb2RpZnlDb2wnKTtcblxuLy8jIFxufSx7XCJfYmFzZS5qc1wiOjYyLFwiYnJvd3NlclwiOjI0LFwiY29sdW1uc01hcHBlclwiOjk2LFwiZXZlbnRNYW5hZ2VyXCI6NDIsXCJoZWxwZXJzL2FycmF5XCI6NDMsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJoZWxwZXJzL251bWJlclwiOjUyLFwicGx1Z2luc1wiOjYxLFwidWkvYmFja2xpZ2h0XCI6OTksXCJ1aS9ndWlkZWxpbmVcIjoxMDB9XSw5ODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgQmFzZVVJOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBCYXNlVUk7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX187XG52YXIgaXNOdW1lcmljID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gPSBfZGVyZXFfKFwiaGVscGVycy9udW1iZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX199KS5pc051bWVyaWM7XG52YXIgU1RBVEVfSU5JVElBTElaRUQgPSAwO1xudmFyIFNUQVRFX0JVSUxUID0gMTtcbnZhciBTVEFURV9BUFBFTkRFRCA9IDI7XG52YXIgVU5JVCA9ICdweCc7XG52YXIgQmFzZVVJID0gZnVuY3Rpb24gQmFzZVVJKGhvdEluc3RhbmNlKSB7XG4gIHRoaXMuaG90ID0gaG90SW5zdGFuY2U7XG4gIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICB0aGlzLnN0YXRlID0gU1RBVEVfSU5JVElBTElaRUQ7XG59O1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoQmFzZVVJLCB7XG4gIGFwcGVuZFRvOiBmdW5jdGlvbih3cmFwcGVyKSB7XG4gICAgd3JhcHBlci5hcHBlbmRDaGlsZCh0aGlzLl9lbGVtZW50KTtcbiAgICB0aGlzLnN0YXRlID0gU1RBVEVfQVBQRU5ERUQ7XG4gIH0sXG4gIGJ1aWxkOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdGhpcy5zdGF0ZSA9IFNUQVRFX0JVSUxUO1xuICB9LFxuICBkZXN0cm95OiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5pc0FwcGVuZGVkKCkpIHtcbiAgICAgIHRoaXMuX2VsZW1lbnQucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLl9lbGVtZW50KTtcbiAgICB9XG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XG4gICAgdGhpcy5zdGF0ZSA9IFNUQVRFX0lOSVRJQUxJWkVEO1xuICB9LFxuICBpc0FwcGVuZGVkOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZSA9PT0gU1RBVEVfQVBQRU5ERUQ7XG4gIH0sXG4gIGlzQnVpbHQ6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnN0YXRlID49IFNUQVRFX0JVSUxUO1xuICB9LFxuICBzZXRQb3NpdGlvbjogZnVuY3Rpb24odG9wLCBsZWZ0KSB7XG4gICAgaWYgKGlzTnVtZXJpYyh0b3ApKSB7XG4gICAgICB0aGlzLl9lbGVtZW50LnN0eWxlLnRvcCA9IHRvcCArIFVOSVQ7XG4gICAgfVxuICAgIGlmIChpc051bWVyaWMobGVmdCkpIHtcbiAgICAgIHRoaXMuX2VsZW1lbnQuc3R5bGUubGVmdCA9IGxlZnQgKyBVTklUO1xuICAgIH1cbiAgfSxcbiAgZ2V0UG9zaXRpb246IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICB0b3A6IHRoaXMuX2VsZW1lbnQuc3R5bGUudG9wID8gcGFyc2VJbnQodGhpcy5fZWxlbWVudC5zdHlsZS50b3AsIDEwKSA6IDAsXG4gICAgICBsZWZ0OiB0aGlzLl9lbGVtZW50LnN0eWxlLmxlZnQgPyBwYXJzZUludCh0aGlzLl9lbGVtZW50LnN0eWxlLmxlZnQsIDEwKSA6IDBcbiAgICB9O1xuICB9LFxuICBzZXRTaXplOiBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0KSB7XG4gICAgaWYgKGlzTnVtZXJpYyh3aWR0aCkpIHtcbiAgICAgIHRoaXMuX2VsZW1lbnQuc3R5bGUud2lkdGggPSB3aWR0aCArIFVOSVQ7XG4gICAgfVxuICAgIGlmIChpc051bWVyaWMoaGVpZ2h0KSkge1xuICAgICAgdGhpcy5fZWxlbWVudC5zdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyBVTklUO1xuICAgIH1cbiAgfSxcbiAgZ2V0U2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdpZHRoOiB0aGlzLl9lbGVtZW50LnN0eWxlLndpZHRoID8gcGFyc2VJbnQodGhpcy5fZWxlbWVudC5zdHlsZS53aWR0aCwgMTApIDogMCxcbiAgICAgIGhlaWdodDogdGhpcy5fZWxlbWVudC5zdHlsZS5oZWlnaHQgPyBwYXJzZUludCh0aGlzLl9lbGVtZW50LnN0eWxlLmhlaWdodCwgMTApIDogMFxuICAgIH07XG4gIH0sXG4gIHNldE9mZnNldDogZnVuY3Rpb24odG9wLCBsZWZ0KSB7XG4gICAgaWYgKGlzTnVtZXJpYyh0b3ApKSB7XG4gICAgICB0aGlzLl9lbGVtZW50LnN0eWxlLm1hcmdpblRvcCA9IHRvcCArIFVOSVQ7XG4gICAgfVxuICAgIGlmIChpc051bWVyaWMobGVmdCkpIHtcbiAgICAgIHRoaXMuX2VsZW1lbnQuc3R5bGUubWFyZ2luTGVmdCA9IGxlZnQgKyBVTklUO1xuICAgIH1cbiAgfSxcbiAgZ2V0T2Zmc2V0OiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdG9wOiB0aGlzLl9lbGVtZW50LnN0eWxlLm1hcmdpblRvcCA/IHBhcnNlSW50KHRoaXMuX2VsZW1lbnQuc3R5bGUubWFyZ2luVG9wLCAxMCkgOiAwLFxuICAgICAgbGVmdDogdGhpcy5fZWxlbWVudC5zdHlsZS5tYXJnaW5MZWZ0ID8gcGFyc2VJbnQodGhpcy5fZWxlbWVudC5zdHlsZS5tYXJnaW5MZWZ0LCAxMCkgOiAwXG4gICAgfTtcbiAgfVxufSwge30pO1xuO1xuXG4vLyMgXG59LHtcImhlbHBlcnMvbnVtYmVyXCI6NTJ9XSw5OTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgQmFja2xpZ2h0VUk6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIEJhY2tsaWdodFVJO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fOTVfYmFzZV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXztcbnZhciBCYXNlVUkgPSAoJF9fXzk1X2Jhc2VfXyA9IF9kZXJlcV8oXCJfYmFzZVwiKSwgJF9fXzk1X2Jhc2VfXyAmJiAkX19fOTVfYmFzZV9fLl9fZXNNb2R1bGUgJiYgJF9fXzk1X2Jhc2VfXyB8fCB7ZGVmYXVsdDogJF9fXzk1X2Jhc2VfX30pLkJhc2VVSTtcbnZhciBhZGRDbGFzcyA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSkuYWRkQ2xhc3M7XG52YXIgQ1NTX0NMQVNTTkFNRSA9ICdodF9fbWFudWFsQ29sdW1uTW92ZS0tYmFja2xpZ2h0JztcbnZhciBCYWNrbGlnaHRVSSA9IGZ1bmN0aW9uIEJhY2tsaWdodFVJKGhvdEluc3RhbmNlKSB7XG4gICR0cmFjZXVyUnVudGltZS5zdXBlckNvbnN0cnVjdG9yKCRCYWNrbGlnaHRVSSkuY2FsbCh0aGlzLCBob3RJbnN0YW5jZSk7XG59O1xudmFyICRCYWNrbGlnaHRVSSA9IEJhY2tsaWdodFVJO1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoQmFja2xpZ2h0VUksIHtidWlsZDogZnVuY3Rpb24oKSB7XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICRCYWNrbGlnaHRVSS5wcm90b3R5cGUsIFwiYnVpbGRcIikuY2FsbCh0aGlzKTtcbiAgICBhZGRDbGFzcyh0aGlzLl9lbGVtZW50LCBDU1NfQ0xBU1NOQU1FKTtcbiAgfX0sIHt9LCBCYXNlVUkpO1xuO1xuXG4vLyMgXG59LHtcIl9iYXNlXCI6OTgsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDd9XSwxMDA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIEd1aWRlbGluZVVJOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBHdWlkZWxpbmVVSTtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzk1X2Jhc2VfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X187XG52YXIgQmFzZVVJID0gKCRfX185NV9iYXNlX18gPSBfZGVyZXFfKFwiX2Jhc2VcIiksICRfX185NV9iYXNlX18gJiYgJF9fXzk1X2Jhc2VfXy5fX2VzTW9kdWxlICYmICRfX185NV9iYXNlX18gfHwge2RlZmF1bHQ6ICRfX185NV9iYXNlX199KS5CYXNlVUk7XG52YXIgYWRkQ2xhc3MgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLmFkZENsYXNzO1xudmFyIENTU19DTEFTU05BTUUgPSAnaHRfX21hbnVhbENvbHVtbk1vdmUtLWd1aWRlbGluZSc7XG52YXIgR3VpZGVsaW5lVUkgPSBmdW5jdGlvbiBHdWlkZWxpbmVVSShob3RJbnN0YW5jZSkge1xuICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJDb25zdHJ1Y3RvcigkR3VpZGVsaW5lVUkpLmNhbGwodGhpcywgaG90SW5zdGFuY2UpO1xufTtcbnZhciAkR3VpZGVsaW5lVUkgPSBHdWlkZWxpbmVVSTtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKEd1aWRlbGluZVVJLCB7YnVpbGQ6IGZ1bmN0aW9uKCkge1xuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkR3VpZGVsaW5lVUkucHJvdG90eXBlLCBcImJ1aWxkXCIpLmNhbGwodGhpcyk7XG4gICAgYWRkQ2xhc3ModGhpcy5fZWxlbWVudCwgQ1NTX0NMQVNTTkFNRSk7XG4gIH19LCB7fSwgQmFzZVVJKTtcbjtcblxuLy8jIFxufSx7XCJfYmFzZVwiOjk4LFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3fV0sMTAxOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBNYW51YWxDb2x1bW5SZXNpemU6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIE1hbnVhbENvbHVtblJlc2l6ZTtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X185NV9iYXNlXzQ2X2pzX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fO1xudmFyIEhhbmRzb250YWJsZSA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gPSBfZGVyZXFfKFwiYnJvd3NlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9ffSkuZGVmYXVsdDtcbnZhciBCYXNlUGx1Z2luID0gKCRfX180Nl9fNDZfXzQ3X185NV9iYXNlXzQ2X2pzX18gPSBfZGVyZXFfKFwiX2Jhc2UuanNcIiksICRfX180Nl9fNDZfXzQ3X185NV9iYXNlXzQ2X2pzX18gJiYgJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfNDZfanNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X185NV9iYXNlXzQ2X2pzX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X185NV9iYXNlXzQ2X2pzX199KS5kZWZhdWx0O1xudmFyICRfXzIgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLFxuICAgIGFkZENsYXNzID0gJF9fMi5hZGRDbGFzcyxcbiAgICBoYXNDbGFzcyA9ICRfXzIuaGFzQ2xhc3MsXG4gICAgcmVtb3ZlQ2xhc3MgPSAkX18yLnJlbW92ZUNsYXNzLFxuICAgIG91dGVySGVpZ2h0ID0gJF9fMi5vdXRlckhlaWdodDtcbnZhciBldmVudE1hbmFnZXJPYmplY3QgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gPSBfZGVyZXFfKFwiZXZlbnRNYW5hZ2VyXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfX30pLmV2ZW50TWFuYWdlcjtcbnZhciAkX180ID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZXZlbnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X199KSxcbiAgICBwYWdlWCA9ICRfXzQucGFnZVgsXG4gICAgcGFnZVkgPSAkX180LnBhZ2VZO1xudmFyIGFycmF5RWFjaCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gPSBfZGVyZXFfKFwiaGVscGVycy9hcnJheVwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9ffSkuYXJyYXlFYWNoO1xudmFyIHJhbmdlRWFjaCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X251bWJlcl9fID0gX2RlcmVxXyhcImhlbHBlcnMvbnVtYmVyXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X251bWJlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X251bWJlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X251bWJlcl9ffSkucmFuZ2VFYWNoO1xudmFyIHJlZ2lzdGVyUGx1Z2luID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyA9IF9kZXJlcV8oXCJwbHVnaW5zXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX199KS5yZWdpc3RlclBsdWdpbjtcbnZhciBNYW51YWxDb2x1bW5SZXNpemUgPSBmdW5jdGlvbiBNYW51YWxDb2x1bW5SZXNpemUoaG90SW5zdGFuY2UpIHtcbiAgJHRyYWNldXJSdW50aW1lLnN1cGVyQ29uc3RydWN0b3IoJE1hbnVhbENvbHVtblJlc2l6ZSkuY2FsbCh0aGlzLCBob3RJbnN0YW5jZSk7XG4gIHRoaXMuY3VycmVudFRIID0gbnVsbDtcbiAgdGhpcy5jdXJyZW50Q29sID0gbnVsbDtcbiAgdGhpcy5zZWxlY3RlZENvbHMgPSBbXTtcbiAgdGhpcy5jdXJyZW50V2lkdGggPSBudWxsO1xuICB0aGlzLm5ld1NpemUgPSBudWxsO1xuICB0aGlzLnN0YXJ0WSA9IG51bGw7XG4gIHRoaXMuc3RhcnRXaWR0aCA9IG51bGw7XG4gIHRoaXMuc3RhcnRPZmZzZXQgPSBudWxsO1xuICB0aGlzLmhhbmRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xuICB0aGlzLmd1aWRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnRElWJyk7XG4gIHRoaXMuZXZlbnRNYW5hZ2VyID0gZXZlbnRNYW5hZ2VyT2JqZWN0KHRoaXMpO1xuICB0aGlzLnByZXNzZWQgPSBudWxsO1xuICB0aGlzLmRibGNsaWNrID0gMDtcbiAgdGhpcy5hdXRvcmVzaXplVGltZW91dCA9IG51bGw7XG4gIHRoaXMubWFudWFsQ29sdW1uV2lkdGhzID0gW107XG4gIGFkZENsYXNzKHRoaXMuaGFuZGxlLCAnbWFudWFsQ29sdW1uUmVzaXplcicpO1xuICBhZGRDbGFzcyh0aGlzLmd1aWRlLCAnbWFudWFsQ29sdW1uUmVzaXplckd1aWRlJyk7XG59O1xudmFyICRNYW51YWxDb2x1bW5SZXNpemUgPSBNYW51YWxDb2x1bW5SZXNpemU7XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShNYW51YWxDb2x1bW5SZXNpemUsIHtcbiAgaXNFbmFibGVkOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5ob3QuZ2V0U2V0dGluZ3MoKS5tYW51YWxDb2x1bW5SZXNpemU7XG4gIH0sXG4gIGVuYWJsZVBsdWdpbjogZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzggPSB0aGlzO1xuICAgIGlmICh0aGlzLmVuYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5tYW51YWxDb2x1bW5XaWR0aHMgPSBbXTtcbiAgICB2YXIgaW5pdGlhbENvbHVtbldpZHRoID0gdGhpcy5ob3QuZ2V0U2V0dGluZ3MoKS5tYW51YWxDb2x1bW5SZXNpemU7XG4gICAgdmFyIGxvYWRlZE1hbnVhbENvbHVtbldpZHRocyA9IHRoaXMubG9hZE1hbnVhbENvbHVtbldpZHRocygpO1xuICAgIHRoaXMuYWRkSG9vaygnbW9kaWZ5Q29sV2lkdGgnLCAoZnVuY3Rpb24od2lkdGgsIGNvbCkge1xuICAgICAgcmV0dXJuICRfXzgub25Nb2RpZnlDb2xXaWR0aCh3aWR0aCwgY29sKTtcbiAgICB9KSk7XG4gICAgdGhpcy5hZGRIb29rKCdiZWZvcmVTdHJldGNoaW5nQ29sdW1uV2lkdGgnLCAoZnVuY3Rpb24oc3RyZXRjaGVkV2lkdGgsIGNvbHVtbikge1xuICAgICAgcmV0dXJuICRfXzgub25CZWZvcmVTdHJldGNoaW5nQ29sdW1uV2lkdGgoc3RyZXRjaGVkV2lkdGgsIGNvbHVtbik7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygnYmVmb3JlQ29sdW1uUmVzaXplJywgKGZ1bmN0aW9uKGN1cnJlbnRDb2x1bW4sIG5ld1NpemUsIGlzRG91YmxlQ2xpY2spIHtcbiAgICAgIHJldHVybiAkX184Lm9uQmVmb3JlQ29sdW1uUmVzaXplKGN1cnJlbnRDb2x1bW4sIG5ld1NpemUsIGlzRG91YmxlQ2xpY2spO1xuICAgIH0pKTtcbiAgICBpZiAodHlwZW9mIGxvYWRlZE1hbnVhbENvbHVtbldpZHRocyAhPSAndW5kZWZpbmVkJykge1xuICAgICAgdGhpcy5tYW51YWxDb2x1bW5XaWR0aHMgPSBsb2FkZWRNYW51YWxDb2x1bW5XaWR0aHM7XG4gICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGluaXRpYWxDb2x1bW5XaWR0aCkpIHtcbiAgICAgIHRoaXMubWFudWFsQ29sdW1uV2lkdGhzID0gaW5pdGlhbENvbHVtbldpZHRoO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm1hbnVhbENvbHVtbldpZHRocyA9IFtdO1xuICAgIH1cbiAgICBIYW5kc29udGFibGUuaG9va3MucmVnaXN0ZXIoJ2JlZm9yZUNvbHVtblJlc2l6ZScpO1xuICAgIEhhbmRzb250YWJsZS5ob29rcy5yZWdpc3RlcignYWZ0ZXJDb2x1bW5SZXNpemUnKTtcbiAgICB0aGlzLmJpbmRFdmVudHMoKTtcbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJE1hbnVhbENvbHVtblJlc2l6ZS5wcm90b3R5cGUsIFwiZW5hYmxlUGx1Z2luXCIpLmNhbGwodGhpcyk7XG4gIH0sXG4gIHVwZGF0ZVBsdWdpbjogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGluaXRpYWxDb2x1bW5XaWR0aCA9IHRoaXMuaG90LmdldFNldHRpbmdzKCkubWFudWFsQ29sdW1uUmVzaXplO1xuICAgIGlmIChBcnJheS5pc0FycmF5KGluaXRpYWxDb2x1bW5XaWR0aCkpIHtcbiAgICAgIHRoaXMubWFudWFsQ29sdW1uV2lkdGhzID0gaW5pdGlhbENvbHVtbldpZHRoO1xuICAgIH0gZWxzZSBpZiAoIWluaXRpYWxDb2x1bW5XaWR0aCkge1xuICAgICAgdGhpcy5tYW51YWxDb2x1bW5XaWR0aHMgPSBbXTtcbiAgICB9XG4gIH0sXG4gIGRpc2FibGVQbHVnaW46IGZ1bmN0aW9uKCkge1xuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkTWFudWFsQ29sdW1uUmVzaXplLnByb3RvdHlwZSwgXCJkaXNhYmxlUGx1Z2luXCIpLmNhbGwodGhpcyk7XG4gIH0sXG4gIHNhdmVNYW51YWxDb2x1bW5XaWR0aHM6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaG90LnJ1bkhvb2tzKCdwZXJzaXN0ZW50U3RhdGVTYXZlJywgJ21hbnVhbENvbHVtbldpZHRocycsIHRoaXMubWFudWFsQ29sdW1uV2lkdGhzKTtcbiAgfSxcbiAgbG9hZE1hbnVhbENvbHVtbldpZHRoczogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHN0b3JlZFN0YXRlID0ge307XG4gICAgdGhpcy5ob3QucnVuSG9va3MoJ3BlcnNpc3RlbnRTdGF0ZUxvYWQnLCAnbWFudWFsQ29sdW1uV2lkdGhzJywgc3RvcmVkU3RhdGUpO1xuICAgIHJldHVybiBzdG9yZWRTdGF0ZS52YWx1ZTtcbiAgfSxcbiAgc2V0dXBIYW5kbGVQb3NpdGlvbjogZnVuY3Rpb24oVEgpIHtcbiAgICB2YXIgJF9fOCA9IHRoaXM7XG4gICAgaWYgKCFUSC5wYXJlbnROb2RlKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHRoaXMuY3VycmVudFRIID0gVEg7XG4gICAgdmFyIGNvbCA9IHRoaXMuaG90LnZpZXcud3Qud3RUYWJsZS5nZXRDb29yZHMoVEgpLmNvbDtcbiAgICB2YXIgaGVhZGVySGVpZ2h0ID0gb3V0ZXJIZWlnaHQodGhpcy5jdXJyZW50VEgpO1xuICAgIGlmIChjb2wgPj0gMCkge1xuICAgICAgdmFyIGJveCA9IHRoaXMuY3VycmVudFRILmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgdGhpcy5jdXJyZW50Q29sID0gY29sO1xuICAgICAgdGhpcy5zZWxlY3RlZENvbHMgPSBbXTtcbiAgICAgIGlmICh0aGlzLmhvdC5zZWxlY3Rpb24uaXNTZWxlY3RlZCgpICYmIHRoaXMuaG90LnNlbGVjdGlvbi5zZWxlY3RlZEhlYWRlci5jb2xzKSB7XG4gICAgICAgIHZhciAkX18xMCA9IHRoaXMuaG90LmdldFNlbGVjdGVkUmFuZ2UoKSxcbiAgICAgICAgICAgIGZyb20gPSAkX18xMC5mcm9tLFxuICAgICAgICAgICAgdG8gPSAkX18xMC50bztcbiAgICAgICAgdmFyIHN0YXJ0ID0gZnJvbS5jb2w7XG4gICAgICAgIHZhciBlbmQgPSB0by5jb2w7XG4gICAgICAgIGlmIChzdGFydCA+PSBlbmQpIHtcbiAgICAgICAgICBzdGFydCA9IHRvLmNvbDtcbiAgICAgICAgICBlbmQgPSBmcm9tLmNvbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jdXJyZW50Q29sID49IHN0YXJ0ICYmIHRoaXMuY3VycmVudENvbCA8PSBlbmQpIHtcbiAgICAgICAgICByYW5nZUVhY2goc3RhcnQsIGVuZCwgKGZ1bmN0aW9uKGkpIHtcbiAgICAgICAgICAgIHJldHVybiAkX184LnNlbGVjdGVkQ29scy5wdXNoKGkpO1xuICAgICAgICAgIH0pKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnNlbGVjdGVkQ29scy5wdXNoKHRoaXMuY3VycmVudENvbCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRDb2xzLnB1c2godGhpcy5jdXJyZW50Q29sKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuc3RhcnRPZmZzZXQgPSBib3gubGVmdCAtIDY7XG4gICAgICB0aGlzLnN0YXJ0V2lkdGggPSBwYXJzZUludChib3gud2lkdGgsIDEwKTtcbiAgICAgIHRoaXMuaGFuZGxlLnN0eWxlLnRvcCA9IGJveC50b3AgKyAncHgnO1xuICAgICAgdGhpcy5oYW5kbGUuc3R5bGUubGVmdCA9IHRoaXMuc3RhcnRPZmZzZXQgKyB0aGlzLnN0YXJ0V2lkdGggKyAncHgnO1xuICAgICAgdGhpcy5oYW5kbGUuc3R5bGUuaGVpZ2h0ID0gaGVhZGVySGVpZ2h0ICsgJ3B4JztcbiAgICAgIHRoaXMuaG90LnJvb3RFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuaGFuZGxlKTtcbiAgICB9XG4gIH0sXG4gIHJlZnJlc2hIYW5kbGVQb3NpdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5oYW5kbGUuc3R5bGUubGVmdCA9IHRoaXMuc3RhcnRPZmZzZXQgKyB0aGlzLmN1cnJlbnRXaWR0aCArICdweCc7XG4gIH0sXG4gIHNldHVwR3VpZGVQb3NpdGlvbjogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGhhbmRsZUhlaWdodCA9IHBhcnNlSW50KG91dGVySGVpZ2h0KHRoaXMuaGFuZGxlKSwgMTApO1xuICAgIHZhciBoYW5kbGVCb3R0b21Qb3NpdGlvbiA9IHBhcnNlSW50KHRoaXMuaGFuZGxlLnN0eWxlLnRvcCwgMTApICsgaGFuZGxlSGVpZ2h0O1xuICAgIHZhciBtYXhpbXVtVmlzaWJsZUVsZW1lbnRIZWlnaHQgPSBwYXJzZUludCh0aGlzLmhvdC52aWV3Lm1heGltdW1WaXNpYmxlRWxlbWVudEhlaWdodCgwKSwgMTApO1xuICAgIGFkZENsYXNzKHRoaXMuaGFuZGxlLCAnYWN0aXZlJyk7XG4gICAgYWRkQ2xhc3ModGhpcy5ndWlkZSwgJ2FjdGl2ZScpO1xuICAgIHRoaXMuZ3VpZGUuc3R5bGUudG9wID0gaGFuZGxlQm90dG9tUG9zaXRpb24gKyAncHgnO1xuICAgIHRoaXMuZ3VpZGUuc3R5bGUubGVmdCA9IHRoaXMuaGFuZGxlLnN0eWxlLmxlZnQ7XG4gICAgdGhpcy5ndWlkZS5zdHlsZS5oZWlnaHQgPSAobWF4aW11bVZpc2libGVFbGVtZW50SGVpZ2h0IC0gaGFuZGxlSGVpZ2h0KSArICdweCc7XG4gICAgdGhpcy5ob3Qucm9vdEVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5ndWlkZSk7XG4gIH0sXG4gIHJlZnJlc2hHdWlkZVBvc2l0aW9uOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmd1aWRlLnN0eWxlLmxlZnQgPSB0aGlzLmhhbmRsZS5zdHlsZS5sZWZ0O1xuICB9LFxuICBoaWRlSGFuZGxlQW5kR3VpZGU6IGZ1bmN0aW9uKCkge1xuICAgIHJlbW92ZUNsYXNzKHRoaXMuaGFuZGxlLCAnYWN0aXZlJyk7XG4gICAgcmVtb3ZlQ2xhc3ModGhpcy5ndWlkZSwgJ2FjdGl2ZScpO1xuICB9LFxuICBjaGVja0lmQ29sdW1uSGVhZGVyOiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgaWYgKGVsZW1lbnQgIT0gdGhpcy5ob3Qucm9vdEVsZW1lbnQpIHtcbiAgICAgIHZhciBwYXJlbnQgPSBlbGVtZW50LnBhcmVudE5vZGU7XG4gICAgICBpZiAocGFyZW50LnRhZ05hbWUgPT09ICdUSEVBRCcpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5jaGVja0lmQ29sdW1uSGVhZGVyKHBhcmVudCk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfSxcbiAgZ2V0VEhGcm9tVGFyZ2V0RWxlbWVudDogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIGlmIChlbGVtZW50LnRhZ05hbWUgIT0gJ1RBQkxFJykge1xuICAgICAgaWYgKGVsZW1lbnQudGFnTmFtZSA9PSAnVEgnKSB7XG4gICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VEhGcm9tVGFyZ2V0RWxlbWVudChlbGVtZW50LnBhcmVudE5vZGUpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfSxcbiAgb25Nb3VzZU92ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKHRoaXMuY2hlY2tJZkNvbHVtbkhlYWRlcihldmVudC50YXJnZXQpKSB7XG4gICAgICB2YXIgdGggPSB0aGlzLmdldFRIRnJvbVRhcmdldEVsZW1lbnQoZXZlbnQudGFyZ2V0KTtcbiAgICAgIGlmICghdGgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIGNvbHNwYW4gPSB0aC5nZXRBdHRyaWJ1dGUoJ2NvbHNwYW4nKTtcbiAgICAgIGlmICh0aCAmJiAoY29sc3BhbiA9PT0gbnVsbCB8fCBjb2xzcGFuID09PSAxKSkge1xuICAgICAgICBpZiAoIXRoaXMucHJlc3NlZCkge1xuICAgICAgICAgIHRoaXMuc2V0dXBIYW5kbGVQb3NpdGlvbih0aCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFmdGVyTW91c2VEb3duVGltZW91dDogZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzggPSB0aGlzO1xuICAgIHZhciByZW5kZXIgPSAoZnVuY3Rpb24oKSB7XG4gICAgICAkX184LmhvdC5mb3JjZUZ1bGxSZW5kZXIgPSB0cnVlO1xuICAgICAgJF9fOC5ob3Qudmlldy5yZW5kZXIoKTtcbiAgICAgICRfXzguaG90LnZpZXcud3Qud3RPdmVybGF5cy5hZGp1c3RFbGVtZW50c1NpemUodHJ1ZSk7XG4gICAgfSk7XG4gICAgdmFyIHJlc2l6ZSA9IChmdW5jdGlvbihzZWxlY3RlZENvbCwgZm9yY2VSZW5kZXIpIHtcbiAgICAgIHZhciBob29rTmV3U2l6ZSA9ICRfXzguaG90LnJ1bkhvb2tzKCdiZWZvcmVDb2x1bW5SZXNpemUnLCBzZWxlY3RlZENvbCwgJF9fOC5uZXdTaXplLCB0cnVlKTtcbiAgICAgIGlmIChob29rTmV3U2l6ZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgICRfXzgubmV3U2l6ZSA9IGhvb2tOZXdTaXplO1xuICAgICAgfVxuICAgICAgaWYgKCRfXzguaG90LmdldFNldHRpbmdzKCkuc3RyZXRjaEggPT09ICdhbGwnKSB7XG4gICAgICAgICRfXzguY2xlYXJNYW51YWxTaXplKHNlbGVjdGVkQ29sKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRfXzguc2V0TWFudWFsU2l6ZShzZWxlY3RlZENvbCwgJF9fOC5uZXdTaXplKTtcbiAgICAgIH1cbiAgICAgIGlmIChmb3JjZVJlbmRlcikge1xuICAgICAgICByZW5kZXIoKTtcbiAgICAgIH1cbiAgICAgICRfXzguc2F2ZU1hbnVhbENvbHVtbldpZHRocygpO1xuICAgICAgJF9fOC5ob3QucnVuSG9va3MoJ2FmdGVyQ29sdW1uUmVzaXplJywgc2VsZWN0ZWRDb2wsICRfXzgubmV3U2l6ZSwgdHJ1ZSk7XG4gICAgfSk7XG4gICAgaWYgKHRoaXMuZGJsY2xpY2sgPj0gMikge1xuICAgICAgdmFyIHNlbGVjdGVkQ29sc0xlbmd0aCA9IHRoaXMuc2VsZWN0ZWRDb2xzLmxlbmd0aDtcbiAgICAgIGlmIChzZWxlY3RlZENvbHNMZW5ndGggPiAxKSB7XG4gICAgICAgIGFycmF5RWFjaCh0aGlzLnNlbGVjdGVkQ29scywgKGZ1bmN0aW9uKHNlbGVjdGVkQ29sKSB7XG4gICAgICAgICAgcmVzaXplKHNlbGVjdGVkQ29sKTtcbiAgICAgICAgfSkpO1xuICAgICAgICByZW5kZXIoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFycmF5RWFjaCh0aGlzLnNlbGVjdGVkQ29scywgKGZ1bmN0aW9uKHNlbGVjdGVkQ29sKSB7XG4gICAgICAgICAgcmVzaXplKHNlbGVjdGVkQ29sLCB0cnVlKTtcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmRibGNsaWNrID0gMDtcbiAgICB0aGlzLmF1dG9yZXNpemVUaW1lb3V0ID0gbnVsbDtcbiAgfSxcbiAgb25Nb3VzZURvd246IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyICRfXzggPSB0aGlzO1xuICAgIGlmIChoYXNDbGFzcyhldmVudC50YXJnZXQsICdtYW51YWxDb2x1bW5SZXNpemVyJykpIHtcbiAgICAgIHRoaXMuc2V0dXBHdWlkZVBvc2l0aW9uKCk7XG4gICAgICB0aGlzLnByZXNzZWQgPSB0aGlzLmhvdDtcbiAgICAgIGlmICh0aGlzLmF1dG9yZXNpemVUaW1lb3V0ID09PSBudWxsKSB7XG4gICAgICAgIHRoaXMuYXV0b3Jlc2l6ZVRpbWVvdXQgPSBzZXRUaW1lb3V0KChmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gJF9fOC5hZnRlck1vdXNlRG93blRpbWVvdXQoKTtcbiAgICAgICAgfSksIDUwMCk7XG4gICAgICAgIHRoaXMuaG90Ll9yZWdpc3RlclRpbWVvdXQodGhpcy5hdXRvcmVzaXplVGltZW91dCk7XG4gICAgICB9XG4gICAgICB0aGlzLmRibGNsaWNrKys7XG4gICAgICB0aGlzLnN0YXJ0WCA9IHBhZ2VYKGV2ZW50KTtcbiAgICAgIHRoaXMubmV3U2l6ZSA9IHRoaXMuc3RhcnRXaWR0aDtcbiAgICB9XG4gIH0sXG4gIG9uTW91c2VNb3ZlOiBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciAkX184ID0gdGhpcztcbiAgICBpZiAodGhpcy5wcmVzc2VkKSB7XG4gICAgICB0aGlzLmN1cnJlbnRXaWR0aCA9IHRoaXMuc3RhcnRXaWR0aCArIChwYWdlWChldmVudCkgLSB0aGlzLnN0YXJ0WCk7XG4gICAgICBhcnJheUVhY2godGhpcy5zZWxlY3RlZENvbHMsIChmdW5jdGlvbihzZWxlY3RlZENvbCkge1xuICAgICAgICAkX184Lm5ld1NpemUgPSAkX184LnNldE1hbnVhbFNpemUoc2VsZWN0ZWRDb2wsICRfXzguY3VycmVudFdpZHRoKTtcbiAgICAgIH0pKTtcbiAgICAgIHRoaXMucmVmcmVzaEhhbmRsZVBvc2l0aW9uKCk7XG4gICAgICB0aGlzLnJlZnJlc2hHdWlkZVBvc2l0aW9uKCk7XG4gICAgfVxuICB9LFxuICBvbk1vdXNlVXA6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyICRfXzggPSB0aGlzO1xuICAgIHZhciByZW5kZXIgPSAoZnVuY3Rpb24oKSB7XG4gICAgICAkX184LmhvdC5mb3JjZUZ1bGxSZW5kZXIgPSB0cnVlO1xuICAgICAgJF9fOC5ob3Qudmlldy5yZW5kZXIoKTtcbiAgICAgICRfXzguaG90LnZpZXcud3Qud3RPdmVybGF5cy5hZGp1c3RFbGVtZW50c1NpemUodHJ1ZSk7XG4gICAgfSk7XG4gICAgdmFyIHJlc2l6ZSA9IChmdW5jdGlvbihzZWxlY3RlZENvbCwgZm9yY2VSZW5kZXIpIHtcbiAgICAgICRfXzguaG90LnJ1bkhvb2tzKCdiZWZvcmVDb2x1bW5SZXNpemUnLCBzZWxlY3RlZENvbCwgJF9fOC5uZXdTaXplKTtcbiAgICAgIGlmIChmb3JjZVJlbmRlcikge1xuICAgICAgICByZW5kZXIoKTtcbiAgICAgIH1cbiAgICAgICRfXzguc2F2ZU1hbnVhbENvbHVtbldpZHRocygpO1xuICAgICAgJF9fOC5ob3QucnVuSG9va3MoJ2FmdGVyQ29sdW1uUmVzaXplJywgc2VsZWN0ZWRDb2wsICRfXzgubmV3U2l6ZSk7XG4gICAgfSk7XG4gICAgaWYgKHRoaXMucHJlc3NlZCkge1xuICAgICAgdGhpcy5oaWRlSGFuZGxlQW5kR3VpZGUoKTtcbiAgICAgIHRoaXMucHJlc3NlZCA9IGZhbHNlO1xuICAgICAgaWYgKHRoaXMubmV3U2l6ZSAhPSB0aGlzLnN0YXJ0V2lkdGgpIHtcbiAgICAgICAgdmFyIHNlbGVjdGVkQ29sc0xlbmd0aCA9IHRoaXMuc2VsZWN0ZWRDb2xzLmxlbmd0aDtcbiAgICAgICAgaWYgKHNlbGVjdGVkQ29sc0xlbmd0aCA+IDEpIHtcbiAgICAgICAgICBhcnJheUVhY2godGhpcy5zZWxlY3RlZENvbHMsIChmdW5jdGlvbihzZWxlY3RlZENvbCkge1xuICAgICAgICAgICAgcmVzaXplKHNlbGVjdGVkQ29sKTtcbiAgICAgICAgICB9KSk7XG4gICAgICAgICAgcmVuZGVyKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXJyYXlFYWNoKHRoaXMuc2VsZWN0ZWRDb2xzLCAoZnVuY3Rpb24oc2VsZWN0ZWRDb2wpIHtcbiAgICAgICAgICAgIHJlc2l6ZShzZWxlY3RlZENvbCwgdHJ1ZSk7XG4gICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLnNldHVwSGFuZGxlUG9zaXRpb24odGhpcy5jdXJyZW50VEgpO1xuICAgIH1cbiAgfSxcbiAgYmluZEV2ZW50czogZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzggPSB0aGlzO1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5ob3Qucm9vdEVsZW1lbnQsICdtb3VzZW92ZXInLCAoZnVuY3Rpb24oZSkge1xuICAgICAgcmV0dXJuICRfXzgub25Nb3VzZU92ZXIoZSk7XG4gICAgfSkpO1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5ob3Qucm9vdEVsZW1lbnQsICdtb3VzZWRvd24nLCAoZnVuY3Rpb24oZSkge1xuICAgICAgcmV0dXJuICRfXzgub25Nb3VzZURvd24oZSk7XG4gICAgfSkpO1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIod2luZG93LCAnbW91c2Vtb3ZlJywgKGZ1bmN0aW9uKGUpIHtcbiAgICAgIHJldHVybiAkX184Lm9uTW91c2VNb3ZlKGUpO1xuICAgIH0pKTtcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKHdpbmRvdywgJ21vdXNldXAnLCAoZnVuY3Rpb24oZSkge1xuICAgICAgcmV0dXJuICRfXzgub25Nb3VzZVVwKGUpO1xuICAgIH0pKTtcbiAgfSxcbiAgc2V0TWFudWFsU2l6ZTogZnVuY3Rpb24oY29sdW1uLCB3aWR0aCkge1xuICAgIHdpZHRoID0gTWF0aC5tYXgod2lkdGgsIDIwKTtcbiAgICBjb2x1bW4gPSB0aGlzLmhvdC5ydW5Ib29rcygnbW9kaWZ5Q29sJywgY29sdW1uKTtcbiAgICB0aGlzLm1hbnVhbENvbHVtbldpZHRoc1tjb2x1bW5dID0gd2lkdGg7XG4gICAgcmV0dXJuIHdpZHRoO1xuICB9LFxuICBjbGVhck1hbnVhbFNpemU6IGZ1bmN0aW9uKGNvbHVtbikge1xuICAgIGNvbHVtbiA9IHRoaXMuaG90LnJ1bkhvb2tzKCdtb2RpZnlDb2wnLCBjb2x1bW4pO1xuICAgIHRoaXMubWFudWFsQ29sdW1uV2lkdGhzW2NvbHVtbl0gPSB2b2lkIDA7XG4gIH0sXG4gIG9uTW9kaWZ5Q29sV2lkdGg6IGZ1bmN0aW9uKHdpZHRoLCBjb2x1bW4pIHtcbiAgICBpZiAodGhpcy5lbmFibGVkKSB7XG4gICAgICBjb2x1bW4gPSB0aGlzLmhvdC5ydW5Ib29rcygnbW9kaWZ5Q29sJywgY29sdW1uKTtcbiAgICAgIGlmICh0aGlzLmhvdC5nZXRTZXR0aW5ncygpLm1hbnVhbENvbHVtblJlc2l6ZSAmJiB0aGlzLm1hbnVhbENvbHVtbldpZHRoc1tjb2x1bW5dKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1hbnVhbENvbHVtbldpZHRoc1tjb2x1bW5dO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gd2lkdGg7XG4gIH0sXG4gIG9uQmVmb3JlU3RyZXRjaGluZ0NvbHVtbldpZHRoOiBmdW5jdGlvbihzdHJldGNoZWRXaWR0aCwgY29sdW1uKSB7XG4gICAgdmFyIHdpZHRoID0gdGhpcy5tYW51YWxDb2x1bW5XaWR0aHNbY29sdW1uXTtcbiAgICBpZiAod2lkdGggPT09IHZvaWQgMCkge1xuICAgICAgd2lkdGggPSBzdHJldGNoZWRXaWR0aDtcbiAgICB9XG4gICAgcmV0dXJuIHdpZHRoO1xuICB9LFxuICBvbkJlZm9yZUNvbHVtblJlc2l6ZTogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5ob3Qudmlldy53dC53dFZpZXdwb3J0Lmhhc092ZXJzaXplZENvbHVtbkhlYWRlcnNNYXJrZWQgPSB7fTtcbiAgfVxufSwge30sIEJhc2VQbHVnaW4pO1xuO1xucmVnaXN0ZXJQbHVnaW4oJ21hbnVhbENvbHVtblJlc2l6ZScsIE1hbnVhbENvbHVtblJlc2l6ZSk7XG5cbi8vIyBcbn0se1wiX2Jhc2UuanNcIjo2MixcImJyb3dzZXJcIjoyNCxcImV2ZW50TWFuYWdlclwiOjQyLFwiaGVscGVycy9hcnJheVwiOjQzLFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwiaGVscGVycy9kb20vZXZlbnRcIjo0OCxcImhlbHBlcnMvbnVtYmVyXCI6NTIsXCJwbHVnaW5zXCI6NjF9XSwxMDI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIE1hbnVhbFJvd01vdmU6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIE1hbnVhbFJvd01vdmU7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X185NV9iYXNlXzQ2X2pzX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18sXG4gICAgJF9fcm93c01hcHBlcl9fLFxuICAgICRfX3VpXzQ3X2JhY2tsaWdodF9fLFxuICAgICRfX3VpXzQ3X2d1aWRlbGluZV9fO1xudmFyIEJhc2VQbHVnaW4gPSAoJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfNDZfanNfXyA9IF9kZXJlcV8oXCJfYmFzZS5qc1wiKSwgJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfNDZfanNfXyAmJiAkX19fNDZfXzQ2X180N19fOTVfYmFzZV80Nl9qc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfNDZfanNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfNDZfanNfX30pLmRlZmF1bHQ7XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX199KS5kZWZhdWx0O1xudmFyIGFycmF5RWFjaCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gPSBfZGVyZXFfKFwiaGVscGVycy9hcnJheVwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9ffSkuYXJyYXlFYWNoO1xudmFyICRfXzMgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLFxuICAgIGFkZENsYXNzID0gJF9fMy5hZGRDbGFzcyxcbiAgICByZW1vdmVDbGFzcyA9ICRfXzMucmVtb3ZlQ2xhc3MsXG4gICAgb2Zmc2V0ID0gJF9fMy5vZmZzZXQ7XG52YXIgcmFuZ2VFYWNoID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gPSBfZGVyZXFfKFwiaGVscGVycy9udW1iZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX199KS5yYW5nZUVhY2g7XG52YXIgZXZlbnRNYW5hZ2VyT2JqZWN0ID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fID0gX2RlcmVxXyhcImV2ZW50TWFuYWdlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX199KS5ldmVudE1hbmFnZXI7XG52YXIgcmVnaXN0ZXJQbHVnaW4gPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fID0gX2RlcmVxXyhcInBsdWdpbnNcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfX30pLnJlZ2lzdGVyUGx1Z2luO1xudmFyIFJvd3NNYXBwZXIgPSAoJF9fcm93c01hcHBlcl9fID0gX2RlcmVxXyhcInJvd3NNYXBwZXJcIiksICRfX3Jvd3NNYXBwZXJfXyAmJiAkX19yb3dzTWFwcGVyX18uX19lc01vZHVsZSAmJiAkX19yb3dzTWFwcGVyX18gfHwge2RlZmF1bHQ6ICRfX3Jvd3NNYXBwZXJfX30pLlJvd3NNYXBwZXI7XG52YXIgQmFja2xpZ2h0VUkgPSAoJF9fdWlfNDdfYmFja2xpZ2h0X18gPSBfZGVyZXFfKFwidWkvYmFja2xpZ2h0XCIpLCAkX191aV80N19iYWNrbGlnaHRfXyAmJiAkX191aV80N19iYWNrbGlnaHRfXy5fX2VzTW9kdWxlICYmICRfX3VpXzQ3X2JhY2tsaWdodF9fIHx8IHtkZWZhdWx0OiAkX191aV80N19iYWNrbGlnaHRfX30pLkJhY2tsaWdodFVJO1xudmFyIEd1aWRlbGluZVVJID0gKCRfX3VpXzQ3X2d1aWRlbGluZV9fID0gX2RlcmVxXyhcInVpL2d1aWRlbGluZVwiKSwgJF9fdWlfNDdfZ3VpZGVsaW5lX18gJiYgJF9fdWlfNDdfZ3VpZGVsaW5lX18uX19lc01vZHVsZSAmJiAkX191aV80N19ndWlkZWxpbmVfXyB8fCB7ZGVmYXVsdDogJF9fdWlfNDdfZ3VpZGVsaW5lX199KS5HdWlkZWxpbmVVSTtcbnZhciBwcml2YXRlUG9vbCA9IG5ldyBXZWFrTWFwKCk7XG52YXIgQ1NTX1BMVUdJTiA9ICdodF9fbWFudWFsUm93TW92ZSc7XG52YXIgQ1NTX1NIT1dfVUkgPSAnc2hvdy11aSc7XG52YXIgQ1NTX09OX01PVklORyA9ICdvbi1tb3ZpbmctLXJvd3MnO1xudmFyIENTU19BRlRFUl9TRUxFQ1RJT04gPSAnYWZ0ZXItc2VsZWN0aW9uLS1yb3dzJztcbnZhciBNYW51YWxSb3dNb3ZlID0gZnVuY3Rpb24gTWFudWFsUm93TW92ZShob3RJbnN0YW5jZSkge1xuICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJDb25zdHJ1Y3RvcigkTWFudWFsUm93TW92ZSkuY2FsbCh0aGlzLCBob3RJbnN0YW5jZSk7XG4gIHByaXZhdGVQb29sLnNldCh0aGlzLCB7XG4gICAgcm93c1RvTW92ZTogW10sXG4gICAgcHJlc3NlZDogdm9pZCAwLFxuICAgIGRpc2FsbG93TW92aW5nOiB2b2lkIDAsXG4gICAgdGFyZ2V0OiB7XG4gICAgICBldmVudFBhZ2VZOiB2b2lkIDAsXG4gICAgICBjb29yZHM6IHZvaWQgMCxcbiAgICAgIFREOiB2b2lkIDAsXG4gICAgICByb3c6IHZvaWQgMFxuICAgIH1cbiAgfSk7XG4gIHRoaXMucmVtb3ZlZFJvd3MgPSBbXTtcbiAgdGhpcy5yb3dzTWFwcGVyID0gbmV3IFJvd3NNYXBwZXIodGhpcyk7XG4gIHRoaXMuZXZlbnRNYW5hZ2VyID0gZXZlbnRNYW5hZ2VyT2JqZWN0KHRoaXMpO1xuICB0aGlzLmJhY2tsaWdodCA9IG5ldyBCYWNrbGlnaHRVSShob3RJbnN0YW5jZSk7XG4gIHRoaXMuZ3VpZGVsaW5lID0gbmV3IEd1aWRlbGluZVVJKGhvdEluc3RhbmNlKTtcbn07XG52YXIgJE1hbnVhbFJvd01vdmUgPSBNYW51YWxSb3dNb3ZlO1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoTWFudWFsUm93TW92ZSwge1xuICBpc0VuYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAhIXRoaXMuaG90LmdldFNldHRpbmdzKCkubWFudWFsUm93TW92ZTtcbiAgfSxcbiAgZW5hYmxlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fMTAgPSB0aGlzO1xuICAgIGlmICh0aGlzLmVuYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5hZGRIb29rKCdiZWZvcmVPbkNlbGxNb3VzZURvd24nLCAoZnVuY3Rpb24oZXZlbnQsIGNvb3JkcywgVEQsIGJsb2NrQ2FsY3VsYXRpb25zKSB7XG4gICAgICByZXR1cm4gJF9fMTAub25CZWZvcmVPbkNlbGxNb3VzZURvd24oZXZlbnQsIGNvb3JkcywgVEQsIGJsb2NrQ2FsY3VsYXRpb25zKTtcbiAgICB9KSk7XG4gICAgdGhpcy5hZGRIb29rKCdiZWZvcmVPbkNlbGxNb3VzZU92ZXInLCAoZnVuY3Rpb24oZXZlbnQsIGNvb3JkcywgVEQsIGJsb2NrQ2FsY3VsYXRpb25zKSB7XG4gICAgICByZXR1cm4gJF9fMTAub25CZWZvcmVPbkNlbGxNb3VzZU92ZXIoZXZlbnQsIGNvb3JkcywgVEQsIGJsb2NrQ2FsY3VsYXRpb25zKTtcbiAgICB9KSk7XG4gICAgdGhpcy5hZGRIb29rKCdhZnRlclNjcm9sbEhvcml6b250YWxseScsIChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX18xMC5vbkFmdGVyU2Nyb2xsSG9yaXpvbnRhbGx5KCk7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygnbW9kaWZ5Um93JywgKGZ1bmN0aW9uKHJvdywgc291cmNlKSB7XG4gICAgICByZXR1cm4gJF9fMTAub25Nb2RpZnlSb3cocm93LCBzb3VyY2UpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ2JlZm9yZVJlbW92ZVJvdycsIChmdW5jdGlvbihpbmRleCwgYW1vdW50KSB7XG4gICAgICByZXR1cm4gJF9fMTAub25CZWZvcmVSZW1vdmVSb3coaW5kZXgsIGFtb3VudCk7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygnYWZ0ZXJSZW1vdmVSb3cnLCAoZnVuY3Rpb24oaW5kZXgsIGFtb3VudCkge1xuICAgICAgcmV0dXJuICRfXzEwLm9uQWZ0ZXJSZW1vdmVSb3coaW5kZXgsIGFtb3VudCk7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygnYWZ0ZXJDcmVhdGVSb3cnLCAoZnVuY3Rpb24oaW5kZXgsIGFtb3VudCkge1xuICAgICAgcmV0dXJuICRfXzEwLm9uQWZ0ZXJDcmVhdGVSb3coaW5kZXgsIGFtb3VudCk7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygnYWZ0ZXJMb2FkRGF0YScsIChmdW5jdGlvbihmaXJzdFRpbWUpIHtcbiAgICAgIHJldHVybiAkX18xMC5vbkFmdGVyTG9hZERhdGEoZmlyc3RUaW1lKTtcbiAgICB9KSk7XG4gICAgdGhpcy5hZGRIb29rKCdiZWZvcmVDb2x1bW5Tb3J0JywgKGZ1bmN0aW9uKGNvbHVtbiwgb3JkZXIpIHtcbiAgICAgIHJldHVybiAkX18xMC5vbkJlZm9yZUNvbHVtblNvcnQoY29sdW1uLCBvcmRlcik7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygndW5tb2RpZnlSb3cnLCAoZnVuY3Rpb24ocm93KSB7XG4gICAgICByZXR1cm4gJF9fMTAub25Vbm1vZGlmeVJvdyhyb3cpO1xuICAgIH0pKTtcbiAgICB0aGlzLnJlZ2lzdGVyRXZlbnRzKCk7XG4gICAgYWRkQ2xhc3ModGhpcy5ob3Qucm9vdEVsZW1lbnQsIENTU19QTFVHSU4pO1xuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkTWFudWFsUm93TW92ZS5wcm90b3R5cGUsIFwiZW5hYmxlUGx1Z2luXCIpLmNhbGwodGhpcyk7XG4gIH0sXG4gIHVwZGF0ZVBsdWdpbjogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5kaXNhYmxlUGx1Z2luKCk7XG4gICAgdGhpcy5lbmFibGVQbHVnaW4oKTtcbiAgICB0aGlzLm9uQWZ0ZXJQbHVnaW5zSW5pdGlhbGl6ZWQoKTtcbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJE1hbnVhbFJvd01vdmUucHJvdG90eXBlLCBcInVwZGF0ZVBsdWdpblwiKS5jYWxsKHRoaXMpO1xuICB9LFxuICBkaXNhYmxlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgcGx1Z2luU2V0dGluZ3MgPSB0aGlzLmhvdC5nZXRTZXR0aW5ncygpLm1hbnVhbFJvd01vdmU7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkocGx1Z2luU2V0dGluZ3MpKSB7XG4gICAgICB0aGlzLnJvd3NNYXBwZXIuY2xlYXJNYXAoKTtcbiAgICB9XG4gICAgcmVtb3ZlQ2xhc3ModGhpcy5ob3Qucm9vdEVsZW1lbnQsIENTU19QTFVHSU4pO1xuICAgIHRoaXMudW5yZWdpc3RlckV2ZW50cygpO1xuICAgIHRoaXMuYmFja2xpZ2h0LmRlc3Ryb3koKTtcbiAgICB0aGlzLmd1aWRlbGluZS5kZXN0cm95KCk7XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICRNYW51YWxSb3dNb3ZlLnByb3RvdHlwZSwgXCJkaXNhYmxlUGx1Z2luXCIpLmNhbGwodGhpcyk7XG4gIH0sXG4gIG1vdmVSb3c6IGZ1bmN0aW9uKHJvdywgdGFyZ2V0KSB7XG4gICAgdGhpcy5tb3ZlUm93cyhbcm93XSwgdGFyZ2V0KTtcbiAgfSxcbiAgbW92ZVJvd3M6IGZ1bmN0aW9uKHJvd3MsIHRhcmdldCkge1xuICAgIHZhciAkX18xMCA9IHRoaXM7XG4gICAgdmFyIHByaXYgPSBwcml2YXRlUG9vbC5nZXQodGhpcyk7XG4gICAgdmFyIGJlZm9yZU1vdmVIb29rID0gdGhpcy5ob3QucnVuSG9va3MoJ2JlZm9yZVJvd01vdmUnLCByb3dzLCB0YXJnZXQpO1xuICAgIHByaXYuZGlzYWxsb3dNb3ZpbmcgPSBiZWZvcmVNb3ZlSG9vayA9PT0gZmFsc2U7XG4gICAgaWYgKCFwcml2LmRpc2FsbG93TW92aW5nKSB7XG4gICAgICBhcnJheUVhY2gocm93cywgKGZ1bmN0aW9uKHJvdywgaW5kZXgsIGFycmF5KSB7XG4gICAgICAgIGFycmF5W2luZGV4XSA9ICRfXzEwLnJvd3NNYXBwZXIuZ2V0VmFsdWVCeUluZGV4KHJvdyk7XG4gICAgICB9KSk7XG4gICAgICBhcnJheUVhY2gocm93cywgKGZ1bmN0aW9uKHJvdywgaW5kZXgpIHtcbiAgICAgICAgdmFyIGFjdHVhbFBvc2l0aW9uID0gJF9fMTAucm93c01hcHBlci5nZXRJbmRleEJ5VmFsdWUocm93KTtcbiAgICAgICAgaWYgKGFjdHVhbFBvc2l0aW9uICE9PSB0YXJnZXQpIHtcbiAgICAgICAgICAkX18xMC5yb3dzTWFwcGVyLm1vdmVSb3coYWN0dWFsUG9zaXRpb24sIHRhcmdldCArIGluZGV4KTtcbiAgICAgICAgfVxuICAgICAgfSkpO1xuICAgICAgdGhpcy5yb3dzTWFwcGVyLmNsZWFyTnVsbCgpO1xuICAgIH1cbiAgICB0aGlzLmhvdC5ydW5Ib29rcygnYWZ0ZXJSb3dNb3ZlJywgcm93cywgdGFyZ2V0KTtcbiAgfSxcbiAgY2hhbmdlU2VsZWN0aW9uOiBmdW5jdGlvbihzdGFydFJvdywgZW5kUm93KSB7XG4gICAgdmFyIHNlbGVjdGlvbiA9IHRoaXMuaG90LnNlbGVjdGlvbjtcbiAgICB2YXIgbGFzdENvbEluZGV4ID0gdGhpcy5ob3QuY291bnRDb2xzKCkgLSAxO1xuICAgIHNlbGVjdGlvbi5zZXRSYW5nZVN0YXJ0T25seShuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHN0YXJ0Um93LCAwKSk7XG4gICAgc2VsZWN0aW9uLnNldFJhbmdlRW5kKG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoZW5kUm93LCBsYXN0Q29sSW5kZXgpLCBmYWxzZSk7XG4gIH0sXG4gIGdldFJvd3NIZWlnaHQ6IGZ1bmN0aW9uKGZyb20sIHRvKSB7XG4gICAgdmFyIGhlaWdodCA9IDA7XG4gICAgZm9yICh2YXIgaSA9IGZyb207IGkgPCB0bzsgaSsrKSB7XG4gICAgICB2YXIgcm93SGVpZ2h0ID0gdGhpcy5ob3Qudmlldy53dC53dFRhYmxlLmdldFJvd0hlaWdodChpKSB8fCAyMztcbiAgICAgIGhlaWdodCArPSByb3dIZWlnaHQ7XG4gICAgfVxuICAgIHJldHVybiBoZWlnaHQ7XG4gIH0sXG4gIGluaXRpYWxTZXR0aW5nczogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHBsdWdpblNldHRpbmdzID0gdGhpcy5ob3QuZ2V0U2V0dGluZ3MoKS5tYW51YWxSb3dNb3ZlO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHBsdWdpblNldHRpbmdzKSkge1xuICAgICAgdGhpcy5tb3ZlUm93cyhwbHVnaW5TZXR0aW5ncywgMCk7XG4gICAgfSBlbHNlIGlmIChwbHVnaW5TZXR0aW5ncyAhPT0gdm9pZCAwKSB7XG4gICAgICB2YXIgcGVyc2lzdGVudFN0YXRlID0gdGhpcy5wZXJzaXN0ZW50U3RhdGVMb2FkKCk7XG4gICAgICBpZiAocGVyc2lzdGVudFN0YXRlLmxlbmd0aCkge1xuICAgICAgICB0aGlzLm1vdmVSb3dzKHBlcnNpc3RlbnRTdGF0ZSwgMCk7XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBpc0ZpeGVkUm93VG9wOiBmdW5jdGlvbihyb3cpIHtcbiAgICByZXR1cm4gcm93IDwgdGhpcy5ob3QuZ2V0U2V0dGluZ3MoKS5maXhlZFJvd3NUb3A7XG4gIH0sXG4gIGlzRml4ZWRSb3dCb3R0b206IGZ1bmN0aW9uKHJvdykge1xuICAgIHJldHVybiByb3cgPiB0aGlzLmhvdC5nZXRTZXR0aW5ncygpLmZpeGVkUm93c0JvdHRvbTtcbiAgfSxcbiAgcGVyc2lzdGVudFN0YXRlU2F2ZTogZnVuY3Rpb24oKSB7XG4gICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bih0aGlzLmhvdCwgJ3BlcnNpc3RlbnRTdGF0ZVNhdmUnLCAnbWFudWFsUm93TW92ZScsIHRoaXMucm93c01hcHBlci5fYXJyYXlNYXApO1xuICB9LFxuICBwZXJzaXN0ZW50U3RhdGVMb2FkOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc3RvcmVkU3RhdGUgPSB7fTtcbiAgICBIYW5kc29udGFibGUuaG9va3MucnVuKHRoaXMuaG90LCAncGVyc2lzdGVudFN0YXRlTG9hZCcsICdtYW51YWxSb3dNb3ZlJywgc3RvcmVkU3RhdGUpO1xuICAgIHJldHVybiBzdG9yZWRTdGF0ZS52YWx1ZSA/IHN0b3JlZFN0YXRlLnZhbHVlIDogW107XG4gIH0sXG4gIHByZXBhcmVSb3dzVG9Nb3Zpbmc6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWxlY3Rpb24gPSB0aGlzLmhvdC5nZXRTZWxlY3RlZFJhbmdlKCk7XG4gICAgdmFyIHNlbGVjdGVkUm93cyA9IFtdO1xuICAgIGlmICghc2VsZWN0aW9uKSB7XG4gICAgICByZXR1cm4gc2VsZWN0ZWRSb3dzO1xuICAgIH1cbiAgICB2YXIgJF9fMTIgPSBzZWxlY3Rpb24sXG4gICAgICAgIGZyb20gPSAkX18xMi5mcm9tLFxuICAgICAgICB0byA9ICRfXzEyLnRvO1xuICAgIHZhciBzdGFydCA9IE1hdGgubWluKGZyb20ucm93LCB0by5yb3cpO1xuICAgIHZhciBlbmQgPSBNYXRoLm1heChmcm9tLnJvdywgdG8ucm93KTtcbiAgICByYW5nZUVhY2goc3RhcnQsIGVuZCwgKGZ1bmN0aW9uKGkpIHtcbiAgICAgIHNlbGVjdGVkUm93cy5wdXNoKGkpO1xuICAgIH0pKTtcbiAgICByZXR1cm4gc2VsZWN0ZWRSb3dzO1xuICB9LFxuICByZWZyZXNoUG9zaXRpb25zOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgcHJpdiA9IHByaXZhdGVQb29sLmdldCh0aGlzKTtcbiAgICB2YXIgY29vcmRzID0gcHJpdi50YXJnZXQuY29vcmRzO1xuICAgIHZhciBmaXJzdFZpc2libGUgPSB0aGlzLmhvdC52aWV3Lnd0Lnd0VGFibGUuZ2V0Rmlyc3RWaXNpYmxlUm93KCk7XG4gICAgdmFyIGxhc3RWaXNpYmxlID0gdGhpcy5ob3Qudmlldy53dC53dFRhYmxlLmdldExhc3RWaXNpYmxlUm93KCk7XG4gICAgdmFyIGZpeGVkUm93cyA9IHRoaXMuaG90LmdldFNldHRpbmdzKCkuZml4ZWRSb3dzVG9wO1xuICAgIHZhciBjb3VudFJvd3MgPSB0aGlzLmhvdC5jb3VudFJvd3MoKTtcbiAgICBpZiAoY29vcmRzLnJvdyA8IGZpeGVkUm93cyAmJiBmaXJzdFZpc2libGUgPiAwKSB7XG4gICAgICB0aGlzLmhvdC5zY3JvbGxWaWV3cG9ydFRvKGZpcnN0VmlzaWJsZSAtIDEpO1xuICAgIH1cbiAgICBpZiAoY29vcmRzLnJvdyA+PSBsYXN0VmlzaWJsZSAmJiBsYXN0VmlzaWJsZSA8IGNvdW50Um93cykge1xuICAgICAgdGhpcy5ob3Quc2Nyb2xsVmlld3BvcnRUbyhsYXN0VmlzaWJsZSArIDEsIHVuZGVmaW5lZCwgdHJ1ZSk7XG4gICAgfVxuICAgIHZhciB3dFRhYmxlID0gdGhpcy5ob3Qudmlldy53dC53dFRhYmxlO1xuICAgIHZhciBURCA9IHByaXYudGFyZ2V0LlREO1xuICAgIHZhciByb290RWxlbWVudE9mZnNldCA9IG9mZnNldCh0aGlzLmhvdC5yb290RWxlbWVudCk7XG4gICAgdmFyIHRkT2Zmc2V0VG9wID0gdGhpcy5ob3Qudmlldy5USEVBRC5vZmZzZXRIZWlnaHQgKyB0aGlzLmdldFJvd3NIZWlnaHQoMCwgY29vcmRzLnJvdyk7XG4gICAgdmFyIG1vdXNlT2Zmc2V0VG9wID0gcHJpdi50YXJnZXQuZXZlbnRQYWdlWSAtIHJvb3RFbGVtZW50T2Zmc2V0LnRvcCArIHd0VGFibGUuaG9sZGVyLnNjcm9sbFRvcDtcbiAgICB2YXIgaGlkZXJIZWlnaHQgPSB3dFRhYmxlLmhpZGVyLm9mZnNldEhlaWdodDtcbiAgICB2YXIgdGJvZHlPZmZzZXRUb3AgPSB3dFRhYmxlLlRCT0RZLm9mZnNldFRvcDtcbiAgICB2YXIgYmFja2xpZ2h0RWxlbU1hcmdpblRvcCA9IHRoaXMuYmFja2xpZ2h0LmdldE9mZnNldCgpLnRvcDtcbiAgICB2YXIgYmFja2xpZ2h0RWxlbUhlaWdodCA9IHRoaXMuYmFja2xpZ2h0LmdldFNpemUoKS5oZWlnaHQ7XG4gICAgaWYgKChyb290RWxlbWVudE9mZnNldC50b3AgKyB3dFRhYmxlLmhvbGRlci5vZmZzZXRIZWlnaHQpIDwgcHJpdi50YXJnZXQuZXZlbnRQYWdlWSkge1xuICAgICAgcHJpdi50YXJnZXQuY29vcmRzLnJvdysrO1xuICAgIH1cbiAgICBpZiAodGhpcy5pc0ZpeGVkUm93VG9wKGNvb3Jkcy5yb3cpKSB7XG4gICAgICB0ZE9mZnNldFRvcCArPSB3dFRhYmxlLmhvbGRlci5zY3JvbGxUb3A7XG4gICAgfVxuICAgIGlmIChjb29yZHMucm93IDwgMCkge1xuICAgICAgcHJpdi50YXJnZXQucm93ID0gZmlyc3RWaXNpYmxlID4gMCA/IGZpcnN0VmlzaWJsZSAtIDEgOiBmaXJzdFZpc2libGU7XG4gICAgfSBlbHNlIGlmIChURC5vZmZzZXRIZWlnaHQgLyAyICsgdGRPZmZzZXRUb3AgPD0gbW91c2VPZmZzZXRUb3ApIHtcbiAgICAgIHByaXYudGFyZ2V0LnJvdyA9IGNvb3Jkcy5yb3cgKyAxO1xuICAgICAgdGRPZmZzZXRUb3AgKz0gY29vcmRzLnJvdyA9PT0gMCA/IFRELm9mZnNldEhlaWdodCAtIDEgOiBURC5vZmZzZXRIZWlnaHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHByaXYudGFyZ2V0LnJvdyA9IGNvb3Jkcy5yb3c7XG4gICAgfVxuICAgIHZhciBiYWNrbGlnaHRUb3AgPSBtb3VzZU9mZnNldFRvcDtcbiAgICB2YXIgZ3VpZGVsaW5lVG9wID0gdGRPZmZzZXRUb3A7XG4gICAgaWYgKG1vdXNlT2Zmc2V0VG9wICsgYmFja2xpZ2h0RWxlbUhlaWdodCArIGJhY2tsaWdodEVsZW1NYXJnaW5Ub3AgPj0gaGlkZXJIZWlnaHQpIHtcbiAgICAgIGJhY2tsaWdodFRvcCA9IGhpZGVySGVpZ2h0IC0gYmFja2xpZ2h0RWxlbUhlaWdodCAtIGJhY2tsaWdodEVsZW1NYXJnaW5Ub3A7XG4gICAgfSBlbHNlIGlmIChtb3VzZU9mZnNldFRvcCArIGJhY2tsaWdodEVsZW1NYXJnaW5Ub3AgPCB0Ym9keU9mZnNldFRvcCkge1xuICAgICAgYmFja2xpZ2h0VG9wID0gdGJvZHlPZmZzZXRUb3AgKyBNYXRoLmFicyhiYWNrbGlnaHRFbGVtTWFyZ2luVG9wKTtcbiAgICB9XG4gICAgaWYgKHRkT2Zmc2V0VG9wID49IGhpZGVySGVpZ2h0IC0gMSkge1xuICAgICAgZ3VpZGVsaW5lVG9wID0gaGlkZXJIZWlnaHQgLSAxO1xuICAgIH1cbiAgICB2YXIgdG9wT3ZlcmxheUhlaWdodCA9IDA7XG4gICAgaWYgKHRoaXMuaG90LnZpZXcud3Qud3RPdmVybGF5cy50b3BPdmVybGF5KSB7XG4gICAgICB0b3BPdmVybGF5SGVpZ2h0ID0gdGhpcy5ob3Qudmlldy53dC53dE92ZXJsYXlzLnRvcE92ZXJsYXkuY2xvbmUud3RUYWJsZS5UQUJMRS5vZmZzZXRIZWlnaHQ7XG4gICAgfVxuICAgIGlmIChjb29yZHMucm93ID49IGZpeGVkUm93cyAmJiAoZ3VpZGVsaW5lVG9wIC0gd3RUYWJsZS5ob2xkZXIuc2Nyb2xsVG9wKSA8IHRvcE92ZXJsYXlIZWlnaHQpIHtcbiAgICAgIHRoaXMuaG90LnNjcm9sbFZpZXdwb3J0VG8oY29vcmRzLnJvdyk7XG4gICAgfVxuICAgIHRoaXMuYmFja2xpZ2h0LnNldFBvc2l0aW9uKGJhY2tsaWdodFRvcCk7XG4gICAgdGhpcy5ndWlkZWxpbmUuc2V0UG9zaXRpb24oZ3VpZGVsaW5lVG9wKTtcbiAgfSxcbiAgdXBkYXRlUm93c01hcHBlcjogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNvdW50Um93cyA9IHRoaXMuaG90LmNvdW50U291cmNlUm93cygpO1xuICAgIHZhciByb3dzTWFwcGVyTGVuID0gdGhpcy5yb3dzTWFwcGVyLl9hcnJheU1hcC5sZW5ndGg7XG4gICAgaWYgKHJvd3NNYXBwZXJMZW4gPT09IDApIHtcbiAgICAgIHRoaXMucm93c01hcHBlci5jcmVhdGVNYXAoY291bnRSb3dzIHx8IHRoaXMuaG90LmdldFNldHRpbmdzKCkuc3RhcnRSb3dzKTtcbiAgICB9IGVsc2UgaWYgKHJvd3NNYXBwZXJMZW4gPCBjb3VudFJvd3MpIHtcbiAgICAgIHZhciBkaWZmID0gY291bnRSb3dzIC0gcm93c01hcHBlckxlbjtcbiAgICAgIHRoaXMucm93c01hcHBlci5pbnNlcnRJdGVtcyhyb3dzTWFwcGVyTGVuLCBkaWZmKTtcbiAgICB9IGVsc2UgaWYgKHJvd3NNYXBwZXJMZW4gPiBjb3VudFJvd3MpIHtcbiAgICAgIHZhciBtYXhJbmRleCA9IGNvdW50Um93cyAtIDE7XG4gICAgICB2YXIgcm93c1RvUmVtb3ZlID0gW107XG4gICAgICBhcnJheUVhY2godGhpcy5yb3dzTWFwcGVyLl9hcnJheU1hcCwgKGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgYXJyYXkpIHtcbiAgICAgICAgaWYgKHZhbHVlID4gbWF4SW5kZXgpIHtcbiAgICAgICAgICByb3dzVG9SZW1vdmUucHVzaChpbmRleCk7XG4gICAgICAgIH1cbiAgICAgIH0pKTtcbiAgICAgIHRoaXMucm93c01hcHBlci5yZW1vdmVJdGVtcyhyb3dzVG9SZW1vdmUpO1xuICAgIH1cbiAgfSxcbiAgcmVnaXN0ZXJFdmVudHM6IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX18xMCA9IHRoaXM7XG4gICAgdGhpcy5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsICdtb3VzZW1vdmUnLCAoZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHJldHVybiAkX18xMC5vbk1vdXNlTW92ZShldmVudCk7XG4gICAgfSkpO1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCAnbW91c2V1cCcsIChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX18xMC5vbk1vdXNlVXAoKTtcbiAgICB9KSk7XG4gIH0sXG4gIHVucmVnaXN0ZXJFdmVudHM6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmNsZWFyKCk7XG4gIH0sXG4gIG9uQmVmb3JlQ29sdW1uU29ydDogZnVuY3Rpb24oY29sdW1uLCBvcmRlcikge1xuICAgIHZhciBwcml2ID0gcHJpdmF0ZVBvb2wuZ2V0KHRoaXMpO1xuICAgIHByaXYuZGlzYWxsb3dNb3ZpbmcgPSBvcmRlciAhPT0gdm9pZCAwO1xuICB9LFxuICBvbkJlZm9yZU9uQ2VsbE1vdXNlRG93bjogZnVuY3Rpb24oZXZlbnQsIGNvb3JkcywgVEQsIGJsb2NrQ2FsY3VsYXRpb25zKSB7XG4gICAgdmFyIHd0VGFibGUgPSB0aGlzLmhvdC52aWV3Lnd0Lnd0VGFibGU7XG4gICAgdmFyIGlzSGVhZGVyU2VsZWN0aW9uID0gdGhpcy5ob3Quc2VsZWN0aW9uLnNlbGVjdGVkSGVhZGVyLnJvd3M7XG4gICAgdmFyIHNlbGVjdGlvbiA9IHRoaXMuaG90LmdldFNlbGVjdGVkUmFuZ2UoKTtcbiAgICB2YXIgcHJpdiA9IHByaXZhdGVQb29sLmdldCh0aGlzKTtcbiAgICBpZiAoIXNlbGVjdGlvbiB8fCAhaXNIZWFkZXJTZWxlY3Rpb24gfHwgcHJpdi5wcmVzc2VkIHx8IGV2ZW50LmJ1dHRvbiAhPT0gMCkge1xuICAgICAgcHJpdi5wcmVzc2VkID0gZmFsc2U7XG4gICAgICBwcml2LnJvd3NUb01vdmUubGVuZ3RoID0gMDtcbiAgICAgIHJlbW92ZUNsYXNzKHRoaXMuaG90LnJvb3RFbGVtZW50LCBbQ1NTX09OX01PVklORywgQ1NTX1NIT1dfVUldKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGd1aWRlbGluZUlzTm90UmVhZHkgPSB0aGlzLmd1aWRlbGluZS5pc0J1aWx0KCkgJiYgIXRoaXMuZ3VpZGVsaW5lLmlzQXBwZW5kZWQoKTtcbiAgICB2YXIgYmFja2xpZ2h0SXNOb3RSZWFkeSA9IHRoaXMuYmFja2xpZ2h0LmlzQnVpbHQoKSAmJiAhdGhpcy5iYWNrbGlnaHQuaXNBcHBlbmRlZCgpO1xuICAgIGlmIChndWlkZWxpbmVJc05vdFJlYWR5ICYmIGJhY2tsaWdodElzTm90UmVhZHkpIHtcbiAgICAgIHRoaXMuZ3VpZGVsaW5lLmFwcGVuZFRvKHd0VGFibGUuaGlkZXIpO1xuICAgICAgdGhpcy5iYWNrbGlnaHQuYXBwZW5kVG8od3RUYWJsZS5oaWRlcik7XG4gICAgfVxuICAgIHZhciAkX18xMiA9IHNlbGVjdGlvbixcbiAgICAgICAgZnJvbSA9ICRfXzEyLmZyb20sXG4gICAgICAgIHRvID0gJF9fMTIudG87XG4gICAgdmFyIHN0YXJ0ID0gTWF0aC5taW4oZnJvbS5yb3csIHRvLnJvdyk7XG4gICAgdmFyIGVuZCA9IE1hdGgubWF4KGZyb20ucm93LCB0by5yb3cpO1xuICAgIGlmIChjb29yZHMuY29sIDwgMCAmJiAoY29vcmRzLnJvdyA+PSBzdGFydCAmJiBjb29yZHMucm93IDw9IGVuZCkpIHtcbiAgICAgIGJsb2NrQ2FsY3VsYXRpb25zLnJvdyA9IHRydWU7XG4gICAgICBwcml2LnByZXNzZWQgPSB0cnVlO1xuICAgICAgcHJpdi50YXJnZXQuZXZlbnRQYWdlWSA9IGV2ZW50LnBhZ2VZO1xuICAgICAgcHJpdi50YXJnZXQuY29vcmRzID0gY29vcmRzO1xuICAgICAgcHJpdi50YXJnZXQuVEQgPSBURDtcbiAgICAgIHByaXYucm93c1RvTW92ZSA9IHRoaXMucHJlcGFyZVJvd3NUb01vdmluZygpO1xuICAgICAgdmFyIGxlZnRQb3MgPSB3dFRhYmxlLmhvbGRlci5zY3JvbGxMZWZ0ICsgd3RUYWJsZS5nZXRDb2x1bW5XaWR0aCgtMSk7XG4gICAgICB0aGlzLmJhY2tsaWdodC5zZXRQb3NpdGlvbihudWxsLCBsZWZ0UG9zKTtcbiAgICAgIHRoaXMuYmFja2xpZ2h0LnNldFNpemUod3RUYWJsZS5oaWRlci5vZmZzZXRXaWR0aCAtIGxlZnRQb3MsIHRoaXMuZ2V0Um93c0hlaWdodChzdGFydCwgZW5kICsgMSkpO1xuICAgICAgdGhpcy5iYWNrbGlnaHQuc2V0T2Zmc2V0KCh0aGlzLmdldFJvd3NIZWlnaHQoc3RhcnQsIGNvb3Jkcy5yb3cpICsgZXZlbnQubGF5ZXJZKSAqIC0xLCBudWxsKTtcbiAgICAgIGFkZENsYXNzKHRoaXMuaG90LnJvb3RFbGVtZW50LCBDU1NfT05fTU9WSU5HKTtcbiAgICAgIHRoaXMucmVmcmVzaFBvc2l0aW9ucygpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZW1vdmVDbGFzcyh0aGlzLmhvdC5yb290RWxlbWVudCwgQ1NTX0FGVEVSX1NFTEVDVElPTik7XG4gICAgICBwcml2LnByZXNzZWQgPSBmYWxzZTtcbiAgICAgIHByaXYucm93c1RvTW92ZS5sZW5ndGggPSAwO1xuICAgIH1cbiAgfSxcbiAgb25Nb3VzZU1vdmU6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIHByaXYgPSBwcml2YXRlUG9vbC5nZXQodGhpcyk7XG4gICAgaWYgKCFwcml2LnByZXNzZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGV2ZW50LnJlYWxUYXJnZXQgPT09IHRoaXMuYmFja2xpZ2h0LmVsZW1lbnQpIHtcbiAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmJhY2tsaWdodC5nZXRTaXplKCkuaGVpZ2h0O1xuICAgICAgdGhpcy5iYWNrbGlnaHQuc2V0U2l6ZShudWxsLCAwKTtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuYmFja2xpZ2h0LnNldFBvc2l0aW9uKG51bGwsIGhlaWdodCk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcHJpdi50YXJnZXQuZXZlbnRQYWdlWSA9IGV2ZW50LnBhZ2VZO1xuICAgIHRoaXMucmVmcmVzaFBvc2l0aW9ucygpO1xuICB9LFxuICBvbkJlZm9yZU9uQ2VsbE1vdXNlT3ZlcjogZnVuY3Rpb24oZXZlbnQsIGNvb3JkcywgVEQsIGJsb2NrQ2FsY3VsYXRpb25zKSB7XG4gICAgdmFyIHNlbGVjdGVkUmFuZ2UgPSB0aGlzLmhvdC5nZXRTZWxlY3RlZFJhbmdlKCk7XG4gICAgdmFyIHByaXYgPSBwcml2YXRlUG9vbC5nZXQodGhpcyk7XG4gICAgaWYgKCFzZWxlY3RlZFJhbmdlIHx8ICFwcml2LnByZXNzZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHByaXYucm93c1RvTW92ZS5pbmRleE9mKGNvb3Jkcy5yb3cpID4gLTEpIHtcbiAgICAgIHJlbW92ZUNsYXNzKHRoaXMuaG90LnJvb3RFbGVtZW50LCBDU1NfU0hPV19VSSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFkZENsYXNzKHRoaXMuaG90LnJvb3RFbGVtZW50LCBDU1NfU0hPV19VSSk7XG4gICAgfVxuICAgIGJsb2NrQ2FsY3VsYXRpb25zLnJvdyA9IHRydWU7XG4gICAgYmxvY2tDYWxjdWxhdGlvbnMuY29sdW1uID0gdHJ1ZTtcbiAgICBibG9ja0NhbGN1bGF0aW9ucy5jZWxsID0gdHJ1ZTtcbiAgICBwcml2LnRhcmdldC5jb29yZHMgPSBjb29yZHM7XG4gICAgcHJpdi50YXJnZXQuVEQgPSBURDtcbiAgfSxcbiAgb25Nb3VzZVVwOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgcHJpdiA9IHByaXZhdGVQb29sLmdldCh0aGlzKTtcbiAgICB2YXIgdGFyZ2V0ID0gcHJpdi50YXJnZXQucm93O1xuICAgIHZhciByb3dzTGVuID0gcHJpdi5yb3dzVG9Nb3ZlLmxlbmd0aDtcbiAgICBwcml2LnByZXNzZWQgPSBmYWxzZTtcbiAgICBwcml2LmJhY2tsaWdodEhlaWdodCA9IDA7XG4gICAgcmVtb3ZlQ2xhc3ModGhpcy5ob3Qucm9vdEVsZW1lbnQsIFtDU1NfT05fTU9WSU5HLCBDU1NfU0hPV19VSSwgQ1NTX0FGVEVSX1NFTEVDVElPTl0pO1xuICAgIGlmICh0aGlzLmhvdC5zZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIucm93cykge1xuICAgICAgYWRkQ2xhc3ModGhpcy5ob3Qucm9vdEVsZW1lbnQsIENTU19BRlRFUl9TRUxFQ1RJT04pO1xuICAgIH1cbiAgICBpZiAocm93c0xlbiA8IDEgfHwgdGFyZ2V0ID09PSB2b2lkIDAgfHwgcHJpdi5yb3dzVG9Nb3ZlLmluZGV4T2YodGFyZ2V0KSA+IC0xIHx8IChwcml2LnJvd3NUb01vdmVbcm93c0xlbiAtIDFdID09PSB0YXJnZXQgLSAxKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLm1vdmVSb3dzKHByaXYucm93c1RvTW92ZSwgdGFyZ2V0KTtcbiAgICB0aGlzLnBlcnNpc3RlbnRTdGF0ZVNhdmUoKTtcbiAgICB0aGlzLmhvdC5yZW5kZXIoKTtcbiAgICBpZiAoIXByaXYuZGlzYWxsb3dNb3ZpbmcpIHtcbiAgICAgIHZhciBzZWxlY3Rpb25TdGFydCA9IHRoaXMucm93c01hcHBlci5nZXRJbmRleEJ5VmFsdWUocHJpdi5yb3dzVG9Nb3ZlWzBdKTtcbiAgICAgIHZhciBzZWxlY3Rpb25FbmQgPSB0aGlzLnJvd3NNYXBwZXIuZ2V0SW5kZXhCeVZhbHVlKHByaXYucm93c1RvTW92ZVtyb3dzTGVuIC0gMV0pO1xuICAgICAgdGhpcy5jaGFuZ2VTZWxlY3Rpb24oc2VsZWN0aW9uU3RhcnQsIHNlbGVjdGlvbkVuZCk7XG4gICAgfVxuICAgIHByaXYucm93c1RvTW92ZS5sZW5ndGggPSAwO1xuICB9LFxuICBvbkFmdGVyU2Nyb2xsSG9yaXpvbnRhbGx5OiBmdW5jdGlvbigpIHtcbiAgICB2YXIgd3RUYWJsZSA9IHRoaXMuaG90LnZpZXcud3Qud3RUYWJsZTtcbiAgICB2YXIgaGVhZGVyV2lkdGggPSB3dFRhYmxlLmdldENvbHVtbldpZHRoKC0xKTtcbiAgICB2YXIgc2Nyb2xsTGVmdCA9IHd0VGFibGUuaG9sZGVyLnNjcm9sbExlZnQ7XG4gICAgdmFyIHBvc0xlZnQgPSBoZWFkZXJXaWR0aCArIHNjcm9sbExlZnQ7XG4gICAgdGhpcy5iYWNrbGlnaHQuc2V0UG9zaXRpb24obnVsbCwgcG9zTGVmdCk7XG4gICAgdGhpcy5iYWNrbGlnaHQuc2V0U2l6ZSh3dFRhYmxlLmhpZGVyLm9mZnNldFdpZHRoIC0gcG9zTGVmdCk7XG4gIH0sXG4gIG9uQWZ0ZXJDcmVhdGVSb3c6IGZ1bmN0aW9uKGluZGV4LCBhbW91bnQpIHtcbiAgICB0aGlzLnJvd3NNYXBwZXIuc2hpZnRJdGVtcyhpbmRleCwgYW1vdW50KTtcbiAgfSxcbiAgb25CZWZvcmVSZW1vdmVSb3c6IGZ1bmN0aW9uKGluZGV4LCBhbW91bnQpIHtcbiAgICB2YXIgJF9fMTAgPSB0aGlzO1xuICAgIHRoaXMucmVtb3ZlZFJvd3MubGVuZ3RoID0gMDtcbiAgICBpZiAoaW5kZXggIT09IGZhbHNlKSB7XG4gICAgICByYW5nZUVhY2goaW5kZXgsIGluZGV4ICsgYW1vdW50IC0gMSwgKGZ1bmN0aW9uKHJlbW92ZWRJbmRleCkge1xuICAgICAgICAkX18xMC5yZW1vdmVkUm93cy5wdXNoKCRfXzEwLmhvdC5ydW5Ib29rcygnbW9kaWZ5Um93JywgcmVtb3ZlZEluZGV4LCAkX18xMC5wbHVnaW5OYW1lKSk7XG4gICAgICB9KSk7XG4gICAgfVxuICB9LFxuICBvbkFmdGVyUmVtb3ZlUm93OiBmdW5jdGlvbihpbmRleCwgYW1vdW50KSB7XG4gICAgdGhpcy5yb3dzTWFwcGVyLnVuc2hpZnRJdGVtcyh0aGlzLnJlbW92ZWRSb3dzKTtcbiAgfSxcbiAgb25BZnRlckxvYWREYXRhOiBmdW5jdGlvbihmaXJzdFRpbWUpIHtcbiAgICB0aGlzLnVwZGF0ZVJvd3NNYXBwZXIoKTtcbiAgfSxcbiAgb25Nb2RpZnlSb3c6IGZ1bmN0aW9uKHJvdywgc291cmNlKSB7XG4gICAgaWYgKHNvdXJjZSAhPT0gdGhpcy5wbHVnaW5OYW1lKSB7XG4gICAgICB2YXIgcm93SW5NYXBwZXIgPSB0aGlzLnJvd3NNYXBwZXIuZ2V0VmFsdWVCeUluZGV4KHJvdyk7XG4gICAgICByb3cgPSByb3dJbk1hcHBlciA9PT0gbnVsbCA/IHJvdyA6IHJvd0luTWFwcGVyO1xuICAgIH1cbiAgICByZXR1cm4gcm93O1xuICB9LFxuICBvblVubW9kaWZ5Um93OiBmdW5jdGlvbihyb3cpIHtcbiAgICB2YXIgaW5kZXhJbk1hcHBlciA9IHRoaXMucm93c01hcHBlci5nZXRJbmRleEJ5VmFsdWUocm93KTtcbiAgICByZXR1cm4gaW5kZXhJbk1hcHBlciA9PT0gbnVsbCA/IHJvdyA6IGluZGV4SW5NYXBwZXI7XG4gIH0sXG4gIG9uQWZ0ZXJQbHVnaW5zSW5pdGlhbGl6ZWQ6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMudXBkYXRlUm93c01hcHBlcigpO1xuICAgIHRoaXMuaW5pdGlhbFNldHRpbmdzKCk7XG4gICAgdGhpcy5iYWNrbGlnaHQuYnVpbGQoKTtcbiAgICB0aGlzLmd1aWRlbGluZS5idWlsZCgpO1xuICB9LFxuICBkZXN0cm95OiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmJhY2tsaWdodC5kZXN0cm95KCk7XG4gICAgdGhpcy5ndWlkZWxpbmUuZGVzdHJveSgpO1xuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkTWFudWFsUm93TW92ZS5wcm90b3R5cGUsIFwiZGVzdHJveVwiKS5jYWxsKHRoaXMpO1xuICB9XG59LCB7fSwgQmFzZVBsdWdpbik7XG47XG5yZWdpc3RlclBsdWdpbignTWFudWFsUm93TW92ZScsIE1hbnVhbFJvd01vdmUpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLnJlZ2lzdGVyKCdiZWZvcmVSb3dNb3ZlJyk7XG5IYW5kc29udGFibGUuaG9va3MucmVnaXN0ZXIoJ2FmdGVyUm93TW92ZScpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLnJlZ2lzdGVyKCd1bm1vZGlmeVJvdycpO1xuXG4vLyMgXG59LHtcIl9iYXNlLmpzXCI6NjIsXCJicm93c2VyXCI6MjQsXCJldmVudE1hbmFnZXJcIjo0MixcImhlbHBlcnMvYXJyYXlcIjo0MyxcImhlbHBlcnMvZG9tL2VsZW1lbnRcIjo0NyxcImhlbHBlcnMvbnVtYmVyXCI6NTIsXCJwbHVnaW5zXCI6NjEsXCJyb3dzTWFwcGVyXCI6MTAzLFwidWkvYmFja2xpZ2h0XCI6MTA1LFwidWkvZ3VpZGVsaW5lXCI6MTA2fV0sMTAzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBSb3dzTWFwcGVyOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBSb3dzTWFwcGVyO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfbWl4aW5zXzQ3X2FycmF5TWFwcGVyX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgYXJyYXlNYXBwZXIgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfbWl4aW5zXzQ3X2FycmF5TWFwcGVyX18gPSBfZGVyZXFfKFwibWl4aW5zL2FycmF5TWFwcGVyXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19taXhpbnNfNDdfYXJyYXlNYXBwZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19taXhpbnNfNDdfYXJyYXlNYXBwZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X21peGluc180N19hcnJheU1hcHBlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19taXhpbnNfNDdfYXJyYXlNYXBwZXJfX30pLmFycmF5TWFwcGVyO1xudmFyIGFycmF5RmlsdGVyID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2FycmF5XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X199KS5hcnJheUZpbHRlcjtcbnZhciBtaXhpbiA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fID0gX2RlcmVxXyhcImhlbHBlcnMvb2JqZWN0XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9ffSkubWl4aW47XG52YXIgcmFuZ2VFYWNoID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gPSBfZGVyZXFfKFwiaGVscGVycy9udW1iZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX199KS5yYW5nZUVhY2g7XG52YXIgUm93c01hcHBlciA9IGZ1bmN0aW9uIFJvd3NNYXBwZXIobWFudWFsUm93TW92ZSkge1xuICB0aGlzLm1hbnVhbFJvd01vdmUgPSBtYW51YWxSb3dNb3ZlO1xufTtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKFJvd3NNYXBwZXIsIHtcbiAgY3JlYXRlTWFwOiBmdW5jdGlvbihsZW5ndGgpIHtcbiAgICB2YXIgJF9fNSA9IHRoaXM7XG4gICAgdmFyIG9yaWdpbkxlbmd0aCA9IGxlbmd0aCA9PT0gdm9pZCAwID8gdGhpcy5fYXJyYXlNYXAubGVuZ3RoIDogbGVuZ3RoO1xuICAgIHRoaXMuX2FycmF5TWFwLmxlbmd0aCA9IDA7XG4gICAgcmFuZ2VFYWNoKG9yaWdpbkxlbmd0aCAtIDEsIChmdW5jdGlvbihpdGVtSW5kZXgpIHtcbiAgICAgICRfXzUuX2FycmF5TWFwW2l0ZW1JbmRleF0gPSBpdGVtSW5kZXg7XG4gICAgfSkpO1xuICB9LFxuICBkZXN0cm95OiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLl9hcnJheU1hcCA9IG51bGw7XG4gIH0sXG4gIG1vdmVSb3c6IGZ1bmN0aW9uKGZyb20sIHRvKSB7XG4gICAgdmFyIGluZGV4VG9Nb3ZlID0gdGhpcy5fYXJyYXlNYXBbZnJvbV07XG4gICAgdGhpcy5fYXJyYXlNYXBbZnJvbV0gPSBudWxsO1xuICAgIHRoaXMuX2FycmF5TWFwLnNwbGljZSh0bywgMCwgaW5kZXhUb01vdmUpO1xuICB9LFxuICBjbGVhck51bGw6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuX2FycmF5TWFwID0gYXJyYXlGaWx0ZXIodGhpcy5fYXJyYXlNYXAsIChmdW5jdGlvbihpKSB7XG4gICAgICByZXR1cm4gaSAhPT0gbnVsbDtcbiAgICB9KSk7XG4gIH1cbn0sIHt9KTtcbm1peGluKFJvd3NNYXBwZXIsIGFycmF5TWFwcGVyKTtcbjtcbkhhbmRzb250YWJsZS51dGlscy5NYW51YWxSb3dNb3ZlUm93c01hcHBlciA9IFJvd3NNYXBwZXI7XG5cbi8vIyBcbn0se1wiYnJvd3NlclwiOjI0LFwiaGVscGVycy9hcnJheVwiOjQzLFwiaGVscGVycy9udW1iZXJcIjo1MixcImhlbHBlcnMvb2JqZWN0XCI6NTMsXCJtaXhpbnMvYXJyYXlNYXBwZXJcIjo1N31dLDEwNDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgQmFzZVVJOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBCYXNlVUk7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyIFNUQVRFX0lOSVRJQUxJWkVEID0gMDtcbnZhciBTVEFURV9CVUlMVCA9IDE7XG52YXIgU1RBVEVfQVBQRU5ERUQgPSAyO1xudmFyIFVOSVQgPSAncHgnO1xudmFyIEJhc2VVSSA9IGZ1bmN0aW9uIEJhc2VVSShob3RJbnN0YW5jZSkge1xuICB0aGlzLmhvdCA9IGhvdEluc3RhbmNlO1xuICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcbiAgdGhpcy5zdGF0ZSA9IFNUQVRFX0lOSVRJQUxJWkVEO1xufTtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKEJhc2VVSSwge1xuICBhcHBlbmRUbzogZnVuY3Rpb24od3JhcHBlcikge1xuICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQodGhpcy5fZWxlbWVudCk7XG4gICAgdGhpcy5zdGF0ZSA9IFNUQVRFX0FQUEVOREVEO1xuICB9LFxuICBidWlsZDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5fZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRoaXMuc3RhdGUgPSBTVEFURV9CVUlMVDtcbiAgfSxcbiAgZGVzdHJveTogZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuaXNBcHBlbmRlZCgpKSB7XG4gICAgICB0aGlzLl9lbGVtZW50LnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5fZWxlbWVudCk7XG4gICAgfVxuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICAgIHRoaXMuc3RhdGUgPSBTVEFURV9JTklUSUFMSVpFRDtcbiAgfSxcbiAgaXNBcHBlbmRlZDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdGUgPT09IFNUQVRFX0FQUEVOREVEO1xuICB9LFxuICBpc0J1aWx0OiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZSA+PSBTVEFURV9CVUlMVDtcbiAgfSxcbiAgc2V0UG9zaXRpb246IGZ1bmN0aW9uKHRvcCwgbGVmdCkge1xuICAgIGlmICh0b3ApIHtcbiAgICAgIHRoaXMuX2VsZW1lbnQuc3R5bGUudG9wID0gdG9wICsgVU5JVDtcbiAgICB9XG4gICAgaWYgKGxlZnQpIHtcbiAgICAgIHRoaXMuX2VsZW1lbnQuc3R5bGUubGVmdCA9IGxlZnQgKyBVTklUO1xuICAgIH1cbiAgfSxcbiAgZ2V0UG9zaXRpb246IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICB0b3A6IHRoaXMuX2VsZW1lbnQuc3R5bGUudG9wID8gcGFyc2VJbnQodGhpcy5fZWxlbWVudC5zdHlsZS50b3AsIDEwKSA6IDAsXG4gICAgICBsZWZ0OiB0aGlzLl9lbGVtZW50LnN0eWxlLmxlZnQgPyBwYXJzZUludCh0aGlzLl9lbGVtZW50LnN0eWxlLmxlZnQsIDEwKSA6IDBcbiAgICB9O1xuICB9LFxuICBzZXRTaXplOiBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0KSB7XG4gICAgaWYgKHdpZHRoKSB7XG4gICAgICB0aGlzLl9lbGVtZW50LnN0eWxlLndpZHRoID0gd2lkdGggKyBVTklUO1xuICAgIH1cbiAgICBpZiAoaGVpZ2h0KSB7XG4gICAgICB0aGlzLl9lbGVtZW50LnN0eWxlLmhlaWdodCA9IGhlaWdodCArIFVOSVQ7XG4gICAgfVxuICB9LFxuICBnZXRTaXplOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGg6IHRoaXMuX2VsZW1lbnQuc3R5bGUud2lkdGggPyBwYXJzZUludCh0aGlzLl9lbGVtZW50LnN0eWxlLndpZHRoLCAxMCkgOiAwLFxuICAgICAgaGVpZ2h0OiB0aGlzLl9lbGVtZW50LnN0eWxlLmhlaWdodCA/IHBhcnNlSW50KHRoaXMuX2VsZW1lbnQuc3R5bGUuaGVpZ2h0LCAxMCkgOiAwXG4gICAgfTtcbiAgfSxcbiAgc2V0T2Zmc2V0OiBmdW5jdGlvbih0b3AsIGxlZnQpIHtcbiAgICBpZiAodG9wKSB7XG4gICAgICB0aGlzLl9lbGVtZW50LnN0eWxlLm1hcmdpblRvcCA9IHRvcCArIFVOSVQ7XG4gICAgfVxuICAgIGlmIChsZWZ0KSB7XG4gICAgICB0aGlzLl9lbGVtZW50LnN0eWxlLm1hcmdpbkxlZnQgPSBsZWZ0ICsgVU5JVDtcbiAgICB9XG4gIH0sXG4gIGdldE9mZnNldDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRvcDogdGhpcy5fZWxlbWVudC5zdHlsZS5tYXJnaW5Ub3AgPyBwYXJzZUludCh0aGlzLl9lbGVtZW50LnN0eWxlLm1hcmdpblRvcCwgMTApIDogMCxcbiAgICAgIGxlZnQ6IHRoaXMuX2VsZW1lbnQuc3R5bGUubWFyZ2luTGVmdCA/IHBhcnNlSW50KHRoaXMuX2VsZW1lbnQuc3R5bGUubWFyZ2luTGVmdCwgMTApIDogMFxuICAgIH07XG4gIH1cbn0sIHt9KTtcbjtcblxuLy8jIFxufSx7fV0sMTA1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBCYWNrbGlnaHRVSToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gQmFja2xpZ2h0VUk7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX185NV9iYXNlX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fO1xudmFyIEJhc2VVSSA9ICgkX19fOTVfYmFzZV9fID0gX2RlcmVxXyhcIl9iYXNlXCIpLCAkX19fOTVfYmFzZV9fICYmICRfX185NV9iYXNlX18uX19lc01vZHVsZSAmJiAkX19fOTVfYmFzZV9fIHx8IHtkZWZhdWx0OiAkX19fOTVfYmFzZV9ffSkuQmFzZVVJO1xudmFyIGFkZENsYXNzID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9lbGVtZW50XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X199KS5hZGRDbGFzcztcbnZhciBDU1NfQ0xBU1NOQU1FID0gJ2h0X19tYW51YWxSb3dNb3ZlLS1iYWNrbGlnaHQnO1xudmFyIEJhY2tsaWdodFVJID0gZnVuY3Rpb24gQmFja2xpZ2h0VUkoaG90SW5zdGFuY2UpIHtcbiAgJHRyYWNldXJSdW50aW1lLnN1cGVyQ29uc3RydWN0b3IoJEJhY2tsaWdodFVJKS5jYWxsKHRoaXMsIGhvdEluc3RhbmNlKTtcbn07XG52YXIgJEJhY2tsaWdodFVJID0gQmFja2xpZ2h0VUk7XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShCYWNrbGlnaHRVSSwge2J1aWxkOiBmdW5jdGlvbigpIHtcbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJEJhY2tsaWdodFVJLnByb3RvdHlwZSwgXCJidWlsZFwiKS5jYWxsKHRoaXMpO1xuICAgIGFkZENsYXNzKHRoaXMuX2VsZW1lbnQsIENTU19DTEFTU05BTUUpO1xuICB9fSwge30sIEJhc2VVSSk7XG47XG5cbi8vIyBcbn0se1wiX2Jhc2VcIjoxMDQsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDd9XSwxMDY6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIEd1aWRlbGluZVVJOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBHdWlkZWxpbmVVSTtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzk1X2Jhc2VfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X187XG52YXIgQmFzZVVJID0gKCRfX185NV9iYXNlX18gPSBfZGVyZXFfKFwiX2Jhc2VcIiksICRfX185NV9iYXNlX18gJiYgJF9fXzk1X2Jhc2VfXy5fX2VzTW9kdWxlICYmICRfX185NV9iYXNlX18gfHwge2RlZmF1bHQ6ICRfX185NV9iYXNlX199KS5CYXNlVUk7XG52YXIgYWRkQ2xhc3MgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLmFkZENsYXNzO1xudmFyIENTU19DTEFTU05BTUUgPSAnaHRfX21hbnVhbFJvd01vdmUtLWd1aWRlbGluZSc7XG52YXIgR3VpZGVsaW5lVUkgPSBmdW5jdGlvbiBHdWlkZWxpbmVVSShob3RJbnN0YW5jZSkge1xuICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJDb25zdHJ1Y3RvcigkR3VpZGVsaW5lVUkpLmNhbGwodGhpcywgaG90SW5zdGFuY2UpO1xufTtcbnZhciAkR3VpZGVsaW5lVUkgPSBHdWlkZWxpbmVVSTtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKEd1aWRlbGluZVVJLCB7YnVpbGQ6IGZ1bmN0aW9uKCkge1xuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkR3VpZGVsaW5lVUkucHJvdG90eXBlLCBcImJ1aWxkXCIpLmNhbGwodGhpcyk7XG4gICAgYWRkQ2xhc3ModGhpcy5fZWxlbWVudCwgQ1NTX0NMQVNTTkFNRSk7XG4gIH19LCB7fSwgQmFzZVVJKTtcbjtcblxuLy8jIFxufSx7XCJfYmFzZVwiOjEwNCxcImhlbHBlcnMvZG9tL2VsZW1lbnRcIjo0N31dLDEwNzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgTWFudWFsUm93UmVzaXplOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBNYW51YWxSb3dSZXNpemU7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fOTVfYmFzZV80Nl9qc19fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X251bWJlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgQmFzZVBsdWdpbiA9ICgkX19fNDZfXzQ2X180N19fOTVfYmFzZV80Nl9qc19fID0gX2RlcmVxXyhcIl9iYXNlLmpzXCIpLCAkX19fNDZfXzQ2X180N19fOTVfYmFzZV80Nl9qc19fICYmICRfX180Nl9fNDZfXzQ3X185NV9iYXNlXzQ2X2pzX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fOTVfYmFzZV80Nl9qc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fOTVfYmFzZV80Nl9qc19ffSkuZGVmYXVsdDtcbnZhciAkX18yID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9lbGVtZW50XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X199KSxcbiAgICBhZGRDbGFzcyA9ICRfXzIuYWRkQ2xhc3MsXG4gICAgaGFzQ2xhc3MgPSAkX18yLmhhc0NsYXNzLFxuICAgIHJlbW92ZUNsYXNzID0gJF9fMi5yZW1vdmVDbGFzcyxcbiAgICBvdXRlcldpZHRoID0gJF9fMi5vdXRlcldpZHRoO1xudmFyIGV2ZW50TWFuYWdlck9iamVjdCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyA9IF9kZXJlcV8oXCJldmVudE1hbmFnZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9ffSkuZXZlbnRNYW5hZ2VyO1xudmFyICRfXzQgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9ldmVudFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfX30pLFxuICAgIHBhZ2VYID0gJF9fNC5wYWdlWCxcbiAgICBwYWdlWSA9ICRfXzQucGFnZVk7XG52YXIgYXJyYXlFYWNoID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2FycmF5XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X199KS5hcnJheUVhY2g7XG52YXIgcmFuZ2VFYWNoID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gPSBfZGVyZXFfKFwiaGVscGVycy9udW1iZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX199KS5yYW5nZUVhY2g7XG52YXIgcmVnaXN0ZXJQbHVnaW4gPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fID0gX2RlcmVxXyhcInBsdWdpbnNcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfX30pLnJlZ2lzdGVyUGx1Z2luO1xudmFyIE1hbnVhbFJvd1Jlc2l6ZSA9IGZ1bmN0aW9uIE1hbnVhbFJvd1Jlc2l6ZShob3RJbnN0YW5jZSkge1xuICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJDb25zdHJ1Y3RvcigkTWFudWFsUm93UmVzaXplKS5jYWxsKHRoaXMsIGhvdEluc3RhbmNlKTtcbiAgdGhpcy5jdXJyZW50VEggPSBudWxsO1xuICB0aGlzLmN1cnJlbnRSb3cgPSBudWxsO1xuICB0aGlzLnNlbGVjdGVkUm93cyA9IFtdO1xuICB0aGlzLmN1cnJlbnRIZWlnaHQgPSBudWxsO1xuICB0aGlzLm5ld1NpemUgPSBudWxsO1xuICB0aGlzLnN0YXJ0WSA9IG51bGw7XG4gIHRoaXMuc3RhcnRIZWlnaHQgPSBudWxsO1xuICB0aGlzLnN0YXJ0T2Zmc2V0ID0gbnVsbDtcbiAgdGhpcy5oYW5kbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKTtcbiAgdGhpcy5ndWlkZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xuICB0aGlzLmV2ZW50TWFuYWdlciA9IGV2ZW50TWFuYWdlck9iamVjdCh0aGlzKTtcbiAgdGhpcy5wcmVzc2VkID0gbnVsbDtcbiAgdGhpcy5kYmxjbGljayA9IDA7XG4gIHRoaXMuYXV0b3Jlc2l6ZVRpbWVvdXQgPSBudWxsO1xuICB0aGlzLm1hbnVhbFJvd0hlaWdodHMgPSBbXTtcbiAgYWRkQ2xhc3ModGhpcy5oYW5kbGUsICdtYW51YWxSb3dSZXNpemVyJyk7XG4gIGFkZENsYXNzKHRoaXMuZ3VpZGUsICdtYW51YWxSb3dSZXNpemVyR3VpZGUnKTtcbn07XG52YXIgJE1hbnVhbFJvd1Jlc2l6ZSA9IE1hbnVhbFJvd1Jlc2l6ZTtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKE1hbnVhbFJvd1Jlc2l6ZSwge1xuICBpc0VuYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmhvdC5nZXRTZXR0aW5ncygpLm1hbnVhbFJvd1Jlc2l6ZTtcbiAgfSxcbiAgZW5hYmxlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fOCA9IHRoaXM7XG4gICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLm1hbnVhbFJvd0hlaWdodHMgPSBbXTtcbiAgICB2YXIgaW5pdGlhbFJvd0hlaWdodHMgPSB0aGlzLmhvdC5nZXRTZXR0aW5ncygpLm1hbnVhbFJvd1Jlc2l6ZTtcbiAgICB2YXIgbG9hZGVkTWFudWFsUm93SGVpZ2h0cyA9IHRoaXMubG9hZE1hbnVhbFJvd0hlaWdodHMoKTtcbiAgICBpZiAodHlwZW9mIGxvYWRlZE1hbnVhbFJvd0hlaWdodHMgIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHRoaXMubWFudWFsUm93SGVpZ2h0cyA9IGxvYWRlZE1hbnVhbFJvd0hlaWdodHM7XG4gICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGluaXRpYWxSb3dIZWlnaHRzKSkge1xuICAgICAgdGhpcy5tYW51YWxSb3dIZWlnaHRzID0gaW5pdGlhbFJvd0hlaWdodHM7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubWFudWFsUm93SGVpZ2h0cyA9IFtdO1xuICAgIH1cbiAgICB0aGlzLmFkZEhvb2soJ21vZGlmeVJvd0hlaWdodCcsIChmdW5jdGlvbihoZWlnaHQsIHJvdykge1xuICAgICAgcmV0dXJuICRfXzgub25Nb2RpZnlSb3dIZWlnaHQoaGVpZ2h0LCByb3cpO1xuICAgIH0pKTtcbiAgICBIYW5kc29udGFibGUuaG9va3MucmVnaXN0ZXIoJ2JlZm9yZVJvd1Jlc2l6ZScpO1xuICAgIEhhbmRzb250YWJsZS5ob29rcy5yZWdpc3RlcignYWZ0ZXJSb3dSZXNpemUnKTtcbiAgICB0aGlzLmJpbmRFdmVudHMoKTtcbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJE1hbnVhbFJvd1Jlc2l6ZS5wcm90b3R5cGUsIFwiZW5hYmxlUGx1Z2luXCIpLmNhbGwodGhpcyk7XG4gIH0sXG4gIHVwZGF0ZVBsdWdpbjogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGluaXRpYWxSb3dIZWlnaHRzID0gdGhpcy5ob3QuZ2V0U2V0dGluZ3MoKS5tYW51YWxSb3dSZXNpemU7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoaW5pdGlhbFJvd0hlaWdodHMpKSB7XG4gICAgICB0aGlzLm1hbnVhbFJvd0hlaWdodHMgPSBpbml0aWFsUm93SGVpZ2h0cztcbiAgICB9IGVsc2UgaWYgKCFpbml0aWFsUm93SGVpZ2h0cykge1xuICAgICAgdGhpcy5tYW51YWxSb3dIZWlnaHRzID0gW107XG4gICAgfVxuICB9LFxuICBkaXNhYmxlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJE1hbnVhbFJvd1Jlc2l6ZS5wcm90b3R5cGUsIFwiZGlzYWJsZVBsdWdpblwiKS5jYWxsKHRoaXMpO1xuICB9LFxuICBzYXZlTWFudWFsUm93SGVpZ2h0czogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5ob3QucnVuSG9va3MoJ3BlcnNpc3RlbnRTdGF0ZVNhdmUnLCAnbWFudWFsUm93SGVpZ2h0cycsIHRoaXMubWFudWFsUm93SGVpZ2h0cyk7XG4gIH0sXG4gIGxvYWRNYW51YWxSb3dIZWlnaHRzOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgc3RvcmVkU3RhdGUgPSB7fTtcbiAgICB0aGlzLmhvdC5ydW5Ib29rcygncGVyc2lzdGVudFN0YXRlTG9hZCcsICdtYW51YWxSb3dIZWlnaHRzJywgc3RvcmVkU3RhdGUpO1xuICAgIHJldHVybiBzdG9yZWRTdGF0ZS52YWx1ZTtcbiAgfSxcbiAgc2V0dXBIYW5kbGVQb3NpdGlvbjogZnVuY3Rpb24oVEgpIHtcbiAgICB2YXIgJF9fOCA9IHRoaXM7XG4gICAgdGhpcy5jdXJyZW50VEggPSBUSDtcbiAgICB2YXIgcm93ID0gdGhpcy5ob3Qudmlldy53dC53dFRhYmxlLmdldENvb3JkcyhUSCkucm93O1xuICAgIHZhciBoZWFkZXJXaWR0aCA9IG91dGVyV2lkdGgodGhpcy5jdXJyZW50VEgpO1xuICAgIGlmIChyb3cgPj0gMCkge1xuICAgICAgdmFyIGJveCA9IHRoaXMuY3VycmVudFRILmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgdGhpcy5jdXJyZW50Um93ID0gcm93O1xuICAgICAgdGhpcy5zZWxlY3RlZFJvd3MgPSBbXTtcbiAgICAgIGlmICh0aGlzLmhvdC5zZWxlY3Rpb24uaXNTZWxlY3RlZCgpICYmIHRoaXMuaG90LnNlbGVjdGlvbi5zZWxlY3RlZEhlYWRlci5yb3dzKSB7XG4gICAgICAgIHZhciAkX18xMCA9IHRoaXMuaG90LmdldFNlbGVjdGVkUmFuZ2UoKSxcbiAgICAgICAgICAgIGZyb20gPSAkX18xMC5mcm9tLFxuICAgICAgICAgICAgdG8gPSAkX18xMC50bztcbiAgICAgICAgdmFyIHN0YXJ0ID0gZnJvbS5yb3c7XG4gICAgICAgIHZhciBlbmQgPSB0by5yb3c7XG4gICAgICAgIGlmIChzdGFydCA+PSBlbmQpIHtcbiAgICAgICAgICBzdGFydCA9IHRvLnJvdztcbiAgICAgICAgICBlbmQgPSBmcm9tLnJvdztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jdXJyZW50Um93ID49IHN0YXJ0ICYmIHRoaXMuY3VycmVudFJvdyA8PSBlbmQpIHtcbiAgICAgICAgICByYW5nZUVhY2goc3RhcnQsIGVuZCwgKGZ1bmN0aW9uKGkpIHtcbiAgICAgICAgICAgIHJldHVybiAkX184LnNlbGVjdGVkUm93cy5wdXNoKGkpO1xuICAgICAgICAgIH0pKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnNlbGVjdGVkUm93cy5wdXNoKHRoaXMuY3VycmVudFJvdyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRSb3dzLnB1c2godGhpcy5jdXJyZW50Um93KTtcbiAgICAgIH1cbiAgICAgIHRoaXMuc3RhcnRPZmZzZXQgPSBib3gudG9wIC0gNjtcbiAgICAgIHRoaXMuc3RhcnRIZWlnaHQgPSBwYXJzZUludChib3guaGVpZ2h0LCAxMCk7XG4gICAgICB0aGlzLmhhbmRsZS5zdHlsZS5sZWZ0ID0gYm94LmxlZnQgKyAncHgnO1xuICAgICAgdGhpcy5oYW5kbGUuc3R5bGUudG9wID0gdGhpcy5zdGFydE9mZnNldCArIHRoaXMuc3RhcnRIZWlnaHQgKyAncHgnO1xuICAgICAgdGhpcy5oYW5kbGUuc3R5bGUud2lkdGggPSBoZWFkZXJXaWR0aCArICdweCc7XG4gICAgICB0aGlzLmhvdC5yb290RWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLmhhbmRsZSk7XG4gICAgfVxuICB9LFxuICByZWZyZXNoSGFuZGxlUG9zaXRpb246IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuaGFuZGxlLnN0eWxlLnRvcCA9IHRoaXMuc3RhcnRPZmZzZXQgKyB0aGlzLmN1cnJlbnRIZWlnaHQgKyAncHgnO1xuICB9LFxuICBzZXR1cEd1aWRlUG9zaXRpb246IGZ1bmN0aW9uKCkge1xuICAgIHZhciBoYW5kbGVXaWR0aCA9IHBhcnNlSW50KG91dGVyV2lkdGgodGhpcy5oYW5kbGUpLCAxMCk7XG4gICAgdmFyIGhhbmRsZVJpZ2h0UG9zaXRpb24gPSBwYXJzZUludCh0aGlzLmhhbmRsZS5zdHlsZS5sZWZ0LCAxMCkgKyBoYW5kbGVXaWR0aDtcbiAgICB2YXIgbWF4aW11bVZpc2libGVFbGVtZW50V2lkdGggPSBwYXJzZUludCh0aGlzLmhvdC52aWV3Lm1heGltdW1WaXNpYmxlRWxlbWVudFdpZHRoKDApLCAxMCk7XG4gICAgYWRkQ2xhc3ModGhpcy5oYW5kbGUsICdhY3RpdmUnKTtcbiAgICBhZGRDbGFzcyh0aGlzLmd1aWRlLCAnYWN0aXZlJyk7XG4gICAgdGhpcy5ndWlkZS5zdHlsZS50b3AgPSB0aGlzLmhhbmRsZS5zdHlsZS50b3A7XG4gICAgdGhpcy5ndWlkZS5zdHlsZS5sZWZ0ID0gaGFuZGxlUmlnaHRQb3NpdGlvbiArICdweCc7XG4gICAgdGhpcy5ndWlkZS5zdHlsZS53aWR0aCA9IChtYXhpbXVtVmlzaWJsZUVsZW1lbnRXaWR0aCAtIGhhbmRsZVdpZHRoKSArICdweCc7XG4gICAgdGhpcy5ob3Qucm9vdEVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5ndWlkZSk7XG4gIH0sXG4gIHJlZnJlc2hHdWlkZVBvc2l0aW9uOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmd1aWRlLnN0eWxlLnRvcCA9IHRoaXMuaGFuZGxlLnN0eWxlLnRvcDtcbiAgfSxcbiAgaGlkZUhhbmRsZUFuZEd1aWRlOiBmdW5jdGlvbigpIHtcbiAgICByZW1vdmVDbGFzcyh0aGlzLmhhbmRsZSwgJ2FjdGl2ZScpO1xuICAgIHJlbW92ZUNsYXNzKHRoaXMuZ3VpZGUsICdhY3RpdmUnKTtcbiAgfSxcbiAgY2hlY2tJZlJvd0hlYWRlcjogZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIGlmIChlbGVtZW50ICE9IHRoaXMuaG90LnJvb3RFbGVtZW50KSB7XG4gICAgICB2YXIgcGFyZW50ID0gZWxlbWVudC5wYXJlbnROb2RlO1xuICAgICAgaWYgKHBhcmVudC50YWdOYW1lID09PSAnVEJPRFknKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuY2hlY2tJZlJvd0hlYWRlcihwYXJlbnQpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG4gIGdldFRIRnJvbVRhcmdldEVsZW1lbnQ6IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICBpZiAoZWxlbWVudC50YWdOYW1lICE9ICdUQUJMRScpIHtcbiAgICAgIGlmIChlbGVtZW50LnRhZ05hbWUgPT0gJ1RIJykge1xuICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFRIRnJvbVRhcmdldEVsZW1lbnQoZWxlbWVudC5wYXJlbnROb2RlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH0sXG4gIG9uTW91c2VPdmVyOiBmdW5jdGlvbihldmVudCkge1xuICAgIGlmICh0aGlzLmNoZWNrSWZSb3dIZWFkZXIoZXZlbnQudGFyZ2V0KSkge1xuICAgICAgdmFyIHRoID0gdGhpcy5nZXRUSEZyb21UYXJnZXRFbGVtZW50KGV2ZW50LnRhcmdldCk7XG4gICAgICBpZiAodGgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnByZXNzZWQpIHtcbiAgICAgICAgICB0aGlzLnNldHVwSGFuZGxlUG9zaXRpb24odGgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhZnRlck1vdXNlRG93blRpbWVvdXQ6IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX184ID0gdGhpcztcbiAgICB2YXIgcmVuZGVyID0gKGZ1bmN0aW9uKCkge1xuICAgICAgJF9fOC5ob3QuZm9yY2VGdWxsUmVuZGVyID0gdHJ1ZTtcbiAgICAgICRfXzguaG90LnZpZXcucmVuZGVyKCk7XG4gICAgICAkX184LmhvdC52aWV3Lnd0Lnd0T3ZlcmxheXMuYWRqdXN0RWxlbWVudHNTaXplKHRydWUpO1xuICAgIH0pO1xuICAgIHZhciByZXNpemUgPSAoZnVuY3Rpb24oc2VsZWN0ZWRSb3csIGZvcmNlUmVuZGVyKSB7XG4gICAgICB2YXIgaG9va05ld1NpemUgPSAkX184LmhvdC5ydW5Ib29rcygnYmVmb3JlUm93UmVzaXplJywgc2VsZWN0ZWRSb3csICRfXzgubmV3U2l6ZSwgdHJ1ZSk7XG4gICAgICBpZiAoaG9va05ld1NpemUgIT09IHZvaWQgMCkge1xuICAgICAgICAkX184Lm5ld1NpemUgPSBob29rTmV3U2l6ZTtcbiAgICAgIH1cbiAgICAgICRfXzguc2V0TWFudWFsU2l6ZShzZWxlY3RlZFJvdywgJF9fOC5uZXdTaXplKTtcbiAgICAgIGlmIChmb3JjZVJlbmRlcikge1xuICAgICAgICByZW5kZXIoKTtcbiAgICAgIH1cbiAgICAgICRfXzguaG90LnJ1bkhvb2tzKCdhZnRlclJvd1Jlc2l6ZScsIHNlbGVjdGVkUm93LCAkX184Lm5ld1NpemUsIHRydWUpO1xuICAgIH0pO1xuICAgIGlmICh0aGlzLmRibGNsaWNrID49IDIpIHtcbiAgICAgIHZhciBzZWxlY3RlZFJvd3NMZW5ndGggPSB0aGlzLnNlbGVjdGVkUm93cy5sZW5ndGg7XG4gICAgICBpZiAoc2VsZWN0ZWRSb3dzTGVuZ3RoID4gMSkge1xuICAgICAgICBhcnJheUVhY2godGhpcy5zZWxlY3RlZFJvd3MsIChmdW5jdGlvbihzZWxlY3RlZFJvdykge1xuICAgICAgICAgIHJlc2l6ZShzZWxlY3RlZFJvdyk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgcmVuZGVyKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhcnJheUVhY2godGhpcy5zZWxlY3RlZFJvd3MsIChmdW5jdGlvbihzZWxlY3RlZFJvdykge1xuICAgICAgICAgIHJlc2l6ZShzZWxlY3RlZFJvdywgdHJ1ZSk7XG4gICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5kYmxjbGljayA9IDA7XG4gICAgdGhpcy5hdXRvcmVzaXplVGltZW91dCA9IG51bGw7XG4gIH0sXG4gIG9uTW91c2VEb3duOiBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciAkX184ID0gdGhpcztcbiAgICBpZiAoaGFzQ2xhc3MoZXZlbnQudGFyZ2V0LCAnbWFudWFsUm93UmVzaXplcicpKSB7XG4gICAgICB0aGlzLnNldHVwR3VpZGVQb3NpdGlvbigpO1xuICAgICAgdGhpcy5wcmVzc2VkID0gdGhpcy5ob3Q7XG4gICAgICBpZiAodGhpcy5hdXRvcmVzaXplVGltZW91dCA9PSBudWxsKSB7XG4gICAgICAgIHRoaXMuYXV0b3Jlc2l6ZVRpbWVvdXQgPSBzZXRUaW1lb3V0KChmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gJF9fOC5hZnRlck1vdXNlRG93blRpbWVvdXQoKTtcbiAgICAgICAgfSksIDUwMCk7XG4gICAgICAgIHRoaXMuaG90Ll9yZWdpc3RlclRpbWVvdXQodGhpcy5hdXRvcmVzaXplVGltZW91dCk7XG4gICAgICB9XG4gICAgICB0aGlzLmRibGNsaWNrKys7XG4gICAgICB0aGlzLnN0YXJ0WSA9IHBhZ2VZKGV2ZW50KTtcbiAgICAgIHRoaXMubmV3U2l6ZSA9IHRoaXMuc3RhcnRIZWlnaHQ7XG4gICAgfVxuICB9LFxuICBvbk1vdXNlTW92ZTogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB2YXIgJF9fOCA9IHRoaXM7XG4gICAgaWYgKHRoaXMucHJlc3NlZCkge1xuICAgICAgdGhpcy5jdXJyZW50SGVpZ2h0ID0gdGhpcy5zdGFydEhlaWdodCArIChwYWdlWShldmVudCkgLSB0aGlzLnN0YXJ0WSk7XG4gICAgICBhcnJheUVhY2godGhpcy5zZWxlY3RlZFJvd3MsIChmdW5jdGlvbihzZWxlY3RlZFJvdykge1xuICAgICAgICAkX184Lm5ld1NpemUgPSAkX184LnNldE1hbnVhbFNpemUoc2VsZWN0ZWRSb3csICRfXzguY3VycmVudEhlaWdodCk7XG4gICAgICB9KSk7XG4gICAgICB0aGlzLnJlZnJlc2hIYW5kbGVQb3NpdGlvbigpO1xuICAgICAgdGhpcy5yZWZyZXNoR3VpZGVQb3NpdGlvbigpO1xuICAgIH1cbiAgfSxcbiAgb25Nb3VzZVVwOiBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciAkX184ID0gdGhpcztcbiAgICB2YXIgcmVuZGVyID0gKGZ1bmN0aW9uKCkge1xuICAgICAgJF9fOC5ob3QuZm9yY2VGdWxsUmVuZGVyID0gdHJ1ZTtcbiAgICAgICRfXzguaG90LnZpZXcucmVuZGVyKCk7XG4gICAgICAkX184LmhvdC52aWV3Lnd0Lnd0T3ZlcmxheXMuYWRqdXN0RWxlbWVudHNTaXplKHRydWUpO1xuICAgIH0pO1xuICAgIHZhciBydW5Ib29rcyA9IChmdW5jdGlvbihzZWxlY3RlZFJvdywgZm9yY2VSZW5kZXIpIHtcbiAgICAgICRfXzguaG90LnJ1bkhvb2tzKCdiZWZvcmVSb3dSZXNpemUnLCBzZWxlY3RlZFJvdywgJF9fOC5uZXdTaXplKTtcbiAgICAgIGlmIChmb3JjZVJlbmRlcikge1xuICAgICAgICByZW5kZXIoKTtcbiAgICAgIH1cbiAgICAgICRfXzguc2F2ZU1hbnVhbFJvd0hlaWdodHMoKTtcbiAgICAgICRfXzguaG90LnJ1bkhvb2tzKCdhZnRlclJvd1Jlc2l6ZScsIHNlbGVjdGVkUm93LCAkX184Lm5ld1NpemUpO1xuICAgIH0pO1xuICAgIGlmICh0aGlzLnByZXNzZWQpIHtcbiAgICAgIHRoaXMuaGlkZUhhbmRsZUFuZEd1aWRlKCk7XG4gICAgICB0aGlzLnByZXNzZWQgPSBmYWxzZTtcbiAgICAgIGlmICh0aGlzLm5ld1NpemUgIT0gdGhpcy5zdGFydEhlaWdodCkge1xuICAgICAgICB2YXIgc2VsZWN0ZWRSb3dzTGVuZ3RoID0gdGhpcy5zZWxlY3RlZFJvd3MubGVuZ3RoO1xuICAgICAgICBpZiAoc2VsZWN0ZWRSb3dzTGVuZ3RoID4gMSkge1xuICAgICAgICAgIGFycmF5RWFjaCh0aGlzLnNlbGVjdGVkUm93cywgKGZ1bmN0aW9uKHNlbGVjdGVkUm93KSB7XG4gICAgICAgICAgICBydW5Ib29rcyhzZWxlY3RlZFJvdyk7XG4gICAgICAgICAgfSkpO1xuICAgICAgICAgIHJlbmRlcigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFycmF5RWFjaCh0aGlzLnNlbGVjdGVkUm93cywgKGZ1bmN0aW9uKHNlbGVjdGVkUm93KSB7XG4gICAgICAgICAgICBydW5Ib29rcyhzZWxlY3RlZFJvdywgdHJ1ZSk7XG4gICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLnNldHVwSGFuZGxlUG9zaXRpb24odGhpcy5jdXJyZW50VEgpO1xuICAgIH1cbiAgfSxcbiAgYmluZEV2ZW50czogZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzggPSB0aGlzO1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5ob3Qucm9vdEVsZW1lbnQsICdtb3VzZW92ZXInLCAoZnVuY3Rpb24oZSkge1xuICAgICAgcmV0dXJuICRfXzgub25Nb3VzZU92ZXIoZSk7XG4gICAgfSkpO1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5ob3Qucm9vdEVsZW1lbnQsICdtb3VzZWRvd24nLCAoZnVuY3Rpb24oZSkge1xuICAgICAgcmV0dXJuICRfXzgub25Nb3VzZURvd24oZSk7XG4gICAgfSkpO1xuICAgIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIod2luZG93LCAnbW91c2Vtb3ZlJywgKGZ1bmN0aW9uKGUpIHtcbiAgICAgIHJldHVybiAkX184Lm9uTW91c2VNb3ZlKGUpO1xuICAgIH0pKTtcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKHdpbmRvdywgJ21vdXNldXAnLCAoZnVuY3Rpb24oZSkge1xuICAgICAgcmV0dXJuICRfXzgub25Nb3VzZVVwKGUpO1xuICAgIH0pKTtcbiAgfSxcbiAgc2V0TWFudWFsU2l6ZTogZnVuY3Rpb24ocm93LCBoZWlnaHQpIHtcbiAgICByb3cgPSB0aGlzLmhvdC5ydW5Ib29rcygnbW9kaWZ5Um93Jywgcm93KTtcbiAgICB0aGlzLm1hbnVhbFJvd0hlaWdodHNbcm93XSA9IGhlaWdodDtcbiAgICByZXR1cm4gaGVpZ2h0O1xuICB9LFxuICBvbk1vZGlmeVJvd0hlaWdodDogZnVuY3Rpb24oaGVpZ2h0LCByb3cpIHtcbiAgICBpZiAodGhpcy5lbmFibGVkKSB7XG4gICAgICB2YXIgYXV0b1Jvd1NpemVQbHVnaW4gPSB0aGlzLmhvdC5nZXRQbHVnaW4oJ2F1dG9Sb3dTaXplJyk7XG4gICAgICB2YXIgYXV0b1Jvd0hlaWdodFJlc3VsdCA9IGF1dG9Sb3dTaXplUGx1Z2luID8gYXV0b1Jvd1NpemVQbHVnaW4uaGVpZ2h0c1tyb3ddIDogbnVsbDtcbiAgICAgIHJvdyA9IHRoaXMuaG90LnJ1bkhvb2tzKCdtb2RpZnlSb3cnLCByb3cpO1xuICAgICAgdmFyIG1hbnVhbFJvd0hlaWdodCA9IHRoaXMubWFudWFsUm93SGVpZ2h0c1tyb3ddO1xuICAgICAgaWYgKG1hbnVhbFJvd0hlaWdodCAhPT0gdm9pZCAwICYmIChtYW51YWxSb3dIZWlnaHQgPT09IGF1dG9Sb3dIZWlnaHRSZXN1bHQgfHwgbWFudWFsUm93SGVpZ2h0ID4gKGhlaWdodCB8fCAwKSkpIHtcbiAgICAgICAgcmV0dXJuIG1hbnVhbFJvd0hlaWdodDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGhlaWdodDtcbiAgfVxufSwge30sIEJhc2VQbHVnaW4pO1xuO1xucmVnaXN0ZXJQbHVnaW4oJ21hbnVhbFJvd1Jlc2l6ZScsIE1hbnVhbFJvd1Jlc2l6ZSk7XG5cbi8vIyBcbn0se1wiX2Jhc2UuanNcIjo2MixcImJyb3dzZXJcIjoyNCxcImV2ZW50TWFuYWdlclwiOjQyLFwiaGVscGVycy9hcnJheVwiOjQzLFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwiaGVscGVycy9kb20vZXZlbnRcIjo0OCxcImhlbHBlcnMvbnVtYmVyXCI6NTIsXCJwbHVnaW5zXCI6NjF9XSwxMDg6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIE1lcmdlQ2VsbHM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIE1lcmdlQ2VsbHM7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2VsbF80N19jb29yZHNfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2VsbF80N19yYW5nZV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N190YWJsZV9fO1xudmFyIEhhbmRzb250YWJsZSA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gPSBfZGVyZXFfKFwiYnJvd3NlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9ffSkuZGVmYXVsdDtcbnZhciByZWdpc3RlclBsdWdpbiA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gPSBfZGVyZXFfKFwicGx1Z2luc1wiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19ffSkucmVnaXN0ZXJQbHVnaW47XG52YXIgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZXZlbnRcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X199KS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb247XG52YXIgV2Fsa29udGFibGVDZWxsQ29vcmRzID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19fID0gX2RlcmVxXyhcIjNyZHBhcnR5L3dhbGtvbnRhYmxlL3NyYy9jZWxsL2Nvb3Jkc1wiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2VsbF80N19jb29yZHNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX199KS5XYWxrb250YWJsZUNlbGxDb29yZHM7XG52YXIgV2Fsa29udGFibGVDZWxsUmFuZ2UgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfcmFuZ2VfXyA9IF9kZXJlcV8oXCIzcmRwYXJ0eS93YWxrb250YWJsZS9zcmMvY2VsbC9yYW5nZVwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfcmFuZ2VfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2VsbF80N19yYW5nZV9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfcmFuZ2VfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfcmFuZ2VfX30pLldhbGtvbnRhYmxlQ2VsbFJhbmdlO1xudmFyIFdhbGtvbnRhYmxlVGFibGUgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X3RhYmxlX18gPSBfZGVyZXFfKFwiM3JkcGFydHkvd2Fsa29udGFibGUvc3JjL3RhYmxlXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfdGFibGVfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfdGFibGVfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N190YWJsZV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfdGFibGVfX30pLldhbGtvbnRhYmxlVGFibGU7XG47XG5mdW5jdGlvbiBDZWxsSW5mb0NvbGxlY3Rpb24oKSB7XG4gIHZhciBjb2xsZWN0aW9uID0gW107XG4gIGNvbGxlY3Rpb24uZ2V0SW5mbyA9IGZ1bmN0aW9uKHJvdywgY29sKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsXG4gICAgICAgIGlsZW4gPSB0aGlzLmxlbmd0aDsgaSA8IGlsZW47IGkrKykge1xuICAgICAgaWYgKHRoaXNbaV0ucm93IDw9IHJvdyAmJiB0aGlzW2ldLnJvdyArIHRoaXNbaV0ucm93c3BhbiAtIDEgPj0gcm93ICYmIHRoaXNbaV0uY29sIDw9IGNvbCAmJiB0aGlzW2ldLmNvbCArIHRoaXNbaV0uY29sc3BhbiAtIDEgPj0gY29sKSB7XG4gICAgICAgIHJldHVybiB0aGlzW2ldO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgY29sbGVjdGlvbi5zZXRJbmZvID0gZnVuY3Rpb24oaW5mbykge1xuICAgIGZvciAodmFyIGkgPSAwLFxuICAgICAgICBpbGVuID0gdGhpcy5sZW5ndGg7IGkgPCBpbGVuOyBpKyspIHtcbiAgICAgIGlmICh0aGlzW2ldLnJvdyA9PT0gaW5mby5yb3cgJiYgdGhpc1tpXS5jb2wgPT09IGluZm8uY29sKSB7XG4gICAgICAgIHRoaXNbaV0gPSBpbmZvO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMucHVzaChpbmZvKTtcbiAgfTtcbiAgY29sbGVjdGlvbi5yZW1vdmVJbmZvID0gZnVuY3Rpb24ocm93LCBjb2wpIHtcbiAgICBmb3IgKHZhciBpID0gMCxcbiAgICAgICAgaWxlbiA9IHRoaXMubGVuZ3RoOyBpIDwgaWxlbjsgaSsrKSB7XG4gICAgICBpZiAodGhpc1tpXS5yb3cgPT09IHJvdyAmJiB0aGlzW2ldLmNvbCA9PT0gY29sKSB7XG4gICAgICAgIHRoaXMuc3BsaWNlKGksIDEpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIHJldHVybiBjb2xsZWN0aW9uO1xufVxuZnVuY3Rpb24gTWVyZ2VDZWxscyhtZXJnZUNlbGxzU2V0dGluZykge1xuICB0aGlzLm1lcmdlZENlbGxJbmZvQ29sbGVjdGlvbiA9IG5ldyBDZWxsSW5mb0NvbGxlY3Rpb24oKTtcbiAgaWYgKEFycmF5LmlzQXJyYXkobWVyZ2VDZWxsc1NldHRpbmcpKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsXG4gICAgICAgIGlsZW4gPSBtZXJnZUNlbGxzU2V0dGluZy5sZW5ndGg7IGkgPCBpbGVuOyBpKyspIHtcbiAgICAgIHRoaXMubWVyZ2VkQ2VsbEluZm9Db2xsZWN0aW9uLnNldEluZm8obWVyZ2VDZWxsc1NldHRpbmdbaV0pO1xuICAgIH1cbiAgfVxufVxuTWVyZ2VDZWxscy5wcm90b3R5cGUuY2FuTWVyZ2VSYW5nZSA9IGZ1bmN0aW9uKGNlbGxSYW5nZSkge1xuICByZXR1cm4gIWNlbGxSYW5nZS5pc1NpbmdsZSgpO1xufTtcbk1lcmdlQ2VsbHMucHJvdG90eXBlLm1lcmdlUmFuZ2UgPSBmdW5jdGlvbihjZWxsUmFuZ2UpIHtcbiAgaWYgKCF0aGlzLmNhbk1lcmdlUmFuZ2UoY2VsbFJhbmdlKSkge1xuICAgIHJldHVybjtcbiAgfVxuICB2YXIgdG9wTGVmdCA9IGNlbGxSYW5nZS5nZXRUb3BMZWZ0Q29ybmVyKCk7XG4gIHZhciBib3R0b21SaWdodCA9IGNlbGxSYW5nZS5nZXRCb3R0b21SaWdodENvcm5lcigpO1xuICB2YXIgbWVyZ2VQYXJlbnQgPSB7fTtcbiAgbWVyZ2VQYXJlbnQucm93ID0gdG9wTGVmdC5yb3c7XG4gIG1lcmdlUGFyZW50LmNvbCA9IHRvcExlZnQuY29sO1xuICBtZXJnZVBhcmVudC5yb3dzcGFuID0gYm90dG9tUmlnaHQucm93IC0gdG9wTGVmdC5yb3cgKyAxO1xuICBtZXJnZVBhcmVudC5jb2xzcGFuID0gYm90dG9tUmlnaHQuY29sIC0gdG9wTGVmdC5jb2wgKyAxO1xuICB0aGlzLm1lcmdlZENlbGxJbmZvQ29sbGVjdGlvbi5zZXRJbmZvKG1lcmdlUGFyZW50KTtcbn07XG5NZXJnZUNlbGxzLnByb3RvdHlwZS5tZXJnZU9yVW5tZXJnZVNlbGVjdGlvbiA9IGZ1bmN0aW9uKGNlbGxSYW5nZSkge1xuICB2YXIgaW5mbyA9IHRoaXMubWVyZ2VkQ2VsbEluZm9Db2xsZWN0aW9uLmdldEluZm8oY2VsbFJhbmdlLmZyb20ucm93LCBjZWxsUmFuZ2UuZnJvbS5jb2wpO1xuICBpZiAoaW5mbykge1xuICAgIHRoaXMudW5tZXJnZVNlbGVjdGlvbihjZWxsUmFuZ2UuZnJvbSk7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5tZXJnZVNlbGVjdGlvbihjZWxsUmFuZ2UpO1xuICB9XG59O1xuTWVyZ2VDZWxscy5wcm90b3R5cGUubWVyZ2VTZWxlY3Rpb24gPSBmdW5jdGlvbihjZWxsUmFuZ2UpIHtcbiAgdGhpcy5tZXJnZVJhbmdlKGNlbGxSYW5nZSk7XG59O1xuTWVyZ2VDZWxscy5wcm90b3R5cGUudW5tZXJnZVNlbGVjdGlvbiA9IGZ1bmN0aW9uKGNlbGxSYW5nZSkge1xuICB2YXIgaW5mbyA9IHRoaXMubWVyZ2VkQ2VsbEluZm9Db2xsZWN0aW9uLmdldEluZm8oY2VsbFJhbmdlLnJvdywgY2VsbFJhbmdlLmNvbCk7XG4gIHRoaXMubWVyZ2VkQ2VsbEluZm9Db2xsZWN0aW9uLnJlbW92ZUluZm8oaW5mby5yb3csIGluZm8uY29sKTtcbn07XG5NZXJnZUNlbGxzLnByb3RvdHlwZS5hcHBseVNwYW5Qcm9wZXJ0aWVzID0gZnVuY3Rpb24oVEQsIHJvdywgY29sKSB7XG4gIHZhciBpbmZvID0gdGhpcy5tZXJnZWRDZWxsSW5mb0NvbGxlY3Rpb24uZ2V0SW5mbyhyb3csIGNvbCk7XG4gIGlmIChpbmZvKSB7XG4gICAgaWYgKGluZm8ucm93ID09PSByb3cgJiYgaW5mby5jb2wgPT09IGNvbCkge1xuICAgICAgVEQuc2V0QXR0cmlidXRlKCdyb3dzcGFuJywgaW5mby5yb3dzcGFuKTtcbiAgICAgIFRELnNldEF0dHJpYnV0ZSgnY29sc3BhbicsIGluZm8uY29sc3Bhbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIFRELnJlbW92ZUF0dHJpYnV0ZSgncm93c3BhbicpO1xuICAgICAgVEQucmVtb3ZlQXR0cmlidXRlKCdjb2xzcGFuJyk7XG4gICAgICBURC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBURC5yZW1vdmVBdHRyaWJ1dGUoJ3Jvd3NwYW4nKTtcbiAgICBURC5yZW1vdmVBdHRyaWJ1dGUoJ2NvbHNwYW4nKTtcbiAgfVxufTtcbk1lcmdlQ2VsbHMucHJvdG90eXBlLm1vZGlmeVRyYW5zZm9ybSA9IGZ1bmN0aW9uKGhvb2ssIGN1cnJlbnRTZWxlY3RlZFJhbmdlLCBkZWx0YSkge1xuICB2YXIgc2FtZVJvd3NwYW4gPSBmdW5jdGlvbihtZXJnZWQsIGNvb3Jkcykge1xuICAgIGlmIChjb29yZHMucm93ID49IG1lcmdlZC5yb3cgJiYgY29vcmRzLnJvdyA8PSAobWVyZ2VkLnJvdyArIG1lcmdlZC5yb3dzcGFuIC0gMSkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG4gICAgICBzYW1lQ29sc3BhbiA9IGZ1bmN0aW9uKG1lcmdlZCwgY29vcmRzKSB7XG4gICAgICAgIGlmIChjb29yZHMuY29sID49IG1lcmdlZC5jb2wgJiYgY29vcmRzLmNvbCA8PSAobWVyZ2VkLmNvbCArIG1lcmdlZC5jb2xzcGFuIC0gMSkpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9LFxuICAgICAgZ2V0TmV4dFBvc2l0aW9uID0gZnVuY3Rpb24obmV3RGVsdGEpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoY3VycmVudFNlbGVjdGVkUmFuZ2UudG8ucm93ICsgbmV3RGVsdGEucm93LCBjdXJyZW50U2VsZWN0ZWRSYW5nZS50by5jb2wgKyBuZXdEZWx0YS5jb2wpO1xuICAgICAgfTtcbiAgdmFyIG5ld0RlbHRhID0ge1xuICAgIHJvdzogZGVsdGEucm93LFxuICAgIGNvbDogZGVsdGEuY29sXG4gIH07XG4gIGlmIChob29rID09ICdtb2RpZnlUcmFuc2Zvcm1TdGFydCcpIHtcbiAgICBpZiAoIXRoaXMubGFzdERlc2lyZWRDb29yZHMpIHtcbiAgICAgIHRoaXMubGFzdERlc2lyZWRDb29yZHMgPSBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKG51bGwsIG51bGwpO1xuICAgIH1cbiAgICB2YXIgY3VycmVudFBvc2l0aW9uID0gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhjdXJyZW50U2VsZWN0ZWRSYW5nZS5oaWdobGlnaHQucm93LCBjdXJyZW50U2VsZWN0ZWRSYW5nZS5oaWdobGlnaHQuY29sKSxcbiAgICAgICAgbWVyZ2VkUGFyZW50ID0gdGhpcy5tZXJnZWRDZWxsSW5mb0NvbGxlY3Rpb24uZ2V0SW5mbyhjdXJyZW50UG9zaXRpb24ucm93LCBjdXJyZW50UG9zaXRpb24uY29sKSxcbiAgICAgICAgY3VycmVudFJhbmdlQ29udGFpbnNNZXJnZTtcbiAgICBmb3IgKHZhciBpID0gMCxcbiAgICAgICAgbWVyZ2VzTGVuZ3RoID0gdGhpcy5tZXJnZWRDZWxsSW5mb0NvbGxlY3Rpb24ubGVuZ3RoOyBpIDwgbWVyZ2VzTGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciByYW5nZSA9IHRoaXMubWVyZ2VkQ2VsbEluZm9Db2xsZWN0aW9uW2ldO1xuICAgICAgcmFuZ2UgPSBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHJhbmdlLnJvdyArIHJhbmdlLnJvd3NwYW4gLSAxLCByYW5nZS5jb2wgKyByYW5nZS5jb2xzcGFuIC0gMSk7XG4gICAgICBpZiAoY3VycmVudFNlbGVjdGVkUmFuZ2UuaW5jbHVkZXMocmFuZ2UpKSB7XG4gICAgICAgIGN1cnJlbnRSYW5nZUNvbnRhaW5zTWVyZ2UgPSB0cnVlO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG1lcmdlZFBhcmVudCkge1xuICAgICAgdmFyIG1lcmdlVG9wTGVmdCA9IG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMobWVyZ2VkUGFyZW50LnJvdywgbWVyZ2VkUGFyZW50LmNvbCksXG4gICAgICAgICAgbWVyZ2VCb3R0b21SaWdodCA9IG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMobWVyZ2VkUGFyZW50LnJvdyArIG1lcmdlZFBhcmVudC5yb3dzcGFuIC0gMSwgbWVyZ2VkUGFyZW50LmNvbCArIG1lcmdlZFBhcmVudC5jb2xzcGFuIC0gMSksXG4gICAgICAgICAgbWVyZ2VSYW5nZSA9IG5ldyBXYWxrb250YWJsZUNlbGxSYW5nZShtZXJnZVRvcExlZnQsIG1lcmdlVG9wTGVmdCwgbWVyZ2VCb3R0b21SaWdodCk7XG4gICAgICBpZiAoIW1lcmdlUmFuZ2UuaW5jbHVkZXModGhpcy5sYXN0RGVzaXJlZENvb3JkcykpIHtcbiAgICAgICAgdGhpcy5sYXN0RGVzaXJlZENvb3JkcyA9IG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMobnVsbCwgbnVsbCk7XG4gICAgICB9XG4gICAgICBuZXdEZWx0YS5yb3cgPSB0aGlzLmxhc3REZXNpcmVkQ29vcmRzLnJvdyA/IHRoaXMubGFzdERlc2lyZWRDb29yZHMucm93IC0gY3VycmVudFBvc2l0aW9uLnJvdyA6IG5ld0RlbHRhLnJvdztcbiAgICAgIG5ld0RlbHRhLmNvbCA9IHRoaXMubGFzdERlc2lyZWRDb29yZHMuY29sID8gdGhpcy5sYXN0RGVzaXJlZENvb3Jkcy5jb2wgLSBjdXJyZW50UG9zaXRpb24uY29sIDogbmV3RGVsdGEuY29sO1xuICAgICAgaWYgKGRlbHRhLnJvdyA+IDApIHtcbiAgICAgICAgbmV3RGVsdGEucm93ID0gbWVyZ2VkUGFyZW50LnJvdyArIG1lcmdlZFBhcmVudC5yb3dzcGFuIC0gMSAtIGN1cnJlbnRQb3NpdGlvbi5yb3cgKyBkZWx0YS5yb3c7XG4gICAgICB9IGVsc2UgaWYgKGRlbHRhLnJvdyA8IDApIHtcbiAgICAgICAgbmV3RGVsdGEucm93ID0gY3VycmVudFBvc2l0aW9uLnJvdyAtIG1lcmdlZFBhcmVudC5yb3cgKyBkZWx0YS5yb3c7XG4gICAgICB9XG4gICAgICBpZiAoZGVsdGEuY29sID4gMCkge1xuICAgICAgICBuZXdEZWx0YS5jb2wgPSBtZXJnZWRQYXJlbnQuY29sICsgbWVyZ2VkUGFyZW50LmNvbHNwYW4gLSAxIC0gY3VycmVudFBvc2l0aW9uLmNvbCArIGRlbHRhLmNvbDtcbiAgICAgIH0gZWxzZSBpZiAoZGVsdGEuY29sIDwgMCkge1xuICAgICAgICBuZXdEZWx0YS5jb2wgPSBjdXJyZW50UG9zaXRpb24uY29sIC0gbWVyZ2VkUGFyZW50LmNvbCArIGRlbHRhLmNvbDtcbiAgICAgIH1cbiAgICB9XG4gICAgdmFyIG5leHRQb3NpdGlvbiA9IG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoY3VycmVudFNlbGVjdGVkUmFuZ2UuaGlnaGxpZ2h0LnJvdyArIG5ld0RlbHRhLnJvdywgY3VycmVudFNlbGVjdGVkUmFuZ2UuaGlnaGxpZ2h0LmNvbCArIG5ld0RlbHRhLmNvbCksXG4gICAgICAgIG5leHRQYXJlbnRJc01lcmdlZCA9IHRoaXMubWVyZ2VkQ2VsbEluZm9Db2xsZWN0aW9uLmdldEluZm8obmV4dFBvc2l0aW9uLnJvdywgbmV4dFBvc2l0aW9uLmNvbCk7XG4gICAgaWYgKG5leHRQYXJlbnRJc01lcmdlZCkge1xuICAgICAgdGhpcy5sYXN0RGVzaXJlZENvb3JkcyA9IG5leHRQb3NpdGlvbjtcbiAgICAgIG5ld0RlbHRhID0ge1xuICAgICAgICByb3c6IG5leHRQYXJlbnRJc01lcmdlZC5yb3cgLSBjdXJyZW50UG9zaXRpb24ucm93LFxuICAgICAgICBjb2w6IG5leHRQYXJlbnRJc01lcmdlZC5jb2wgLSBjdXJyZW50UG9zaXRpb24uY29sXG4gICAgICB9O1xuICAgIH1cbiAgfSBlbHNlIGlmIChob29rID09ICdtb2RpZnlUcmFuc2Zvcm1FbmQnKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsXG4gICAgICAgIG1lcmdlc0xlbmd0aCA9IHRoaXMubWVyZ2VkQ2VsbEluZm9Db2xsZWN0aW9uLmxlbmd0aDsgaSA8IG1lcmdlc0xlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgY3VycmVudE1lcmdlID0gdGhpcy5tZXJnZWRDZWxsSW5mb0NvbGxlY3Rpb25baV0sXG4gICAgICAgICAgbWVyZ2VUb3BMZWZ0ID0gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhjdXJyZW50TWVyZ2Uucm93LCBjdXJyZW50TWVyZ2UuY29sKSxcbiAgICAgICAgICBtZXJnZUJvdHRvbVJpZ2h0ID0gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhjdXJyZW50TWVyZ2Uucm93ICsgY3VycmVudE1lcmdlLnJvd3NwYW4gLSAxLCBjdXJyZW50TWVyZ2UuY29sICsgY3VycmVudE1lcmdlLmNvbHNwYW4gLSAxKSxcbiAgICAgICAgICBtZXJnZWRSYW5nZSA9IG5ldyBXYWxrb250YWJsZUNlbGxSYW5nZShtZXJnZVRvcExlZnQsIG1lcmdlVG9wTGVmdCwgbWVyZ2VCb3R0b21SaWdodCksXG4gICAgICAgICAgc2hhcmVkQm9yZGVycyA9IGN1cnJlbnRTZWxlY3RlZFJhbmdlLmdldEJvcmRlcnNTaGFyZWRXaXRoKG1lcmdlZFJhbmdlKTtcbiAgICAgIGlmIChtZXJnZWRSYW5nZS5pc0VxdWFsKGN1cnJlbnRTZWxlY3RlZFJhbmdlKSkge1xuICAgICAgICBjdXJyZW50U2VsZWN0ZWRSYW5nZS5zZXREaXJlY3Rpb24oJ05XLVNFJyk7XG4gICAgICB9IGVsc2UgaWYgKHNoYXJlZEJvcmRlcnMubGVuZ3RoID4gMCkge1xuICAgICAgICB2YXIgbWVyZ2VIaWdobGlnaHRlZCA9IChjdXJyZW50U2VsZWN0ZWRSYW5nZS5oaWdobGlnaHQuaXNFcXVhbChtZXJnZWRSYW5nZS5mcm9tKSk7XG4gICAgICAgIGlmIChzaGFyZWRCb3JkZXJzLmluZGV4T2YoJ3RvcCcpID4gLTEpIHtcbiAgICAgICAgICBpZiAoY3VycmVudFNlbGVjdGVkUmFuZ2UudG8uaXNTb3V0aEVhc3RPZihtZXJnZWRSYW5nZS5mcm9tKSAmJiBtZXJnZUhpZ2hsaWdodGVkKSB7XG4gICAgICAgICAgICBjdXJyZW50U2VsZWN0ZWRSYW5nZS5zZXREaXJlY3Rpb24oJ05XLVNFJyk7XG4gICAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50U2VsZWN0ZWRSYW5nZS50by5pc1NvdXRoV2VzdE9mKG1lcmdlZFJhbmdlLmZyb20pICYmIG1lcmdlSGlnaGxpZ2h0ZWQpIHtcbiAgICAgICAgICAgIGN1cnJlbnRTZWxlY3RlZFJhbmdlLnNldERpcmVjdGlvbignTkUtU1cnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoc2hhcmVkQm9yZGVycy5pbmRleE9mKCdib3R0b20nKSA+IC0xKSB7XG4gICAgICAgICAgaWYgKGN1cnJlbnRTZWxlY3RlZFJhbmdlLnRvLmlzTm9ydGhFYXN0T2YobWVyZ2VkUmFuZ2UuZnJvbSkgJiYgbWVyZ2VIaWdobGlnaHRlZCkge1xuICAgICAgICAgICAgY3VycmVudFNlbGVjdGVkUmFuZ2Uuc2V0RGlyZWN0aW9uKCdTVy1ORScpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoY3VycmVudFNlbGVjdGVkUmFuZ2UudG8uaXNOb3J0aFdlc3RPZihtZXJnZWRSYW5nZS5mcm9tKSAmJiBtZXJnZUhpZ2hsaWdodGVkKSB7XG4gICAgICAgICAgICBjdXJyZW50U2VsZWN0ZWRSYW5nZS5zZXREaXJlY3Rpb24oJ1NFLU5XJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICB2YXIgbmV4dFBvc2l0aW9uID0gZ2V0TmV4dFBvc2l0aW9uKG5ld0RlbHRhKSxcbiAgICAgICAgICB3aXRoaW5Sb3dzcGFuID0gc2FtZVJvd3NwYW4oY3VycmVudE1lcmdlLCBuZXh0UG9zaXRpb24pLFxuICAgICAgICAgIHdpdGhpbkNvbHNwYW4gPSBzYW1lQ29sc3BhbihjdXJyZW50TWVyZ2UsIG5leHRQb3NpdGlvbik7XG4gICAgICBpZiAoY3VycmVudFNlbGVjdGVkUmFuZ2UuaW5jbHVkZXNSYW5nZShtZXJnZWRSYW5nZSkgJiYgKG1lcmdlZFJhbmdlLmluY2x1ZGVzKG5leHRQb3NpdGlvbikgfHwgd2l0aGluUm93c3BhbiB8fCB3aXRoaW5Db2xzcGFuKSkge1xuICAgICAgICBpZiAod2l0aGluUm93c3Bhbikge1xuICAgICAgICAgIGlmIChuZXdEZWx0YS5yb3cgPCAwKSB7XG4gICAgICAgICAgICBuZXdEZWx0YS5yb3cgLT0gY3VycmVudE1lcmdlLnJvd3NwYW4gLSAxO1xuICAgICAgICAgIH0gZWxzZSBpZiAobmV3RGVsdGEucm93ID4gMCkge1xuICAgICAgICAgICAgbmV3RGVsdGEucm93ICs9IGN1cnJlbnRNZXJnZS5yb3dzcGFuIC0gMTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHdpdGhpbkNvbHNwYW4pIHtcbiAgICAgICAgICBpZiAobmV3RGVsdGEuY29sIDwgMCkge1xuICAgICAgICAgICAgbmV3RGVsdGEuY29sIC09IGN1cnJlbnRNZXJnZS5jb2xzcGFuIC0gMTtcbiAgICAgICAgICB9IGVsc2UgaWYgKG5ld0RlbHRhLmNvbCA+IDApIHtcbiAgICAgICAgICAgIG5ld0RlbHRhLmNvbCArPSBjdXJyZW50TWVyZ2UuY29sc3BhbiAtIDE7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGlmIChuZXdEZWx0YS5yb3cgIT09IDApIHtcbiAgICBkZWx0YS5yb3cgPSBuZXdEZWx0YS5yb3c7XG4gIH1cbiAgaWYgKG5ld0RlbHRhLmNvbCAhPT0gMCkge1xuICAgIGRlbHRhLmNvbCA9IG5ld0RlbHRhLmNvbDtcbiAgfVxufTtcbk1lcmdlQ2VsbHMucHJvdG90eXBlLnNoaWZ0Q29sbGVjdGlvbiA9IGZ1bmN0aW9uKGRpcmVjdGlvbiwgaW5kZXgsIGNvdW50KSB7XG4gIHZhciBzaGlmdFZlY3RvciA9IFswLCAwXTtcbiAgc3dpdGNoIChkaXJlY3Rpb24pIHtcbiAgICBjYXNlICdyaWdodCc6XG4gICAgICBzaGlmdFZlY3RvclswXSArPSAxO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnbGVmdCc6XG4gICAgICBzaGlmdFZlY3RvclswXSAtPSAxO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnZG93bic6XG4gICAgICBzaGlmdFZlY3RvclsxXSArPSAxO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAndXAnOlxuICAgICAgc2hpZnRWZWN0b3JbMV0gLT0gMTtcbiAgICAgIGJyZWFrO1xuICB9XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tZXJnZWRDZWxsSW5mb0NvbGxlY3Rpb24ubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgY3VycmVudE1lcmdlID0gdGhpcy5tZXJnZWRDZWxsSW5mb0NvbGxlY3Rpb25baV07XG4gICAgaWYgKGRpcmVjdGlvbiA9PT0gJ3JpZ2h0JyB8fCBkaXJlY3Rpb24gPT09ICdsZWZ0Jykge1xuICAgICAgaWYgKGluZGV4IDw9IGN1cnJlbnRNZXJnZS5jb2wpIHtcbiAgICAgICAgY3VycmVudE1lcmdlLmNvbCArPSBzaGlmdFZlY3RvclswXTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGluZGV4IDw9IGN1cnJlbnRNZXJnZS5yb3cpIHtcbiAgICAgICAgY3VycmVudE1lcmdlLnJvdyArPSBzaGlmdFZlY3RvclsxXTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG52YXIgYmVmb3JlSW5pdCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgaW5zdGFuY2UgPSB0aGlzO1xuICB2YXIgbWVyZ2VDZWxsc1NldHRpbmcgPSBpbnN0YW5jZS5nZXRTZXR0aW5ncygpLm1lcmdlQ2VsbHM7XG4gIGlmIChtZXJnZUNlbGxzU2V0dGluZykge1xuICAgIGlmICghaW5zdGFuY2UubWVyZ2VDZWxscykge1xuICAgICAgaW5zdGFuY2UubWVyZ2VDZWxscyA9IG5ldyBNZXJnZUNlbGxzKG1lcmdlQ2VsbHNTZXR0aW5nKTtcbiAgICB9XG4gIH1cbn07XG52YXIgYWZ0ZXJJbml0ID0gZnVuY3Rpb24oKSB7XG4gIHZhciBpbnN0YW5jZSA9IHRoaXM7XG4gIGlmIChpbnN0YW5jZS5tZXJnZUNlbGxzKSB7XG4gICAgaW5zdGFuY2Uudmlldy53dC53dFRhYmxlLmdldENlbGwgPSBmdW5jdGlvbihjb29yZHMpIHtcbiAgICAgIGlmIChpbnN0YW5jZS5nZXRTZXR0aW5ncygpLm1lcmdlQ2VsbHMpIHtcbiAgICAgICAgdmFyIG1lcmdlUGFyZW50ID0gaW5zdGFuY2UubWVyZ2VDZWxscy5tZXJnZWRDZWxsSW5mb0NvbGxlY3Rpb24uZ2V0SW5mbyhjb29yZHMucm93LCBjb29yZHMuY29sKTtcbiAgICAgICAgaWYgKG1lcmdlUGFyZW50KSB7XG4gICAgICAgICAgY29vcmRzID0gbWVyZ2VQYXJlbnQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBXYWxrb250YWJsZVRhYmxlLnByb3RvdHlwZS5nZXRDZWxsLmNhbGwodGhpcywgY29vcmRzKTtcbiAgICB9O1xuICB9XG59O1xudmFyIGFmdGVyVXBkYXRlU2V0dGluZ3MgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGluc3RhbmNlID0gdGhpcztcbiAgdmFyIG1lcmdlQ2VsbHNTZXR0aW5nID0gaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5tZXJnZUNlbGxzO1xuICBpZiAobWVyZ2VDZWxsc1NldHRpbmcpIHtcbiAgICBpZiAoaW5zdGFuY2UubWVyZ2VDZWxscykge1xuICAgICAgaW5zdGFuY2UubWVyZ2VDZWxscy5tZXJnZWRDZWxsSW5mb0NvbGxlY3Rpb24gPSBuZXcgQ2VsbEluZm9Db2xsZWN0aW9uKCk7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShtZXJnZUNlbGxzU2V0dGluZykpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsXG4gICAgICAgICAgICBpbGVuID0gbWVyZ2VDZWxsc1NldHRpbmcubGVuZ3RoOyBpIDwgaWxlbjsgaSsrKSB7XG4gICAgICAgICAgaW5zdGFuY2UubWVyZ2VDZWxscy5tZXJnZWRDZWxsSW5mb0NvbGxlY3Rpb24uc2V0SW5mbyhtZXJnZUNlbGxzU2V0dGluZ1tpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaW5zdGFuY2UubWVyZ2VDZWxscyA9IG5ldyBNZXJnZUNlbGxzKG1lcmdlQ2VsbHNTZXR0aW5nKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaWYgKGluc3RhbmNlLm1lcmdlQ2VsbHMpIHtcbiAgICAgIGluc3RhbmNlLm1lcmdlQ2VsbHMubWVyZ2VkQ2VsbEluZm9Db2xsZWN0aW9uID0gbmV3IENlbGxJbmZvQ29sbGVjdGlvbigpO1xuICAgIH1cbiAgfVxufTtcbnZhciBvbkJlZm9yZUtleURvd24gPSBmdW5jdGlvbihldmVudCkge1xuICBpZiAoIXRoaXMubWVyZ2VDZWxscykge1xuICAgIHJldHVybjtcbiAgfVxuICB2YXIgY3RybERvd24gPSAoZXZlbnQuY3RybEtleSB8fCBldmVudC5tZXRhS2V5KSAmJiAhZXZlbnQuYWx0S2V5O1xuICBpZiAoY3RybERvd24pIHtcbiAgICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gNzcpIHtcbiAgICAgIHRoaXMubWVyZ2VDZWxscy5tZXJnZU9yVW5tZXJnZVNlbGVjdGlvbih0aGlzLmdldFNlbGVjdGVkUmFuZ2UoKSk7XG4gICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKGV2ZW50KTtcbiAgICB9XG4gIH1cbn07XG52YXIgYWRkTWVyZ2VBY3Rpb25zVG9Db250ZXh0TWVudSA9IGZ1bmN0aW9uKGRlZmF1bHRPcHRpb25zKSB7XG4gIGlmICghdGhpcy5nZXRTZXR0aW5ncygpLm1lcmdlQ2VsbHMpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgZGVmYXVsdE9wdGlvbnMuaXRlbXMucHVzaChIYW5kc29udGFibGUucGx1Z2lucy5Db250ZXh0TWVudS5TRVBBUkFUT1IpO1xuICBkZWZhdWx0T3B0aW9ucy5pdGVtcy5wdXNoKHtcbiAgICBrZXk6ICdtZXJnZUNlbGxzJyxcbiAgICBuYW1lOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzZWwgPSB0aGlzLmdldFNlbGVjdGVkKCk7XG4gICAgICB2YXIgaW5mbyA9IHRoaXMubWVyZ2VDZWxscy5tZXJnZWRDZWxsSW5mb0NvbGxlY3Rpb24uZ2V0SW5mbyhzZWxbMF0sIHNlbFsxXSk7XG4gICAgICBpZiAoaW5mbykge1xuICAgICAgICByZXR1cm4gJ1VubWVyZ2UgY2VsbHMnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICdNZXJnZSBjZWxscyc7XG4gICAgICB9XG4gICAgfSxcbiAgICBjYWxsYmFjazogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLm1lcmdlQ2VsbHMubWVyZ2VPclVubWVyZ2VTZWxlY3Rpb24odGhpcy5nZXRTZWxlY3RlZFJhbmdlKCkpO1xuICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9LFxuICAgIGRpc2FibGVkOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGlzLnNlbGVjdGlvbi5zZWxlY3RlZEhlYWRlci5jb3JuZXI7XG4gICAgfVxuICB9KTtcbn07XG52YXIgYWZ0ZXJSZW5kZXJlciA9IGZ1bmN0aW9uKFRELCByb3csIGNvbCwgcHJvcCwgdmFsdWUsIGNlbGxQcm9wZXJ0aWVzKSB7XG4gIGlmICh0aGlzLm1lcmdlQ2VsbHMpIHtcbiAgICB0aGlzLm1lcmdlQ2VsbHMuYXBwbHlTcGFuUHJvcGVydGllcyhURCwgcm93LCBjb2wpO1xuICB9XG59O1xudmFyIG1vZGlmeVRyYW5zZm9ybUZhY3RvcnkgPSBmdW5jdGlvbihob29rKSB7XG4gIHJldHVybiBmdW5jdGlvbihkZWx0YSkge1xuICAgIHZhciBtZXJnZUNlbGxzU2V0dGluZyA9IHRoaXMuZ2V0U2V0dGluZ3MoKS5tZXJnZUNlbGxzO1xuICAgIGlmIChtZXJnZUNlbGxzU2V0dGluZykge1xuICAgICAgdmFyIGN1cnJlbnRTZWxlY3RlZFJhbmdlID0gdGhpcy5nZXRTZWxlY3RlZFJhbmdlKCk7XG4gICAgICB0aGlzLm1lcmdlQ2VsbHMubW9kaWZ5VHJhbnNmb3JtKGhvb2ssIGN1cnJlbnRTZWxlY3RlZFJhbmdlLCBkZWx0YSk7XG4gICAgICBpZiAoaG9vayA9PT0gJ21vZGlmeVRyYW5zZm9ybUVuZCcpIHtcbiAgICAgICAgdmFyIHRvdGFsUm93cyA9IHRoaXMuY291bnRSb3dzKCk7XG4gICAgICAgIHZhciB0b3RhbENvbHMgPSB0aGlzLmNvdW50Q29scygpO1xuICAgICAgICBpZiAoY3VycmVudFNlbGVjdGVkUmFuZ2UuZnJvbS5yb3cgPCAwKSB7XG4gICAgICAgICAgY3VycmVudFNlbGVjdGVkUmFuZ2UuZnJvbS5yb3cgPSAwO1xuICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnRTZWxlY3RlZFJhbmdlLmZyb20ucm93ID4gMCAmJiBjdXJyZW50U2VsZWN0ZWRSYW5nZS5mcm9tLnJvdyA+PSB0b3RhbFJvd3MpIHtcbiAgICAgICAgICBjdXJyZW50U2VsZWN0ZWRSYW5nZS5mcm9tLnJvdyA9IGN1cnJlbnRTZWxlY3RlZFJhbmdlLmZyb20gLSAxO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjdXJyZW50U2VsZWN0ZWRSYW5nZS5mcm9tLmNvbCA8IDApIHtcbiAgICAgICAgICBjdXJyZW50U2VsZWN0ZWRSYW5nZS5mcm9tLmNvbCA9IDA7XG4gICAgICAgIH0gZWxzZSBpZiAoY3VycmVudFNlbGVjdGVkUmFuZ2UuZnJvbS5jb2wgPiAwICYmIGN1cnJlbnRTZWxlY3RlZFJhbmdlLmZyb20uY29sID49IHRvdGFsQ29scykge1xuICAgICAgICAgIGN1cnJlbnRTZWxlY3RlZFJhbmdlLmZyb20uY29sID0gdG90YWxDb2xzIC0gMTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcbn07XG52YXIgYmVmb3JlU2V0UmFuZ2VFbmQgPSBmdW5jdGlvbihjb29yZHMpIHtcbiAgdGhpcy5sYXN0RGVzaXJlZENvb3JkcyA9IG51bGw7XG4gIHZhciBtZXJnZUNlbGxzU2V0dGluZyA9IHRoaXMuZ2V0U2V0dGluZ3MoKS5tZXJnZUNlbGxzO1xuICBpZiAobWVyZ2VDZWxsc1NldHRpbmcpIHtcbiAgICB2YXIgc2VsUmFuZ2UgPSB0aGlzLmdldFNlbGVjdGVkUmFuZ2UoKTtcbiAgICBzZWxSYW5nZS5oaWdobGlnaHQgPSBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHNlbFJhbmdlLmhpZ2hsaWdodC5yb3csIHNlbFJhbmdlLmhpZ2hsaWdodC5jb2wpO1xuICAgIHNlbFJhbmdlLnRvID0gY29vcmRzO1xuICAgIHZhciByYW5nZUV4cGFuZGVkID0gZmFsc2U7XG4gICAgZG8ge1xuICAgICAgcmFuZ2VFeHBhbmRlZCA9IGZhbHNlO1xuICAgICAgZm9yICh2YXIgaSA9IDAsXG4gICAgICAgICAgaWxlbiA9IHRoaXMubWVyZ2VDZWxscy5tZXJnZWRDZWxsSW5mb0NvbGxlY3Rpb24ubGVuZ3RoOyBpIDwgaWxlbjsgaSsrKSB7XG4gICAgICAgIHZhciBjZWxsSW5mbyA9IHRoaXMubWVyZ2VDZWxscy5tZXJnZWRDZWxsSW5mb0NvbGxlY3Rpb25baV07XG4gICAgICAgIHZhciBtZXJnZWRDZWxsVG9wTGVmdCA9IG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoY2VsbEluZm8ucm93LCBjZWxsSW5mby5jb2wpO1xuICAgICAgICB2YXIgbWVyZ2VkQ2VsbEJvdHRvbVJpZ2h0ID0gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhjZWxsSW5mby5yb3cgKyBjZWxsSW5mby5yb3dzcGFuIC0gMSwgY2VsbEluZm8uY29sICsgY2VsbEluZm8uY29sc3BhbiAtIDEpO1xuICAgICAgICB2YXIgbWVyZ2VkQ2VsbFJhbmdlID0gbmV3IFdhbGtvbnRhYmxlQ2VsbFJhbmdlKG1lcmdlZENlbGxUb3BMZWZ0LCBtZXJnZWRDZWxsVG9wTGVmdCwgbWVyZ2VkQ2VsbEJvdHRvbVJpZ2h0KTtcbiAgICAgICAgaWYgKHNlbFJhbmdlLmV4cGFuZEJ5UmFuZ2UobWVyZ2VkQ2VsbFJhbmdlKSkge1xuICAgICAgICAgIGNvb3Jkcy5yb3cgPSBzZWxSYW5nZS50by5yb3c7XG4gICAgICAgICAgY29vcmRzLmNvbCA9IHNlbFJhbmdlLnRvLmNvbDtcbiAgICAgICAgICByYW5nZUV4cGFuZGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gd2hpbGUgKHJhbmdlRXhwYW5kZWQpO1xuICB9XG59O1xudmFyIGJlZm9yZURyYXdBcmVhQm9yZGVycyA9IGZ1bmN0aW9uKGNvcm5lcnMsIGNsYXNzTmFtZSkge1xuICBpZiAoY2xhc3NOYW1lICYmIGNsYXNzTmFtZSA9PSAnYXJlYScpIHtcbiAgICB2YXIgbWVyZ2VDZWxsc1NldHRpbmcgPSB0aGlzLmdldFNldHRpbmdzKCkubWVyZ2VDZWxscztcbiAgICBpZiAobWVyZ2VDZWxsc1NldHRpbmcpIHtcbiAgICAgIHZhciBzZWxSYW5nZSA9IHRoaXMuZ2V0U2VsZWN0ZWRSYW5nZSgpO1xuICAgICAgdmFyIHN0YXJ0UmFuZ2UgPSBuZXcgV2Fsa29udGFibGVDZWxsUmFuZ2Uoc2VsUmFuZ2UuZnJvbSwgc2VsUmFuZ2UuZnJvbSwgc2VsUmFuZ2UuZnJvbSk7XG4gICAgICB2YXIgc3RvcFJhbmdlID0gbmV3IFdhbGtvbnRhYmxlQ2VsbFJhbmdlKHNlbFJhbmdlLnRvLCBzZWxSYW5nZS50bywgc2VsUmFuZ2UudG8pO1xuICAgICAgZm9yICh2YXIgaSA9IDAsXG4gICAgICAgICAgaWxlbiA9IHRoaXMubWVyZ2VDZWxscy5tZXJnZWRDZWxsSW5mb0NvbGxlY3Rpb24ubGVuZ3RoOyBpIDwgaWxlbjsgaSsrKSB7XG4gICAgICAgIHZhciBjZWxsSW5mbyA9IHRoaXMubWVyZ2VDZWxscy5tZXJnZWRDZWxsSW5mb0NvbGxlY3Rpb25baV07XG4gICAgICAgIHZhciBtZXJnZWRDZWxsVG9wTGVmdCA9IG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoY2VsbEluZm8ucm93LCBjZWxsSW5mby5jb2wpO1xuICAgICAgICB2YXIgbWVyZ2VkQ2VsbEJvdHRvbVJpZ2h0ID0gbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhjZWxsSW5mby5yb3cgKyBjZWxsSW5mby5yb3dzcGFuIC0gMSwgY2VsbEluZm8uY29sICsgY2VsbEluZm8uY29sc3BhbiAtIDEpO1xuICAgICAgICB2YXIgbWVyZ2VkQ2VsbFJhbmdlID0gbmV3IFdhbGtvbnRhYmxlQ2VsbFJhbmdlKG1lcmdlZENlbGxUb3BMZWZ0LCBtZXJnZWRDZWxsVG9wTGVmdCwgbWVyZ2VkQ2VsbEJvdHRvbVJpZ2h0KTtcbiAgICAgICAgaWYgKHN0YXJ0UmFuZ2UuZXhwYW5kQnlSYW5nZShtZXJnZWRDZWxsUmFuZ2UpKSB7XG4gICAgICAgICAgY29ybmVyc1swXSA9IHN0YXJ0UmFuZ2UuZnJvbS5yb3c7XG4gICAgICAgICAgY29ybmVyc1sxXSA9IHN0YXJ0UmFuZ2UuZnJvbS5jb2w7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0b3BSYW5nZS5leHBhbmRCeVJhbmdlKG1lcmdlZENlbGxSYW5nZSkpIHtcbiAgICAgICAgICBjb3JuZXJzWzJdID0gc3RvcFJhbmdlLmZyb20ucm93O1xuICAgICAgICAgIGNvcm5lcnNbM10gPSBzdG9wUmFuZ2UuZnJvbS5jb2w7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG52YXIgYWZ0ZXJHZXRDZWxsTWV0YSA9IGZ1bmN0aW9uKHJvdywgY29sLCBjZWxsUHJvcGVydGllcykge1xuICB2YXIgbWVyZ2VDZWxsc1NldHRpbmcgPSB0aGlzLmdldFNldHRpbmdzKCkubWVyZ2VDZWxscztcbiAgaWYgKG1lcmdlQ2VsbHNTZXR0aW5nKSB7XG4gICAgdmFyIG1lcmdlUGFyZW50ID0gdGhpcy5tZXJnZUNlbGxzLm1lcmdlZENlbGxJbmZvQ29sbGVjdGlvbi5nZXRJbmZvKHJvdywgY29sKTtcbiAgICBpZiAobWVyZ2VQYXJlbnQgJiYgKG1lcmdlUGFyZW50LnJvdyAhPSByb3cgfHwgbWVyZ2VQYXJlbnQuY29sICE9IGNvbCkpIHtcbiAgICAgIGNlbGxQcm9wZXJ0aWVzLmNvcHlhYmxlID0gZmFsc2U7XG4gICAgfVxuICB9XG59O1xudmFyIGFmdGVyVmlld3BvcnRSb3dDYWxjdWxhdG9yT3ZlcnJpZGUgPSBmdW5jdGlvbihjYWxjKSB7XG4gIHZhciBtZXJnZUNlbGxzU2V0dGluZyA9IHRoaXMuZ2V0U2V0dGluZ3MoKS5tZXJnZUNlbGxzO1xuICBpZiAobWVyZ2VDZWxsc1NldHRpbmcpIHtcbiAgICB2YXIgY29sQ291bnQgPSB0aGlzLmNvdW50Q29scygpO1xuICAgIHZhciBtZXJnZVBhcmVudDtcbiAgICBmb3IgKHZhciBjID0gMDsgYyA8IGNvbENvdW50OyBjKyspIHtcbiAgICAgIG1lcmdlUGFyZW50ID0gdGhpcy5tZXJnZUNlbGxzLm1lcmdlZENlbGxJbmZvQ29sbGVjdGlvbi5nZXRJbmZvKGNhbGMuc3RhcnRSb3csIGMpO1xuICAgICAgaWYgKG1lcmdlUGFyZW50KSB7XG4gICAgICAgIGlmIChtZXJnZVBhcmVudC5yb3cgPCBjYWxjLnN0YXJ0Um93KSB7XG4gICAgICAgICAgY2FsYy5zdGFydFJvdyA9IG1lcmdlUGFyZW50LnJvdztcbiAgICAgICAgICByZXR1cm4gYWZ0ZXJWaWV3cG9ydFJvd0NhbGN1bGF0b3JPdmVycmlkZS5jYWxsKHRoaXMsIGNhbGMpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBtZXJnZVBhcmVudCA9IHRoaXMubWVyZ2VDZWxscy5tZXJnZWRDZWxsSW5mb0NvbGxlY3Rpb24uZ2V0SW5mbyhjYWxjLmVuZFJvdywgYyk7XG4gICAgICBpZiAobWVyZ2VQYXJlbnQpIHtcbiAgICAgICAgdmFyIG1lcmdlRW5kID0gbWVyZ2VQYXJlbnQucm93ICsgbWVyZ2VQYXJlbnQucm93c3BhbiAtIDE7XG4gICAgICAgIGlmIChtZXJnZUVuZCA+IGNhbGMuZW5kUm93KSB7XG4gICAgICAgICAgY2FsYy5lbmRSb3cgPSBtZXJnZUVuZDtcbiAgICAgICAgICByZXR1cm4gYWZ0ZXJWaWV3cG9ydFJvd0NhbGN1bGF0b3JPdmVycmlkZS5jYWxsKHRoaXMsIGNhbGMpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59O1xudmFyIGFmdGVyVmlld3BvcnRDb2x1bW5DYWxjdWxhdG9yT3ZlcnJpZGUgPSBmdW5jdGlvbihjYWxjKSB7XG4gIHZhciBtZXJnZUNlbGxzU2V0dGluZyA9IHRoaXMuZ2V0U2V0dGluZ3MoKS5tZXJnZUNlbGxzO1xuICBpZiAobWVyZ2VDZWxsc1NldHRpbmcpIHtcbiAgICB2YXIgcm93Q291bnQgPSB0aGlzLmNvdW50Um93cygpO1xuICAgIHZhciBtZXJnZVBhcmVudDtcbiAgICBmb3IgKHZhciByID0gMDsgciA8IHJvd0NvdW50OyByKyspIHtcbiAgICAgIG1lcmdlUGFyZW50ID0gdGhpcy5tZXJnZUNlbGxzLm1lcmdlZENlbGxJbmZvQ29sbGVjdGlvbi5nZXRJbmZvKHIsIGNhbGMuc3RhcnRDb2x1bW4pO1xuICAgICAgaWYgKG1lcmdlUGFyZW50KSB7XG4gICAgICAgIGlmIChtZXJnZVBhcmVudC5jb2wgPCBjYWxjLnN0YXJ0Q29sdW1uKSB7XG4gICAgICAgICAgY2FsYy5zdGFydENvbHVtbiA9IG1lcmdlUGFyZW50LmNvbDtcbiAgICAgICAgICByZXR1cm4gYWZ0ZXJWaWV3cG9ydENvbHVtbkNhbGN1bGF0b3JPdmVycmlkZS5jYWxsKHRoaXMsIGNhbGMpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBtZXJnZVBhcmVudCA9IHRoaXMubWVyZ2VDZWxscy5tZXJnZWRDZWxsSW5mb0NvbGxlY3Rpb24uZ2V0SW5mbyhyLCBjYWxjLmVuZENvbHVtbik7XG4gICAgICBpZiAobWVyZ2VQYXJlbnQpIHtcbiAgICAgICAgdmFyIG1lcmdlRW5kID0gbWVyZ2VQYXJlbnQuY29sICsgbWVyZ2VQYXJlbnQuY29sc3BhbiAtIDE7XG4gICAgICAgIGlmIChtZXJnZUVuZCA+IGNhbGMuZW5kQ29sdW1uKSB7XG4gICAgICAgICAgY2FsYy5lbmRDb2x1bW4gPSBtZXJnZUVuZDtcbiAgICAgICAgICByZXR1cm4gYWZ0ZXJWaWV3cG9ydENvbHVtbkNhbGN1bGF0b3JPdmVycmlkZS5jYWxsKHRoaXMsIGNhbGMpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59O1xudmFyIGlzTXVsdGlwbGVTZWxlY3Rpb24gPSBmdW5jdGlvbihpc011bHRpcGxlKSB7XG4gIGlmIChpc011bHRpcGxlICYmIHRoaXMubWVyZ2VDZWxscykge1xuICAgIHZhciBtZXJnZWRDZWxscyA9IHRoaXMubWVyZ2VDZWxscy5tZXJnZWRDZWxsSW5mb0NvbGxlY3Rpb24sXG4gICAgICAgIHNlbGVjdGlvblJhbmdlID0gdGhpcy5nZXRTZWxlY3RlZFJhbmdlKCk7XG4gICAgZm9yICh2YXIgZ3JvdXAgaW4gbWVyZ2VkQ2VsbHMpIHtcbiAgICAgIGlmIChzZWxlY3Rpb25SYW5nZS5oaWdobGlnaHQucm93ID09IG1lcmdlZENlbGxzW2dyb3VwXS5yb3cgJiYgc2VsZWN0aW9uUmFuZ2UuaGlnaGxpZ2h0LmNvbCA9PSBtZXJnZWRDZWxsc1tncm91cF0uY29sICYmIHNlbGVjdGlvblJhbmdlLnRvLnJvdyA9PSBtZXJnZWRDZWxsc1tncm91cF0ucm93ICsgbWVyZ2VkQ2VsbHNbZ3JvdXBdLnJvd3NwYW4gLSAxICYmIHNlbGVjdGlvblJhbmdlLnRvLmNvbCA9PSBtZXJnZWRDZWxsc1tncm91cF0uY29sICsgbWVyZ2VkQ2VsbHNbZ3JvdXBdLmNvbHNwYW4gLSAxKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIGlzTXVsdGlwbGU7XG59O1xuZnVuY3Rpb24gbW9kaWZ5QXV0b2ZpbGxSYW5nZShzZWxlY3QsIGRyYWcpIHtcbiAgdmFyIG1lcmdlQ2VsbHNTZXR0aW5nID0gdGhpcy5nZXRTZXR0aW5ncygpLm1lcmdlQ2VsbHM7XG4gIGlmICghbWVyZ2VDZWxsc1NldHRpbmcgfHwgdGhpcy5zZWxlY3Rpb24uaXNNdWx0aXBsZSgpKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHZhciBpbmZvID0gdGhpcy5tZXJnZUNlbGxzLm1lcmdlZENlbGxJbmZvQ29sbGVjdGlvbi5nZXRJbmZvKHNlbGVjdFswXSwgc2VsZWN0WzFdKTtcbiAgaWYgKGluZm8pIHtcbiAgICBzZWxlY3RbMF0gPSBpbmZvLnJvdztcbiAgICBzZWxlY3RbMV0gPSBpbmZvLmNvbDtcbiAgICBzZWxlY3RbMl0gPSBpbmZvLnJvdyArIGluZm8ucm93c3BhbiAtIDE7XG4gICAgc2VsZWN0WzNdID0gaW5mby5jb2wgKyBpbmZvLmNvbHNwYW4gLSAxO1xuICB9XG59XG5mdW5jdGlvbiBvbkFmdGVyQ3JlYXRlQ29sKGNvbCwgY291bnQpIHtcbiAgaWYgKHRoaXMubWVyZ2VDZWxscykge1xuICAgIHRoaXMubWVyZ2VDZWxscy5zaGlmdENvbGxlY3Rpb24oJ3JpZ2h0JywgY29sLCBjb3VudCk7XG4gIH1cbn1cbmZ1bmN0aW9uIG9uQWZ0ZXJSZW1vdmVDb2woY29sLCBjb3VudCkge1xuICBpZiAodGhpcy5tZXJnZUNlbGxzKSB7XG4gICAgdGhpcy5tZXJnZUNlbGxzLnNoaWZ0Q29sbGVjdGlvbignbGVmdCcsIGNvbCwgY291bnQpO1xuICB9XG59XG5mdW5jdGlvbiBvbkFmdGVyQ3JlYXRlUm93KHJvdywgY291bnQpIHtcbiAgaWYgKHRoaXMubWVyZ2VDZWxscykge1xuICAgIHRoaXMubWVyZ2VDZWxscy5zaGlmdENvbGxlY3Rpb24oJ2Rvd24nLCByb3csIGNvdW50KTtcbiAgfVxufVxuZnVuY3Rpb24gb25BZnRlclJlbW92ZVJvdyhyb3csIGNvdW50KSB7XG4gIGlmICh0aGlzLm1lcmdlQ2VsbHMpIHtcbiAgICB0aGlzLm1lcmdlQ2VsbHMuc2hpZnRDb2xsZWN0aW9uKCd1cCcsIHJvdywgY291bnQpO1xuICB9XG59XG5IYW5kc29udGFibGUuaG9va3MuYWRkKCdiZWZvcmVJbml0JywgYmVmb3JlSW5pdCk7XG5IYW5kc29udGFibGUuaG9va3MuYWRkKCdhZnRlckluaXQnLCBhZnRlckluaXQpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLmFkZCgnYWZ0ZXJVcGRhdGVTZXR0aW5ncycsIGFmdGVyVXBkYXRlU2V0dGluZ3MpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLmFkZCgnYmVmb3JlS2V5RG93bicsIG9uQmVmb3JlS2V5RG93bik7XG5IYW5kc29udGFibGUuaG9va3MuYWRkKCdtb2RpZnlUcmFuc2Zvcm1TdGFydCcsIG1vZGlmeVRyYW5zZm9ybUZhY3RvcnkoJ21vZGlmeVRyYW5zZm9ybVN0YXJ0JykpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLmFkZCgnbW9kaWZ5VHJhbnNmb3JtRW5kJywgbW9kaWZ5VHJhbnNmb3JtRmFjdG9yeSgnbW9kaWZ5VHJhbnNmb3JtRW5kJykpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLmFkZCgnYmVmb3JlU2V0UmFuZ2VFbmQnLCBiZWZvcmVTZXRSYW5nZUVuZCk7XG5IYW5kc29udGFibGUuaG9va3MuYWRkKCdiZWZvcmVEcmF3Qm9yZGVycycsIGJlZm9yZURyYXdBcmVhQm9yZGVycyk7XG5IYW5kc29udGFibGUuaG9va3MuYWRkKCdhZnRlcklzTXVsdGlwbGVTZWxlY3Rpb24nLCBpc011bHRpcGxlU2VsZWN0aW9uKTtcbkhhbmRzb250YWJsZS5ob29rcy5hZGQoJ2FmdGVyUmVuZGVyZXInLCBhZnRlclJlbmRlcmVyKTtcbkhhbmRzb250YWJsZS5ob29rcy5hZGQoJ2FmdGVyQ29udGV4dE1lbnVEZWZhdWx0T3B0aW9ucycsIGFkZE1lcmdlQWN0aW9uc1RvQ29udGV4dE1lbnUpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLmFkZCgnYWZ0ZXJHZXRDZWxsTWV0YScsIGFmdGVyR2V0Q2VsbE1ldGEpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLmFkZCgnYWZ0ZXJWaWV3cG9ydFJvd0NhbGN1bGF0b3JPdmVycmlkZScsIGFmdGVyVmlld3BvcnRSb3dDYWxjdWxhdG9yT3ZlcnJpZGUpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLmFkZCgnYWZ0ZXJWaWV3cG9ydENvbHVtbkNhbGN1bGF0b3JPdmVycmlkZScsIGFmdGVyVmlld3BvcnRDb2x1bW5DYWxjdWxhdG9yT3ZlcnJpZGUpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLmFkZCgnbW9kaWZ5QXV0b2ZpbGxSYW5nZScsIG1vZGlmeUF1dG9maWxsUmFuZ2UpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLmFkZCgnYWZ0ZXJDcmVhdGVDb2wnLCBvbkFmdGVyQ3JlYXRlQ29sKTtcbkhhbmRzb250YWJsZS5ob29rcy5hZGQoJ2FmdGVyUmVtb3ZlQ29sJywgb25BZnRlclJlbW92ZUNvbCk7XG5IYW5kc29udGFibGUuaG9va3MuYWRkKCdhZnRlckNyZWF0ZVJvdycsIG9uQWZ0ZXJDcmVhdGVSb3cpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLmFkZCgnYWZ0ZXJSZW1vdmVSb3cnLCBvbkFmdGVyUmVtb3ZlUm93KTtcbkhhbmRzb250YWJsZS5NZXJnZUNlbGxzID0gTWVyZ2VDZWxscztcblxuLy8jIFxufSx7XCIzcmRwYXJ0eS93YWxrb250YWJsZS9zcmMvY2VsbC9jb29yZHNcIjo2LFwiM3JkcGFydHkvd2Fsa29udGFibGUvc3JjL2NlbGwvcmFuZ2VcIjo3LFwiM3JkcGFydHkvd2Fsa29udGFibGUvc3JjL3RhYmxlXCI6MjEsXCJicm93c2VyXCI6MjQsXCJoZWxwZXJzL2RvbS9ldmVudFwiOjQ4LFwicGx1Z2luc1wiOjYxfV0sMTA5OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBNdWx0aXBsZVNlbGVjdGlvbkhhbmRsZXM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIE11bHRpcGxlU2VsZWN0aW9uSGFuZGxlcztcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgJF9fMSA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSksXG4gICAgZ2V0V2luZG93U2Nyb2xsVG9wID0gJF9fMS5nZXRXaW5kb3dTY3JvbGxUb3AsXG4gICAgaGFzQ2xhc3MgPSAkX18xLmhhc0NsYXNzLFxuICAgIGdldFdpbmRvd1Njcm9sbExlZnQgPSAkX18xLmdldFdpbmRvd1Njcm9sbExlZnQ7XG52YXIgaXNNb2JpbGVCcm93c2VyID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYnJvd3Nlcl9fID0gX2RlcmVxXyhcImhlbHBlcnMvYnJvd3NlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19icm93c2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19icm93c2VyX199KS5pc01vYmlsZUJyb3dzZXI7XG52YXIgQmFzZVBsdWdpbiA9ICgkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fID0gX2RlcmVxXyhcIl9iYXNlXCIpLCAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fICYmICRfX180Nl9fNDZfXzQ3X185NV9iYXNlX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9ffSkuZGVmYXVsdDtcbnZhciBFdmVudE1hbmFnZXIgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gPSBfZGVyZXFfKFwiZXZlbnRNYW5hZ2VyXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfX30pLkV2ZW50TWFuYWdlcjtcbnZhciByZWdpc3RlclBsdWdpbiA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gPSBfZGVyZXFfKFwicGx1Z2luc1wiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19ffSkucmVnaXN0ZXJQbHVnaW47XG52YXIgTXVsdGlwbGVTZWxlY3Rpb25IYW5kbGVzID0gZnVuY3Rpb24gTXVsdGlwbGVTZWxlY3Rpb25IYW5kbGVzKGhvdEluc3RhbmNlKSB7XG4gICR0cmFjZXVyUnVudGltZS5zdXBlckNvbnN0cnVjdG9yKCRNdWx0aXBsZVNlbGVjdGlvbkhhbmRsZXMpLmNhbGwodGhpcywgaG90SW5zdGFuY2UpO1xuICB0aGlzLmRyYWdnZWQgPSBbXTtcbiAgdGhpcy5ldmVudE1hbmFnZXIgPSBudWxsO1xuICB0aGlzLmxhc3RTZXRDZWxsID0gbnVsbDtcbn07XG52YXIgJE11bHRpcGxlU2VsZWN0aW9uSGFuZGxlcyA9IE11bHRpcGxlU2VsZWN0aW9uSGFuZGxlcztcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKE11bHRpcGxlU2VsZWN0aW9uSGFuZGxlcywge1xuICBpc0VuYWJsZWQ6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBpc01vYmlsZUJyb3dzZXIoKTtcbiAgfSxcbiAgZW5hYmxlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5lbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICghdGhpcy5ldmVudE1hbmFnZXIpIHtcbiAgICAgIHRoaXMuZXZlbnRNYW5hZ2VyID0gbmV3IEV2ZW50TWFuYWdlcih0aGlzKTtcbiAgICB9XG4gICAgdGhpcy5yZWdpc3Rlckxpc3RlbmVycygpO1xuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkTXVsdGlwbGVTZWxlY3Rpb25IYW5kbGVzLnByb3RvdHlwZSwgXCJlbmFibGVQbHVnaW5cIikuY2FsbCh0aGlzKTtcbiAgfSxcbiAgcmVnaXN0ZXJMaXN0ZW5lcnM6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgZnVuY3Rpb24gcmVtb3ZlRnJvbURyYWdnZWQocXVlcnkpIHtcbiAgICAgIGlmIChfdGhpcy5kcmFnZ2VkLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICBfdGhpcy5kcmFnZ2VkLnNwbGljZSgwLCBfdGhpcy5kcmFnZ2VkLmxlbmd0aCk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgICAgdmFyIGVudHJ5UG9zaXRpb24gPSBfdGhpcy5kcmFnZ2VkLmluZGV4T2YocXVlcnkpO1xuICAgICAgaWYgKGVudHJ5UG9zaXRpb24gPT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSBlbHNlIGlmIChlbnRyeVBvc2l0aW9uID09PSAwKSB7XG4gICAgICAgIF90aGlzLmRyYWdnZWQgPSBfdGhpcy5kcmFnZ2VkLnNsaWNlKDAsIDEpO1xuICAgICAgfSBlbHNlIGlmIChlbnRyeVBvc2l0aW9uID09IDEpIHtcbiAgICAgICAgX3RoaXMuZHJhZ2dlZCA9IF90aGlzLmRyYWdnZWQuc2xpY2UoLTEpO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKHRoaXMuaG90LnJvb3RFbGVtZW50LCAndG91Y2hzdGFydCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICB2YXIgc2VsZWN0ZWRSYW5nZTtcbiAgICAgIGlmIChoYXNDbGFzcyhldmVudC50YXJnZXQsICd0b3BMZWZ0U2VsZWN0aW9uSGFuZGxlLUhpdEFyZWEnKSkge1xuICAgICAgICBzZWxlY3RlZFJhbmdlID0gX3RoaXMuaG90LmdldFNlbGVjdGVkUmFuZ2UoKTtcbiAgICAgICAgX3RoaXMuZHJhZ2dlZC5wdXNoKCd0b3BMZWZ0Jyk7XG4gICAgICAgIF90aGlzLnRvdWNoU3RhcnRSYW5nZSA9IHtcbiAgICAgICAgICB3aWR0aDogc2VsZWN0ZWRSYW5nZS5nZXRXaWR0aCgpLFxuICAgICAgICAgIGhlaWdodDogc2VsZWN0ZWRSYW5nZS5nZXRIZWlnaHQoKSxcbiAgICAgICAgICBkaXJlY3Rpb246IHNlbGVjdGVkUmFuZ2UuZ2V0RGlyZWN0aW9uKClcbiAgICAgICAgfTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSBlbHNlIGlmIChoYXNDbGFzcyhldmVudC50YXJnZXQsICdib3R0b21SaWdodFNlbGVjdGlvbkhhbmRsZS1IaXRBcmVhJykpIHtcbiAgICAgICAgc2VsZWN0ZWRSYW5nZSA9IF90aGlzLmhvdC5nZXRTZWxlY3RlZFJhbmdlKCk7XG4gICAgICAgIF90aGlzLmRyYWdnZWQucHVzaCgnYm90dG9tUmlnaHQnKTtcbiAgICAgICAgX3RoaXMudG91Y2hTdGFydFJhbmdlID0ge1xuICAgICAgICAgIHdpZHRoOiBzZWxlY3RlZFJhbmdlLmdldFdpZHRoKCksXG4gICAgICAgICAgaGVpZ2h0OiBzZWxlY3RlZFJhbmdlLmdldEhlaWdodCgpLFxuICAgICAgICAgIGRpcmVjdGlvbjogc2VsZWN0ZWRSYW5nZS5nZXREaXJlY3Rpb24oKVxuICAgICAgICB9O1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLmhvdC5yb290RWxlbWVudCwgJ3RvdWNoZW5kJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGlmIChoYXNDbGFzcyhldmVudC50YXJnZXQsICd0b3BMZWZ0U2VsZWN0aW9uSGFuZGxlLUhpdEFyZWEnKSkge1xuICAgICAgICByZW1vdmVGcm9tRHJhZ2dlZC5jYWxsKF90aGlzLCAndG9wTGVmdCcpO1xuICAgICAgICBfdGhpcy50b3VjaFN0YXJ0UmFuZ2UgPSB2b2lkIDA7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0gZWxzZSBpZiAoaGFzQ2xhc3MoZXZlbnQudGFyZ2V0LCAnYm90dG9tUmlnaHRTZWxlY3Rpb25IYW5kbGUtSGl0QXJlYScpKSB7XG4gICAgICAgIHJlbW92ZUZyb21EcmFnZ2VkLmNhbGwoX3RoaXMsICdib3R0b21SaWdodCcpO1xuICAgICAgICBfdGhpcy50b3VjaFN0YXJ0UmFuZ2UgPSB2b2lkIDA7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKHRoaXMuaG90LnJvb3RFbGVtZW50LCAndG91Y2htb3ZlJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIHZhciBzY3JvbGxUb3AgPSBnZXRXaW5kb3dTY3JvbGxUb3AoKSxcbiAgICAgICAgICBzY3JvbGxMZWZ0ID0gZ2V0V2luZG93U2Nyb2xsTGVmdCgpLFxuICAgICAgICAgIGVuZFRhcmdldCxcbiAgICAgICAgICB0YXJnZXRDb29yZHMsXG4gICAgICAgICAgc2VsZWN0ZWRSYW5nZSxcbiAgICAgICAgICByYW5nZVdpZHRoLFxuICAgICAgICAgIHJhbmdlSGVpZ2h0LFxuICAgICAgICAgIHJhbmdlRGlyZWN0aW9uLFxuICAgICAgICAgIG5ld1JhbmdlQ29vcmRzO1xuICAgICAgaWYgKF90aGlzLmRyYWdnZWQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGVuZFRhcmdldCA9IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoZXZlbnQudG91Y2hlc1swXS5zY3JlZW5YIC0gc2Nyb2xsTGVmdCwgZXZlbnQudG91Y2hlc1swXS5zY3JlZW5ZIC0gc2Nyb2xsVG9wKTtcbiAgICAgIGlmICghZW5kVGFyZ2V0IHx8IGVuZFRhcmdldCA9PT0gX3RoaXMubGFzdFNldENlbGwpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGVuZFRhcmdldC5ub2RlTmFtZSA9PSAnVEQnIHx8IGVuZFRhcmdldC5ub2RlTmFtZSA9PSAnVEgnKSB7XG4gICAgICAgIHRhcmdldENvb3JkcyA9IF90aGlzLmhvdC5nZXRDb29yZHMoZW5kVGFyZ2V0KTtcbiAgICAgICAgaWYgKHRhcmdldENvb3Jkcy5jb2wgPT0gLTEpIHtcbiAgICAgICAgICB0YXJnZXRDb29yZHMuY29sID0gMDtcbiAgICAgICAgfVxuICAgICAgICBzZWxlY3RlZFJhbmdlID0gX3RoaXMuaG90LmdldFNlbGVjdGVkUmFuZ2UoKTtcbiAgICAgICAgcmFuZ2VXaWR0aCA9IHNlbGVjdGVkUmFuZ2UuZ2V0V2lkdGgoKTtcbiAgICAgICAgcmFuZ2VIZWlnaHQgPSBzZWxlY3RlZFJhbmdlLmdldEhlaWdodCgpO1xuICAgICAgICByYW5nZURpcmVjdGlvbiA9IHNlbGVjdGVkUmFuZ2UuZ2V0RGlyZWN0aW9uKCk7XG4gICAgICAgIGlmIChyYW5nZVdpZHRoID09IDEgJiYgcmFuZ2VIZWlnaHQgPT0gMSkge1xuICAgICAgICAgIF90aGlzLmhvdC5zZWxlY3Rpb24uc2V0UmFuZ2VFbmQodGFyZ2V0Q29vcmRzKTtcbiAgICAgICAgfVxuICAgICAgICBuZXdSYW5nZUNvb3JkcyA9IF90aGlzLmdldEN1cnJlbnRSYW5nZUNvb3JkcyhzZWxlY3RlZFJhbmdlLCB0YXJnZXRDb29yZHMsIF90aGlzLnRvdWNoU3RhcnRSYW5nZS5kaXJlY3Rpb24sIHJhbmdlRGlyZWN0aW9uLCBfdGhpcy5kcmFnZ2VkWzBdKTtcbiAgICAgICAgaWYgKG5ld1JhbmdlQ29vcmRzLnN0YXJ0ICE9PSBudWxsKSB7XG4gICAgICAgICAgX3RoaXMuaG90LnNlbGVjdGlvbi5zZXRSYW5nZVN0YXJ0KG5ld1JhbmdlQ29vcmRzLnN0YXJ0KTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcy5ob3Quc2VsZWN0aW9uLnNldFJhbmdlRW5kKG5ld1JhbmdlQ29vcmRzLmVuZCk7XG4gICAgICAgIF90aGlzLmxhc3RTZXRDZWxsID0gZW5kVGFyZ2V0O1xuICAgICAgfVxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgfSxcbiAgZ2V0Q3VycmVudFJhbmdlQ29vcmRzOiBmdW5jdGlvbihzZWxlY3RlZFJhbmdlLCBjdXJyZW50VG91Y2gsIHRvdWNoU3RhcnREaXJlY3Rpb24sIGN1cnJlbnREaXJlY3Rpb24sIGRyYWdnZWRIYW5kbGUpIHtcbiAgICB2YXIgdG9wTGVmdENvcm5lciA9IHNlbGVjdGVkUmFuZ2UuZ2V0VG9wTGVmdENvcm5lcigpLFxuICAgICAgICBib3R0b21SaWdodENvcm5lciA9IHNlbGVjdGVkUmFuZ2UuZ2V0Qm90dG9tUmlnaHRDb3JuZXIoKSxcbiAgICAgICAgYm90dG9tTGVmdENvcm5lciA9IHNlbGVjdGVkUmFuZ2UuZ2V0Qm90dG9tTGVmdENvcm5lcigpLFxuICAgICAgICB0b3BSaWdodENvcm5lciA9IHNlbGVjdGVkUmFuZ2UuZ2V0VG9wUmlnaHRDb3JuZXIoKTtcbiAgICB2YXIgbmV3Q29vcmRzID0ge1xuICAgICAgc3RhcnQ6IG51bGwsXG4gICAgICBlbmQ6IG51bGxcbiAgICB9O1xuICAgIHN3aXRjaCAodG91Y2hTdGFydERpcmVjdGlvbikge1xuICAgICAgY2FzZSAnTkUtU1cnOlxuICAgICAgICBzd2l0Y2ggKGN1cnJlbnREaXJlY3Rpb24pIHtcbiAgICAgICAgICBjYXNlICdORS1TVyc6XG4gICAgICAgICAgY2FzZSAnTlctU0UnOlxuICAgICAgICAgICAgaWYgKGRyYWdnZWRIYW5kbGUgPT0gJ3RvcExlZnQnKSB7XG4gICAgICAgICAgICAgIG5ld0Nvb3JkcyA9IHtcbiAgICAgICAgICAgICAgICBzdGFydDogbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhjdXJyZW50VG91Y2gucm93LCBzZWxlY3RlZFJhbmdlLmhpZ2hsaWdodC5jb2wpLFxuICAgICAgICAgICAgICAgIGVuZDogbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3Jkcyhib3R0b21MZWZ0Q29ybmVyLnJvdywgY3VycmVudFRvdWNoLmNvbClcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIG5ld0Nvb3JkcyA9IHtcbiAgICAgICAgICAgICAgICBzdGFydDogbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhzZWxlY3RlZFJhbmdlLmhpZ2hsaWdodC5yb3csIGN1cnJlbnRUb3VjaC5jb2wpLFxuICAgICAgICAgICAgICAgIGVuZDogbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhjdXJyZW50VG91Y2gucm93LCB0b3BMZWZ0Q29ybmVyLmNvbClcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ1NFLU5XJzpcbiAgICAgICAgICAgIGlmIChkcmFnZ2VkSGFuZGxlID09ICdib3R0b21SaWdodCcpIHtcbiAgICAgICAgICAgICAgbmV3Q29vcmRzID0ge1xuICAgICAgICAgICAgICAgIHN0YXJ0OiBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKGJvdHRvbVJpZ2h0Q29ybmVyLnJvdywgY3VycmVudFRvdWNoLmNvbCksXG4gICAgICAgICAgICAgICAgZW5kOiBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKGN1cnJlbnRUb3VjaC5yb3csIHRvcExlZnRDb3JuZXIuY29sKVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdOVy1TRSc6XG4gICAgICAgIHN3aXRjaCAoY3VycmVudERpcmVjdGlvbikge1xuICAgICAgICAgIGNhc2UgJ05FLVNXJzpcbiAgICAgICAgICAgIGlmIChkcmFnZ2VkSGFuZGxlID09ICd0b3BMZWZ0Jykge1xuICAgICAgICAgICAgICBuZXdDb29yZHMgPSB7XG4gICAgICAgICAgICAgICAgc3RhcnQ6IGN1cnJlbnRUb3VjaCxcbiAgICAgICAgICAgICAgICBlbmQ6IGJvdHRvbUxlZnRDb3JuZXJcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIG5ld0Nvb3Jkcy5lbmQgPSBjdXJyZW50VG91Y2g7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdOVy1TRSc6XG4gICAgICAgICAgICBpZiAoZHJhZ2dlZEhhbmRsZSA9PSAndG9wTGVmdCcpIHtcbiAgICAgICAgICAgICAgbmV3Q29vcmRzID0ge1xuICAgICAgICAgICAgICAgIHN0YXJ0OiBjdXJyZW50VG91Y2gsXG4gICAgICAgICAgICAgICAgZW5kOiBib3R0b21SaWdodENvcm5lclxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgbmV3Q29vcmRzLmVuZCA9IGN1cnJlbnRUb3VjaDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ1NFLU5XJzpcbiAgICAgICAgICAgIGlmIChkcmFnZ2VkSGFuZGxlID09ICd0b3BMZWZ0Jykge1xuICAgICAgICAgICAgICBuZXdDb29yZHMgPSB7XG4gICAgICAgICAgICAgICAgc3RhcnQ6IGN1cnJlbnRUb3VjaCxcbiAgICAgICAgICAgICAgICBlbmQ6IHRvcExlZnRDb3JuZXJcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIG5ld0Nvb3Jkcy5lbmQgPSBjdXJyZW50VG91Y2g7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdTVy1ORSc6XG4gICAgICAgICAgICBpZiAoZHJhZ2dlZEhhbmRsZSA9PSAndG9wTGVmdCcpIHtcbiAgICAgICAgICAgICAgbmV3Q29vcmRzID0ge1xuICAgICAgICAgICAgICAgIHN0YXJ0OiBjdXJyZW50VG91Y2gsXG4gICAgICAgICAgICAgICAgZW5kOiB0b3BSaWdodENvcm5lclxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgbmV3Q29vcmRzLmVuZCA9IGN1cnJlbnRUb3VjaDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnU1ctTkUnOlxuICAgICAgICBzd2l0Y2ggKGN1cnJlbnREaXJlY3Rpb24pIHtcbiAgICAgICAgICBjYXNlICdOVy1TRSc6XG4gICAgICAgICAgICBpZiAoZHJhZ2dlZEhhbmRsZSA9PSAnYm90dG9tUmlnaHQnKSB7XG4gICAgICAgICAgICAgIG5ld0Nvb3JkcyA9IHtcbiAgICAgICAgICAgICAgICBzdGFydDogbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhjdXJyZW50VG91Y2gucm93LCB0b3BMZWZ0Q29ybmVyLmNvbCksXG4gICAgICAgICAgICAgICAgZW5kOiBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKGJvdHRvbUxlZnRDb3JuZXIucm93LCBjdXJyZW50VG91Y2guY29sKVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgbmV3Q29vcmRzID0ge1xuICAgICAgICAgICAgICAgIHN0YXJ0OiBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHRvcExlZnRDb3JuZXIucm93LCBjdXJyZW50VG91Y2guY29sKSxcbiAgICAgICAgICAgICAgICBlbmQ6IG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoY3VycmVudFRvdWNoLnJvdywgYm90dG9tUmlnaHRDb3JuZXIuY29sKVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnU1ctTkUnOlxuICAgICAgICAgICAgaWYgKGRyYWdnZWRIYW5kbGUgPT0gJ3RvcExlZnQnKSB7XG4gICAgICAgICAgICAgIG5ld0Nvb3JkcyA9IHtcbiAgICAgICAgICAgICAgICBzdGFydDogbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhzZWxlY3RlZFJhbmdlLmhpZ2hsaWdodC5yb3csIGN1cnJlbnRUb3VjaC5jb2wpLFxuICAgICAgICAgICAgICAgIGVuZDogbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhjdXJyZW50VG91Y2gucm93LCBib3R0b21SaWdodENvcm5lci5jb2wpXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBuZXdDb29yZHMgPSB7XG4gICAgICAgICAgICAgICAgc3RhcnQ6IG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoY3VycmVudFRvdWNoLnJvdywgdG9wTGVmdENvcm5lci5jb2wpLFxuICAgICAgICAgICAgICAgIGVuZDogbmV3IFdhbGtvbnRhYmxlQ2VsbENvb3Jkcyh0b3BMZWZ0Q29ybmVyLnJvdywgY3VycmVudFRvdWNoLmNvbClcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ1NFLU5XJzpcbiAgICAgICAgICAgIGlmIChkcmFnZ2VkSGFuZGxlID09ICdib3R0b21SaWdodCcpIHtcbiAgICAgICAgICAgICAgbmV3Q29vcmRzID0ge1xuICAgICAgICAgICAgICAgIHN0YXJ0OiBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKGN1cnJlbnRUb3VjaC5yb3csIHRvcFJpZ2h0Q29ybmVyLmNvbCksXG4gICAgICAgICAgICAgICAgZW5kOiBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHRvcExlZnRDb3JuZXIucm93LCBjdXJyZW50VG91Y2guY29sKVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChkcmFnZ2VkSGFuZGxlID09ICd0b3BMZWZ0Jykge1xuICAgICAgICAgICAgICBuZXdDb29yZHMgPSB7XG4gICAgICAgICAgICAgICAgc3RhcnQ6IGJvdHRvbUxlZnRDb3JuZXIsXG4gICAgICAgICAgICAgICAgZW5kOiBjdXJyZW50VG91Y2hcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnU0UtTlcnOlxuICAgICAgICBzd2l0Y2ggKGN1cnJlbnREaXJlY3Rpb24pIHtcbiAgICAgICAgICBjYXNlICdOVy1TRSc6XG4gICAgICAgICAgY2FzZSAnTkUtU1cnOlxuICAgICAgICAgIGNhc2UgJ1NXLU5FJzpcbiAgICAgICAgICAgIGlmIChkcmFnZ2VkSGFuZGxlID09ICd0b3BMZWZ0Jykge1xuICAgICAgICAgICAgICBuZXdDb29yZHMuZW5kID0gY3VycmVudFRvdWNoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnU0UtTlcnOlxuICAgICAgICAgICAgaWYgKGRyYWdnZWRIYW5kbGUgPT0gJ3RvcExlZnQnKSB7XG4gICAgICAgICAgICAgIG5ld0Nvb3Jkcy5lbmQgPSBjdXJyZW50VG91Y2g7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBuZXdDb29yZHMgPSB7XG4gICAgICAgICAgICAgICAgc3RhcnQ6IGN1cnJlbnRUb3VjaCxcbiAgICAgICAgICAgICAgICBlbmQ6IHRvcExlZnRDb3JuZXJcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICByZXR1cm4gbmV3Q29vcmRzO1xuICB9LFxuICBpc0RyYWdnZWQ6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmRyYWdnZWQubGVuZ3RoID4gMDtcbiAgfVxufSwge30sIEJhc2VQbHVnaW4pO1xuO1xucmVnaXN0ZXJQbHVnaW4oJ211bHRpcGxlU2VsZWN0aW9uSGFuZGxlcycsIE11bHRpcGxlU2VsZWN0aW9uSGFuZGxlcyk7XG5cbi8vIyBcbn0se1wiX2Jhc2VcIjo2MixcImJyb3dzZXJcIjoyNCxcImV2ZW50TWFuYWdlclwiOjQyLFwiaGVscGVycy9icm93c2VyXCI6NDQsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJwbHVnaW5zXCI6NjF9XSwxMTA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIERhdGFPYnNlcnZlcjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gRGF0YU9ic2VydmVyO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19qc29ucGF0Y2hfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19taXhpbnNfNDdfbG9jYWxIb29rc19fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18sXG4gICAgJF9fdXRpbHNfXztcbnZhciBqc29ucGF0Y2ggPSAoJF9fanNvbnBhdGNoX18gPSBfZGVyZXFfKFwianNvbnBhdGNoXCIpLCAkX19qc29ucGF0Y2hfXyAmJiAkX19qc29ucGF0Y2hfXy5fX2VzTW9kdWxlICYmICRfX2pzb25wYXRjaF9fIHx8IHtkZWZhdWx0OiAkX19qc29ucGF0Y2hfX30pLmRlZmF1bHQ7XG52YXIgbG9jYWxIb29rcyA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19taXhpbnNfNDdfbG9jYWxIb29rc19fID0gX2RlcmVxXyhcIi4uLy4uL21peGlucy9sb2NhbEhvb2tzXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19taXhpbnNfNDdfbG9jYWxIb29rc19fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X21peGluc180N19sb2NhbEhvb2tzX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19taXhpbnNfNDdfbG9jYWxIb29rc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19taXhpbnNfNDdfbG9jYWxIb29rc19ffSkubG9jYWxIb29rcztcbnZhciBtaXhpbiA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fID0gX2RlcmVxXyhcIi4uLy4uL2hlbHBlcnMvb2JqZWN0XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9ffSkubWl4aW47XG52YXIgY2xlYW5QYXRjaGVzID0gKCRfX3V0aWxzX18gPSBfZGVyZXFfKFwidXRpbHNcIiksICRfX3V0aWxzX18gJiYgJF9fdXRpbHNfXy5fX2VzTW9kdWxlICYmICRfX3V0aWxzX18gfHwge2RlZmF1bHQ6ICRfX3V0aWxzX199KS5jbGVhblBhdGNoZXM7XG52YXIgRGF0YU9ic2VydmVyID0gZnVuY3Rpb24gRGF0YU9ic2VydmVyKG9ic2VydmVkRGF0YSkge1xuICB0aGlzLm9ic2VydmVkRGF0YSA9IG51bGw7XG4gIHRoaXMub2JzZXJ2ZXIgPSBudWxsO1xuICB0aGlzLnBhdXNlZCA9IGZhbHNlO1xuICB0aGlzLnNldE9ic2VydmVkRGF0YShvYnNlcnZlZERhdGEpO1xufTtcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKERhdGFPYnNlcnZlciwge1xuICBzZXRPYnNlcnZlZERhdGE6IGZ1bmN0aW9uKG9ic2VydmVkRGF0YSkge1xuICAgIHZhciAkX180ID0gdGhpcztcbiAgICBpZiAodGhpcy5vYnNlcnZlcikge1xuICAgICAganNvbnBhdGNoLnVub2JzZXJ2ZSh0aGlzLm9ic2VydmVkRGF0YSwgdGhpcy5vYnNlcnZlcik7XG4gICAgfVxuICAgIHRoaXMub2JzZXJ2ZWREYXRhID0gb2JzZXJ2ZWREYXRhO1xuICAgIHRoaXMub2JzZXJ2ZXIgPSBqc29ucGF0Y2gub2JzZXJ2ZSh0aGlzLm9ic2VydmVkRGF0YSwgKGZ1bmN0aW9uKHBhdGNoZXMpIHtcbiAgICAgIHJldHVybiAkX180Lm9uQ2hhbmdlKHBhdGNoZXMpO1xuICAgIH0pKTtcbiAgfSxcbiAgaXNQYXVzZWQ6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnBhdXNlZDtcbiAgfSxcbiAgcGF1c2U6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucGF1c2VkID0gdHJ1ZTtcbiAgfSxcbiAgcmVzdW1lOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnBhdXNlZCA9IGZhbHNlO1xuICB9LFxuICBvbkNoYW5nZTogZnVuY3Rpb24ocGF0Y2hlcykge1xuICAgIHRoaXMucnVuTG9jYWxIb29rcygnY2hhbmdlJywgY2xlYW5QYXRjaGVzKHBhdGNoZXMpKTtcbiAgfSxcbiAgZGVzdHJveTogZnVuY3Rpb24oKSB7XG4gICAganNvbnBhdGNoLnVub2JzZXJ2ZSh0aGlzLm9ic2VydmVkRGF0YSwgdGhpcy5vYnNlcnZlcik7XG4gICAgdGhpcy5vYnNlcnZlZERhdGEgPSBudWxsO1xuICAgIHRoaXMub2JzZXJ2ZXIgPSBudWxsO1xuICB9XG59LCB7fSk7XG5taXhpbihEYXRhT2JzZXJ2ZXIsIGxvY2FsSG9va3MpO1xuO1xuXG4vLyMgXG59LHtcIi4uLy4uL2hlbHBlcnMvb2JqZWN0XCI6NTMsXCIuLi8uLi9taXhpbnMvbG9jYWxIb29rc1wiOjU4LFwianNvbnBhdGNoXCI6XCJqc29ucGF0Y2hcIixcInV0aWxzXCI6MTEyfV0sMTExOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBPYnNlcnZlQ2hhbmdlczoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gT2JzZXJ2ZUNoYW5nZXM7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fLFxuICAgICRfX2pzb25wYXRjaF9fLFxuICAgICRfX2RhdGFPYnNlcnZlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX187XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX199KS5kZWZhdWx0O1xudmFyIEJhc2VQbHVnaW4gPSAoJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfXyA9IF9kZXJlcV8oXCJfYmFzZVwiKSwgJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfXyAmJiAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfX30pLmRlZmF1bHQ7XG52YXIganNvbnBhdGNoID0gKCRfX2pzb25wYXRjaF9fID0gX2RlcmVxXyhcImpzb25wYXRjaFwiKSwgJF9fanNvbnBhdGNoX18gJiYgJF9fanNvbnBhdGNoX18uX19lc01vZHVsZSAmJiAkX19qc29ucGF0Y2hfXyB8fCB7ZGVmYXVsdDogJF9fanNvbnBhdGNoX199KS5kZWZhdWx0O1xudmFyIERhdGFPYnNlcnZlciA9ICgkX19kYXRhT2JzZXJ2ZXJfXyA9IF9kZXJlcV8oXCJkYXRhT2JzZXJ2ZXJcIiksICRfX2RhdGFPYnNlcnZlcl9fICYmICRfX2RhdGFPYnNlcnZlcl9fLl9fZXNNb2R1bGUgJiYgJF9fZGF0YU9ic2VydmVyX18gfHwge2RlZmF1bHQ6ICRfX2RhdGFPYnNlcnZlcl9ffSkuRGF0YU9ic2VydmVyO1xudmFyIGFycmF5RWFjaCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gPSBfZGVyZXFfKFwiaGVscGVycy9hcnJheVwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9ffSkuYXJyYXlFYWNoO1xudmFyIHJlZ2lzdGVyUGx1Z2luID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyA9IF9kZXJlcV8oXCJwbHVnaW5zXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX199KS5yZWdpc3RlclBsdWdpbjtcbkhhbmRzb250YWJsZS5ob29rcy5yZWdpc3RlcignYWZ0ZXJDaGFuZ2VzT2JzZXJ2ZWQnKTtcbnZhciBPYnNlcnZlQ2hhbmdlcyA9IGZ1bmN0aW9uIE9ic2VydmVDaGFuZ2VzKGhvdEluc3RhbmNlKSB7XG4gICR0cmFjZXVyUnVudGltZS5zdXBlckNvbnN0cnVjdG9yKCRPYnNlcnZlQ2hhbmdlcykuY2FsbCh0aGlzLCBob3RJbnN0YW5jZSk7XG4gIHRoaXMub2JzZXJ2ZXIgPSBudWxsO1xufTtcbnZhciAkT2JzZXJ2ZUNoYW5nZXMgPSBPYnNlcnZlQ2hhbmdlcztcbigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKE9ic2VydmVDaGFuZ2VzLCB7XG4gIGlzRW5hYmxlZDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuaG90LmdldFNldHRpbmdzKCkub2JzZXJ2ZUNoYW5nZXM7XG4gIH0sXG4gIGVuYWJsZVBsdWdpbjogZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzYgPSB0aGlzO1xuICAgIGlmICh0aGlzLmVuYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCF0aGlzLm9ic2VydmVyKSB7XG4gICAgICB0aGlzLm9ic2VydmVyID0gbmV3IERhdGFPYnNlcnZlcih0aGlzLmhvdC5nZXRTb3VyY2VEYXRhKCkpO1xuICAgICAgdGhpcy5fZXhwb3NlUHVibGljQXBpKCk7XG4gICAgfVxuICAgIHRoaXMub2JzZXJ2ZXIuYWRkTG9jYWxIb29rKCdjaGFuZ2UnLCAoZnVuY3Rpb24ocGF0Y2hlcykge1xuICAgICAgcmV0dXJuICRfXzYub25EYXRhQ2hhbmdlKHBhdGNoZXMpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ2FmdGVyQ3JlYXRlUm93JywgKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICRfXzYub25BZnRlclRhYmxlQWx0ZXIoKTtcbiAgICB9KSk7XG4gICAgdGhpcy5hZGRIb29rKCdhZnRlclJlbW92ZVJvdycsIChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX182Lm9uQWZ0ZXJUYWJsZUFsdGVyKCk7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygnYWZ0ZXJDcmVhdGVDb2wnLCAoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fNi5vbkFmdGVyVGFibGVBbHRlcigpO1xuICAgIH0pKTtcbiAgICB0aGlzLmFkZEhvb2soJ2FmdGVyUmVtb3ZlQ29sJywgKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICRfXzYub25BZnRlclRhYmxlQWx0ZXIoKTtcbiAgICB9KSk7XG4gICAgdGhpcy5hZGRIb29rKCdhZnRlckNoYW5nZScsIChmdW5jdGlvbihjaGFuZ2VzLCBzb3VyY2UpIHtcbiAgICAgIHJldHVybiAkX182Lm9uQWZ0ZXJUYWJsZUFsdGVyKHNvdXJjZSk7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygnYWZ0ZXJMb2FkRGF0YScsIChmdW5jdGlvbihmaXJzdFJ1bikge1xuICAgICAgcmV0dXJuICRfXzYub25BZnRlckxvYWREYXRhKGZpcnN0UnVuKTtcbiAgICB9KSk7XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICRPYnNlcnZlQ2hhbmdlcy5wcm90b3R5cGUsIFwiZW5hYmxlUGx1Z2luXCIpLmNhbGwodGhpcyk7XG4gIH0sXG4gIGRpc2FibGVQbHVnaW46IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLm9ic2VydmVyKSB7XG4gICAgICB0aGlzLm9ic2VydmVyLmRlc3Ryb3koKTtcbiAgICAgIHRoaXMub2JzZXJ2ZXIgPSBudWxsO1xuICAgICAgdGhpcy5fZGVsZXRlUHVibGljQXBpKCk7XG4gICAgfVxuICAgICR0cmFjZXVyUnVudGltZS5zdXBlckdldCh0aGlzLCAkT2JzZXJ2ZUNoYW5nZXMucHJvdG90eXBlLCBcImRpc2FibGVQbHVnaW5cIikuY2FsbCh0aGlzKTtcbiAgfSxcbiAgb25EYXRhQ2hhbmdlOiBmdW5jdGlvbihwYXRjaGVzKSB7XG4gICAgdmFyICRfXzYgPSB0aGlzO1xuICAgIGlmICghdGhpcy5vYnNlcnZlci5pc1BhdXNlZCgpKSB7XG4gICAgICB2YXIgc291cmNlTmFtZSA9ICh0aGlzLnBsdWdpbk5hbWUgKyBcIi5jaGFuZ2VcIik7XG4gICAgICB2YXIgYWN0aW9ucyA9IHtcbiAgICAgICAgYWRkOiAoZnVuY3Rpb24ocGF0Y2gpIHtcbiAgICAgICAgICBpZiAoaXNOYU4ocGF0Y2guY29sKSkge1xuICAgICAgICAgICAgJF9fNi5ob3QucnVuSG9va3MoJ2FmdGVyQ3JlYXRlUm93JywgcGF0Y2gucm93LCAxLCBzb3VyY2VOYW1lKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJF9fNi5ob3QucnVuSG9va3MoJ2FmdGVyQ3JlYXRlQ29sJywgcGF0Y2guY29sLCAxLCBzb3VyY2VOYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pLFxuICAgICAgICByZW1vdmU6IChmdW5jdGlvbihwYXRjaCkge1xuICAgICAgICAgIGlmIChpc05hTihwYXRjaC5jb2wpKSB7XG4gICAgICAgICAgICAkX182LmhvdC5ydW5Ib29rcygnYWZ0ZXJSZW1vdmVSb3cnLCBwYXRjaC5yb3csIDEsIHNvdXJjZU5hbWUpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkX182LmhvdC5ydW5Ib29rcygnYWZ0ZXJSZW1vdmVDb2wnLCBwYXRjaC5jb2wsIDEsIHNvdXJjZU5hbWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSksXG4gICAgICAgIHJlcGxhY2U6IChmdW5jdGlvbihwYXRjaCkge1xuICAgICAgICAgICRfXzYuaG90LnJ1bkhvb2tzKCdhZnRlckNoYW5nZScsIFtwYXRjaC5yb3csIHBhdGNoLmNvbCwgbnVsbCwgcGF0Y2gudmFsdWVdLCBzb3VyY2VOYW1lKTtcbiAgICAgICAgfSlcbiAgICAgIH07XG4gICAgICBhcnJheUVhY2gocGF0Y2hlcywgKGZ1bmN0aW9uKHBhdGNoKSB7XG4gICAgICAgIGlmIChhY3Rpb25zW3BhdGNoLm9wXSkge1xuICAgICAgICAgIGFjdGlvbnNbcGF0Y2gub3BdKHBhdGNoKTtcbiAgICAgICAgfVxuICAgICAgfSkpO1xuICAgICAgdGhpcy5ob3QucmVuZGVyKCk7XG4gICAgfVxuICAgIHRoaXMuaG90LnJ1bkhvb2tzKCdhZnRlckNoYW5nZXNPYnNlcnZlZCcpO1xuICB9LFxuICBvbkFmdGVyVGFibGVBbHRlcjogZnVuY3Rpb24oc291cmNlKSB7XG4gICAgdmFyICRfXzYgPSB0aGlzO1xuICAgIGlmIChzb3VyY2UgIT09ICdsb2FkRGF0YScpIHtcbiAgICAgIHRoaXMub2JzZXJ2ZXIucGF1c2UoKTtcbiAgICAgIHRoaXMuaG90LmFkZEhvb2tPbmNlKCdhZnRlckNoYW5nZXNPYnNlcnZlZCcsIChmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICRfXzYub2JzZXJ2ZXIucmVzdW1lKCk7XG4gICAgICB9KSk7XG4gICAgfVxuICB9LFxuICBvbkFmdGVyTG9hZERhdGE6IGZ1bmN0aW9uKGZpcnN0UnVuKSB7XG4gICAgaWYgKCFmaXJzdFJ1bikge1xuICAgICAgdGhpcy5vYnNlcnZlci5zZXRPYnNlcnZlZERhdGEodGhpcy5ob3QuZ2V0U291cmNlRGF0YSgpKTtcbiAgICB9XG4gIH0sXG4gIGRlc3Ryb3k6IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLm9ic2VydmVyKSB7XG4gICAgICB0aGlzLm9ic2VydmVyLmRlc3Ryb3koKTtcbiAgICAgIHRoaXMuX2RlbGV0ZVB1YmxpY0FwaSgpO1xuICAgIH1cbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJE9ic2VydmVDaGFuZ2VzLnByb3RvdHlwZSwgXCJkZXN0cm95XCIpLmNhbGwodGhpcyk7XG4gIH0sXG4gIF9leHBvc2VQdWJsaWNBcGk6IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX182ID0gdGhpcztcbiAgICB2YXIgaG90ID0gdGhpcy5ob3Q7XG4gICAgaG90LnBhdXNlT2JzZXJ2aW5nQ2hhbmdlcyA9IChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX182Lm9ic2VydmVyLnBhdXNlKCk7XG4gICAgfSk7XG4gICAgaG90LnJlc3VtZU9ic2VydmluZ0NoYW5nZXMgPSAoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fNi5vYnNlcnZlci5yZXN1bWUoKTtcbiAgICB9KTtcbiAgICBob3QuaXNQYXVzZWRPYnNlcnZpbmdDaGFuZ2VzID0gKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICRfXzYub2JzZXJ2ZXIuaXNQYXVzZWQoKTtcbiAgICB9KTtcbiAgfSxcbiAgX2RlbGV0ZVB1YmxpY0FwaTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGhvdCA9IHRoaXMuaG90O1xuICAgIGRlbGV0ZSBob3QucGF1c2VPYnNlcnZpbmdDaGFuZ2VzO1xuICAgIGRlbGV0ZSBob3QucmVzdW1lT2JzZXJ2aW5nQ2hhbmdlcztcbiAgICBkZWxldGUgaG90LmlzUGF1c2VkT2JzZXJ2aW5nQ2hhbmdlcztcbiAgfVxufSwge30sIEJhc2VQbHVnaW4pO1xuO1xucmVnaXN0ZXJQbHVnaW4oJ29ic2VydmVDaGFuZ2VzJywgT2JzZXJ2ZUNoYW5nZXMpO1xuXG4vLyMgXG59LHtcIl9iYXNlXCI6NjIsXCJicm93c2VyXCI6MjQsXCJkYXRhT2JzZXJ2ZXJcIjoxMTAsXCJoZWxwZXJzL2FycmF5XCI6NDMsXCJqc29ucGF0Y2hcIjpcImpzb25wYXRjaFwiLFwicGx1Z2luc1wiOjYxfV0sMTEyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBjbGVhblBhdGNoZXM6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGNsZWFuUGF0Y2hlcztcbiAgICB9fSxcbiAgcGFyc2VQYXRoOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBwYXJzZVBhdGg7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXztcbnZhciAkX18wID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyA9IF9kZXJlcV8oXCIuLi8uLi9oZWxwZXJzL2FycmF5XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X199KSxcbiAgICBhcnJheUZpbHRlciA9ICRfXzAuYXJyYXlGaWx0ZXIsXG4gICAgYXJyYXlNYXAgPSAkX18wLmFycmF5TWFwO1xuZnVuY3Rpb24gY2xlYW5QYXRjaGVzKHBhdGNoZXMpIHtcbiAgdmFyIG5ld09yUmVtb3ZlZENvbHVtbnMgPSBbXTtcbiAgcGF0Y2hlcyA9IGFycmF5RmlsdGVyKHBhdGNoZXMsIChmdW5jdGlvbihwYXRjaCkge1xuICAgIGlmICgvWy9dbGVuZ3RoL2lnLnRlc3QocGF0Y2gucGF0aCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKCFwYXJzZVBhdGgocGF0Y2gucGF0aCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH0pKTtcbiAgcGF0Y2hlcyA9IGFycmF5TWFwKHBhdGNoZXMsIChmdW5jdGlvbihwYXRjaCkge1xuICAgIHZhciBjb29yZHMgPSBwYXJzZVBhdGgocGF0Y2gucGF0aCk7XG4gICAgcGF0Y2gucm93ID0gY29vcmRzLnJvdztcbiAgICBwYXRjaC5jb2wgPSBjb29yZHMuY29sO1xuICAgIHJldHVybiBwYXRjaDtcbiAgfSkpO1xuICBwYXRjaGVzID0gYXJyYXlGaWx0ZXIocGF0Y2hlcywgZnVuY3Rpb24ocGF0Y2gpIHtcbiAgICBpZiAoWydhZGQnLCAncmVtb3ZlJ10uaW5kZXhPZihwYXRjaC5vcCkgIT09IC0xICYmICFpc05hTihwYXRjaC5jb2wpKSB7XG4gICAgICBpZiAobmV3T3JSZW1vdmVkQ29sdW1ucy5pbmRleE9mKHBhdGNoLmNvbCkgIT09IC0xKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIG5ld09yUmVtb3ZlZENvbHVtbnMucHVzaChwYXRjaC5jb2wpO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSk7XG4gIG5ld09yUmVtb3ZlZENvbHVtbnMubGVuZ3RoID0gMDtcbiAgcmV0dXJuIHBhdGNoZXM7XG59XG5mdW5jdGlvbiBwYXJzZVBhdGgocGF0aCkge1xuICB2YXIgbWF0Y2ggPSBwYXRoLm1hdGNoKC9eXFwvKFxcZCspXFwvPyguKik/JC8pO1xuICBpZiAoIW1hdGNoKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgdmFyICRfXzEgPSBtYXRjaCxcbiAgICAgIHJvdyA9ICRfXzFbMV0sXG4gICAgICBjb2x1bW4gPSAkX18xWzJdO1xuICByZXR1cm4ge1xuICAgIHJvdzogcGFyc2VJbnQocm93LCAxMCksXG4gICAgY29sOiAvXlxcZCokLy50ZXN0KGNvbHVtbikgPyBwYXJzZUludChjb2x1bW4sIDEwKSA6IGNvbHVtblxuICB9O1xufVxuXG4vLyMgXG59LHtcIi4uLy4uL2hlbHBlcnMvYXJyYXlcIjo0M31dLDExMzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgSGFuZHNvbnRhYmxlUGVyc2lzdGVudFN0YXRlOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBIYW5kc29udGFibGVQZXJzaXN0ZW50U3RhdGU7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX187XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX199KS5kZWZhdWx0O1xudmFyIHJlZ2lzdGVyUGx1Z2luID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyA9IF9kZXJlcV8oXCJwbHVnaW5zXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX199KS5yZWdpc3RlclBsdWdpbjtcbjtcbmZ1bmN0aW9uIFN0b3JhZ2UocHJlZml4KSB7XG4gIHZhciBzYXZlZEtleXM7XG4gIHZhciBzYXZlU2F2ZWRLZXlzID0gZnVuY3Rpb24oKSB7XG4gICAgd2luZG93LmxvY2FsU3RvcmFnZVtwcmVmaXggKyAnX18nICsgJ3BlcnNpc3RlbnRTdGF0ZUtleXMnXSA9IEpTT04uc3RyaW5naWZ5KHNhdmVkS2V5cyk7XG4gIH07XG4gIHZhciBsb2FkU2F2ZWRLZXlzID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGtleXNKU09OID0gd2luZG93LmxvY2FsU3RvcmFnZVtwcmVmaXggKyAnX18nICsgJ3BlcnNpc3RlbnRTdGF0ZUtleXMnXTtcbiAgICB2YXIga2V5cyA9IHR5cGVvZiBrZXlzSlNPTiA9PSAnc3RyaW5nJyA/IEpTT04ucGFyc2Uoa2V5c0pTT04pIDogdm9pZCAwO1xuICAgIHNhdmVkS2V5cyA9IGtleXMgPyBrZXlzIDogW107XG4gIH07XG4gIHZhciBjbGVhclNhdmVkS2V5cyA9IGZ1bmN0aW9uKCkge1xuICAgIHNhdmVkS2V5cyA9IFtdO1xuICAgIHNhdmVTYXZlZEtleXMoKTtcbiAgfTtcbiAgbG9hZFNhdmVkS2V5cygpO1xuICB0aGlzLnNhdmVWYWx1ZSA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICB3aW5kb3cubG9jYWxTdG9yYWdlW3ByZWZpeCArICdfJyArIGtleV0gPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XG4gICAgaWYgKHNhdmVkS2V5cy5pbmRleE9mKGtleSkgPT0gLTEpIHtcbiAgICAgIHNhdmVkS2V5cy5wdXNoKGtleSk7XG4gICAgICBzYXZlU2F2ZWRLZXlzKCk7XG4gICAgfVxuICB9O1xuICB0aGlzLmxvYWRWYWx1ZSA9IGZ1bmN0aW9uKGtleSwgZGVmYXVsdFZhbHVlKSB7XG4gICAga2V5ID0gdHlwZW9mIGtleSA9PT0gJ3VuZGVmaW5lZCcgPyBkZWZhdWx0VmFsdWUgOiBrZXk7XG4gICAgdmFyIHZhbHVlID0gd2luZG93LmxvY2FsU3RvcmFnZVtwcmVmaXggKyAnXycgKyBrZXldO1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ3VuZGVmaW5lZCcgPyB2b2lkIDAgOiBKU09OLnBhcnNlKHZhbHVlKTtcbiAgfTtcbiAgdGhpcy5yZXNldCA9IGZ1bmN0aW9uKGtleSkge1xuICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShwcmVmaXggKyAnXycgKyBrZXkpO1xuICB9O1xuICB0aGlzLnJlc2V0QWxsID0gZnVuY3Rpb24oKSB7XG4gICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IHNhdmVkS2V5cy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShwcmVmaXggKyAnXycgKyBzYXZlZEtleXNbaW5kZXhdKTtcbiAgICB9XG4gICAgY2xlYXJTYXZlZEtleXMoKTtcbiAgfTtcbn1cbmZ1bmN0aW9uIEhhbmRzb250YWJsZVBlcnNpc3RlbnRTdGF0ZSgpIHtcbiAgdmFyIHBsdWdpbiA9IHRoaXM7XG4gIHRoaXMuaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBpbnN0YW5jZSA9IHRoaXMsXG4gICAgICAgIHBsdWdpblNldHRpbmdzID0gaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5wZXJzaXN0ZW50U3RhdGU7XG4gICAgcGx1Z2luLmVuYWJsZWQgPSAhIShwbHVnaW5TZXR0aW5ncyk7XG4gICAgaWYgKCFwbHVnaW4uZW5hYmxlZCkge1xuICAgICAgcmVtb3ZlSG9va3MuY2FsbChpbnN0YW5jZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICghaW5zdGFuY2Uuc3RvcmFnZSkge1xuICAgICAgaW5zdGFuY2Uuc3RvcmFnZSA9IG5ldyBTdG9yYWdlKGluc3RhbmNlLnJvb3RFbGVtZW50LmlkKTtcbiAgICB9XG4gICAgaW5zdGFuY2UucmVzZXRTdGF0ZSA9IHBsdWdpbi5yZXNldFZhbHVlO1xuICAgIGFkZEhvb2tzLmNhbGwoaW5zdGFuY2UpO1xuICB9O1xuICB0aGlzLnNhdmVWYWx1ZSA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICB2YXIgaW5zdGFuY2UgPSB0aGlzO1xuICAgIGluc3RhbmNlLnN0b3JhZ2Uuc2F2ZVZhbHVlKGtleSwgdmFsdWUpO1xuICB9O1xuICB0aGlzLmxvYWRWYWx1ZSA9IGZ1bmN0aW9uKGtleSwgc2F2ZVRvKSB7XG4gICAgdmFyIGluc3RhbmNlID0gdGhpcztcbiAgICBzYXZlVG8udmFsdWUgPSBpbnN0YW5jZS5zdG9yYWdlLmxvYWRWYWx1ZShrZXkpO1xuICB9O1xuICB0aGlzLnJlc2V0VmFsdWUgPSBmdW5jdGlvbihrZXkpIHtcbiAgICB2YXIgaW5zdGFuY2UgPSB0aGlzO1xuICAgIGlmICh0eXBlb2Yga2V5ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgaW5zdGFuY2Uuc3RvcmFnZS5yZXNldEFsbCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbnN0YW5jZS5zdG9yYWdlLnJlc2V0KGtleSk7XG4gICAgfVxuICB9O1xuICB2YXIgaG9va3MgPSB7XG4gICAgcGVyc2lzdGVudFN0YXRlU2F2ZTogcGx1Z2luLnNhdmVWYWx1ZSxcbiAgICBwZXJzaXN0ZW50U3RhdGVMb2FkOiBwbHVnaW4ubG9hZFZhbHVlLFxuICAgIHBlcnNpc3RlbnRTdGF0ZVJlc2V0OiBwbHVnaW4ucmVzZXRWYWx1ZVxuICB9O1xuICBmb3IgKHZhciBob29rTmFtZSBpbiBob29rcykge1xuICAgIGlmIChob29rcy5oYXNPd25Qcm9wZXJ0eShob29rTmFtZSkpIHtcbiAgICAgIEhhbmRzb250YWJsZS5ob29rcy5yZWdpc3Rlcihob29rTmFtZSk7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGFkZEhvb2tzKCkge1xuICAgIHZhciBpbnN0YW5jZSA9IHRoaXM7XG4gICAgZm9yICh2YXIgaG9va05hbWUgaW4gaG9va3MpIHtcbiAgICAgIGlmIChob29rcy5oYXNPd25Qcm9wZXJ0eShob29rTmFtZSkpIHtcbiAgICAgICAgaW5zdGFuY2UuYWRkSG9vayhob29rTmFtZSwgaG9va3NbaG9va05hbWVdKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gcmVtb3ZlSG9va3MoKSB7XG4gICAgdmFyIGluc3RhbmNlID0gdGhpcztcbiAgICBmb3IgKHZhciBob29rTmFtZSBpbiBob29rcykge1xuICAgICAgaWYgKGhvb2tzLmhhc093blByb3BlcnR5KGhvb2tOYW1lKSkge1xuICAgICAgICBpbnN0YW5jZS5yZW1vdmVIb29rKGhvb2tOYW1lLCBob29rc1tob29rTmFtZV0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxudmFyIGh0UGVyc2lzdGVudFN0YXRlID0gbmV3IEhhbmRzb250YWJsZVBlcnNpc3RlbnRTdGF0ZSgpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLmFkZCgnYmVmb3JlSW5pdCcsIGh0UGVyc2lzdGVudFN0YXRlLmluaXQpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLmFkZCgnYWZ0ZXJVcGRhdGVTZXR0aW5ncycsIGh0UGVyc2lzdGVudFN0YXRlLmluaXQpO1xuXG4vLyMgXG59LHtcImJyb3dzZXJcIjoyNCxcInBsdWdpbnNcIjo2MX1dLDExNDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbnZhciAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3JlbmRlcmVyc19fO1xudmFyIEhhbmRzb250YWJsZSA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gPSBfZGVyZXFfKFwiYnJvd3NlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9ffSkuZGVmYXVsdDtcbnZhciAkX18xID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9lbGVtZW50XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X199KSxcbiAgICBhZGRDbGFzcyA9ICRfXzEuYWRkQ2xhc3MsXG4gICAgcmVtb3ZlQ2xhc3MgPSAkX18xLnJlbW92ZUNsYXNzO1xudmFyICRfXzIgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcmVuZGVyZXJzX18gPSBfZGVyZXFfKFwicmVuZGVyZXJzXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19yZW5kZXJlcnNfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19yZW5kZXJlcnNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3JlbmRlcmVyc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19yZW5kZXJlcnNfX30pLFxuICAgIHJlZ2lzdGVyUmVuZGVyZXIgPSAkX18yLnJlZ2lzdGVyUmVuZGVyZXIsXG4gICAgZ2V0UmVuZGVyZXIgPSAkX18yLmdldFJlbmRlcmVyO1xuSGFuZHNvbnRhYmxlLlNlYXJjaCA9IGZ1bmN0aW9uIFNlYXJjaChpbnN0YW5jZSkge1xuICB0aGlzLnF1ZXJ5ID0gZnVuY3Rpb24ocXVlcnlTdHIsIGNhbGxiYWNrLCBxdWVyeU1ldGhvZCkge1xuICAgIHZhciByb3dDb3VudCA9IGluc3RhbmNlLmNvdW50Um93cygpO1xuICAgIHZhciBjb2xDb3VudCA9IGluc3RhbmNlLmNvdW50Q29scygpO1xuICAgIHZhciBxdWVyeVJlc3VsdCA9IFtdO1xuICAgIGlmICghY2FsbGJhY2spIHtcbiAgICAgIGNhbGxiYWNrID0gSGFuZHNvbnRhYmxlLlNlYXJjaC5nbG9iYWwuZ2V0RGVmYXVsdENhbGxiYWNrKCk7XG4gICAgfVxuICAgIGlmICghcXVlcnlNZXRob2QpIHtcbiAgICAgIHF1ZXJ5TWV0aG9kID0gSGFuZHNvbnRhYmxlLlNlYXJjaC5nbG9iYWwuZ2V0RGVmYXVsdFF1ZXJ5TWV0aG9kKCk7XG4gICAgfVxuICAgIGZvciAodmFyIHJvd0luZGV4ID0gMDsgcm93SW5kZXggPCByb3dDb3VudDsgcm93SW5kZXgrKykge1xuICAgICAgZm9yICh2YXIgY29sSW5kZXggPSAwOyBjb2xJbmRleCA8IGNvbENvdW50OyBjb2xJbmRleCsrKSB7XG4gICAgICAgIHZhciBjZWxsRGF0YSA9IGluc3RhbmNlLmdldERhdGFBdENlbGwocm93SW5kZXgsIGNvbEluZGV4KTtcbiAgICAgICAgdmFyIGNlbGxQcm9wZXJ0aWVzID0gaW5zdGFuY2UuZ2V0Q2VsbE1ldGEocm93SW5kZXgsIGNvbEluZGV4KTtcbiAgICAgICAgdmFyIGNlbGxDYWxsYmFjayA9IGNlbGxQcm9wZXJ0aWVzLnNlYXJjaC5jYWxsYmFjayB8fCBjYWxsYmFjaztcbiAgICAgICAgdmFyIGNlbGxRdWVyeU1ldGhvZCA9IGNlbGxQcm9wZXJ0aWVzLnNlYXJjaC5xdWVyeU1ldGhvZCB8fCBxdWVyeU1ldGhvZDtcbiAgICAgICAgdmFyIHRlc3RSZXN1bHQgPSBjZWxsUXVlcnlNZXRob2QocXVlcnlTdHIsIGNlbGxEYXRhKTtcbiAgICAgICAgaWYgKHRlc3RSZXN1bHQpIHtcbiAgICAgICAgICB2YXIgc2luZ2xlUmVzdWx0ID0ge1xuICAgICAgICAgICAgcm93OiByb3dJbmRleCxcbiAgICAgICAgICAgIGNvbDogY29sSW5kZXgsXG4gICAgICAgICAgICBkYXRhOiBjZWxsRGF0YVxuICAgICAgICAgIH07XG4gICAgICAgICAgcXVlcnlSZXN1bHQucHVzaChzaW5nbGVSZXN1bHQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjZWxsQ2FsbGJhY2spIHtcbiAgICAgICAgICBjZWxsQ2FsbGJhY2soaW5zdGFuY2UsIHJvd0luZGV4LCBjb2xJbmRleCwgY2VsbERhdGEsIHRlc3RSZXN1bHQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBxdWVyeVJlc3VsdDtcbiAgfTtcbn07XG5IYW5kc29udGFibGUuU2VhcmNoLkRFRkFVTFRfQ0FMTEJBQ0sgPSBmdW5jdGlvbihpbnN0YW5jZSwgcm93LCBjb2wsIGRhdGEsIHRlc3RSZXN1bHQpIHtcbiAgaW5zdGFuY2UuZ2V0Q2VsbE1ldGEocm93LCBjb2wpLmlzU2VhcmNoUmVzdWx0ID0gdGVzdFJlc3VsdDtcbn07XG5IYW5kc29udGFibGUuU2VhcmNoLkRFRkFVTFRfUVVFUllfTUVUSE9EID0gZnVuY3Rpb24ocXVlcnksIHZhbHVlKSB7XG4gIGlmICh0eXBlb2YgcXVlcnkgPT0gJ3VuZGVmaW5lZCcgfHwgcXVlcnkgPT0gbnVsbCB8fCAhcXVlcnkudG9Mb3dlckNhc2UgfHwgcXVlcnkubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGlmICh0eXBlb2YgdmFsdWUgPT0gJ3VuZGVmaW5lZCcgfHwgdmFsdWUgPT0gbnVsbCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpLmluZGV4T2YocXVlcnkudG9Mb3dlckNhc2UoKSkgIT0gLTE7XG59O1xuSGFuZHNvbnRhYmxlLlNlYXJjaC5ERUZBVUxUX1NFQVJDSF9SRVNVTFRfQ0xBU1MgPSAnaHRTZWFyY2hSZXN1bHQnO1xuSGFuZHNvbnRhYmxlLlNlYXJjaC5nbG9iYWwgPSAoZnVuY3Rpb24oKSB7XG4gIHZhciBkZWZhdWx0Q2FsbGJhY2sgPSBIYW5kc29udGFibGUuU2VhcmNoLkRFRkFVTFRfQ0FMTEJBQ0s7XG4gIHZhciBkZWZhdWx0UXVlcnlNZXRob2QgPSBIYW5kc29udGFibGUuU2VhcmNoLkRFRkFVTFRfUVVFUllfTUVUSE9EO1xuICB2YXIgZGVmYXVsdFNlYXJjaFJlc3VsdENsYXNzID0gSGFuZHNvbnRhYmxlLlNlYXJjaC5ERUZBVUxUX1NFQVJDSF9SRVNVTFRfQ0xBU1M7XG4gIHJldHVybiB7XG4gICAgZ2V0RGVmYXVsdENhbGxiYWNrOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBkZWZhdWx0Q2FsbGJhY2s7XG4gICAgfSxcbiAgICBzZXREZWZhdWx0Q2FsbGJhY2s6IGZ1bmN0aW9uKG5ld0RlZmF1bHRDYWxsYmFjaykge1xuICAgICAgZGVmYXVsdENhbGxiYWNrID0gbmV3RGVmYXVsdENhbGxiYWNrO1xuICAgIH0sXG4gICAgZ2V0RGVmYXVsdFF1ZXJ5TWV0aG9kOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBkZWZhdWx0UXVlcnlNZXRob2Q7XG4gICAgfSxcbiAgICBzZXREZWZhdWx0UXVlcnlNZXRob2Q6IGZ1bmN0aW9uKG5ld0RlZmF1bHRRdWVyeU1ldGhvZCkge1xuICAgICAgZGVmYXVsdFF1ZXJ5TWV0aG9kID0gbmV3RGVmYXVsdFF1ZXJ5TWV0aG9kO1xuICAgIH0sXG4gICAgZ2V0RGVmYXVsdFNlYXJjaFJlc3VsdENsYXNzOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBkZWZhdWx0U2VhcmNoUmVzdWx0Q2xhc3M7XG4gICAgfSxcbiAgICBzZXREZWZhdWx0U2VhcmNoUmVzdWx0Q2xhc3M6IGZ1bmN0aW9uKG5ld1NlYXJjaFJlc3VsdENsYXNzKSB7XG4gICAgICBkZWZhdWx0U2VhcmNoUmVzdWx0Q2xhc3MgPSBuZXdTZWFyY2hSZXN1bHRDbGFzcztcbiAgICB9XG4gIH07XG59KSgpO1xuSGFuZHNvbnRhYmxlLlNlYXJjaENlbGxEZWNvcmF0b3IgPSBmdW5jdGlvbihpbnN0YW5jZSwgVEQsIHJvdywgY29sLCBwcm9wLCB2YWx1ZSwgY2VsbFByb3BlcnRpZXMpIHtcbiAgdmFyIHNlYXJjaFJlc3VsdENsYXNzID0gKGNlbGxQcm9wZXJ0aWVzLnNlYXJjaCAhPT0gbnVsbCAmJiB0eXBlb2YgY2VsbFByb3BlcnRpZXMuc2VhcmNoID09ICdvYmplY3QnICYmIGNlbGxQcm9wZXJ0aWVzLnNlYXJjaC5zZWFyY2hSZXN1bHRDbGFzcykgfHwgSGFuZHNvbnRhYmxlLlNlYXJjaC5nbG9iYWwuZ2V0RGVmYXVsdFNlYXJjaFJlc3VsdENsYXNzKCk7XG4gIGlmIChjZWxsUHJvcGVydGllcy5pc1NlYXJjaFJlc3VsdCkge1xuICAgIGFkZENsYXNzKFRELCBzZWFyY2hSZXN1bHRDbGFzcyk7XG4gIH0gZWxzZSB7XG4gICAgcmVtb3ZlQ2xhc3MoVEQsIHNlYXJjaFJlc3VsdENsYXNzKTtcbiAgfVxufTtcbnZhciBvcmlnaW5hbEJhc2VSZW5kZXJlciA9IGdldFJlbmRlcmVyKCdiYXNlJyk7XG5yZWdpc3RlclJlbmRlcmVyKCdiYXNlJywgZnVuY3Rpb24oaW5zdGFuY2UsIFRELCByb3csIGNvbCwgcHJvcCwgdmFsdWUsIGNlbGxQcm9wZXJ0aWVzKSB7XG4gIG9yaWdpbmFsQmFzZVJlbmRlcmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIEhhbmRzb250YWJsZS5TZWFyY2hDZWxsRGVjb3JhdG9yLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59KTtcbmZ1bmN0aW9uIGluaXQoKSB7XG4gIHZhciBpbnN0YW5jZSA9IHRoaXM7XG4gIHZhciBwbHVnaW5FbmFibGVkID0gISFpbnN0YW5jZS5nZXRTZXR0aW5ncygpLnNlYXJjaDtcbiAgaWYgKHBsdWdpbkVuYWJsZWQpIHtcbiAgICBpbnN0YW5jZS5zZWFyY2ggPSBuZXcgSGFuZHNvbnRhYmxlLlNlYXJjaChpbnN0YW5jZSk7XG4gIH0gZWxzZSB7XG4gICAgZGVsZXRlIGluc3RhbmNlLnNlYXJjaDtcbiAgfVxufVxuSGFuZHNvbnRhYmxlLmhvb2tzLmFkZCgnYWZ0ZXJJbml0JywgaW5pdCk7XG5IYW5kc29udGFibGUuaG9va3MuYWRkKCdhZnRlclVwZGF0ZVNldHRpbmdzJywgaW5pdCk7XG5cbi8vIyBcbn0se1wiYnJvd3NlclwiOjI0LFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwicmVuZGVyZXJzXCI6MTE3fV0sMTE1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBUb3VjaFNjcm9sbDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gVG91Y2hTY3JvbGw7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X185NV9iYXNlX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZmVhdHVyZV9fO1xudmFyIEhhbmRzb250YWJsZSA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gPSBfZGVyZXFfKFwiYnJvd3NlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9ffSkuZGVmYXVsdDtcbnZhciAkX18xID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9lbGVtZW50XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X199KSxcbiAgICBhZGRDbGFzcyA9ICRfXzEuYWRkQ2xhc3MsXG4gICAgcmVtb3ZlQ2xhc3MgPSAkX18xLnJlbW92ZUNsYXNzO1xudmFyIGFycmF5RWFjaCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gPSBfZGVyZXFfKFwiaGVscGVycy9hcnJheVwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9ffSkuYXJyYXlFYWNoO1xudmFyIEJhc2VQbHVnaW4gPSAoJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfXyA9IF9kZXJlcV8oXCJfYmFzZVwiKSwgJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfXyAmJiAkX19fNDZfXzQ2X180N19fOTVfYmFzZV9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzk1X2Jhc2VfX30pLmRlZmF1bHQ7XG52YXIgcmVnaXN0ZXJQbHVnaW4gPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfcGx1Z2luc19fID0gX2RlcmVxXyhcInBsdWdpbnNcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19wbHVnaW5zX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X3BsdWdpbnNfX30pLnJlZ2lzdGVyUGx1Z2luO1xudmFyIGlzVG91Y2hTdXBwb3J0ZWQgPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19mZWF0dXJlX18gPSBfZGVyZXFfKFwiaGVscGVycy9mZWF0dXJlXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2ZlYXR1cmVfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2ZlYXR1cmVfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZmVhdHVyZV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2ZlYXR1cmVfX30pLmlzVG91Y2hTdXBwb3J0ZWQ7XG52YXIgVG91Y2hTY3JvbGwgPSBmdW5jdGlvbiBUb3VjaFNjcm9sbChob3RJbnN0YW5jZSkge1xuICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJDb25zdHJ1Y3RvcigkVG91Y2hTY3JvbGwpLmNhbGwodGhpcywgaG90SW5zdGFuY2UpO1xuICB0aGlzLnNjcm9sbGJhcnMgPSBbXTtcbiAgdGhpcy5jbG9uZXMgPSBbXTtcbiAgdGhpcy5sb2NrZWRDb2xsZWN0aW9uID0gZmFsc2U7XG59O1xudmFyICRUb3VjaFNjcm9sbCA9IFRvdWNoU2Nyb2xsO1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoVG91Y2hTY3JvbGwsIHtcbiAgaXNFbmFibGVkOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gaXNUb3VjaFN1cHBvcnRlZCgpO1xuICB9LFxuICBlbmFibGVQbHVnaW46IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX182ID0gdGhpcztcbiAgICBpZiAodGhpcy5lbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuYWRkSG9vaygnYWZ0ZXJSZW5kZXInLCAoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fNi5vbkFmdGVyUmVuZGVyKCk7XG4gICAgfSkpO1xuICAgIHRoaXMucmVnaXN0ZXJFdmVudHMoKTtcbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJFRvdWNoU2Nyb2xsLnByb3RvdHlwZSwgXCJlbmFibGVQbHVnaW5cIikuY2FsbCh0aGlzKTtcbiAgfSxcbiAgdXBkYXRlUGx1Z2luOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmxvY2tlZENvbGxlY3Rpb24gPSBmYWxzZTtcbiAgICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQodGhpcywgJFRvdWNoU2Nyb2xsLnByb3RvdHlwZSwgXCJ1cGRhdGVQbHVnaW5cIikuY2FsbCh0aGlzKTtcbiAgfSxcbiAgZGlzYWJsZVBsdWdpbjogZnVuY3Rpb24oKSB7XG4gICAgJHRyYWNldXJSdW50aW1lLnN1cGVyR2V0KHRoaXMsICRUb3VjaFNjcm9sbC5wcm90b3R5cGUsIFwiZGlzYWJsZVBsdWdpblwiKS5jYWxsKHRoaXMpO1xuICB9LFxuICByZWdpc3RlckV2ZW50czogZnVuY3Rpb24oKSB7XG4gICAgdmFyICRfXzYgPSB0aGlzO1xuICAgIHRoaXMuYWRkSG9vaygnYmVmb3JlVG91Y2hTY3JvbGwnLCAoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gJF9fNi5vbkJlZm9yZVRvdWNoU2Nyb2xsKCk7XG4gICAgfSkpO1xuICAgIHRoaXMuYWRkSG9vaygnYWZ0ZXJNb21lbnR1bVNjcm9sbCcsIChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAkX182Lm9uQWZ0ZXJNb21lbnR1bVNjcm9sbCgpO1xuICAgIH0pKTtcbiAgfSxcbiAgb25BZnRlclJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMubG9ja2VkQ29sbGVjdGlvbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgJF9fOCA9IHRoaXMuaG90LnZpZXcud3Qud3RPdmVybGF5cyxcbiAgICAgICAgdG9wT3ZlcmxheSA9ICRfXzgudG9wT3ZlcmxheSxcbiAgICAgICAgYm90dG9tT3ZlcmxheSA9ICRfXzguYm90dG9tT3ZlcmxheSxcbiAgICAgICAgbGVmdE92ZXJsYXkgPSAkX184LmxlZnRPdmVybGF5LFxuICAgICAgICB0b3BMZWZ0Q29ybmVyT3ZlcmxheSA9ICRfXzgudG9wTGVmdENvcm5lck92ZXJsYXksXG4gICAgICAgIGJvdHRvbUxlZnRDb3JuZXJPdmVybGF5ID0gJF9fOC5ib3R0b21MZWZ0Q29ybmVyT3ZlcmxheTtcbiAgICB0aGlzLmxvY2tlZENvbGxlY3Rpb24gPSB0cnVlO1xuICAgIHRoaXMuc2Nyb2xsYmFycy5sZW5ndGggPSAwO1xuICAgIHRoaXMuc2Nyb2xsYmFycy5wdXNoKHRvcE92ZXJsYXkpO1xuICAgIGlmIChib3R0b21PdmVybGF5LmNsb25lKSB7XG4gICAgICB0aGlzLnNjcm9sbGJhcnMucHVzaChib3R0b21PdmVybGF5KTtcbiAgICB9XG4gICAgdGhpcy5zY3JvbGxiYXJzLnB1c2gobGVmdE92ZXJsYXkpO1xuICAgIGlmICh0b3BMZWZ0Q29ybmVyT3ZlcmxheSkge1xuICAgICAgdGhpcy5zY3JvbGxiYXJzLnB1c2godG9wTGVmdENvcm5lck92ZXJsYXkpO1xuICAgIH1cbiAgICBpZiAoYm90dG9tTGVmdENvcm5lck92ZXJsYXkgJiYgYm90dG9tTGVmdENvcm5lck92ZXJsYXkuY2xvbmUpIHtcbiAgICAgIHRoaXMuc2Nyb2xsYmFycy5wdXNoKGJvdHRvbUxlZnRDb3JuZXJPdmVybGF5KTtcbiAgICB9XG4gICAgdGhpcy5jbG9uZXMubGVuZ3RoID0gMDtcbiAgICBpZiAodG9wT3ZlcmxheS5uZWVkRnVsbFJlbmRlcikge1xuICAgICAgdGhpcy5jbG9uZXMucHVzaCh0b3BPdmVybGF5LmNsb25lLnd0VGFibGUuaG9sZGVyLnBhcmVudE5vZGUpO1xuICAgIH1cbiAgICBpZiAoYm90dG9tT3ZlcmxheS5uZWVkRnVsbFJlbmRlcikge1xuICAgICAgdGhpcy5jbG9uZXMucHVzaChib3R0b21PdmVybGF5LmNsb25lLnd0VGFibGUuaG9sZGVyLnBhcmVudE5vZGUpO1xuICAgIH1cbiAgICBpZiAobGVmdE92ZXJsYXkubmVlZEZ1bGxSZW5kZXIpIHtcbiAgICAgIHRoaXMuY2xvbmVzLnB1c2gobGVmdE92ZXJsYXkuY2xvbmUud3RUYWJsZS5ob2xkZXIucGFyZW50Tm9kZSk7XG4gICAgfVxuICAgIGlmICh0b3BMZWZ0Q29ybmVyT3ZlcmxheSkge1xuICAgICAgdGhpcy5jbG9uZXMucHVzaCh0b3BMZWZ0Q29ybmVyT3ZlcmxheS5jbG9uZS53dFRhYmxlLmhvbGRlci5wYXJlbnROb2RlKTtcbiAgICB9XG4gICAgaWYgKGJvdHRvbUxlZnRDb3JuZXJPdmVybGF5ICYmIGJvdHRvbUxlZnRDb3JuZXJPdmVybGF5LmNsb25lKSB7XG4gICAgICB0aGlzLmNsb25lcy5wdXNoKGJvdHRvbUxlZnRDb3JuZXJPdmVybGF5LmNsb25lLnd0VGFibGUuaG9sZGVyLnBhcmVudE5vZGUpO1xuICAgIH1cbiAgfSxcbiAgb25CZWZvcmVUb3VjaFNjcm9sbDogZnVuY3Rpb24oKSB7XG4gICAgSGFuZHNvbnRhYmxlLmZyZWV6ZU92ZXJsYXlzID0gdHJ1ZTtcbiAgICBhcnJheUVhY2godGhpcy5jbG9uZXMsIChmdW5jdGlvbihjbG9uZSkge1xuICAgICAgYWRkQ2xhc3MoY2xvbmUsICdoaWRlLXR3ZWVuJyk7XG4gICAgfSkpO1xuICB9LFxuICBvbkFmdGVyTW9tZW50dW1TY3JvbGw6IGZ1bmN0aW9uKCkge1xuICAgIHZhciAkX182ID0gdGhpcztcbiAgICBIYW5kc29udGFibGUuZnJlZXplT3ZlcmxheXMgPSBmYWxzZTtcbiAgICBhcnJheUVhY2godGhpcy5jbG9uZXMsIChmdW5jdGlvbihjbG9uZSkge1xuICAgICAgcmVtb3ZlQ2xhc3MoY2xvbmUsICdoaWRlLXR3ZWVuJyk7XG4gICAgICBhZGRDbGFzcyhjbG9uZSwgJ3Nob3ctdHdlZW4nKTtcbiAgICB9KSk7XG4gICAgc2V0VGltZW91dCgoZnVuY3Rpb24oKSB7XG4gICAgICBhcnJheUVhY2goJF9fNi5jbG9uZXMsIChmdW5jdGlvbihjbG9uZSkge1xuICAgICAgICByZW1vdmVDbGFzcyhjbG9uZSwgJ3Nob3ctdHdlZW4nKTtcbiAgICAgIH0pKTtcbiAgICB9KSwgNDAwKTtcbiAgICBhcnJheUVhY2godGhpcy5zY3JvbGxiYXJzLCAoZnVuY3Rpb24oc2Nyb2xsYmFyKSB7XG4gICAgICBzY3JvbGxiYXIucmVmcmVzaCgpO1xuICAgICAgc2Nyb2xsYmFyLnJlc2V0Rml4ZWRQb3NpdGlvbigpO1xuICAgIH0pKTtcbiAgICB0aGlzLmhvdC52aWV3Lnd0Lnd0T3ZlcmxheXMuc3luY1Njcm9sbFdpdGhNYXN0ZXIoKTtcbiAgfVxufSwge30sIEJhc2VQbHVnaW4pO1xuO1xucmVnaXN0ZXJQbHVnaW4oJ3RvdWNoU2Nyb2xsJywgVG91Y2hTY3JvbGwpO1xuXG4vLyMgXG59LHtcIl9iYXNlXCI6NjIsXCJicm93c2VyXCI6MjQsXCJoZWxwZXJzL2FycmF5XCI6NDMsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJoZWxwZXJzL2ZlYXR1cmVcIjo0OSxcInBsdWdpbnNcIjo2MX1dLDExNjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbnZhciAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyxcbiAgICAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fO1xudmFyIEhhbmRzb250YWJsZSA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gPSBfZGVyZXFfKFwiYnJvd3NlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9ffSkuZGVmYXVsdDtcbnZhciBhcnJheU1hcCA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gPSBfZGVyZXFfKFwiaGVscGVycy9hcnJheVwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9ffSkuYXJyYXlNYXA7XG52YXIgcmFuZ2VFYWNoID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gPSBfZGVyZXFfKFwiaGVscGVycy9udW1iZXJcIiksICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX199KS5yYW5nZUVhY2g7XG52YXIgJF9fMyA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fID0gX2RlcmVxXyhcImhlbHBlcnMvb2JqZWN0XCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9ffSksXG4gICAgaW5oZXJpdCA9ICRfXzMuaW5oZXJpdCxcbiAgICBkZWVwQ2xvbmUgPSAkX18zLmRlZXBDbG9uZTtcbnZhciBzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24gPSAoJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9ldmVudFwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfXyAmJiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZXZlbnRfX30pLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbjtcbkhhbmRzb250YWJsZS5VbmRvUmVkbyA9IGZ1bmN0aW9uKGluc3RhbmNlKSB7XG4gIHZhciBwbHVnaW4gPSB0aGlzO1xuICB0aGlzLmluc3RhbmNlID0gaW5zdGFuY2U7XG4gIHRoaXMuZG9uZUFjdGlvbnMgPSBbXTtcbiAgdGhpcy51bmRvbmVBY3Rpb25zID0gW107XG4gIHRoaXMuaWdub3JlTmV3QWN0aW9ucyA9IGZhbHNlO1xuICBpbnN0YW5jZS5hZGRIb29rKCdhZnRlckNoYW5nZScsIGZ1bmN0aW9uKGNoYW5nZXMsIHNvdXJjZSkge1xuICAgIGlmIChjaGFuZ2VzICYmIHNvdXJjZSAhPT0gJ1VuZG9SZWRvLnVuZG8nICYmIHNvdXJjZSAhPT0gJ1VuZG9SZWRvLnJlZG8nKSB7XG4gICAgICBwbHVnaW4uZG9uZShuZXcgSGFuZHNvbnRhYmxlLlVuZG9SZWRvLkNoYW5nZUFjdGlvbihjaGFuZ2VzKSk7XG4gICAgfVxuICB9KTtcbiAgaW5zdGFuY2UuYWRkSG9vaygnYWZ0ZXJDcmVhdGVSb3cnLCBmdW5jdGlvbihpbmRleCwgYW1vdW50LCBzb3VyY2UpIHtcbiAgICBpZiAoc291cmNlID09PSAnVW5kb1JlZG8udW5kbycgfHwgc291cmNlID09PSAnVW5kb1JlZG8udW5kbycgfHwgc291cmNlID09PSAnYXV0bycpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGFjdGlvbiA9IG5ldyBIYW5kc29udGFibGUuVW5kb1JlZG8uQ3JlYXRlUm93QWN0aW9uKGluZGV4LCBhbW91bnQpO1xuICAgIHBsdWdpbi5kb25lKGFjdGlvbik7XG4gIH0pO1xuICBpbnN0YW5jZS5hZGRIb29rKCdiZWZvcmVSZW1vdmVSb3cnLCBmdW5jdGlvbihpbmRleCwgYW1vdW50LCBsb2dpY1Jvd3MsIHNvdXJjZSkge1xuICAgIGlmIChzb3VyY2UgPT09ICdVbmRvUmVkby51bmRvJyB8fCBzb3VyY2UgPT09ICdVbmRvUmVkby5yZWRvJyB8fCBzb3VyY2UgPT09ICdhdXRvJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgb3JpZ2luYWxEYXRhID0gcGx1Z2luLmluc3RhbmNlLmdldFNvdXJjZURhdGFBcnJheSgpO1xuICAgIGluZGV4ID0gKG9yaWdpbmFsRGF0YS5sZW5ndGggKyBpbmRleCkgJSBvcmlnaW5hbERhdGEubGVuZ3RoO1xuICAgIHZhciByZW1vdmVkRGF0YSA9IGRlZXBDbG9uZShvcmlnaW5hbERhdGEuc2xpY2UoaW5kZXgsIGluZGV4ICsgYW1vdW50KSk7XG4gICAgcGx1Z2luLmRvbmUobmV3IEhhbmRzb250YWJsZS5VbmRvUmVkby5SZW1vdmVSb3dBY3Rpb24oaW5kZXgsIHJlbW92ZWREYXRhKSk7XG4gIH0pO1xuICBpbnN0YW5jZS5hZGRIb29rKCdhZnRlckNyZWF0ZUNvbCcsIGZ1bmN0aW9uKGluZGV4LCBhbW91bnQsIHNvdXJjZSkge1xuICAgIGlmIChzb3VyY2UgPT09ICdVbmRvUmVkby51bmRvJyB8fCBzb3VyY2UgPT09ICdVbmRvUmVkby5yZWRvJyB8fCBzb3VyY2UgPT09ICdhdXRvJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBwbHVnaW4uZG9uZShuZXcgSGFuZHNvbnRhYmxlLlVuZG9SZWRvLkNyZWF0ZUNvbHVtbkFjdGlvbihpbmRleCwgYW1vdW50KSk7XG4gIH0pO1xuICBpbnN0YW5jZS5hZGRIb29rKCdiZWZvcmVSZW1vdmVDb2wnLCBmdW5jdGlvbihpbmRleCwgYW1vdW50LCBsb2dpY0NvbHVtbnMsIHNvdXJjZSkge1xuICAgIGlmIChzb3VyY2UgPT09ICdVbmRvUmVkby51bmRvJyB8fCBzb3VyY2UgPT09ICdVbmRvUmVkby5yZWRvJyB8fCBzb3VyY2UgPT09ICdhdXRvJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgb3JpZ2luYWxEYXRhID0gcGx1Z2luLmluc3RhbmNlLmdldFNvdXJjZURhdGFBcnJheSgpO1xuICAgIGluZGV4ID0gKHBsdWdpbi5pbnN0YW5jZS5jb3VudENvbHMoKSArIGluZGV4KSAlIHBsdWdpbi5pbnN0YW5jZS5jb3VudENvbHMoKTtcbiAgICB2YXIgcmVtb3ZlZERhdGEgPSBbXTtcbiAgICB2YXIgaGVhZGVycyA9IFtdO1xuICAgIHZhciBpbmRleGVzID0gW107XG4gICAgcmFuZ2VFYWNoKG9yaWdpbmFsRGF0YS5sZW5ndGggLSAxLCAoZnVuY3Rpb24oaSkge1xuICAgICAgdmFyIGNvbHVtbiA9IFtdO1xuICAgICAgdmFyIG9yaWdSb3cgPSBvcmlnaW5hbERhdGFbaV07XG4gICAgICByYW5nZUVhY2goaW5kZXgsIGluZGV4ICsgKGFtb3VudCAtIDEpLCAoZnVuY3Rpb24oaikge1xuICAgICAgICBjb2x1bW4ucHVzaChvcmlnUm93W2luc3RhbmNlLnJ1bkhvb2tzKCdtb2RpZnlDb2wnLCBqKV0pO1xuICAgICAgfSkpO1xuICAgICAgcmVtb3ZlZERhdGEucHVzaChjb2x1bW4pO1xuICAgIH0pKTtcbiAgICByYW5nZUVhY2goYW1vdW50IC0gMSwgKGZ1bmN0aW9uKGkpIHtcbiAgICAgIGluZGV4ZXMucHVzaChpbnN0YW5jZS5ydW5Ib29rcygnbW9kaWZ5Q29sJywgaW5kZXggKyBpKSk7XG4gICAgfSkpO1xuICAgIGlmIChBcnJheS5pc0FycmF5KGluc3RhbmNlLmdldFNldHRpbmdzKCkuY29sSGVhZGVycykpIHtcbiAgICAgIHJhbmdlRWFjaChhbW91bnQgLSAxLCAoZnVuY3Rpb24oaSkge1xuICAgICAgICBoZWFkZXJzLnB1c2goaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5jb2xIZWFkZXJzW2luc3RhbmNlLnJ1bkhvb2tzKCdtb2RpZnlDb2wnLCBpbmRleCArIGkpXSB8fCBudWxsKTtcbiAgICAgIH0pKTtcbiAgICB9XG4gICAgdmFyIG1hbnVhbENvbHVtbk1vdmVQbHVnaW4gPSBwbHVnaW4uaW5zdGFuY2UuZ2V0UGx1Z2luKCdtYW51YWxDb2x1bW5Nb3ZlJyk7XG4gICAgdmFyIGNvbHVtbnNNYXAgPSBtYW51YWxDb2x1bW5Nb3ZlUGx1Z2luLmlzRW5hYmxlZCgpID8gbWFudWFsQ29sdW1uTW92ZVBsdWdpbi5jb2x1bW5zTWFwcGVyLl9fYXJyYXlNYXAgOiBbXTtcbiAgICB2YXIgYWN0aW9uID0gbmV3IEhhbmRzb250YWJsZS5VbmRvUmVkby5SZW1vdmVDb2x1bW5BY3Rpb24oaW5kZXgsIGluZGV4ZXMsIHJlbW92ZWREYXRhLCBoZWFkZXJzLCBjb2x1bW5zTWFwKTtcbiAgICBwbHVnaW4uZG9uZShhY3Rpb24pO1xuICB9KTtcbiAgaW5zdGFuY2UuYWRkSG9vaygnYmVmb3JlQ2VsbEFsaWdubWVudCcsIGZ1bmN0aW9uKHN0YXRlQmVmb3JlLCByYW5nZSwgdHlwZSwgYWxpZ25tZW50KSB7XG4gICAgdmFyIGFjdGlvbiA9IG5ldyBIYW5kc29udGFibGUuVW5kb1JlZG8uQ2VsbEFsaWdubWVudEFjdGlvbihzdGF0ZUJlZm9yZSwgcmFuZ2UsIHR5cGUsIGFsaWdubWVudCk7XG4gICAgcGx1Z2luLmRvbmUoYWN0aW9uKTtcbiAgfSk7XG4gIGluc3RhbmNlLmFkZEhvb2soJ2JlZm9yZUZpbHRlcicsIGZ1bmN0aW9uKGZvcm11bGFTdGFja3MpIHtcbiAgICBwbHVnaW4uZG9uZShuZXcgSGFuZHNvbnRhYmxlLlVuZG9SZWRvLkZpbHRlcnNBY3Rpb24oZm9ybXVsYVN0YWNrcykpO1xuICB9KTtcbiAgaW5zdGFuY2UuYWRkSG9vaygnYmVmb3JlUm93TW92ZScsIGZ1bmN0aW9uKG1vdmVkUm93cywgdGFyZ2V0KSB7XG4gICAgaWYgKG1vdmVkUm93cyA9PT0gZmFsc2UpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcGx1Z2luLmRvbmUobmV3IEhhbmRzb250YWJsZS5VbmRvUmVkby5Sb3dNb3ZlQWN0aW9uKG1vdmVkUm93cywgdGFyZ2V0KSk7XG4gIH0pO1xufTtcbkhhbmRzb250YWJsZS5VbmRvUmVkby5wcm90b3R5cGUuZG9uZSA9IGZ1bmN0aW9uKGFjdGlvbikge1xuICBpZiAoIXRoaXMuaWdub3JlTmV3QWN0aW9ucykge1xuICAgIHRoaXMuZG9uZUFjdGlvbnMucHVzaChhY3Rpb24pO1xuICAgIHRoaXMudW5kb25lQWN0aW9ucy5sZW5ndGggPSAwO1xuICB9XG59O1xuSGFuZHNvbnRhYmxlLlVuZG9SZWRvLnByb3RvdHlwZS51bmRvID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0aGlzLmlzVW5kb0F2YWlsYWJsZSgpKSB7XG4gICAgdmFyIGFjdGlvbiA9IHRoaXMuZG9uZUFjdGlvbnMucG9wKCk7XG4gICAgdmFyIGFjdGlvbkNsb25lID0gZGVlcENsb25lKGFjdGlvbik7XG4gICAgdmFyIGluc3RhbmNlID0gdGhpcy5pbnN0YW5jZTtcbiAgICB2YXIgY29udGludWVBY3Rpb24gPSBpbnN0YW5jZS5ydW5Ib29rcygnYmVmb3JlVW5kbycsIGFjdGlvbkNsb25lKTtcbiAgICBpZiAoY29udGludWVBY3Rpb24gPT09IGZhbHNlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuaWdub3JlTmV3QWN0aW9ucyA9IHRydWU7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgIGFjdGlvbi51bmRvKHRoaXMuaW5zdGFuY2UsIGZ1bmN0aW9uKCkge1xuICAgICAgdGhhdC5pZ25vcmVOZXdBY3Rpb25zID0gZmFsc2U7XG4gICAgICB0aGF0LnVuZG9uZUFjdGlvbnMucHVzaChhY3Rpb24pO1xuICAgIH0pO1xuICAgIGluc3RhbmNlLnJ1bkhvb2tzKCdhZnRlclVuZG8nLCBhY3Rpb25DbG9uZSk7XG4gIH1cbn07XG5IYW5kc29udGFibGUuVW5kb1JlZG8ucHJvdG90eXBlLnJlZG8gPSBmdW5jdGlvbigpIHtcbiAgaWYgKHRoaXMuaXNSZWRvQXZhaWxhYmxlKCkpIHtcbiAgICB2YXIgYWN0aW9uID0gdGhpcy51bmRvbmVBY3Rpb25zLnBvcCgpO1xuICAgIHZhciBhY3Rpb25DbG9uZSA9IGRlZXBDbG9uZShhY3Rpb24pO1xuICAgIHZhciBpbnN0YW5jZSA9IHRoaXMuaW5zdGFuY2U7XG4gICAgdmFyIGNvbnRpbnVlQWN0aW9uID0gaW5zdGFuY2UucnVuSG9va3MoJ2JlZm9yZVJlZG8nLCBhY3Rpb25DbG9uZSk7XG4gICAgaWYgKGNvbnRpbnVlQWN0aW9uID09PSBmYWxzZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmlnbm9yZU5ld0FjdGlvbnMgPSB0cnVlO1xuICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICBhY3Rpb24ucmVkbyh0aGlzLmluc3RhbmNlLCBmdW5jdGlvbigpIHtcbiAgICAgIHRoYXQuaWdub3JlTmV3QWN0aW9ucyA9IGZhbHNlO1xuICAgICAgdGhhdC5kb25lQWN0aW9ucy5wdXNoKGFjdGlvbik7XG4gICAgfSk7XG4gICAgaW5zdGFuY2UucnVuSG9va3MoJ2FmdGVyUmVkbycsIGFjdGlvbkNsb25lKTtcbiAgfVxufTtcbkhhbmRzb250YWJsZS5VbmRvUmVkby5wcm90b3R5cGUuaXNVbmRvQXZhaWxhYmxlID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLmRvbmVBY3Rpb25zLmxlbmd0aCA+IDA7XG59O1xuSGFuZHNvbnRhYmxlLlVuZG9SZWRvLnByb3RvdHlwZS5pc1JlZG9BdmFpbGFibGUgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMudW5kb25lQWN0aW9ucy5sZW5ndGggPiAwO1xufTtcbkhhbmRzb250YWJsZS5VbmRvUmVkby5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5kb25lQWN0aW9ucy5sZW5ndGggPSAwO1xuICB0aGlzLnVuZG9uZUFjdGlvbnMubGVuZ3RoID0gMDtcbn07XG5IYW5kc29udGFibGUuVW5kb1JlZG8uQWN0aW9uID0gZnVuY3Rpb24oKSB7fTtcbkhhbmRzb250YWJsZS5VbmRvUmVkby5BY3Rpb24ucHJvdG90eXBlLnVuZG8gPSBmdW5jdGlvbigpIHt9O1xuSGFuZHNvbnRhYmxlLlVuZG9SZWRvLkFjdGlvbi5wcm90b3R5cGUucmVkbyA9IGZ1bmN0aW9uKCkge307XG5IYW5kc29udGFibGUuVW5kb1JlZG8uQ2hhbmdlQWN0aW9uID0gZnVuY3Rpb24oY2hhbmdlcykge1xuICB0aGlzLmNoYW5nZXMgPSBjaGFuZ2VzO1xuICB0aGlzLmFjdGlvblR5cGUgPSAnY2hhbmdlJztcbn07XG5pbmhlcml0KEhhbmRzb250YWJsZS5VbmRvUmVkby5DaGFuZ2VBY3Rpb24sIEhhbmRzb250YWJsZS5VbmRvUmVkby5BY3Rpb24pO1xuSGFuZHNvbnRhYmxlLlVuZG9SZWRvLkNoYW5nZUFjdGlvbi5wcm90b3R5cGUudW5kbyA9IGZ1bmN0aW9uKGluc3RhbmNlLCB1bmRvbmVDYWxsYmFjaykge1xuICB2YXIgZGF0YSA9IGRlZXBDbG9uZSh0aGlzLmNoYW5nZXMpLFxuICAgICAgZW1wdHlSb3dzQXRUaGVFbmQgPSBpbnN0YW5jZS5jb3VudEVtcHR5Um93cyh0cnVlKSxcbiAgICAgIGVtcHR5Q29sc0F0VGhlRW5kID0gaW5zdGFuY2UuY291bnRFbXB0eUNvbHModHJ1ZSk7XG4gIGZvciAodmFyIGkgPSAwLFxuICAgICAgbGVuID0gZGF0YS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgIGRhdGFbaV0uc3BsaWNlKDMsIDEpO1xuICB9XG4gIGluc3RhbmNlLmFkZEhvb2tPbmNlKCdhZnRlckNoYW5nZScsIHVuZG9uZUNhbGxiYWNrKTtcbiAgaW5zdGFuY2Uuc2V0RGF0YUF0Um93UHJvcChkYXRhLCBudWxsLCBudWxsLCAnVW5kb1JlZG8udW5kbycpO1xuICBmb3IgKHZhciBpJF9fNiA9IDAsXG4gICAgICBsZW4kX183ID0gZGF0YS5sZW5ndGg7IGkkX182IDwgbGVuJF9fNzsgaSRfXzYrKykge1xuICAgIGlmIChpbnN0YW5jZS5nZXRTZXR0aW5ncygpLm1pblNwYXJlUm93cyAmJiBkYXRhW2kkX182XVswXSArIDEgKyBpbnN0YW5jZS5nZXRTZXR0aW5ncygpLm1pblNwYXJlUm93cyA9PT0gaW5zdGFuY2UuY291bnRSb3dzKCkgJiYgZW1wdHlSb3dzQXRUaGVFbmQgPT0gaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5taW5TcGFyZVJvd3MpIHtcbiAgICAgIGluc3RhbmNlLmFsdGVyKCdyZW1vdmVfcm93JywgcGFyc2VJbnQoZGF0YVtpJF9fNl1bMF0gKyAxLCAxMCksIGluc3RhbmNlLmdldFNldHRpbmdzKCkubWluU3BhcmVSb3dzKTtcbiAgICAgIGluc3RhbmNlLnVuZG9SZWRvLmRvbmVBY3Rpb25zLnBvcCgpO1xuICAgIH1cbiAgICBpZiAoaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5taW5TcGFyZUNvbHMgJiYgZGF0YVtpJF9fNl1bMV0gKyAxICsgaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS5taW5TcGFyZUNvbHMgPT09IGluc3RhbmNlLmNvdW50Q29scygpICYmIGVtcHR5Q29sc0F0VGhlRW5kID09IGluc3RhbmNlLmdldFNldHRpbmdzKCkubWluU3BhcmVDb2xzKSB7XG4gICAgICBpbnN0YW5jZS5hbHRlcigncmVtb3ZlX2NvbCcsIHBhcnNlSW50KGRhdGFbaSRfXzZdWzFdICsgMSwgMTApLCBpbnN0YW5jZS5nZXRTZXR0aW5ncygpLm1pblNwYXJlQ29scyk7XG4gICAgICBpbnN0YW5jZS51bmRvUmVkby5kb25lQWN0aW9ucy5wb3AoKTtcbiAgICB9XG4gIH1cbn07XG5IYW5kc29udGFibGUuVW5kb1JlZG8uQ2hhbmdlQWN0aW9uLnByb3RvdHlwZS5yZWRvID0gZnVuY3Rpb24oaW5zdGFuY2UsIG9uRmluaXNoQ2FsbGJhY2spIHtcbiAgdmFyIGRhdGEgPSBkZWVwQ2xvbmUodGhpcy5jaGFuZ2VzKTtcbiAgZm9yICh2YXIgaSA9IDAsXG4gICAgICBsZW4gPSBkYXRhLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgZGF0YVtpXS5zcGxpY2UoMiwgMSk7XG4gIH1cbiAgaW5zdGFuY2UuYWRkSG9va09uY2UoJ2FmdGVyQ2hhbmdlJywgb25GaW5pc2hDYWxsYmFjayk7XG4gIGluc3RhbmNlLnNldERhdGFBdFJvd1Byb3AoZGF0YSwgbnVsbCwgbnVsbCwgJ1VuZG9SZWRvLnJlZG8nKTtcbn07XG5IYW5kc29udGFibGUuVW5kb1JlZG8uQ3JlYXRlUm93QWN0aW9uID0gZnVuY3Rpb24oaW5kZXgsIGFtb3VudCkge1xuICB0aGlzLmluZGV4ID0gaW5kZXg7XG4gIHRoaXMuYW1vdW50ID0gYW1vdW50O1xuICB0aGlzLmFjdGlvblR5cGUgPSAnaW5zZXJ0X3Jvdyc7XG59O1xuaW5oZXJpdChIYW5kc29udGFibGUuVW5kb1JlZG8uQ3JlYXRlUm93QWN0aW9uLCBIYW5kc29udGFibGUuVW5kb1JlZG8uQWN0aW9uKTtcbkhhbmRzb250YWJsZS5VbmRvUmVkby5DcmVhdGVSb3dBY3Rpb24ucHJvdG90eXBlLnVuZG8gPSBmdW5jdGlvbihpbnN0YW5jZSwgdW5kb25lQ2FsbGJhY2spIHtcbiAgdmFyIHJvd0NvdW50ID0gaW5zdGFuY2UuY291bnRSb3dzKCksXG4gICAgICBtaW5TcGFyZVJvd3MgPSBpbnN0YW5jZS5nZXRTZXR0aW5ncygpLm1pblNwYXJlUm93cztcbiAgaWYgKHRoaXMuaW5kZXggPj0gcm93Q291bnQgJiYgdGhpcy5pbmRleCAtIG1pblNwYXJlUm93cyA8IHJvd0NvdW50KSB7XG4gICAgdGhpcy5pbmRleCAtPSBtaW5TcGFyZVJvd3M7XG4gIH1cbiAgaW5zdGFuY2UuYWRkSG9va09uY2UoJ2FmdGVyUmVtb3ZlUm93JywgdW5kb25lQ2FsbGJhY2spO1xuICBpbnN0YW5jZS5hbHRlcigncmVtb3ZlX3JvdycsIHRoaXMuaW5kZXgsIHRoaXMuYW1vdW50LCAnVW5kb1JlZG8udW5kbycpO1xufTtcbkhhbmRzb250YWJsZS5VbmRvUmVkby5DcmVhdGVSb3dBY3Rpb24ucHJvdG90eXBlLnJlZG8gPSBmdW5jdGlvbihpbnN0YW5jZSwgcmVkb25lQ2FsbGJhY2spIHtcbiAgaW5zdGFuY2UuYWRkSG9va09uY2UoJ2FmdGVyQ3JlYXRlUm93JywgcmVkb25lQ2FsbGJhY2spO1xuICBpbnN0YW5jZS5hbHRlcignaW5zZXJ0X3JvdycsIHRoaXMuaW5kZXgsIHRoaXMuYW1vdW50LCAnVW5kb1JlZG8ucmVkbycpO1xufTtcbkhhbmRzb250YWJsZS5VbmRvUmVkby5SZW1vdmVSb3dBY3Rpb24gPSBmdW5jdGlvbihpbmRleCwgZGF0YSkge1xuICB0aGlzLmluZGV4ID0gaW5kZXg7XG4gIHRoaXMuZGF0YSA9IGRhdGE7XG4gIHRoaXMuYWN0aW9uVHlwZSA9ICdyZW1vdmVfcm93Jztcbn07XG5pbmhlcml0KEhhbmRzb250YWJsZS5VbmRvUmVkby5SZW1vdmVSb3dBY3Rpb24sIEhhbmRzb250YWJsZS5VbmRvUmVkby5BY3Rpb24pO1xuSGFuZHNvbnRhYmxlLlVuZG9SZWRvLlJlbW92ZVJvd0FjdGlvbi5wcm90b3R5cGUudW5kbyA9IGZ1bmN0aW9uKGluc3RhbmNlLCB1bmRvbmVDYWxsYmFjaykge1xuICBpbnN0YW5jZS5hbHRlcignaW5zZXJ0X3JvdycsIHRoaXMuaW5kZXgsIHRoaXMuZGF0YS5sZW5ndGgsICdVbmRvUmVkby51bmRvJyk7XG4gIGluc3RhbmNlLmFkZEhvb2tPbmNlKCdhZnRlclJlbmRlcicsIHVuZG9uZUNhbGxiYWNrKTtcbiAgaW5zdGFuY2UucG9wdWxhdGVGcm9tQXJyYXkodGhpcy5pbmRleCwgMCwgdGhpcy5kYXRhLCB2b2lkIDAsIHZvaWQgMCwgJ1VuZG9SZWRvLnVuZG8nKTtcbn07XG5IYW5kc29udGFibGUuVW5kb1JlZG8uUmVtb3ZlUm93QWN0aW9uLnByb3RvdHlwZS5yZWRvID0gZnVuY3Rpb24oaW5zdGFuY2UsIHJlZG9uZUNhbGxiYWNrKSB7XG4gIGluc3RhbmNlLmFkZEhvb2tPbmNlKCdhZnRlclJlbW92ZVJvdycsIHJlZG9uZUNhbGxiYWNrKTtcbiAgaW5zdGFuY2UuYWx0ZXIoJ3JlbW92ZV9yb3cnLCB0aGlzLmluZGV4LCB0aGlzLmRhdGEubGVuZ3RoLCAnVW5kb1JlZG8ucmVkbycpO1xufTtcbkhhbmRzb250YWJsZS5VbmRvUmVkby5DcmVhdGVDb2x1bW5BY3Rpb24gPSBmdW5jdGlvbihpbmRleCwgYW1vdW50KSB7XG4gIHRoaXMuaW5kZXggPSBpbmRleDtcbiAgdGhpcy5hbW91bnQgPSBhbW91bnQ7XG4gIHRoaXMuYWN0aW9uVHlwZSA9ICdpbnNlcnRfY29sJztcbn07XG5pbmhlcml0KEhhbmRzb250YWJsZS5VbmRvUmVkby5DcmVhdGVDb2x1bW5BY3Rpb24sIEhhbmRzb250YWJsZS5VbmRvUmVkby5BY3Rpb24pO1xuSGFuZHNvbnRhYmxlLlVuZG9SZWRvLkNyZWF0ZUNvbHVtbkFjdGlvbi5wcm90b3R5cGUudW5kbyA9IGZ1bmN0aW9uKGluc3RhbmNlLCB1bmRvbmVDYWxsYmFjaykge1xuICBpbnN0YW5jZS5hZGRIb29rT25jZSgnYWZ0ZXJSZW1vdmVDb2wnLCB1bmRvbmVDYWxsYmFjayk7XG4gIGluc3RhbmNlLmFsdGVyKCdyZW1vdmVfY29sJywgdGhpcy5pbmRleCwgdGhpcy5hbW91bnQsICdVbmRvUmVkby51bmRvJyk7XG59O1xuSGFuZHNvbnRhYmxlLlVuZG9SZWRvLkNyZWF0ZUNvbHVtbkFjdGlvbi5wcm90b3R5cGUucmVkbyA9IGZ1bmN0aW9uKGluc3RhbmNlLCByZWRvbmVDYWxsYmFjaykge1xuICBpbnN0YW5jZS5hZGRIb29rT25jZSgnYWZ0ZXJDcmVhdGVDb2wnLCByZWRvbmVDYWxsYmFjayk7XG4gIGluc3RhbmNlLmFsdGVyKCdpbnNlcnRfY29sJywgdGhpcy5pbmRleCwgdGhpcy5hbW91bnQsICdVbmRvUmVkby5yZWRvJyk7XG59O1xuSGFuZHNvbnRhYmxlLlVuZG9SZWRvLlJlbW92ZUNvbHVtbkFjdGlvbiA9IGZ1bmN0aW9uKGluZGV4LCBpbmRleGVzLCBkYXRhLCBoZWFkZXJzLCBjb2x1bW5Qb3NpdGlvbnMpIHtcbiAgdGhpcy5pbmRleCA9IGluZGV4O1xuICB0aGlzLmluZGV4ZXMgPSBpbmRleGVzO1xuICB0aGlzLmRhdGEgPSBkYXRhO1xuICB0aGlzLmFtb3VudCA9IHRoaXMuZGF0YVswXS5sZW5ndGg7XG4gIHRoaXMuaGVhZGVycyA9IGhlYWRlcnM7XG4gIHRoaXMuY29sdW1uUG9zaXRpb25zID0gY29sdW1uUG9zaXRpb25zLnNsaWNlKDApO1xuICB0aGlzLmFjdGlvblR5cGUgPSAncmVtb3ZlX2NvbCc7XG59O1xuaW5oZXJpdChIYW5kc29udGFibGUuVW5kb1JlZG8uUmVtb3ZlQ29sdW1uQWN0aW9uLCBIYW5kc29udGFibGUuVW5kb1JlZG8uQWN0aW9uKTtcbkhhbmRzb250YWJsZS5VbmRvUmVkby5SZW1vdmVDb2x1bW5BY3Rpb24ucHJvdG90eXBlLnVuZG8gPSBmdW5jdGlvbihpbnN0YW5jZSwgdW5kb25lQ2FsbGJhY2spIHtcbiAgdmFyICRfXzUgPSB0aGlzO1xuICB2YXIgcm93O1xuICB2YXIgYXNjZW5kaW5nSW5kZXhlcyA9IHRoaXMuaW5kZXhlcy5zbGljZSgwKS5zb3J0KCk7XG4gIHZhciBzb3J0QnlJbmRleGVzID0gKGZ1bmN0aW9uKGVsZW0sIGosIGFycikge1xuICAgIHJldHVybiBhcnJbJF9fNS5pbmRleGVzLmluZGV4T2YoYXNjZW5kaW5nSW5kZXhlc1tqXSldO1xuICB9KTtcbiAgdmFyIHNvcnRlZERhdGEgPSBbXTtcbiAgcmFuZ2VFYWNoKHRoaXMuZGF0YS5sZW5ndGggLSAxLCAoZnVuY3Rpb24oaSkge1xuICAgIHNvcnRlZERhdGFbaV0gPSBhcnJheU1hcCgkX181LmRhdGFbaV0sIHNvcnRCeUluZGV4ZXMpO1xuICB9KSk7XG4gIHZhciBzb3J0ZWRIZWFkZXJzID0gW107XG4gIHNvcnRlZEhlYWRlcnMgPSBhcnJheU1hcCh0aGlzLmhlYWRlcnMsIHNvcnRCeUluZGV4ZXMpO1xuICB2YXIgY2hhbmdlcyA9IFtdO1xuICBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnYmVmb3JlQ3JlYXRlQ29sJywgdGhpcy5pbmRleGVzWzBdLCB0aGlzLmluZGV4ZXNbdGhpcy5pbmRleGVzLmxlbmd0aCAtIDFdLCAnVW5kb1JlZG8udW5kbycpO1xuICByYW5nZUVhY2godGhpcy5kYXRhLmxlbmd0aCAtIDEsIChmdW5jdGlvbihpKSB7XG4gICAgcm93ID0gaW5zdGFuY2UuZ2V0U291cmNlRGF0YUF0Um93KGkpO1xuICAgIHJhbmdlRWFjaChhc2NlbmRpbmdJbmRleGVzLmxlbmd0aCAtIDEsIChmdW5jdGlvbihqKSB7XG4gICAgICByb3cuc3BsaWNlKGFzY2VuZGluZ0luZGV4ZXNbal0sIDAsIHNvcnRlZERhdGFbaV1bal0pO1xuICAgICAgY2hhbmdlcy5wdXNoKFtpLCBhc2NlbmRpbmdJbmRleGVzW2pdLCBudWxsLCBzb3J0ZWREYXRhW2ldW2pdXSk7XG4gICAgfSkpO1xuICB9KSk7XG4gIGlmIChpbnN0YW5jZS5nZXRQbHVnaW4oJ2Zvcm11bGFzJykpIHtcbiAgICBpbnN0YW5jZS5nZXRQbHVnaW4oJ2Zvcm11bGFzJykub25BZnRlclNldERhdGFBdENlbGwoY2hhbmdlcyk7XG4gIH1cbiAgaWYgKHR5cGVvZiB0aGlzLmhlYWRlcnMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmFuZ2VFYWNoKHNvcnRlZEhlYWRlcnMubGVuZ3RoIC0gMSwgKGZ1bmN0aW9uKGopIHtcbiAgICAgIGluc3RhbmNlLmdldFNldHRpbmdzKCkuY29sSGVhZGVycy5zcGxpY2UoYXNjZW5kaW5nSW5kZXhlc1tqXSwgMCwgc29ydGVkSGVhZGVyc1tqXSk7XG4gICAgfSkpO1xuICB9XG4gIGlmIChpbnN0YW5jZS5nZXRQbHVnaW4oJ21hbnVhbENvbHVtbk1vdmUnKSkge1xuICAgIGluc3RhbmNlLmdldFBsdWdpbignbWFudWFsQ29sdW1uTW92ZScpLmNvbHVtbnNNYXBwZXIuX19hcnJheU1hcCA9IHRoaXMuY29sdW1uUG9zaXRpb25zO1xuICB9XG4gIGluc3RhbmNlLmFkZEhvb2tPbmNlKCdhZnRlclJlbmRlcicsIHVuZG9uZUNhbGxiYWNrKTtcbiAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2FmdGVyQ3JlYXRlQ29sJywgdGhpcy5pbmRleGVzWzBdLCB0aGlzLmluZGV4ZXNbdGhpcy5pbmRleGVzLmxlbmd0aCAtIDFdLCAnVW5kb1JlZG8udW5kbycpO1xuICBpZiAoaW5zdGFuY2UuZ2V0UGx1Z2luKCdmb3JtdWxhcycpKSB7XG4gICAgaW5zdGFuY2UuZ2V0UGx1Z2luKCdmb3JtdWxhcycpLnJlY2FsY3VsYXRlRnVsbCgpO1xuICB9XG4gIGluc3RhbmNlLnJlbmRlcigpO1xufTtcbkhhbmRzb250YWJsZS5VbmRvUmVkby5SZW1vdmVDb2x1bW5BY3Rpb24ucHJvdG90eXBlLnJlZG8gPSBmdW5jdGlvbihpbnN0YW5jZSwgcmVkb25lQ2FsbGJhY2spIHtcbiAgaW5zdGFuY2UuYWRkSG9va09uY2UoJ2FmdGVyUmVtb3ZlQ29sJywgcmVkb25lQ2FsbGJhY2spO1xuICBpbnN0YW5jZS5hbHRlcigncmVtb3ZlX2NvbCcsIHRoaXMuaW5kZXgsIHRoaXMuYW1vdW50LCAnVW5kb1JlZG8ucmVkbycpO1xufTtcbkhhbmRzb250YWJsZS5VbmRvUmVkby5DZWxsQWxpZ25tZW50QWN0aW9uID0gZnVuY3Rpb24oc3RhdGVCZWZvcmUsIHJhbmdlLCB0eXBlLCBhbGlnbm1lbnQpIHtcbiAgdGhpcy5zdGF0ZUJlZm9yZSA9IHN0YXRlQmVmb3JlO1xuICB0aGlzLnJhbmdlID0gcmFuZ2U7XG4gIHRoaXMudHlwZSA9IHR5cGU7XG4gIHRoaXMuYWxpZ25tZW50ID0gYWxpZ25tZW50O1xufTtcbkhhbmRzb250YWJsZS5VbmRvUmVkby5DZWxsQWxpZ25tZW50QWN0aW9uLnByb3RvdHlwZS51bmRvID0gZnVuY3Rpb24oaW5zdGFuY2UsIHVuZG9uZUNhbGxiYWNrKSB7XG4gIGlmICghaW5zdGFuY2UuZ2V0UGx1Z2luKCdjb250ZXh0TWVudScpLmlzRW5hYmxlZCgpKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGZvciAodmFyIHJvdyA9IHRoaXMucmFuZ2UuZnJvbS5yb3c7IHJvdyA8PSB0aGlzLnJhbmdlLnRvLnJvdzsgcm93KyspIHtcbiAgICBmb3IgKHZhciBjb2wgPSB0aGlzLnJhbmdlLmZyb20uY29sOyBjb2wgPD0gdGhpcy5yYW5nZS50by5jb2w7IGNvbCsrKSB7XG4gICAgICBpbnN0YW5jZS5zZXRDZWxsTWV0YShyb3csIGNvbCwgJ2NsYXNzTmFtZScsIHRoaXMuc3RhdGVCZWZvcmVbcm93XVtjb2xdIHx8ICcgaHRMZWZ0Jyk7XG4gICAgfVxuICB9XG4gIGluc3RhbmNlLmFkZEhvb2tPbmNlKCdhZnRlclJlbmRlcicsIHVuZG9uZUNhbGxiYWNrKTtcbiAgaW5zdGFuY2UucmVuZGVyKCk7XG59O1xuSGFuZHNvbnRhYmxlLlVuZG9SZWRvLkNlbGxBbGlnbm1lbnRBY3Rpb24ucHJvdG90eXBlLnJlZG8gPSBmdW5jdGlvbihpbnN0YW5jZSwgdW5kb25lQ2FsbGJhY2spIHtcbiAgaWYgKCFpbnN0YW5jZS5nZXRQbHVnaW4oJ2NvbnRleHRNZW51JykuaXNFbmFibGVkKCkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaW5zdGFuY2Uuc2VsZWN0Q2VsbCh0aGlzLnJhbmdlLmZyb20ucm93LCB0aGlzLnJhbmdlLmZyb20uY29sLCB0aGlzLnJhbmdlLnRvLnJvdywgdGhpcy5yYW5nZS50by5jb2wpO1xuICBpbnN0YW5jZS5nZXRQbHVnaW4oJ2NvbnRleHRNZW51JykuZXhlY3V0ZUNvbW1hbmQoJ2FsaWdubWVudDonICsgdGhpcy5hbGlnbm1lbnQucmVwbGFjZSgnaHQnLCAnJykudG9Mb3dlckNhc2UoKSk7XG4gIGluc3RhbmNlLmFkZEhvb2tPbmNlKCdhZnRlclJlbmRlcicsIHVuZG9uZUNhbGxiYWNrKTtcbiAgaW5zdGFuY2UucmVuZGVyKCk7XG59O1xuSGFuZHNvbnRhYmxlLlVuZG9SZWRvLkZpbHRlcnNBY3Rpb24gPSBmdW5jdGlvbihmb3JtdWxhU3RhY2tzKSB7XG4gIHRoaXMuZm9ybXVsYVN0YWNrcyA9IGZvcm11bGFTdGFja3M7XG4gIHRoaXMuYWN0aW9uVHlwZSA9ICdmaWx0ZXInO1xufTtcbmluaGVyaXQoSGFuZHNvbnRhYmxlLlVuZG9SZWRvLkZpbHRlcnNBY3Rpb24sIEhhbmRzb250YWJsZS5VbmRvUmVkby5BY3Rpb24pO1xuSGFuZHNvbnRhYmxlLlVuZG9SZWRvLkZpbHRlcnNBY3Rpb24ucHJvdG90eXBlLnVuZG8gPSBmdW5jdGlvbihpbnN0YW5jZSwgdW5kb25lQ2FsbGJhY2spIHtcbiAgdmFyIGZpbHRlcnMgPSBpbnN0YW5jZS5nZXRQbHVnaW4oJ2ZpbHRlcnMnKTtcbiAgaW5zdGFuY2UuYWRkSG9va09uY2UoJ2FmdGVyUmVuZGVyJywgdW5kb25lQ2FsbGJhY2spO1xuICBmaWx0ZXJzLmZvcm11bGFDb2xsZWN0aW9uLmltcG9ydEFsbEZvcm11bGFzKHRoaXMuZm9ybXVsYVN0YWNrcy5zbGljZSgwLCB0aGlzLmZvcm11bGFTdGFja3MubGVuZ3RoIC0gMSkpO1xuICBmaWx0ZXJzLmZpbHRlcigpO1xufTtcbkhhbmRzb250YWJsZS5VbmRvUmVkby5GaWx0ZXJzQWN0aW9uLnByb3RvdHlwZS5yZWRvID0gZnVuY3Rpb24oaW5zdGFuY2UsIHJlZG9uZUNhbGxiYWNrKSB7XG4gIHZhciBmaWx0ZXJzID0gaW5zdGFuY2UuZ2V0UGx1Z2luKCdmaWx0ZXJzJyk7XG4gIGluc3RhbmNlLmFkZEhvb2tPbmNlKCdhZnRlclJlbmRlcicsIHJlZG9uZUNhbGxiYWNrKTtcbiAgZmlsdGVycy5mb3JtdWxhQ29sbGVjdGlvbi5pbXBvcnRBbGxGb3JtdWxhcyh0aGlzLmZvcm11bGFTdGFja3MpO1xuICBmaWx0ZXJzLmZpbHRlcigpO1xufTtcbkhhbmRzb250YWJsZS5VbmRvUmVkby5Sb3dNb3ZlQWN0aW9uID0gZnVuY3Rpb24obW92ZWRSb3dzLCB0YXJnZXQpIHtcbiAgdGhpcy5yb3dzID0gbW92ZWRSb3dzLnNsaWNlKCk7XG4gIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xufTtcbmluaGVyaXQoSGFuZHNvbnRhYmxlLlVuZG9SZWRvLlJvd01vdmVBY3Rpb24sIEhhbmRzb250YWJsZS5VbmRvUmVkby5BY3Rpb24pO1xuSGFuZHNvbnRhYmxlLlVuZG9SZWRvLlJvd01vdmVBY3Rpb24ucHJvdG90eXBlLnVuZG8gPSBmdW5jdGlvbihpbnN0YW5jZSwgdW5kb25lQ2FsbGJhY2spIHtcbiAgdmFyIG1hbnVhbFJvd01vdmUgPSBpbnN0YW5jZS5nZXRQbHVnaW4oJ21hbnVhbFJvd01vdmUnKTtcbiAgaW5zdGFuY2UuYWRkSG9va09uY2UoJ2FmdGVyUmVuZGVyJywgdW5kb25lQ2FsbGJhY2spO1xuICB2YXIgbW9kID0gdGhpcy5yb3dzWzBdIDwgdGhpcy50YXJnZXQgPyAtMSAqIHRoaXMucm93cy5sZW5ndGggOiAwO1xuICB2YXIgbmV3VGFyZ2V0ID0gdGhpcy5yb3dzWzBdID4gdGhpcy50YXJnZXQgPyB0aGlzLnJvd3NbMF0gKyB0aGlzLnJvd3MubGVuZ3RoIDogdGhpcy5yb3dzWzBdO1xuICB2YXIgbmV3Um93cyA9IFtdO1xuICB2YXIgcm93c0xlbiA9IHRoaXMucm93cy5sZW5ndGggKyBtb2Q7XG4gIGZvciAodmFyIGkgPSBtb2Q7IGkgPCByb3dzTGVuOyBpKyspIHtcbiAgICBuZXdSb3dzLnB1c2godGhpcy50YXJnZXQgKyBpKTtcbiAgfVxuICBtYW51YWxSb3dNb3ZlLm1vdmVSb3dzKG5ld1Jvd3Muc2xpY2UoKSwgbmV3VGFyZ2V0KTtcbiAgaW5zdGFuY2UucmVuZGVyKCk7XG4gIGluc3RhbmNlLnNlbGVjdGlvbi5zZXRSYW5nZVN0YXJ0T25seShuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHRoaXMucm93c1swXSwgMCkpO1xuICBpbnN0YW5jZS5zZWxlY3Rpb24uc2V0UmFuZ2VFbmQobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3Jkcyh0aGlzLnJvd3NbdGhpcy5yb3dzLmxlbmd0aCAtIDFdLCBpbnN0YW5jZS5jb3VudENvbHMoKSAtIDEpKTtcbn07XG5IYW5kc29udGFibGUuVW5kb1JlZG8uUm93TW92ZUFjdGlvbi5wcm90b3R5cGUucmVkbyA9IGZ1bmN0aW9uKGluc3RhbmNlLCByZWRvbmVDYWxsYmFjaykge1xuICB2YXIgbWFudWFsUm93TW92ZSA9IGluc3RhbmNlLmdldFBsdWdpbignbWFudWFsUm93TW92ZScpO1xuICBpbnN0YW5jZS5hZGRIb29rT25jZSgnYWZ0ZXJSZW5kZXInLCByZWRvbmVDYWxsYmFjayk7XG4gIG1hbnVhbFJvd01vdmUubW92ZVJvd3ModGhpcy5yb3dzLnNsaWNlKCksIHRoaXMudGFyZ2V0KTtcbiAgaW5zdGFuY2UucmVuZGVyKCk7XG4gIHZhciBzdGFydFNlbGVjdGlvbiA9IHRoaXMucm93c1swXSA8IHRoaXMudGFyZ2V0ID8gdGhpcy50YXJnZXQgLSB0aGlzLnJvd3MubGVuZ3RoIDogdGhpcy50YXJnZXQ7XG4gIGluc3RhbmNlLnNlbGVjdGlvbi5zZXRSYW5nZVN0YXJ0T25seShuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHN0YXJ0U2VsZWN0aW9uLCAwKSk7XG4gIGluc3RhbmNlLnNlbGVjdGlvbi5zZXRSYW5nZUVuZChuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHN0YXJ0U2VsZWN0aW9uICsgdGhpcy5yb3dzLmxlbmd0aCAtIDEsIGluc3RhbmNlLmNvdW50Q29scygpIC0gMSkpO1xufTtcbmZ1bmN0aW9uIGluaXQoKSB7XG4gIHZhciBpbnN0YW5jZSA9IHRoaXM7XG4gIHZhciBwbHVnaW5FbmFibGVkID0gdHlwZW9mIGluc3RhbmNlLmdldFNldHRpbmdzKCkudW5kbyA9PSAndW5kZWZpbmVkJyB8fCBpbnN0YW5jZS5nZXRTZXR0aW5ncygpLnVuZG87XG4gIGlmIChwbHVnaW5FbmFibGVkKSB7XG4gICAgaWYgKCFpbnN0YW5jZS51bmRvUmVkbykge1xuICAgICAgaW5zdGFuY2UudW5kb1JlZG8gPSBuZXcgSGFuZHNvbnRhYmxlLlVuZG9SZWRvKGluc3RhbmNlKTtcbiAgICAgIGV4cG9zZVVuZG9SZWRvTWV0aG9kcyhpbnN0YW5jZSk7XG4gICAgICBpbnN0YW5jZS5hZGRIb29rKCdiZWZvcmVLZXlEb3duJywgb25CZWZvcmVLZXlEb3duKTtcbiAgICAgIGluc3RhbmNlLmFkZEhvb2soJ2FmdGVyQ2hhbmdlJywgb25BZnRlckNoYW5nZSk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGlmIChpbnN0YW5jZS51bmRvUmVkbykge1xuICAgICAgZGVsZXRlIGluc3RhbmNlLnVuZG9SZWRvO1xuICAgICAgcmVtb3ZlRXhwb3NlZFVuZG9SZWRvTWV0aG9kcyhpbnN0YW5jZSk7XG4gICAgICBpbnN0YW5jZS5yZW1vdmVIb29rKCdiZWZvcmVLZXlEb3duJywgb25CZWZvcmVLZXlEb3duKTtcbiAgICAgIGluc3RhbmNlLnJlbW92ZUhvb2soJ2FmdGVyQ2hhbmdlJywgb25BZnRlckNoYW5nZSk7XG4gICAgfVxuICB9XG59XG5mdW5jdGlvbiBvbkJlZm9yZUtleURvd24oZXZlbnQpIHtcbiAgdmFyIGluc3RhbmNlID0gdGhpcztcbiAgdmFyIGN0cmxEb3duID0gKGV2ZW50LmN0cmxLZXkgfHwgZXZlbnQubWV0YUtleSkgJiYgIWV2ZW50LmFsdEtleTtcbiAgaWYgKGN0cmxEb3duKSB7XG4gICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDg5IHx8IChldmVudC5zaGlmdEtleSAmJiBldmVudC5rZXlDb2RlID09PSA5MCkpIHtcbiAgICAgIGluc3RhbmNlLnVuZG9SZWRvLnJlZG8oKTtcbiAgICAgIHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbihldmVudCk7XG4gICAgfSBlbHNlIGlmIChldmVudC5rZXlDb2RlID09PSA5MCkge1xuICAgICAgaW5zdGFuY2UudW5kb1JlZG8udW5kbygpO1xuICAgICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKGV2ZW50KTtcbiAgICB9XG4gIH1cbn1cbmZ1bmN0aW9uIG9uQWZ0ZXJDaGFuZ2UoY2hhbmdlcywgc291cmNlKSB7XG4gIHZhciBpbnN0YW5jZSA9IHRoaXM7XG4gIGlmIChzb3VyY2UgPT09ICdsb2FkRGF0YScpIHtcbiAgICByZXR1cm4gaW5zdGFuY2UudW5kb1JlZG8uY2xlYXIoKTtcbiAgfVxufVxuZnVuY3Rpb24gZXhwb3NlVW5kb1JlZG9NZXRob2RzKGluc3RhbmNlKSB7XG4gIGluc3RhbmNlLnVuZG8gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gaW5zdGFuY2UudW5kb1JlZG8udW5kbygpO1xuICB9O1xuICBpbnN0YW5jZS5yZWRvID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGluc3RhbmNlLnVuZG9SZWRvLnJlZG8oKTtcbiAgfTtcbiAgaW5zdGFuY2UuaXNVbmRvQXZhaWxhYmxlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGluc3RhbmNlLnVuZG9SZWRvLmlzVW5kb0F2YWlsYWJsZSgpO1xuICB9O1xuICBpbnN0YW5jZS5pc1JlZG9BdmFpbGFibGUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gaW5zdGFuY2UudW5kb1JlZG8uaXNSZWRvQXZhaWxhYmxlKCk7XG4gIH07XG4gIGluc3RhbmNlLmNsZWFyVW5kbyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBpbnN0YW5jZS51bmRvUmVkby5jbGVhcigpO1xuICB9O1xufVxuZnVuY3Rpb24gcmVtb3ZlRXhwb3NlZFVuZG9SZWRvTWV0aG9kcyhpbnN0YW5jZSkge1xuICBkZWxldGUgaW5zdGFuY2UudW5kbztcbiAgZGVsZXRlIGluc3RhbmNlLnJlZG87XG4gIGRlbGV0ZSBpbnN0YW5jZS5pc1VuZG9BdmFpbGFibGU7XG4gIGRlbGV0ZSBpbnN0YW5jZS5pc1JlZG9BdmFpbGFibGU7XG4gIGRlbGV0ZSBpbnN0YW5jZS5jbGVhclVuZG87XG59XG5IYW5kc29udGFibGUuaG9va3MuYWRkKCdhZnRlckluaXQnLCBpbml0KTtcbkhhbmRzb250YWJsZS5ob29rcy5hZGQoJ2FmdGVyVXBkYXRlU2V0dGluZ3MnLCBpbml0KTtcbkhhbmRzb250YWJsZS5ob29rcy5yZWdpc3RlcignYmVmb3JlVW5kbycpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLnJlZ2lzdGVyKCdhZnRlclVuZG8nKTtcbkhhbmRzb250YWJsZS5ob29rcy5yZWdpc3RlcignYmVmb3JlUmVkbycpO1xuSGFuZHNvbnRhYmxlLmhvb2tzLnJlZ2lzdGVyKCdhZnRlclJlZG8nKTtcblxuLy8jIFxufSx7XCJicm93c2VyXCI6MjQsXCJoZWxwZXJzL2FycmF5XCI6NDMsXCJoZWxwZXJzL2RvbS9ldmVudFwiOjQ4LFwiaGVscGVycy9udW1iZXJcIjo1MixcImhlbHBlcnMvb2JqZWN0XCI6NTN9XSwxMTc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIHJlZ2lzdGVyUmVuZGVyZXI6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHJlZ2lzdGVyUmVuZGVyZXI7XG4gICAgfX0sXG4gIGdldFJlbmRlcmVyOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBnZXRSZW5kZXJlcjtcbiAgICB9fSxcbiAgaGFzUmVuZGVyZXI6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGhhc1JlbmRlcmVyO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19icm93c2VyX18sXG4gICAgJF9faGVscGVyc180N19zdHJpbmdfXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX2Jyb3dzZXJfXyAmJiAkX19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgdG9VcHBlckNhc2VGaXJzdCA9ICgkX19oZWxwZXJzXzQ3X3N0cmluZ19fID0gX2RlcmVxXyhcImhlbHBlcnMvc3RyaW5nXCIpLCAkX19oZWxwZXJzXzQ3X3N0cmluZ19fICYmICRfX2hlbHBlcnNfNDdfc3RyaW5nX18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X3N0cmluZ19fIHx8IHtkZWZhdWx0OiAkX19oZWxwZXJzXzQ3X3N0cmluZ19ffSkudG9VcHBlckNhc2VGaXJzdDtcbnZhciByZWdpc3RlcmVkUmVuZGVyZXJzID0ge307XG5IYW5kc29udGFibGUucmVuZGVyZXJzID0gSGFuZHNvbnRhYmxlLnJlbmRlcmVycyB8fCB7fTtcbkhhbmRzb250YWJsZS5yZW5kZXJlcnMucmVnaXN0ZXJSZW5kZXJlciA9IHJlZ2lzdGVyUmVuZGVyZXI7XG5IYW5kc29udGFibGUucmVuZGVyZXJzLmdldFJlbmRlcmVyID0gZ2V0UmVuZGVyZXI7XG5mdW5jdGlvbiByZWdpc3RlclJlbmRlcmVyKHJlbmRlcmVyTmFtZSwgcmVuZGVyZXJGdW5jdGlvbikge1xuICB2YXIgcmVnaXN0ZXJOYW1lO1xuICByZWdpc3RlcmVkUmVuZGVyZXJzW3JlbmRlcmVyTmFtZV0gPSByZW5kZXJlckZ1bmN0aW9uO1xuICByZWdpc3Rlck5hbWUgPSB0b1VwcGVyQ2FzZUZpcnN0KHJlbmRlcmVyTmFtZSkgKyAnUmVuZGVyZXInO1xuICBIYW5kc29udGFibGUucmVuZGVyZXJzW3JlZ2lzdGVyTmFtZV0gPSByZW5kZXJlckZ1bmN0aW9uO1xuICBIYW5kc29udGFibGVbcmVnaXN0ZXJOYW1lXSA9IHJlbmRlcmVyRnVuY3Rpb247XG4gIGlmIChyZW5kZXJlck5hbWUgPT09ICdiYXNlJykge1xuICAgIEhhbmRzb250YWJsZS5yZW5kZXJlcnMuY2VsbERlY29yYXRvciA9IHJlbmRlcmVyRnVuY3Rpb247XG4gIH1cbn1cbmZ1bmN0aW9uIGdldFJlbmRlcmVyKHJlbmRlcmVyTmFtZSkge1xuICBpZiAodHlwZW9mIHJlbmRlcmVyTmFtZSA9PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIHJlbmRlcmVyTmFtZTtcbiAgfVxuICBpZiAodHlwZW9mIHJlbmRlcmVyTmFtZSAhPSAnc3RyaW5nJykge1xuICAgIHRocm93IEVycm9yKCdPbmx5IHN0cmluZ3MgYW5kIGZ1bmN0aW9ucyBjYW4gYmUgcGFzc2VkIGFzIFwicmVuZGVyZXJcIiBwYXJhbWV0ZXInKTtcbiAgfVxuICBpZiAoIShyZW5kZXJlck5hbWUgaW4gcmVnaXN0ZXJlZFJlbmRlcmVycykpIHtcbiAgICB0aHJvdyBFcnJvcignTm8gZWRpdG9yIHJlZ2lzdGVyZWQgdW5kZXIgbmFtZSBcIicgKyByZW5kZXJlck5hbWUgKyAnXCInKTtcbiAgfVxuICByZXR1cm4gcmVnaXN0ZXJlZFJlbmRlcmVyc1tyZW5kZXJlck5hbWVdO1xufVxuZnVuY3Rpb24gaGFzUmVuZGVyZXIocmVuZGVyZXJOYW1lKSB7XG4gIHJldHVybiByZW5kZXJlck5hbWUgaW4gcmVnaXN0ZXJlZFJlbmRlcmVycztcbn1cbjtcblxuLy8jIFxufSx7XCJicm93c2VyXCI6MjQsXCJoZWxwZXJzL3N0cmluZ1wiOjU1fV0sMTE4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBjZWxsRGVjb3JhdG9yOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBjZWxsRGVjb3JhdG9yO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfcmVuZGVyZXJzX187XG52YXIgJF9fMCA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSksXG4gICAgYWRkQ2xhc3MgPSAkX18wLmFkZENsYXNzLFxuICAgIHJlbW92ZUNsYXNzID0gJF9fMC5yZW1vdmVDbGFzcztcbnZhciByZWdpc3RlclJlbmRlcmVyID0gKCRfX180Nl9fNDZfXzQ3X3JlbmRlcmVyc19fID0gX2RlcmVxXyhcInJlbmRlcmVyc1wiKSwgJF9fXzQ2X180Nl9fNDdfcmVuZGVyZXJzX18gJiYgJF9fXzQ2X180Nl9fNDdfcmVuZGVyZXJzX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19yZW5kZXJlcnNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfcmVuZGVyZXJzX199KS5yZWdpc3RlclJlbmRlcmVyO1xuZnVuY3Rpb24gY2VsbERlY29yYXRvcihpbnN0YW5jZSwgVEQsIHJvdywgY29sLCBwcm9wLCB2YWx1ZSwgY2VsbFByb3BlcnRpZXMpIHtcbiAgaWYgKGNlbGxQcm9wZXJ0aWVzLmNsYXNzTmFtZSkge1xuICAgIGlmIChURC5jbGFzc05hbWUpIHtcbiAgICAgIFRELmNsYXNzTmFtZSA9IFRELmNsYXNzTmFtZSArICcgJyArIGNlbGxQcm9wZXJ0aWVzLmNsYXNzTmFtZTtcbiAgICB9IGVsc2Uge1xuICAgICAgVEQuY2xhc3NOYW1lID0gY2VsbFByb3BlcnRpZXMuY2xhc3NOYW1lO1xuICAgIH1cbiAgfVxuICBpZiAoY2VsbFByb3BlcnRpZXMucmVhZE9ubHkpIHtcbiAgICBhZGRDbGFzcyhURCwgY2VsbFByb3BlcnRpZXMucmVhZE9ubHlDZWxsQ2xhc3NOYW1lKTtcbiAgfVxuICBpZiAoY2VsbFByb3BlcnRpZXMudmFsaWQgPT09IGZhbHNlICYmIGNlbGxQcm9wZXJ0aWVzLmludmFsaWRDZWxsQ2xhc3NOYW1lKSB7XG4gICAgYWRkQ2xhc3MoVEQsIGNlbGxQcm9wZXJ0aWVzLmludmFsaWRDZWxsQ2xhc3NOYW1lKTtcbiAgfSBlbHNlIHtcbiAgICByZW1vdmVDbGFzcyhURCwgY2VsbFByb3BlcnRpZXMuaW52YWxpZENlbGxDbGFzc05hbWUpO1xuICB9XG4gIGlmIChjZWxsUHJvcGVydGllcy53b3JkV3JhcCA9PT0gZmFsc2UgJiYgY2VsbFByb3BlcnRpZXMubm9Xb3JkV3JhcENsYXNzTmFtZSkge1xuICAgIGFkZENsYXNzKFRELCBjZWxsUHJvcGVydGllcy5ub1dvcmRXcmFwQ2xhc3NOYW1lKTtcbiAgfVxuICBpZiAoIXZhbHVlICYmIGNlbGxQcm9wZXJ0aWVzLnBsYWNlaG9sZGVyKSB7XG4gICAgYWRkQ2xhc3MoVEQsIGNlbGxQcm9wZXJ0aWVzLnBsYWNlaG9sZGVyQ2VsbENsYXNzTmFtZSk7XG4gIH1cbn1cbjtcbnJlZ2lzdGVyUmVuZGVyZXIoJ2Jhc2UnLCBjZWxsRGVjb3JhdG9yKTtcblxuLy8jIFxufSx7XCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJyZW5kZXJlcnNcIjoxMTd9XSwxMTk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIGF1dG9jb21wbGV0ZVJlbmRlcmVyOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBhdXRvY29tcGxldGVSZW5kZXJlcjtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X3JlbmRlcmVyc19fLFxuICAgICRfX180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19fO1xudmFyICRfXzAgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLFxuICAgIGFkZENsYXNzID0gJF9fMC5hZGRDbGFzcyxcbiAgICBoYXNDbGFzcyA9ICRfXzAuaGFzQ2xhc3MsXG4gICAgZW1wdHkgPSAkX18wLmVtcHR5O1xudmFyIGV2ZW50TWFuYWdlck9iamVjdCA9ICgkX19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyA9IF9kZXJlcV8oXCJldmVudE1hbmFnZXJcIiksICRfX180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fICYmICRfX180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9ffSkuZXZlbnRNYW5hZ2VyO1xudmFyICRfXzIgPSAoJF9fXzQ2X180Nl9fNDdfcmVuZGVyZXJzX18gPSBfZGVyZXFfKFwicmVuZGVyZXJzXCIpLCAkX19fNDZfXzQ2X180N19yZW5kZXJlcnNfXyAmJiAkX19fNDZfXzQ2X180N19yZW5kZXJlcnNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X3JlbmRlcmVyc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19yZW5kZXJlcnNfX30pLFxuICAgIGdldFJlbmRlcmVyID0gJF9fMi5nZXRSZW5kZXJlcixcbiAgICByZWdpc3RlclJlbmRlcmVyID0gJF9fMi5yZWdpc3RlclJlbmRlcmVyO1xudmFyIFdhbGtvbnRhYmxlQ2VsbENvb3JkcyA9ICgkX19fNDZfXzQ2X180N18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2VsbF80N19jb29yZHNfXyA9IF9kZXJlcV8oXCIzcmRwYXJ0eS93YWxrb250YWJsZS9zcmMvY2VsbC9jb29yZHNcIiksICRfX180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19fICYmICRfX180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3XzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19ffSkuV2Fsa29udGFibGVDZWxsQ29vcmRzO1xudmFyIGNsb25hYmxlV1JBUFBFUiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xuY2xvbmFibGVXUkFQUEVSLmNsYXNzTmFtZSA9ICdodEF1dG9jb21wbGV0ZVdyYXBwZXInO1xudmFyIGNsb25hYmxlQVJST1cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKTtcbmNsb25hYmxlQVJST1cuY2xhc3NOYW1lID0gJ2h0QXV0b2NvbXBsZXRlQXJyb3cnO1xuY2xvbmFibGVBUlJPVy5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShTdHJpbmcuZnJvbUNoYXJDb2RlKDk2NjApKSk7XG52YXIgd3JhcFRkQ29udGVudFdpdGhXcmFwcGVyID0gZnVuY3Rpb24oVEQsIFdSQVBQRVIpIHtcbiAgV1JBUFBFUi5pbm5lckhUTUwgPSBURC5pbm5lckhUTUw7XG4gIGVtcHR5KFREKTtcbiAgVEQuYXBwZW5kQ2hpbGQoV1JBUFBFUik7XG59O1xuZnVuY3Rpb24gYXV0b2NvbXBsZXRlUmVuZGVyZXIoaW5zdGFuY2UsIFRELCByb3csIGNvbCwgcHJvcCwgdmFsdWUsIGNlbGxQcm9wZXJ0aWVzKSB7XG4gIHZhciBXUkFQUEVSID0gY2xvbmFibGVXUkFQUEVSLmNsb25lTm9kZSh0cnVlKTtcbiAgdmFyIEFSUk9XID0gY2xvbmFibGVBUlJPVy5jbG9uZU5vZGUodHJ1ZSk7XG4gIGlmIChjZWxsUHJvcGVydGllcy5hbGxvd0h0bWwpIHtcbiAgICBnZXRSZW5kZXJlcignaHRtbCcpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH0gZWxzZSB7XG4gICAgZ2V0UmVuZGVyZXIoJ3RleHQnKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9XG4gIFRELmFwcGVuZENoaWxkKEFSUk9XKTtcbiAgYWRkQ2xhc3MoVEQsICdodEF1dG9jb21wbGV0ZScpO1xuICBpZiAoIVRELmZpcnN0Q2hpbGQpIHtcbiAgICBURC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShTdHJpbmcuZnJvbUNoYXJDb2RlKDE2MCkpKTtcbiAgfVxuICBpZiAoIWluc3RhbmNlLmFjQXJyb3dMaXN0ZW5lcikge1xuICAgIHZhciBldmVudE1hbmFnZXIgPSBldmVudE1hbmFnZXJPYmplY3QoaW5zdGFuY2UpO1xuICAgIGluc3RhbmNlLmFjQXJyb3dMaXN0ZW5lciA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBpZiAoaGFzQ2xhc3MoZXZlbnQudGFyZ2V0LCAnaHRBdXRvY29tcGxldGVBcnJvdycpKSB7XG4gICAgICAgIGluc3RhbmNlLnZpZXcud3QuZ2V0U2V0dGluZygnb25DZWxsRGJsQ2xpY2snLCBudWxsLCBuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKHJvdywgY29sKSwgVEQpO1xuICAgICAgfVxuICAgIH07XG4gICAgZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoaW5zdGFuY2Uucm9vdEVsZW1lbnQsICdtb3VzZWRvd24nLCBpbnN0YW5jZS5hY0Fycm93TGlzdGVuZXIpO1xuICAgIGluc3RhbmNlLmFkZEhvb2tPbmNlKCdhZnRlckRlc3Ryb3knLCBmdW5jdGlvbigpIHtcbiAgICAgIGV2ZW50TWFuYWdlci5kZXN0cm95KCk7XG4gICAgfSk7XG4gIH1cbn1cbjtcbnJlZ2lzdGVyUmVuZGVyZXIoJ2F1dG9jb21wbGV0ZScsIGF1dG9jb21wbGV0ZVJlbmRlcmVyKTtcblxuLy8jIFxufSx7XCIzcmRwYXJ0eS93YWxrb250YWJsZS9zcmMvY2VsbC9jb29yZHNcIjo2LFwiZXZlbnRNYW5hZ2VyXCI6NDIsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJyZW5kZXJlcnNcIjoxMTd9XSwxMjA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIGNoZWNrYm94UmVuZGVyZXI6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGNoZWNrYm94UmVuZGVyZXI7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3N0cmluZ19fLFxuICAgICRfX180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X3JlbmRlcmVyc19fLFxuICAgICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZnVuY3Rpb25fXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fO1xudmFyICRfXzAgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLFxuICAgIGVtcHR5ID0gJF9fMC5lbXB0eSxcbiAgICBhZGRDbGFzcyA9ICRfXzAuYWRkQ2xhc3MsXG4gICAgaGFzQ2xhc3MgPSAkX18wLmhhc0NsYXNzO1xudmFyIGVxdWFsc0lnbm9yZUNhc2UgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19zdHJpbmdfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL3N0cmluZ1wiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19zdHJpbmdfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3N0cmluZ19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19zdHJpbmdfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19zdHJpbmdfX30pLmVxdWFsc0lnbm9yZUNhc2U7XG52YXIgRXZlbnRNYW5hZ2VyID0gKCRfX180Nl9fNDZfXzQ3X2V2ZW50TWFuYWdlcl9fID0gX2RlcmVxXyhcImV2ZW50TWFuYWdlclwiKSwgJF9fXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19ldmVudE1hbmFnZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfZXZlbnRNYW5hZ2VyX199KS5FdmVudE1hbmFnZXI7XG52YXIgJF9fMyA9ICgkX19fNDZfXzQ2X180N19yZW5kZXJlcnNfXyA9IF9kZXJlcV8oXCJyZW5kZXJlcnNcIiksICRfX180Nl9fNDZfXzQ3X3JlbmRlcmVyc19fICYmICRfX180Nl9fNDZfXzQ3X3JlbmRlcmVyc19fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfcmVuZGVyZXJzX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X3JlbmRlcmVyc19ffSksXG4gICAgZ2V0UmVuZGVyZXIgPSAkX18zLmdldFJlbmRlcmVyLFxuICAgIHJlZ2lzdGVyUmVuZGVyZXIgPSAkX18zLnJlZ2lzdGVyUmVuZGVyZXI7XG52YXIgaXNLZXkgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N191bmljb2RlX18gPSBfZGVyZXFfKFwiaGVscGVycy91bmljb2RlXCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfdW5pY29kZV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X3VuaWNvZGVfX30pLmlzS2V5O1xudmFyIHBhcnRpYWwgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19mdW5jdGlvbl9fID0gX2RlcmVxXyhcImhlbHBlcnMvZnVuY3Rpb25cIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZnVuY3Rpb25fXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Z1bmN0aW9uX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2Z1bmN0aW9uX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZnVuY3Rpb25fX30pLnBhcnRpYWw7XG52YXIgJF9fNiA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2V2ZW50XCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9ffSksXG4gICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uID0gJF9fNi5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24sXG4gICAgaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSAkX182LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkO1xudmFyIGlzTGlzdGVuaW5nS2V5RG93bkV2ZW50ID0gbmV3IFdlYWtNYXAoKTtcbnZhciBpc0NoZWNrYm94TGlzdGVuZXJBZGRlZCA9IG5ldyBXZWFrTWFwKCk7XG52YXIgQkFEX1ZBTFVFX0NMQVNTID0gJ2h0QmFkVmFsdWUnO1xuZnVuY3Rpb24gY2hlY2tib3hSZW5kZXJlcihpbnN0YW5jZSwgVEQsIHJvdywgY29sLCBwcm9wLCB2YWx1ZSwgY2VsbFByb3BlcnRpZXMpIHtcbiAgZ2V0UmVuZGVyZXIoJ2Jhc2UnKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB2YXIgZXZlbnRNYW5hZ2VyID0gcmVnaXN0ZXJFdmVudHMoaW5zdGFuY2UpO1xuICB2YXIgaW5wdXQgPSBjcmVhdGVJbnB1dCgpO1xuICB2YXIgbGFiZWxPcHRpb25zID0gY2VsbFByb3BlcnRpZXMubGFiZWw7XG4gIHZhciBiYWRWYWx1ZSA9IGZhbHNlO1xuICBpZiAodHlwZW9mIGNlbGxQcm9wZXJ0aWVzLmNoZWNrZWRUZW1wbGF0ZSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBjZWxsUHJvcGVydGllcy5jaGVja2VkVGVtcGxhdGUgPSB0cnVlO1xuICB9XG4gIGlmICh0eXBlb2YgY2VsbFByb3BlcnRpZXMudW5jaGVja2VkVGVtcGxhdGUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgY2VsbFByb3BlcnRpZXMudW5jaGVja2VkVGVtcGxhdGUgPSBmYWxzZTtcbiAgfVxuICBlbXB0eShURCk7XG4gIGlmICh2YWx1ZSA9PT0gY2VsbFByb3BlcnRpZXMuY2hlY2tlZFRlbXBsYXRlIHx8IGVxdWFsc0lnbm9yZUNhc2UodmFsdWUsIGNlbGxQcm9wZXJ0aWVzLmNoZWNrZWRUZW1wbGF0ZSkpIHtcbiAgICBpbnB1dC5jaGVja2VkID0gdHJ1ZTtcbiAgfSBlbHNlIGlmICh2YWx1ZSA9PT0gY2VsbFByb3BlcnRpZXMudW5jaGVja2VkVGVtcGxhdGUgfHwgZXF1YWxzSWdub3JlQ2FzZSh2YWx1ZSwgY2VsbFByb3BlcnRpZXMudW5jaGVja2VkVGVtcGxhdGUpKSB7XG4gICAgaW5wdXQuY2hlY2tlZCA9IGZhbHNlO1xuICB9IGVsc2UgaWYgKHZhbHVlID09PSBudWxsKSB7XG4gICAgYWRkQ2xhc3MoaW5wdXQsICdub1ZhbHVlJyk7XG4gIH0gZWxzZSB7XG4gICAgaW5wdXQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICBhZGRDbGFzcyhpbnB1dCwgQkFEX1ZBTFVFX0NMQVNTKTtcbiAgICBiYWRWYWx1ZSA9IHRydWU7XG4gIH1cbiAgaW5wdXQuc2V0QXR0cmlidXRlKCdkYXRhLXJvdycsIHJvdyk7XG4gIGlucHV0LnNldEF0dHJpYnV0ZSgnZGF0YS1jb2wnLCBjb2wpO1xuICBpZiAoIWJhZFZhbHVlICYmIGxhYmVsT3B0aW9ucykge1xuICAgIHZhciBsYWJlbFRleHQgPSAnJztcbiAgICBpZiAobGFiZWxPcHRpb25zLnZhbHVlKSB7XG4gICAgICBsYWJlbFRleHQgPSB0eXBlb2YgbGFiZWxPcHRpb25zLnZhbHVlID09PSAnZnVuY3Rpb24nID8gbGFiZWxPcHRpb25zLnZhbHVlLmNhbGwodGhpcywgcm93LCBjb2wsIHByb3AsIHZhbHVlKSA6IGxhYmVsT3B0aW9ucy52YWx1ZTtcbiAgICB9IGVsc2UgaWYgKGxhYmVsT3B0aW9ucy5wcm9wZXJ0eSkge1xuICAgICAgbGFiZWxUZXh0ID0gaW5zdGFuY2UuZ2V0RGF0YUF0Um93UHJvcChyb3csIGxhYmVsT3B0aW9ucy5wcm9wZXJ0eSk7XG4gICAgfVxuICAgIHZhciBsYWJlbCA9IGNyZWF0ZUxhYmVsKGxhYmVsVGV4dCk7XG4gICAgaWYgKGxhYmVsT3B0aW9ucy5wb3NpdGlvbiA9PT0gJ2JlZm9yZScpIHtcbiAgICAgIGxhYmVsLmFwcGVuZENoaWxkKGlucHV0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgbGFiZWwuaW5zZXJ0QmVmb3JlKGlucHV0LCBsYWJlbC5maXJzdENoaWxkKTtcbiAgICB9XG4gICAgaW5wdXQgPSBsYWJlbDtcbiAgfVxuICBURC5hcHBlbmRDaGlsZChpbnB1dCk7XG4gIGlmIChiYWRWYWx1ZSkge1xuICAgIFRELmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcjYmFkLXZhbHVlIycpKTtcbiAgfVxuICBpZiAoIWlzTGlzdGVuaW5nS2V5RG93bkV2ZW50LmhhcyhpbnN0YW5jZSkpIHtcbiAgICBpc0xpc3RlbmluZ0tleURvd25FdmVudC5zZXQoaW5zdGFuY2UsIHRydWUpO1xuICAgIGluc3RhbmNlLmFkZEhvb2soJ2JlZm9yZUtleURvd24nLCBvbkJlZm9yZUtleURvd24pO1xuICB9XG4gIGZ1bmN0aW9uIG9uQmVmb3JlS2V5RG93bihldmVudCkge1xuICAgIHZhciB0b2dnbGVLZXlzID0gJ1NQQUNFfEVOVEVSJztcbiAgICB2YXIgc3dpdGNoT2ZmS2V5cyA9ICdERUxFVEV8QkFDS1NQQUNFJztcbiAgICB2YXIgaXNLZXlDb2RlID0gcGFydGlhbChpc0tleSwgZXZlbnQua2V5Q29kZSk7XG4gICAgaWYgKGlzS2V5Q29kZSgodG9nZ2xlS2V5cyArIFwifFwiICsgc3dpdGNoT2ZmS2V5cykpICYmICFpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZChldmVudCkpIHtcbiAgICAgIGVhY2hTZWxlY3RlZENoZWNrYm94Q2VsbChmdW5jdGlvbigpIHtcbiAgICAgICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKGV2ZW50KTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoaXNLZXlDb2RlKHRvZ2dsZUtleXMpKSB7XG4gICAgICBjaGFuZ2VTZWxlY3RlZENoZWNrYm94ZXNTdGF0ZSgpO1xuICAgIH1cbiAgICBpZiAoaXNLZXlDb2RlKHN3aXRjaE9mZktleXMpKSB7XG4gICAgICBjaGFuZ2VTZWxlY3RlZENoZWNrYm94ZXNTdGF0ZSh0cnVlKTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gY2hhbmdlU2VsZWN0ZWRDaGVja2JveGVzU3RhdGUoKSB7XG4gICAgdmFyIHVuY2hlY2tDaGVja2JveCA9IGFyZ3VtZW50c1swXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTtcbiAgICB2YXIgc2VsUmFuZ2UgPSBpbnN0YW5jZS5nZXRTZWxlY3RlZFJhbmdlKCk7XG4gICAgaWYgKCFzZWxSYW5nZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdG9wTGVmdCA9IHNlbFJhbmdlLmdldFRvcExlZnRDb3JuZXIoKTtcbiAgICB2YXIgYm90dG9tUmlnaHQgPSBzZWxSYW5nZS5nZXRCb3R0b21SaWdodENvcm5lcigpO1xuICAgIHZhciBjaGFuZ2VzID0gW107XG4gICAgZm9yICh2YXIgcm93ID0gdG9wTGVmdC5yb3c7IHJvdyA8PSBib3R0b21SaWdodC5yb3c7IHJvdyArPSAxKSB7XG4gICAgICBmb3IgKHZhciBjb2wgPSB0b3BMZWZ0LmNvbDsgY29sIDw9IGJvdHRvbVJpZ2h0LmNvbDsgY29sICs9IDEpIHtcbiAgICAgICAgdmFyIGNlbGxQcm9wZXJ0aWVzJF9fNyA9IGluc3RhbmNlLmdldENlbGxNZXRhKHJvdywgY29sKTtcbiAgICAgICAgaWYgKGNlbGxQcm9wZXJ0aWVzJF9fNy50eXBlICE9PSAnY2hlY2tib3gnKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjZWxsUHJvcGVydGllcyRfXzcucmVhZE9ubHkgPT09IHRydWUpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGNlbGxQcm9wZXJ0aWVzJF9fNy5jaGVja2VkVGVtcGxhdGUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgY2VsbFByb3BlcnRpZXMkX183LmNoZWNrZWRUZW1wbGF0ZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBjZWxsUHJvcGVydGllcyRfXzcudW5jaGVja2VkVGVtcGxhdGUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgY2VsbFByb3BlcnRpZXMkX183LnVuY2hlY2tlZFRlbXBsYXRlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRhdGFBdENlbGwgPSBpbnN0YW5jZS5nZXREYXRhQXRDZWxsKHJvdywgY29sKTtcbiAgICAgICAgaWYgKHVuY2hlY2tDaGVja2JveCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICBpZiAoZGF0YUF0Q2VsbCA9PT0gY2VsbFByb3BlcnRpZXMkX183LmNoZWNrZWRUZW1wbGF0ZSkge1xuICAgICAgICAgICAgY2hhbmdlcy5wdXNoKFtyb3csIGNvbCwgY2VsbFByb3BlcnRpZXMkX183LnVuY2hlY2tlZFRlbXBsYXRlXSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChbY2VsbFByb3BlcnRpZXMkX183LnVuY2hlY2tlZFRlbXBsYXRlLCBudWxsLCB2b2lkIDBdLmluZGV4T2YoZGF0YUF0Q2VsbCkgIT09IC0xKSB7XG4gICAgICAgICAgICBjaGFuZ2VzLnB1c2goW3JvdywgY29sLCBjZWxsUHJvcGVydGllcyRfXzcuY2hlY2tlZFRlbXBsYXRlXSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNoYW5nZXMucHVzaChbcm93LCBjb2wsIGNlbGxQcm9wZXJ0aWVzJF9fNy51bmNoZWNrZWRUZW1wbGF0ZV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChjaGFuZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgIGluc3RhbmNlLnNldERhdGFBdENlbGwoY2hhbmdlcyk7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGVhY2hTZWxlY3RlZENoZWNrYm94Q2VsbChjYWxsYmFjaykge1xuICAgIHZhciBzZWxSYW5nZSA9IGluc3RhbmNlLmdldFNlbGVjdGVkUmFuZ2UoKTtcbiAgICBpZiAoIXNlbFJhbmdlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0b3BMZWZ0ID0gc2VsUmFuZ2UuZ2V0VG9wTGVmdENvcm5lcigpO1xuICAgIHZhciBib3R0b21SaWdodCA9IHNlbFJhbmdlLmdldEJvdHRvbVJpZ2h0Q29ybmVyKCk7XG4gICAgZm9yICh2YXIgcm93ID0gdG9wTGVmdC5yb3c7IHJvdyA8PSBib3R0b21SaWdodC5yb3c7IHJvdysrKSB7XG4gICAgICBmb3IgKHZhciBjb2wgPSB0b3BMZWZ0LmNvbDsgY29sIDw9IGJvdHRvbVJpZ2h0LmNvbDsgY29sKyspIHtcbiAgICAgICAgdmFyIGNlbGxQcm9wZXJ0aWVzJF9fOCA9IGluc3RhbmNlLmdldENlbGxNZXRhKHJvdywgY29sKTtcbiAgICAgICAgaWYgKGNlbGxQcm9wZXJ0aWVzJF9fOC50eXBlICE9PSAnY2hlY2tib3gnKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjZWxsID0gaW5zdGFuY2UuZ2V0Q2VsbChyb3csIGNvbCk7XG4gICAgICAgIGlmIChjZWxsID09IG51bGwpIHtcbiAgICAgICAgICBjYWxsYmFjayhyb3csIGNvbCwgY2VsbFByb3BlcnRpZXMkX184KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgY2hlY2tib3hlcyA9IGNlbGwucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbdHlwZT1jaGVja2JveF0nKTtcbiAgICAgICAgICBpZiAoY2hlY2tib3hlcy5sZW5ndGggPiAwICYmICFjZWxsUHJvcGVydGllcyRfXzgucmVhZE9ubHkpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKGNoZWNrYm94ZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuZnVuY3Rpb24gcmVnaXN0ZXJFdmVudHMoaW5zdGFuY2UpIHtcbiAgdmFyIGV2ZW50TWFuYWdlciA9IGlzQ2hlY2tib3hMaXN0ZW5lckFkZGVkLmdldChpbnN0YW5jZSk7XG4gIGlmICghZXZlbnRNYW5hZ2VyKSB7XG4gICAgZXZlbnRNYW5hZ2VyID0gbmV3IEV2ZW50TWFuYWdlcihpbnN0YW5jZSk7XG4gICAgZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoaW5zdGFuY2Uucm9vdEVsZW1lbnQsICdjbGljaycsIChmdW5jdGlvbihldmVudCkge1xuICAgICAgcmV0dXJuIG9uQ2xpY2soZXZlbnQsIGluc3RhbmNlKTtcbiAgICB9KSk7XG4gICAgZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoaW5zdGFuY2Uucm9vdEVsZW1lbnQsICdtb3VzZXVwJywgKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICByZXR1cm4gb25Nb3VzZVVwKGV2ZW50LCBpbnN0YW5jZSk7XG4gICAgfSkpO1xuICAgIGV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKGluc3RhbmNlLnJvb3RFbGVtZW50LCAnY2hhbmdlJywgKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICByZXR1cm4gb25DaGFuZ2UoZXZlbnQsIGluc3RhbmNlKTtcbiAgICB9KSk7XG4gICAgaXNDaGVja2JveExpc3RlbmVyQWRkZWQuc2V0KGluc3RhbmNlLCBldmVudE1hbmFnZXIpO1xuICB9XG4gIHJldHVybiBldmVudE1hbmFnZXI7XG59XG5mdW5jdGlvbiBjcmVhdGVJbnB1dCgpIHtcbiAgdmFyIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgaW5wdXQuY2xhc3NOYW1lID0gJ2h0Q2hlY2tib3hSZW5kZXJlcklucHV0JztcbiAgaW5wdXQudHlwZSA9ICdjaGVja2JveCc7XG4gIGlucHV0LnNldEF0dHJpYnV0ZSgnYXV0b2NvbXBsZXRlJywgJ29mZicpO1xuICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XG4gIHJldHVybiBpbnB1dC5jbG9uZU5vZGUoZmFsc2UpO1xufVxuZnVuY3Rpb24gY3JlYXRlTGFiZWwodGV4dCkge1xuICB2YXIgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpO1xuICBsYWJlbC5jbGFzc05hbWUgPSAnaHRDaGVja2JveFJlbmRlcmVyTGFiZWwnO1xuICBsYWJlbC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0ZXh0KSk7XG4gIHJldHVybiBsYWJlbC5jbG9uZU5vZGUodHJ1ZSk7XG59XG5mdW5jdGlvbiBvbk1vdXNlVXAoZXZlbnQsIGluc3RhbmNlKSB7XG4gIGlmICghaXNDaGVja2JveElucHV0KGV2ZW50LnRhcmdldCkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgc2V0VGltZW91dChpbnN0YW5jZS5saXN0ZW4sIDEwKTtcbn1cbmZ1bmN0aW9uIG9uQ2xpY2soZXZlbnQsIGluc3RhbmNlKSB7XG4gIGlmICghaXNDaGVja2JveElucHV0KGV2ZW50LnRhcmdldCkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgdmFyIHJvdyA9IHBhcnNlSW50KGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtcm93JyksIDEwKTtcbiAgdmFyIGNvbCA9IHBhcnNlSW50KGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtY29sJyksIDEwKTtcbiAgdmFyIGNlbGxQcm9wZXJ0aWVzID0gaW5zdGFuY2UuZ2V0Q2VsbE1ldGEocm93LCBjb2wpO1xuICBpZiAoY2VsbFByb3BlcnRpZXMucmVhZE9ubHkpIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICB9XG59XG5mdW5jdGlvbiBvbkNoYW5nZShldmVudCwgaW5zdGFuY2UpIHtcbiAgaWYgKCFpc0NoZWNrYm94SW5wdXQoZXZlbnQudGFyZ2V0KSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICB2YXIgcm93ID0gcGFyc2VJbnQoZXZlbnQudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1yb3cnKSwgMTApO1xuICB2YXIgY29sID0gcGFyc2VJbnQoZXZlbnQudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1jb2wnKSwgMTApO1xuICB2YXIgY2VsbFByb3BlcnRpZXMgPSBpbnN0YW5jZS5nZXRDZWxsTWV0YShyb3csIGNvbCk7XG4gIGlmICghY2VsbFByb3BlcnRpZXMucmVhZE9ubHkpIHtcbiAgICB2YXIgbmV3Q2hlY2tib3hWYWx1ZSA9IG51bGw7XG4gICAgaWYgKGV2ZW50LnRhcmdldC5jaGVja2VkKSB7XG4gICAgICBpZiAoY2VsbFByb3BlcnRpZXMuY2hlY2tlZFRlbXBsYXRlID09PSB2b2lkIDApIHtcbiAgICAgICAgbmV3Q2hlY2tib3hWYWx1ZSA9IHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXdDaGVja2JveFZhbHVlID0gY2VsbFByb3BlcnRpZXMuY2hlY2tlZFRlbXBsYXRlO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoY2VsbFByb3BlcnRpZXMudW5jaGVja2VkVGVtcGxhdGUgPT09IHZvaWQgMCkge1xuICAgICAgICBuZXdDaGVja2JveFZhbHVlID0gZmFsc2U7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXdDaGVja2JveFZhbHVlID0gY2VsbFByb3BlcnRpZXMudW5jaGVja2VkVGVtcGxhdGU7XG4gICAgICB9XG4gICAgfVxuICAgIGluc3RhbmNlLnNldERhdGFBdENlbGwocm93LCBjb2wsIG5ld0NoZWNrYm94VmFsdWUpO1xuICB9XG59XG5mdW5jdGlvbiBpc0NoZWNrYm94SW5wdXQoZWxlbWVudCkge1xuICByZXR1cm4gZWxlbWVudC50YWdOYW1lID09PSAnSU5QVVQnICYmIGVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0eXBlJykgPT09ICdjaGVja2JveCc7XG59XG47XG5yZWdpc3RlclJlbmRlcmVyKCdjaGVja2JveCcsIGNoZWNrYm94UmVuZGVyZXIpO1xuXG4vLyMgXG59LHtcImV2ZW50TWFuYWdlclwiOjQyLFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwiaGVscGVycy9kb20vZXZlbnRcIjo0OCxcImhlbHBlcnMvZnVuY3Rpb25cIjo1MCxcImhlbHBlcnMvc3RyaW5nXCI6NTUsXCJoZWxwZXJzL3VuaWNvZGVcIjo1NixcInJlbmRlcmVyc1wiOjExN31dLDEyMTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgaHRtbFJlbmRlcmVyOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBodG1sUmVuZGVyZXI7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyxcbiAgICAkX19fNDZfXzQ2X180N19yZW5kZXJlcnNfXztcbnZhciBmYXN0SW5uZXJIVE1MID0gKCRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9lbGVtZW50XCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X199KS5mYXN0SW5uZXJIVE1MO1xudmFyICRfXzEgPSAoJF9fXzQ2X180Nl9fNDdfcmVuZGVyZXJzX18gPSBfZGVyZXFfKFwicmVuZGVyZXJzXCIpLCAkX19fNDZfXzQ2X180N19yZW5kZXJlcnNfXyAmJiAkX19fNDZfXzQ2X180N19yZW5kZXJlcnNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X3JlbmRlcmVyc19fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19yZW5kZXJlcnNfX30pLFxuICAgIGdldFJlbmRlcmVyID0gJF9fMS5nZXRSZW5kZXJlcixcbiAgICByZWdpc3RlclJlbmRlcmVyID0gJF9fMS5yZWdpc3RlclJlbmRlcmVyO1xuZnVuY3Rpb24gaHRtbFJlbmRlcmVyKGluc3RhbmNlLCBURCwgcm93LCBjb2wsIHByb3AsIHZhbHVlLCBjZWxsUHJvcGVydGllcykge1xuICBnZXRSZW5kZXJlcignYmFzZScpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdm9pZCAwKSB7XG4gICAgdmFsdWUgPSAnJztcbiAgfVxuICBmYXN0SW5uZXJIVE1MKFRELCB2YWx1ZSk7XG59XG47XG5yZWdpc3RlclJlbmRlcmVyKCdodG1sJywgaHRtbFJlbmRlcmVyKTtcblxuLy8jIFxufSx7XCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJyZW5kZXJlcnNcIjoxMTd9XSwxMjI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIG51bWVyaWNSZW5kZXJlcjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbnVtZXJpY1JlbmRlcmVyO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19udW1icm9fXyxcbiAgICAkX19fNDZfXzQ2X180N19yZW5kZXJlcnNfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X251bWJlcl9fO1xudmFyIG51bWJybyA9ICgkX19udW1icm9fXyA9IF9kZXJlcV8oXCJudW1icm9cIiksICRfX251bWJyb19fICYmICRfX251bWJyb19fLl9fZXNNb2R1bGUgJiYgJF9fbnVtYnJvX18gfHwge2RlZmF1bHQ6ICRfX251bWJyb19ffSkuZGVmYXVsdDtcbnZhciAkX18xID0gKCRfX180Nl9fNDZfXzQ3X3JlbmRlcmVyc19fID0gX2RlcmVxXyhcInJlbmRlcmVyc1wiKSwgJF9fXzQ2X180Nl9fNDdfcmVuZGVyZXJzX18gJiYgJF9fXzQ2X180Nl9fNDdfcmVuZGVyZXJzX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19yZW5kZXJlcnNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfcmVuZGVyZXJzX199KSxcbiAgICBnZXRSZW5kZXJlciA9ICRfXzEuZ2V0UmVuZGVyZXIsXG4gICAgcmVnaXN0ZXJSZW5kZXJlciA9ICRfXzEucmVnaXN0ZXJSZW5kZXJlcjtcbnZhciBpc051bWVyaWMgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL251bWJlclwiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X251bWJlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfX30pLmlzTnVtZXJpYztcbmZ1bmN0aW9uIG51bWVyaWNSZW5kZXJlcihpbnN0YW5jZSwgVEQsIHJvdywgY29sLCBwcm9wLCB2YWx1ZSwgY2VsbFByb3BlcnRpZXMpIHtcbiAgaWYgKGlzTnVtZXJpYyh2YWx1ZSkpIHtcbiAgICBpZiAodHlwZW9mIGNlbGxQcm9wZXJ0aWVzLmxhbmd1YWdlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgbnVtYnJvLmN1bHR1cmUoY2VsbFByb3BlcnRpZXMubGFuZ3VhZ2UpO1xuICAgIH1cbiAgICB2YWx1ZSA9IG51bWJybyh2YWx1ZSkuZm9ybWF0KGNlbGxQcm9wZXJ0aWVzLmZvcm1hdCB8fCAnMCcpO1xuICAgIHZhciBjbGFzc05hbWUgPSBjZWxsUHJvcGVydGllcy5jbGFzc05hbWUgfHwgJyc7XG4gICAgdmFyIGNsYXNzQXJyID0gY2xhc3NOYW1lLmxlbmd0aCA/IGNsYXNzTmFtZS5zcGxpdCgnICcpIDogW107XG4gICAgaWYgKGNsYXNzQXJyLmluZGV4T2YoJ2h0TGVmdCcpIDwgMCAmJiBjbGFzc0Fyci5pbmRleE9mKCdodENlbnRlcicpIDwgMCAmJiBjbGFzc0Fyci5pbmRleE9mKCdodFJpZ2h0JykgPCAwICYmIGNsYXNzQXJyLmluZGV4T2YoJ2h0SnVzdGlmeScpIDwgMCkge1xuICAgICAgY2xhc3NBcnIucHVzaCgnaHRSaWdodCcpO1xuICAgIH1cbiAgICBpZiAoY2xhc3NBcnIuaW5kZXhPZignaHROdW1lcmljJykgPCAwKSB7XG4gICAgICBjbGFzc0Fyci5wdXNoKCdodE51bWVyaWMnKTtcbiAgICB9XG4gICAgY2VsbFByb3BlcnRpZXMuY2xhc3NOYW1lID0gY2xhc3NBcnIuam9pbignICcpO1xuICB9XG4gIGdldFJlbmRlcmVyKCd0ZXh0JykoaW5zdGFuY2UsIFRELCByb3csIGNvbCwgcHJvcCwgdmFsdWUsIGNlbGxQcm9wZXJ0aWVzKTtcbn1cbjtcbnJlZ2lzdGVyUmVuZGVyZXIoJ251bWVyaWMnLCBudW1lcmljUmVuZGVyZXIpO1xuXG4vLyMgXG59LHtcImhlbHBlcnMvbnVtYmVyXCI6NTIsXCJudW1icm9cIjpcIm51bWJyb1wiLFwicmVuZGVyZXJzXCI6MTE3fV0sMTIzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBwYXNzd29yZFJlbmRlcmVyOiB7Z2V0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBwYXNzd29yZFJlbmRlcmVyO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfcmVuZGVyZXJzX187XG52YXIgZmFzdElubmVySFRNTCA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSkuZmFzdElubmVySFRNTDtcbnZhciAkX18xID0gKCRfX180Nl9fNDZfXzQ3X3JlbmRlcmVyc19fID0gX2RlcmVxXyhcInJlbmRlcmVyc1wiKSwgJF9fXzQ2X180Nl9fNDdfcmVuZGVyZXJzX18gJiYgJF9fXzQ2X180Nl9fNDdfcmVuZGVyZXJzX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19yZW5kZXJlcnNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfcmVuZGVyZXJzX199KSxcbiAgICBnZXRSZW5kZXJlciA9ICRfXzEuZ2V0UmVuZGVyZXIsXG4gICAgcmVnaXN0ZXJSZW5kZXJlciA9ICRfXzEucmVnaXN0ZXJSZW5kZXJlcjtcbmZ1bmN0aW9uIHBhc3N3b3JkUmVuZGVyZXIoaW5zdGFuY2UsIFRELCByb3csIGNvbCwgcHJvcCwgdmFsdWUsIGNlbGxQcm9wZXJ0aWVzKSB7XG4gIGdldFJlbmRlcmVyKCd0ZXh0JykuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgdmFsdWUgPSBURC5pbm5lckhUTUw7XG4gIHZhciBoYXNoO1xuICB2YXIgaGFzaExlbmd0aCA9IGNlbGxQcm9wZXJ0aWVzLmhhc2hMZW5ndGggfHwgdmFsdWUubGVuZ3RoO1xuICB2YXIgaGFzaFN5bWJvbCA9IGNlbGxQcm9wZXJ0aWVzLmhhc2hTeW1ib2wgfHwgJyonO1xuICBmb3IgKGhhc2ggPSAnJzsgaGFzaC5zcGxpdChoYXNoU3ltYm9sKS5sZW5ndGggLSAxIDwgaGFzaExlbmd0aDsgaGFzaCArPSBoYXNoU3ltYm9sKSB7fVxuICBmYXN0SW5uZXJIVE1MKFRELCBoYXNoKTtcbn1cbjtcbnJlZ2lzdGVyUmVuZGVyZXIoJ3Bhc3N3b3JkJywgcGFzc3dvcmRSZW5kZXJlcik7XG5cbi8vIyBcbn0se1wiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwicmVuZGVyZXJzXCI6MTE3fV0sMTI0OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICB0ZXh0UmVuZGVyZXI6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRleHRSZW5kZXJlcjtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbWl4ZWRfXyxcbiAgICAkX19fNDZfXzQ2X180N19yZW5kZXJlcnNfXztcbnZhciAkX18wID0gKCRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9lbGVtZW50XCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X199KSxcbiAgICBlbXB0eSA9ICRfXzAuZW1wdHksXG4gICAgZmFzdElubmVyVGV4dCA9ICRfXzAuZmFzdElubmVyVGV4dDtcbnZhciBzdHJpbmdpZnkgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19taXhlZF9fID0gX2RlcmVxXyhcImhlbHBlcnMvbWl4ZWRcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbWl4ZWRfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbWl4ZWRfX30pLnN0cmluZ2lmeTtcbnZhciAkX18yID0gKCRfX180Nl9fNDZfXzQ3X3JlbmRlcmVyc19fID0gX2RlcmVxXyhcInJlbmRlcmVyc1wiKSwgJF9fXzQ2X180Nl9fNDdfcmVuZGVyZXJzX18gJiYgJF9fXzQ2X180Nl9fNDdfcmVuZGVyZXJzX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19yZW5kZXJlcnNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfcmVuZGVyZXJzX199KSxcbiAgICBnZXRSZW5kZXJlciA9ICRfXzIuZ2V0UmVuZGVyZXIsXG4gICAgcmVnaXN0ZXJSZW5kZXJlciA9ICRfXzIucmVnaXN0ZXJSZW5kZXJlcjtcbmZ1bmN0aW9uIHRleHRSZW5kZXJlcihpbnN0YW5jZSwgVEQsIHJvdywgY29sLCBwcm9wLCB2YWx1ZSwgY2VsbFByb3BlcnRpZXMpIHtcbiAgZ2V0UmVuZGVyZXIoJ2Jhc2UnKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICBpZiAoIXZhbHVlICYmIGNlbGxQcm9wZXJ0aWVzLnBsYWNlaG9sZGVyKSB7XG4gICAgdmFsdWUgPSBjZWxsUHJvcGVydGllcy5wbGFjZWhvbGRlcjtcbiAgfVxuICB2YXIgZXNjYXBlZCA9IHN0cmluZ2lmeSh2YWx1ZSk7XG4gIGlmICghaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS50cmltV2hpdGVzcGFjZSkge1xuICAgIGVzY2FwZWQgPSBlc2NhcGVkLnJlcGxhY2UoLyAvZywgU3RyaW5nLmZyb21DaGFyQ29kZSgxNjApKTtcbiAgfVxuICBpZiAoY2VsbFByb3BlcnRpZXMucmVuZGVyZXJUZW1wbGF0ZSkge1xuICAgIGVtcHR5KFREKTtcbiAgICB2YXIgVEVNUExBVEUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdURU1QTEFURScpO1xuICAgIFRFTVBMQVRFLnNldEF0dHJpYnV0ZSgnYmluZCcsICd7e319Jyk7XG4gICAgVEVNUExBVEUuaW5uZXJIVE1MID0gY2VsbFByb3BlcnRpZXMucmVuZGVyZXJUZW1wbGF0ZTtcbiAgICBIVE1MVGVtcGxhdGVFbGVtZW50LmRlY29yYXRlKFRFTVBMQVRFKTtcbiAgICBURU1QTEFURS5tb2RlbCA9IGluc3RhbmNlLmdldFNvdXJjZURhdGFBdFJvdyhyb3cpO1xuICAgIFRELmFwcGVuZENoaWxkKFRFTVBMQVRFKTtcbiAgfSBlbHNlIHtcbiAgICBmYXN0SW5uZXJUZXh0KFRELCBlc2NhcGVkKTtcbiAgfVxufVxuO1xucmVnaXN0ZXJSZW5kZXJlcigndGV4dCcsIHRleHRSZW5kZXJlcik7XG5cbi8vIyBcbn0se1wiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwiaGVscGVycy9taXhlZFwiOjUxLFwicmVuZGVyZXJzXCI6MTE3fV0sMTI1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbi8vIGpzY3M6ZGlzYWJsZVxuLyoganNoaW50IGlnbm9yZTpzdGFydCAqL1xuKGZ1bmN0aW9uKGdsb2JhbCkge1xuICAndXNlIHN0cmljdCc7XG4gIGlmIChnbG9iYWwuJHRyYWNldXJSdW50aW1lKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHZhciAkT2JqZWN0ID0gT2JqZWN0O1xuICB2YXIgJFR5cGVFcnJvciA9IFR5cGVFcnJvcjtcbiAgdmFyICRjcmVhdGUgPSAkT2JqZWN0LmNyZWF0ZTtcbiAgdmFyICRkZWZpbmVQcm9wZXJ0aWVzID0gJE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzO1xuICB2YXIgJGRlZmluZVByb3BlcnR5ID0gJE9iamVjdC5kZWZpbmVQcm9wZXJ0eTtcbiAgdmFyICRmcmVlemUgPSAkT2JqZWN0LmZyZWV6ZTtcbiAgdmFyICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSAkT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjtcbiAgdmFyICRnZXRPd25Qcm9wZXJ0eU5hbWVzID0gJE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzO1xuICB2YXIgJGtleXMgPSAkT2JqZWN0LmtleXM7XG4gIHZhciAkaXNFeHRlbnNpYmxlID0gT2JqZWN0LmlzRXh0ZW5zaWJsZTtcbiAgZnVuY3Rpb24gbm9uRW51bSh2YWx1ZSkge1xuICAgIHJldHVybiB7XG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlXG4gICAgfTtcbiAgfVxuICB2YXIgbWV0aG9kID0gbm9uRW51bTtcbiAgdmFyIGNvdW50ZXIgPSAwO1xuICBmdW5jdGlvbiBuZXdVbmlxdWVTdHJpbmcoKSB7XG4gICAgcmV0dXJuICdfXyQnICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMWU5KSArICckJyArICsrY291bnRlciArICckX18nO1xuICB9XG4gIHZhciBzeW1ib2xJbnRlcm5hbFByb3BlcnR5ID0gbmV3VW5pcXVlU3RyaW5nKCk7XG4gIHZhciBzeW1ib2xEZXNjcmlwdGlvblByb3BlcnR5ID0gbmV3VW5pcXVlU3RyaW5nKCk7XG4gIHZhciBzeW1ib2xEYXRhUHJvcGVydHkgPSBuZXdVbmlxdWVTdHJpbmcoKTtcbiAgdmFyIHN5bWJvbFZhbHVlcyA9ICRjcmVhdGUobnVsbCk7XG4gIHZhciBwcml2YXRlTmFtZXMgPSAkY3JlYXRlKG51bGwpO1xuICBmdW5jdGlvbiBpc1ByaXZhdGVOYW1lKHMpIHtcbiAgICByZXR1cm4gcHJpdmF0ZU5hbWVzW3NdO1xuICB9XG4gIGZ1bmN0aW9uIGNyZWF0ZVByaXZhdGVOYW1lKCkge1xuICAgIHZhciBzID0gbmV3VW5pcXVlU3RyaW5nKCk7XG4gICAgcHJpdmF0ZU5hbWVzW3NdID0gdHJ1ZTtcbiAgICByZXR1cm4gcztcbiAgfVxuICBmdW5jdGlvbiBpc1NoaW1TeW1ib2woc3ltYm9sKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBzeW1ib2wgPT09ICdvYmplY3QnICYmIHN5bWJvbCBpbnN0YW5jZW9mIFN5bWJvbFZhbHVlO1xuICB9XG4gIGZ1bmN0aW9uIHR5cGVPZih2KSB7XG4gICAgaWYgKGlzU2hpbVN5bWJvbCh2KSlcbiAgICAgIHJldHVybiAnc3ltYm9sJztcbiAgICByZXR1cm4gdHlwZW9mIHY7XG4gIH1cbiAgZnVuY3Rpb24gU3ltYm9sKGRlc2NyaXB0aW9uKSB7XG4gICAgdmFyIHZhbHVlID0gbmV3IFN5bWJvbFZhbHVlKGRlc2NyaXB0aW9uKTtcbiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgU3ltYm9sKSlcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdTeW1ib2wgY2Fubm90IGJlIG5ld1xcJ2VkJyk7XG4gIH1cbiAgJGRlZmluZVByb3BlcnR5KFN5bWJvbC5wcm90b3R5cGUsICdjb25zdHJ1Y3RvcicsIG5vbkVudW0oU3ltYm9sKSk7XG4gICRkZWZpbmVQcm9wZXJ0eShTeW1ib2wucHJvdG90eXBlLCAndG9TdHJpbmcnLCBtZXRob2QoZnVuY3Rpb24oKSB7XG4gICAgdmFyIHN5bWJvbFZhbHVlID0gdGhpc1tzeW1ib2xEYXRhUHJvcGVydHldO1xuICAgIGlmICghZ2V0T3B0aW9uKCdzeW1ib2xzJykpXG4gICAgICByZXR1cm4gc3ltYm9sVmFsdWVbc3ltYm9sSW50ZXJuYWxQcm9wZXJ0eV07XG4gICAgaWYgKCFzeW1ib2xWYWx1ZSlcbiAgICAgIHRocm93IFR5cGVFcnJvcignQ29udmVyc2lvbiBmcm9tIHN5bWJvbCB0byBzdHJpbmcnKTtcbiAgICB2YXIgZGVzYyA9IHN5bWJvbFZhbHVlW3N5bWJvbERlc2NyaXB0aW9uUHJvcGVydHldO1xuICAgIGlmIChkZXNjID09PSB1bmRlZmluZWQpXG4gICAgICBkZXNjID0gJyc7XG4gICAgcmV0dXJuICdTeW1ib2woJyArIGRlc2MgKyAnKSc7XG4gIH0pKTtcbiAgJGRlZmluZVByb3BlcnR5KFN5bWJvbC5wcm90b3R5cGUsICd2YWx1ZU9mJywgbWV0aG9kKGZ1bmN0aW9uKCkge1xuICAgIHZhciBzeW1ib2xWYWx1ZSA9IHRoaXNbc3ltYm9sRGF0YVByb3BlcnR5XTtcbiAgICBpZiAoIXN5bWJvbFZhbHVlKVxuICAgICAgdGhyb3cgVHlwZUVycm9yKCdDb252ZXJzaW9uIGZyb20gc3ltYm9sIHRvIHN0cmluZycpO1xuICAgIGlmICghZ2V0T3B0aW9uKCdzeW1ib2xzJykpXG4gICAgICByZXR1cm4gc3ltYm9sVmFsdWVbc3ltYm9sSW50ZXJuYWxQcm9wZXJ0eV07XG4gICAgcmV0dXJuIHN5bWJvbFZhbHVlO1xuICB9KSk7XG4gIGZ1bmN0aW9uIFN5bWJvbFZhbHVlKGRlc2NyaXB0aW9uKSB7XG4gICAgdmFyIGtleSA9IG5ld1VuaXF1ZVN0cmluZygpO1xuICAgICRkZWZpbmVQcm9wZXJ0eSh0aGlzLCBzeW1ib2xEYXRhUHJvcGVydHksIHt2YWx1ZTogdGhpc30pO1xuICAgICRkZWZpbmVQcm9wZXJ0eSh0aGlzLCBzeW1ib2xJbnRlcm5hbFByb3BlcnR5LCB7dmFsdWU6IGtleX0pO1xuICAgICRkZWZpbmVQcm9wZXJ0eSh0aGlzLCBzeW1ib2xEZXNjcmlwdGlvblByb3BlcnR5LCB7dmFsdWU6IGRlc2NyaXB0aW9ufSk7XG4gICAgZnJlZXplKHRoaXMpO1xuICAgIHN5bWJvbFZhbHVlc1trZXldID0gdGhpcztcbiAgfVxuICAkZGVmaW5lUHJvcGVydHkoU3ltYm9sVmFsdWUucHJvdG90eXBlLCAnY29uc3RydWN0b3InLCBub25FbnVtKFN5bWJvbCkpO1xuICAkZGVmaW5lUHJvcGVydHkoU3ltYm9sVmFsdWUucHJvdG90eXBlLCAndG9TdHJpbmcnLCB7XG4gICAgdmFsdWU6IFN5bWJvbC5wcm90b3R5cGUudG9TdHJpbmcsXG4gICAgZW51bWVyYWJsZTogZmFsc2VcbiAgfSk7XG4gICRkZWZpbmVQcm9wZXJ0eShTeW1ib2xWYWx1ZS5wcm90b3R5cGUsICd2YWx1ZU9mJywge1xuICAgIHZhbHVlOiBTeW1ib2wucHJvdG90eXBlLnZhbHVlT2YsXG4gICAgZW51bWVyYWJsZTogZmFsc2VcbiAgfSk7XG4gIHZhciBoYXNoUHJvcGVydHkgPSBjcmVhdGVQcml2YXRlTmFtZSgpO1xuICB2YXIgaGFzaFByb3BlcnR5RGVzY3JpcHRvciA9IHt2YWx1ZTogdW5kZWZpbmVkfTtcbiAgdmFyIGhhc2hPYmplY3RQcm9wZXJ0aWVzID0ge1xuICAgIGhhc2g6IHt2YWx1ZTogdW5kZWZpbmVkfSxcbiAgICBzZWxmOiB7dmFsdWU6IHVuZGVmaW5lZH1cbiAgfTtcbiAgdmFyIGhhc2hDb3VudGVyID0gMDtcbiAgZnVuY3Rpb24gZ2V0T3duSGFzaE9iamVjdChvYmplY3QpIHtcbiAgICB2YXIgaGFzaE9iamVjdCA9IG9iamVjdFtoYXNoUHJvcGVydHldO1xuICAgIGlmIChoYXNoT2JqZWN0ICYmIGhhc2hPYmplY3Quc2VsZiA9PT0gb2JqZWN0KVxuICAgICAgcmV0dXJuIGhhc2hPYmplY3Q7XG4gICAgaWYgKCRpc0V4dGVuc2libGUob2JqZWN0KSkge1xuICAgICAgaGFzaE9iamVjdFByb3BlcnRpZXMuaGFzaC52YWx1ZSA9IGhhc2hDb3VudGVyKys7XG4gICAgICBoYXNoT2JqZWN0UHJvcGVydGllcy5zZWxmLnZhbHVlID0gb2JqZWN0O1xuICAgICAgaGFzaFByb3BlcnR5RGVzY3JpcHRvci52YWx1ZSA9ICRjcmVhdGUobnVsbCwgaGFzaE9iamVjdFByb3BlcnRpZXMpO1xuICAgICAgJGRlZmluZVByb3BlcnR5KG9iamVjdCwgaGFzaFByb3BlcnR5LCBoYXNoUHJvcGVydHlEZXNjcmlwdG9yKTtcbiAgICAgIHJldHVybiBoYXNoUHJvcGVydHlEZXNjcmlwdG9yLnZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIGZ1bmN0aW9uIGZyZWV6ZShvYmplY3QpIHtcbiAgICBnZXRPd25IYXNoT2JqZWN0KG9iamVjdCk7XG4gICAgcmV0dXJuICRmcmVlemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuICBmcmVlemUoU3ltYm9sVmFsdWUucHJvdG90eXBlKTtcbiAgZnVuY3Rpb24gaXNTeW1ib2xTdHJpbmcocykge1xuICAgIHJldHVybiBzeW1ib2xWYWx1ZXNbc10gfHwgcHJpdmF0ZU5hbWVzW3NdO1xuICB9XG4gIGZ1bmN0aW9uIHRvUHJvcGVydHkobmFtZSkge1xuICAgIGlmIChpc1NoaW1TeW1ib2wobmFtZSkpXG4gICAgICByZXR1cm4gbmFtZVtzeW1ib2xJbnRlcm5hbFByb3BlcnR5XTtcbiAgICByZXR1cm4gbmFtZTtcbiAgfVxuICBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KSB7XG4gICAgdmFyIHJ2ID0gW107XG4gICAgdmFyIG5hbWVzID0gJGdldE93blByb3BlcnR5TmFtZXMob2JqZWN0KTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5hbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgc3ltYm9sID0gc3ltYm9sVmFsdWVzW25hbWVzW2ldXTtcbiAgICAgIGlmIChzeW1ib2wpIHtcbiAgICAgICAgcnYucHVzaChzeW1ib2wpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcnY7XG4gIH1cbiAgZnVuY3Rpb24gZ2V0T3B0aW9uKG5hbWUpIHtcbiAgICByZXR1cm4gZ2xvYmFsLnRyYWNldXIgJiYgZ2xvYmFsLnRyYWNldXIub3B0aW9uc1tuYW1lXTtcbiAgfVxuICBmdW5jdGlvbiBleHBvcnRTdGFyKG9iamVjdCkge1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgbmFtZXMgPSAkZ2V0T3duUHJvcGVydHlOYW1lcyhhcmd1bWVudHNbaV0pO1xuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBuYW1lcy5sZW5ndGg7IGorKykge1xuICAgICAgICB2YXIgbmFtZSA9IG5hbWVzW2pdO1xuICAgICAgICBpZiAoaXNTeW1ib2xTdHJpbmcobmFtZSkpXG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIChmdW5jdGlvbihtb2QsIG5hbWUpIHtcbiAgICAgICAgICAkZGVmaW5lUHJvcGVydHkob2JqZWN0LCBuYW1lLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICByZXR1cm4gbW9kW25hbWVdO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSkoYXJndW1lbnRzW2ldLCBuYW1lc1tqXSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmplY3Q7XG4gIH1cbiAgZnVuY3Rpb24gaXNPYmplY3QoeCkge1xuICAgIHJldHVybiB4ICE9IG51bGwgJiYgKHR5cGVvZiB4ID09PSAnb2JqZWN0JyB8fCB0eXBlb2YgeCA9PT0gJ2Z1bmN0aW9uJyk7XG4gIH1cbiAgZnVuY3Rpb24gdG9PYmplY3QoeCkge1xuICAgIGlmICh4ID09IG51bGwpXG4gICAgICB0aHJvdyAkVHlwZUVycm9yKCk7XG4gICAgcmV0dXJuICRPYmplY3QoeCk7XG4gIH1cbiAgZnVuY3Rpb24gY2hlY2tPYmplY3RDb2VyY2libGUoYXJndW1lbnQpIHtcbiAgICBpZiAoYXJndW1lbnQgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVmFsdWUgY2Fubm90IGJlIGNvbnZlcnRlZCB0byBhbiBPYmplY3QnKTtcbiAgICB9XG4gICAgcmV0dXJuIGFyZ3VtZW50O1xuICB9XG4gIGZ1bmN0aW9uIHBvbHlmaWxsU3ltYm9sKGdsb2JhbCwgU3ltYm9sKSB7XG4gICAgaWYgKCFnbG9iYWwuU3ltYm9sKSB7XG4gICAgICBnbG9iYWwuU3ltYm9sID0gU3ltYm9sO1xuICAgICAgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9IGdldE93blByb3BlcnR5U3ltYm9scztcbiAgICB9XG4gICAgaWYgKCFnbG9iYWwuU3ltYm9sLml0ZXJhdG9yKSB7XG4gICAgICBnbG9iYWwuU3ltYm9sLml0ZXJhdG9yID0gU3ltYm9sKCdTeW1ib2wuaXRlcmF0b3InKTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gc2V0dXBHbG9iYWxzKGdsb2JhbCkge1xuICAgIHBvbHlmaWxsU3ltYm9sKGdsb2JhbCwgU3ltYm9sKTtcbiAgICBnbG9iYWwuUmVmbGVjdCA9IGdsb2JhbC5SZWZsZWN0IHx8IHt9O1xuICAgIGdsb2JhbC5SZWZsZWN0Lmdsb2JhbCA9IGdsb2JhbC5SZWZsZWN0Lmdsb2JhbCB8fCBnbG9iYWw7XG4gIH1cbiAgc2V0dXBHbG9iYWxzKGdsb2JhbCk7XG4gIGdsb2JhbC4kdHJhY2V1clJ1bnRpbWUgPSB7XG4gICAgY2hlY2tPYmplY3RDb2VyY2libGU6IGNoZWNrT2JqZWN0Q29lcmNpYmxlLFxuICAgIGNyZWF0ZVByaXZhdGVOYW1lOiBjcmVhdGVQcml2YXRlTmFtZSxcbiAgICBkZWZpbmVQcm9wZXJ0aWVzOiAkZGVmaW5lUHJvcGVydGllcyxcbiAgICBkZWZpbmVQcm9wZXJ0eTogJGRlZmluZVByb3BlcnR5LFxuICAgIGV4cG9ydFN0YXI6IGV4cG9ydFN0YXIsXG4gICAgZ2V0T3duSGFzaE9iamVjdDogZ2V0T3duSGFzaE9iamVjdCxcbiAgICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6ICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsXG4gICAgZ2V0T3duUHJvcGVydHlOYW1lczogJGdldE93blByb3BlcnR5TmFtZXMsXG4gICAgaXNPYmplY3Q6IGlzT2JqZWN0LFxuICAgIGlzUHJpdmF0ZU5hbWU6IGlzUHJpdmF0ZU5hbWUsXG4gICAgaXNTeW1ib2xTdHJpbmc6IGlzU3ltYm9sU3RyaW5nLFxuICAgIGtleXM6ICRrZXlzLFxuICAgIHNldHVwR2xvYmFsczogc2V0dXBHbG9iYWxzLFxuICAgIHRvT2JqZWN0OiB0b09iamVjdCxcbiAgICB0b1Byb3BlcnR5OiB0b1Byb3BlcnR5LFxuICAgIHR5cGVvZjogdHlwZU9mXG4gIH07XG59KSh3aW5kb3cpO1xuKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG4gIHZhciAkdG9Qcm9wZXJ0eSA9ICR0cmFjZXVyUnVudGltZS50b1Byb3BlcnR5O1xuXG4gIGZ1bmN0aW9uIHNwcmVhZCgpIHtcbiAgICB2YXIgcnYgPSBbXSxcbiAgICAgIGogPSAwLFxuICAgICAgaXRlclJlc3VsdDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHZhbHVlVG9TcHJlYWQgPSAkdHJhY2V1clJ1bnRpbWUuY2hlY2tPYmplY3RDb2VyY2libGUoYXJndW1lbnRzW2ldKTtcblxuICAgICAgaWYgKHR5cGVvZiB2YWx1ZVRvU3ByZWFkWyR0b1Byb3BlcnR5KFN5bWJvbC5pdGVyYXRvcildICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHZhbHVlVG9TcHJlYWRbJHRvUHJvcGVydHkoU3ltYm9sLml0ZXJhdG9yKV0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzO1xuICAgICAgICAgIHZhciBsZW5ndGggPSB2YWx1ZS5sZW5ndGg7XG4gICAgICAgICAgdmFyIGluZGV4ID0gMDtcblxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuZXh0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHtkb25lOiB0cnVlfTtcblxuICAgICAgICAgICAgICBpZiAoaW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQuZG9uZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJlc3VsdC52YWx1ZSA9IHZhbHVlW2luZGV4XTtcbiAgICAgICAgICAgICAgICArK2luZGV4O1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICB2YXIgaXRlciA9IHZhbHVlVG9TcHJlYWRbJHRvUHJvcGVydHkoU3ltYm9sLml0ZXJhdG9yKV0oKTtcblxuICAgICAgd2hpbGUgKCEoaXRlclJlc3VsdCA9IGl0ZXIubmV4dCgpKS5kb25lKSB7XG4gICAgICAgIHJ2W2orK10gPSBpdGVyUmVzdWx0LnZhbHVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcnY7XG4gIH1cbiAgJHRyYWNldXJSdW50aW1lLnNwcmVhZCA9IHNwcmVhZDtcbn0pKCk7XG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgdmFyICRPYmplY3QgPSBPYmplY3Q7XG4gIHZhciAkVHlwZUVycm9yID0gVHlwZUVycm9yO1xuICB2YXIgJGNyZWF0ZSA9ICRPYmplY3QuY3JlYXRlO1xuICB2YXIgJGRlZmluZVByb3BlcnRpZXMgPSAkdHJhY2V1clJ1bnRpbWUuZGVmaW5lUHJvcGVydGllcztcbiAgdmFyICRkZWZpbmVQcm9wZXJ0eSA9ICR0cmFjZXVyUnVudGltZS5kZWZpbmVQcm9wZXJ0eTtcbiAgdmFyICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSAkdHJhY2V1clJ1bnRpbWUuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO1xuICB2YXIgJGdldFByb3RvdHlwZU9mID0gT2JqZWN0LmdldFByb3RvdHlwZU9mO1xuICB2YXIgJHRvUHJvcGVydHkgPSAkdHJhY2V1clJ1bnRpbWUudG9Qcm9wZXJ0eTtcbiAgdmFyICRfXzAgPSBPYmplY3QsXG4gICAgZ2V0T3duUHJvcGVydHlOYW1lcyA9ICRfXzAuZ2V0T3duUHJvcGVydHlOYW1lcyxcbiAgICBnZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPSAkX18wLmdldE93blByb3BlcnR5U3ltYm9scztcbiAgZnVuY3Rpb24gc3VwZXJEZXNjcmlwdG9yKGhvbWVPYmplY3QsIG5hbWUpIHtcbiAgICB2YXIgcHJvdG8gPSAkZ2V0UHJvdG90eXBlT2YoaG9tZU9iamVjdCk7XG4gICAgZG8ge1xuICAgICAgdmFyIHJlc3VsdCA9ICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocHJvdG8sIG5hbWUpO1xuICAgICAgaWYgKHJlc3VsdClcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIHByb3RvID0gJGdldFByb3RvdHlwZU9mKHByb3RvKTtcbiAgICB9IHdoaWxlIChwcm90byk7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICBmdW5jdGlvbiBzdXBlckNvbnN0cnVjdG9yKGN0b3IpIHtcbiAgICByZXR1cm4gY3Rvci5fX3Byb3RvX187XG4gIH1cbiAgZnVuY3Rpb24gc3VwZXJDYWxsKHNlbGYsIGhvbWVPYmplY3QsIG5hbWUsIGFyZ3MpIHtcbiAgICByZXR1cm4gc3VwZXJHZXQoc2VsZiwgaG9tZU9iamVjdCwgbmFtZSkuYXBwbHkoc2VsZiwgYXJncyk7XG4gIH1cbiAgZnVuY3Rpb24gc3VwZXJHZXQoc2VsZiwgaG9tZU9iamVjdCwgbmFtZSkge1xuICAgIHZhciBkZXNjcmlwdG9yID0gc3VwZXJEZXNjcmlwdG9yKGhvbWVPYmplY3QsIG5hbWUpO1xuICAgIGlmIChkZXNjcmlwdG9yKSB7XG4gICAgICBpZiAoIWRlc2NyaXB0b3IuZ2V0KVxuICAgICAgICByZXR1cm4gZGVzY3JpcHRvci52YWx1ZTtcbiAgICAgIHJldHVybiBkZXNjcmlwdG9yLmdldC5jYWxsKHNlbGYpO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIGZ1bmN0aW9uIHN1cGVyU2V0KHNlbGYsIGhvbWVPYmplY3QsIG5hbWUsIHZhbHVlKSB7XG4gICAgdmFyIGRlc2NyaXB0b3IgPSBzdXBlckRlc2NyaXB0b3IoaG9tZU9iamVjdCwgbmFtZSk7XG4gICAgaWYgKGRlc2NyaXB0b3IgJiYgZGVzY3JpcHRvci5zZXQpIHtcbiAgICAgIGRlc2NyaXB0b3Iuc2V0LmNhbGwoc2VsZiwgdmFsdWUpO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICB0aHJvdyAkVHlwZUVycm9yKChcInN1cGVyIGhhcyBubyBzZXR0ZXIgJ1wiICsgbmFtZSArIFwiJy5cIikpO1xuICB9XG4gIGZ1bmN0aW9uIGdldERlc2NyaXB0b3JzKG9iamVjdCkge1xuICAgIHZhciBkZXNjcmlwdG9ycyA9IHt9O1xuICAgIHZhciBuYW1lcyA9IGdldE93blByb3BlcnR5TmFtZXMob2JqZWN0KTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5hbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgbmFtZSA9IG5hbWVzW2ldO1xuICAgICAgZGVzY3JpcHRvcnNbbmFtZV0gPSAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgbmFtZSk7XG4gICAgfVxuICAgIHZhciBzeW1ib2xzID0gZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzeW1ib2xzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgc3ltYm9sID0gc3ltYm9sc1tpXTtcbiAgICAgIGRlc2NyaXB0b3JzWyR0b1Byb3BlcnR5KHN5bWJvbCldID0gJGdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsICR0b1Byb3BlcnR5KHN5bWJvbCkpO1xuICAgIH1cbiAgICByZXR1cm4gZGVzY3JpcHRvcnM7XG4gIH1cbiAgZnVuY3Rpb24gY3JlYXRlQ2xhc3MoY3Rvciwgb2JqZWN0LCBzdGF0aWNPYmplY3QsIHN1cGVyQ2xhc3MpIHtcbiAgICAkZGVmaW5lUHJvcGVydHkob2JqZWN0LCAnY29uc3RydWN0b3InLCB7XG4gICAgICB2YWx1ZTogY3RvcixcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgd3JpdGFibGU6IHRydWVcbiAgICB9KTtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDMpIHtcbiAgICAgIGlmICh0eXBlb2Ygc3VwZXJDbGFzcyA9PT0gJ2Z1bmN0aW9uJylcbiAgICAgICAgY3Rvci5fX3Byb3RvX18gPSBzdXBlckNsYXNzO1xuICAgICAgY3Rvci5wcm90b3R5cGUgPSAkY3JlYXRlKGdldFByb3RvUGFyZW50KHN1cGVyQ2xhc3MpLCBnZXREZXNjcmlwdG9ycyhvYmplY3QpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY3Rvci5wcm90b3R5cGUgPSBvYmplY3Q7XG4gICAgfVxuICAgICRkZWZpbmVQcm9wZXJ0eShjdG9yLCAncHJvdG90eXBlJywge1xuICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSxcbiAgICAgIHdyaXRhYmxlOiBmYWxzZVxuICAgIH0pO1xuICAgIHJldHVybiAkZGVmaW5lUHJvcGVydGllcyhjdG9yLCBnZXREZXNjcmlwdG9ycyhzdGF0aWNPYmplY3QpKTtcbiAgfVxuICBmdW5jdGlvbiBnZXRQcm90b1BhcmVudChzdXBlckNsYXNzKSB7XG4gICAgaWYgKHR5cGVvZiBzdXBlckNsYXNzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICB2YXIgcHJvdG90eXBlID0gc3VwZXJDbGFzcy5wcm90b3R5cGU7XG4gICAgICBpZiAoJE9iamVjdChwcm90b3R5cGUpID09PSBwcm90b3R5cGUgfHwgcHJvdG90eXBlID09PSBudWxsKVxuICAgICAgICByZXR1cm4gc3VwZXJDbGFzcy5wcm90b3R5cGU7XG4gICAgICB0aHJvdyBuZXcgJFR5cGVFcnJvcignc3VwZXIgcHJvdG90eXBlIG11c3QgYmUgYW4gT2JqZWN0IG9yIG51bGwnKTtcbiAgICB9XG4gICAgaWYgKHN1cGVyQ2xhc3MgPT09IG51bGwpXG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB0aHJvdyBuZXcgJFR5cGVFcnJvcigoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MgKyBcIi5cIikpO1xuICB9XG4gIGZ1bmN0aW9uIGRlZmF1bHRTdXBlckNhbGwoc2VsZiwgaG9tZU9iamVjdCwgYXJncykge1xuICAgIGlmICgkZ2V0UHJvdG90eXBlT2YoaG9tZU9iamVjdCkgIT09IG51bGwpXG4gICAgICBzdXBlckNhbGwoc2VsZiwgaG9tZU9iamVjdCwgJ2NvbnN0cnVjdG9yJywgYXJncyk7XG4gIH1cbiAgJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzID0gY3JlYXRlQ2xhc3M7XG4gICR0cmFjZXVyUnVudGltZS5kZWZhdWx0U3VwZXJDYWxsID0gZGVmYXVsdFN1cGVyQ2FsbDtcbiAgJHRyYWNldXJSdW50aW1lLnN1cGVyQ2FsbCA9IHN1cGVyQ2FsbDtcbiAgJHRyYWNldXJSdW50aW1lLnN1cGVyQ29uc3RydWN0b3IgPSBzdXBlckNvbnN0cnVjdG9yO1xuICAkdHJhY2V1clJ1bnRpbWUuc3VwZXJHZXQgPSBzdXBlckdldDtcbiAgJHRyYWNldXJSdW50aW1lLnN1cGVyU2V0ID0gc3VwZXJTZXQ7XG59KSgpO1xuLyoganNoaW50IGlnbm9yZTplbmQgKi9cblxufSx7fV0sMTI2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZXhwb3J0cywge1xuICBUYWJsZVZpZXc6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFRhYmxlVmlldztcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fYnJvd3Nlcl9fLFxuICAgICRfX2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyxcbiAgICAkX19oZWxwZXJzXzQ3X29iamVjdF9fLFxuICAgICRfX2V2ZW50TWFuYWdlcl9fLFxuICAgICRfX2hlbHBlcnNfNDdfZG9tXzQ3X2V2ZW50X18sXG4gICAgJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX18sXG4gICAgJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X3NlbGVjdGlvbl9fLFxuICAgICRfXzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jb3JlX187XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19icm93c2VyX18gJiYgJF9fYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19icm93c2VyX199KS5kZWZhdWx0O1xudmFyICRfXzEgPSAoJF9faGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLFxuICAgIGFkZENsYXNzID0gJF9fMS5hZGRDbGFzcyxcbiAgICBlbXB0eSA9ICRfXzEuZW1wdHksXG4gICAgZmFzdElubmVySFRNTCA9ICRfXzEuZmFzdElubmVySFRNTCxcbiAgICBmYXN0SW5uZXJUZXh0ID0gJF9fMS5mYXN0SW5uZXJUZXh0LFxuICAgIGdldFNjcm9sbGJhcldpZHRoID0gJF9fMS5nZXRTY3JvbGxiYXJXaWR0aCxcbiAgICBoYXNDbGFzcyA9ICRfXzEuaGFzQ2xhc3MsXG4gICAgaXNDaGlsZE9mID0gJF9fMS5pc0NoaWxkT2YsXG4gICAgaXNJbnB1dCA9ICRfXzEuaXNJbnB1dCxcbiAgICBpc091dHNpZGVJbnB1dCA9ICRfXzEuaXNPdXRzaWRlSW5wdXQsXG4gICAgcmVtb3ZlQ2xhc3MgPSAkX18xLnJlbW92ZUNsYXNzO1xudmFyIGNyZWF0ZU9iamVjdFByb3BMaXN0ZW5lciA9ICgkX19oZWxwZXJzXzQ3X29iamVjdF9fID0gX2RlcmVxXyhcImhlbHBlcnMvb2JqZWN0XCIpLCAkX19oZWxwZXJzXzQ3X29iamVjdF9fICYmICRfX2hlbHBlcnNfNDdfb2JqZWN0X18uX19lc01vZHVsZSAmJiAkX19oZWxwZXJzXzQ3X29iamVjdF9fIHx8IHtkZWZhdWx0OiAkX19oZWxwZXJzXzQ3X29iamVjdF9ffSkuY3JlYXRlT2JqZWN0UHJvcExpc3RlbmVyO1xudmFyIGV2ZW50TWFuYWdlck9iamVjdCA9ICgkX19ldmVudE1hbmFnZXJfXyA9IF9kZXJlcV8oXCJldmVudE1hbmFnZXJcIiksICRfX2V2ZW50TWFuYWdlcl9fICYmICRfX2V2ZW50TWFuYWdlcl9fLl9fZXNNb2R1bGUgJiYgJF9fZXZlbnRNYW5hZ2VyX18gfHwge2RlZmF1bHQ6ICRfX2V2ZW50TWFuYWdlcl9ffSkuZXZlbnRNYW5hZ2VyO1xudmFyICRfXzQgPSAoJF9faGVscGVyc180N19kb21fNDdfZXZlbnRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL2RvbS9ldmVudFwiKSwgJF9faGVscGVyc180N19kb21fNDdfZXZlbnRfXyAmJiAkX19oZWxwZXJzXzQ3X2RvbV80N19ldmVudF9fLl9fZXNNb2R1bGUgJiYgJF9faGVscGVyc180N19kb21fNDdfZXZlbnRfXyB8fCB7ZGVmYXVsdDogJF9faGVscGVyc180N19kb21fNDdfZXZlbnRfX30pLFxuICAgIHN0b3BQcm9wYWdhdGlvbiA9ICRfXzQuc3RvcFByb3BhZ2F0aW9uLFxuICAgIGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkID0gJF9fNC5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCxcbiAgICBpc1JpZ2h0Q2xpY2sgPSAkX180LmlzUmlnaHRDbGljayxcbiAgICBpc0xlZnRDbGljayA9ICRfXzQuaXNMZWZ0Q2xpY2s7XG52YXIgV2Fsa29udGFibGVDZWxsQ29vcmRzID0gKCRfXzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jZWxsXzQ3X2Nvb3Jkc19fID0gX2RlcmVxXyhcIjNyZHBhcnR5L3dhbGtvbnRhYmxlL3NyYy9jZWxsL2Nvb3Jkc1wiKSwgJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX18gJiYgJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX18uX19lc01vZHVsZSAmJiAkX18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfY2VsbF80N19jb29yZHNfXyB8fCB7ZGVmYXVsdDogJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NlbGxfNDdfY29vcmRzX199KS5XYWxrb250YWJsZUNlbGxDb29yZHM7XG52YXIgV2Fsa29udGFibGVTZWxlY3Rpb24gPSAoJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X3NlbGVjdGlvbl9fID0gX2RlcmVxXyhcIjNyZHBhcnR5L3dhbGtvbnRhYmxlL3NyYy9zZWxlY3Rpb25cIiksICRfXzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19zZWxlY3Rpb25fXyAmJiAkX18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfc2VsZWN0aW9uX18uX19lc01vZHVsZSAmJiAkX18zcmRwYXJ0eV80N193YWxrb250YWJsZV80N19zcmNfNDdfc2VsZWN0aW9uX18gfHwge2RlZmF1bHQ6ICRfXzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19zZWxlY3Rpb25fX30pLldhbGtvbnRhYmxlU2VsZWN0aW9uO1xudmFyIFdhbGtvbnRhYmxlID0gKCRfXzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jb3JlX18gPSBfZGVyZXFfKFwiM3JkcGFydHkvd2Fsa29udGFibGUvc3JjL2NvcmVcIiksICRfXzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jb3JlX18gJiYgJF9fM3JkcGFydHlfNDdfd2Fsa29udGFibGVfNDdfc3JjXzQ3X2NvcmVfXy5fX2VzTW9kdWxlICYmICRfXzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jb3JlX18gfHwge2RlZmF1bHQ6ICRfXzNyZHBhcnR5XzQ3X3dhbGtvbnRhYmxlXzQ3X3NyY180N19jb3JlX199KS5XYWxrb250YWJsZTtcbkhhbmRzb250YWJsZS5UYWJsZVZpZXcgPSBUYWJsZVZpZXc7XG5mdW5jdGlvbiBUYWJsZVZpZXcoaW5zdGFuY2UpIHtcbiAgdmFyICRfXzggPSB0aGlzO1xuICB2YXIgdGhhdCA9IHRoaXM7XG4gIHRoaXMuZXZlbnRNYW5hZ2VyID0gZXZlbnRNYW5hZ2VyT2JqZWN0KGluc3RhbmNlKTtcbiAgdGhpcy5pbnN0YW5jZSA9IGluc3RhbmNlO1xuICB0aGlzLnNldHRpbmdzID0gaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKTtcbiAgdGhpcy5zZWxlY3Rpb25Nb3VzZURvd24gPSBmYWxzZTtcbiAgdmFyIG9yaWdpbmFsU3R5bGUgPSBpbnN0YW5jZS5yb290RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3N0eWxlJyk7XG4gIGlmIChvcmlnaW5hbFN0eWxlKSB7XG4gICAgaW5zdGFuY2Uucm9vdEVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLW9yaWdpbmFsc3R5bGUnLCBvcmlnaW5hbFN0eWxlKTtcbiAgfVxuICBhZGRDbGFzcyhpbnN0YW5jZS5yb290RWxlbWVudCwgJ2hhbmRzb250YWJsZScpO1xuICB2YXIgdGFibGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdUQUJMRScpO1xuICBhZGRDbGFzcyh0YWJsZSwgJ2h0Q29yZScpO1xuICBpZiAoaW5zdGFuY2UuZ2V0U2V0dGluZ3MoKS50YWJsZUNsYXNzTmFtZSkge1xuICAgIGFkZENsYXNzKHRhYmxlLCBpbnN0YW5jZS5nZXRTZXR0aW5ncygpLnRhYmxlQ2xhc3NOYW1lKTtcbiAgfVxuICB0aGlzLlRIRUFEID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnVEhFQUQnKTtcbiAgdGFibGUuYXBwZW5kQ2hpbGQodGhpcy5USEVBRCk7XG4gIHRoaXMuVEJPRFkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdUQk9EWScpO1xuICB0YWJsZS5hcHBlbmRDaGlsZCh0aGlzLlRCT0RZKTtcbiAgaW5zdGFuY2UudGFibGUgPSB0YWJsZTtcbiAgaW5zdGFuY2UuY29udGFpbmVyLmluc2VydEJlZm9yZSh0YWJsZSwgaW5zdGFuY2UuY29udGFpbmVyLmZpcnN0Q2hpbGQpO1xuICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKGluc3RhbmNlLnJvb3RFbGVtZW50LCAnbW91c2Vkb3duJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICB0aGlzLnNlbGVjdGlvbk1vdXNlRG93biA9IHRydWU7XG4gICAgaWYgKCF0aGF0LmlzVGV4dFNlbGVjdGlvbkFsbG93ZWQoZXZlbnQudGFyZ2V0KSkge1xuICAgICAgY2xlYXJUZXh0U2VsZWN0aW9uKCk7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgd2luZG93LmZvY3VzKCk7XG4gICAgfVxuICB9KTtcbiAgdGhpcy5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihpbnN0YW5jZS5yb290RWxlbWVudCwgJ21vdXNldXAnLCBmdW5jdGlvbihldmVudCkge1xuICAgIHRoaXMuc2VsZWN0aW9uTW91c2VEb3duID0gZmFsc2U7XG4gIH0pO1xuICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKGluc3RhbmNlLnJvb3RFbGVtZW50LCAnbW91c2Vtb3ZlJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAodGhpcy5zZWxlY3Rpb25Nb3VzZURvd24gJiYgIXRoYXQuaXNUZXh0U2VsZWN0aW9uQWxsb3dlZChldmVudC50YXJnZXQpKSB7XG4gICAgICBjbGVhclRleHRTZWxlY3Rpb24oKTtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICB9KTtcbiAgdGhpcy5ldmVudE1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsICdrZXl1cCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKGluc3RhbmNlLnNlbGVjdGlvbi5pc0luUHJvZ3Jlc3MoKSAmJiAhZXZlbnQuc2hpZnRLZXkpIHtcbiAgICAgIGluc3RhbmNlLnNlbGVjdGlvbi5maW5pc2goKTtcbiAgICB9XG4gIH0pO1xuICB2YXIgaXNNb3VzZURvd247XG4gIHRoaXMuaXNNb3VzZURvd24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gaXNNb3VzZURvd247XG4gIH07XG4gIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCAnbW91c2V1cCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKGluc3RhbmNlLnNlbGVjdGlvbi5pc0luUHJvZ3Jlc3MoKSAmJiBldmVudC53aGljaCA9PT0gMSkge1xuICAgICAgaW5zdGFuY2Uuc2VsZWN0aW9uLmZpbmlzaCgpO1xuICAgIH1cbiAgICBpc01vdXNlRG93biA9IGZhbHNlO1xuICAgIGlmIChpc091dHNpZGVJbnB1dChkb2N1bWVudC5hY3RpdmVFbGVtZW50KSkge1xuICAgICAgaW5zdGFuY2UudW5saXN0ZW4oKTtcbiAgICB9XG4gIH0pO1xuICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgJ21vdXNlZG93bicsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIG9yaWdpbmFsVGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICAgIHZhciBuZXh0ID0gZXZlbnQudGFyZ2V0O1xuICAgIHZhciBldmVudFggPSBldmVudC54IHx8IGV2ZW50LmNsaWVudFg7XG4gICAgdmFyIGV2ZW50WSA9IGV2ZW50LnkgfHwgZXZlbnQuY2xpZW50WTtcbiAgICBpZiAoaXNNb3VzZURvd24gfHwgIWluc3RhbmNlLnJvb3RFbGVtZW50KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChuZXh0ID09PSBpbnN0YW5jZS52aWV3Lnd0Lnd0VGFibGUuaG9sZGVyKSB7XG4gICAgICB2YXIgc2Nyb2xsYmFyV2lkdGggPSBnZXRTY3JvbGxiYXJXaWR0aCgpO1xuICAgICAgaWYgKGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoZXZlbnRYICsgc2Nyb2xsYmFyV2lkdGgsIGV2ZW50WSkgIT09IGluc3RhbmNlLnZpZXcud3Qud3RUYWJsZS5ob2xkZXIgfHwgZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludChldmVudFgsIGV2ZW50WSArIHNjcm9sbGJhcldpZHRoKSAhPT0gaW5zdGFuY2Uudmlldy53dC53dFRhYmxlLmhvbGRlcikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHdoaWxlIChuZXh0ICE9PSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpIHtcbiAgICAgICAgaWYgKG5leHQgPT09IG51bGwpIHtcbiAgICAgICAgICBpZiAoZXZlbnQuaXNUYXJnZXRXZWJDb21wb25lbnQpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5leHQgPT09IGluc3RhbmNlLnJvb3RFbGVtZW50KSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIG5leHQgPSBuZXh0LnBhcmVudE5vZGU7XG4gICAgICB9XG4gICAgfVxuICAgIHZhciBvdXRzaWRlQ2xpY2tEZXNlbGVjdHMgPSB0eXBlb2YgdGhhdC5zZXR0aW5ncy5vdXRzaWRlQ2xpY2tEZXNlbGVjdHMgPT09ICdmdW5jdGlvbicgPyB0aGF0LnNldHRpbmdzLm91dHNpZGVDbGlja0Rlc2VsZWN0cyhvcmlnaW5hbFRhcmdldCkgOiB0aGF0LnNldHRpbmdzLm91dHNpZGVDbGlja0Rlc2VsZWN0cztcbiAgICBpZiAob3V0c2lkZUNsaWNrRGVzZWxlY3RzKSB7XG4gICAgICBpbnN0YW5jZS5kZXNlbGVjdENlbGwoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaW5zdGFuY2UuZGVzdHJveUVkaXRvcigpO1xuICAgIH1cbiAgfSk7XG4gIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGFibGUsICdzZWxlY3RzdGFydCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKHRoYXQuc2V0dGluZ3MuZnJhZ21lbnRTZWxlY3Rpb24gfHwgaXNJbnB1dChldmVudC50YXJnZXQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIH0pO1xuICB2YXIgY2xlYXJUZXh0U2VsZWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHdpbmRvdy5nZXRTZWxlY3Rpb24pIHtcbiAgICAgIGlmICh3aW5kb3cuZ2V0U2VsZWN0aW9uKCkuZW1wdHkpIHtcbiAgICAgICAgd2luZG93LmdldFNlbGVjdGlvbigpLmVtcHR5KCk7XG4gICAgICB9IGVsc2UgaWYgKHdpbmRvdy5nZXRTZWxlY3Rpb24oKS5yZW1vdmVBbGxSYW5nZXMpIHtcbiAgICAgICAgd2luZG93LmdldFNlbGVjdGlvbigpLnJlbW92ZUFsbFJhbmdlcygpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQuc2VsZWN0aW9uKSB7XG4gICAgICBkb2N1bWVudC5zZWxlY3Rpb24uZW1wdHkoKTtcbiAgICB9XG4gIH07XG4gIHZhciBzZWxlY3Rpb25zID0gW25ldyBXYWxrb250YWJsZVNlbGVjdGlvbih7XG4gICAgY2xhc3NOYW1lOiAnY3VycmVudCcsXG4gICAgYm9yZGVyOiB7XG4gICAgICB3aWR0aDogMixcbiAgICAgIGNvbG9yOiAnIzUyOTJGNycsXG4gICAgICBjb3JuZXJWaXNpYmxlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoYXQuc2V0dGluZ3MuZmlsbEhhbmRsZSAmJiAhdGhhdC5pc0NlbGxFZGl0ZWQoKSAmJiAhaW5zdGFuY2Uuc2VsZWN0aW9uLmlzTXVsdGlwbGUoKTtcbiAgICAgIH0sXG4gICAgICBtdWx0aXBsZVNlbGVjdGlvbkhhbmRsZXNWaXNpYmxlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICF0aGF0LmlzQ2VsbEVkaXRlZCgpICYmICFpbnN0YW5jZS5zZWxlY3Rpb24uaXNNdWx0aXBsZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfSksIG5ldyBXYWxrb250YWJsZVNlbGVjdGlvbih7XG4gICAgY2xhc3NOYW1lOiAnYXJlYScsXG4gICAgYm9yZGVyOiB7XG4gICAgICB3aWR0aDogMSxcbiAgICAgIGNvbG9yOiAnIzg5QUZGOScsXG4gICAgICBjb3JuZXJWaXNpYmxlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoYXQuc2V0dGluZ3MuZmlsbEhhbmRsZSAmJiAhdGhhdC5pc0NlbGxFZGl0ZWQoKSAmJiBpbnN0YW5jZS5zZWxlY3Rpb24uaXNNdWx0aXBsZSgpO1xuICAgICAgfSxcbiAgICAgIG11bHRpcGxlU2VsZWN0aW9uSGFuZGxlc1Zpc2libGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gIXRoYXQuaXNDZWxsRWRpdGVkKCkgJiYgaW5zdGFuY2Uuc2VsZWN0aW9uLmlzTXVsdGlwbGUoKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pLCBuZXcgV2Fsa29udGFibGVTZWxlY3Rpb24oe1xuICAgIGNsYXNzTmFtZTogJ2hpZ2hsaWdodCcsXG4gICAgaGlnaGxpZ2h0SGVhZGVyQ2xhc3NOYW1lOiB0aGF0LnNldHRpbmdzLmN1cnJlbnRIZWFkZXJDbGFzc05hbWUsXG4gICAgaGlnaGxpZ2h0Um93Q2xhc3NOYW1lOiB0aGF0LnNldHRpbmdzLmN1cnJlbnRSb3dDbGFzc05hbWUsXG4gICAgaGlnaGxpZ2h0Q29sdW1uQ2xhc3NOYW1lOiB0aGF0LnNldHRpbmdzLmN1cnJlbnRDb2xDbGFzc05hbWVcbiAgfSksIG5ldyBXYWxrb250YWJsZVNlbGVjdGlvbih7XG4gICAgY2xhc3NOYW1lOiAnZmlsbCcsXG4gICAgYm9yZGVyOiB7XG4gICAgICB3aWR0aDogMSxcbiAgICAgIGNvbG9yOiAncmVkJ1xuICAgIH1cbiAgfSldO1xuICBzZWxlY3Rpb25zLmN1cnJlbnQgPSBzZWxlY3Rpb25zWzBdO1xuICBzZWxlY3Rpb25zLmFyZWEgPSBzZWxlY3Rpb25zWzFdO1xuICBzZWxlY3Rpb25zLmhpZ2hsaWdodCA9IHNlbGVjdGlvbnNbMl07XG4gIHNlbGVjdGlvbnMuZmlsbCA9IHNlbGVjdGlvbnNbM107XG4gIHZhciB3YWxrb250YWJsZUNvbmZpZyA9IHtcbiAgICBkZWJ1ZzogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhhdC5zZXR0aW5ncy5kZWJ1ZztcbiAgICB9LFxuICAgIGV4dGVybmFsUm93Q2FsY3VsYXRvcjogdGhpcy5pbnN0YW5jZS5nZXRQbHVnaW4oJ2F1dG9Sb3dTaXplJykgJiYgdGhpcy5pbnN0YW5jZS5nZXRQbHVnaW4oJ2F1dG9Sb3dTaXplJykuaXNFbmFibGVkKCksXG4gICAgdGFibGU6IHRhYmxlLFxuICAgIHByZXZlbnRPdmVyZmxvdzogKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuICRfXzguc2V0dGluZ3MucHJldmVudE92ZXJmbG93O1xuICAgIH0pLFxuICAgIHN0cmV0Y2hIOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGF0LnNldHRpbmdzLnN0cmV0Y2hIO1xuICAgIH0sXG4gICAgZGF0YTogaW5zdGFuY2UuZ2V0RGF0YUF0Q2VsbCxcbiAgICB0b3RhbFJvd3M6IChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBpbnN0YW5jZS5jb3VudFJvd3MoKTtcbiAgICB9KSxcbiAgICB0b3RhbENvbHVtbnM6IChmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBpbnN0YW5jZS5jb3VudENvbHMoKTtcbiAgICB9KSxcbiAgICBmaXhlZENvbHVtbnNMZWZ0OiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGF0LnNldHRpbmdzLmZpeGVkQ29sdW1uc0xlZnQ7XG4gICAgfSxcbiAgICBmaXhlZFJvd3NUb3A6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoYXQuc2V0dGluZ3MuZml4ZWRSb3dzVG9wO1xuICAgIH0sXG4gICAgZml4ZWRSb3dzQm90dG9tOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGF0LnNldHRpbmdzLmZpeGVkUm93c0JvdHRvbTtcbiAgICB9LFxuICAgIG1pblNwYXJlUm93czogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhhdC5zZXR0aW5ncy5taW5TcGFyZVJvd3M7XG4gICAgfSxcbiAgICByZW5kZXJBbGxSb3dzOiB0aGF0LnNldHRpbmdzLnJlbmRlckFsbFJvd3MsXG4gICAgcm93SGVhZGVyczogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgaGVhZGVyUmVuZGVyZXJzID0gW107XG4gICAgICBpZiAoaW5zdGFuY2UuaGFzUm93SGVhZGVycygpKSB7XG4gICAgICAgIGhlYWRlclJlbmRlcmVycy5wdXNoKGZ1bmN0aW9uKHJvdywgVEgpIHtcbiAgICAgICAgICB0aGF0LmFwcGVuZFJvd0hlYWRlcihyb3csIFRIKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnYWZ0ZXJHZXRSb3dIZWFkZXJSZW5kZXJlcnMnLCBoZWFkZXJSZW5kZXJlcnMpO1xuICAgICAgcmV0dXJuIGhlYWRlclJlbmRlcmVycztcbiAgICB9LFxuICAgIGNvbHVtbkhlYWRlcnM6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGhlYWRlclJlbmRlcmVycyA9IFtdO1xuICAgICAgaWYgKGluc3RhbmNlLmhhc0NvbEhlYWRlcnMoKSkge1xuICAgICAgICBoZWFkZXJSZW5kZXJlcnMucHVzaChmdW5jdGlvbihjb2x1bW4sIFRIKSB7XG4gICAgICAgICAgdGhhdC5hcHBlbmRDb2xIZWFkZXIoY29sdW1uLCBUSCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2FmdGVyR2V0Q29sdW1uSGVhZGVyUmVuZGVyZXJzJywgaGVhZGVyUmVuZGVyZXJzKTtcbiAgICAgIHJldHVybiBoZWFkZXJSZW5kZXJlcnM7XG4gICAgfSxcbiAgICBjb2x1bW5XaWR0aDogaW5zdGFuY2UuZ2V0Q29sV2lkdGgsXG4gICAgcm93SGVpZ2h0OiBpbnN0YW5jZS5nZXRSb3dIZWlnaHQsXG4gICAgY2VsbFJlbmRlcmVyOiBmdW5jdGlvbihyb3csIGNvbCwgVEQpIHtcbiAgICAgIHZhciBjZWxsUHJvcGVydGllcyA9IHRoYXQuaW5zdGFuY2UuZ2V0Q2VsbE1ldGEocm93LCBjb2wpO1xuICAgICAgdmFyIHByb3AgPSB0aGF0Lmluc3RhbmNlLmNvbFRvUHJvcChjb2wpO1xuICAgICAgdmFyIHZhbHVlID0gdGhhdC5pbnN0YW5jZS5nZXREYXRhQXRSb3dQcm9wKHJvdywgcHJvcCk7XG4gICAgICBpZiAodGhhdC5pbnN0YW5jZS5oYXNIb29rKCdiZWZvcmVWYWx1ZVJlbmRlcicpKSB7XG4gICAgICAgIHZhbHVlID0gdGhhdC5pbnN0YW5jZS5ydW5Ib29rcygnYmVmb3JlVmFsdWVSZW5kZXInLCB2YWx1ZSk7XG4gICAgICB9XG4gICAgICB0aGF0Lmluc3RhbmNlLnJ1bkhvb2tzKCdiZWZvcmVSZW5kZXJlcicsIFRELCByb3csIGNvbCwgcHJvcCwgdmFsdWUsIGNlbGxQcm9wZXJ0aWVzKTtcbiAgICAgIHRoYXQuaW5zdGFuY2UuZ2V0Q2VsbFJlbmRlcmVyKGNlbGxQcm9wZXJ0aWVzKSh0aGF0Lmluc3RhbmNlLCBURCwgcm93LCBjb2wsIHByb3AsIHZhbHVlLCBjZWxsUHJvcGVydGllcyk7XG4gICAgICB0aGF0Lmluc3RhbmNlLnJ1bkhvb2tzKCdhZnRlclJlbmRlcmVyJywgVEQsIHJvdywgY29sLCBwcm9wLCB2YWx1ZSwgY2VsbFByb3BlcnRpZXMpO1xuICAgIH0sXG4gICAgc2VsZWN0aW9uczogc2VsZWN0aW9ucyxcbiAgICBoaWRlQm9yZGVyT25Nb3VzZURvd25PdmVyOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGF0LnNldHRpbmdzLmZyYWdtZW50U2VsZWN0aW9uO1xuICAgIH0sXG4gICAgb25DZWxsTW91c2VEb3duOiBmdW5jdGlvbihldmVudCwgY29vcmRzLCBURCwgd3QpIHtcbiAgICAgIHZhciBibG9ja0NhbGN1bGF0aW9ucyA9IHtcbiAgICAgICAgcm93OiBmYWxzZSxcbiAgICAgICAgY29sdW1uOiBmYWxzZSxcbiAgICAgICAgY2VsbHM6IGZhbHNlXG4gICAgICB9O1xuICAgICAgaW5zdGFuY2UubGlzdGVuKCk7XG4gICAgICB0aGF0LmFjdGl2ZVd0ID0gd3Q7XG4gICAgICBpc01vdXNlRG93biA9IHRydWU7XG4gICAgICBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnYmVmb3JlT25DZWxsTW91c2VEb3duJywgZXZlbnQsIGNvb3JkcywgVEQsIGJsb2NrQ2FsY3VsYXRpb25zKTtcbiAgICAgIGlmIChpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZChldmVudCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIGFjdHVhbFNlbGVjdGlvbiA9IGluc3RhbmNlLmdldFNlbGVjdGVkUmFuZ2UoKTtcbiAgICAgIHZhciBzZWxlY3Rpb24gPSBpbnN0YW5jZS5zZWxlY3Rpb247XG4gICAgICB2YXIgc2VsZWN0ZWRIZWFkZXIgPSBzZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXI7XG4gICAgICBpZiAoZXZlbnQuc2hpZnRLZXkgJiYgYWN0dWFsU2VsZWN0aW9uKSB7XG4gICAgICAgIGlmIChjb29yZHMucm93ID49IDAgJiYgY29vcmRzLmNvbCA+PSAwICYmICFibG9ja0NhbGN1bGF0aW9ucy5jZWxscykge1xuICAgICAgICAgIHNlbGVjdGlvbi5zZXRTZWxlY3RlZEhlYWRlcnMoZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgICBzZWxlY3Rpb24uc2V0UmFuZ2VFbmQoY29vcmRzKTtcbiAgICAgICAgfSBlbHNlIGlmICgoc2VsZWN0ZWRIZWFkZXIuY29scyB8fCBzZWxlY3RlZEhlYWRlci5yb3dzKSAmJiBjb29yZHMucm93ID49IDAgJiYgY29vcmRzLmNvbCA+PSAwICYmICFibG9ja0NhbGN1bGF0aW9ucy5jZWxscykge1xuICAgICAgICAgIHNlbGVjdGlvbi5zZXRTZWxlY3RlZEhlYWRlcnMoZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgICBzZWxlY3Rpb24uc2V0UmFuZ2VFbmQobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3Jkcyhjb29yZHMucm93LCBjb29yZHMuY29sKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoc2VsZWN0ZWRIZWFkZXIuY29scyAmJiBjb29yZHMucm93IDwgMCAmJiAhYmxvY2tDYWxjdWxhdGlvbnMuY29sdW1uKSB7XG4gICAgICAgICAgc2VsZWN0aW9uLnNldFJhbmdlRW5kKG5ldyBXYWxrb250YWJsZUNlbGxDb29yZHMoYWN0dWFsU2VsZWN0aW9uLnRvLnJvdywgY29vcmRzLmNvbCkpO1xuICAgICAgICB9IGVsc2UgaWYgKHNlbGVjdGVkSGVhZGVyLnJvd3MgJiYgY29vcmRzLmNvbCA8IDAgJiYgIWJsb2NrQ2FsY3VsYXRpb25zLnJvdykge1xuICAgICAgICAgIHNlbGVjdGlvbi5zZXRSYW5nZUVuZChuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKGNvb3Jkcy5yb3csIGFjdHVhbFNlbGVjdGlvbi50by5jb2wpKTtcbiAgICAgICAgfSBlbHNlIGlmICgoKCFzZWxlY3RlZEhlYWRlci5jb2xzICYmICFzZWxlY3RlZEhlYWRlci5yb3dzICYmIGNvb3Jkcy5jb2wgPCAwKSB8fCAoc2VsZWN0ZWRIZWFkZXIuY29scyAmJiBjb29yZHMuY29sIDwgMCkpICYmICFibG9ja0NhbGN1bGF0aW9ucy5yb3cpIHtcbiAgICAgICAgICBzZWxlY3Rpb24uc2V0U2VsZWN0ZWRIZWFkZXJzKHRydWUsIGZhbHNlKTtcbiAgICAgICAgICBzZWxlY3Rpb24uc2V0UmFuZ2VTdGFydE9ubHkobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhhY3R1YWxTZWxlY3Rpb24uZnJvbS5yb3csIDApKTtcbiAgICAgICAgICBzZWxlY3Rpb24uc2V0UmFuZ2VFbmQobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3Jkcyhjb29yZHMucm93LCBpbnN0YW5jZS5jb3VudENvbHMoKSAtIDEpKTtcbiAgICAgICAgfSBlbHNlIGlmICgoKCFzZWxlY3RlZEhlYWRlci5jb2xzICYmICFzZWxlY3RlZEhlYWRlci5yb3dzICYmIGNvb3Jkcy5yb3cgPCAwKSB8fCAoc2VsZWN0ZWRIZWFkZXIucm93cyAmJiBjb29yZHMucm93IDwgMCkpICYmICFibG9ja0NhbGN1bGF0aW9ucy5jb2x1bW4pIHtcbiAgICAgICAgICBzZWxlY3Rpb24uc2V0U2VsZWN0ZWRIZWFkZXJzKGZhbHNlLCB0cnVlKTtcbiAgICAgICAgICBzZWxlY3Rpb24uc2V0UmFuZ2VTdGFydE9ubHkobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcygwLCBhY3R1YWxTZWxlY3Rpb24uZnJvbS5jb2wpKTtcbiAgICAgICAgICBzZWxlY3Rpb24uc2V0UmFuZ2VFbmQobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhpbnN0YW5jZS5jb3VudFJvd3MoKSAtIDEsIGNvb3Jkcy5jb2wpKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGRvTmV3U2VsZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgaWYgKGFjdHVhbFNlbGVjdGlvbikge1xuICAgICAgICAgIHZhciAkX185ID0gYWN0dWFsU2VsZWN0aW9uLFxuICAgICAgICAgICAgICBmcm9tID0gJF9fOS5mcm9tLFxuICAgICAgICAgICAgICB0byA9ICRfXzkudG87XG4gICAgICAgICAgdmFyIGNvb3Jkc05vdEluU2VsZWN0aW9uID0gIXNlbGVjdGlvbi5pbkluU2VsZWN0aW9uKGNvb3Jkcyk7XG4gICAgICAgICAgaWYgKGNvb3Jkcy5yb3cgPCAwICYmIHNlbGVjdGVkSGVhZGVyLmNvbHMpIHtcbiAgICAgICAgICAgIHZhciBzdGFydCA9IE1hdGgubWluKGZyb20uY29sLCB0by5jb2wpO1xuICAgICAgICAgICAgdmFyIGVuZCA9IE1hdGgubWF4KGZyb20uY29sLCB0by5jb2wpO1xuICAgICAgICAgICAgZG9OZXdTZWxlY3Rpb24gPSAoY29vcmRzLmNvbCA8IHN0YXJ0IHx8IGNvb3Jkcy5jb2wgPiBlbmQpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoY29vcmRzLmNvbCA8IDAgJiYgc2VsZWN0ZWRIZWFkZXIucm93cykge1xuICAgICAgICAgICAgdmFyIHN0YXJ0JF9fMTAgPSBNYXRoLm1pbihmcm9tLnJvdywgdG8ucm93KTtcbiAgICAgICAgICAgIHZhciBlbmQkX18xMSA9IE1hdGgubWF4KGZyb20ucm93LCB0by5yb3cpO1xuICAgICAgICAgICAgZG9OZXdTZWxlY3Rpb24gPSAoY29vcmRzLnJvdyA8IHN0YXJ0JF9fMTAgfHwgY29vcmRzLnJvdyA+IGVuZCRfXzExKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZG9OZXdTZWxlY3Rpb24gPSBjb29yZHNOb3RJblNlbGVjdGlvbjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJpZ2h0Q2xpY2sgPSBpc1JpZ2h0Q2xpY2soZXZlbnQpO1xuICAgICAgICB2YXIgbGVmdENsaWNrID0gaXNMZWZ0Q2xpY2soZXZlbnQpIHx8IGV2ZW50LnR5cGUgPT09ICd0b3VjaHN0YXJ0JztcbiAgICAgICAgaWYgKGNvb3Jkcy5yb3cgPCAwICYmIGNvb3Jkcy5jb2wgPj0gMCAmJiAhYmxvY2tDYWxjdWxhdGlvbnMuY29sdW1uKSB7XG4gICAgICAgICAgc2VsZWN0aW9uLnNldFNlbGVjdGVkSGVhZGVycyhmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgaWYgKGxlZnRDbGljayB8fCAocmlnaHRDbGljayAmJiBkb05ld1NlbGVjdGlvbikpIHtcbiAgICAgICAgICAgIHNlbGVjdGlvbi5zZXRSYW5nZVN0YXJ0T25seShuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKDAsIGNvb3Jkcy5jb2wpKTtcbiAgICAgICAgICAgIHNlbGVjdGlvbi5zZXRSYW5nZUVuZChuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKE1hdGgubWF4KGluc3RhbmNlLmNvdW50Um93cygpIC0gMSwgMCksIGNvb3Jkcy5jb2wpLCBmYWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGNvb3Jkcy5jb2wgPCAwICYmIGNvb3Jkcy5yb3cgPj0gMCAmJiAhYmxvY2tDYWxjdWxhdGlvbnMucm93KSB7XG4gICAgICAgICAgc2VsZWN0aW9uLnNldFNlbGVjdGVkSGVhZGVycyh0cnVlLCBmYWxzZSk7XG4gICAgICAgICAgaWYgKGxlZnRDbGljayB8fCAocmlnaHRDbGljayAmJiBkb05ld1NlbGVjdGlvbikpIHtcbiAgICAgICAgICAgIHNlbGVjdGlvbi5zZXRSYW5nZVN0YXJ0T25seShuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKGNvb3Jkcy5yb3csIDApKTtcbiAgICAgICAgICAgIHNlbGVjdGlvbi5zZXRSYW5nZUVuZChuZXcgV2Fsa29udGFibGVDZWxsQ29vcmRzKGNvb3Jkcy5yb3csIE1hdGgubWF4KGluc3RhbmNlLmNvdW50Q29scygpIC0gMSwgMCkpLCBmYWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGNvb3Jkcy5jb2wgPj0gMCAmJiBjb29yZHMucm93ID49IDAgJiYgIWJsb2NrQ2FsY3VsYXRpb25zLmNlbGxzKSB7XG4gICAgICAgICAgaWYgKGxlZnRDbGljayB8fCAocmlnaHRDbGljayAmJiBkb05ld1NlbGVjdGlvbikpIHtcbiAgICAgICAgICAgIHNlbGVjdGlvbi5zZXRTZWxlY3RlZEhlYWRlcnMoZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgICAgIHNlbGVjdGlvbi5zZXRSYW5nZVN0YXJ0KGNvb3Jkcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGNvb3Jkcy5jb2wgPCAwICYmIGNvb3Jkcy5yb3cgPCAwKSB7XG4gICAgICAgICAgY29vcmRzLnJvdyA9IDA7XG4gICAgICAgICAgY29vcmRzLmNvbCA9IDA7XG4gICAgICAgICAgc2VsZWN0aW9uLnNldFNlbGVjdGVkSGVhZGVycyhmYWxzZSwgZmFsc2UsIHRydWUpO1xuICAgICAgICAgIHNlbGVjdGlvbi5zZXRSYW5nZVN0YXJ0KGNvb3Jkcyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIEhhbmRzb250YWJsZS5ob29rcy5ydW4oaW5zdGFuY2UsICdhZnRlck9uQ2VsbE1vdXNlRG93bicsIGV2ZW50LCBjb29yZHMsIFREKTtcbiAgICAgIHRoYXQuYWN0aXZlV3QgPSB0aGF0Lnd0O1xuICAgIH0sXG4gICAgb25DZWxsTW91c2VPdXQ6IGZ1bmN0aW9uKGV2ZW50LCBjb29yZHMsIFRELCB3dCkge1xuICAgICAgdGhhdC5hY3RpdmVXdCA9IHd0O1xuICAgICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2JlZm9yZU9uQ2VsbE1vdXNlT3V0JywgZXZlbnQsIGNvb3JkcywgVEQpO1xuICAgICAgaWYgKGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKGV2ZW50KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnYWZ0ZXJPbkNlbGxNb3VzZU91dCcsIGV2ZW50LCBjb29yZHMsIFREKTtcbiAgICAgIHRoYXQuYWN0aXZlV3QgPSB0aGF0Lnd0O1xuICAgIH0sXG4gICAgb25DZWxsTW91c2VPdmVyOiBmdW5jdGlvbihldmVudCwgY29vcmRzLCBURCwgd3QpIHtcbiAgICAgIHZhciBibG9ja0NhbGN1bGF0aW9ucyA9IHtcbiAgICAgICAgcm93OiBmYWxzZSxcbiAgICAgICAgY29sdW1uOiBmYWxzZSxcbiAgICAgICAgY2VsbDogZmFsc2VcbiAgICAgIH07XG4gICAgICB0aGF0LmFjdGl2ZVd0ID0gd3Q7XG4gICAgICBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnYmVmb3JlT25DZWxsTW91c2VPdmVyJywgZXZlbnQsIGNvb3JkcywgVEQsIGJsb2NrQ2FsY3VsYXRpb25zKTtcbiAgICAgIGlmIChpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZChldmVudCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGV2ZW50LmJ1dHRvbiA9PT0gMCAmJiBpc01vdXNlRG93bikge1xuICAgICAgICBpZiAoY29vcmRzLnJvdyA+PSAwICYmIGNvb3Jkcy5jb2wgPj0gMCkge1xuICAgICAgICAgIGlmIChpbnN0YW5jZS5zZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIuY29scyAmJiAhYmxvY2tDYWxjdWxhdGlvbnMuY29sdW1uKSB7XG4gICAgICAgICAgICBpbnN0YW5jZS5zZWxlY3Rpb24uc2V0UmFuZ2VFbmQobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhpbnN0YW5jZS5jb3VudFJvd3MoKSAtIDEsIGNvb3Jkcy5jb2wpLCBmYWxzZSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChpbnN0YW5jZS5zZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIucm93cyAmJiAhYmxvY2tDYWxjdWxhdGlvbnMucm93KSB7XG4gICAgICAgICAgICBpbnN0YW5jZS5zZWxlY3Rpb24uc2V0UmFuZ2VFbmQobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3Jkcyhjb29yZHMucm93LCBpbnN0YW5jZS5jb3VudENvbHMoKSAtIDEpLCBmYWxzZSk7XG4gICAgICAgICAgfSBlbHNlIGlmICghYmxvY2tDYWxjdWxhdGlvbnMuY2VsbCkge1xuICAgICAgICAgICAgaW5zdGFuY2Uuc2VsZWN0aW9uLnNldFJhbmdlRW5kKGNvb3Jkcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChpbnN0YW5jZS5zZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIuY29scyAmJiAhYmxvY2tDYWxjdWxhdGlvbnMuY29sdW1uKSB7XG4gICAgICAgICAgICBpbnN0YW5jZS5zZWxlY3Rpb24uc2V0UmFuZ2VFbmQobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3JkcyhpbnN0YW5jZS5jb3VudFJvd3MoKSAtIDEsIGNvb3Jkcy5jb2wpLCBmYWxzZSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChpbnN0YW5jZS5zZWxlY3Rpb24uc2VsZWN0ZWRIZWFkZXIucm93cyAmJiAhYmxvY2tDYWxjdWxhdGlvbnMucm93KSB7XG4gICAgICAgICAgICBpbnN0YW5jZS5zZWxlY3Rpb24uc2V0UmFuZ2VFbmQobmV3IFdhbGtvbnRhYmxlQ2VsbENvb3Jkcyhjb29yZHMucm93LCBpbnN0YW5jZS5jb3VudENvbHMoKSAtIDEpLCBmYWxzZSk7XG4gICAgICAgICAgfSBlbHNlIGlmICghYmxvY2tDYWxjdWxhdGlvbnMuY2VsbCkge1xuICAgICAgICAgICAgaW5zdGFuY2Uuc2VsZWN0aW9uLnNldFJhbmdlRW5kKGNvb3Jkcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnYWZ0ZXJPbkNlbGxNb3VzZU92ZXInLCBldmVudCwgY29vcmRzLCBURCk7XG4gICAgICB0aGF0LmFjdGl2ZVd0ID0gdGhhdC53dDtcbiAgICB9LFxuICAgIG9uQ2VsbE1vdXNlVXA6IGZ1bmN0aW9uKGV2ZW50LCBjb29yZHMsIFRELCB3dCkge1xuICAgICAgdGhhdC5hY3RpdmVXdCA9IHd0O1xuICAgICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2JlZm9yZU9uQ2VsbE1vdXNlVXAnLCBldmVudCwgY29vcmRzLCBURCk7XG4gICAgICBIYW5kc29udGFibGUuaG9va3MucnVuKGluc3RhbmNlLCAnYWZ0ZXJPbkNlbGxNb3VzZVVwJywgZXZlbnQsIGNvb3JkcywgVEQpO1xuICAgICAgdGhhdC5hY3RpdmVXdCA9IHRoYXQud3Q7XG4gICAgfSxcbiAgICBvbkNlbGxDb3JuZXJNb3VzZURvd246IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2FmdGVyT25DZWxsQ29ybmVyTW91c2VEb3duJywgZXZlbnQpO1xuICAgIH0sXG4gICAgb25DZWxsQ29ybmVyRGJsQ2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2FmdGVyT25DZWxsQ29ybmVyRGJsQ2xpY2snLCBldmVudCk7XG4gICAgfSxcbiAgICBiZWZvcmVEcmF3OiBmdW5jdGlvbihmb3JjZSwgc2tpcFJlbmRlcikge1xuICAgICAgdGhhdC5iZWZvcmVSZW5kZXIoZm9yY2UsIHNraXBSZW5kZXIpO1xuICAgIH0sXG4gICAgb25EcmF3OiBmdW5jdGlvbihmb3JjZSkge1xuICAgICAgdGhhdC5vbkRyYXcoZm9yY2UpO1xuICAgIH0sXG4gICAgb25TY3JvbGxWZXJ0aWNhbGx5OiBmdW5jdGlvbigpIHtcbiAgICAgIGluc3RhbmNlLnJ1bkhvb2tzKCdhZnRlclNjcm9sbFZlcnRpY2FsbHknKTtcbiAgICB9LFxuICAgIG9uU2Nyb2xsSG9yaXpvbnRhbGx5OiBmdW5jdGlvbigpIHtcbiAgICAgIGluc3RhbmNlLnJ1bkhvb2tzKCdhZnRlclNjcm9sbEhvcml6b250YWxseScpO1xuICAgIH0sXG4gICAgb25CZWZvcmVEcmF3Qm9yZGVyczogZnVuY3Rpb24oY29ybmVycywgYm9yZGVyQ2xhc3NOYW1lKSB7XG4gICAgICBpbnN0YW5jZS5ydW5Ib29rcygnYmVmb3JlRHJhd0JvcmRlcnMnLCBjb3JuZXJzLCBib3JkZXJDbGFzc05hbWUpO1xuICAgIH0sXG4gICAgb25CZWZvcmVUb3VjaFNjcm9sbDogZnVuY3Rpb24oKSB7XG4gICAgICBpbnN0YW5jZS5ydW5Ib29rcygnYmVmb3JlVG91Y2hTY3JvbGwnKTtcbiAgICB9LFxuICAgIG9uQWZ0ZXJNb21lbnR1bVNjcm9sbDogZnVuY3Rpb24oKSB7XG4gICAgICBpbnN0YW5jZS5ydW5Ib29rcygnYWZ0ZXJNb21lbnR1bVNjcm9sbCcpO1xuICAgIH0sXG4gICAgb25CZWZvcmVTdHJldGNoaW5nQ29sdW1uV2lkdGg6IGZ1bmN0aW9uKHN0cmV0Y2hlZFdpZHRoLCBjb2x1bW4pIHtcbiAgICAgIHJldHVybiBpbnN0YW5jZS5ydW5Ib29rcygnYmVmb3JlU3RyZXRjaGluZ0NvbHVtbldpZHRoJywgc3RyZXRjaGVkV2lkdGgsIGNvbHVtbik7XG4gICAgfSxcbiAgICBvbk1vZGlmeVJvd0hlYWRlcldpZHRoOiBmdW5jdGlvbihyb3dIZWFkZXJXaWR0aCkge1xuICAgICAgcmV0dXJuIGluc3RhbmNlLnJ1bkhvb2tzKCdtb2RpZnlSb3dIZWFkZXJXaWR0aCcsIHJvd0hlYWRlcldpZHRoKTtcbiAgICB9LFxuICAgIHZpZXdwb3J0Um93Q2FsY3VsYXRvck92ZXJyaWRlOiBmdW5jdGlvbihjYWxjKSB7XG4gICAgICB2YXIgcm93cyA9IGluc3RhbmNlLmNvdW50Um93cygpO1xuICAgICAgdmFyIHZpZXdwb3J0T2Zmc2V0ID0gdGhhdC5zZXR0aW5ncy52aWV3cG9ydFJvd1JlbmRlcmluZ09mZnNldDtcbiAgICAgIGlmICh2aWV3cG9ydE9mZnNldCA9PT0gJ2F1dG8nICYmIHRoYXQuc2V0dGluZ3MuZml4ZWRSb3dzVG9wKSB7XG4gICAgICAgIHZpZXdwb3J0T2Zmc2V0ID0gMTA7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHZpZXdwb3J0T2Zmc2V0ID09PSAnbnVtYmVyJykge1xuICAgICAgICBjYWxjLnN0YXJ0Um93ID0gTWF0aC5tYXgoY2FsYy5zdGFydFJvdyAtIHZpZXdwb3J0T2Zmc2V0LCAwKTtcbiAgICAgICAgY2FsYy5lbmRSb3cgPSBNYXRoLm1pbihjYWxjLmVuZFJvdyArIHZpZXdwb3J0T2Zmc2V0LCByb3dzIC0gMSk7XG4gICAgICB9XG4gICAgICBpZiAodmlld3BvcnRPZmZzZXQgPT09ICdhdXRvJykge1xuICAgICAgICB2YXIgY2VudGVyID0gY2FsYy5zdGFydFJvdyArIGNhbGMuZW5kUm93IC0gY2FsYy5zdGFydFJvdztcbiAgICAgICAgdmFyIG9mZnNldCA9IE1hdGguY2VpbChjZW50ZXIgLyByb3dzICogMTIpO1xuICAgICAgICBjYWxjLnN0YXJ0Um93ID0gTWF0aC5tYXgoY2FsYy5zdGFydFJvdyAtIG9mZnNldCwgMCk7XG4gICAgICAgIGNhbGMuZW5kUm93ID0gTWF0aC5taW4oY2FsYy5lbmRSb3cgKyBvZmZzZXQsIHJvd3MgLSAxKTtcbiAgICAgIH1cbiAgICAgIGluc3RhbmNlLnJ1bkhvb2tzKCdhZnRlclZpZXdwb3J0Um93Q2FsY3VsYXRvck92ZXJyaWRlJywgY2FsYyk7XG4gICAgfSxcbiAgICB2aWV3cG9ydENvbHVtbkNhbGN1bGF0b3JPdmVycmlkZTogZnVuY3Rpb24oY2FsYykge1xuICAgICAgdmFyIGNvbHMgPSBpbnN0YW5jZS5jb3VudENvbHMoKTtcbiAgICAgIHZhciB2aWV3cG9ydE9mZnNldCA9IHRoYXQuc2V0dGluZ3Mudmlld3BvcnRDb2x1bW5SZW5kZXJpbmdPZmZzZXQ7XG4gICAgICBpZiAodmlld3BvcnRPZmZzZXQgPT09ICdhdXRvJyAmJiB0aGF0LnNldHRpbmdzLmZpeGVkQ29sdW1uc0xlZnQpIHtcbiAgICAgICAgdmlld3BvcnRPZmZzZXQgPSAxMDtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2Ygdmlld3BvcnRPZmZzZXQgPT09ICdudW1iZXInKSB7XG4gICAgICAgIGNhbGMuc3RhcnRDb2x1bW4gPSBNYXRoLm1heChjYWxjLnN0YXJ0Q29sdW1uIC0gdmlld3BvcnRPZmZzZXQsIDApO1xuICAgICAgICBjYWxjLmVuZENvbHVtbiA9IE1hdGgubWluKGNhbGMuZW5kQ29sdW1uICsgdmlld3BvcnRPZmZzZXQsIGNvbHMgLSAxKTtcbiAgICAgIH1cbiAgICAgIGlmICh2aWV3cG9ydE9mZnNldCA9PT0gJ2F1dG8nKSB7XG4gICAgICAgIHZhciBjZW50ZXIgPSBjYWxjLnN0YXJ0Q29sdW1uICsgY2FsYy5lbmRDb2x1bW4gLSBjYWxjLnN0YXJ0Q29sdW1uO1xuICAgICAgICB2YXIgb2Zmc2V0ID0gTWF0aC5jZWlsKGNlbnRlciAvIGNvbHMgKiAxMik7XG4gICAgICAgIGNhbGMuc3RhcnRSb3cgPSBNYXRoLm1heChjYWxjLnN0YXJ0Q29sdW1uIC0gb2Zmc2V0LCAwKTtcbiAgICAgICAgY2FsYy5lbmRDb2x1bW4gPSBNYXRoLm1pbihjYWxjLmVuZENvbHVtbiArIG9mZnNldCwgY29scyAtIDEpO1xuICAgICAgfVxuICAgICAgaW5zdGFuY2UucnVuSG9va3MoJ2FmdGVyVmlld3BvcnRDb2x1bW5DYWxjdWxhdG9yT3ZlcnJpZGUnLCBjYWxjKTtcbiAgICB9LFxuICAgIHJvd0hlYWRlcldpZHRoOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB0aGF0LnNldHRpbmdzLnJvd0hlYWRlcldpZHRoO1xuICAgIH0sXG4gICAgY29sdW1uSGVhZGVySGVpZ2h0OiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBjb2x1bW5IZWFkZXJIZWlnaHQgPSBpbnN0YW5jZS5ydW5Ib29rcygnbW9kaWZ5Q29sdW1uSGVhZGVySGVpZ2h0Jyk7XG4gICAgICByZXR1cm4gdGhhdC5zZXR0aW5ncy5jb2x1bW5IZWFkZXJIZWlnaHQgfHwgY29sdW1uSGVhZGVySGVpZ2h0O1xuICAgIH1cbiAgfTtcbiAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bihpbnN0YW5jZSwgJ2JlZm9yZUluaXRXYWxrb250YWJsZScsIHdhbGtvbnRhYmxlQ29uZmlnKTtcbiAgdGhpcy53dCA9IG5ldyBXYWxrb250YWJsZSh3YWxrb250YWJsZUNvbmZpZyk7XG4gIHRoaXMuYWN0aXZlV3QgPSB0aGlzLnd0O1xuICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKHRoYXQud3Qud3RUYWJsZS5zcHJlYWRlciwgJ21vdXNlZG93bicsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gdGhhdC53dC53dFRhYmxlLnNwcmVhZGVyICYmIGV2ZW50LndoaWNoID09PSAzKSB7XG4gICAgICBzdG9wUHJvcGFnYXRpb24oZXZlbnQpO1xuICAgIH1cbiAgfSk7XG4gIHRoaXMuZXZlbnRNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIodGhhdC53dC53dFRhYmxlLnNwcmVhZGVyLCAnY29udGV4dG1lbnUnLCBmdW5jdGlvbihldmVudCkge1xuICAgIGlmIChldmVudC50YXJnZXQgPT09IHRoYXQud3Qud3RUYWJsZS5zcHJlYWRlciAmJiBldmVudC53aGljaCA9PT0gMykge1xuICAgICAgc3RvcFByb3BhZ2F0aW9uKGV2ZW50KTtcbiAgICB9XG4gIH0pO1xuICB0aGlzLmV2ZW50TWFuYWdlci5hZGRFdmVudExpc3RlbmVyKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoYXQuc2V0dGluZ3Mub2JzZXJ2ZURPTVZpc2liaWxpdHkpIHtcbiAgICAgIGlmICh0aGF0Lnd0LmRyYXdJbnRlcnJ1cHRlZCkge1xuICAgICAgICB0aGF0Lmluc3RhbmNlLmZvcmNlRnVsbFJlbmRlciA9IHRydWU7XG4gICAgICAgIHRoYXQucmVuZGVyKCk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn1cblRhYmxlVmlldy5wcm90b3R5cGUuaXNUZXh0U2VsZWN0aW9uQWxsb3dlZCA9IGZ1bmN0aW9uKGVsKSB7XG4gIGlmIChpc0lucHV0KGVsKSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHZhciBpc0NoaWxkT2ZUYWJsZUJvZHkgPSBpc0NoaWxkT2YoZWwsIHRoaXMuaW5zdGFuY2Uudmlldy53dC53dFRhYmxlLnNwcmVhZGVyKTtcbiAgaWYgKHRoaXMuc2V0dGluZ3MuZnJhZ21lbnRTZWxlY3Rpb24gPT09IHRydWUgJiYgaXNDaGlsZE9mVGFibGVCb2R5KSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgaWYgKHRoaXMuc2V0dGluZ3MuZnJhZ21lbnRTZWxlY3Rpb24gPT09ICdjZWxsJyAmJiB0aGlzLmlzU2VsZWN0ZWRPbmx5Q2VsbCgpICYmIGlzQ2hpbGRPZlRhYmxlQm9keSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGlmICghdGhpcy5zZXR0aW5ncy5mcmFnbWVudFNlbGVjdGlvbiAmJiB0aGlzLmlzQ2VsbEVkaXRlZCgpICYmIHRoaXMuaXNTZWxlY3RlZE9ubHlDZWxsKCkpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59O1xuVGFibGVWaWV3LnByb3RvdHlwZS5pc1NlbGVjdGVkT25seUNlbGwgPSBmdW5jdGlvbigpIHtcbiAgdmFyICRfXzkgPSB0aGlzLmluc3RhbmNlLmdldFNlbGVjdGVkKCkgfHwgW10sXG4gICAgICByb3cgPSAkX185WzBdLFxuICAgICAgY29sID0gJF9fOVsxXSxcbiAgICAgIHJvd0VuZCA9ICRfXzlbMl0sXG4gICAgICBjb2xFbmQgPSAkX185WzNdO1xuICByZXR1cm4gcm93ICE9PSB2b2lkIDAgJiYgcm93ID09PSByb3dFbmQgJiYgY29sID09PSBjb2xFbmQ7XG59O1xuVGFibGVWaWV3LnByb3RvdHlwZS5pc0NlbGxFZGl0ZWQgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGFjdGl2ZUVkaXRvciA9IHRoaXMuaW5zdGFuY2UuZ2V0QWN0aXZlRWRpdG9yKCk7XG4gIHJldHVybiBhY3RpdmVFZGl0b3IgJiYgYWN0aXZlRWRpdG9yLmlzT3BlbmVkKCk7XG59O1xuVGFibGVWaWV3LnByb3RvdHlwZS5iZWZvcmVSZW5kZXIgPSBmdW5jdGlvbihmb3JjZSwgc2tpcFJlbmRlcikge1xuICBpZiAoZm9yY2UpIHtcbiAgICBIYW5kc29udGFibGUuaG9va3MucnVuKHRoaXMuaW5zdGFuY2UsICdiZWZvcmVSZW5kZXInLCB0aGlzLmluc3RhbmNlLmZvcmNlRnVsbFJlbmRlciwgc2tpcFJlbmRlcik7XG4gIH1cbn07XG5UYWJsZVZpZXcucHJvdG90eXBlLm9uRHJhdyA9IGZ1bmN0aW9uKGZvcmNlKSB7XG4gIGlmIChmb3JjZSkge1xuICAgIEhhbmRzb250YWJsZS5ob29rcy5ydW4odGhpcy5pbnN0YW5jZSwgJ2FmdGVyUmVuZGVyJywgdGhpcy5pbnN0YW5jZS5mb3JjZUZ1bGxSZW5kZXIpO1xuICB9XG59O1xuVGFibGVWaWV3LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy53dC5kcmF3KCF0aGlzLmluc3RhbmNlLmZvcmNlRnVsbFJlbmRlcik7XG4gIHRoaXMuaW5zdGFuY2UuZm9yY2VGdWxsUmVuZGVyID0gZmFsc2U7XG4gIHRoaXMuaW5zdGFuY2UucmVuZGVyQ2FsbCA9IGZhbHNlO1xufTtcblRhYmxlVmlldy5wcm90b3R5cGUuZ2V0Q2VsbEF0Q29vcmRzID0gZnVuY3Rpb24oY29vcmRzLCB0b3Btb3N0KSB7XG4gIHZhciB0ZCA9IHRoaXMud3QuZ2V0Q2VsbChjb29yZHMsIHRvcG1vc3QpO1xuICBpZiAodGQgPCAwKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHRkO1xuICB9XG59O1xuVGFibGVWaWV3LnByb3RvdHlwZS5zY3JvbGxWaWV3cG9ydCA9IGZ1bmN0aW9uKGNvb3Jkcykge1xuICB0aGlzLnd0LnNjcm9sbFZpZXdwb3J0KGNvb3Jkcyk7XG59O1xuVGFibGVWaWV3LnByb3RvdHlwZS5hcHBlbmRSb3dIZWFkZXIgPSBmdW5jdGlvbihyb3csIFRIKSB7XG4gIGlmIChUSC5maXJzdENoaWxkKSB7XG4gICAgdmFyIGNvbnRhaW5lciA9IFRILmZpcnN0Q2hpbGQ7XG4gICAgaWYgKCFoYXNDbGFzcyhjb250YWluZXIsICdyZWxhdGl2ZScpKSB7XG4gICAgICBlbXB0eShUSCk7XG4gICAgICB0aGlzLmFwcGVuZFJvd0hlYWRlcihyb3csIFRIKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy51cGRhdGVDZWxsSGVhZGVyKGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcucm93SGVhZGVyJyksIHJvdywgdGhpcy5pbnN0YW5jZS5nZXRSb3dIZWFkZXIpO1xuICB9IGVsc2Uge1xuICAgIHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB2YXIgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBkaXYuY2xhc3NOYW1lID0gJ3JlbGF0aXZlJztcbiAgICBzcGFuLmNsYXNzTmFtZSA9ICdyb3dIZWFkZXInO1xuICAgIHRoaXMudXBkYXRlQ2VsbEhlYWRlcihzcGFuLCByb3csIHRoaXMuaW5zdGFuY2UuZ2V0Um93SGVhZGVyKTtcbiAgICBkaXYuYXBwZW5kQ2hpbGQoc3Bhbik7XG4gICAgVEguYXBwZW5kQ2hpbGQoZGl2KTtcbiAgfVxuICBIYW5kc29udGFibGUuaG9va3MucnVuKHRoaXMuaW5zdGFuY2UsICdhZnRlckdldFJvd0hlYWRlcicsIHJvdywgVEgpO1xufTtcblRhYmxlVmlldy5wcm90b3R5cGUuYXBwZW5kQ29sSGVhZGVyID0gZnVuY3Rpb24oY29sLCBUSCkge1xuICBpZiAoVEguZmlyc3RDaGlsZCkge1xuICAgIHZhciBjb250YWluZXIgPSBUSC5maXJzdENoaWxkO1xuICAgIGlmIChoYXNDbGFzcyhjb250YWluZXIsICdyZWxhdGl2ZScpKSB7XG4gICAgICB0aGlzLnVwZGF0ZUNlbGxIZWFkZXIoY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5jb2xIZWFkZXInKSwgY29sLCB0aGlzLmluc3RhbmNlLmdldENvbEhlYWRlcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVtcHR5KFRIKTtcbiAgICAgIHRoaXMuYXBwZW5kQ29sSGVhZGVyKGNvbCwgVEgpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdmFyIHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgZGl2LmNsYXNzTmFtZSA9ICdyZWxhdGl2ZSc7XG4gICAgc3Bhbi5jbGFzc05hbWUgPSAnY29sSGVhZGVyJztcbiAgICB0aGlzLnVwZGF0ZUNlbGxIZWFkZXIoc3BhbiwgY29sLCB0aGlzLmluc3RhbmNlLmdldENvbEhlYWRlcik7XG4gICAgZGl2LmFwcGVuZENoaWxkKHNwYW4pO1xuICAgIFRILmFwcGVuZENoaWxkKGRpdik7XG4gIH1cbiAgSGFuZHNvbnRhYmxlLmhvb2tzLnJ1bih0aGlzLmluc3RhbmNlLCAnYWZ0ZXJHZXRDb2xIZWFkZXInLCBjb2wsIFRIKTtcbn07XG5UYWJsZVZpZXcucHJvdG90eXBlLnVwZGF0ZUNlbGxIZWFkZXIgPSBmdW5jdGlvbihlbGVtZW50LCBpbmRleCwgY29udGVudCkge1xuICB2YXIgcmVuZGVyZWRJbmRleCA9IGluZGV4O1xuICB2YXIgcGFyZW50T3ZlcmxheSA9IHRoaXMud3Qud3RPdmVybGF5cy5nZXRQYXJlbnRPdmVybGF5KGVsZW1lbnQpIHx8IHRoaXMud3Q7XG4gIGlmIChlbGVtZW50LnBhcmVudE5vZGUpIHtcbiAgICBpZiAoaGFzQ2xhc3MoZWxlbWVudCwgJ2NvbEhlYWRlcicpKSB7XG4gICAgICByZW5kZXJlZEluZGV4ID0gcGFyZW50T3ZlcmxheS53dFRhYmxlLmNvbHVtbkZpbHRlci5zb3VyY2VUb1JlbmRlcmVkKGluZGV4KTtcbiAgICB9IGVsc2UgaWYgKGhhc0NsYXNzKGVsZW1lbnQsICdyb3dIZWFkZXInKSkge1xuICAgICAgcmVuZGVyZWRJbmRleCA9IHBhcmVudE92ZXJsYXkud3RUYWJsZS5yb3dGaWx0ZXIuc291cmNlVG9SZW5kZXJlZChpbmRleCk7XG4gICAgfVxuICB9XG4gIGlmIChyZW5kZXJlZEluZGV4ID4gLTEpIHtcbiAgICBmYXN0SW5uZXJIVE1MKGVsZW1lbnQsIGNvbnRlbnQoaW5kZXgpKTtcbiAgfSBlbHNlIHtcbiAgICBmYXN0SW5uZXJUZXh0KGVsZW1lbnQsIFN0cmluZy5mcm9tQ2hhckNvZGUoMTYwKSk7XG4gICAgYWRkQ2xhc3MoZWxlbWVudCwgJ2Nvcm5lckhlYWRlcicpO1xuICB9XG59O1xuVGFibGVWaWV3LnByb3RvdHlwZS5tYXhpbXVtVmlzaWJsZUVsZW1lbnRXaWR0aCA9IGZ1bmN0aW9uKGxlZnRPZmZzZXQpIHtcbiAgdmFyIHdvcmtzcGFjZVdpZHRoID0gdGhpcy53dC53dFZpZXdwb3J0LmdldFdvcmtzcGFjZVdpZHRoKCk7XG4gIHZhciBtYXhXaWR0aCA9IHdvcmtzcGFjZVdpZHRoIC0gbGVmdE9mZnNldDtcbiAgcmV0dXJuIG1heFdpZHRoID4gMCA/IG1heFdpZHRoIDogMDtcbn07XG5UYWJsZVZpZXcucHJvdG90eXBlLm1heGltdW1WaXNpYmxlRWxlbWVudEhlaWdodCA9IGZ1bmN0aW9uKHRvcE9mZnNldCkge1xuICB2YXIgd29ya3NwYWNlSGVpZ2h0ID0gdGhpcy53dC53dFZpZXdwb3J0LmdldFdvcmtzcGFjZUhlaWdodCgpO1xuICB2YXIgbWF4SGVpZ2h0ID0gd29ya3NwYWNlSGVpZ2h0IC0gdG9wT2Zmc2V0O1xuICByZXR1cm4gbWF4SGVpZ2h0ID4gMCA/IG1heEhlaWdodCA6IDA7XG59O1xuVGFibGVWaWV3LnByb3RvdHlwZS5tYWluVmlld0lzQWN0aXZlID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLnd0ID09PSB0aGlzLmFjdGl2ZVd0O1xufTtcblRhYmxlVmlldy5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnd0LmRlc3Ryb3koKTtcbiAgdGhpcy5ldmVudE1hbmFnZXIuZGVzdHJveSgpO1xufTtcbjtcblxuLy8jIFxufSx7XCIzcmRwYXJ0eS93YWxrb250YWJsZS9zcmMvY2VsbC9jb29yZHNcIjo2LFwiM3JkcGFydHkvd2Fsa29udGFibGUvc3JjL2NvcmVcIjo4LFwiM3JkcGFydHkvd2Fsa29udGFibGUvc3JjL3NlbGVjdGlvblwiOjE5LFwiYnJvd3NlclwiOjI0LFwiZXZlbnRNYW5hZ2VyXCI6NDIsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJoZWxwZXJzL2RvbS9ldmVudFwiOjQ4LFwiaGVscGVycy9vYmplY3RcIjo1M31dLDEyNzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgTm9kZVN0cnVjdHVyZToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gTm9kZVN0cnVjdHVyZTtcbiAgICB9fSxcbiAgTGlua2VkTGlzdDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gTGlua2VkTGlzdDtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fO1xudmFyIEhhbmRzb250YWJsZSA9ICgkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gPSBfZGVyZXFfKFwiYnJvd3NlclwiKSwgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9ffSkuZGVmYXVsdDtcbnZhciBOb2RlU3RydWN0dXJlID0gZnVuY3Rpb24gTm9kZVN0cnVjdHVyZShkYXRhKSB7XG4gIHRoaXMuZGF0YSA9IGRhdGE7XG4gIHRoaXMubmV4dCA9IG51bGw7XG4gIHRoaXMucHJldiA9IG51bGw7XG59O1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoTm9kZVN0cnVjdHVyZSwge30sIHt9KTtcbnZhciBMaW5rZWRMaXN0ID0gZnVuY3Rpb24gTGlua2VkTGlzdCgpIHtcbiAgdGhpcy5maXJzdCA9IG51bGw7XG4gIHRoaXMubGFzdCA9IG51bGw7XG59O1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoTGlua2VkTGlzdCwge1xuICBwdXNoOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgdmFyIG5vZGUgPSBuZXcgTm9kZVN0cnVjdHVyZShkYXRhKTtcbiAgICBpZiAodGhpcy5maXJzdCA9PT0gbnVsbCkge1xuICAgICAgdGhpcy5maXJzdCA9IHRoaXMubGFzdCA9IG5vZGU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciB0ZW1wID0gdGhpcy5sYXN0O1xuICAgICAgdGhpcy5sYXN0ID0gbm9kZTtcbiAgICAgIG5vZGUucHJldiA9IHRlbXA7XG4gICAgICB0ZW1wLm5leHQgPSBub2RlO1xuICAgIH1cbiAgfSxcbiAgdW5zaGlmdDogZnVuY3Rpb24oZGF0YSkge1xuICAgIHZhciBub2RlID0gbmV3IE5vZGVTdHJ1Y3R1cmUoZGF0YSk7XG4gICAgaWYgKHRoaXMuZmlyc3QgPT09IG51bGwpIHtcbiAgICAgIHRoaXMuZmlyc3QgPSB0aGlzLmxhc3QgPSBub2RlO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgdGVtcCA9IHRoaXMuZmlyc3Q7XG4gICAgICB0aGlzLmZpcnN0ID0gbm9kZTtcbiAgICAgIG5vZGUubmV4dCA9IHRlbXA7XG4gICAgICB0ZW1wLnByZXYgPSBub2RlO1xuICAgIH1cbiAgfSxcbiAgaW5vcmRlcjogZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICB2YXIgdGVtcCA9IHRoaXMuZmlyc3Q7XG4gICAgd2hpbGUgKHRlbXApIHtcbiAgICAgIGNhbGxiYWNrKHRlbXApO1xuICAgICAgdGVtcCA9IHRlbXAubmV4dDtcbiAgICB9XG4gIH0sXG4gIHJlbW92ZTogZnVuY3Rpb24oZGF0YSkge1xuICAgIGlmICh0aGlzLmZpcnN0ID09PSBudWxsKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciB0ZW1wID0gdGhpcy5maXJzdDtcbiAgICB2YXIgbmV4dDtcbiAgICB2YXIgcHJldjtcbiAgICB3aGlsZSAodGVtcCkge1xuICAgICAgaWYgKHRlbXAuZGF0YSA9PT0gZGF0YSkge1xuICAgICAgICBuZXh0ID0gdGVtcC5uZXh0O1xuICAgICAgICBwcmV2ID0gdGVtcC5wcmV2O1xuICAgICAgICBpZiAobmV4dCkge1xuICAgICAgICAgIG5leHQucHJldiA9IHByZXY7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHByZXYpIHtcbiAgICAgICAgICBwcmV2Lm5leHQgPSBuZXh0O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0ZW1wID09PSB0aGlzLmZpcnN0KSB7XG4gICAgICAgICAgdGhpcy5maXJzdCA9IG5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRlbXAgPT09IHRoaXMubGFzdCkge1xuICAgICAgICAgIHRoaXMubGFzdCA9IHByZXY7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICB0ZW1wID0gdGVtcC5uZXh0O1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG4gIGhhc0N5Y2xlOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgZmFzdCA9IHRoaXMuZmlyc3Q7XG4gICAgdmFyIHNsb3cgPSB0aGlzLmZpcnN0O1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICBpZiAoZmFzdCA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBmYXN0ID0gZmFzdC5uZXh0O1xuICAgICAgaWYgKGZhc3QgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgZmFzdCA9IGZhc3QubmV4dDtcbiAgICAgIHNsb3cgPSBzbG93Lm5leHQ7XG4gICAgICBpZiAoZmFzdCA9PT0gc2xvdykge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIHBvcDogZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMubGFzdCA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciB0ZW1wID0gdGhpcy5sYXN0O1xuICAgIHRoaXMubGFzdCA9IHRoaXMubGFzdC5wcmV2O1xuICAgIHJldHVybiB0ZW1wO1xuICB9LFxuICBzaGlmdDogZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuZmlyc3QgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgdGVtcCA9IHRoaXMuZmlyc3Q7XG4gICAgdGhpcy5maXJzdCA9IHRoaXMuZmlyc3QubmV4dDtcbiAgICByZXR1cm4gdGVtcDtcbiAgfSxcbiAgcmVjdXJzaXZlUmV2ZXJzZTogZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gaW52ZXJzZShjdXJyZW50LCBuZXh0KSB7XG4gICAgICBpZiAoIW5leHQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaW52ZXJzZShuZXh0LCBuZXh0Lm5leHQpO1xuICAgICAgbmV4dC5uZXh0ID0gY3VycmVudDtcbiAgICB9XG4gICAgaWYgKCF0aGlzLmZpcnN0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGludmVyc2UodGhpcy5maXJzdCwgdGhpcy5maXJzdC5uZXh0KTtcbiAgICB0aGlzLmZpcnN0Lm5leHQgPSBudWxsO1xuICAgIHZhciB0ZW1wID0gdGhpcy5maXJzdDtcbiAgICB0aGlzLmZpcnN0ID0gdGhpcy5sYXN0O1xuICAgIHRoaXMubGFzdCA9IHRlbXA7XG4gIH0sXG4gIHJldmVyc2U6IGZ1bmN0aW9uKCkge1xuICAgIGlmICghdGhpcy5maXJzdCB8fCAhdGhpcy5maXJzdC5uZXh0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBjdXJyZW50ID0gdGhpcy5maXJzdC5uZXh0O1xuICAgIHZhciBwcmV2ID0gdGhpcy5maXJzdDtcbiAgICB2YXIgdGVtcDtcbiAgICB3aGlsZSAoY3VycmVudCkge1xuICAgICAgdGVtcCA9IGN1cnJlbnQubmV4dDtcbiAgICAgIGN1cnJlbnQubmV4dCA9IHByZXY7XG4gICAgICBwcmV2LnByZXYgPSBjdXJyZW50O1xuICAgICAgcHJldiA9IGN1cnJlbnQ7XG4gICAgICBjdXJyZW50ID0gdGVtcDtcbiAgICB9XG4gICAgdGhpcy5maXJzdC5uZXh0ID0gbnVsbDtcbiAgICB0aGlzLmxhc3QucHJldiA9IG51bGw7XG4gICAgdGVtcCA9IHRoaXMuZmlyc3Q7XG4gICAgdGhpcy5maXJzdCA9IHByZXY7XG4gICAgdGhpcy5sYXN0ID0gdGVtcDtcbiAgfVxufSwge30pO1xuO1xuO1xuSGFuZHNvbnRhYmxlLnV0aWxzLk5vZGVTdHJ1Y3R1cmUgPSBOb2RlU3RydWN0dXJlO1xuSGFuZHNvbnRhYmxlLnV0aWxzLkxpbmtlZExpc3QgPSBMaW5rZWRMaXN0O1xuXG4vLyMgXG59LHtcImJyb3dzZXJcIjoyNH1dLDEyODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgR2hvc3RUYWJsZToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gR2hvc3RUYWJsZTtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X251bWJlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbWl4ZWRfXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyAmJiAkX19fNDZfXzQ2X180N19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgJF9fMSA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gPSBfZGVyZXFfKFwiaGVscGVycy9kb20vZWxlbWVudFwiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9ffSksXG4gICAgYWRkQ2xhc3MgPSAkX18xLmFkZENsYXNzLFxuICAgIG91dGVySGVpZ2h0ID0gJF9fMS5vdXRlckhlaWdodCxcbiAgICBvdXRlcldpZHRoID0gJF9fMS5vdXRlcldpZHRoO1xudmFyIGFycmF5RWFjaCA9ICgkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gPSBfZGVyZXFfKFwiaGVscGVycy9hcnJheVwiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9ffSkuYXJyYXlFYWNoO1xudmFyIG9iamVjdEVhY2ggPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL29iamVjdFwiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X29iamVjdF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfX30pLm9iamVjdEVhY2g7XG52YXIgcmFuZ2VFYWNoID0gKCRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gPSBfZGVyZXFfKFwiaGVscGVycy9udW1iZXJcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbnVtYmVyX199KS5yYW5nZUVhY2g7XG52YXIgc3RyaW5naWZ5ID0gKCRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbWl4ZWRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL21peGVkXCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX18gJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19taXhlZF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19taXhlZF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX199KS5zdHJpbmdpZnk7XG52YXIgR2hvc3RUYWJsZSA9IGZ1bmN0aW9uIEdob3N0VGFibGUoaG90SW5zdGFuY2UpIHtcbiAgdGhpcy5ob3QgPSBob3RJbnN0YW5jZTtcbiAgdGhpcy5jb250YWluZXIgPSBudWxsO1xuICB0aGlzLmluamVjdGVkID0gZmFsc2U7XG4gIHRoaXMucm93cyA9IFtdO1xuICB0aGlzLmNvbHVtbnMgPSBbXTtcbiAgdGhpcy5zYW1wbGVzID0gbnVsbDtcbiAgdGhpcy5zZXR0aW5ncyA9IHt1c2VIZWFkZXJzOiB0cnVlfTtcbn07XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShHaG9zdFRhYmxlLCB7XG4gIGFkZFJvdzogZnVuY3Rpb24ocm93LCBzYW1wbGVzKSB7XG4gICAgaWYgKHRoaXMuY29sdW1ucy5sZW5ndGgpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRG9lc25cXCd0IHN1cHBvcnQgbXVsdGktZGltZW5zaW9uYWwgdGFibGUnKTtcbiAgICB9XG4gICAgaWYgKCF0aGlzLnJvd3MubGVuZ3RoKSB7XG4gICAgICB0aGlzLmNvbnRhaW5lciA9IHRoaXMuY3JlYXRlQ29udGFpbmVyKHRoaXMuaG90LnJvb3RFbGVtZW50LmNsYXNzTmFtZSk7XG4gICAgfVxuICAgIHZhciByb3dPYmplY3QgPSB7cm93OiByb3d9O1xuICAgIHRoaXMucm93cy5wdXNoKHJvd09iamVjdCk7XG4gICAgdGhpcy5zYW1wbGVzID0gc2FtcGxlcztcbiAgICB0aGlzLnRhYmxlID0gdGhpcy5jcmVhdGVUYWJsZSh0aGlzLmhvdC50YWJsZS5jbGFzc05hbWUpO1xuICAgIHRoaXMudGFibGUuY29sR3JvdXAuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVDb2xHcm91cHNDb2woKSk7XG4gICAgdGhpcy50YWJsZS50ci5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZVJvdyhyb3cpKTtcbiAgICB0aGlzLmNvbnRhaW5lci5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy50YWJsZS5mcmFnbWVudCk7XG4gICAgcm93T2JqZWN0LnRhYmxlID0gdGhpcy50YWJsZS50YWJsZTtcbiAgfSxcbiAgYWRkQ29sdW1uSGVhZGVyc1JvdzogZnVuY3Rpb24oc2FtcGxlcykge1xuICAgIGlmICh0aGlzLmhvdC5nZXRDb2xIZWFkZXIoMCkgIT0gbnVsbCkge1xuICAgICAgdmFyIHJvd09iamVjdCA9IHtyb3c6IC0xfTtcbiAgICAgIHRoaXMucm93cy5wdXNoKHJvd09iamVjdCk7XG4gICAgICB0aGlzLmNvbnRhaW5lciA9IHRoaXMuY3JlYXRlQ29udGFpbmVyKHRoaXMuaG90LnJvb3RFbGVtZW50LmNsYXNzTmFtZSk7XG4gICAgICB0aGlzLnNhbXBsZXMgPSBzYW1wbGVzO1xuICAgICAgdGhpcy50YWJsZSA9IHRoaXMuY3JlYXRlVGFibGUodGhpcy5ob3QudGFibGUuY2xhc3NOYW1lKTtcbiAgICAgIHRoaXMudGFibGUuY29sR3JvdXAuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVDb2xHcm91cHNDb2woKSk7XG4gICAgICB0aGlzLnRhYmxlLnRIZWFkLmFwcGVuZENoaWxkKHRoaXMuY3JlYXRlQ29sdW1uSGVhZGVyc1JvdygpKTtcbiAgICAgIHRoaXMuY29udGFpbmVyLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLnRhYmxlLmZyYWdtZW50KTtcbiAgICAgIHJvd09iamVjdC50YWJsZSA9IHRoaXMudGFibGUudGFibGU7XG4gICAgfVxuICB9LFxuICBhZGRDb2x1bW46IGZ1bmN0aW9uKGNvbHVtbiwgc2FtcGxlcykge1xuICAgIGlmICh0aGlzLnJvd3MubGVuZ3RoKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0RvZXNuXFwndCBzdXBwb3J0IG11bHRpLWRpbWVuc2lvbmFsIHRhYmxlJyk7XG4gICAgfVxuICAgIGlmICghdGhpcy5jb2x1bW5zLmxlbmd0aCkge1xuICAgICAgdGhpcy5jb250YWluZXIgPSB0aGlzLmNyZWF0ZUNvbnRhaW5lcih0aGlzLmhvdC5yb290RWxlbWVudC5jbGFzc05hbWUpO1xuICAgIH1cbiAgICB2YXIgY29sdW1uT2JqZWN0ID0ge2NvbDogY29sdW1ufTtcbiAgICB0aGlzLmNvbHVtbnMucHVzaChjb2x1bW5PYmplY3QpO1xuICAgIHRoaXMuc2FtcGxlcyA9IHNhbXBsZXM7XG4gICAgdGhpcy50YWJsZSA9IHRoaXMuY3JlYXRlVGFibGUodGhpcy5ob3QudGFibGUuY2xhc3NOYW1lKTtcbiAgICBpZiAodGhpcy5nZXRTZXR0aW5nKCd1c2VIZWFkZXJzJykgJiYgdGhpcy5ob3QuZ2V0Q29sSGVhZGVyKGNvbHVtbikgIT09IG51bGwpIHtcbiAgICAgIHRoaXMuaG90LnZpZXcuYXBwZW5kQ29sSGVhZGVyKGNvbHVtbiwgdGhpcy50YWJsZS50aCk7XG4gICAgfVxuICAgIHRoaXMudGFibGUudEJvZHkuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVDb2woY29sdW1uKSk7XG4gICAgdGhpcy5jb250YWluZXIuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMudGFibGUuZnJhZ21lbnQpO1xuICAgIGNvbHVtbk9iamVjdC50YWJsZSA9IHRoaXMudGFibGUudGFibGU7XG4gIH0sXG4gIGdldEhlaWdodHM6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgaWYgKCF0aGlzLmluamVjdGVkKSB7XG4gICAgICB0aGlzLmluamVjdFRhYmxlKCk7XG4gICAgfVxuICAgIGFycmF5RWFjaCh0aGlzLnJvd3MsIChmdW5jdGlvbihyb3cpIHtcbiAgICAgIGNhbGxiYWNrKHJvdy5yb3csIG91dGVySGVpZ2h0KHJvdy50YWJsZSkgLSAxKTtcbiAgICB9KSk7XG4gIH0sXG4gIGdldFdpZHRoczogZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICBpZiAoIXRoaXMuaW5qZWN0ZWQpIHtcbiAgICAgIHRoaXMuaW5qZWN0VGFibGUoKTtcbiAgICB9XG4gICAgYXJyYXlFYWNoKHRoaXMuY29sdW1ucywgKGZ1bmN0aW9uKGNvbHVtbikge1xuICAgICAgY2FsbGJhY2soY29sdW1uLmNvbCwgb3V0ZXJXaWR0aChjb2x1bW4udGFibGUpKTtcbiAgICB9KSk7XG4gIH0sXG4gIHNldFNldHRpbmdzOiBmdW5jdGlvbihzZXR0aW5ncykge1xuICAgIHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgfSxcbiAgc2V0U2V0dGluZzogZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgICBpZiAoIXRoaXMuc2V0dGluZ3MpIHtcbiAgICAgIHRoaXMuc2V0dGluZ3MgPSB7fTtcbiAgICB9XG4gICAgdGhpcy5zZXR0aW5nc1tuYW1lXSA9IHZhbHVlO1xuICB9LFxuICBnZXRTZXR0aW5nczogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuc2V0dGluZ3M7XG4gIH0sXG4gIGdldFNldHRpbmc6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBpZiAodGhpcy5zZXR0aW5ncykge1xuICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3NbbmFtZV07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfSxcbiAgY3JlYXRlQ29sR3JvdXBzQ29sOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fNiA9IHRoaXM7XG4gICAgdmFyIGQgPSBkb2N1bWVudDtcbiAgICB2YXIgZnJhZ21lbnQgPSBkLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICBpZiAodGhpcy5ob3QuaGFzUm93SGVhZGVycygpKSB7XG4gICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZUNvbEVsZW1lbnQoLTEpKTtcbiAgICB9XG4gICAgdGhpcy5zYW1wbGVzLmZvckVhY2goKGZ1bmN0aW9uKHNhbXBsZSkge1xuICAgICAgYXJyYXlFYWNoKHNhbXBsZS5zdHJpbmdzLCAoZnVuY3Rpb24oc3RyaW5nKSB7XG4gICAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKCRfXzYuY3JlYXRlQ29sRWxlbWVudChzdHJpbmcuY29sKSk7XG4gICAgICB9KSk7XG4gICAgfSkpO1xuICAgIHJldHVybiBmcmFnbWVudDtcbiAgfSxcbiAgY3JlYXRlUm93OiBmdW5jdGlvbihyb3cpIHtcbiAgICB2YXIgJF9fNiA9IHRoaXM7XG4gICAgdmFyIGQgPSBkb2N1bWVudDtcbiAgICB2YXIgZnJhZ21lbnQgPSBkLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICB2YXIgdGggPSBkLmNyZWF0ZUVsZW1lbnQoJ3RoJyk7XG4gICAgaWYgKHRoaXMuaG90Lmhhc1Jvd0hlYWRlcnMoKSkge1xuICAgICAgdGhpcy5ob3Qudmlldy5hcHBlbmRSb3dIZWFkZXIocm93LCB0aCk7XG4gICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCh0aCk7XG4gICAgfVxuICAgIHRoaXMuc2FtcGxlcy5mb3JFYWNoKChmdW5jdGlvbihzYW1wbGUpIHtcbiAgICAgIGFycmF5RWFjaChzYW1wbGUuc3RyaW5ncywgKGZ1bmN0aW9uKHN0cmluZykge1xuICAgICAgICB2YXIgY29sdW1uID0gc3RyaW5nLmNvbDtcbiAgICAgICAgdmFyIGNlbGxQcm9wZXJ0aWVzID0gJF9fNi5ob3QuZ2V0Q2VsbE1ldGEocm93LCBjb2x1bW4pO1xuICAgICAgICBjZWxsUHJvcGVydGllcy5jb2wgPSBjb2x1bW47XG4gICAgICAgIGNlbGxQcm9wZXJ0aWVzLnJvdyA9IHJvdztcbiAgICAgICAgdmFyIHJlbmRlcmVyID0gJF9fNi5ob3QuZ2V0Q2VsbFJlbmRlcmVyKGNlbGxQcm9wZXJ0aWVzKTtcbiAgICAgICAgdmFyIHRkID0gZC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuICAgICAgICByZW5kZXJlcigkX182LmhvdCwgdGQsIHJvdywgY29sdW1uLCAkX182LmhvdC5jb2xUb1Byb3AoY29sdW1uKSwgc3RyaW5nLnZhbHVlLCBjZWxsUHJvcGVydGllcyk7XG4gICAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKHRkKTtcbiAgICAgIH0pKTtcbiAgICB9KSk7XG4gICAgcmV0dXJuIGZyYWdtZW50O1xuICB9LFxuICBjcmVhdGVDb2x1bW5IZWFkZXJzUm93OiBmdW5jdGlvbigpIHtcbiAgICB2YXIgJF9fNiA9IHRoaXM7XG4gICAgdmFyIGQgPSBkb2N1bWVudDtcbiAgICB2YXIgZnJhZ21lbnQgPSBkLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICBpZiAodGhpcy5ob3QuaGFzUm93SGVhZGVycygpKSB7XG4gICAgICB2YXIgdGggPSBkLmNyZWF0ZUVsZW1lbnQoJ3RoJyk7XG4gICAgICB0aGlzLmhvdC52aWV3LmFwcGVuZENvbEhlYWRlcigtMSwgdGgpO1xuICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQodGgpO1xuICAgIH1cbiAgICB0aGlzLnNhbXBsZXMuZm9yRWFjaCgoZnVuY3Rpb24oc2FtcGxlKSB7XG4gICAgICBhcnJheUVhY2goc2FtcGxlLnN0cmluZ3MsIChmdW5jdGlvbihzdHJpbmcpIHtcbiAgICAgICAgdmFyIGNvbHVtbiA9IHN0cmluZy5jb2w7XG4gICAgICAgIHZhciB0aCA9IGQuY3JlYXRlRWxlbWVudCgndGgnKTtcbiAgICAgICAgJF9fNi5ob3Qudmlldy5hcHBlbmRDb2xIZWFkZXIoY29sdW1uLCB0aCk7XG4gICAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKHRoKTtcbiAgICAgIH0pKTtcbiAgICB9KSk7XG4gICAgcmV0dXJuIGZyYWdtZW50O1xuICB9LFxuICBjcmVhdGVDb2w6IGZ1bmN0aW9uKGNvbHVtbikge1xuICAgIHZhciAkX182ID0gdGhpcztcbiAgICB2YXIgZCA9IGRvY3VtZW50O1xuICAgIHZhciBmcmFnbWVudCA9IGQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIHRoaXMuc2FtcGxlcy5mb3JFYWNoKChmdW5jdGlvbihzYW1wbGUpIHtcbiAgICAgIGFycmF5RWFjaChzYW1wbGUuc3RyaW5ncywgKGZ1bmN0aW9uKHN0cmluZykge1xuICAgICAgICB2YXIgcm93ID0gc3RyaW5nLnJvdztcbiAgICAgICAgdmFyIGNlbGxQcm9wZXJ0aWVzID0gJF9fNi5ob3QuZ2V0Q2VsbE1ldGEocm93LCBjb2x1bW4pO1xuICAgICAgICBjZWxsUHJvcGVydGllcy5jb2wgPSBjb2x1bW47XG4gICAgICAgIGNlbGxQcm9wZXJ0aWVzLnJvdyA9IHJvdztcbiAgICAgICAgdmFyIHJlbmRlcmVyID0gJF9fNi5ob3QuZ2V0Q2VsbFJlbmRlcmVyKGNlbGxQcm9wZXJ0aWVzKTtcbiAgICAgICAgdmFyIHRkID0gZC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuICAgICAgICB2YXIgdHIgPSBkLmNyZWF0ZUVsZW1lbnQoJ3RyJyk7XG4gICAgICAgIHJlbmRlcmVyKCRfXzYuaG90LCB0ZCwgcm93LCBjb2x1bW4sICRfXzYuaG90LmNvbFRvUHJvcChjb2x1bW4pLCBzdHJpbmcudmFsdWUsIGNlbGxQcm9wZXJ0aWVzKTtcbiAgICAgICAgdHIuYXBwZW5kQ2hpbGQodGQpO1xuICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZCh0cik7XG4gICAgICB9KSk7XG4gICAgfSkpO1xuICAgIHJldHVybiBmcmFnbWVudDtcbiAgfSxcbiAgY2xlYW46IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucm93cy5sZW5ndGggPSAwO1xuICAgIHRoaXMucm93c1stMV0gPSB2b2lkIDA7XG4gICAgdGhpcy5jb2x1bW5zLmxlbmd0aCA9IDA7XG4gICAgaWYgKHRoaXMuc2FtcGxlcykge1xuICAgICAgdGhpcy5zYW1wbGVzLmNsZWFyKCk7XG4gICAgfVxuICAgIHRoaXMuc2FtcGxlcyA9IG51bGw7XG4gICAgdGhpcy5yZW1vdmVUYWJsZSgpO1xuICB9LFxuICBpbmplY3RUYWJsZTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIHBhcmVudCA9IGFyZ3VtZW50c1swXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMF0gOiBudWxsO1xuICAgIGlmICghdGhpcy5pbmplY3RlZCkge1xuICAgICAgKHBhcmVudCB8fCB0aGlzLmhvdC5yb290RWxlbWVudCkuYXBwZW5kQ2hpbGQodGhpcy5jb250YWluZXIuZnJhZ21lbnQpO1xuICAgICAgdGhpcy5pbmplY3RlZCA9IHRydWU7XG4gICAgfVxuICB9LFxuICByZW1vdmVUYWJsZTogZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuaW5qZWN0ZWQgJiYgdGhpcy5jb250YWluZXIuY29udGFpbmVyLnBhcmVudE5vZGUpIHtcbiAgICAgIHRoaXMuY29udGFpbmVyLmNvbnRhaW5lci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuY29udGFpbmVyLmNvbnRhaW5lcik7XG4gICAgICB0aGlzLmNvbnRhaW5lciA9IG51bGw7XG4gICAgICB0aGlzLmluamVjdGVkID0gZmFsc2U7XG4gICAgfVxuICB9LFxuICBjcmVhdGVDb2xFbGVtZW50OiBmdW5jdGlvbihjb2x1bW4pIHtcbiAgICB2YXIgZCA9IGRvY3VtZW50O1xuICAgIHZhciBjb2wgPSBkLmNyZWF0ZUVsZW1lbnQoJ2NvbCcpO1xuICAgIGNvbC5zdHlsZS53aWR0aCA9IHRoaXMuaG90LnZpZXcud3Qud3RUYWJsZS5nZXRTdHJldGNoZWRDb2x1bW5XaWR0aChjb2x1bW4pICsgJ3B4JztcbiAgICByZXR1cm4gY29sO1xuICB9LFxuICBjcmVhdGVUYWJsZTogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNsYXNzTmFtZSA9IGFyZ3VtZW50c1swXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbMF0gOiAnJztcbiAgICB2YXIgZCA9IGRvY3VtZW50O1xuICAgIHZhciBmcmFnbWVudCA9IGQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIHZhciB0YWJsZSA9IGQuY3JlYXRlRWxlbWVudCgndGFibGUnKTtcbiAgICB2YXIgdEhlYWQgPSBkLmNyZWF0ZUVsZW1lbnQoJ3RoZWFkJyk7XG4gICAgdmFyIHRCb2R5ID0gZC5jcmVhdGVFbGVtZW50KCd0Ym9keScpO1xuICAgIHZhciBjb2xHcm91cCA9IGQuY3JlYXRlRWxlbWVudCgnY29sZ3JvdXAnKTtcbiAgICB2YXIgdHIgPSBkLmNyZWF0ZUVsZW1lbnQoJ3RyJyk7XG4gICAgdmFyIHRoID0gZC5jcmVhdGVFbGVtZW50KCd0aCcpO1xuICAgIGlmICh0aGlzLmlzVmVydGljYWwoKSkge1xuICAgICAgdGFibGUuYXBwZW5kQ2hpbGQoY29sR3JvdXApO1xuICAgIH1cbiAgICBpZiAodGhpcy5pc0hvcml6b250YWwoKSkge1xuICAgICAgdHIuYXBwZW5kQ2hpbGQodGgpO1xuICAgICAgdEhlYWQuYXBwZW5kQ2hpbGQodHIpO1xuICAgICAgdGFibGUuc3R5bGUudGFibGVMYXlvdXQgPSAnYXV0byc7XG4gICAgICB0YWJsZS5zdHlsZS53aWR0aCA9ICdhdXRvJztcbiAgICB9XG4gICAgdGFibGUuYXBwZW5kQ2hpbGQodEhlYWQpO1xuICAgIGlmICh0aGlzLmlzVmVydGljYWwoKSkge1xuICAgICAgdEJvZHkuYXBwZW5kQ2hpbGQodHIpO1xuICAgIH1cbiAgICB0YWJsZS5hcHBlbmRDaGlsZCh0Qm9keSk7XG4gICAgYWRkQ2xhc3ModGFibGUsIGNsYXNzTmFtZSk7XG4gICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQodGFibGUpO1xuICAgIHJldHVybiB7XG4gICAgICBmcmFnbWVudDogZnJhZ21lbnQsXG4gICAgICB0YWJsZTogdGFibGUsXG4gICAgICB0SGVhZDogdEhlYWQsXG4gICAgICB0Qm9keTogdEJvZHksXG4gICAgICBjb2xHcm91cDogY29sR3JvdXAsXG4gICAgICB0cjogdHIsXG4gICAgICB0aDogdGhcbiAgICB9O1xuICB9LFxuICBjcmVhdGVDb250YWluZXI6IGZ1bmN0aW9uKCkge1xuICAgIHZhciBjbGFzc05hbWUgPSBhcmd1bWVudHNbMF0gIT09ICh2b2lkIDApID8gYXJndW1lbnRzWzBdIDogJyc7XG4gICAgdmFyIGQgPSBkb2N1bWVudDtcbiAgICB2YXIgZnJhZ21lbnQgPSBkLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICB2YXIgY29udGFpbmVyID0gZC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjbGFzc05hbWUgPSAnaHRHaG9zdFRhYmxlIGh0QXV0b1NpemUgJyArIGNsYXNzTmFtZS50cmltKCk7XG4gICAgYWRkQ2xhc3MoY29udGFpbmVyLCBjbGFzc05hbWUpO1xuICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKGNvbnRhaW5lcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIGZyYWdtZW50OiBmcmFnbWVudCxcbiAgICAgIGNvbnRhaW5lcjogY29udGFpbmVyXG4gICAgfTtcbiAgfSxcbiAgaXNWZXJ0aWNhbDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMucm93cy5sZW5ndGggJiYgIXRoaXMuY29sdW1ucy5sZW5ndGggPyB0cnVlIDogZmFsc2U7XG4gIH0sXG4gIGlzSG9yaXpvbnRhbDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuY29sdW1ucy5sZW5ndGggJiYgIXRoaXMucm93cy5sZW5ndGggPyB0cnVlIDogZmFsc2U7XG4gIH1cbn0sIHt9KTtcbjtcbkhhbmRzb250YWJsZS51dGlscy5HaG9zdFRhYmxlID0gR2hvc3RUYWJsZTtcblxuLy8jIFxufSx7XCJicm93c2VyXCI6MjQsXCJoZWxwZXJzL2FycmF5XCI6NDMsXCJoZWxwZXJzL2RvbS9lbGVtZW50XCI6NDcsXCJoZWxwZXJzL21peGVkXCI6NTEsXCJoZWxwZXJzL251bWJlclwiOjUyLFwiaGVscGVycy9vYmplY3RcIjo1M31dLDEyOTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgSW50ZXJ2YWw6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIEludGVydmFsO1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19icm93c2VyX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19mZWF0dXJlX187XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19fNDZfXzQ2X180N19icm93c2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19icm93c2VyX199KS5kZWZhdWx0O1xudmFyICRfXzEgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19mZWF0dXJlX18gPSBfZGVyZXFfKFwiaGVscGVycy9mZWF0dXJlXCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2ZlYXR1cmVfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2ZlYXR1cmVfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZmVhdHVyZV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2ZlYXR1cmVfX30pLFxuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSA9ICRfXzEucmVxdWVzdEFuaW1hdGlvbkZyYW1lLFxuICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lID0gJF9fMS5jYW5jZWxBbmltYXRpb25GcmFtZTtcbnZhciBJbnRlcnZhbCA9IGZ1bmN0aW9uIEludGVydmFsKGZ1bmMsIGRlbGF5KSB7XG4gIHZhciAkX18yID0gdGhpcztcbiAgdGhpcy50aW1lciA9IG51bGw7XG4gIHRoaXMuZnVuYyA9IGZ1bmM7XG4gIHRoaXMuZGVsYXkgPSBwYXJzZURlbGF5KGRlbGF5KTtcbiAgdGhpcy5zdG9wcGVkID0gdHJ1ZTtcbiAgdGhpcy5fdGhlbiA9IG51bGw7XG4gIHRoaXMuX2NhbGxiYWNrID0gKGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAkX18yLl9fY2FsbGJhY2soKTtcbiAgfSk7XG59O1xudmFyICRJbnRlcnZhbCA9IEludGVydmFsO1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoSW50ZXJ2YWwsIHtcbiAgc3RhcnQ6IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLnN0b3BwZWQpIHtcbiAgICAgIHRoaXMuX3RoZW4gPSBEYXRlLm5vdygpO1xuICAgICAgdGhpcy5zdG9wcGVkID0gZmFsc2U7XG4gICAgICB0aGlzLnRpbWVyID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMuX2NhbGxiYWNrKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIHN0b3A6IGZ1bmN0aW9uKCkge1xuICAgIGlmICghdGhpcy5zdG9wcGVkKSB7XG4gICAgICB0aGlzLnN0b3BwZWQgPSB0cnVlO1xuICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy50aW1lcik7XG4gICAgICB0aGlzLnRpbWVyID0gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH0sXG4gIF9fY2FsbGJhY2s6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMudGltZXIgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5fY2FsbGJhY2spO1xuICAgIGlmICh0aGlzLmRlbGF5KSB7XG4gICAgICB2YXIgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgIHZhciBlbGFwc2VkID0gbm93IC0gdGhpcy5fdGhlbjtcbiAgICAgIGlmIChlbGFwc2VkID4gdGhpcy5kZWxheSkge1xuICAgICAgICB0aGlzLl90aGVuID0gbm93IC0gKGVsYXBzZWQgJSB0aGlzLmRlbGF5KTtcbiAgICAgICAgdGhpcy5mdW5jKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZnVuYygpO1xuICAgIH1cbiAgfVxufSwge2NyZWF0ZTogZnVuY3Rpb24oZnVuYywgZGVsYXkpIHtcbiAgICByZXR1cm4gbmV3ICRJbnRlcnZhbChmdW5jLCBkZWxheSk7XG4gIH19KTtcbjtcbmZ1bmN0aW9uIHBhcnNlRGVsYXkoZGVsYXkpIHtcbiAgaWYgKHR5cGVvZiBkZWxheSA9PT0gJ3N0cmluZycgJiYgL2ZwcyQvLnRlc3QoZGVsYXkpKSB7XG4gICAgZGVsYXkgPSAxMDAwIC8gcGFyc2VJbnQoZGVsYXkucmVwbGFjZSgnZnBzJywgJycpIHx8IDAsIDEwKTtcbiAgfVxuICByZXR1cm4gZGVsYXk7XG59XG5IYW5kc29udGFibGUudXRpbHMuSW50ZXJ2YWwgPSBJbnRlcnZhbDtcblxuLy8jIFxufSx7XCJicm93c2VyXCI6MjQsXCJoZWxwZXJzL2ZlYXR1cmVcIjo0OX1dLDEzMDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV4cG9ydHMsIHtcbiAgcmVnaXN0ZXJJZGVudGl0eToge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gcmVnaXN0ZXJJZGVudGl0eTtcbiAgICB9fSxcbiAgZ2V0VHJhbnNsYXRvcjoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZ2V0VHJhbnNsYXRvcjtcbiAgICB9fSxcbiAgX19lc01vZHVsZToge3ZhbHVlOiB0cnVlfVxufSk7XG52YXIgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X187XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19fNDZfXzQ2X180N19icm93c2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19icm93c2VyX199KS5kZWZhdWx0O1xudmFyIGlzT2JqZWN0ID0gKCRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gPSBfZGVyZXFfKFwiaGVscGVycy9vYmplY3RcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X199KS5pc09iamVjdDtcbnZhciBSZWNvcmRUcmFuc2xhdG9yID0gZnVuY3Rpb24gUmVjb3JkVHJhbnNsYXRvcihob3QpIHtcbiAgdGhpcy5ob3QgPSBob3Q7XG59O1xuKCR0cmFjZXVyUnVudGltZS5jcmVhdGVDbGFzcykoUmVjb3JkVHJhbnNsYXRvciwge1xuICB0b1Zpc3VhbFJvdzogZnVuY3Rpb24ocm93KSB7XG4gICAgcmV0dXJuIHRoaXMuaG90LnJ1bkhvb2tzKCd1bm1vZGlmeVJvdycsIHJvdyk7XG4gIH0sXG4gIHRvVmlzdWFsQ29sdW1uOiBmdW5jdGlvbihjb2x1bW4pIHtcbiAgICByZXR1cm4gdGhpcy5ob3QucnVuSG9va3MoJ3VubW9kaWZ5Q29sJywgY29sdW1uKTtcbiAgfSxcbiAgdG9WaXN1YWw6IGZ1bmN0aW9uKHJvdywgY29sdW1uKSB7XG4gICAgdmFyIHJlc3VsdDtcbiAgICBpZiAoaXNPYmplY3Qocm93KSkge1xuICAgICAgcmVzdWx0ID0ge1xuICAgICAgICByb3c6IHRoaXMudG9WaXN1YWxSb3cocm93LnJvdyksXG4gICAgICAgIGNvbHVtbjogdGhpcy50b1Zpc3VhbENvbHVtbihyb3cuY29sdW1uKVxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0ID0gW3RoaXMudG9WaXN1YWxSb3cocm93KSwgdGhpcy50b1Zpc3VhbENvbHVtbihjb2x1bW4pXTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfSxcbiAgdG9QaHlzaWNhbFJvdzogZnVuY3Rpb24ocm93KSB7XG4gICAgcmV0dXJuIHRoaXMuaG90LnJ1bkhvb2tzKCdtb2RpZnlSb3cnLCByb3cpO1xuICB9LFxuICB0b1BoeXNpY2FsQ29sdW1uOiBmdW5jdGlvbihjb2x1bW4pIHtcbiAgICByZXR1cm4gdGhpcy5ob3QucnVuSG9va3MoJ21vZGlmeUNvbCcsIGNvbHVtbik7XG4gIH0sXG4gIHRvUGh5c2ljYWw6IGZ1bmN0aW9uKHJvdywgY29sdW1uKSB7XG4gICAgdmFyIHJlc3VsdDtcbiAgICBpZiAoaXNPYmplY3Qocm93KSkge1xuICAgICAgcmVzdWx0ID0ge1xuICAgICAgICByb3c6IHRoaXMudG9QaHlzaWNhbFJvdyhyb3cucm93KSxcbiAgICAgICAgY29sdW1uOiB0aGlzLnRvUGh5c2ljYWxDb2x1bW4ocm93LmNvbHVtbilcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3VsdCA9IFt0aGlzLnRvUGh5c2ljYWxSb3cocm93KSwgdGhpcy50b1BoeXNpY2FsQ29sdW1uKGNvbHVtbildO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG59LCB7fSk7XG52YXIgaWRlbnRpdGllcyA9IG5ldyBXZWFrTWFwKCk7XG52YXIgdHJhbnNsYXRvclNpbmdsZXRvbnMgPSBuZXcgV2Vha01hcCgpO1xuZnVuY3Rpb24gcmVnaXN0ZXJJZGVudGl0eShpZGVudGl0eSwgaG90KSB7XG4gIGlkZW50aXRpZXMuc2V0KGlkZW50aXR5LCBob3QpO1xufVxuZnVuY3Rpb24gZ2V0VHJhbnNsYXRvcihpZGVudGl0eSkge1xuICB2YXIgc2luZ2xldG9uO1xuICBpZiAoIShpZGVudGl0eSBpbnN0YW5jZW9mIEhhbmRzb250YWJsZS5Db3JlKSkge1xuICAgIGlmICghaWRlbnRpdGllcy5oYXMoaWRlbnRpdHkpKSB7XG4gICAgICB0aHJvdyBFcnJvcignUmVjb3JkIHRyYW5zbGF0b3Igd2FzIG5vdCByZWdpc3RlcmVkIGZvciB0aGlzIG9iamVjdCBpZGVudGl0eScpO1xuICAgIH1cbiAgICBpZGVudGl0eSA9IGlkZW50aXRpZXMuZ2V0KGlkZW50aXR5KTtcbiAgfVxuICBpZiAodHJhbnNsYXRvclNpbmdsZXRvbnMuaGFzKGlkZW50aXR5KSkge1xuICAgIHNpbmdsZXRvbiA9IHRyYW5zbGF0b3JTaW5nbGV0b25zLmdldChpZGVudGl0eSk7XG4gIH0gZWxzZSB7XG4gICAgc2luZ2xldG9uID0gbmV3IFJlY29yZFRyYW5zbGF0b3IoaWRlbnRpdHkpO1xuICAgIHRyYW5zbGF0b3JTaW5nbGV0b25zLnNldChpZGVudGl0eSwgc2luZ2xldG9uKTtcbiAgfVxuICByZXR1cm4gc2luZ2xldG9uO1xufVxuSGFuZHNvbnRhYmxlLnV0aWxzLlJlY29yZFRyYW5zbGF0b3IgPSBSZWNvcmRUcmFuc2xhdG9yO1xuSGFuZHNvbnRhYmxlLnV0aWxzLlJlY29yZFRyYW5zbGF0b3JVdGlscyA9IHtcbiAgcmVnaXN0ZXJJZGVudGl0eTogcmVnaXN0ZXJJZGVudGl0eSxcbiAgZ2V0VHJhbnNsYXRvcjogZ2V0VHJhbnNsYXRvclxufTtcblxuLy8jIFxufSx7XCJicm93c2VyXCI6MjQsXCJoZWxwZXJzL29iamVjdFwiOjUzfV0sMTMxOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xudmFyICRfXzg7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIFNhbXBsZXNHZW5lcmF0b3I6IHtnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFNhbXBsZXNHZW5lcmF0b3I7XG4gICAgfX0sXG4gIF9fZXNNb2R1bGU6IHt2YWx1ZTogdHJ1ZX1cbn0pO1xudmFyICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyxcbiAgICAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX187XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19fNDZfXzQ2X180N19icm93c2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19icm93c2VyX199KS5kZWZhdWx0O1xudmFyICRfXzEgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kb21fNDdfZWxlbWVudF9fID0gX2RlcmVxXyhcImhlbHBlcnMvZG9tL2VsZW1lbnRcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RvbV80N19lbGVtZW50X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZG9tXzQ3X2VsZW1lbnRfX30pLFxuICAgIGFkZENsYXNzID0gJF9fMS5hZGRDbGFzcyxcbiAgICBvdXRlckhlaWdodCA9ICRfXzEub3V0ZXJIZWlnaHQsXG4gICAgb3V0ZXJXaWR0aCA9ICRfXzEub3V0ZXJXaWR0aDtcbnZhciBhcnJheUVhY2ggPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19hcnJheV9fID0gX2RlcmVxXyhcImhlbHBlcnMvYXJyYXlcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2FycmF5X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfYXJyYXlfX30pLmFycmF5RWFjaDtcbnZhciAkX18zID0gKCRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gPSBfZGVyZXFfKFwiaGVscGVycy9vYmplY3RcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19vYmplY3RfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfb2JqZWN0X199KSxcbiAgICBvYmplY3RFYWNoID0gJF9fMy5vYmplY3RFYWNoLFxuICAgIGlzT2JqZWN0ID0gJF9fMy5pc09iamVjdDtcbnZhciByYW5nZUVhY2ggPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL251bWJlclwiKSwgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X251bWJlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19udW1iZXJfX30pLnJhbmdlRWFjaDtcbnZhciBzdHJpbmdpZnkgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19taXhlZF9fID0gX2RlcmVxXyhcImhlbHBlcnMvbWl4ZWRcIiksICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbWl4ZWRfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbWl4ZWRfX30pLnN0cmluZ2lmeTtcbnZhciBTYW1wbGVzR2VuZXJhdG9yID0gZnVuY3Rpb24gU2FtcGxlc0dlbmVyYXRvcihkYXRhRmFjdG9yeSkge1xuICB0aGlzLnNhbXBsZXMgPSBudWxsO1xuICB0aGlzLmRhdGFGYWN0b3J5ID0gZGF0YUZhY3Rvcnk7XG4gIHRoaXMuY3VzdG9tU2FtcGxlQ291bnQgPSBudWxsO1xuICB0aGlzLmFsbG93RHVwbGljYXRlcyA9IGZhbHNlO1xufTtcbnZhciAkU2FtcGxlc0dlbmVyYXRvciA9IFNhbXBsZXNHZW5lcmF0b3I7XG4oJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKShTYW1wbGVzR2VuZXJhdG9yLCAoJF9fOCA9IHt9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fOCwgXCJnZXRTYW1wbGVDb3VudFwiLCB7XG4gIHZhbHVlOiBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5jdXN0b21TYW1wbGVDb3VudCkge1xuICAgICAgcmV0dXJuIHRoaXMuY3VzdG9tU2FtcGxlQ291bnQ7XG4gICAgfVxuICAgIHJldHVybiAkU2FtcGxlc0dlbmVyYXRvci5TQU1QTEVfQ09VTlQ7XG4gIH0sXG4gIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgd3JpdGFibGU6IHRydWVcbn0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fOCwgXCJzZXRTYW1wbGVDb3VudFwiLCB7XG4gIHZhbHVlOiBmdW5jdGlvbihzYW1wbGVDb3VudCkge1xuICAgIHRoaXMuY3VzdG9tU2FtcGxlQ291bnQgPSBzYW1wbGVDb3VudDtcbiAgfSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX184LCBcInNldEFsbG93RHVwbGljYXRlc1wiLCB7XG4gIHZhbHVlOiBmdW5jdGlvbihhbGxvd0R1cGxpY2F0ZXMpIHtcbiAgICB0aGlzLmFsbG93RHVwbGljYXRlcyA9IGFsbG93RHVwbGljYXRlcztcbiAgfSxcbiAgY29uZmlndXJhYmxlOiB0cnVlLFxuICBlbnVtZXJhYmxlOiB0cnVlLFxuICB3cml0YWJsZTogdHJ1ZVxufSksIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSgkX184LCBcImdlbmVyYXRlUm93U2FtcGxlc1wiLCB7XG4gIHZhbHVlOiBmdW5jdGlvbihyb3dSYW5nZSwgY29sUmFuZ2UpIHtcbiAgICByZXR1cm4gdGhpcy5nZW5lcmF0ZVNhbXBsZXMoJ3JvdycsIGNvbFJhbmdlLCByb3dSYW5nZSk7XG4gIH0sXG4gIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgd3JpdGFibGU6IHRydWVcbn0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fOCwgXCJnZW5lcmF0ZUNvbHVtblNhbXBsZXNcIiwge1xuICB2YWx1ZTogZnVuY3Rpb24oY29sUmFuZ2UsIHJvd1JhbmdlKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVTYW1wbGVzKCdjb2wnLCByb3dSYW5nZSwgY29sUmFuZ2UpO1xuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzgsIFwiZ2VuZXJhdGVTYW1wbGVzXCIsIHtcbiAgdmFsdWU6IGZ1bmN0aW9uKHR5cGUsIHJhbmdlLCBzcGVjaWZpZXJSYW5nZSkge1xuICAgIHZhciAkX182ID0gdGhpcztcbiAgICB2YXIgc2FtcGxlcyA9IG5ldyBNYXAoKTtcbiAgICBpZiAodHlwZW9mIHNwZWNpZmllclJhbmdlID09PSAnbnVtYmVyJykge1xuICAgICAgc3BlY2lmaWVyUmFuZ2UgPSB7XG4gICAgICAgIGZyb206IHNwZWNpZmllclJhbmdlLFxuICAgICAgICB0bzogc3BlY2lmaWVyUmFuZ2VcbiAgICAgIH07XG4gICAgfVxuICAgIHJhbmdlRWFjaChzcGVjaWZpZXJSYW5nZS5mcm9tLCBzcGVjaWZpZXJSYW5nZS50bywgKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICB2YXIgc2FtcGxlID0gJF9fNi5nZW5lcmF0ZVNhbXBsZSh0eXBlLCByYW5nZSwgaW5kZXgpO1xuICAgICAgc2FtcGxlcy5zZXQoaW5kZXgsIHNhbXBsZSk7XG4gICAgfSkpO1xuICAgIHJldHVybiBzYW1wbGVzO1xuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzgsIFwiZ2VuZXJhdGVTYW1wbGVcIiwge1xuICB2YWx1ZTogZnVuY3Rpb24odHlwZSwgcmFuZ2UsIHNwZWNpZmllclZhbHVlKSB7XG4gICAgdmFyICRfXzYgPSB0aGlzO1xuICAgIHZhciBzYW1wbGVzID0gbmV3IE1hcCgpO1xuICAgIHZhciBzYW1wbGVkVmFsdWVzID0gW107XG4gICAgdmFyIGxlbmd0aDtcbiAgICByYW5nZUVhY2gocmFuZ2UuZnJvbSwgcmFuZ2UudG8sIChmdW5jdGlvbihpbmRleCkge1xuICAgICAgdmFyICRfXzg7XG4gICAgICB2YXIgdmFsdWU7XG4gICAgICBpZiAodHlwZSA9PT0gJ3JvdycpIHtcbiAgICAgICAgdmFsdWUgPSAkX182LmRhdGFGYWN0b3J5KHNwZWNpZmllclZhbHVlLCBpbmRleCk7XG4gICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdjb2wnKSB7XG4gICAgICAgIHZhbHVlID0gJF9fNi5kYXRhRmFjdG9yeShpbmRleCwgc3BlY2lmaWVyVmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbnN1cHBvcnRlZCBzYW1wbGUgdHlwZScpO1xuICAgICAgfVxuICAgICAgaWYgKGlzT2JqZWN0KHZhbHVlKSkge1xuICAgICAgICBsZW5ndGggPSBPYmplY3Qua2V5cyh2YWx1ZSkubGVuZ3RoO1xuICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICBsZW5ndGggPSB2YWx1ZS5sZW5ndGg7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsZW5ndGggPSBzdHJpbmdpZnkodmFsdWUpLmxlbmd0aDtcbiAgICAgIH1cbiAgICAgIGlmICghc2FtcGxlcy5oYXMobGVuZ3RoKSkge1xuICAgICAgICBzYW1wbGVzLnNldChsZW5ndGgsIHtcbiAgICAgICAgICBuZWVkZWQ6ICRfXzYuZ2V0U2FtcGxlQ291bnQoKSxcbiAgICAgICAgICBzdHJpbmdzOiBbXVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHZhciBzYW1wbGUgPSBzYW1wbGVzLmdldChsZW5ndGgpO1xuICAgICAgaWYgKHNhbXBsZS5uZWVkZWQpIHtcbiAgICAgICAgdmFyIGR1cGxpY2F0ZSA9IHNhbXBsZWRWYWx1ZXMuaW5kZXhPZih2YWx1ZSkgPiAtMTtcbiAgICAgICAgaWYgKCFkdXBsaWNhdGUgfHwgJF9fNi5hbGxvd0R1cGxpY2F0ZXMpIHtcbiAgICAgICAgICB2YXIgY29tcHV0ZWRLZXkgPSB0eXBlID09PSAncm93JyA/ICdjb2wnIDogJ3Jvdyc7XG4gICAgICAgICAgc2FtcGxlLnN0cmluZ3MucHVzaCgoJF9fOCA9IHt9LCBPYmplY3QuZGVmaW5lUHJvcGVydHkoJF9fOCwgXCJ2YWx1ZVwiLCB7XG4gICAgICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWVcbiAgICAgICAgICB9KSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KCRfXzgsIGNvbXB1dGVkS2V5LCB7XG4gICAgICAgICAgICB2YWx1ZTogaW5kZXgsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWVcbiAgICAgICAgICB9KSwgJF9fOCkpO1xuICAgICAgICAgIHNhbXBsZWRWYWx1ZXMucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgc2FtcGxlLm5lZWRlZC0tO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSkpO1xuICAgIHJldHVybiBzYW1wbGVzO1xuICB9LFxuICBjb25maWd1cmFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHdyaXRhYmxlOiB0cnVlXG59KSwgJF9fOCksIHtnZXQgU0FNUExFX0NPVU5UKCkge1xuICAgIHJldHVybiAzO1xuICB9fSk7XG47XG5IYW5kc29udGFibGUudXRpbHMuU2FtcGxlc0dlbmVyYXRvciA9IFNhbXBsZXNHZW5lcmF0b3I7XG5cbi8vIyBcbn0se1wiYnJvd3NlclwiOjI0LFwiaGVscGVycy9hcnJheVwiOjQzLFwiaGVscGVycy9kb20vZWxlbWVudFwiOjQ3LFwiaGVscGVycy9taXhlZFwiOjUxLFwiaGVscGVycy9udW1iZXJcIjo1MixcImhlbHBlcnMvb2JqZWN0XCI6NTN9XSwxMzI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhleHBvcnRzLCB7XG4gIG1lcmdlU29ydDoge2dldDogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbWVyZ2VTb3J0O1xuICAgIH19LFxuICBfX2VzTW9kdWxlOiB7dmFsdWU6IHRydWV9XG59KTtcbnZhciAkX19fNDZfXzQ2X180N19kYXRhU3RydWN0dXJlc180N19saW5rZWRMaXN0X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fO1xudmFyIExpbmtlZExpc3QgPSAoJF9fXzQ2X180Nl9fNDdfZGF0YVN0cnVjdHVyZXNfNDdfbGlua2VkTGlzdF9fID0gX2RlcmVxXyhcIi4uL2RhdGFTdHJ1Y3R1cmVzL2xpbmtlZExpc3RcIiksICRfX180Nl9fNDZfXzQ3X2RhdGFTdHJ1Y3R1cmVzXzQ3X2xpbmtlZExpc3RfXyAmJiAkX19fNDZfXzQ2X180N19kYXRhU3RydWN0dXJlc180N19saW5rZWRMaXN0X18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19kYXRhU3RydWN0dXJlc180N19saW5rZWRMaXN0X18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2RhdGFTdHJ1Y3R1cmVzXzQ3X2xpbmtlZExpc3RfX30pLkxpbmtlZExpc3Q7XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX180Nl9fNDZfXzQ3X180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfXzQ2X180Nl9fNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19fNDZfXzQ2X180N19icm93c2VyX199KS5kZWZhdWx0O1xudmFyIGRlZmF1bHRDb21wYXJlRnVuY3Rpb24gPSBmdW5jdGlvbihhLCBiKSB7XG4gIHZhciBmaXJzdFZhbHVlID0gYS50b1N0cmluZygpO1xuICB2YXIgc2Vjb25kVmFsdWUgPSBiLnRvU3RyaW5nKCk7XG4gIGlmIChmaXJzdFZhbHVlID09PSBzZWNvbmRWYWx1ZSkge1xuICAgIHJldHVybiAwO1xuICB9IGVsc2UgaWYgKGZpcnN0VmFsdWUgPCBzZWNvbmRWYWx1ZSkge1xuICAgIHJldHVybiAtMTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gMTtcbiAgfVxufTtcbmZ1bmN0aW9uIG1lcmdlU29ydChhcnJheSkge1xuICB2YXIgY29tcGFyZUZ1bmN0aW9uID0gYXJndW1lbnRzWzFdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1sxXSA6IGRlZmF1bHRDb21wYXJlRnVuY3Rpb247XG4gIHZhciBzdGFydEluZGV4ID0gYXJndW1lbnRzWzJdICE9PSAodm9pZCAwKSA/IGFyZ3VtZW50c1syXSA6IDA7XG4gIHZhciBlbmRJbmRleCA9IGFyZ3VtZW50c1szXSAhPT0gKHZvaWQgMCkgPyBhcmd1bWVudHNbM10gOiBhcnJheS5sZW5ndGg7XG4gIGlmIChNYXRoLmFicyhlbmRJbmRleCAtIHN0YXJ0SW5kZXgpIDw9IDEpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgdmFyIG1pZGRsZUluZGV4ID0gTWF0aC5jZWlsKChzdGFydEluZGV4ICsgZW5kSW5kZXgpIC8gMik7XG4gIG1lcmdlU29ydChhcnJheSwgY29tcGFyZUZ1bmN0aW9uLCBzdGFydEluZGV4LCBtaWRkbGVJbmRleCk7XG4gIG1lcmdlU29ydChhcnJheSwgY29tcGFyZUZ1bmN0aW9uLCBtaWRkbGVJbmRleCwgZW5kSW5kZXgpO1xuICByZXR1cm4gbWVyZ2UoYXJyYXksIGNvbXBhcmVGdW5jdGlvbiwgc3RhcnRJbmRleCwgbWlkZGxlSW5kZXgsIGVuZEluZGV4KTtcbn1cbmZ1bmN0aW9uIG1lcmdlKGFycmF5LCBjb21wYXJlRnVuY3Rpb24sIHN0YXJ0SW5kZXgsIG1pZGRsZUluZGV4LCBlbmRJbmRleCkge1xuICB2YXIgbGVmdEVsZW1lbnRzID0gbmV3IExpbmtlZExpc3QoKTtcbiAgdmFyIHJpZ2h0RWxlbWVudHMgPSBuZXcgTGlua2VkTGlzdCgpO1xuICB2YXIgbGVmdFNpemUgPSBtaWRkbGVJbmRleCAtIHN0YXJ0SW5kZXg7XG4gIHZhciByaWdodFNpemUgPSBlbmRJbmRleCAtIG1pZGRsZUluZGV4O1xuICB2YXIgbWF4U2l6ZSA9IE1hdGgubWF4KGxlZnRTaXplLCByaWdodFNpemUpO1xuICB2YXIgc2l6ZSA9IGVuZEluZGV4IC0gc3RhcnRJbmRleDtcbiAgZm9yICh2YXIgaSRfXzIgPSAwOyBpJF9fMiA8IG1heFNpemU7IGkkX18yICs9IDEpIHtcbiAgICBpZiAoaSRfXzIgPCBsZWZ0U2l6ZSkge1xuICAgICAgbGVmdEVsZW1lbnRzLnB1c2goYXJyYXlbc3RhcnRJbmRleCArIGkkX18yXSk7XG4gICAgfVxuICAgIGlmIChpJF9fMiA8IHJpZ2h0U2l6ZSkge1xuICAgICAgcmlnaHRFbGVtZW50cy5wdXNoKGFycmF5W21pZGRsZUluZGV4ICsgaSRfXzJdKTtcbiAgICB9XG4gIH1cbiAgdmFyIGkgPSAwO1xuICB3aGlsZSAoaSA8IHNpemUpIHtcbiAgICBpZiAobGVmdEVsZW1lbnRzLmZpcnN0ICYmIHJpZ2h0RWxlbWVudHMuZmlyc3QpIHtcbiAgICAgIGlmIChjb21wYXJlRnVuY3Rpb24obGVmdEVsZW1lbnRzLmZpcnN0LmRhdGEsIHJpZ2h0RWxlbWVudHMuZmlyc3QuZGF0YSkgPiAwKSB7XG4gICAgICAgIGFycmF5W3N0YXJ0SW5kZXggKyBpXSA9IHJpZ2h0RWxlbWVudHMuc2hpZnQoKS5kYXRhO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXJyYXlbc3RhcnRJbmRleCArIGldID0gbGVmdEVsZW1lbnRzLnNoaWZ0KCkuZGF0YTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGxlZnRFbGVtZW50cy5maXJzdCkge1xuICAgICAgYXJyYXlbc3RhcnRJbmRleCArIGldID0gbGVmdEVsZW1lbnRzLnNoaWZ0KCkuZGF0YTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXJyYXlbc3RhcnRJbmRleCArIGldID0gcmlnaHRFbGVtZW50cy5zaGlmdCgpLmRhdGE7XG4gICAgfVxuICAgIGkgKz0gMTtcbiAgfVxuICByZXR1cm4gYXJyYXk7XG59XG47XG5IYW5kc29udGFibGUudXRpbHMubWVyZ2VTb3J0ID0gbWVyZ2VTb3J0O1xuXG4vLyMgXG59LHtcIi4uL2RhdGFTdHJ1Y3R1cmVzL2xpbmtlZExpc3RcIjoxMjcsXCJicm93c2VyXCI6MjR9XSwxMzM6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLFxuICAgICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbWl4ZWRfXztcbnZhciBIYW5kc29udGFibGUgPSAoJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fID0gX2RlcmVxXyhcImJyb3dzZXJcIiksICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyAmJiAkX19fNDZfXzQ2X180N19icm93c2VyX18uX19lc01vZHVsZSAmJiAkX19fNDZfXzQ2X180N19icm93c2VyX18gfHwge2RlZmF1bHQ6ICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfX30pLmRlZmF1bHQ7XG52YXIgc3RyaW5naWZ5ID0gKCRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfbWl4ZWRfXyA9IF9kZXJlcV8oXCJoZWxwZXJzL21peGVkXCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX18gJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19taXhlZF9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19taXhlZF9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X21peGVkX199KS5zdHJpbmdpZnk7XG5IYW5kc29udGFibGUuQXV0b2NvbXBsZXRlVmFsaWRhdG9yID0gZnVuY3Rpb24odmFsdWUsIGNhbGxiYWNrKSB7XG4gIGlmICh2YWx1ZSA9PSBudWxsKSB7XG4gICAgdmFsdWUgPSAnJztcbiAgfVxuICBpZiAodGhpcy5hbGxvd0VtcHR5ICYmIHZhbHVlID09PSAnJykge1xuICAgIGNhbGxiYWNrKHRydWUpO1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAodGhpcy5zdHJpY3QgJiYgdGhpcy5zb3VyY2UpIHtcbiAgICBpZiAodHlwZW9mIHRoaXMuc291cmNlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICB0aGlzLnNvdXJjZSh2YWx1ZSwgcHJvY2Vzcyh2YWx1ZSwgY2FsbGJhY2spKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcHJvY2Vzcyh2YWx1ZSwgY2FsbGJhY2spKHRoaXMuc291cmNlKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgY2FsbGJhY2sodHJ1ZSk7XG4gIH1cbn07XG5mdW5jdGlvbiBwcm9jZXNzKHZhbHVlLCBjYWxsYmFjaykge1xuICB2YXIgb3JpZ2luYWxWYWwgPSB2YWx1ZTtcbiAgcmV0dXJuIGZ1bmN0aW9uKHNvdXJjZSkge1xuICAgIHZhciBmb3VuZCA9IGZhbHNlO1xuICAgIGZvciAodmFyIHMgPSAwLFxuICAgICAgICBzbGVuID0gc291cmNlLmxlbmd0aDsgcyA8IHNsZW47IHMrKykge1xuICAgICAgaWYgKG9yaWdpbmFsVmFsID09PSBzb3VyY2Vbc10pIHtcbiAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgY2FsbGJhY2soZm91bmQpO1xuICB9O1xufVxuXG4vLyMgXG59LHtcImJyb3dzZXJcIjoyNCxcImhlbHBlcnMvbWl4ZWRcIjo1MX1dLDEzNDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbnZhciAkX19fNDZfXzQ2X180N19icm93c2VyX18sXG4gICAgJF9fbW9tZW50X18sXG4gICAgJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kYXRlX18sXG4gICAgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fO1xudmFyIEhhbmRzb250YWJsZSA9ICgkX19fNDZfXzQ2X180N19icm93c2VyX18gPSBfZGVyZXFfKFwiYnJvd3NlclwiKSwgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9ffSkuZGVmYXVsdDtcbnZhciBtb21lbnQgPSAoJF9fbW9tZW50X18gPSBfZGVyZXFfKFwibW9tZW50XCIpLCAkX19tb21lbnRfXyAmJiAkX19tb21lbnRfXy5fX2VzTW9kdWxlICYmICRfX21vbWVudF9fIHx8IHtkZWZhdWx0OiAkX19tb21lbnRfX30pLmRlZmF1bHQ7XG52YXIgZ2V0Tm9ybWFsaXplZERhdGUgPSAoJF9fXzQ2X180Nl9fNDdfaGVscGVyc180N19kYXRlX18gPSBfZGVyZXFfKFwiLi4vaGVscGVycy9kYXRlXCIpLCAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RhdGVfXyAmJiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RhdGVfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2hlbHBlcnNfNDdfZGF0ZV9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19oZWxwZXJzXzQ3X2RhdGVfX30pLmdldE5vcm1hbGl6ZWREYXRlO1xudmFyIGdldEVkaXRvciA9ICgkX19fNDZfXzQ2X180N19lZGl0b3JzX18gPSBfZGVyZXFfKFwiZWRpdG9yc1wiKSwgJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19fICYmICRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2VkaXRvcnNfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfZWRpdG9yc19ffSkuZ2V0RWRpdG9yO1xuSGFuZHNvbnRhYmxlLkRhdGVWYWxpZGF0b3IgPSBmdW5jdGlvbih2YWx1ZSwgY2FsbGJhY2spIHtcbiAgdmFyIHZhbGlkID0gdHJ1ZTtcbiAgdmFyIGRhdGVFZGl0b3IgPSBnZXRFZGl0b3IoJ2RhdGUnLCB0aGlzLmluc3RhbmNlKTtcbiAgaWYgKHZhbHVlID09IG51bGwpIHtcbiAgICB2YWx1ZSA9ICcnO1xuICB9XG4gIHZhciBpc1ZhbGlkRGF0ZSA9IG1vbWVudChuZXcgRGF0ZSh2YWx1ZSkpLmlzVmFsaWQoKSB8fCBtb21lbnQodmFsdWUsIGRhdGVFZGl0b3IuZGVmYXVsdERhdGVGb3JtYXQpLmlzVmFsaWQoKTtcbiAgdmFyIGlzVmFsaWRGb3JtYXQgPSBtb21lbnQodmFsdWUsIHRoaXMuZGF0ZUZvcm1hdCB8fCBkYXRlRWRpdG9yLmRlZmF1bHREYXRlRm9ybWF0LCB0cnVlKS5pc1ZhbGlkKCk7XG4gIGlmICh0aGlzLmFsbG93RW1wdHkgJiYgdmFsdWUgPT09ICcnKSB7XG4gICAgaXNWYWxpZERhdGUgPSB0cnVlO1xuICAgIGlzVmFsaWRGb3JtYXQgPSB0cnVlO1xuICB9XG4gIGlmICghaXNWYWxpZERhdGUpIHtcbiAgICB2YWxpZCA9IGZhbHNlO1xuICB9XG4gIGlmICghaXNWYWxpZERhdGUgJiYgaXNWYWxpZEZvcm1hdCkge1xuICAgIHZhbGlkID0gdHJ1ZTtcbiAgfVxuICBpZiAoaXNWYWxpZERhdGUgJiYgIWlzVmFsaWRGb3JtYXQpIHtcbiAgICBpZiAodGhpcy5jb3JyZWN0Rm9ybWF0ID09PSB0cnVlKSB7XG4gICAgICB2YXIgY29ycmVjdGVkVmFsdWUgPSBjb3JyZWN0Rm9ybWF0KHZhbHVlLCB0aGlzLmRhdGVGb3JtYXQpO1xuICAgICAgdmFyIHJvdyA9IHRoaXMuaW5zdGFuY2UucnVuSG9va3MoJ3VubW9kaWZ5Um93JywgdGhpcy5yb3cpO1xuICAgICAgdmFyIGNvbHVtbiA9IHRoaXMuaW5zdGFuY2UucnVuSG9va3MoJ3VubW9kaWZ5Q29sJywgdGhpcy5jb2wpO1xuICAgICAgdGhpcy5pbnN0YW5jZS5zZXREYXRhQXRDZWxsKHJvdywgY29sdW1uLCBjb3JyZWN0ZWRWYWx1ZSwgJ2RhdGVWYWxpZGF0b3InKTtcbiAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsaWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cbiAgY2FsbGJhY2sodmFsaWQpO1xufTtcbnZhciBjb3JyZWN0Rm9ybWF0ID0gZnVuY3Rpb24gY29ycmVjdEZvcm1hdCh2YWx1ZSwgZGF0ZUZvcm1hdCkge1xuICB2YXIgZGF0ZUZyb21EYXRlID0gbW9tZW50KGdldE5vcm1hbGl6ZWREYXRlKHZhbHVlKSk7XG4gIHZhciBkYXRlRnJvbU1vbWVudCA9IG1vbWVudCh2YWx1ZSwgZGF0ZUZvcm1hdCk7XG4gIHZhciBpc0FscGhhbnVtZXJpYyA9IHZhbHVlLnNlYXJjaCgvW0Etel0vZykgPiAtMTtcbiAgdmFyIGRhdGU7XG4gIGlmICgoZGF0ZUZyb21EYXRlLmlzVmFsaWQoKSAmJiBkYXRlRnJvbURhdGUuZm9ybWF0KCd4JykgPT09IGRhdGVGcm9tTW9tZW50LmZvcm1hdCgneCcpKSB8fCAhZGF0ZUZyb21Nb21lbnQuaXNWYWxpZCgpIHx8IGlzQWxwaGFudW1lcmljKSB7XG4gICAgZGF0ZSA9IGRhdGVGcm9tRGF0ZTtcbiAgfSBlbHNlIHtcbiAgICBkYXRlID0gZGF0ZUZyb21Nb21lbnQ7XG4gIH1cbiAgcmV0dXJuIGRhdGUuZm9ybWF0KGRhdGVGb3JtYXQpO1xufTtcblxuLy8jIFxufSx7XCIuLi9oZWxwZXJzL2RhdGVcIjo0NixcImJyb3dzZXJcIjoyNCxcImVkaXRvcnNcIjozMCxcIm1vbWVudFwiOlwibW9tZW50XCJ9XSwxMzU6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fO1xudmFyIEhhbmRzb250YWJsZSA9ICgkX19fNDZfXzQ2X180N19icm93c2VyX18gPSBfZGVyZXFfKFwiYnJvd3NlclwiKSwgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fICYmICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXy5fX2VzTW9kdWxlICYmICRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyB8fCB7ZGVmYXVsdDogJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9ffSkuZGVmYXVsdDtcbkhhbmRzb250YWJsZS5OdW1lcmljVmFsaWRhdG9yID0gZnVuY3Rpb24odmFsdWUsIGNhbGxiYWNrKSB7XG4gIGlmICh2YWx1ZSA9PSBudWxsKSB7XG4gICAgdmFsdWUgPSAnJztcbiAgfVxuICBpZiAodGhpcy5hbGxvd0VtcHR5ICYmIHZhbHVlID09PSAnJykge1xuICAgIGNhbGxiYWNrKHRydWUpO1xuICB9IGVsc2UgaWYgKHZhbHVlID09PSAnJykge1xuICAgIGNhbGxiYWNrKGZhbHNlKTtcbiAgfSBlbHNlIHtcbiAgICBjYWxsYmFjaygvXi0/XFxkKihcXC58XFwsKT9cXGQqJC8udGVzdCh2YWx1ZSkpO1xuICB9XG59O1xuXG4vLyMgXG59LHtcImJyb3dzZXJcIjoyNH1dLDEzNjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcbnZhciAkX19fNDZfXzQ2X180N19icm93c2VyX18sXG4gICAgJF9fbW9tZW50X187XG52YXIgSGFuZHNvbnRhYmxlID0gKCRfX180Nl9fNDZfXzQ3X2Jyb3dzZXJfXyA9IF9kZXJlcV8oXCJicm93c2VyXCIpLCAkX19fNDZfXzQ2X180N19icm93c2VyX18gJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fLl9fZXNNb2R1bGUgJiYgJF9fXzQ2X180Nl9fNDdfYnJvd3Nlcl9fIHx8IHtkZWZhdWx0OiAkX19fNDZfXzQ2X180N19icm93c2VyX199KS5kZWZhdWx0O1xudmFyIG1vbWVudCA9ICgkX19tb21lbnRfXyA9IF9kZXJlcV8oXCJtb21lbnRcIiksICRfX21vbWVudF9fICYmICRfX21vbWVudF9fLl9fZXNNb2R1bGUgJiYgJF9fbW9tZW50X18gfHwge2RlZmF1bHQ6ICRfX21vbWVudF9ffSkuZGVmYXVsdDtcbnZhciBTVFJJQ1RfRk9STUFUUyA9IFsnWVlZWS1NTS1ERFRISDptbTpzcy5TU1NaJywgJ1gnLCAneCddO1xuSGFuZHNvbnRhYmxlLlRpbWVWYWxpZGF0b3IgPSBmdW5jdGlvbih2YWx1ZSwgY2FsbGJhY2spIHtcbiAgdmFyIHZhbGlkID0gdHJ1ZTtcbiAgdmFyIHRpbWVGb3JtYXQgPSB0aGlzLnRpbWVGb3JtYXQgfHwgJ2g6bW06c3MgYSc7XG4gIGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuICAgIHZhbHVlID0gJyc7XG4gIH1cbiAgdmFsdWUgPSAvXlxcZHszLH0kLy50ZXN0KHZhbHVlKSA/IHBhcnNlSW50KHZhbHVlLCAxMCkgOiB2YWx1ZTtcbiAgdmFyIHR3b0RpZ2l0VmFsdWUgPSAvXlxcZHsxLDJ9JC8udGVzdCh2YWx1ZSk7XG4gIGlmICh0d29EaWdpdFZhbHVlKSB7XG4gICAgdmFsdWUgPSB2YWx1ZSArICc6MDAnO1xuICB9XG4gIHZhciBkYXRlID0gbW9tZW50KHZhbHVlLCBTVFJJQ1RfRk9STUFUUywgdHJ1ZSkuaXNWYWxpZCgpID8gbW9tZW50KHZhbHVlKSA6IG1vbWVudCh2YWx1ZSwgdGltZUZvcm1hdCk7XG4gIHZhciBpc1ZhbGlkVGltZSA9IGRhdGUuaXNWYWxpZCgpO1xuICB2YXIgaXNWYWxpZEZvcm1hdCA9IG1vbWVudCh2YWx1ZSwgdGltZUZvcm1hdCwgdHJ1ZSkuaXNWYWxpZCgpICYmICF0d29EaWdpdFZhbHVlO1xuICBpZiAodGhpcy5hbGxvd0VtcHR5ICYmIHZhbHVlID09PSAnJykge1xuICAgIGlzVmFsaWRUaW1lID0gdHJ1ZTtcbiAgICBpc1ZhbGlkRm9ybWF0ID0gdHJ1ZTtcbiAgfVxuICBpZiAoIWlzVmFsaWRUaW1lKSB7XG4gICAgdmFsaWQgPSBmYWxzZTtcbiAgfVxuICBpZiAoIWlzVmFsaWRUaW1lICYmIGlzVmFsaWRGb3JtYXQpIHtcbiAgICB2YWxpZCA9IHRydWU7XG4gIH1cbiAgaWYgKGlzVmFsaWRUaW1lICYmICFpc1ZhbGlkRm9ybWF0KSB7XG4gICAgaWYgKHRoaXMuY29ycmVjdEZvcm1hdCA9PT0gdHJ1ZSkge1xuICAgICAgdmFyIGNvcnJlY3RlZFZhbHVlID0gZGF0ZS5mb3JtYXQodGltZUZvcm1hdCk7XG4gICAgICB2YXIgcm93ID0gdGhpcy5pbnN0YW5jZS5ydW5Ib29rcygndW5tb2RpZnlSb3cnLCB0aGlzLnJvdyk7XG4gICAgICB2YXIgY29sdW1uID0gdGhpcy5pbnN0YW5jZS5ydW5Ib29rcygndW5tb2RpZnlDb2wnLCB0aGlzLmNvbCk7XG4gICAgICB0aGlzLmluc3RhbmNlLnNldERhdGFBdENlbGwocm93LCBjb2x1bW4sIGNvcnJlY3RlZFZhbHVlLCAndGltZVZhbGlkYXRvcicpO1xuICAgICAgdmFsaWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWxpZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuICBjYWxsYmFjayh2YWxpZCk7XG59O1xuXG4vLyMgXG59LHtcImJyb3dzZXJcIjoyNCxcIm1vbWVudFwiOlwibW9tZW50XCJ9XSxcIlNoZWV0Q2xpcFwiOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbi8qKlxuICogU2hlZXRDbGlwIC0gU3ByZWFkc2hlZXQgQ2xpcGJvYXJkIFBhcnNlclxuICogdmVyc2lvbiAwLjJcbiAqXG4gKiBUaGlzIHRpbnkgbGlicmFyeSB0cmFuc2Zvcm1zIEphdmFTY3JpcHQgYXJyYXlzIHRvIHN0cmluZ3MgdGhhdCBhcmUgcGFzdGVhYmxlIGJ5IExpYnJlT2ZmaWNlLCBPcGVuT2ZmaWNlLFxuICogR29vZ2xlIERvY3MgYW5kIE1pY3Jvc29mdCBFeGNlbC5cbiAqXG4gKiBDb3B5cmlnaHQgMjAxMiwgTWFyY2luIFdhcnBlY2hvd3NraVxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuICogaHR0cDovL2dpdGh1Yi5jb20vd2FycGVjaC9zaGVldGNsaXAvXG4gKi9cbi8qanNsaW50IHdoaXRlOiB0cnVlKi9cbihmdW5jdGlvbiAoZ2xvYmFsKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIGZ1bmN0aW9uIGNvdW50UXVvdGVzKHN0cikge1xuICAgIHJldHVybiBzdHIuc3BsaXQoJ1wiJykubGVuZ3RoIC0gMTtcbiAgfVxuXG4gIHZhciBTaGVldENsaXAgPSB7XG4gICAgLyoqXG4gICAgICogRGVjb2RlIHNwcmVhZHNoZWV0IHN0cmluZyBpbnRvIGFycmF5XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gc3RyXG4gICAgICogQHJldHVybnMge0FycmF5fVxuICAgICAqL1xuICAgIHBhcnNlOiBmdW5jdGlvbiAoc3RyKSB7XG4gICAgICB2YXIgciwgckxlbiwgcm93cywgYXJyID0gW10sIGEgPSAwLCBjLCBjTGVuLCBtdWx0aWxpbmUsIGxhc3Q7XG5cbiAgICAgIHJvd3MgPSBzdHIuc3BsaXQoJ1xcbicpO1xuXG4gICAgICBpZiAocm93cy5sZW5ndGggPiAxICYmIHJvd3Nbcm93cy5sZW5ndGggLSAxXSA9PT0gJycpIHtcbiAgICAgICAgcm93cy5wb3AoKTtcbiAgICAgIH1cbiAgICAgIGZvciAociA9IDAsIHJMZW4gPSByb3dzLmxlbmd0aDsgciA8IHJMZW47IHIgKz0gMSkge1xuICAgICAgICByb3dzW3JdID0gcm93c1tyXS5zcGxpdCgnXFx0Jyk7XG5cbiAgICAgICAgZm9yIChjID0gMCwgY0xlbiA9IHJvd3Nbcl0ubGVuZ3RoOyBjIDwgY0xlbjsgYyArPSAxKSB7XG4gICAgICAgICAgaWYgKCFhcnJbYV0pIHtcbiAgICAgICAgICAgIGFyclthXSA9IFtdO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobXVsdGlsaW5lICYmIGMgPT09IDApIHtcbiAgICAgICAgICAgIGxhc3QgPSBhcnJbYV0ubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIGFyclthXVtsYXN0XSA9IGFyclthXVtsYXN0XSArICdcXG4nICsgcm93c1tyXVswXTtcblxuICAgICAgICAgICAgaWYgKG11bHRpbGluZSAmJiAoY291bnRRdW90ZXMocm93c1tyXVswXSkgJiAxKSkgeyAvLyYgMSBpcyBhIGJpdHdpc2Ugd2F5IG9mIHBlcmZvcm1pbmcgbW9kIDJcbiAgICAgICAgICAgICAgbXVsdGlsaW5lID0gZmFsc2U7XG4gICAgICAgICAgICAgIGFyclthXVtsYXN0XSA9IGFyclthXVtsYXN0XS5zdWJzdHJpbmcoMCwgYXJyW2FdW2xhc3RdLmxlbmd0aCAtIDEpLnJlcGxhY2UoL1wiXCIvZywgJ1wiJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGMgPT09IGNMZW4gLSAxICYmIHJvd3Nbcl1bY10uaW5kZXhPZignXCInKSA9PT0gMCAmJiAoY291bnRRdW90ZXMocm93c1tyXVtjXSkgJiAxKSkge1xuICAgICAgICAgICAgICBhcnJbYV0ucHVzaChyb3dzW3JdW2NdLnN1YnN0cmluZygxKS5yZXBsYWNlKC9cIlwiL2csICdcIicpKTtcbiAgICAgICAgICAgICAgbXVsdGlsaW5lID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICBhcnJbYV0ucHVzaChyb3dzW3JdW2NdLnJlcGxhY2UoL1wiXCIvZywgJ1wiJykpO1xuICAgICAgICAgICAgICBtdWx0aWxpbmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFtdWx0aWxpbmUpIHtcbiAgICAgICAgICBhICs9IDE7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGFycjtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogRW5jb2RlIGFycmF5IGludG8gdmFsaWQgc3ByZWFkc2hlZXQgc3RyaW5nXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYXJyXG4gICAgICogQHJldHVybnMge1N0cmluZ31cbiAgICAgKi9cbiAgICBzdHJpbmdpZnk6IGZ1bmN0aW9uIChhcnIpIHtcbiAgICAgIHZhciByLCByTGVuLCBjLCBjTGVuLCBzdHIgPSAnJywgdmFsO1xuXG4gICAgICBmb3IgKHIgPSAwLCByTGVuID0gYXJyLmxlbmd0aDsgciA8IHJMZW47IHIgKz0gMSkge1xuICAgICAgICBjTGVuID0gYXJyW3JdLmxlbmd0aDtcblxuICAgICAgICBmb3IgKGMgPSAwOyBjIDwgY0xlbjsgYyArPSAxKSB7XG4gICAgICAgICAgaWYgKGMgPiAwKSB7XG4gICAgICAgICAgICBzdHIgKz0gJ1xcdCc7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhbCA9IGFycltyXVtjXTtcblxuICAgICAgICAgIGlmICh0eXBlb2YgdmFsID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgaWYgKHZhbC5pbmRleE9mKCdcXG4nKSA+IC0xKSB7XG4gICAgICAgICAgICAgIHN0ciArPSAnXCInICsgdmFsLnJlcGxhY2UoL1wiL2csICdcIlwiJykgKyAnXCInO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgIHN0ciArPSB2YWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKHZhbCA9PT0gbnVsbCB8fCB2YWwgPT09IHZvaWQgMCkgeyAvLyB2b2lkIDAgcmVzb2x2ZXMgdG8gdW5kZWZpbmVkXG4gICAgICAgICAgICBzdHIgKz0gJyc7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3RyICs9IHZhbDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc3RyICs9ICdcXG4nO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gc3RyO1xuICAgIH1cbiAgfTtcblxuICBpZiAodHlwZW9mIGV4cG9ydHMgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgZXhwb3J0cy5wYXJzZSA9IFNoZWV0Q2xpcC5wYXJzZTtcbiAgICBleHBvcnRzLnN0cmluZ2lmeSA9IFNoZWV0Q2xpcC5zdHJpbmdpZnk7XG4gIH0gZWxzZSB7XG4gICAgZ2xvYmFsLlNoZWV0Q2xpcCA9IFNoZWV0Q2xpcDtcbiAgfVxufSh3aW5kb3cpKTtcblxufSx7fV0sXCJhdXRvUmVzaXplXCI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuLyoqXG4gKiBhdXRvUmVzaXplIC0gcmVzaXplcyBhIERPTSBlbGVtZW50IHRvIHRoZSB3aWR0aCBhbmQgaGVpZ2h0IG9mIGFub3RoZXIgRE9NIGVsZW1lbnRcbiAqXG4gKiBDb3B5cmlnaHQgMjAxNCwgTWFyY2luIFdhcnBlY2hvd3NraVxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlXG4gKi9cblxuXG5mdW5jdGlvbiBhdXRvUmVzaXplKCkge1xuICB2YXIgZGVmYXVsdHMgPSB7XG4gICAgICBtaW5IZWlnaHQ6IDIwMCxcbiAgICAgIG1heEhlaWdodDogMzAwLFxuICAgICAgbWluV2lkdGg6IDEwMCxcbiAgICAgIG1heFdpZHRoOiAzMDBcbiAgICB9LFxuICAgIGVsLFxuICAgIGJvZHkgPSBkb2N1bWVudC5ib2R5LFxuICAgIHRleHQgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnJyksXG4gICAgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ1NQQU4nKSxcbiAgICBvYnNlcnZlID0gZnVuY3Rpb24gKGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyKSB7XG4gICAgICBpZiAod2luZG93LmF0dGFjaEV2ZW50KSB7XG4gICAgICAgIGVsZW1lbnQuYXR0YWNoRXZlbnQoJ29uJyArIGV2ZW50LCBoYW5kbGVyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgZmFsc2UpO1xuICAgICAgfVxuICAgIH0sXG4gICAgdW5PYnNlcnZlID0gZnVuY3Rpb24gKGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyKSB7XG4gICAgICBpZiAod2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBmYWxzZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlbGVtZW50LmRldGFjaEV2ZW50KCdvbicgKyBldmVudCwgaGFuZGxlcik7XG4gICAgICB9XG4gICAgfSxcbiAgICByZXNpemUgPSBmdW5jdGlvbiAobmV3Q2hhcikge1xuICAgICAgdmFyIHdpZHRoLCBzY3JvbGxIZWlnaHQ7XG5cbiAgICAgIGlmICghbmV3Q2hhcikge1xuICAgICAgICBuZXdDaGFyID0gXCJcIjtcbiAgICAgIH0gZWxzZSBpZiAoIS9eW2EtekEtWiBcXC4sXFxcXFxcL1xcfDAtOV0kLy50ZXN0KG5ld0NoYXIpKSB7XG4gICAgICAgIG5ld0NoYXIgPSBcIi5cIjtcbiAgICAgIH1cblxuICAgICAgaWYgKHRleHQudGV4dENvbnRlbnQgIT09IHZvaWQgMCkge1xuICAgICAgICB0ZXh0LnRleHRDb250ZW50ID0gZWwudmFsdWUgKyBuZXdDaGFyO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHRleHQuZGF0YSA9IGVsLnZhbHVlICsgbmV3Q2hhcjsgLy9JRThcbiAgICAgIH1cbiAgICAgIHNwYW4uc3R5bGUuZm9udFNpemUgPSBnZXRDb21wdXRlZFN0eWxlKGVsKS5mb250U2l6ZTtcbiAgICAgIHNwYW4uc3R5bGUuZm9udEZhbWlseSA9IGdldENvbXB1dGVkU3R5bGUoZWwpLmZvbnRGYW1pbHk7XG4gICAgICBzcGFuLnN0eWxlLndoaXRlU3BhY2UgPSBcInByZVwiO1xuXG4gICAgICBib2R5LmFwcGVuZENoaWxkKHNwYW4pO1xuICAgICAgd2lkdGggPSBzcGFuLmNsaWVudFdpZHRoICsgMjtcbiAgICAgIGJvZHkucmVtb3ZlQ2hpbGQoc3Bhbik7XG5cbiAgICAgIGVsLnN0eWxlLmhlaWdodCA9IGRlZmF1bHRzLm1pbkhlaWdodCArICdweCc7XG5cbiAgICAgIGlmIChkZWZhdWx0cy5taW5XaWR0aCA+IHdpZHRoKSB7XG4gICAgICAgIGVsLnN0eWxlLndpZHRoID0gZGVmYXVsdHMubWluV2lkdGggKyAncHgnO1xuXG4gICAgICB9IGVsc2UgaWYgKHdpZHRoID4gZGVmYXVsdHMubWF4V2lkdGgpIHtcbiAgICAgICAgZWwuc3R5bGUud2lkdGggPSBkZWZhdWx0cy5tYXhXaWR0aCArICdweCc7XG5cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVsLnN0eWxlLndpZHRoID0gd2lkdGggKyAncHgnO1xuICAgICAgfVxuICAgICAgc2Nyb2xsSGVpZ2h0ID0gZWwuc2Nyb2xsSGVpZ2h0ID8gZWwuc2Nyb2xsSGVpZ2h0IC0gMSA6IDA7XG5cbiAgICAgIGlmIChkZWZhdWx0cy5taW5IZWlnaHQgPiBzY3JvbGxIZWlnaHQpIHtcbiAgICAgICAgZWwuc3R5bGUuaGVpZ2h0ID0gZGVmYXVsdHMubWluSGVpZ2h0ICsgJ3B4JztcblxuICAgICAgfSBlbHNlIGlmIChkZWZhdWx0cy5tYXhIZWlnaHQgPCBzY3JvbGxIZWlnaHQpIHtcbiAgICAgICAgZWwuc3R5bGUuaGVpZ2h0ID0gZGVmYXVsdHMubWF4SGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgZWwuc3R5bGUub3ZlcmZsb3dZID0gJ3Zpc2libGUnO1xuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlbC5zdHlsZS5oZWlnaHQgPSBzY3JvbGxIZWlnaHQgKyAncHgnO1xuICAgICAgfVxuICAgIH0sXG4gICAgZGVsYXllZFJlc2l6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KHJlc2l6ZSwgMCk7XG4gICAgfSxcbiAgICBleHRlbmREZWZhdWx0cyA9IGZ1bmN0aW9uIChjb25maWcpIHtcblxuICAgICAgaWYgKGNvbmZpZyAmJiBjb25maWcubWluSGVpZ2h0KSB7XG4gICAgICAgIGlmIChjb25maWcubWluSGVpZ2h0ID09ICdpbmhlcml0Jykge1xuICAgICAgICAgIGRlZmF1bHRzLm1pbkhlaWdodCA9IGVsLmNsaWVudEhlaWdodDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgbWluSGVpZ2h0ID0gcGFyc2VJbnQoY29uZmlnLm1pbkhlaWdodCk7XG4gICAgICAgICAgaWYgKCFpc05hTihtaW5IZWlnaHQpKSB7XG4gICAgICAgICAgICBkZWZhdWx0cy5taW5IZWlnaHQgPSBtaW5IZWlnaHQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChjb25maWcgJiYgY29uZmlnLm1heEhlaWdodCkge1xuICAgICAgICBpZiAoY29uZmlnLm1heEhlaWdodCA9PSAnaW5oZXJpdCcpIHtcbiAgICAgICAgICBkZWZhdWx0cy5tYXhIZWlnaHQgPSBlbC5jbGllbnRIZWlnaHQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIG1heEhlaWdodCA9IHBhcnNlSW50KGNvbmZpZy5tYXhIZWlnaHQpO1xuICAgICAgICAgIGlmICghaXNOYU4obWF4SGVpZ2h0KSkge1xuICAgICAgICAgICAgZGVmYXVsdHMubWF4SGVpZ2h0ID0gbWF4SGVpZ2h0O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoY29uZmlnICYmIGNvbmZpZy5taW5XaWR0aCkge1xuICAgICAgICBpZiAoY29uZmlnLm1pbldpZHRoID09ICdpbmhlcml0Jykge1xuICAgICAgICAgIGRlZmF1bHRzLm1pbldpZHRoID0gZWwuY2xpZW50V2lkdGg7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIG1pbldpZHRoID0gcGFyc2VJbnQoY29uZmlnLm1pbldpZHRoKTtcbiAgICAgICAgICBpZiAoIWlzTmFOKG1pbldpZHRoKSkge1xuICAgICAgICAgICAgZGVmYXVsdHMubWluV2lkdGggPSBtaW5XaWR0aDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGNvbmZpZyAmJiBjb25maWcubWF4V2lkdGgpIHtcbiAgICAgICAgaWYgKGNvbmZpZy5tYXhXaWR0aCA9PSAnaW5oZXJpdCcpIHtcbiAgICAgICAgICBkZWZhdWx0cy5tYXhXaWR0aCA9IGVsLmNsaWVudFdpZHRoO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBtYXhXaWR0aCA9IHBhcnNlSW50KGNvbmZpZy5tYXhXaWR0aCk7XG4gICAgICAgICAgaWYgKCFpc05hTihtYXhXaWR0aCkpIHtcbiAgICAgICAgICAgIGRlZmF1bHRzLm1heFdpZHRoID0gbWF4V2lkdGg7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmKCFzcGFuLmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgc3Bhbi5jbGFzc05hbWUgPSBcImF1dG9SZXNpemVcIjtcbiAgICAgICAgc3Bhbi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7XG4gICAgICAgIHNwYW4uYXBwZW5kQ2hpbGQodGV4dCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBpbml0ID0gZnVuY3Rpb24gKGVsXywgY29uZmlnLCBkb09ic2VydmUpIHtcbiAgICAgIGVsID0gZWxfO1xuICAgICAgZXh0ZW5kRGVmYXVsdHMoY29uZmlnKTtcblxuICAgICAgaWYgKGVsLm5vZGVOYW1lID09ICdURVhUQVJFQScpIHtcblxuICAgICAgICBlbC5zdHlsZS5yZXNpemUgPSAnbm9uZSc7XG4gICAgICAgIGVsLnN0eWxlLm92ZXJmbG93WSA9ICcnO1xuICAgICAgICBlbC5zdHlsZS5oZWlnaHQgPSBkZWZhdWx0cy5taW5IZWlnaHQgKyAncHgnO1xuICAgICAgICBlbC5zdHlsZS5taW5XaWR0aCA9IGRlZmF1bHRzLm1pbldpZHRoICsgJ3B4JztcbiAgICAgICAgZWwuc3R5bGUubWF4V2lkdGggPSBkZWZhdWx0cy5tYXhXaWR0aCArICdweCc7XG4gICAgICAgIGVsLnN0eWxlLm92ZXJmbG93WSA9ICdoaWRkZW4nO1xuICAgICAgfVxuXG4gICAgICBpZihkb09ic2VydmUpIHtcbiAgICAgICAgb2JzZXJ2ZShlbCwgJ2NoYW5nZScsIHJlc2l6ZSk7XG4gICAgICAgIG9ic2VydmUoZWwsICdjdXQnLCBkZWxheWVkUmVzaXplKTtcbiAgICAgICAgb2JzZXJ2ZShlbCwgJ3Bhc3RlJywgZGVsYXllZFJlc2l6ZSk7XG4gICAgICAgIG9ic2VydmUoZWwsICdkcm9wJywgZGVsYXllZFJlc2l6ZSk7XG4gICAgICAgIG9ic2VydmUoZWwsICdrZXlkb3duJywgZGVsYXllZFJlc2l6ZSk7XG4gICAgICAgIG9ic2VydmUoZWwsICdmb2N1cycsIHJlc2l6ZSk7XG4gICAgICB9XG5cbiAgICAgIHJlc2l6ZSgpO1xuICAgIH07XG5cbiAgZnVuY3Rpb24gZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQuY3VycmVudFN0eWxlIHx8IGRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGluaXQ6IGZ1bmN0aW9uIChlbF8sIGNvbmZpZywgZG9PYnNlcnZlKSB7XG4gICAgICBpbml0KGVsXywgY29uZmlnLCBkb09ic2VydmUpO1xuICAgIH0sXG4gICAgdW5PYnNlcnZlOiBmdW5jdGlvbiAoKSB7XG4gICAgICB1bk9ic2VydmUoZWwsICdjaGFuZ2UnLCByZXNpemUpO1xuICAgICAgdW5PYnNlcnZlKGVsLCAnY3V0JywgZGVsYXllZFJlc2l6ZSk7XG4gICAgICB1bk9ic2VydmUoZWwsICdwYXN0ZScsIGRlbGF5ZWRSZXNpemUpO1xuICAgICAgdW5PYnNlcnZlKGVsLCAnZHJvcCcsIGRlbGF5ZWRSZXNpemUpO1xuICAgICAgdW5PYnNlcnZlKGVsLCAna2V5ZG93bicsIGRlbGF5ZWRSZXNpemUpO1xuICAgICAgdW5PYnNlcnZlKGVsLCAnZm9jdXMnLCByZXNpemUpO1xuICAgIH0sXG4gICAgcmVzaXplOiByZXNpemVcbiAgfTtcbn1cblxuaWYgKHR5cGVvZiBleHBvcnRzICE9PSAndW5kZWZpbmVkJykge1xuICBtb2R1bGUuZXhwb3J0cyA9IGF1dG9SZXNpemU7XG59XG5cbn0se31dLFwiY29weVBhc3RlXCI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuLyoqXG4gKiBDcmVhdGVzIGEgdGV4dGFyZWEgdGhhdCBzdGF5cyBoaWRkZW4gb24gdGhlIHBhZ2UgYW5kIGdldHMgZm9jdXNlZCB3aGVuIHVzZXIgcHJlc3NlcyBDVFJMIHdoaWxlIG5vdCBoYXZpbmcgYSBmb3JtXG4gKiBpbnB1dCBmb2N1c2VkLlxuICogSW4gZnV0dXJlIHdlIG1heSBpbXBsZW1lbnQgYSBiZXR0ZXIgZHJpdmVyIHdoZW4gYmV0dGVyIEFQSXMgYXJlIGF2YWlsYWJsZS5cbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqIEBwcml2YXRlXG4gKi9cblxudmFyIGluc3RhbmNlO1xuXG5mdW5jdGlvbiBjb3B5UGFzdGUoKSB7XG4gIGlmICghaW5zdGFuY2UpIHtcbiAgICBpbnN0YW5jZSA9IG5ldyBDb3B5UGFzdGVDbGFzcygpO1xuXG4gIH0gZWxzZSBpZiAoaW5zdGFuY2UuaGFzQmVlbkRlc3Ryb3llZCgpKXtcbiAgICBpbnN0YW5jZS5pbml0KCk7XG4gIH1cbiAgaW5zdGFuY2UucmVmQ291bnRlcisrO1xuXG4gIHJldHVybiBpbnN0YW5jZTtcbn1cblxuaWYgKHR5cGVvZiBleHBvcnRzICE9PSAndW5kZWZpbmVkJykge1xuICBtb2R1bGUuZXhwb3J0cyA9IGNvcHlQYXN0ZTtcbn1cblxuZnVuY3Rpb24gQ29weVBhc3RlQ2xhc3MoKSB7XG4gIHRoaXMucmVmQ291bnRlciA9IDA7XG4gIHRoaXMuaW5pdCgpO1xufVxuXG5Db3B5UGFzdGVDbGFzcy5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyXG4gICAgc3R5bGUsXG4gICAgcGFyZW50O1xuXG4gIHRoaXMuY29weUNhbGxiYWNrcyA9IFtdO1xuICB0aGlzLmN1dENhbGxiYWNrcyA9IFtdO1xuICB0aGlzLnBhc3RlQ2FsbGJhY2tzID0gW107XG5cbiAgLy8gdGhpcy5saXN0ZW5lckVsZW1lbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XG4gIHBhcmVudCA9IGRvY3VtZW50LmJvZHk7XG5cbiAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdDb3B5UGFzdGVEaXYnKSkge1xuICAgIHRoaXMuZWxEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnQ29weVBhc3RlRGl2Jyk7XG4gICAgdGhpcy5lbFRleHRhcmVhID0gdGhpcy5lbERpdi5maXJzdENoaWxkO1xuXG4gIH0gZWxzZSB7XG4gICAgdGhpcy5lbERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRoaXMuZWxEaXYuaWQgPSAnQ29weVBhc3RlRGl2JztcbiAgICBzdHlsZSA9IHRoaXMuZWxEaXYuc3R5bGU7XG4gICAgc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnO1xuICAgIHN0eWxlLnRvcCA9ICctMTAwMDBweCc7XG4gICAgc3R5bGUubGVmdCA9ICctMTAwMDBweCc7XG4gICAgcGFyZW50LmFwcGVuZENoaWxkKHRoaXMuZWxEaXYpO1xuXG4gICAgdGhpcy5lbFRleHRhcmVhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGV4dGFyZWEnKTtcbiAgICB0aGlzLmVsVGV4dGFyZWEuY2xhc3NOYW1lID0gJ2NvcHlQYXN0ZSc7XG4gICAgdGhpcy5lbFRleHRhcmVhLm9ucGFzdGUgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgdmFyIGNsaXBib2FyZENvbnRlbnRzLFxuICAgICAgICB0ZW1wO1xuXG4gICAgICBpZiAoJ1dlYmtpdEFwcGVhcmFuY2UnIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZSkgeyAvLyBjaHJvbWUgYW5kIHNhZmFyaVxuICAgICAgICBjbGlwYm9hcmRDb250ZW50cyA9IGV2ZW50LmNsaXBib2FyZERhdGEuZ2V0RGF0YShcIlRleHRcIik7XG5cbiAgICAgICAgLy8gU2FmYXJpIGFkZHMgYW4gYWRkaXRpb25hbCBuZXdsaW5lIHRvIGNvcGllZCB0ZXh0XG4gICAgICAgIGlmIChuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ1NhZmFyaScpICE9PSAtMSAmJiBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ0Nocm9tZScpID09PSAtMSkge1xuICAgICAgICAgIHRlbXAgPSBjbGlwYm9hcmRDb250ZW50cy5zcGxpdCgnXFxuJyk7XG5cbiAgICAgICAgICBpZiAodGVtcFt0ZW1wLmxlbmd0aCAtIDFdID09PSAnJykge1xuICAgICAgICAgICAgdGVtcC5wb3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2xpcGJvYXJkQ29udGVudHMgPSB0ZW1wLmpvaW4oJ1xcbicpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudmFsdWUgPSBjbGlwYm9hcmRDb250ZW50cztcblxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfVxuICAgIH07XG4gICAgc3R5bGUgPSB0aGlzLmVsVGV4dGFyZWEuc3R5bGU7XG4gICAgc3R5bGUud2lkdGggPSAnMTAwMDBweCc7XG4gICAgc3R5bGUuaGVpZ2h0ID0gJzEwMDAwcHgnO1xuICAgIHN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XG4gICAgdGhpcy5lbERpdi5hcHBlbmRDaGlsZCh0aGlzLmVsVGV4dGFyZWEpO1xuXG4gICAgaWYgKHR5cGVvZiBzdHlsZS5vcGFjaXR5ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgc3R5bGUub3BhY2l0eSA9IDA7XG4gICAgfVxuICB9XG4gIHRoaXMub25LZXlEb3duUmVmID0gdGhpcy5vbktleURvd24uYmluZCh0aGlzKTtcbiAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLm9uS2V5RG93blJlZiwgZmFsc2UpO1xufTtcblxuLyoqXG4gKiBDYWxsIG1ldGhvZCBvbiBldmVyeSBrZXkgZG93biBldmVudFxuICpcbiAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gKi9cbkNvcHlQYXN0ZUNsYXNzLnByb3RvdHlwZS5vbktleURvd24gPSBmdW5jdGlvbihldmVudCkge1xuICB2YXIgX3RoaXMgPSB0aGlzLFxuICAgIGlzQ3RybERvd24gPSBmYWxzZTtcblxuICBmdW5jdGlvbiBpc0FjdGl2ZUVsZW1lbnRFZGl0YWJsZSgpIHtcbiAgICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG5cbiAgICBpZiAoZWxlbWVudC5zaGFkb3dSb290ICYmIGVsZW1lbnQuc2hhZG93Um9vdC5hY3RpdmVFbGVtZW50KSB7XG4gICAgICBlbGVtZW50ID0gZWxlbWVudC5zaGFkb3dSb290LmFjdGl2ZUVsZW1lbnQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIFsnSU5QVVQnLCAnU0VMRUNUJywgJ1RFWFRBUkVBJ10uaW5kZXhPZihlbGVtZW50Lm5vZGVOYW1lKSA+IC0xIHx8IGVsZW1lbnQuY29udGVudEVkaXRhYmxlID09PSAndHJ1ZSc7XG4gIH1cblxuICAvLyBtYWNcbiAgaWYgKGV2ZW50Lm1ldGFLZXkpIHtcbiAgICBpc0N0cmxEb3duID0gdHJ1ZTtcbiAgfVxuICAvLyBwY1xuICBlbHNlIGlmIChldmVudC5jdHJsS2V5ICYmIG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZignTWFjJykgPT09IC0xKSB7XG4gICAgaXNDdHJsRG93biA9IHRydWU7XG4gIH1cbiAgaWYgKGlzQ3RybERvd24pIHtcbiAgICAvLyB0aGlzIGlzIG5lZWRlZCBieSBmcmFnbWVudFNlbGVjdGlvbiBpbiBIYW5kc29udGFibGUuIElnbm9yZSBjb3B5cGFzdGUuanMgYmVoYXZpb3IgaWYgZnJhZ21lbnQgb2YgY2VsbCB0ZXh0IGlzIHNlbGVjdGVkXG4gICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgIT09IHRoaXMuZWxUZXh0YXJlYSAmJiAodGhpcy5nZXRTZWxlY3Rpb25UZXh0KCkgIT09ICcnIHx8IGlzQWN0aXZlRWxlbWVudEVkaXRhYmxlKCkpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuc2VsZWN0Tm9kZVRleHQodGhpcy5lbFRleHRhcmVhKTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgIT09IF90aGlzLmVsVGV4dGFyZWEpIHtcbiAgICAgICAgX3RoaXMuc2VsZWN0Tm9kZVRleHQoX3RoaXMuZWxUZXh0YXJlYSk7XG4gICAgICB9XG4gICAgfSwgMCk7XG4gIH1cblxuICBpZiAoZXZlbnQuaXNJbW1lZGlhdGVQcm9wYWdhdGlvbkVuYWJsZWQgIT09IGZhbHNlICYmIGlzQ3RybERvd24gJiZcbiAgICAgIChldmVudC5rZXlDb2RlID09PSA2NyB8fFxuICAgICAgZXZlbnQua2V5Q29kZSA9PT0gODYgfHxcbiAgICAgIGV2ZW50LmtleUNvZGUgPT09IDg4KSkge1xuICAgIC8vIHdvcmtzIGluIGFsbCBicm93c2VycywgaW5jbC4gT3BlcmEgPCAxMi4xMlxuICAgIGlmIChldmVudC5rZXlDb2RlID09PSA4OCkge1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzLnRyaWdnZXJDdXQoZXZlbnQpO1xuICAgICAgfSwgMCk7XG5cbiAgICB9IGVsc2UgaWYgKGV2ZW50LmtleUNvZGUgPT09IDg2KSB7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3RoaXMudHJpZ2dlclBhc3RlKGV2ZW50KTtcbiAgICAgIH0sIDApO1xuICAgIH1cbiAgfVxufTtcblxuLy9odHRwOi8vanNwZXJmLmNvbS90ZXh0YXJhLXNlbGVjdGlvblxuLy9odHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzE1MDIzODUvaG93LWNhbi1pLW1ha2UtdGhpcy1jb2RlLXdvcmstaW4taWVcbi8qKlxuICogU2VsZWN0IGFsbCB0ZXh0IGNvbnRhaW5zIGluIHBhc3NlZCBub2RlIGVsZW1lbnRcbiAqXG4gKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnRcbiAqL1xuQ29weVBhc3RlQ2xhc3MucHJvdG90eXBlLnNlbGVjdE5vZGVUZXh0ID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICBpZiAoZWxlbWVudCkge1xuICAgIGVsZW1lbnQuc2VsZWN0KCk7XG4gIH1cbn07XG5cbi8vaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy81Mzc5MTIwL2dldC10aGUtaGlnaGxpZ2h0ZWQtc2VsZWN0ZWQtdGV4dFxuLyoqXG4gKiBHZXQgc2VsZWN0aW9uIHRleHRcbiAqXG4gKiBAcmV0dXJucyB7U3RyaW5nfVxuICovXG5Db3B5UGFzdGVDbGFzcy5wcm90b3R5cGUuZ2V0U2VsZWN0aW9uVGV4dCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgdGV4dCA9ICcnO1xuXG4gIGlmICh3aW5kb3cuZ2V0U2VsZWN0aW9uKSB7XG4gICAgdGV4dCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpO1xuXG4gIH0gZWxzZSBpZiAoZG9jdW1lbnQuc2VsZWN0aW9uICYmIGRvY3VtZW50LnNlbGVjdGlvbi50eXBlICE9PSAnQ29udHJvbCcpIHtcbiAgICB0ZXh0ID0gZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCkudGV4dDtcbiAgfVxuXG4gIHJldHVybiB0ZXh0O1xufTtcblxuLyoqXG4gKiBNYWtlIHN0cmluZyBjb3B5YWJsZVxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBzdHJpbmdcbiAqL1xuQ29weVBhc3RlQ2xhc3MucHJvdG90eXBlLmNvcHlhYmxlID0gZnVuY3Rpb24oc3RyaW5nKSB7XG4gIGlmICh0eXBlb2Ygc3RyaW5nICE9PSAnc3RyaW5nJyAmJiBzdHJpbmcudG9TdHJpbmcgPT09IHZvaWQgMCkge1xuICAgIHRocm93IG5ldyBFcnJvcignY29weWFibGUgcmVxdWlyZXMgc3RyaW5nIHBhcmFtZXRlcicpO1xuICB9XG4gIHRoaXMuZWxUZXh0YXJlYS52YWx1ZSA9IHN0cmluZztcbiAgdGhpcy5zZWxlY3ROb2RlVGV4dCh0aGlzLmVsVGV4dGFyZWEpO1xufTtcblxuLypDb3B5UGFzdGVDbGFzcy5wcm90b3R5cGUub25Db3B5ID0gZnVuY3Rpb24gKGZuKSB7XG4gIHRoaXMuY29weUNhbGxiYWNrcy5wdXNoKGZuKTtcbn07Ki9cblxuLyoqXG4gKiBBZGQgZnVuY3Rpb24gY2FsbGJhY2sgdG8gb25DdXQgZXZlbnRcbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuICovXG5Db3B5UGFzdGVDbGFzcy5wcm90b3R5cGUub25DdXQgPSBmdW5jdGlvbihjYWxsYmFjaykge1xuICB0aGlzLmN1dENhbGxiYWNrcy5wdXNoKGNhbGxiYWNrKTtcbn07XG5cbi8qKlxuICogQWRkIGZ1bmN0aW9uIGNhbGxiYWNrIHRvIG9uUGFzdGUgZXZlbnRcbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuICovXG5Db3B5UGFzdGVDbGFzcy5wcm90b3R5cGUub25QYXN0ZSA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gIHRoaXMucGFzdGVDYWxsYmFja3MucHVzaChjYWxsYmFjayk7XG59O1xuXG4vKipcbiAqIFJlbW92ZSBjYWxsYmFjayBmcm9tIGFsbCBldmVudHNcbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuICogQHJldHVybnMge0Jvb2xlYW59XG4gKi9cbkNvcHlQYXN0ZUNsYXNzLnByb3RvdHlwZS5yZW1vdmVDYWxsYmFjayA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gIHZhciBpLCBsZW47XG5cbiAgZm9yIChpID0gMCwgbGVuID0gdGhpcy5jb3B5Q2FsbGJhY2tzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgaWYgKHRoaXMuY29weUNhbGxiYWNrc1tpXSA9PT0gY2FsbGJhY2spIHtcbiAgICAgIHRoaXMuY29weUNhbGxiYWNrcy5zcGxpY2UoaSwgMSk7XG5cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICBmb3IgKGkgPSAwLCBsZW4gPSB0aGlzLmN1dENhbGxiYWNrcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgIGlmICh0aGlzLmN1dENhbGxiYWNrc1tpXSA9PT0gY2FsbGJhY2spIHtcbiAgICAgIHRoaXMuY3V0Q2FsbGJhY2tzLnNwbGljZShpLCAxKTtcblxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIGZvciAoaSA9IDAsIGxlbiA9IHRoaXMucGFzdGVDYWxsYmFja3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICBpZiAodGhpcy5wYXN0ZUNhbGxiYWNrc1tpXSA9PT0gY2FsbGJhY2spIHtcbiAgICAgIHRoaXMucGFzdGVDYWxsYmFja3Muc3BsaWNlKGksIDEpO1xuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZmFsc2U7XG59O1xuXG4vKipcbiAqIFRyaWdnZXIgY3V0IGV2ZW50XG4gKlxuICogQHBhcmFtIHtET01FdmVudH0gZXZlbnRcbiAqL1xuQ29weVBhc3RlQ2xhc3MucHJvdG90eXBlLnRyaWdnZXJDdXQgPSBmdW5jdGlvbihldmVudCkge1xuICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gIGlmIChfdGhpcy5jdXRDYWxsYmFja3MpIHtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBfdGhpcy5jdXRDYWxsYmFja3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgX3RoaXMuY3V0Q2FsbGJhY2tzW2ldKGV2ZW50KTtcbiAgICAgIH1cbiAgICB9LCA1MCk7XG4gIH1cbn07XG5cbi8qKlxuICogVHJpZ2dlciBwYXN0ZSBldmVudFxuICpcbiAqIEBwYXJhbSB7RE9NRXZlbnR9IGV2ZW50XG4gKiBAcGFyYW0ge1N0cmluZ30gc3RyaW5nXG4gKi9cbkNvcHlQYXN0ZUNsYXNzLnByb3RvdHlwZS50cmlnZ2VyUGFzdGUgPSBmdW5jdGlvbihldmVudCwgc3RyaW5nKSB7XG4gIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgaWYgKF90aGlzLnBhc3RlQ2FsbGJhY2tzKSB7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgdmFsID0gc3RyaW5nIHx8IF90aGlzLmVsVGV4dGFyZWEudmFsdWU7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBfdGhpcy5wYXN0ZUNhbGxiYWNrcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBfdGhpcy5wYXN0ZUNhbGxiYWNrc1tpXSh2YWwsIGV2ZW50KTtcbiAgICAgIH1cbiAgICB9LCA1MCk7XG4gIH1cbn07XG5cbi8qKlxuICogRGVzdHJveSBpbnN0YW5jZVxuICovXG5Db3B5UGFzdGVDbGFzcy5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuICBpZiAoIXRoaXMuaGFzQmVlbkRlc3Ryb3llZCgpICYmIC0tdGhpcy5yZWZDb3VudGVyID09PSAwKSB7XG4gICAgaWYgKHRoaXMuZWxEaXYgJiYgdGhpcy5lbERpdi5wYXJlbnROb2RlKSB7XG4gICAgICB0aGlzLmVsRGl2LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5lbERpdik7XG4gICAgICB0aGlzLmVsRGl2ID0gbnVsbDtcbiAgICAgIHRoaXMuZWxUZXh0YXJlYSA9IG51bGw7XG4gICAgfVxuICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5vbktleURvd25SZWYpO1xuICAgIHRoaXMub25LZXlEb3duUmVmID0gbnVsbDtcbiAgfVxufTtcblxuLyoqXG4gKiBDaGVjayBpZiBpbnN0YW5jZSBoYXMgYmVlbiBkZXN0cm95ZWRcbiAqXG4gKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAqL1xuQ29weVBhc3RlQ2xhc3MucHJvdG90eXBlLmhhc0JlZW5EZXN0cm95ZWQgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuICF0aGlzLnJlZkNvdW50ZXI7XG59O1xuXG5cblxufSx7fV0sXCJlczZjb2xsZWN0aW9uc1wiOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbi8qIVxuICogQ29weXJpZ2h0IChDKSAyMDExIGJ5IEFuZHJlYSBHaWFtbWFyY2hpLCBAV2ViUmVmbGVjdGlvblxuICpcbiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbiAqIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiAqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbiAqIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuICogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbiAqXG4gKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxuICogYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4gKlxuICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksXG4gKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcbiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4gKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOXG4gKiBUSEUgU09GVFdBUkUuXG4gKi9cbihmdW5jdGlvbihleHBvcnRzKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgLy9zaGFyZWQgcG9pbnRlclxuICB2YXIgaTtcbiAgLy9zaG9ydGN1dHNcbiAgdmFyIGRlZmluZVByb3BlcnR5ID0gT2JqZWN0LmRlZmluZVByb3BlcnR5LFxuICAgIGlzID0gZnVuY3Rpb24oYSwgYikge1xuICAgICAgcmV0dXJuIGlzTmFOKGEpID8gaXNOYU4oYikgOiBhID09PSBiO1xuICAgIH07XG5cblxuICAvL1BvbHlmaWxsIGdsb2JhbCBvYmplY3RzXG4gIGlmICh0eXBlb2YgV2Vha01hcCA9PSAndW5kZWZpbmVkJykge1xuICAgIGV4cG9ydHMuV2Vha01hcCA9IGNyZWF0ZUNvbGxlY3Rpb24oe1xuICAgICAgLy8gV2Vha01hcCNkZWxldGUoa2V5OnZvaWQqKTpib29sZWFuXG4gICAgICAnZGVsZXRlJzogc2hhcmVkRGVsZXRlLFxuICAgICAgLy8gV2Vha01hcCNjbGVhcigpOlxuICAgICAgY2xlYXI6IHNoYXJlZENsZWFyLFxuICAgICAgLy8gV2Vha01hcCNnZXQoa2V5OnZvaWQqKTp2b2lkKlxuICAgICAgZ2V0OiBzaGFyZWRHZXQsXG4gICAgICAvLyBXZWFrTWFwI2hhcyhrZXk6dm9pZCopOmJvb2xlYW5cbiAgICAgIGhhczogbWFwSGFzLFxuICAgICAgLy8gV2Vha01hcCNzZXQoa2V5OnZvaWQqLCB2YWx1ZTp2b2lkKik6dm9pZFxuICAgICAgc2V0OiBzaGFyZWRTZXRcbiAgICB9LCB0cnVlKTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgTWFwID09ICd1bmRlZmluZWQnKSB7XG4gICAgZXhwb3J0cy5NYXAgPSBjcmVhdGVDb2xsZWN0aW9uKHtcbiAgICAgIC8vIFdlYWtNYXAjZGVsZXRlKGtleTp2b2lkKik6Ym9vbGVhblxuICAgICAgJ2RlbGV0ZSc6IHNoYXJlZERlbGV0ZSxcbiAgICAgIC8vOndhcyBNYXAjZ2V0KGtleTp2b2lkKlssIGQzZmF1bHQ6dm9pZCpdKTp2b2lkKlxuICAgICAgLy8gTWFwI2hhcyhrZXk6dm9pZCopOmJvb2xlYW5cbiAgICAgIGhhczogbWFwSGFzLFxuICAgICAgLy8gTWFwI2dldChrZXk6dm9pZCopOmJvb2xlYW5cbiAgICAgIGdldDogc2hhcmVkR2V0LFxuICAgICAgLy8gTWFwI3NldChrZXk6dm9pZCosIHZhbHVlOnZvaWQqKTp2b2lkXG4gICAgICBzZXQ6IHNoYXJlZFNldCxcbiAgICAgIC8vIE1hcCNrZXlzKHZvaWQpOkl0ZXJhdG9yXG4gICAgICBrZXlzOiBzaGFyZWRLZXlzLFxuICAgICAgLy8gTWFwI3ZhbHVlcyh2b2lkKTpJdGVyYXRvclxuICAgICAgdmFsdWVzOiBzaGFyZWRWYWx1ZXMsXG4gICAgICAvLyBNYXAjZW50cmllcyh2b2lkKTpJdGVyYXRvclxuICAgICAgZW50cmllczogbWFwRW50cmllcyxcbiAgICAgIC8vIE1hcCNmb3JFYWNoKGNhbGxiYWNrOkZ1bmN0aW9uLCBjb250ZXh0OnZvaWQqKTp2b2lkID09PiBjYWxsYmFjay5jYWxsKGNvbnRleHQsIGtleSwgdmFsdWUsIG1hcE9iamVjdCkgPT09IG5vdCBpbiBzcGVjc2BcbiAgICAgIGZvckVhY2g6IHNoYXJlZEZvckVhY2gsXG4gICAgICAvLyBNYXAjY2xlYXIoKTpcbiAgICAgIGNsZWFyOiBzaGFyZWRDbGVhclxuICAgIH0pO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBTZXQgPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBleHBvcnRzLlNldCA9IGNyZWF0ZUNvbGxlY3Rpb24oe1xuICAgICAgLy8gU2V0I2hhcyh2YWx1ZTp2b2lkKik6Ym9vbGVhblxuICAgICAgaGFzOiBzZXRIYXMsXG4gICAgICAvLyBTZXQjYWRkKHZhbHVlOnZvaWQqKTpib29sZWFuXG4gICAgICBhZGQ6IHNoYXJlZEFkZCxcbiAgICAgIC8vIFNldCNkZWxldGUoa2V5OnZvaWQqKTpib29sZWFuXG4gICAgICAnZGVsZXRlJzogc2hhcmVkRGVsZXRlLFxuICAgICAgLy8gU2V0I2NsZWFyKCk6XG4gICAgICBjbGVhcjogc2hhcmVkQ2xlYXIsXG4gICAgICAvLyBTZXQja2V5cyh2b2lkKTpJdGVyYXRvclxuICAgICAga2V5czogc2hhcmVkVmFsdWVzLCAvLyBzcGVjcyBhY3R1YWxseSBzYXkgXCJ0aGUgc2FtZSBmdW5jdGlvbiBvYmplY3QgYXMgdGhlIGluaXRpYWwgdmFsdWUgb2YgdGhlIHZhbHVlcyBwcm9wZXJ0eVwiXG4gICAgICAvLyBTZXQjdmFsdWVzKHZvaWQpOkl0ZXJhdG9yXG4gICAgICB2YWx1ZXM6IHNoYXJlZFZhbHVlcyxcbiAgICAgIC8vIFNldCNlbnRyaWVzKHZvaWQpOkl0ZXJhdG9yXG4gICAgICBlbnRyaWVzOiBzZXRFbnRyaWVzLFxuICAgICAgLy8gU2V0I2ZvckVhY2goY2FsbGJhY2s6RnVuY3Rpb24sIGNvbnRleHQ6dm9pZCopOnZvaWQgPT0+IGNhbGxiYWNrLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4KSA9PT0gbm90IGluIHNwZWNzXG4gICAgICBmb3JFYWNoOiBzaGFyZWRGb3JFYWNoXG4gICAgfSk7XG4gIH1cblxuICBpZiAodHlwZW9mIFdlYWtTZXQgPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBleHBvcnRzLldlYWtTZXQgPSBjcmVhdGVDb2xsZWN0aW9uKHtcbiAgICAgIC8vIFdlYWtTZXQjZGVsZXRlKGtleTp2b2lkKik6Ym9vbGVhblxuICAgICAgJ2RlbGV0ZSc6IHNoYXJlZERlbGV0ZSxcbiAgICAgIC8vIFdlYWtTZXQjYWRkKHZhbHVlOnZvaWQqKTpib29sZWFuXG4gICAgICBhZGQ6IHNoYXJlZEFkZCxcbiAgICAgIC8vIFdlYWtTZXQjY2xlYXIoKTpcbiAgICAgIGNsZWFyOiBzaGFyZWRDbGVhcixcbiAgICAgIC8vIFdlYWtTZXQjaGFzKHZhbHVlOnZvaWQqKTpib29sZWFuXG4gICAgICBoYXM6IHNldEhhc1xuICAgIH0sIHRydWUpO1xuICB9XG5cblxuICAvKipcbiAgICogRVM2IGNvbGxlY3Rpb24gY29uc3RydWN0b3JcbiAgICogQHJldHVybiB7RnVuY3Rpb259IGEgY29sbGVjdGlvbiBjbGFzc1xuICAgKi9cbiAgZnVuY3Rpb24gY3JlYXRlQ29sbGVjdGlvbihwcm90bywgb2JqZWN0T25seSkge1xuICAgIGZ1bmN0aW9uIENvbGxlY3Rpb24oYSkge1xuICAgICAgaWYgKCF0aGlzIHx8IHRoaXMuY29uc3RydWN0b3IgIT09IENvbGxlY3Rpb24pIHJldHVybiBuZXcgQ29sbGVjdGlvbihhKTtcbiAgICAgIHRoaXMuX2tleXMgPSBbXTtcbiAgICAgIHRoaXMuX3ZhbHVlcyA9IFtdO1xuICAgICAgdGhpcy5faXRwID0gW107IC8vIGl0ZXJhdGlvbiBwb2ludGVyc1xuICAgICAgdGhpcy5vYmplY3RPbmx5ID0gb2JqZWN0T25seTtcblxuICAgICAgLy9wYXJzZSBpbml0aWFsIGl0ZXJhYmxlIGFyZ3VtZW50IHBhc3NlZFxuICAgICAgaWYgKGEpIGluaXQuY2FsbCh0aGlzLCBhKTtcbiAgICB9XG5cbiAgICAvL2RlZmluZSBzaXplIGZvciBub24gb2JqZWN0LW9ubHkgY29sbGVjdGlvbnNcbiAgICBpZiAoIW9iamVjdE9ubHkpIHtcbiAgICAgIGRlZmluZVByb3BlcnR5KHByb3RvLCAnc2l6ZScsIHtcbiAgICAgICAgZ2V0OiBzaGFyZWRTaXplXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvL3NldCBwcm90b3R5cGVcbiAgICBwcm90by5jb25zdHJ1Y3RvciA9IENvbGxlY3Rpb247XG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUgPSBwcm90bztcblxuICAgIHJldHVybiBDb2xsZWN0aW9uO1xuICB9XG5cblxuICAvKiogcGFyc2UgaW5pdGlhbCBpdGVyYWJsZSBhcmd1bWVudCBwYXNzZWQgKi9cbiAgZnVuY3Rpb24gaW5pdChhKSB7XG4gICAgdmFyIGk7XG4gICAgLy9pbml0IFNldCBhcmd1bWVudCwgbGlrZSBgWzEsMiwzLHt9XWBcbiAgICBpZiAodGhpcy5hZGQpIGEuZm9yRWFjaCh0aGlzLmFkZCwgdGhpcyk7XG4gICAgLy9pbml0IE1hcCBhcmd1bWVudCBsaWtlIGBbWzEsMl0sIFt7fSwgNF1dYFxuICAgIGVsc2UgYS5mb3JFYWNoKGZ1bmN0aW9uKGEpIHtcbiAgICAgIHRoaXMuc2V0KGFbMF0sIGFbMV0pXG4gICAgfSwgdGhpcyk7XG4gIH1cblxuXG4gIC8qKiBkZWxldGUgKi9cbiAgZnVuY3Rpb24gc2hhcmVkRGVsZXRlKGtleSkge1xuICAgIGlmICh0aGlzLmhhcyhrZXkpKSB7XG4gICAgICB0aGlzLl9rZXlzLnNwbGljZShpLCAxKTtcbiAgICAgIHRoaXMuX3ZhbHVlcy5zcGxpY2UoaSwgMSk7XG4gICAgICAvLyB1cGRhdGUgaXRlcmF0aW9uIHBvaW50ZXJzXG4gICAgICB0aGlzLl9pdHAuZm9yRWFjaChmdW5jdGlvbihwKSB7XG4gICAgICAgIGlmIChpIDwgcFswXSkgcFswXS0tO1xuICAgICAgfSk7XG4gICAgfVxuICAgIC8vIEF1cm9yYSBoZXJlIGRvZXMgaXQgd2hpbGUgQ2FuYXJ5IGRvZXNuJ3RcbiAgICByZXR1cm4gLTEgPCBpO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHNoYXJlZEdldChrZXkpIHtcbiAgICByZXR1cm4gdGhpcy5oYXMoa2V5KSA/IHRoaXMuX3ZhbHVlc1tpXSA6IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhcyhsaXN0LCBrZXkpIHtcbiAgICBpZiAodGhpcy5vYmplY3RPbmx5ICYmIGtleSAhPT0gT2JqZWN0KGtleSkpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIHZhbHVlIHVzZWQgYXMgd2VhayBjb2xsZWN0aW9uIGtleVwiKTtcbiAgICAvL05hTiBvciAwIHBhc3NlZFxuICAgIGlmIChrZXkgIT0ga2V5IHx8IGtleSA9PT0gMCkgZm9yIChpID0gbGlzdC5sZW5ndGg7IGktLSAmJiAhaXMobGlzdFtpXSwga2V5KTspIHt9IGVsc2UgaSA9IGxpc3QuaW5kZXhPZihrZXkpO1xuICAgIHJldHVybiAtMSA8IGk7XG4gIH1cblxuICBmdW5jdGlvbiBzZXRIYXModmFsdWUpIHtcbiAgICByZXR1cm4gaGFzLmNhbGwodGhpcywgdGhpcy5fdmFsdWVzLCB2YWx1ZSk7XG4gIH1cblxuICBmdW5jdGlvbiBtYXBIYXModmFsdWUpIHtcbiAgICByZXR1cm4gaGFzLmNhbGwodGhpcywgdGhpcy5fa2V5cywgdmFsdWUpO1xuICB9XG5cbiAgLyoqIEBjaGFpbmFibGUgKi9cbiAgZnVuY3Rpb24gc2hhcmVkU2V0KGtleSwgdmFsdWUpIHtcbiAgICB0aGlzLmhhcyhrZXkpID8gdGhpcy5fdmFsdWVzW2ldID0gdmFsdWUgOiB0aGlzLl92YWx1ZXNbdGhpcy5fa2V5cy5wdXNoKGtleSkgLSAxXSA9IHZhbHVlO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqIEBjaGFpbmFibGUgKi9cbiAgZnVuY3Rpb24gc2hhcmVkQWRkKHZhbHVlKSB7XG4gICAgaWYgKCF0aGlzLmhhcyh2YWx1ZSkpIHRoaXMuX3ZhbHVlcy5wdXNoKHZhbHVlKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGZ1bmN0aW9uIHNoYXJlZENsZWFyKCkge1xuICAgIHRoaXMuX3ZhbHVlcy5sZW5ndGggPSAwO1xuICB9XG5cbiAgLyoqIGtleXMsIHZhbHVlcywgYW5kIGl0ZXJhdGUgcmVsYXRlZCBtZXRob2RzICovXG4gIGZ1bmN0aW9uIHNoYXJlZEtleXMoKSB7XG4gICAgcmV0dXJuIHNoYXJlZEl0ZXJhdG9yKHRoaXMuX2l0cCwgdGhpcy5fa2V5cyk7XG4gIH1cblxuICBmdW5jdGlvbiBzaGFyZWRWYWx1ZXMoKSB7XG4gICAgcmV0dXJuIHNoYXJlZEl0ZXJhdG9yKHRoaXMuX2l0cCwgdGhpcy5fdmFsdWVzKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG1hcEVudHJpZXMoKSB7XG4gICAgcmV0dXJuIHNoYXJlZEl0ZXJhdG9yKHRoaXMuX2l0cCwgdGhpcy5fa2V5cywgdGhpcy5fdmFsdWVzKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNldEVudHJpZXMoKSB7XG4gICAgcmV0dXJuIHNoYXJlZEl0ZXJhdG9yKHRoaXMuX2l0cCwgdGhpcy5fdmFsdWVzLCB0aGlzLl92YWx1ZXMpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2hhcmVkSXRlcmF0b3IoaXRwLCBhcnJheSwgYXJyYXkyKSB7XG4gICAgdmFyIHAgPSBbMF0sXG4gICAgICBkb25lID0gZmFsc2U7XG4gICAgaXRwLnB1c2gocCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5leHQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgdiwgayA9IHBbMF07XG4gICAgICAgIGlmICghZG9uZSAmJiBrIDwgYXJyYXkubGVuZ3RoKSB7XG4gICAgICAgICAgdiA9IGFycmF5MiA/IFthcnJheVtrXSwgYXJyYXkyW2tdXSA6IGFycmF5W2tdO1xuICAgICAgICAgIHBbMF0rKztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgICBpdHAuc3BsaWNlKGl0cC5pbmRleE9mKHApLCAxKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGRvbmU6IGRvbmUsXG4gICAgICAgICAgdmFsdWU6IHZcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gc2hhcmVkU2l6ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fdmFsdWVzLmxlbmd0aDtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNoYXJlZEZvckVhY2goY2FsbGJhY2ssIGNvbnRleHQpIHtcbiAgICB2YXIgaXQgPSB0aGlzLmVudHJpZXMoKTtcbiAgICBmb3IgKDs7KSB7XG4gICAgICB2YXIgciA9IGl0Lm5leHQoKTtcbiAgICAgIGlmIChyLmRvbmUpIGJyZWFrO1xuICAgICAgY2FsbGJhY2suY2FsbChjb250ZXh0LCByLnZhbHVlWzFdLCByLnZhbHVlWzBdLCB0aGlzKTtcbiAgICB9XG4gIH1cblxufSkodHlwZW9mIGV4cG9ydHMgIT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIGdsb2JhbCAhPSAndW5kZWZpbmVkJyA/IGdsb2JhbCA6IHdpbmRvdyk7XG5cbn0se31dLFwianNvbnBhdGNoXCI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuLyohXG4gKiBodHRwczovL2dpdGh1Yi5jb20vU3RhcmNvdW50ZXItSmFjay9KU09OLVBhdGNoXG4gKiBqc29uLXBhdGNoLWR1cGxleC5qcyB2ZXJzaW9uOiAwLjUuN1xuICogKGMpIDIwMTMgSm9hY2hpbSBXZXN0ZXJcbiAqIE1JVCBsaWNlbnNlXG4gKi9cbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHtcbiAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG59O1xudmFyIE9yaWdpbmFsRXJyb3IgPSBFcnJvcjtcbnZhciBqc29ucGF0Y2g7XG4oZnVuY3Rpb24gKGpzb25wYXRjaCkge1xuICAgIHZhciBfb2JqZWN0S2V5cyA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgaWYgKF9pc0FycmF5KG9iaikpIHtcbiAgICAgICAgICAgIHZhciBrZXlzID0gbmV3IEFycmF5KG9iai5sZW5ndGgpO1xuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBrZXlzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAga2V5c1trXSA9IFwiXCIgKyBrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGtleXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKSB7XG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMob2JqKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIga2V5cyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpIGluIG9iaikge1xuICAgICAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICAgICAgICAgIGtleXMucHVzaChpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ga2V5cztcbiAgICB9O1xuICAgIGZ1bmN0aW9uIF9lcXVhbHMoYSwgYikge1xuICAgICAgICBzd2l0Y2ggKHR5cGVvZiBhKSB7XG4gICAgICAgICAgICBjYXNlICd1bmRlZmluZWQnOiAvL2JhY2t3YXJkIGNvbXBhdGliaWxpdHksIGJ1dCByZWFsbHkgSSB0aGluayB3ZSBzaG91bGQgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICBjYXNlICdib29sZWFuJzpcbiAgICAgICAgICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICAgICAgICBjYXNlICdudW1iZXInOlxuICAgICAgICAgICAgICAgIHJldHVybiBhID09PSBiO1xuICAgICAgICAgICAgY2FzZSAnb2JqZWN0JzpcbiAgICAgICAgICAgICAgICBpZiAoYSA9PT0gbnVsbClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIgPT09IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKF9pc0FycmF5KGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghX2lzQXJyYXkoYikgfHwgYS5sZW5ndGggIT09IGIubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGEubGVuZ3RoOyBpIDwgbDsgaSsrKVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFfZXF1YWxzKGFbaV0sIGJbaV0pKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBiS2V5cyA9IF9vYmplY3RLZXlzKGIpO1xuICAgICAgICAgICAgICAgIHZhciBiTGVuZ3RoID0gYktleXMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIGlmIChfb2JqZWN0S2V5cyhhKS5sZW5ndGggIT09IGJMZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJMZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFfZXF1YWxzKGFbaV0sIGJbaV0pKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyogV2UgdXNlIGEgSmF2YXNjcmlwdCBoYXNoIHRvIHN0b3JlIGVhY2hcbiAgICAgZnVuY3Rpb24uIEVhY2ggaGFzaCBlbnRyeSAocHJvcGVydHkpIHVzZXNcbiAgICAgdGhlIG9wZXJhdGlvbiBpZGVudGlmaWVycyBzcGVjaWZpZWQgaW4gcmZjNjkwMi5cbiAgICAgSW4gdGhpcyB3YXksIHdlIGNhbiBtYXAgZWFjaCBwYXRjaCBvcGVyYXRpb25cbiAgICAgdG8gaXRzIGRlZGljYXRlZCBmdW5jdGlvbiBpbiBlZmZpY2llbnQgd2F5LlxuICAgICAqL1xuICAgIC8qIFRoZSBvcGVyYXRpb25zIGFwcGxpY2FibGUgdG8gYW4gb2JqZWN0ICovXG4gICAgdmFyIG9iak9wcyA9IHtcbiAgICAgICAgYWRkOiBmdW5jdGlvbiAob2JqLCBrZXkpIHtcbiAgICAgICAgICAgIG9ialtrZXldID0gdGhpcy52YWx1ZTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICByZW1vdmU6IGZ1bmN0aW9uIChvYmosIGtleSkge1xuICAgICAgICAgICAgZGVsZXRlIG9ialtrZXldO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIHJlcGxhY2U6IGZ1bmN0aW9uIChvYmosIGtleSkge1xuICAgICAgICAgICAgb2JqW2tleV0gPSB0aGlzLnZhbHVlO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIG1vdmU6IGZ1bmN0aW9uIChvYmosIGtleSwgdHJlZSkge1xuICAgICAgICAgICAgdmFyIHRlbXAgPSB7IG9wOiBcIl9nZXRcIiwgcGF0aDogdGhpcy5mcm9tIH07XG4gICAgICAgICAgICBhcHBseSh0cmVlLCBbdGVtcF0pO1xuICAgICAgICAgICAgYXBwbHkodHJlZSwgW1xuICAgICAgICAgICAgICAgIHsgb3A6IFwicmVtb3ZlXCIsIHBhdGg6IHRoaXMuZnJvbSB9XG4gICAgICAgICAgICBdKTtcbiAgICAgICAgICAgIGFwcGx5KHRyZWUsIFtcbiAgICAgICAgICAgICAgICB7IG9wOiBcImFkZFwiLCBwYXRoOiB0aGlzLnBhdGgsIHZhbHVlOiB0ZW1wLnZhbHVlIH1cbiAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIGNvcHk6IGZ1bmN0aW9uIChvYmosIGtleSwgdHJlZSkge1xuICAgICAgICAgICAgdmFyIHRlbXAgPSB7IG9wOiBcIl9nZXRcIiwgcGF0aDogdGhpcy5mcm9tIH07XG4gICAgICAgICAgICBhcHBseSh0cmVlLCBbdGVtcF0pO1xuICAgICAgICAgICAgYXBwbHkodHJlZSwgW1xuICAgICAgICAgICAgICAgIHsgb3A6IFwiYWRkXCIsIHBhdGg6IHRoaXMucGF0aCwgdmFsdWU6IHRlbXAudmFsdWUgfVxuICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgdGVzdDogZnVuY3Rpb24gKG9iaiwga2V5KSB7XG4gICAgICAgICAgICByZXR1cm4gX2VxdWFscyhvYmpba2V5XSwgdGhpcy52YWx1ZSk7XG4gICAgICAgIH0sXG4gICAgICAgIF9nZXQ6IGZ1bmN0aW9uIChvYmosIGtleSkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG9ialtrZXldO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKiBUaGUgb3BlcmF0aW9ucyBhcHBsaWNhYmxlIHRvIGFuIGFycmF5LiBNYW55IGFyZSB0aGUgc2FtZSBhcyBmb3IgdGhlIG9iamVjdCAqL1xuICAgIHZhciBhcnJPcHMgPSB7XG4gICAgICAgIGFkZDogZnVuY3Rpb24gKGFyciwgaSkge1xuICAgICAgICAgICAgYXJyLnNwbGljZShpLCAwLCB0aGlzLnZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICByZW1vdmU6IGZ1bmN0aW9uIChhcnIsIGkpIHtcbiAgICAgICAgICAgIGFyci5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgcmVwbGFjZTogZnVuY3Rpb24gKGFyciwgaSkge1xuICAgICAgICAgICAgYXJyW2ldID0gdGhpcy52YWx1ZTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICBtb3ZlOiBvYmpPcHMubW92ZSxcbiAgICAgICAgY29weTogb2JqT3BzLmNvcHksXG4gICAgICAgIHRlc3Q6IG9iak9wcy50ZXN0LFxuICAgICAgICBfZ2V0OiBvYmpPcHMuX2dldFxuICAgIH07XG4gICAgLyogVGhlIG9wZXJhdGlvbnMgYXBwbGljYWJsZSB0byBvYmplY3Qgcm9vdC4gTWFueSBhcmUgdGhlIHNhbWUgYXMgZm9yIHRoZSBvYmplY3QgKi9cbiAgICB2YXIgcm9vdE9wcyA9IHtcbiAgICAgICAgYWRkOiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICByb290T3BzLnJlbW92ZS5jYWxsKHRoaXMsIG9iaik7XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy52YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgb2JqW2tleV0gPSB0aGlzLnZhbHVlW2tleV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIHJlbW92ZTogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgICAgICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICBvYmpPcHMucmVtb3ZlLmNhbGwodGhpcywgb2JqLCBrZXkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICByZXBsYWNlOiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICBhcHBseShvYmosIFtcbiAgICAgICAgICAgICAgICB7IG9wOiBcInJlbW92ZVwiLCBwYXRoOiB0aGlzLnBhdGggfVxuICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICBhcHBseShvYmosIFtcbiAgICAgICAgICAgICAgICB7IG9wOiBcImFkZFwiLCBwYXRoOiB0aGlzLnBhdGgsIHZhbHVlOiB0aGlzLnZhbHVlIH1cbiAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIG1vdmU6IG9iak9wcy5tb3ZlLFxuICAgICAgICBjb3B5OiBvYmpPcHMuY29weSxcbiAgICAgICAgdGVzdDogZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIChKU09OLnN0cmluZ2lmeShvYmopID09PSBKU09OLnN0cmluZ2lmeSh0aGlzLnZhbHVlKSk7XG4gICAgICAgIH0sXG4gICAgICAgIF9nZXQ6IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSBvYmo7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZhciBvYnNlcnZlT3BzID0ge1xuICAgICAgICBhZGQ6IGZ1bmN0aW9uIChwYXRjaGVzLCBwYXRoKSB7XG4gICAgICAgICAgICB2YXIgcGF0Y2ggPSB7XG4gICAgICAgICAgICAgICAgb3A6IFwiYWRkXCIsXG4gICAgICAgICAgICAgICAgcGF0aDogcGF0aCArIGVzY2FwZVBhdGhDb21wb25lbnQodGhpcy5uYW1lKSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5vYmplY3RbdGhpcy5uYW1lXSB9O1xuICAgICAgICAgICAgcGF0Y2hlcy5wdXNoKHBhdGNoKTtcbiAgICAgICAgfSxcbiAgICAgICAgJ2RlbGV0ZSc6IGZ1bmN0aW9uIChwYXRjaGVzLCBwYXRoKSB7XG4gICAgICAgICAgICB2YXIgcGF0Y2ggPSB7XG4gICAgICAgICAgICAgICAgb3A6IFwicmVtb3ZlXCIsXG4gICAgICAgICAgICAgICAgcGF0aDogcGF0aCArIGVzY2FwZVBhdGhDb21wb25lbnQodGhpcy5uYW1lKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHBhdGNoZXMucHVzaChwYXRjaCk7XG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZTogZnVuY3Rpb24gKHBhdGNoZXMsIHBhdGgpIHtcbiAgICAgICAgICAgIHZhciBwYXRjaCA9IHtcbiAgICAgICAgICAgICAgICBvcDogXCJyZXBsYWNlXCIsXG4gICAgICAgICAgICAgICAgcGF0aDogcGF0aCArIGVzY2FwZVBhdGhDb21wb25lbnQodGhpcy5uYW1lKSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5vYmplY3RbdGhpcy5uYW1lXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHBhdGNoZXMucHVzaChwYXRjaCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGZ1bmN0aW9uIGVzY2FwZVBhdGhDb21wb25lbnQoc3RyKSB7XG4gICAgICAgIGlmIChzdHIuaW5kZXhPZignLycpID09PSAtMSAmJiBzdHIuaW5kZXhPZignficpID09PSAtMSlcbiAgICAgICAgICAgIHJldHVybiBzdHI7XG4gICAgICAgIHJldHVybiBzdHIucmVwbGFjZSgvfi9nLCAnfjAnKS5yZXBsYWNlKC9cXC8vZywgJ34xJyk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIF9nZXRQYXRoUmVjdXJzaXZlKHJvb3QsIG9iaikge1xuICAgICAgICB2YXIgZm91bmQ7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiByb290KSB7XG4gICAgICAgICAgICBpZiAocm9vdC5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJvb3Rba2V5XSA9PT0gb2JqKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlc2NhcGVQYXRoQ29tcG9uZW50KGtleSkgKyAnLyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiByb290W2tleV0gPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvdW5kID0gX2dldFBhdGhSZWN1cnNpdmUocm9vdFtrZXldLCBvYmopO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZm91bmQgIT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlc2NhcGVQYXRoQ29tcG9uZW50KGtleSkgKyAnLycgKyBmb3VuZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdldFBhdGgocm9vdCwgb2JqKSB7XG4gICAgICAgIGlmIChyb290ID09PSBvYmopIHtcbiAgICAgICAgICAgIHJldHVybiAnLyc7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBhdGggPSBfZ2V0UGF0aFJlY3Vyc2l2ZShyb290LCBvYmopO1xuICAgICAgICBpZiAocGF0aCA9PT0gJycpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBPcmlnaW5hbEVycm9yKFwiT2JqZWN0IG5vdCBmb3VuZCBpbiByb290XCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAnLycgKyBwYXRoO1xuICAgIH1cbiAgICB2YXIgYmVmb3JlRGljdCA9IFtdO1xuICAgIHZhciBNaXJyb3IgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBNaXJyb3Iob2JqKSB7XG4gICAgICAgICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5vYmogPSBvYmo7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE1pcnJvcjtcbiAgICB9KSgpO1xuICAgIHZhciBPYnNlcnZlckluZm8gPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBPYnNlcnZlckluZm8oY2FsbGJhY2ssIG9ic2VydmVyKSB7XG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgICAgICAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE9ic2VydmVySW5mbztcbiAgICB9KSgpO1xuICAgIGZ1bmN0aW9uIGdldE1pcnJvcihvYmopIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlsZW4gPSBiZWZvcmVEaWN0Lmxlbmd0aDsgaSA8IGlsZW47IGkrKykge1xuICAgICAgICAgICAgaWYgKGJlZm9yZURpY3RbaV0ub2JqID09PSBvYmopIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYmVmb3JlRGljdFtpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBnZXRPYnNlcnZlckZyb21NaXJyb3IobWlycm9yLCBjYWxsYmFjaykge1xuICAgICAgICBmb3IgKHZhciBqID0gMCwgamxlbiA9IG1pcnJvci5vYnNlcnZlcnMubGVuZ3RoOyBqIDwgamxlbjsgaisrKSB7XG4gICAgICAgICAgICBpZiAobWlycm9yLm9ic2VydmVyc1tqXS5jYWxsYmFjayA9PT0gY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWlycm9yLm9ic2VydmVyc1tqXS5vYnNlcnZlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiByZW1vdmVPYnNlcnZlckZyb21NaXJyb3IobWlycm9yLCBvYnNlcnZlcikge1xuICAgICAgICBmb3IgKHZhciBqID0gMCwgamxlbiA9IG1pcnJvci5vYnNlcnZlcnMubGVuZ3RoOyBqIDwgamxlbjsgaisrKSB7XG4gICAgICAgICAgICBpZiAobWlycm9yLm9ic2VydmVyc1tqXS5vYnNlcnZlciA9PT0gb2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgICAgICBtaXJyb3Iub2JzZXJ2ZXJzLnNwbGljZShqLCAxKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gdW5vYnNlcnZlKHJvb3QsIG9ic2VydmVyKSB7XG4gICAgICAgIG9ic2VydmVyLnVub2JzZXJ2ZSgpO1xuICAgIH1cbiAgICBqc29ucGF0Y2gudW5vYnNlcnZlID0gdW5vYnNlcnZlO1xuICAgIGZ1bmN0aW9uIGRlZXBDbG9uZShvYmopIHtcbiAgICAgICAgaWYgKHR5cGVvZiBvYmogPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9iaikpOyAvL0Zhc3RlciB0aGFuIEVTNSBjbG9uZSAtIGh0dHA6Ly9qc3BlcmYuY29tL2RlZXAtY2xvbmluZy1vZi1vYmplY3RzLzVcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBvYmo7IC8vbm8gbmVlZCB0byBjbG9uZSBwcmltaXRpdmVzXG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gb2JzZXJ2ZShvYmosIGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBwYXRjaGVzID0gW107XG4gICAgICAgIHZhciByb290ID0gb2JqO1xuICAgICAgICB2YXIgb2JzZXJ2ZXI7XG4gICAgICAgIHZhciBtaXJyb3IgPSBnZXRNaXJyb3Iob2JqKTtcbiAgICAgICAgaWYgKCFtaXJyb3IpIHtcbiAgICAgICAgICAgIG1pcnJvciA9IG5ldyBNaXJyb3Iob2JqKTtcbiAgICAgICAgICAgIGJlZm9yZURpY3QucHVzaChtaXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgb2JzZXJ2ZXIgPSBnZXRPYnNlcnZlckZyb21NaXJyb3IobWlycm9yLCBjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9ic2VydmVyKSB7XG4gICAgICAgICAgICByZXR1cm4gb2JzZXJ2ZXI7XG4gICAgICAgIH1cbiAgICAgICAgb2JzZXJ2ZXIgPSB7fTtcbiAgICAgICAgbWlycm9yLnZhbHVlID0gZGVlcENsb25lKG9iaik7XG4gICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgb2JzZXJ2ZXIuY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICAgICAgICAgIG9ic2VydmVyLm5leHQgPSBudWxsO1xuICAgICAgICAgICAgdmFyIGludGVydmFscyA9IHRoaXMuaW50ZXJ2YWxzIHx8IFsxMDAsIDEwMDAsIDEwMDAwLCA2MDAwMF07XG4gICAgICAgICAgICBpZiAoaW50ZXJ2YWxzLnB1c2ggPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBPcmlnaW5hbEVycm9yKFwianNvbnBhdGNoLmludGVydmFscyBtdXN0IGJlIGFuIGFycmF5XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGN1cnJlbnRJbnRlcnZhbCA9IDA7XG4gICAgICAgICAgICB2YXIgZGlydHlDaGVjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBnZW5lcmF0ZShvYnNlcnZlcik7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGZhc3RDaGVjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQob2JzZXJ2ZXIubmV4dCk7XG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBkaXJ0eUNoZWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRJbnRlcnZhbCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQgPSBzZXRUaW1lb3V0KHNsb3dDaGVjaywgaW50ZXJ2YWxzW2N1cnJlbnRJbnRlcnZhbCsrXSk7XG4gICAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIHNsb3dDaGVjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBkaXJ0eUNoZWNrKCk7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRJbnRlcnZhbCA9PSBpbnRlcnZhbHMubGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50SW50ZXJ2YWwgPSBpbnRlcnZhbHMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0ID0gc2V0VGltZW91dChzbG93Q2hlY2ssIGludGVydmFsc1tjdXJyZW50SW50ZXJ2YWwrK10pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcikge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgZmFzdENoZWNrKTtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBmYXN0Q2hlY2spO1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZhc3RDaGVjayk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYXR0YWNoRXZlbnQoJ29ubW91c2Vkb3duJywgZmFzdENoZWNrKTtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmF0dGFjaEV2ZW50KCdvbm1vdXNldXAnLCBmYXN0Q2hlY2spO1xuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYXR0YWNoRXZlbnQoJ29ua2V5ZG93bicsIGZhc3RDaGVjayk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dCA9IHNldFRpbWVvdXQoc2xvd0NoZWNrLCBpbnRlcnZhbHNbY3VycmVudEludGVydmFsKytdKTtcbiAgICAgICAgfVxuICAgICAgICBvYnNlcnZlci5wYXRjaGVzID0gcGF0Y2hlcztcbiAgICAgICAgb2JzZXJ2ZXIub2JqZWN0ID0gb2JqO1xuICAgICAgICBvYnNlcnZlci51bm9ic2VydmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBnZW5lcmF0ZShvYnNlcnZlcik7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQob2JzZXJ2ZXIubmV4dCk7XG4gICAgICAgICAgICByZW1vdmVPYnNlcnZlckZyb21NaXJyb3IobWlycm9yLCBvYnNlcnZlcik7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICBpZiAod2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGZhc3RDaGVjayk7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgZmFzdENoZWNrKTtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmYXN0Q2hlY2spO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRldGFjaEV2ZW50KCdvbm1vdXNlZG93bicsIGZhc3RDaGVjayk7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5kZXRhY2hFdmVudCgnb25tb3VzZXVwJywgZmFzdENoZWNrKTtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRldGFjaEV2ZW50KCdvbmtleWRvd24nLCBmYXN0Q2hlY2spO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgbWlycm9yLm9ic2VydmVycy5wdXNoKG5ldyBPYnNlcnZlckluZm8oY2FsbGJhY2ssIG9ic2VydmVyKSk7XG4gICAgICAgIHJldHVybiBvYnNlcnZlcjtcbiAgICB9XG4gICAganNvbnBhdGNoLm9ic2VydmUgPSBvYnNlcnZlO1xuICAgIGZ1bmN0aW9uIGdlbmVyYXRlKG9ic2VydmVyKSB7XG4gICAgICAgIHZhciBtaXJyb3I7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBpbGVuID0gYmVmb3JlRGljdC5sZW5ndGg7IGkgPCBpbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChiZWZvcmVEaWN0W2ldLm9iaiA9PT0gb2JzZXJ2ZXIub2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgbWlycm9yID0gYmVmb3JlRGljdFtpXTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBfZ2VuZXJhdGUobWlycm9yLnZhbHVlLCBvYnNlcnZlci5vYmplY3QsIG9ic2VydmVyLnBhdGNoZXMsIFwiXCIpO1xuICAgICAgICBpZiAob2JzZXJ2ZXIucGF0Y2hlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGFwcGx5KG1pcnJvci52YWx1ZSwgb2JzZXJ2ZXIucGF0Y2hlcyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRlbXAgPSBvYnNlcnZlci5wYXRjaGVzO1xuICAgICAgICBpZiAodGVtcC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBvYnNlcnZlci5wYXRjaGVzID0gW107XG4gICAgICAgICAgICBpZiAob2JzZXJ2ZXIuY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICBvYnNlcnZlci5jYWxsYmFjayh0ZW1wKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGVtcDtcbiAgICB9XG4gICAganNvbnBhdGNoLmdlbmVyYXRlID0gZ2VuZXJhdGU7XG4gICAgLy8gRGlydHkgY2hlY2sgaWYgb2JqIGlzIGRpZmZlcmVudCBmcm9tIG1pcnJvciwgZ2VuZXJhdGUgcGF0Y2hlcyBhbmQgdXBkYXRlIG1pcnJvclxuICAgIGZ1bmN0aW9uIF9nZW5lcmF0ZShtaXJyb3IsIG9iaiwgcGF0Y2hlcywgcGF0aCkge1xuICAgICAgICB2YXIgbmV3S2V5cyA9IF9vYmplY3RLZXlzKG9iaik7XG4gICAgICAgIHZhciBvbGRLZXlzID0gX29iamVjdEtleXMobWlycm9yKTtcbiAgICAgICAgdmFyIGNoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgdmFyIGRlbGV0ZWQgPSBmYWxzZTtcbiAgICAgICAgLy9pZiBldmVyIFwibW92ZVwiIG9wZXJhdGlvbiBpcyBpbXBsZW1lbnRlZCBoZXJlLCBtYWtlIHN1cmUgdGhpcyB0ZXN0IHJ1bnMgT0s6IFwic2hvdWxkIG5vdCBnZW5lcmF0ZSB0aGUgc2FtZSBwYXRjaCB0d2ljZSAobW92ZSlcIlxuICAgICAgICBmb3IgKHZhciB0ID0gb2xkS2V5cy5sZW5ndGggLSAxOyB0ID49IDA7IHQtLSkge1xuICAgICAgICAgICAgdmFyIGtleSA9IG9sZEtleXNbdF07XG4gICAgICAgICAgICB2YXIgb2xkVmFsID0gbWlycm9yW2tleV07XG4gICAgICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3VmFsID0gb2JqW2tleV07XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvbGRWYWwgPT0gXCJvYmplY3RcIiAmJiBvbGRWYWwgIT0gbnVsbCAmJiB0eXBlb2YgbmV3VmFsID09IFwib2JqZWN0XCIgJiYgbmV3VmFsICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgX2dlbmVyYXRlKG9sZFZhbCwgbmV3VmFsLCBwYXRjaGVzLCBwYXRoICsgXCIvXCIgKyBlc2NhcGVQYXRoQ29tcG9uZW50KGtleSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9sZFZhbCAhPSBuZXdWYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0Y2hlcy5wdXNoKHsgb3A6IFwicmVwbGFjZVwiLCBwYXRoOiBwYXRoICsgXCIvXCIgKyBlc2NhcGVQYXRoQ29tcG9uZW50KGtleSksIHZhbHVlOiBkZWVwQ2xvbmUobmV3VmFsKSB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHBhdGNoZXMucHVzaCh7IG9wOiBcInJlbW92ZVwiLCBwYXRoOiBwYXRoICsgXCIvXCIgKyBlc2NhcGVQYXRoQ29tcG9uZW50KGtleSkgfSk7XG4gICAgICAgICAgICAgICAgZGVsZXRlZCA9IHRydWU7IC8vIHByb3BlcnR5IGhhcyBiZWVuIGRlbGV0ZWRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRlbGV0ZWQgJiYgbmV3S2V5cy5sZW5ndGggPT0gb2xkS2V5cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciB0ID0gMDsgdCA8IG5ld0tleXMubGVuZ3RoOyB0KyspIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSBuZXdLZXlzW3RdO1xuICAgICAgICAgICAgaWYgKCFtaXJyb3IuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgIHBhdGNoZXMucHVzaCh7IG9wOiBcImFkZFwiLCBwYXRoOiBwYXRoICsgXCIvXCIgKyBlc2NhcGVQYXRoQ29tcG9uZW50KGtleSksIHZhbHVlOiBkZWVwQ2xvbmUob2JqW2tleV0pIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBfaXNBcnJheTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheSkge1xuICAgICAgICBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBfaXNBcnJheSA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgIHJldHVybiBvYmoucHVzaCAmJiB0eXBlb2Ygb2JqLmxlbmd0aCA9PT0gJ251bWJlcic7XG4gICAgICAgIH07XG4gICAgfVxuICAgIC8vM3ggZmFzdGVyIHRoYW4gY2FjaGVkIC9eXFxkKyQvLnRlc3Qoc3RyKVxuICAgIGZ1bmN0aW9uIGlzSW50ZWdlcihzdHIpIHtcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICB2YXIgbGVuID0gc3RyLmxlbmd0aDtcbiAgICAgICAgdmFyIGNoYXJDb2RlO1xuICAgICAgICB3aGlsZSAoaSA8IGxlbikge1xuICAgICAgICAgICAgY2hhckNvZGUgPSBzdHIuY2hhckNvZGVBdChpKTtcbiAgICAgICAgICAgIGlmIChjaGFyQ29kZSA+PSA0OCAmJiBjaGFyQ29kZSA8PSA1Nykge1xuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLy8vIEFwcGx5IGEganNvbi1wYXRjaCBvcGVyYXRpb24gb24gYW4gb2JqZWN0IHRyZWVcbiAgICBmdW5jdGlvbiBhcHBseSh0cmVlLCBwYXRjaGVzLCB2YWxpZGF0ZSkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gZmFsc2UsIHAgPSAwLCBwbGVuID0gcGF0Y2hlcy5sZW5ndGgsIHBhdGNoLCBrZXk7XG4gICAgICAgIHdoaWxlIChwIDwgcGxlbikge1xuICAgICAgICAgICAgcGF0Y2ggPSBwYXRjaGVzW3BdO1xuICAgICAgICAgICAgcCsrO1xuICAgICAgICAgICAgLy8gRmluZCB0aGUgb2JqZWN0XG4gICAgICAgICAgICB2YXIgcGF0aCA9IHBhdGNoLnBhdGggfHwgXCJcIjtcbiAgICAgICAgICAgIHZhciBrZXlzID0gcGF0aC5zcGxpdCgnLycpO1xuICAgICAgICAgICAgdmFyIG9iaiA9IHRyZWU7XG4gICAgICAgICAgICB2YXIgdCA9IDE7IC8vc2tpcCBlbXB0eSBlbGVtZW50IC0gaHR0cDovL2pzcGVyZi5jb20vdG8tc2hpZnQtb3Itbm90LXRvLXNoaWZ0XG4gICAgICAgICAgICB2YXIgbGVuID0ga2V5cy5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgZXhpc3RpbmdQYXRoRnJhZ21lbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgICAgICAgIGtleSA9IGtleXNbdF07XG4gICAgICAgICAgICAgICAgaWYgKHZhbGlkYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ1BhdGhGcmFnbWVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqW2tleV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nUGF0aEZyYWdtZW50ID0ga2V5cy5zbGljZSgwLCB0KS5qb2luKCcvJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0ID09IGxlbiAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGlzdGluZ1BhdGhGcmFnbWVudCA9IHBhdGNoLnBhdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdQYXRoRnJhZ21lbnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmFsaWRhdG9yKHBhdGNoLCBwIC0gMSwgdHJlZSwgZXhpc3RpbmdQYXRoRnJhZ21lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHQrKztcbiAgICAgICAgICAgICAgICBpZiAoa2V5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgPj0gbGVuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByb290T3BzW3BhdGNoLm9wXS5jYWxsKHBhdGNoLCBvYmosIGtleSwgdHJlZSk7IC8vIEFwcGx5IHBhdGNoXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoX2lzQXJyYXkob2JqKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoa2V5ID09PSAnLScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleSA9IG9iai5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWRhdGUgJiYgIWlzSW50ZWdlcihrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEpzb25QYXRjaEVycm9yKFwiRXhwZWN0ZWQgYW4gdW5zaWduZWQgYmFzZS0xMCBpbnRlZ2VyIHZhbHVlLCBtYWtpbmcgdGhlIG5ldyByZWZlcmVuY2VkIHZhbHVlIHRoZSBhcnJheSBlbGVtZW50IHdpdGggdGhlIHplcm8tYmFzZWQgaW5kZXhcIiwgXCJPUEVSQVRJT05fUEFUSF9JTExFR0FMX0FSUkFZX0lOREVYXCIsIHAgLSAxLCBwYXRjaC5wYXRoLCBwYXRjaCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBrZXkgPSBwYXJzZUludChrZXksIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodCA+PSBsZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWxpZGF0ZSAmJiBwYXRjaC5vcCA9PT0gXCJhZGRcIiAmJiBrZXkgPiBvYmoubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEpzb25QYXRjaEVycm9yKFwiVGhlIHNwZWNpZmllZCBpbmRleCBNVVNUIE5PVCBiZSBncmVhdGVyIHRoYW4gdGhlIG51bWJlciBvZiBlbGVtZW50cyBpbiB0aGUgYXJyYXlcIiwgXCJPUEVSQVRJT05fVkFMVUVfT1VUX09GX0JPVU5EU1wiLCBwIC0gMSwgcGF0Y2gucGF0aCwgcGF0Y2gpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyT3BzW3BhdGNoLm9wXS5jYWxsKHBhdGNoLCBvYmosIGtleSwgdHJlZSk7IC8vIEFwcGx5IHBhdGNoXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleSAmJiBrZXkuaW5kZXhPZignficpICE9IC0xKVxuICAgICAgICAgICAgICAgICAgICAgICAga2V5ID0ga2V5LnJlcGxhY2UoL34xL2csICcvJykucmVwbGFjZSgvfjAvZywgJ34nKTsgLy8gZXNjYXBlIGNoYXJzXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ID49IGxlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gb2JqT3BzW3BhdGNoLm9wXS5jYWxsKHBhdGNoLCBvYmosIGtleSwgdHJlZSk7IC8vIEFwcGx5IHBhdGNoXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvYmogPSBvYmpba2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBqc29ucGF0Y2guYXBwbHkgPSBhcHBseTtcbiAgICBmdW5jdGlvbiBjb21wYXJlKHRyZWUxLCB0cmVlMikge1xuICAgICAgICB2YXIgcGF0Y2hlcyA9IFtdO1xuICAgICAgICBfZ2VuZXJhdGUodHJlZTEsIHRyZWUyLCBwYXRjaGVzLCAnJyk7XG4gICAgICAgIHJldHVybiBwYXRjaGVzO1xuICAgIH1cbiAgICBqc29ucGF0Y2guY29tcGFyZSA9IGNvbXBhcmU7XG4gICAgdmFyIEpzb25QYXRjaEVycm9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKEpzb25QYXRjaEVycm9yLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBKc29uUGF0Y2hFcnJvcihtZXNzYWdlLCBuYW1lLCBpbmRleCwgb3BlcmF0aW9uLCB0cmVlKSB7XG4gICAgICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKTtcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICAgICAgdGhpcy5pbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgdGhpcy5vcGVyYXRpb24gPSBvcGVyYXRpb247XG4gICAgICAgICAgICB0aGlzLnRyZWUgPSB0cmVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBKc29uUGF0Y2hFcnJvcjtcbiAgICB9KShPcmlnaW5hbEVycm9yKTtcbiAgICBqc29ucGF0Y2guSnNvblBhdGNoRXJyb3IgPSBKc29uUGF0Y2hFcnJvcjtcbiAgICBqc29ucGF0Y2guRXJyb3IgPSBKc29uUGF0Y2hFcnJvcjtcbiAgICAvKipcbiAgICAgKiBSZWN1cnNpdmVseSBjaGVja3Mgd2hldGhlciBhbiBvYmplY3QgaGFzIGFueSB1bmRlZmluZWQgdmFsdWVzIGluc2lkZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBoYXNVbmRlZmluZWQob2JqKSB7XG4gICAgICAgIGlmIChvYmogPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBvYmogPT0gXCJhcnJheVwiIHx8IHR5cGVvZiBvYmogPT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBvYmopIHtcbiAgICAgICAgICAgICAgICBpZiAoaGFzVW5kZWZpbmVkKG9ialtpXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVmFsaWRhdGVzIGEgc2luZ2xlIG9wZXJhdGlvbi4gQ2FsbGVkIGZyb20gYGpzb25wYXRjaC52YWxpZGF0ZWAuIFRocm93cyBgSnNvblBhdGNoRXJyb3JgIGluIGNhc2Ugb2YgYW4gZXJyb3IuXG4gICAgICogQHBhcmFtIHtvYmplY3R9IG9wZXJhdGlvbiAtIG9wZXJhdGlvbiBvYmplY3QgKHBhdGNoKVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCAtIGluZGV4IG9mIG9wZXJhdGlvbiBpbiB0aGUgc2VxdWVuY2VcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gW3RyZWVdIC0gb2JqZWN0IHdoZXJlIHRoZSBvcGVyYXRpb24gaXMgc3VwcG9zZWQgdG8gYmUgYXBwbGllZFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbZXhpc3RpbmdQYXRoRnJhZ21lbnRdIC0gY29tZXMgYWxvbmcgd2l0aCBgdHJlZWBcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB2YWxpZGF0b3Iob3BlcmF0aW9uLCBpbmRleCwgdHJlZSwgZXhpc3RpbmdQYXRoRnJhZ21lbnQpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBvcGVyYXRpb24gIT09ICdvYmplY3QnIHx8IG9wZXJhdGlvbiA9PT0gbnVsbCB8fCBfaXNBcnJheShvcGVyYXRpb24pKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSnNvblBhdGNoRXJyb3IoJ09wZXJhdGlvbiBpcyBub3QgYW4gb2JqZWN0JywgJ09QRVJBVElPTl9OT1RfQU5fT0JKRUNUJywgaW5kZXgsIG9wZXJhdGlvbiwgdHJlZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIW9iak9wc1tvcGVyYXRpb24ub3BdKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSnNvblBhdGNoRXJyb3IoJ09wZXJhdGlvbiBgb3BgIHByb3BlcnR5IGlzIG5vdCBvbmUgb2Ygb3BlcmF0aW9ucyBkZWZpbmVkIGluIFJGQy02OTAyJywgJ09QRVJBVElPTl9PUF9JTlZBTElEJywgaW5kZXgsIG9wZXJhdGlvbiwgdHJlZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIG9wZXJhdGlvbi5wYXRoICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEpzb25QYXRjaEVycm9yKCdPcGVyYXRpb24gYHBhdGhgIHByb3BlcnR5IGlzIG5vdCBhIHN0cmluZycsICdPUEVSQVRJT05fUEFUSF9JTlZBTElEJywgaW5kZXgsIG9wZXJhdGlvbiwgdHJlZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoKG9wZXJhdGlvbi5vcCA9PT0gJ21vdmUnIHx8IG9wZXJhdGlvbi5vcCA9PT0gJ2NvcHknKSAmJiB0eXBlb2Ygb3BlcmF0aW9uLmZyb20gIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSnNvblBhdGNoRXJyb3IoJ09wZXJhdGlvbiBgZnJvbWAgcHJvcGVydHkgaXMgbm90IHByZXNlbnQgKGFwcGxpY2FibGUgaW4gYG1vdmVgIGFuZCBgY29weWAgb3BlcmF0aW9ucyknLCAnT1BFUkFUSU9OX0ZST01fUkVRVUlSRUQnLCBpbmRleCwgb3BlcmF0aW9uLCB0cmVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICgob3BlcmF0aW9uLm9wID09PSAnYWRkJyB8fCBvcGVyYXRpb24ub3AgPT09ICdyZXBsYWNlJyB8fCBvcGVyYXRpb24ub3AgPT09ICd0ZXN0JykgJiYgb3BlcmF0aW9uLnZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBKc29uUGF0Y2hFcnJvcignT3BlcmF0aW9uIGB2YWx1ZWAgcHJvcGVydHkgaXMgbm90IHByZXNlbnQgKGFwcGxpY2FibGUgaW4gYGFkZGAsIGByZXBsYWNlYCBhbmQgYHRlc3RgIG9wZXJhdGlvbnMpJywgJ09QRVJBVElPTl9WQUxVRV9SRVFVSVJFRCcsIGluZGV4LCBvcGVyYXRpb24sIHRyZWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKChvcGVyYXRpb24ub3AgPT09ICdhZGQnIHx8IG9wZXJhdGlvbi5vcCA9PT0gJ3JlcGxhY2UnIHx8IG9wZXJhdGlvbi5vcCA9PT0gJ3Rlc3QnKSAmJiBoYXNVbmRlZmluZWQob3BlcmF0aW9uLnZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEpzb25QYXRjaEVycm9yKCdPcGVyYXRpb24gYHZhbHVlYCBwcm9wZXJ0eSBpcyBub3QgcHJlc2VudCAoYXBwbGljYWJsZSBpbiBgYWRkYCwgYHJlcGxhY2VgIGFuZCBgdGVzdGAgb3BlcmF0aW9ucyknLCAnT1BFUkFUSU9OX1ZBTFVFX0NBTk5PVF9DT05UQUlOX1VOREVGSU5FRCcsIGluZGV4LCBvcGVyYXRpb24sIHRyZWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRyZWUpIHtcbiAgICAgICAgICAgIGlmIChvcGVyYXRpb24ub3AgPT0gXCJhZGRcIikge1xuICAgICAgICAgICAgICAgIHZhciBwYXRoTGVuID0gb3BlcmF0aW9uLnBhdGguc3BsaXQoXCIvXCIpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdQYXRoTGVuID0gZXhpc3RpbmdQYXRoRnJhZ21lbnQuc3BsaXQoXCIvXCIpLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBpZiAocGF0aExlbiAhPT0gZXhpc3RpbmdQYXRoTGVuICsgMSAmJiBwYXRoTGVuICE9PSBleGlzdGluZ1BhdGhMZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEpzb25QYXRjaEVycm9yKCdDYW5ub3QgcGVyZm9ybSBhbiBgYWRkYCBvcGVyYXRpb24gYXQgdGhlIGRlc2lyZWQgcGF0aCcsICdPUEVSQVRJT05fUEFUSF9DQU5OT1RfQUREJywgaW5kZXgsIG9wZXJhdGlvbiwgdHJlZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAob3BlcmF0aW9uLm9wID09PSAncmVwbGFjZScgfHwgb3BlcmF0aW9uLm9wID09PSAncmVtb3ZlJyB8fCBvcGVyYXRpb24ub3AgPT09ICdfZ2V0Jykge1xuICAgICAgICAgICAgICAgIGlmIChvcGVyYXRpb24ucGF0aCAhPT0gZXhpc3RpbmdQYXRoRnJhZ21lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEpzb25QYXRjaEVycm9yKCdDYW5ub3QgcGVyZm9ybSB0aGUgb3BlcmF0aW9uIGF0IGEgcGF0aCB0aGF0IGRvZXMgbm90IGV4aXN0JywgJ09QRVJBVElPTl9QQVRIX1VOUkVTT0xWQUJMRScsIGluZGV4LCBvcGVyYXRpb24sIHRyZWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG9wZXJhdGlvbi5vcCA9PT0gJ21vdmUnIHx8IG9wZXJhdGlvbi5vcCA9PT0gJ2NvcHknKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nVmFsdWUgPSB7IG9wOiBcIl9nZXRcIiwgcGF0aDogb3BlcmF0aW9uLmZyb20sIHZhbHVlOiB1bmRlZmluZWQgfTtcbiAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSBqc29ucGF0Y2gudmFsaWRhdGUoW2V4aXN0aW5nVmFsdWVdLCB0cmVlKTtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IgJiYgZXJyb3IubmFtZSA9PT0gJ09QRVJBVElPTl9QQVRIX1VOUkVTT0xWQUJMRScpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEpzb25QYXRjaEVycm9yKCdDYW5ub3QgcGVyZm9ybSB0aGUgb3BlcmF0aW9uIGZyb20gYSBwYXRoIHRoYXQgZG9lcyBub3QgZXhpc3QnLCAnT1BFUkFUSU9OX0ZST01fVU5SRVNPTFZBQkxFJywgaW5kZXgsIG9wZXJhdGlvbiwgdHJlZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGpzb25wYXRjaC52YWxpZGF0b3IgPSB2YWxpZGF0b3I7XG4gICAgLyoqXG4gICAgICogVmFsaWRhdGVzIGEgc2VxdWVuY2Ugb2Ygb3BlcmF0aW9ucy4gSWYgYHRyZWVgIHBhcmFtZXRlciBpcyBwcm92aWRlZCwgdGhlIHNlcXVlbmNlIGlzIGFkZGl0aW9uYWxseSB2YWxpZGF0ZWQgYWdhaW5zdCB0aGUgb2JqZWN0IHRyZWUuXG4gICAgICogSWYgZXJyb3IgaXMgZW5jb3VudGVyZWQsIHJldHVybnMgYSBKc29uUGF0Y2hFcnJvciBvYmplY3RcbiAgICAgKiBAcGFyYW0gc2VxdWVuY2VcbiAgICAgKiBAcGFyYW0gdHJlZVxuICAgICAqIEByZXR1cm5zIHtKc29uUGF0Y2hFcnJvcnx1bmRlZmluZWR9XG4gICAgICovXG4gICAgZnVuY3Rpb24gdmFsaWRhdGUoc2VxdWVuY2UsIHRyZWUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmICghX2lzQXJyYXkoc2VxdWVuY2UpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEpzb25QYXRjaEVycm9yKCdQYXRjaCBzZXF1ZW5jZSBtdXN0IGJlIGFuIGFycmF5JywgJ1NFUVVFTkNFX05PVF9BTl9BUlJBWScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRyZWUpIHtcbiAgICAgICAgICAgICAgICB0cmVlID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0cmVlKSk7IC8vY2xvbmUgdHJlZSBzbyB0aGF0IHdlIGNhbiBzYWZlbHkgdHJ5IGFwcGx5aW5nIG9wZXJhdGlvbnNcbiAgICAgICAgICAgICAgICBhcHBseS5jYWxsKHRoaXMsIHRyZWUsIHNlcXVlbmNlLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VxdWVuY2UubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWxpZGF0b3Ioc2VxdWVuY2VbaV0sIGkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBKc29uUGF0Y2hFcnJvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBqc29ucGF0Y2gudmFsaWRhdGUgPSB2YWxpZGF0ZTtcbn0pKGpzb25wYXRjaCB8fCAoanNvbnBhdGNoID0ge30pKTtcbmlmICh0eXBlb2YgZXhwb3J0cyAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIGV4cG9ydHMuYXBwbHkgPSBqc29ucGF0Y2guYXBwbHk7XG4gICAgZXhwb3J0cy5vYnNlcnZlID0ganNvbnBhdGNoLm9ic2VydmU7XG4gICAgZXhwb3J0cy51bm9ic2VydmUgPSBqc29ucGF0Y2gudW5vYnNlcnZlO1xuICAgIGV4cG9ydHMuZ2VuZXJhdGUgPSBqc29ucGF0Y2guZ2VuZXJhdGU7XG4gICAgZXhwb3J0cy5jb21wYXJlID0ganNvbnBhdGNoLmNvbXBhcmU7XG4gICAgZXhwb3J0cy52YWxpZGF0ZSA9IGpzb25wYXRjaC52YWxpZGF0ZTtcbiAgICBleHBvcnRzLnZhbGlkYXRvciA9IGpzb25wYXRjaC52YWxpZGF0b3I7XG4gICAgZXhwb3J0cy5Kc29uUGF0Y2hFcnJvciA9IGpzb25wYXRjaC5Kc29uUGF0Y2hFcnJvcjtcbiAgICBleHBvcnRzLkVycm9yID0ganNvbnBhdGNoLkVycm9yO1xufVxuXG59LHt9XSxcIm1vbWVudFwiOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbi8vISBtb21lbnQuanNcbi8vISB2ZXJzaW9uIDogMi4xOC4xXG4vLyEgYXV0aG9ycyA6IFRpbSBXb29kLCBJc2tyZW4gQ2hlcm5ldiwgTW9tZW50LmpzIGNvbnRyaWJ1dG9yc1xuLy8hIGxpY2Vuc2UgOiBNSVRcbi8vISBtb21lbnRqcy5jb21cblxuOyhmdW5jdGlvbiAoZ2xvYmFsLCBmYWN0b3J5KSB7XG4gICAgdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnID8gbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCkgOlxuICAgIHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShmYWN0b3J5KSA6XG4gICAgZ2xvYmFsLm1vbWVudCA9IGZhY3RvcnkoKVxufSh0aGlzLCAoZnVuY3Rpb24gKCkgeyAndXNlIHN0cmljdCc7XG5cbnZhciBob29rQ2FsbGJhY2s7XG5cbmZ1bmN0aW9uIGhvb2tzICgpIHtcbiAgICByZXR1cm4gaG9va0NhbGxiYWNrLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG59XG5cbi8vIFRoaXMgaXMgZG9uZSB0byByZWdpc3RlciB0aGUgbWV0aG9kIGNhbGxlZCB3aXRoIG1vbWVudCgpXG4vLyB3aXRob3V0IGNyZWF0aW5nIGNpcmN1bGFyIGRlcGVuZGVuY2llcy5cbmZ1bmN0aW9uIHNldEhvb2tDYWxsYmFjayAoY2FsbGJhY2spIHtcbiAgICBob29rQ2FsbGJhY2sgPSBjYWxsYmFjaztcbn1cblxuZnVuY3Rpb24gaXNBcnJheShpbnB1dCkge1xuICAgIHJldHVybiBpbnB1dCBpbnN0YW5jZW9mIEFycmF5IHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpbnB1dCkgPT09ICdbb2JqZWN0IEFycmF5XSc7XG59XG5cbmZ1bmN0aW9uIGlzT2JqZWN0KGlucHV0KSB7XG4gICAgLy8gSUU4IHdpbGwgdHJlYXQgdW5kZWZpbmVkIGFuZCBudWxsIGFzIG9iamVjdCBpZiBpdCB3YXNuJ3QgZm9yXG4gICAgLy8gaW5wdXQgIT0gbnVsbFxuICAgIHJldHVybiBpbnB1dCAhPSBudWxsICYmIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpbnB1dCkgPT09ICdbb2JqZWN0IE9iamVjdF0nO1xufVxuXG5mdW5jdGlvbiBpc09iamVjdEVtcHR5KG9iaikge1xuICAgIHZhciBrO1xuICAgIGZvciAoayBpbiBvYmopIHtcbiAgICAgICAgLy8gZXZlbiBpZiBpdHMgbm90IG93biBwcm9wZXJ0eSBJJ2Qgc3RpbGwgY2FsbCBpdCBub24tZW1wdHlcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gaXNVbmRlZmluZWQoaW5wdXQpIHtcbiAgICByZXR1cm4gaW5wdXQgPT09IHZvaWQgMDtcbn1cblxuZnVuY3Rpb24gaXNOdW1iZXIoaW5wdXQpIHtcbiAgICByZXR1cm4gdHlwZW9mIGlucHV0ID09PSAnbnVtYmVyJyB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaW5wdXQpID09PSAnW29iamVjdCBOdW1iZXJdJztcbn1cblxuZnVuY3Rpb24gaXNEYXRlKGlucHV0KSB7XG4gICAgcmV0dXJuIGlucHV0IGluc3RhbmNlb2YgRGF0ZSB8fCBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaW5wdXQpID09PSAnW29iamVjdCBEYXRlXSc7XG59XG5cbmZ1bmN0aW9uIG1hcChhcnIsIGZuKSB7XG4gICAgdmFyIHJlcyA9IFtdLCBpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgcmVzLnB1c2goZm4oYXJyW2ldLCBpKSk7XG4gICAgfVxuICAgIHJldHVybiByZXM7XG59XG5cbmZ1bmN0aW9uIGhhc093blByb3AoYSwgYikge1xuICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYSwgYik7XG59XG5cbmZ1bmN0aW9uIGV4dGVuZChhLCBiKSB7XG4gICAgZm9yICh2YXIgaSBpbiBiKSB7XG4gICAgICAgIGlmIChoYXNPd25Qcm9wKGIsIGkpKSB7XG4gICAgICAgICAgICBhW2ldID0gYltpXTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChoYXNPd25Qcm9wKGIsICd0b1N0cmluZycpKSB7XG4gICAgICAgIGEudG9TdHJpbmcgPSBiLnRvU3RyaW5nO1xuICAgIH1cblxuICAgIGlmIChoYXNPd25Qcm9wKGIsICd2YWx1ZU9mJykpIHtcbiAgICAgICAgYS52YWx1ZU9mID0gYi52YWx1ZU9mO1xuICAgIH1cblxuICAgIHJldHVybiBhO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVVVEMgKGlucHV0LCBmb3JtYXQsIGxvY2FsZSwgc3RyaWN0KSB7XG4gICAgcmV0dXJuIGNyZWF0ZUxvY2FsT3JVVEMoaW5wdXQsIGZvcm1hdCwgbG9jYWxlLCBzdHJpY3QsIHRydWUpLnV0YygpO1xufVxuXG5mdW5jdGlvbiBkZWZhdWx0UGFyc2luZ0ZsYWdzKCkge1xuICAgIC8vIFdlIG5lZWQgdG8gZGVlcCBjbG9uZSB0aGlzIG9iamVjdC5cbiAgICByZXR1cm4ge1xuICAgICAgICBlbXB0eSAgICAgICAgICAgOiBmYWxzZSxcbiAgICAgICAgdW51c2VkVG9rZW5zICAgIDogW10sXG4gICAgICAgIHVudXNlZElucHV0ICAgICA6IFtdLFxuICAgICAgICBvdmVyZmxvdyAgICAgICAgOiAtMixcbiAgICAgICAgY2hhcnNMZWZ0T3ZlciAgIDogMCxcbiAgICAgICAgbnVsbElucHV0ICAgICAgIDogZmFsc2UsXG4gICAgICAgIGludmFsaWRNb250aCAgICA6IG51bGwsXG4gICAgICAgIGludmFsaWRGb3JtYXQgICA6IGZhbHNlLFxuICAgICAgICB1c2VySW52YWxpZGF0ZWQgOiBmYWxzZSxcbiAgICAgICAgaXNvICAgICAgICAgICAgIDogZmFsc2UsXG4gICAgICAgIHBhcnNlZERhdGVQYXJ0cyA6IFtdLFxuICAgICAgICBtZXJpZGllbSAgICAgICAgOiBudWxsLFxuICAgICAgICByZmMyODIyICAgICAgICAgOiBmYWxzZSxcbiAgICAgICAgd2Vla2RheU1pc21hdGNoIDogZmFsc2VcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBnZXRQYXJzaW5nRmxhZ3MobSkge1xuICAgIGlmIChtLl9wZiA9PSBudWxsKSB7XG4gICAgICAgIG0uX3BmID0gZGVmYXVsdFBhcnNpbmdGbGFncygpO1xuICAgIH1cbiAgICByZXR1cm4gbS5fcGY7XG59XG5cbnZhciBzb21lO1xuaWYgKEFycmF5LnByb3RvdHlwZS5zb21lKSB7XG4gICAgc29tZSA9IEFycmF5LnByb3RvdHlwZS5zb21lO1xufSBlbHNlIHtcbiAgICBzb21lID0gZnVuY3Rpb24gKGZ1bikge1xuICAgICAgICB2YXIgdCA9IE9iamVjdCh0aGlzKTtcbiAgICAgICAgdmFyIGxlbiA9IHQubGVuZ3RoID4+PiAwO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChpIGluIHQgJiYgZnVuLmNhbGwodGhpcywgdFtpXSwgaSwgdCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xufVxuXG52YXIgc29tZSQxID0gc29tZTtcblxuZnVuY3Rpb24gaXNWYWxpZChtKSB7XG4gICAgaWYgKG0uX2lzVmFsaWQgPT0gbnVsbCkge1xuICAgICAgICB2YXIgZmxhZ3MgPSBnZXRQYXJzaW5nRmxhZ3MobSk7XG4gICAgICAgIHZhciBwYXJzZWRQYXJ0cyA9IHNvbWUkMS5jYWxsKGZsYWdzLnBhcnNlZERhdGVQYXJ0cywgZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgIHJldHVybiBpICE9IG51bGw7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgaXNOb3dWYWxpZCA9ICFpc05hTihtLl9kLmdldFRpbWUoKSkgJiZcbiAgICAgICAgICAgIGZsYWdzLm92ZXJmbG93IDwgMCAmJlxuICAgICAgICAgICAgIWZsYWdzLmVtcHR5ICYmXG4gICAgICAgICAgICAhZmxhZ3MuaW52YWxpZE1vbnRoICYmXG4gICAgICAgICAgICAhZmxhZ3MuaW52YWxpZFdlZWtkYXkgJiZcbiAgICAgICAgICAgICFmbGFncy5udWxsSW5wdXQgJiZcbiAgICAgICAgICAgICFmbGFncy5pbnZhbGlkRm9ybWF0ICYmXG4gICAgICAgICAgICAhZmxhZ3MudXNlckludmFsaWRhdGVkICYmXG4gICAgICAgICAgICAoIWZsYWdzLm1lcmlkaWVtIHx8IChmbGFncy5tZXJpZGllbSAmJiBwYXJzZWRQYXJ0cykpO1xuXG4gICAgICAgIGlmIChtLl9zdHJpY3QpIHtcbiAgICAgICAgICAgIGlzTm93VmFsaWQgPSBpc05vd1ZhbGlkICYmXG4gICAgICAgICAgICAgICAgZmxhZ3MuY2hhcnNMZWZ0T3ZlciA9PT0gMCAmJlxuICAgICAgICAgICAgICAgIGZsYWdzLnVudXNlZFRva2Vucy5sZW5ndGggPT09IDAgJiZcbiAgICAgICAgICAgICAgICBmbGFncy5iaWdIb3VyID09PSB1bmRlZmluZWQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoT2JqZWN0LmlzRnJvemVuID09IG51bGwgfHwgIU9iamVjdC5pc0Zyb3plbihtKSkge1xuICAgICAgICAgICAgbS5faXNWYWxpZCA9IGlzTm93VmFsaWQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gaXNOb3dWYWxpZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbS5faXNWYWxpZDtcbn1cblxuZnVuY3Rpb24gY3JlYXRlSW52YWxpZCAoZmxhZ3MpIHtcbiAgICB2YXIgbSA9IGNyZWF0ZVVUQyhOYU4pO1xuICAgIGlmIChmbGFncyAhPSBudWxsKSB7XG4gICAgICAgIGV4dGVuZChnZXRQYXJzaW5nRmxhZ3MobSksIGZsYWdzKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGdldFBhcnNpbmdGbGFncyhtKS51c2VySW52YWxpZGF0ZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBtO1xufVxuXG4vLyBQbHVnaW5zIHRoYXQgYWRkIHByb3BlcnRpZXMgc2hvdWxkIGFsc28gYWRkIHRoZSBrZXkgaGVyZSAobnVsbCB2YWx1ZSksXG4vLyBzbyB3ZSBjYW4gcHJvcGVybHkgY2xvbmUgb3Vyc2VsdmVzLlxudmFyIG1vbWVudFByb3BlcnRpZXMgPSBob29rcy5tb21lbnRQcm9wZXJ0aWVzID0gW107XG5cbmZ1bmN0aW9uIGNvcHlDb25maWcodG8sIGZyb20pIHtcbiAgICB2YXIgaSwgcHJvcCwgdmFsO1xuXG4gICAgaWYgKCFpc1VuZGVmaW5lZChmcm9tLl9pc0FNb21lbnRPYmplY3QpKSB7XG4gICAgICAgIHRvLl9pc0FNb21lbnRPYmplY3QgPSBmcm9tLl9pc0FNb21lbnRPYmplY3Q7XG4gICAgfVxuICAgIGlmICghaXNVbmRlZmluZWQoZnJvbS5faSkpIHtcbiAgICAgICAgdG8uX2kgPSBmcm9tLl9pO1xuICAgIH1cbiAgICBpZiAoIWlzVW5kZWZpbmVkKGZyb20uX2YpKSB7XG4gICAgICAgIHRvLl9mID0gZnJvbS5fZjtcbiAgICB9XG4gICAgaWYgKCFpc1VuZGVmaW5lZChmcm9tLl9sKSkge1xuICAgICAgICB0by5fbCA9IGZyb20uX2w7XG4gICAgfVxuICAgIGlmICghaXNVbmRlZmluZWQoZnJvbS5fc3RyaWN0KSkge1xuICAgICAgICB0by5fc3RyaWN0ID0gZnJvbS5fc3RyaWN0O1xuICAgIH1cbiAgICBpZiAoIWlzVW5kZWZpbmVkKGZyb20uX3R6bSkpIHtcbiAgICAgICAgdG8uX3R6bSA9IGZyb20uX3R6bTtcbiAgICB9XG4gICAgaWYgKCFpc1VuZGVmaW5lZChmcm9tLl9pc1VUQykpIHtcbiAgICAgICAgdG8uX2lzVVRDID0gZnJvbS5faXNVVEM7XG4gICAgfVxuICAgIGlmICghaXNVbmRlZmluZWQoZnJvbS5fb2Zmc2V0KSkge1xuICAgICAgICB0by5fb2Zmc2V0ID0gZnJvbS5fb2Zmc2V0O1xuICAgIH1cbiAgICBpZiAoIWlzVW5kZWZpbmVkKGZyb20uX3BmKSkge1xuICAgICAgICB0by5fcGYgPSBnZXRQYXJzaW5nRmxhZ3MoZnJvbSk7XG4gICAgfVxuICAgIGlmICghaXNVbmRlZmluZWQoZnJvbS5fbG9jYWxlKSkge1xuICAgICAgICB0by5fbG9jYWxlID0gZnJvbS5fbG9jYWxlO1xuICAgIH1cblxuICAgIGlmIChtb21lbnRQcm9wZXJ0aWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IG1vbWVudFByb3BlcnRpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHByb3AgPSBtb21lbnRQcm9wZXJ0aWVzW2ldO1xuICAgICAgICAgICAgdmFsID0gZnJvbVtwcm9wXTtcbiAgICAgICAgICAgIGlmICghaXNVbmRlZmluZWQodmFsKSkge1xuICAgICAgICAgICAgICAgIHRvW3Byb3BdID0gdmFsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRvO1xufVxuXG52YXIgdXBkYXRlSW5Qcm9ncmVzcyA9IGZhbHNlO1xuXG4vLyBNb21lbnQgcHJvdG90eXBlIG9iamVjdFxuZnVuY3Rpb24gTW9tZW50KGNvbmZpZykge1xuICAgIGNvcHlDb25maWcodGhpcywgY29uZmlnKTtcbiAgICB0aGlzLl9kID0gbmV3IERhdGUoY29uZmlnLl9kICE9IG51bGwgPyBjb25maWcuX2QuZ2V0VGltZSgpIDogTmFOKTtcbiAgICBpZiAoIXRoaXMuaXNWYWxpZCgpKSB7XG4gICAgICAgIHRoaXMuX2QgPSBuZXcgRGF0ZShOYU4pO1xuICAgIH1cbiAgICAvLyBQcmV2ZW50IGluZmluaXRlIGxvb3AgaW4gY2FzZSB1cGRhdGVPZmZzZXQgY3JlYXRlcyBuZXcgbW9tZW50XG4gICAgLy8gb2JqZWN0cy5cbiAgICBpZiAodXBkYXRlSW5Qcm9ncmVzcyA9PT0gZmFsc2UpIHtcbiAgICAgICAgdXBkYXRlSW5Qcm9ncmVzcyA9IHRydWU7XG4gICAgICAgIGhvb2tzLnVwZGF0ZU9mZnNldCh0aGlzKTtcbiAgICAgICAgdXBkYXRlSW5Qcm9ncmVzcyA9IGZhbHNlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gaXNNb21lbnQgKG9iaikge1xuICAgIHJldHVybiBvYmogaW5zdGFuY2VvZiBNb21lbnQgfHwgKG9iaiAhPSBudWxsICYmIG9iai5faXNBTW9tZW50T2JqZWN0ICE9IG51bGwpO1xufVxuXG5mdW5jdGlvbiBhYnNGbG9vciAobnVtYmVyKSB7XG4gICAgaWYgKG51bWJlciA8IDApIHtcbiAgICAgICAgLy8gLTAgLT4gMFxuICAgICAgICByZXR1cm4gTWF0aC5jZWlsKG51bWJlcikgfHwgMDtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihudW1iZXIpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdG9JbnQoYXJndW1lbnRGb3JDb2VyY2lvbikge1xuICAgIHZhciBjb2VyY2VkTnVtYmVyID0gK2FyZ3VtZW50Rm9yQ29lcmNpb24sXG4gICAgICAgIHZhbHVlID0gMDtcblxuICAgIGlmIChjb2VyY2VkTnVtYmVyICE9PSAwICYmIGlzRmluaXRlKGNvZXJjZWROdW1iZXIpKSB7XG4gICAgICAgIHZhbHVlID0gYWJzRmxvb3IoY29lcmNlZE51bWJlcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHZhbHVlO1xufVxuXG4vLyBjb21wYXJlIHR3byBhcnJheXMsIHJldHVybiB0aGUgbnVtYmVyIG9mIGRpZmZlcmVuY2VzXG5mdW5jdGlvbiBjb21wYXJlQXJyYXlzKGFycmF5MSwgYXJyYXkyLCBkb250Q29udmVydCkge1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihhcnJheTEubGVuZ3RoLCBhcnJheTIubGVuZ3RoKSxcbiAgICAgICAgbGVuZ3RoRGlmZiA9IE1hdGguYWJzKGFycmF5MS5sZW5ndGggLSBhcnJheTIubGVuZ3RoKSxcbiAgICAgICAgZGlmZnMgPSAwLFxuICAgICAgICBpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAoKGRvbnRDb252ZXJ0ICYmIGFycmF5MVtpXSAhPT0gYXJyYXkyW2ldKSB8fFxuICAgICAgICAgICAgKCFkb250Q29udmVydCAmJiB0b0ludChhcnJheTFbaV0pICE9PSB0b0ludChhcnJheTJbaV0pKSkge1xuICAgICAgICAgICAgZGlmZnMrKztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZGlmZnMgKyBsZW5ndGhEaWZmO1xufVxuXG5mdW5jdGlvbiB3YXJuKG1zZykge1xuICAgIGlmIChob29rcy5zdXBwcmVzc0RlcHJlY2F0aW9uV2FybmluZ3MgPT09IGZhbHNlICYmXG4gICAgICAgICAgICAodHlwZW9mIGNvbnNvbGUgIT09ICAndW5kZWZpbmVkJykgJiYgY29uc29sZS53YXJuKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignRGVwcmVjYXRpb24gd2FybmluZzogJyArIG1zZyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkZXByZWNhdGUobXNnLCBmbikge1xuICAgIHZhciBmaXJzdFRpbWUgPSB0cnVlO1xuXG4gICAgcmV0dXJuIGV4dGVuZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChob29rcy5kZXByZWNhdGlvbkhhbmRsZXIgIT0gbnVsbCkge1xuICAgICAgICAgICAgaG9va3MuZGVwcmVjYXRpb25IYW5kbGVyKG51bGwsIG1zZyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZpcnN0VGltZSkge1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgIHZhciBhcmc7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGFyZyA9ICcnO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYXJndW1lbnRzW2ldID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICBhcmcgKz0gJ1xcblsnICsgaSArICddICc7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBhcmd1bWVudHNbMF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZyArPSBrZXkgKyAnOiAnICsgYXJndW1lbnRzWzBdW2tleV0gKyAnLCAnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGFyZyA9IGFyZy5zbGljZSgwLCAtMik7IC8vIFJlbW92ZSB0cmFpbGluZyBjb21tYSBhbmQgc3BhY2VcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhcmcgPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFyZ3MucHVzaChhcmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2Fybihtc2cgKyAnXFxuQXJndW1lbnRzOiAnICsgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJncykuam9pbignJykgKyAnXFxuJyArIChuZXcgRXJyb3IoKSkuc3RhY2spO1xuICAgICAgICAgICAgZmlyc3RUaW1lID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfSwgZm4pO1xufVxuXG52YXIgZGVwcmVjYXRpb25zID0ge307XG5cbmZ1bmN0aW9uIGRlcHJlY2F0ZVNpbXBsZShuYW1lLCBtc2cpIHtcbiAgICBpZiAoaG9va3MuZGVwcmVjYXRpb25IYW5kbGVyICE9IG51bGwpIHtcbiAgICAgICAgaG9va3MuZGVwcmVjYXRpb25IYW5kbGVyKG5hbWUsIG1zZyk7XG4gICAgfVxuICAgIGlmICghZGVwcmVjYXRpb25zW25hbWVdKSB7XG4gICAgICAgIHdhcm4obXNnKTtcbiAgICAgICAgZGVwcmVjYXRpb25zW25hbWVdID0gdHJ1ZTtcbiAgICB9XG59XG5cbmhvb2tzLnN1cHByZXNzRGVwcmVjYXRpb25XYXJuaW5ncyA9IGZhbHNlO1xuaG9va3MuZGVwcmVjYXRpb25IYW5kbGVyID0gbnVsbDtcblxuZnVuY3Rpb24gaXNGdW5jdGlvbihpbnB1dCkge1xuICAgIHJldHVybiBpbnB1dCBpbnN0YW5jZW9mIEZ1bmN0aW9uIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpbnB1dCkgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7XG59XG5cbmZ1bmN0aW9uIHNldCAoY29uZmlnKSB7XG4gICAgdmFyIHByb3AsIGk7XG4gICAgZm9yIChpIGluIGNvbmZpZykge1xuICAgICAgICBwcm9wID0gY29uZmlnW2ldO1xuICAgICAgICBpZiAoaXNGdW5jdGlvbihwcm9wKSkge1xuICAgICAgICAgICAgdGhpc1tpXSA9IHByb3A7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzWydfJyArIGldID0gcHJvcDtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0aGlzLl9jb25maWcgPSBjb25maWc7XG4gICAgLy8gTGVuaWVudCBvcmRpbmFsIHBhcnNpbmcgYWNjZXB0cyBqdXN0IGEgbnVtYmVyIGluIGFkZGl0aW9uIHRvXG4gICAgLy8gbnVtYmVyICsgKHBvc3NpYmx5KSBzdHVmZiBjb21pbmcgZnJvbSBfZGF5T2ZNb250aE9yZGluYWxQYXJzZS5cbiAgICAvLyBUT0RPOiBSZW1vdmUgXCJvcmRpbmFsUGFyc2VcIiBmYWxsYmFjayBpbiBuZXh0IG1ham9yIHJlbGVhc2UuXG4gICAgdGhpcy5fZGF5T2ZNb250aE9yZGluYWxQYXJzZUxlbmllbnQgPSBuZXcgUmVnRXhwKFxuICAgICAgICAodGhpcy5fZGF5T2ZNb250aE9yZGluYWxQYXJzZS5zb3VyY2UgfHwgdGhpcy5fb3JkaW5hbFBhcnNlLnNvdXJjZSkgK1xuICAgICAgICAgICAgJ3wnICsgKC9cXGR7MSwyfS8pLnNvdXJjZSk7XG59XG5cbmZ1bmN0aW9uIG1lcmdlQ29uZmlncyhwYXJlbnRDb25maWcsIGNoaWxkQ29uZmlnKSB7XG4gICAgdmFyIHJlcyA9IGV4dGVuZCh7fSwgcGFyZW50Q29uZmlnKSwgcHJvcDtcbiAgICBmb3IgKHByb3AgaW4gY2hpbGRDb25maWcpIHtcbiAgICAgICAgaWYgKGhhc093blByb3AoY2hpbGRDb25maWcsIHByb3ApKSB7XG4gICAgICAgICAgICBpZiAoaXNPYmplY3QocGFyZW50Q29uZmlnW3Byb3BdKSAmJiBpc09iamVjdChjaGlsZENvbmZpZ1twcm9wXSkpIHtcbiAgICAgICAgICAgICAgICByZXNbcHJvcF0gPSB7fTtcbiAgICAgICAgICAgICAgICBleHRlbmQocmVzW3Byb3BdLCBwYXJlbnRDb25maWdbcHJvcF0pO1xuICAgICAgICAgICAgICAgIGV4dGVuZChyZXNbcHJvcF0sIGNoaWxkQ29uZmlnW3Byb3BdKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hpbGRDb25maWdbcHJvcF0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJlc1twcm9wXSA9IGNoaWxkQ29uZmlnW3Byb3BdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgcmVzW3Byb3BdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGZvciAocHJvcCBpbiBwYXJlbnRDb25maWcpIHtcbiAgICAgICAgaWYgKGhhc093blByb3AocGFyZW50Q29uZmlnLCBwcm9wKSAmJlxuICAgICAgICAgICAgICAgICFoYXNPd25Qcm9wKGNoaWxkQ29uZmlnLCBwcm9wKSAmJlxuICAgICAgICAgICAgICAgIGlzT2JqZWN0KHBhcmVudENvbmZpZ1twcm9wXSkpIHtcbiAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSBjaGFuZ2VzIHRvIHByb3BlcnRpZXMgZG9uJ3QgbW9kaWZ5IHBhcmVudCBjb25maWdcbiAgICAgICAgICAgIHJlc1twcm9wXSA9IGV4dGVuZCh7fSwgcmVzW3Byb3BdKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzO1xufVxuXG5mdW5jdGlvbiBMb2NhbGUoY29uZmlnKSB7XG4gICAgaWYgKGNvbmZpZyAhPSBudWxsKSB7XG4gICAgICAgIHRoaXMuc2V0KGNvbmZpZyk7XG4gICAgfVxufVxuXG52YXIga2V5cztcblxuaWYgKE9iamVjdC5rZXlzKSB7XG4gICAga2V5cyA9IE9iamVjdC5rZXlzO1xufSBlbHNlIHtcbiAgICBrZXlzID0gZnVuY3Rpb24gKG9iaikge1xuICAgICAgICB2YXIgaSwgcmVzID0gW107XG4gICAgICAgIGZvciAoaSBpbiBvYmopIHtcbiAgICAgICAgICAgIGlmIChoYXNPd25Qcm9wKG9iaiwgaSkpIHtcbiAgICAgICAgICAgICAgICByZXMucHVzaChpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH07XG59XG5cbnZhciBrZXlzJDEgPSBrZXlzO1xuXG52YXIgZGVmYXVsdENhbGVuZGFyID0ge1xuICAgIHNhbWVEYXkgOiAnW1RvZGF5IGF0XSBMVCcsXG4gICAgbmV4dERheSA6ICdbVG9tb3Jyb3cgYXRdIExUJyxcbiAgICBuZXh0V2VlayA6ICdkZGRkIFthdF0gTFQnLFxuICAgIGxhc3REYXkgOiAnW1llc3RlcmRheSBhdF0gTFQnLFxuICAgIGxhc3RXZWVrIDogJ1tMYXN0XSBkZGRkIFthdF0gTFQnLFxuICAgIHNhbWVFbHNlIDogJ0wnXG59O1xuXG5mdW5jdGlvbiBjYWxlbmRhciAoa2V5LCBtb20sIG5vdykge1xuICAgIHZhciBvdXRwdXQgPSB0aGlzLl9jYWxlbmRhcltrZXldIHx8IHRoaXMuX2NhbGVuZGFyWydzYW1lRWxzZSddO1xuICAgIHJldHVybiBpc0Z1bmN0aW9uKG91dHB1dCkgPyBvdXRwdXQuY2FsbChtb20sIG5vdykgOiBvdXRwdXQ7XG59XG5cbnZhciBkZWZhdWx0TG9uZ0RhdGVGb3JtYXQgPSB7XG4gICAgTFRTICA6ICdoOm1tOnNzIEEnLFxuICAgIExUICAgOiAnaDptbSBBJyxcbiAgICBMICAgIDogJ01NL0REL1lZWVknLFxuICAgIExMICAgOiAnTU1NTSBELCBZWVlZJyxcbiAgICBMTEwgIDogJ01NTU0gRCwgWVlZWSBoOm1tIEEnLFxuICAgIExMTEwgOiAnZGRkZCwgTU1NTSBELCBZWVlZIGg6bW0gQSdcbn07XG5cbmZ1bmN0aW9uIGxvbmdEYXRlRm9ybWF0IChrZXkpIHtcbiAgICB2YXIgZm9ybWF0ID0gdGhpcy5fbG9uZ0RhdGVGb3JtYXRba2V5XSxcbiAgICAgICAgZm9ybWF0VXBwZXIgPSB0aGlzLl9sb25nRGF0ZUZvcm1hdFtrZXkudG9VcHBlckNhc2UoKV07XG5cbiAgICBpZiAoZm9ybWF0IHx8ICFmb3JtYXRVcHBlcikge1xuICAgICAgICByZXR1cm4gZm9ybWF0O1xuICAgIH1cblxuICAgIHRoaXMuX2xvbmdEYXRlRm9ybWF0W2tleV0gPSBmb3JtYXRVcHBlci5yZXBsYWNlKC9NTU1NfE1NfEREfGRkZGQvZywgZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICByZXR1cm4gdmFsLnNsaWNlKDEpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRoaXMuX2xvbmdEYXRlRm9ybWF0W2tleV07XG59XG5cbnZhciBkZWZhdWx0SW52YWxpZERhdGUgPSAnSW52YWxpZCBkYXRlJztcblxuZnVuY3Rpb24gaW52YWxpZERhdGUgKCkge1xuICAgIHJldHVybiB0aGlzLl9pbnZhbGlkRGF0ZTtcbn1cblxudmFyIGRlZmF1bHRPcmRpbmFsID0gJyVkJztcbnZhciBkZWZhdWx0RGF5T2ZNb250aE9yZGluYWxQYXJzZSA9IC9cXGR7MSwyfS87XG5cbmZ1bmN0aW9uIG9yZGluYWwgKG51bWJlcikge1xuICAgIHJldHVybiB0aGlzLl9vcmRpbmFsLnJlcGxhY2UoJyVkJywgbnVtYmVyKTtcbn1cblxudmFyIGRlZmF1bHRSZWxhdGl2ZVRpbWUgPSB7XG4gICAgZnV0dXJlIDogJ2luICVzJyxcbiAgICBwYXN0ICAgOiAnJXMgYWdvJyxcbiAgICBzICA6ICdhIGZldyBzZWNvbmRzJyxcbiAgICBzcyA6ICclZCBzZWNvbmRzJyxcbiAgICBtICA6ICdhIG1pbnV0ZScsXG4gICAgbW0gOiAnJWQgbWludXRlcycsXG4gICAgaCAgOiAnYW4gaG91cicsXG4gICAgaGggOiAnJWQgaG91cnMnLFxuICAgIGQgIDogJ2EgZGF5JyxcbiAgICBkZCA6ICclZCBkYXlzJyxcbiAgICBNICA6ICdhIG1vbnRoJyxcbiAgICBNTSA6ICclZCBtb250aHMnLFxuICAgIHkgIDogJ2EgeWVhcicsXG4gICAgeXkgOiAnJWQgeWVhcnMnXG59O1xuXG5mdW5jdGlvbiByZWxhdGl2ZVRpbWUgKG51bWJlciwgd2l0aG91dFN1ZmZpeCwgc3RyaW5nLCBpc0Z1dHVyZSkge1xuICAgIHZhciBvdXRwdXQgPSB0aGlzLl9yZWxhdGl2ZVRpbWVbc3RyaW5nXTtcbiAgICByZXR1cm4gKGlzRnVuY3Rpb24ob3V0cHV0KSkgP1xuICAgICAgICBvdXRwdXQobnVtYmVyLCB3aXRob3V0U3VmZml4LCBzdHJpbmcsIGlzRnV0dXJlKSA6XG4gICAgICAgIG91dHB1dC5yZXBsYWNlKC8lZC9pLCBudW1iZXIpO1xufVxuXG5mdW5jdGlvbiBwYXN0RnV0dXJlIChkaWZmLCBvdXRwdXQpIHtcbiAgICB2YXIgZm9ybWF0ID0gdGhpcy5fcmVsYXRpdmVUaW1lW2RpZmYgPiAwID8gJ2Z1dHVyZScgOiAncGFzdCddO1xuICAgIHJldHVybiBpc0Z1bmN0aW9uKGZvcm1hdCkgPyBmb3JtYXQob3V0cHV0KSA6IGZvcm1hdC5yZXBsYWNlKC8lcy9pLCBvdXRwdXQpO1xufVxuXG52YXIgYWxpYXNlcyA9IHt9O1xuXG5mdW5jdGlvbiBhZGRVbml0QWxpYXMgKHVuaXQsIHNob3J0aGFuZCkge1xuICAgIHZhciBsb3dlckNhc2UgPSB1bml0LnRvTG93ZXJDYXNlKCk7XG4gICAgYWxpYXNlc1tsb3dlckNhc2VdID0gYWxpYXNlc1tsb3dlckNhc2UgKyAncyddID0gYWxpYXNlc1tzaG9ydGhhbmRdID0gdW5pdDtcbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplVW5pdHModW5pdHMpIHtcbiAgICByZXR1cm4gdHlwZW9mIHVuaXRzID09PSAnc3RyaW5nJyA/IGFsaWFzZXNbdW5pdHNdIHx8IGFsaWFzZXNbdW5pdHMudG9Mb3dlckNhc2UoKV0gOiB1bmRlZmluZWQ7XG59XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZU9iamVjdFVuaXRzKGlucHV0T2JqZWN0KSB7XG4gICAgdmFyIG5vcm1hbGl6ZWRJbnB1dCA9IHt9LFxuICAgICAgICBub3JtYWxpemVkUHJvcCxcbiAgICAgICAgcHJvcDtcblxuICAgIGZvciAocHJvcCBpbiBpbnB1dE9iamVjdCkge1xuICAgICAgICBpZiAoaGFzT3duUHJvcChpbnB1dE9iamVjdCwgcHJvcCkpIHtcbiAgICAgICAgICAgIG5vcm1hbGl6ZWRQcm9wID0gbm9ybWFsaXplVW5pdHMocHJvcCk7XG4gICAgICAgICAgICBpZiAobm9ybWFsaXplZFByb3ApIHtcbiAgICAgICAgICAgICAgICBub3JtYWxpemVkSW5wdXRbbm9ybWFsaXplZFByb3BdID0gaW5wdXRPYmplY3RbcHJvcF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbm9ybWFsaXplZElucHV0O1xufVxuXG52YXIgcHJpb3JpdGllcyA9IHt9O1xuXG5mdW5jdGlvbiBhZGRVbml0UHJpb3JpdHkodW5pdCwgcHJpb3JpdHkpIHtcbiAgICBwcmlvcml0aWVzW3VuaXRdID0gcHJpb3JpdHk7XG59XG5cbmZ1bmN0aW9uIGdldFByaW9yaXRpemVkVW5pdHModW5pdHNPYmopIHtcbiAgICB2YXIgdW5pdHMgPSBbXTtcbiAgICBmb3IgKHZhciB1IGluIHVuaXRzT2JqKSB7XG4gICAgICAgIHVuaXRzLnB1c2goe3VuaXQ6IHUsIHByaW9yaXR5OiBwcmlvcml0aWVzW3VdfSk7XG4gICAgfVxuICAgIHVuaXRzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGEucHJpb3JpdHkgLSBiLnByaW9yaXR5O1xuICAgIH0pO1xuICAgIHJldHVybiB1bml0cztcbn1cblxuZnVuY3Rpb24gbWFrZUdldFNldCAodW5pdCwga2VlcFRpbWUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSB7XG4gICAgICAgICAgICBzZXQkMSh0aGlzLCB1bml0LCB2YWx1ZSk7XG4gICAgICAgICAgICBob29rcy51cGRhdGVPZmZzZXQodGhpcywga2VlcFRpbWUpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0KHRoaXMsIHVuaXQpO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gZ2V0IChtb20sIHVuaXQpIHtcbiAgICByZXR1cm4gbW9tLmlzVmFsaWQoKSA/XG4gICAgICAgIG1vbS5fZFsnZ2V0JyArIChtb20uX2lzVVRDID8gJ1VUQycgOiAnJykgKyB1bml0XSgpIDogTmFOO1xufVxuXG5mdW5jdGlvbiBzZXQkMSAobW9tLCB1bml0LCB2YWx1ZSkge1xuICAgIGlmIChtb20uaXNWYWxpZCgpKSB7XG4gICAgICAgIG1vbS5fZFsnc2V0JyArIChtb20uX2lzVVRDID8gJ1VUQycgOiAnJykgKyB1bml0XSh2YWx1ZSk7XG4gICAgfVxufVxuXG4vLyBNT01FTlRTXG5cbmZ1bmN0aW9uIHN0cmluZ0dldCAodW5pdHMpIHtcbiAgICB1bml0cyA9IG5vcm1hbGl6ZVVuaXRzKHVuaXRzKTtcbiAgICBpZiAoaXNGdW5jdGlvbih0aGlzW3VuaXRzXSkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXNbdW5pdHNdKCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xufVxuXG5cbmZ1bmN0aW9uIHN0cmluZ1NldCAodW5pdHMsIHZhbHVlKSB7XG4gICAgaWYgKHR5cGVvZiB1bml0cyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgdW5pdHMgPSBub3JtYWxpemVPYmplY3RVbml0cyh1bml0cyk7XG4gICAgICAgIHZhciBwcmlvcml0aXplZCA9IGdldFByaW9yaXRpemVkVW5pdHModW5pdHMpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByaW9yaXRpemVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzW3ByaW9yaXRpemVkW2ldLnVuaXRdKHVuaXRzW3ByaW9yaXRpemVkW2ldLnVuaXRdKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHVuaXRzID0gbm9ybWFsaXplVW5pdHModW5pdHMpO1xuICAgICAgICBpZiAoaXNGdW5jdGlvbih0aGlzW3VuaXRzXSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzW3VuaXRzXSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG59XG5cbmZ1bmN0aW9uIHplcm9GaWxsKG51bWJlciwgdGFyZ2V0TGVuZ3RoLCBmb3JjZVNpZ24pIHtcbiAgICB2YXIgYWJzTnVtYmVyID0gJycgKyBNYXRoLmFicyhudW1iZXIpLFxuICAgICAgICB6ZXJvc1RvRmlsbCA9IHRhcmdldExlbmd0aCAtIGFic051bWJlci5sZW5ndGgsXG4gICAgICAgIHNpZ24gPSBudW1iZXIgPj0gMDtcbiAgICByZXR1cm4gKHNpZ24gPyAoZm9yY2VTaWduID8gJysnIDogJycpIDogJy0nKSArXG4gICAgICAgIE1hdGgucG93KDEwLCBNYXRoLm1heCgwLCB6ZXJvc1RvRmlsbCkpLnRvU3RyaW5nKCkuc3Vic3RyKDEpICsgYWJzTnVtYmVyO1xufVxuXG52YXIgZm9ybWF0dGluZ1Rva2VucyA9IC8oXFxbW15cXFtdKlxcXSl8KFxcXFwpPyhbSGhdbW0oc3MpP3xNb3xNTT9NP00/fERvfERERG98REQ/RD9EP3xkZGQ/ZD98ZG8/fHdbb3x3XT98V1tvfFddP3xRbz98WVlZWVlZfFlZWVlZfFlZWVl8WVl8Z2coZ2dnPyk/fEdHKEdHRz8pP3xlfEV8YXxBfGhoP3xISD98a2s/fG1tP3xzcz98U3sxLDl9fHh8WHx6ej98Wlo/fC4pL2c7XG5cbnZhciBsb2NhbEZvcm1hdHRpbmdUb2tlbnMgPSAvKFxcW1teXFxbXSpcXF0pfChcXFxcKT8oTFRTfExUfExMP0w/TD98bHsxLDR9KS9nO1xuXG52YXIgZm9ybWF0RnVuY3Rpb25zID0ge307XG5cbnZhciBmb3JtYXRUb2tlbkZ1bmN0aW9ucyA9IHt9O1xuXG4vLyB0b2tlbjogICAgJ00nXG4vLyBwYWRkZWQ6ICAgWydNTScsIDJdXG4vLyBvcmRpbmFsOiAgJ01vJ1xuLy8gY2FsbGJhY2s6IGZ1bmN0aW9uICgpIHsgdGhpcy5tb250aCgpICsgMSB9XG5mdW5jdGlvbiBhZGRGb3JtYXRUb2tlbiAodG9rZW4sIHBhZGRlZCwgb3JkaW5hbCwgY2FsbGJhY2spIHtcbiAgICB2YXIgZnVuYyA9IGNhbGxiYWNrO1xuICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGZ1bmMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpc1tjYWxsYmFja10oKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgaWYgKHRva2VuKSB7XG4gICAgICAgIGZvcm1hdFRva2VuRnVuY3Rpb25zW3Rva2VuXSA9IGZ1bmM7XG4gICAgfVxuICAgIGlmIChwYWRkZWQpIHtcbiAgICAgICAgZm9ybWF0VG9rZW5GdW5jdGlvbnNbcGFkZGVkWzBdXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB6ZXJvRmlsbChmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIHBhZGRlZFsxXSwgcGFkZGVkWzJdKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgaWYgKG9yZGluYWwpIHtcbiAgICAgICAgZm9ybWF0VG9rZW5GdW5jdGlvbnNbb3JkaW5hbF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkub3JkaW5hbChmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIHRva2VuKTtcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJlbW92ZUZvcm1hdHRpbmdUb2tlbnMoaW5wdXQpIHtcbiAgICBpZiAoaW5wdXQubWF0Y2goL1xcW1tcXHNcXFNdLykpIHtcbiAgICAgICAgcmV0dXJuIGlucHV0LnJlcGxhY2UoL15cXFt8XFxdJC9nLCAnJyk7XG4gICAgfVxuICAgIHJldHVybiBpbnB1dC5yZXBsYWNlKC9cXFxcL2csICcnKTtcbn1cblxuZnVuY3Rpb24gbWFrZUZvcm1hdEZ1bmN0aW9uKGZvcm1hdCkge1xuICAgIHZhciBhcnJheSA9IGZvcm1hdC5tYXRjaChmb3JtYXR0aW5nVG9rZW5zKSwgaSwgbGVuZ3RoO1xuXG4gICAgZm9yIChpID0gMCwgbGVuZ3RoID0gYXJyYXkubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGZvcm1hdFRva2VuRnVuY3Rpb25zW2FycmF5W2ldXSkge1xuICAgICAgICAgICAgYXJyYXlbaV0gPSBmb3JtYXRUb2tlbkZ1bmN0aW9uc1thcnJheVtpXV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhcnJheVtpXSA9IHJlbW92ZUZvcm1hdHRpbmdUb2tlbnMoYXJyYXlbaV0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtb20pIHtcbiAgICAgICAgdmFyIG91dHB1dCA9ICcnLCBpO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG91dHB1dCArPSBpc0Z1bmN0aW9uKGFycmF5W2ldKSA/IGFycmF5W2ldLmNhbGwobW9tLCBmb3JtYXQpIDogYXJyYXlbaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9O1xufVxuXG4vLyBmb3JtYXQgZGF0ZSB1c2luZyBuYXRpdmUgZGF0ZSBvYmplY3RcbmZ1bmN0aW9uIGZvcm1hdE1vbWVudChtLCBmb3JtYXQpIHtcbiAgICBpZiAoIW0uaXNWYWxpZCgpKSB7XG4gICAgICAgIHJldHVybiBtLmxvY2FsZURhdGEoKS5pbnZhbGlkRGF0ZSgpO1xuICAgIH1cblxuICAgIGZvcm1hdCA9IGV4cGFuZEZvcm1hdChmb3JtYXQsIG0ubG9jYWxlRGF0YSgpKTtcbiAgICBmb3JtYXRGdW5jdGlvbnNbZm9ybWF0XSA9IGZvcm1hdEZ1bmN0aW9uc1tmb3JtYXRdIHx8IG1ha2VGb3JtYXRGdW5jdGlvbihmb3JtYXQpO1xuXG4gICAgcmV0dXJuIGZvcm1hdEZ1bmN0aW9uc1tmb3JtYXRdKG0pO1xufVxuXG5mdW5jdGlvbiBleHBhbmRGb3JtYXQoZm9ybWF0LCBsb2NhbGUpIHtcbiAgICB2YXIgaSA9IDU7XG5cbiAgICBmdW5jdGlvbiByZXBsYWNlTG9uZ0RhdGVGb3JtYXRUb2tlbnMoaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIGxvY2FsZS5sb25nRGF0ZUZvcm1hdChpbnB1dCkgfHwgaW5wdXQ7XG4gICAgfVxuXG4gICAgbG9jYWxGb3JtYXR0aW5nVG9rZW5zLmxhc3RJbmRleCA9IDA7XG4gICAgd2hpbGUgKGkgPj0gMCAmJiBsb2NhbEZvcm1hdHRpbmdUb2tlbnMudGVzdChmb3JtYXQpKSB7XG4gICAgICAgIGZvcm1hdCA9IGZvcm1hdC5yZXBsYWNlKGxvY2FsRm9ybWF0dGluZ1Rva2VucywgcmVwbGFjZUxvbmdEYXRlRm9ybWF0VG9rZW5zKTtcbiAgICAgICAgbG9jYWxGb3JtYXR0aW5nVG9rZW5zLmxhc3RJbmRleCA9IDA7XG4gICAgICAgIGkgLT0gMTtcbiAgICB9XG5cbiAgICByZXR1cm4gZm9ybWF0O1xufVxuXG52YXIgbWF0Y2gxICAgICAgICAgPSAvXFxkLzsgICAgICAgICAgICAvLyAgICAgICAwIC0gOVxudmFyIG1hdGNoMiAgICAgICAgID0gL1xcZFxcZC87ICAgICAgICAgIC8vICAgICAgMDAgLSA5OVxudmFyIG1hdGNoMyAgICAgICAgID0gL1xcZHszfS87ICAgICAgICAgLy8gICAgIDAwMCAtIDk5OVxudmFyIG1hdGNoNCAgICAgICAgID0gL1xcZHs0fS87ICAgICAgICAgLy8gICAgMDAwMCAtIDk5OTlcbnZhciBtYXRjaDYgICAgICAgICA9IC9bKy1dP1xcZHs2fS87ICAgIC8vIC05OTk5OTkgLSA5OTk5OTlcbnZhciBtYXRjaDF0bzIgICAgICA9IC9cXGRcXGQ/LzsgICAgICAgICAvLyAgICAgICAwIC0gOTlcbnZhciBtYXRjaDN0bzQgICAgICA9IC9cXGRcXGRcXGRcXGQ/LzsgICAgIC8vICAgICA5OTkgLSA5OTk5XG52YXIgbWF0Y2g1dG82ICAgICAgPSAvXFxkXFxkXFxkXFxkXFxkXFxkPy87IC8vICAgOTk5OTkgLSA5OTk5OTlcbnZhciBtYXRjaDF0bzMgICAgICA9IC9cXGR7MSwzfS87ICAgICAgIC8vICAgICAgIDAgLSA5OTlcbnZhciBtYXRjaDF0bzQgICAgICA9IC9cXGR7MSw0fS87ICAgICAgIC8vICAgICAgIDAgLSA5OTk5XG52YXIgbWF0Y2gxdG82ICAgICAgPSAvWystXT9cXGR7MSw2fS87ICAvLyAtOTk5OTk5IC0gOTk5OTk5XG5cbnZhciBtYXRjaFVuc2lnbmVkICA9IC9cXGQrLzsgICAgICAgICAgIC8vICAgICAgIDAgLSBpbmZcbnZhciBtYXRjaFNpZ25lZCAgICA9IC9bKy1dP1xcZCsvOyAgICAgIC8vICAgIC1pbmYgLSBpbmZcblxudmFyIG1hdGNoT2Zmc2V0ICAgID0gL1p8WystXVxcZFxcZDo/XFxkXFxkL2dpOyAvLyArMDA6MDAgLTAwOjAwICswMDAwIC0wMDAwIG9yIFpcbnZhciBtYXRjaFNob3J0T2Zmc2V0ID0gL1p8WystXVxcZFxcZCg/Ojo/XFxkXFxkKT8vZ2k7IC8vICswMCAtMDAgKzAwOjAwIC0wMDowMCArMDAwMCAtMDAwMCBvciBaXG5cbnZhciBtYXRjaFRpbWVzdGFtcCA9IC9bKy1dP1xcZCsoXFwuXFxkezEsM30pPy87IC8vIDEyMzQ1Njc4OSAxMjM0NTY3ODkuMTIzXG5cbi8vIGFueSB3b3JkIChvciB0d28pIGNoYXJhY3RlcnMgb3IgbnVtYmVycyBpbmNsdWRpbmcgdHdvL3RocmVlIHdvcmQgbW9udGggaW4gYXJhYmljLlxuLy8gaW5jbHVkZXMgc2NvdHRpc2ggZ2FlbGljIHR3byB3b3JkIGFuZCBoeXBoZW5hdGVkIG1vbnRoc1xudmFyIG1hdGNoV29yZCA9IC9bMC05XSpbJ2EtelxcdTAwQTAtXFx1MDVGRlxcdTA3MDAtXFx1RDdGRlxcdUY5MDAtXFx1RkRDRlxcdUZERjAtXFx1RkZFRl0rfFtcXHUwNjAwLVxcdTA2RkZcXC9dKyhcXHMqP1tcXHUwNjAwLVxcdTA2RkZdKyl7MSwyfS9pO1xuXG5cbnZhciByZWdleGVzID0ge307XG5cbmZ1bmN0aW9uIGFkZFJlZ2V4VG9rZW4gKHRva2VuLCByZWdleCwgc3RyaWN0UmVnZXgpIHtcbiAgICByZWdleGVzW3Rva2VuXSA9IGlzRnVuY3Rpb24ocmVnZXgpID8gcmVnZXggOiBmdW5jdGlvbiAoaXNTdHJpY3QsIGxvY2FsZURhdGEpIHtcbiAgICAgICAgcmV0dXJuIChpc1N0cmljdCAmJiBzdHJpY3RSZWdleCkgPyBzdHJpY3RSZWdleCA6IHJlZ2V4O1xuICAgIH07XG59XG5cbmZ1bmN0aW9uIGdldFBhcnNlUmVnZXhGb3JUb2tlbiAodG9rZW4sIGNvbmZpZykge1xuICAgIGlmICghaGFzT3duUHJvcChyZWdleGVzLCB0b2tlbikpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZWdFeHAodW5lc2NhcGVGb3JtYXQodG9rZW4pKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVnZXhlc1t0b2tlbl0oY29uZmlnLl9zdHJpY3QsIGNvbmZpZy5fbG9jYWxlKTtcbn1cblxuLy8gQ29kZSBmcm9tIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzU2MTQ5My9pcy10aGVyZS1hLXJlZ2V4cC1lc2NhcGUtZnVuY3Rpb24taW4tamF2YXNjcmlwdFxuZnVuY3Rpb24gdW5lc2NhcGVGb3JtYXQocykge1xuICAgIHJldHVybiByZWdleEVzY2FwZShzLnJlcGxhY2UoJ1xcXFwnLCAnJykucmVwbGFjZSgvXFxcXChcXFspfFxcXFwoXFxdKXxcXFsoW15cXF1cXFtdKilcXF18XFxcXCguKS9nLCBmdW5jdGlvbiAobWF0Y2hlZCwgcDEsIHAyLCBwMywgcDQpIHtcbiAgICAgICAgcmV0dXJuIHAxIHx8IHAyIHx8IHAzIHx8IHA0O1xuICAgIH0pKTtcbn1cblxuZnVuY3Rpb24gcmVnZXhFc2NhcGUocykge1xuICAgIHJldHVybiBzLnJlcGxhY2UoL1stXFwvXFxcXF4kKis/LigpfFtcXF17fV0vZywgJ1xcXFwkJicpO1xufVxuXG52YXIgdG9rZW5zID0ge307XG5cbmZ1bmN0aW9uIGFkZFBhcnNlVG9rZW4gKHRva2VuLCBjYWxsYmFjaykge1xuICAgIHZhciBpLCBmdW5jID0gY2FsbGJhY2s7XG4gICAgaWYgKHR5cGVvZiB0b2tlbiA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgdG9rZW4gPSBbdG9rZW5dO1xuICAgIH1cbiAgICBpZiAoaXNOdW1iZXIoY2FsbGJhY2spKSB7XG4gICAgICAgIGZ1bmMgPSBmdW5jdGlvbiAoaW5wdXQsIGFycmF5KSB7XG4gICAgICAgICAgICBhcnJheVtjYWxsYmFja10gPSB0b0ludChpbnB1dCk7XG4gICAgICAgIH07XG4gICAgfVxuICAgIGZvciAoaSA9IDA7IGkgPCB0b2tlbi5sZW5ndGg7IGkrKykge1xuICAgICAgICB0b2tlbnNbdG9rZW5baV1dID0gZnVuYztcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGFkZFdlZWtQYXJzZVRva2VuICh0b2tlbiwgY2FsbGJhY2spIHtcbiAgICBhZGRQYXJzZVRva2VuKHRva2VuLCBmdW5jdGlvbiAoaW5wdXQsIGFycmF5LCBjb25maWcsIHRva2VuKSB7XG4gICAgICAgIGNvbmZpZy5fdyA9IGNvbmZpZy5fdyB8fCB7fTtcbiAgICAgICAgY2FsbGJhY2soaW5wdXQsIGNvbmZpZy5fdywgY29uZmlnLCB0b2tlbik7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGFkZFRpbWVUb0FycmF5RnJvbVRva2VuKHRva2VuLCBpbnB1dCwgY29uZmlnKSB7XG4gICAgaWYgKGlucHV0ICE9IG51bGwgJiYgaGFzT3duUHJvcCh0b2tlbnMsIHRva2VuKSkge1xuICAgICAgICB0b2tlbnNbdG9rZW5dKGlucHV0LCBjb25maWcuX2EsIGNvbmZpZywgdG9rZW4pO1xuICAgIH1cbn1cblxudmFyIFlFQVIgPSAwO1xudmFyIE1PTlRIID0gMTtcbnZhciBEQVRFID0gMjtcbnZhciBIT1VSID0gMztcbnZhciBNSU5VVEUgPSA0O1xudmFyIFNFQ09ORCA9IDU7XG52YXIgTUlMTElTRUNPTkQgPSA2O1xudmFyIFdFRUsgPSA3O1xudmFyIFdFRUtEQVkgPSA4O1xuXG52YXIgaW5kZXhPZjtcblxuaWYgKEFycmF5LnByb3RvdHlwZS5pbmRleE9mKSB7XG4gICAgaW5kZXhPZiA9IEFycmF5LnByb3RvdHlwZS5pbmRleE9mO1xufSBlbHNlIHtcbiAgICBpbmRleE9mID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgLy8gSSBrbm93XG4gICAgICAgIHZhciBpO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgaWYgKHRoaXNbaV0gPT09IG8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfTtcbn1cblxudmFyIGluZGV4T2YkMSA9IGluZGV4T2Y7XG5cbmZ1bmN0aW9uIGRheXNJbk1vbnRoKHllYXIsIG1vbnRoKSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKERhdGUuVVRDKHllYXIsIG1vbnRoICsgMSwgMCkpLmdldFVUQ0RhdGUoKTtcbn1cblxuLy8gRk9STUFUVElOR1xuXG5hZGRGb3JtYXRUb2tlbignTScsIFsnTU0nLCAyXSwgJ01vJywgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLm1vbnRoKCkgKyAxO1xufSk7XG5cbmFkZEZvcm1hdFRva2VuKCdNTU0nLCAwLCAwLCBmdW5jdGlvbiAoZm9ybWF0KSB7XG4gICAgcmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLm1vbnRoc1Nob3J0KHRoaXMsIGZvcm1hdCk7XG59KTtcblxuYWRkRm9ybWF0VG9rZW4oJ01NTU0nLCAwLCAwLCBmdW5jdGlvbiAoZm9ybWF0KSB7XG4gICAgcmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLm1vbnRocyh0aGlzLCBmb3JtYXQpO1xufSk7XG5cbi8vIEFMSUFTRVNcblxuYWRkVW5pdEFsaWFzKCdtb250aCcsICdNJyk7XG5cbi8vIFBSSU9SSVRZXG5cbmFkZFVuaXRQcmlvcml0eSgnbW9udGgnLCA4KTtcblxuLy8gUEFSU0lOR1xuXG5hZGRSZWdleFRva2VuKCdNJywgICAgbWF0Y2gxdG8yKTtcbmFkZFJlZ2V4VG9rZW4oJ01NJywgICBtYXRjaDF0bzIsIG1hdGNoMik7XG5hZGRSZWdleFRva2VuKCdNTU0nLCAgZnVuY3Rpb24gKGlzU3RyaWN0LCBsb2NhbGUpIHtcbiAgICByZXR1cm4gbG9jYWxlLm1vbnRoc1Nob3J0UmVnZXgoaXNTdHJpY3QpO1xufSk7XG5hZGRSZWdleFRva2VuKCdNTU1NJywgZnVuY3Rpb24gKGlzU3RyaWN0LCBsb2NhbGUpIHtcbiAgICByZXR1cm4gbG9jYWxlLm1vbnRoc1JlZ2V4KGlzU3RyaWN0KTtcbn0pO1xuXG5hZGRQYXJzZVRva2VuKFsnTScsICdNTSddLCBmdW5jdGlvbiAoaW5wdXQsIGFycmF5KSB7XG4gICAgYXJyYXlbTU9OVEhdID0gdG9JbnQoaW5wdXQpIC0gMTtcbn0pO1xuXG5hZGRQYXJzZVRva2VuKFsnTU1NJywgJ01NTU0nXSwgZnVuY3Rpb24gKGlucHV0LCBhcnJheSwgY29uZmlnLCB0b2tlbikge1xuICAgIHZhciBtb250aCA9IGNvbmZpZy5fbG9jYWxlLm1vbnRoc1BhcnNlKGlucHV0LCB0b2tlbiwgY29uZmlnLl9zdHJpY3QpO1xuICAgIC8vIGlmIHdlIGRpZG4ndCBmaW5kIGEgbW9udGggbmFtZSwgbWFyayB0aGUgZGF0ZSBhcyBpbnZhbGlkLlxuICAgIGlmIChtb250aCAhPSBudWxsKSB7XG4gICAgICAgIGFycmF5W01PTlRIXSA9IG1vbnRoO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGdldFBhcnNpbmdGbGFncyhjb25maWcpLmludmFsaWRNb250aCA9IGlucHV0O1xuICAgIH1cbn0pO1xuXG4vLyBMT0NBTEVTXG5cbnZhciBNT05USFNfSU5fRk9STUFUID0gL0Rbb0RdPyhcXFtbXlxcW1xcXV0qXFxdfFxccykrTU1NTT8vO1xudmFyIGRlZmF1bHRMb2NhbGVNb250aHMgPSAnSmFudWFyeV9GZWJydWFyeV9NYXJjaF9BcHJpbF9NYXlfSnVuZV9KdWx5X0F1Z3VzdF9TZXB0ZW1iZXJfT2N0b2Jlcl9Ob3ZlbWJlcl9EZWNlbWJlcicuc3BsaXQoJ18nKTtcbmZ1bmN0aW9uIGxvY2FsZU1vbnRocyAobSwgZm9ybWF0KSB7XG4gICAgaWYgKCFtKSB7XG4gICAgICAgIHJldHVybiBpc0FycmF5KHRoaXMuX21vbnRocykgPyB0aGlzLl9tb250aHMgOlxuICAgICAgICAgICAgdGhpcy5fbW9udGhzWydzdGFuZGFsb25lJ107XG4gICAgfVxuICAgIHJldHVybiBpc0FycmF5KHRoaXMuX21vbnRocykgPyB0aGlzLl9tb250aHNbbS5tb250aCgpXSA6XG4gICAgICAgIHRoaXMuX21vbnRoc1sodGhpcy5fbW9udGhzLmlzRm9ybWF0IHx8IE1PTlRIU19JTl9GT1JNQVQpLnRlc3QoZm9ybWF0KSA/ICdmb3JtYXQnIDogJ3N0YW5kYWxvbmUnXVttLm1vbnRoKCldO1xufVxuXG52YXIgZGVmYXVsdExvY2FsZU1vbnRoc1Nob3J0ID0gJ0phbl9GZWJfTWFyX0Fwcl9NYXlfSnVuX0p1bF9BdWdfU2VwX09jdF9Ob3ZfRGVjJy5zcGxpdCgnXycpO1xuZnVuY3Rpb24gbG9jYWxlTW9udGhzU2hvcnQgKG0sIGZvcm1hdCkge1xuICAgIGlmICghbSkge1xuICAgICAgICByZXR1cm4gaXNBcnJheSh0aGlzLl9tb250aHNTaG9ydCkgPyB0aGlzLl9tb250aHNTaG9ydCA6XG4gICAgICAgICAgICB0aGlzLl9tb250aHNTaG9ydFsnc3RhbmRhbG9uZSddO1xuICAgIH1cbiAgICByZXR1cm4gaXNBcnJheSh0aGlzLl9tb250aHNTaG9ydCkgPyB0aGlzLl9tb250aHNTaG9ydFttLm1vbnRoKCldIDpcbiAgICAgICAgdGhpcy5fbW9udGhzU2hvcnRbTU9OVEhTX0lOX0ZPUk1BVC50ZXN0KGZvcm1hdCkgPyAnZm9ybWF0JyA6ICdzdGFuZGFsb25lJ11bbS5tb250aCgpXTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlU3RyaWN0UGFyc2UobW9udGhOYW1lLCBmb3JtYXQsIHN0cmljdCkge1xuICAgIHZhciBpLCBpaSwgbW9tLCBsbGMgPSBtb250aE5hbWUudG9Mb2NhbGVMb3dlckNhc2UoKTtcbiAgICBpZiAoIXRoaXMuX21vbnRoc1BhcnNlKSB7XG4gICAgICAgIC8vIHRoaXMgaXMgbm90IHVzZWRcbiAgICAgICAgdGhpcy5fbW9udGhzUGFyc2UgPSBbXTtcbiAgICAgICAgdGhpcy5fbG9uZ01vbnRoc1BhcnNlID0gW107XG4gICAgICAgIHRoaXMuX3Nob3J0TW9udGhzUGFyc2UgPSBbXTtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IDEyOyArK2kpIHtcbiAgICAgICAgICAgIG1vbSA9IGNyZWF0ZVVUQyhbMjAwMCwgaV0pO1xuICAgICAgICAgICAgdGhpcy5fc2hvcnRNb250aHNQYXJzZVtpXSA9IHRoaXMubW9udGhzU2hvcnQobW9tLCAnJykudG9Mb2NhbGVMb3dlckNhc2UoKTtcbiAgICAgICAgICAgIHRoaXMuX2xvbmdNb250aHNQYXJzZVtpXSA9IHRoaXMubW9udGhzKG1vbSwgJycpLnRvTG9jYWxlTG93ZXJDYXNlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoc3RyaWN0KSB7XG4gICAgICAgIGlmIChmb3JtYXQgPT09ICdNTU0nKSB7XG4gICAgICAgICAgICBpaSA9IGluZGV4T2YkMS5jYWxsKHRoaXMuX3Nob3J0TW9udGhzUGFyc2UsIGxsYyk7XG4gICAgICAgICAgICByZXR1cm4gaWkgIT09IC0xID8gaWkgOiBudWxsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWkgPSBpbmRleE9mJDEuY2FsbCh0aGlzLl9sb25nTW9udGhzUGFyc2UsIGxsYyk7XG4gICAgICAgICAgICByZXR1cm4gaWkgIT09IC0xID8gaWkgOiBudWxsO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGZvcm1hdCA9PT0gJ01NTScpIHtcbiAgICAgICAgICAgIGlpID0gaW5kZXhPZiQxLmNhbGwodGhpcy5fc2hvcnRNb250aHNQYXJzZSwgbGxjKTtcbiAgICAgICAgICAgIGlmIChpaSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaWk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpaSA9IGluZGV4T2YkMS5jYWxsKHRoaXMuX2xvbmdNb250aHNQYXJzZSwgbGxjKTtcbiAgICAgICAgICAgIHJldHVybiBpaSAhPT0gLTEgPyBpaSA6IG51bGw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpaSA9IGluZGV4T2YkMS5jYWxsKHRoaXMuX2xvbmdNb250aHNQYXJzZSwgbGxjKTtcbiAgICAgICAgICAgIGlmIChpaSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaWk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpaSA9IGluZGV4T2YkMS5jYWxsKHRoaXMuX3Nob3J0TW9udGhzUGFyc2UsIGxsYyk7XG4gICAgICAgICAgICByZXR1cm4gaWkgIT09IC0xID8gaWkgOiBudWxsO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5mdW5jdGlvbiBsb2NhbGVNb250aHNQYXJzZSAobW9udGhOYW1lLCBmb3JtYXQsIHN0cmljdCkge1xuICAgIHZhciBpLCBtb20sIHJlZ2V4O1xuXG4gICAgaWYgKHRoaXMuX21vbnRoc1BhcnNlRXhhY3QpIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZVN0cmljdFBhcnNlLmNhbGwodGhpcywgbW9udGhOYW1lLCBmb3JtYXQsIHN0cmljdCk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLl9tb250aHNQYXJzZSkge1xuICAgICAgICB0aGlzLl9tb250aHNQYXJzZSA9IFtdO1xuICAgICAgICB0aGlzLl9sb25nTW9udGhzUGFyc2UgPSBbXTtcbiAgICAgICAgdGhpcy5fc2hvcnRNb250aHNQYXJzZSA9IFtdO1xuICAgIH1cblxuICAgIC8vIFRPRE86IGFkZCBzb3J0aW5nXG4gICAgLy8gU29ydGluZyBtYWtlcyBzdXJlIGlmIG9uZSBtb250aCAob3IgYWJicikgaXMgYSBwcmVmaXggb2YgYW5vdGhlclxuICAgIC8vIHNlZSBzb3J0aW5nIGluIGNvbXB1dGVNb250aHNQYXJzZVxuICAgIGZvciAoaSA9IDA7IGkgPCAxMjsgaSsrKSB7XG4gICAgICAgIC8vIG1ha2UgdGhlIHJlZ2V4IGlmIHdlIGRvbid0IGhhdmUgaXQgYWxyZWFkeVxuICAgICAgICBtb20gPSBjcmVhdGVVVEMoWzIwMDAsIGldKTtcbiAgICAgICAgaWYgKHN0cmljdCAmJiAhdGhpcy5fbG9uZ01vbnRoc1BhcnNlW2ldKSB7XG4gICAgICAgICAgICB0aGlzLl9sb25nTW9udGhzUGFyc2VbaV0gPSBuZXcgUmVnRXhwKCdeJyArIHRoaXMubW9udGhzKG1vbSwgJycpLnJlcGxhY2UoJy4nLCAnJykgKyAnJCcsICdpJyk7XG4gICAgICAgICAgICB0aGlzLl9zaG9ydE1vbnRoc1BhcnNlW2ldID0gbmV3IFJlZ0V4cCgnXicgKyB0aGlzLm1vbnRoc1Nob3J0KG1vbSwgJycpLnJlcGxhY2UoJy4nLCAnJykgKyAnJCcsICdpJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzdHJpY3QgJiYgIXRoaXMuX21vbnRoc1BhcnNlW2ldKSB7XG4gICAgICAgICAgICByZWdleCA9ICdeJyArIHRoaXMubW9udGhzKG1vbSwgJycpICsgJ3xeJyArIHRoaXMubW9udGhzU2hvcnQobW9tLCAnJyk7XG4gICAgICAgICAgICB0aGlzLl9tb250aHNQYXJzZVtpXSA9IG5ldyBSZWdFeHAocmVnZXgucmVwbGFjZSgnLicsICcnKSwgJ2knKTtcbiAgICAgICAgfVxuICAgICAgICAvLyB0ZXN0IHRoZSByZWdleFxuICAgICAgICBpZiAoc3RyaWN0ICYmIGZvcm1hdCA9PT0gJ01NTU0nICYmIHRoaXMuX2xvbmdNb250aHNQYXJzZVtpXS50ZXN0KG1vbnRoTmFtZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICB9IGVsc2UgaWYgKHN0cmljdCAmJiBmb3JtYXQgPT09ICdNTU0nICYmIHRoaXMuX3Nob3J0TW9udGhzUGFyc2VbaV0udGVzdChtb250aE5hbWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgfSBlbHNlIGlmICghc3RyaWN0ICYmIHRoaXMuX21vbnRoc1BhcnNlW2ldLnRlc3QobW9udGhOYW1lKSkge1xuICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIE1PTUVOVFNcblxuZnVuY3Rpb24gc2V0TW9udGggKG1vbSwgdmFsdWUpIHtcbiAgICB2YXIgZGF5T2ZNb250aDtcblxuICAgIGlmICghbW9tLmlzVmFsaWQoKSkge1xuICAgICAgICAvLyBObyBvcFxuICAgICAgICByZXR1cm4gbW9tO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGlmICgvXlxcZCskLy50ZXN0KHZhbHVlKSkge1xuICAgICAgICAgICAgdmFsdWUgPSB0b0ludCh2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YWx1ZSA9IG1vbS5sb2NhbGVEYXRhKCkubW9udGhzUGFyc2UodmFsdWUpO1xuICAgICAgICAgICAgLy8gVE9ETzogQW5vdGhlciBzaWxlbnQgZmFpbHVyZT9cbiAgICAgICAgICAgIGlmICghaXNOdW1iZXIodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRheU9mTW9udGggPSBNYXRoLm1pbihtb20uZGF0ZSgpLCBkYXlzSW5Nb250aChtb20ueWVhcigpLCB2YWx1ZSkpO1xuICAgIG1vbS5fZFsnc2V0JyArIChtb20uX2lzVVRDID8gJ1VUQycgOiAnJykgKyAnTW9udGgnXSh2YWx1ZSwgZGF5T2ZNb250aCk7XG4gICAgcmV0dXJuIG1vbTtcbn1cblxuZnVuY3Rpb24gZ2V0U2V0TW9udGggKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlICE9IG51bGwpIHtcbiAgICAgICAgc2V0TW9udGgodGhpcywgdmFsdWUpO1xuICAgICAgICBob29rcy51cGRhdGVPZmZzZXQodGhpcywgdHJ1ZSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBnZXQodGhpcywgJ01vbnRoJyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBnZXREYXlzSW5Nb250aCAoKSB7XG4gICAgcmV0dXJuIGRheXNJbk1vbnRoKHRoaXMueWVhcigpLCB0aGlzLm1vbnRoKCkpO1xufVxuXG52YXIgZGVmYXVsdE1vbnRoc1Nob3J0UmVnZXggPSBtYXRjaFdvcmQ7XG5mdW5jdGlvbiBtb250aHNTaG9ydFJlZ2V4IChpc1N0cmljdCkge1xuICAgIGlmICh0aGlzLl9tb250aHNQYXJzZUV4YWN0KSB7XG4gICAgICAgIGlmICghaGFzT3duUHJvcCh0aGlzLCAnX21vbnRoc1JlZ2V4JykpIHtcbiAgICAgICAgICAgIGNvbXB1dGVNb250aHNQYXJzZS5jYWxsKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc1N0cmljdCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21vbnRoc1Nob3J0U3RyaWN0UmVnZXg7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbW9udGhzU2hvcnRSZWdleDtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghaGFzT3duUHJvcCh0aGlzLCAnX21vbnRoc1Nob3J0UmVnZXgnKSkge1xuICAgICAgICAgICAgdGhpcy5fbW9udGhzU2hvcnRSZWdleCA9IGRlZmF1bHRNb250aHNTaG9ydFJlZ2V4O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9tb250aHNTaG9ydFN0cmljdFJlZ2V4ICYmIGlzU3RyaWN0ID9cbiAgICAgICAgICAgIHRoaXMuX21vbnRoc1Nob3J0U3RyaWN0UmVnZXggOiB0aGlzLl9tb250aHNTaG9ydFJlZ2V4O1xuICAgIH1cbn1cblxudmFyIGRlZmF1bHRNb250aHNSZWdleCA9IG1hdGNoV29yZDtcbmZ1bmN0aW9uIG1vbnRoc1JlZ2V4IChpc1N0cmljdCkge1xuICAgIGlmICh0aGlzLl9tb250aHNQYXJzZUV4YWN0KSB7XG4gICAgICAgIGlmICghaGFzT3duUHJvcCh0aGlzLCAnX21vbnRoc1JlZ2V4JykpIHtcbiAgICAgICAgICAgIGNvbXB1dGVNb250aHNQYXJzZS5jYWxsKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc1N0cmljdCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21vbnRoc1N0cmljdFJlZ2V4O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21vbnRoc1JlZ2V4O1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCFoYXNPd25Qcm9wKHRoaXMsICdfbW9udGhzUmVnZXgnKSkge1xuICAgICAgICAgICAgdGhpcy5fbW9udGhzUmVnZXggPSBkZWZhdWx0TW9udGhzUmVnZXg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX21vbnRoc1N0cmljdFJlZ2V4ICYmIGlzU3RyaWN0ID9cbiAgICAgICAgICAgIHRoaXMuX21vbnRoc1N0cmljdFJlZ2V4IDogdGhpcy5fbW9udGhzUmVnZXg7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBjb21wdXRlTW9udGhzUGFyc2UgKCkge1xuICAgIGZ1bmN0aW9uIGNtcExlblJldihhLCBiKSB7XG4gICAgICAgIHJldHVybiBiLmxlbmd0aCAtIGEubGVuZ3RoO1xuICAgIH1cblxuICAgIHZhciBzaG9ydFBpZWNlcyA9IFtdLCBsb25nUGllY2VzID0gW10sIG1peGVkUGllY2VzID0gW10sXG4gICAgICAgIGksIG1vbTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgMTI7IGkrKykge1xuICAgICAgICAvLyBtYWtlIHRoZSByZWdleCBpZiB3ZSBkb24ndCBoYXZlIGl0IGFscmVhZHlcbiAgICAgICAgbW9tID0gY3JlYXRlVVRDKFsyMDAwLCBpXSk7XG4gICAgICAgIHNob3J0UGllY2VzLnB1c2godGhpcy5tb250aHNTaG9ydChtb20sICcnKSk7XG4gICAgICAgIGxvbmdQaWVjZXMucHVzaCh0aGlzLm1vbnRocyhtb20sICcnKSk7XG4gICAgICAgIG1peGVkUGllY2VzLnB1c2godGhpcy5tb250aHMobW9tLCAnJykpO1xuICAgICAgICBtaXhlZFBpZWNlcy5wdXNoKHRoaXMubW9udGhzU2hvcnQobW9tLCAnJykpO1xuICAgIH1cbiAgICAvLyBTb3J0aW5nIG1ha2VzIHN1cmUgaWYgb25lIG1vbnRoIChvciBhYmJyKSBpcyBhIHByZWZpeCBvZiBhbm90aGVyIGl0XG4gICAgLy8gd2lsbCBtYXRjaCB0aGUgbG9uZ2VyIHBpZWNlLlxuICAgIHNob3J0UGllY2VzLnNvcnQoY21wTGVuUmV2KTtcbiAgICBsb25nUGllY2VzLnNvcnQoY21wTGVuUmV2KTtcbiAgICBtaXhlZFBpZWNlcy5zb3J0KGNtcExlblJldik7XG4gICAgZm9yIChpID0gMDsgaSA8IDEyOyBpKyspIHtcbiAgICAgICAgc2hvcnRQaWVjZXNbaV0gPSByZWdleEVzY2FwZShzaG9ydFBpZWNlc1tpXSk7XG4gICAgICAgIGxvbmdQaWVjZXNbaV0gPSByZWdleEVzY2FwZShsb25nUGllY2VzW2ldKTtcbiAgICB9XG4gICAgZm9yIChpID0gMDsgaSA8IDI0OyBpKyspIHtcbiAgICAgICAgbWl4ZWRQaWVjZXNbaV0gPSByZWdleEVzY2FwZShtaXhlZFBpZWNlc1tpXSk7XG4gICAgfVxuXG4gICAgdGhpcy5fbW9udGhzUmVnZXggPSBuZXcgUmVnRXhwKCdeKCcgKyBtaXhlZFBpZWNlcy5qb2luKCd8JykgKyAnKScsICdpJyk7XG4gICAgdGhpcy5fbW9udGhzU2hvcnRSZWdleCA9IHRoaXMuX21vbnRoc1JlZ2V4O1xuICAgIHRoaXMuX21vbnRoc1N0cmljdFJlZ2V4ID0gbmV3IFJlZ0V4cCgnXignICsgbG9uZ1BpZWNlcy5qb2luKCd8JykgKyAnKScsICdpJyk7XG4gICAgdGhpcy5fbW9udGhzU2hvcnRTdHJpY3RSZWdleCA9IG5ldyBSZWdFeHAoJ14oJyArIHNob3J0UGllY2VzLmpvaW4oJ3wnKSArICcpJywgJ2knKTtcbn1cblxuLy8gRk9STUFUVElOR1xuXG5hZGRGb3JtYXRUb2tlbignWScsIDAsIDAsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgeSA9IHRoaXMueWVhcigpO1xuICAgIHJldHVybiB5IDw9IDk5OTkgPyAnJyArIHkgOiAnKycgKyB5O1xufSk7XG5cbmFkZEZvcm1hdFRva2VuKDAsIFsnWVknLCAyXSwgMCwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLnllYXIoKSAlIDEwMDtcbn0pO1xuXG5hZGRGb3JtYXRUb2tlbigwLCBbJ1lZWVknLCAgIDRdLCAgICAgICAwLCAneWVhcicpO1xuYWRkRm9ybWF0VG9rZW4oMCwgWydZWVlZWScsICA1XSwgICAgICAgMCwgJ3llYXInKTtcbmFkZEZvcm1hdFRva2VuKDAsIFsnWVlZWVlZJywgNiwgdHJ1ZV0sIDAsICd5ZWFyJyk7XG5cbi8vIEFMSUFTRVNcblxuYWRkVW5pdEFsaWFzKCd5ZWFyJywgJ3knKTtcblxuLy8gUFJJT1JJVElFU1xuXG5hZGRVbml0UHJpb3JpdHkoJ3llYXInLCAxKTtcblxuLy8gUEFSU0lOR1xuXG5hZGRSZWdleFRva2VuKCdZJywgICAgICBtYXRjaFNpZ25lZCk7XG5hZGRSZWdleFRva2VuKCdZWScsICAgICBtYXRjaDF0bzIsIG1hdGNoMik7XG5hZGRSZWdleFRva2VuKCdZWVlZJywgICBtYXRjaDF0bzQsIG1hdGNoNCk7XG5hZGRSZWdleFRva2VuKCdZWVlZWScsICBtYXRjaDF0bzYsIG1hdGNoNik7XG5hZGRSZWdleFRva2VuKCdZWVlZWVknLCBtYXRjaDF0bzYsIG1hdGNoNik7XG5cbmFkZFBhcnNlVG9rZW4oWydZWVlZWScsICdZWVlZWVknXSwgWUVBUik7XG5hZGRQYXJzZVRva2VuKCdZWVlZJywgZnVuY3Rpb24gKGlucHV0LCBhcnJheSkge1xuICAgIGFycmF5W1lFQVJdID0gaW5wdXQubGVuZ3RoID09PSAyID8gaG9va3MucGFyc2VUd29EaWdpdFllYXIoaW5wdXQpIDogdG9JbnQoaW5wdXQpO1xufSk7XG5hZGRQYXJzZVRva2VuKCdZWScsIGZ1bmN0aW9uIChpbnB1dCwgYXJyYXkpIHtcbiAgICBhcnJheVtZRUFSXSA9IGhvb2tzLnBhcnNlVHdvRGlnaXRZZWFyKGlucHV0KTtcbn0pO1xuYWRkUGFyc2VUb2tlbignWScsIGZ1bmN0aW9uIChpbnB1dCwgYXJyYXkpIHtcbiAgICBhcnJheVtZRUFSXSA9IHBhcnNlSW50KGlucHV0LCAxMCk7XG59KTtcblxuLy8gSEVMUEVSU1xuXG5mdW5jdGlvbiBkYXlzSW5ZZWFyKHllYXIpIHtcbiAgICByZXR1cm4gaXNMZWFwWWVhcih5ZWFyKSA/IDM2NiA6IDM2NTtcbn1cblxuZnVuY3Rpb24gaXNMZWFwWWVhcih5ZWFyKSB7XG4gICAgcmV0dXJuICh5ZWFyICUgNCA9PT0gMCAmJiB5ZWFyICUgMTAwICE9PSAwKSB8fCB5ZWFyICUgNDAwID09PSAwO1xufVxuXG4vLyBIT09LU1xuXG5ob29rcy5wYXJzZVR3b0RpZ2l0WWVhciA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgIHJldHVybiB0b0ludChpbnB1dCkgKyAodG9JbnQoaW5wdXQpID4gNjggPyAxOTAwIDogMjAwMCk7XG59O1xuXG4vLyBNT01FTlRTXG5cbnZhciBnZXRTZXRZZWFyID0gbWFrZUdldFNldCgnRnVsbFllYXInLCB0cnVlKTtcblxuZnVuY3Rpb24gZ2V0SXNMZWFwWWVhciAoKSB7XG4gICAgcmV0dXJuIGlzTGVhcFllYXIodGhpcy55ZWFyKCkpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVEYXRlICh5LCBtLCBkLCBoLCBNLCBzLCBtcykge1xuICAgIC8vIGNhbid0IGp1c3QgYXBwbHkoKSB0byBjcmVhdGUgYSBkYXRlOlxuICAgIC8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcS8xODEzNDhcbiAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKHksIG0sIGQsIGgsIE0sIHMsIG1zKTtcblxuICAgIC8vIHRoZSBkYXRlIGNvbnN0cnVjdG9yIHJlbWFwcyB5ZWFycyAwLTk5IHRvIDE5MDAtMTk5OVxuICAgIGlmICh5IDwgMTAwICYmIHkgPj0gMCAmJiBpc0Zpbml0ZShkYXRlLmdldEZ1bGxZZWFyKCkpKSB7XG4gICAgICAgIGRhdGUuc2V0RnVsbFllYXIoeSk7XG4gICAgfVxuICAgIHJldHVybiBkYXRlO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVVVENEYXRlICh5KSB7XG4gICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShEYXRlLlVUQy5hcHBseShudWxsLCBhcmd1bWVudHMpKTtcblxuICAgIC8vIHRoZSBEYXRlLlVUQyBmdW5jdGlvbiByZW1hcHMgeWVhcnMgMC05OSB0byAxOTAwLTE5OTlcbiAgICBpZiAoeSA8IDEwMCAmJiB5ID49IDAgJiYgaXNGaW5pdGUoZGF0ZS5nZXRVVENGdWxsWWVhcigpKSkge1xuICAgICAgICBkYXRlLnNldFVUQ0Z1bGxZZWFyKHkpO1xuICAgIH1cbiAgICByZXR1cm4gZGF0ZTtcbn1cblxuLy8gc3RhcnQtb2YtZmlyc3Qtd2VlayAtIHN0YXJ0LW9mLXllYXJcbmZ1bmN0aW9uIGZpcnN0V2Vla09mZnNldCh5ZWFyLCBkb3csIGRveSkge1xuICAgIHZhciAvLyBmaXJzdC13ZWVrIGRheSAtLSB3aGljaCBqYW51YXJ5IGlzIGFsd2F5cyBpbiB0aGUgZmlyc3Qgd2VlayAoNCBmb3IgaXNvLCAxIGZvciBvdGhlcilcbiAgICAgICAgZndkID0gNyArIGRvdyAtIGRveSxcbiAgICAgICAgLy8gZmlyc3Qtd2VlayBkYXkgbG9jYWwgd2Vla2RheSAtLSB3aGljaCBsb2NhbCB3ZWVrZGF5IGlzIGZ3ZFxuICAgICAgICBmd2RsdyA9ICg3ICsgY3JlYXRlVVRDRGF0ZSh5ZWFyLCAwLCBmd2QpLmdldFVUQ0RheSgpIC0gZG93KSAlIDc7XG5cbiAgICByZXR1cm4gLWZ3ZGx3ICsgZndkIC0gMTtcbn1cblxuLy8gaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvSVNPX3dlZWtfZGF0ZSNDYWxjdWxhdGluZ19hX2RhdGVfZ2l2ZW5fdGhlX3llYXIuMkNfd2Vla19udW1iZXJfYW5kX3dlZWtkYXlcbmZ1bmN0aW9uIGRheU9mWWVhckZyb21XZWVrcyh5ZWFyLCB3ZWVrLCB3ZWVrZGF5LCBkb3csIGRveSkge1xuICAgIHZhciBsb2NhbFdlZWtkYXkgPSAoNyArIHdlZWtkYXkgLSBkb3cpICUgNyxcbiAgICAgICAgd2Vla09mZnNldCA9IGZpcnN0V2Vla09mZnNldCh5ZWFyLCBkb3csIGRveSksXG4gICAgICAgIGRheU9mWWVhciA9IDEgKyA3ICogKHdlZWsgLSAxKSArIGxvY2FsV2Vla2RheSArIHdlZWtPZmZzZXQsXG4gICAgICAgIHJlc1llYXIsIHJlc0RheU9mWWVhcjtcblxuICAgIGlmIChkYXlPZlllYXIgPD0gMCkge1xuICAgICAgICByZXNZZWFyID0geWVhciAtIDE7XG4gICAgICAgIHJlc0RheU9mWWVhciA9IGRheXNJblllYXIocmVzWWVhcikgKyBkYXlPZlllYXI7XG4gICAgfSBlbHNlIGlmIChkYXlPZlllYXIgPiBkYXlzSW5ZZWFyKHllYXIpKSB7XG4gICAgICAgIHJlc1llYXIgPSB5ZWFyICsgMTtcbiAgICAgICAgcmVzRGF5T2ZZZWFyID0gZGF5T2ZZZWFyIC0gZGF5c0luWWVhcih5ZWFyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXNZZWFyID0geWVhcjtcbiAgICAgICAgcmVzRGF5T2ZZZWFyID0gZGF5T2ZZZWFyO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIHllYXI6IHJlc1llYXIsXG4gICAgICAgIGRheU9mWWVhcjogcmVzRGF5T2ZZZWFyXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gd2Vla09mWWVhcihtb20sIGRvdywgZG95KSB7XG4gICAgdmFyIHdlZWtPZmZzZXQgPSBmaXJzdFdlZWtPZmZzZXQobW9tLnllYXIoKSwgZG93LCBkb3kpLFxuICAgICAgICB3ZWVrID0gTWF0aC5mbG9vcigobW9tLmRheU9mWWVhcigpIC0gd2Vla09mZnNldCAtIDEpIC8gNykgKyAxLFxuICAgICAgICByZXNXZWVrLCByZXNZZWFyO1xuXG4gICAgaWYgKHdlZWsgPCAxKSB7XG4gICAgICAgIHJlc1llYXIgPSBtb20ueWVhcigpIC0gMTtcbiAgICAgICAgcmVzV2VlayA9IHdlZWsgKyB3ZWVrc0luWWVhcihyZXNZZWFyLCBkb3csIGRveSk7XG4gICAgfSBlbHNlIGlmICh3ZWVrID4gd2Vla3NJblllYXIobW9tLnllYXIoKSwgZG93LCBkb3kpKSB7XG4gICAgICAgIHJlc1dlZWsgPSB3ZWVrIC0gd2Vla3NJblllYXIobW9tLnllYXIoKSwgZG93LCBkb3kpO1xuICAgICAgICByZXNZZWFyID0gbW9tLnllYXIoKSArIDE7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmVzWWVhciA9IG1vbS55ZWFyKCk7XG4gICAgICAgIHJlc1dlZWsgPSB3ZWVrO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIHdlZWs6IHJlc1dlZWssXG4gICAgICAgIHllYXI6IHJlc1llYXJcbiAgICB9O1xufVxuXG5mdW5jdGlvbiB3ZWVrc0luWWVhcih5ZWFyLCBkb3csIGRveSkge1xuICAgIHZhciB3ZWVrT2Zmc2V0ID0gZmlyc3RXZWVrT2Zmc2V0KHllYXIsIGRvdywgZG95KSxcbiAgICAgICAgd2Vla09mZnNldE5leHQgPSBmaXJzdFdlZWtPZmZzZXQoeWVhciArIDEsIGRvdywgZG95KTtcbiAgICByZXR1cm4gKGRheXNJblllYXIoeWVhcikgLSB3ZWVrT2Zmc2V0ICsgd2Vla09mZnNldE5leHQpIC8gNztcbn1cblxuLy8gRk9STUFUVElOR1xuXG5hZGRGb3JtYXRUb2tlbigndycsIFsnd3cnLCAyXSwgJ3dvJywgJ3dlZWsnKTtcbmFkZEZvcm1hdFRva2VuKCdXJywgWydXVycsIDJdLCAnV28nLCAnaXNvV2VlaycpO1xuXG4vLyBBTElBU0VTXG5cbmFkZFVuaXRBbGlhcygnd2VlaycsICd3Jyk7XG5hZGRVbml0QWxpYXMoJ2lzb1dlZWsnLCAnVycpO1xuXG4vLyBQUklPUklUSUVTXG5cbmFkZFVuaXRQcmlvcml0eSgnd2VlaycsIDUpO1xuYWRkVW5pdFByaW9yaXR5KCdpc29XZWVrJywgNSk7XG5cbi8vIFBBUlNJTkdcblxuYWRkUmVnZXhUb2tlbigndycsICBtYXRjaDF0bzIpO1xuYWRkUmVnZXhUb2tlbignd3cnLCBtYXRjaDF0bzIsIG1hdGNoMik7XG5hZGRSZWdleFRva2VuKCdXJywgIG1hdGNoMXRvMik7XG5hZGRSZWdleFRva2VuKCdXVycsIG1hdGNoMXRvMiwgbWF0Y2gyKTtcblxuYWRkV2Vla1BhcnNlVG9rZW4oWyd3JywgJ3d3JywgJ1cnLCAnV1cnXSwgZnVuY3Rpb24gKGlucHV0LCB3ZWVrLCBjb25maWcsIHRva2VuKSB7XG4gICAgd2Vla1t0b2tlbi5zdWJzdHIoMCwgMSldID0gdG9JbnQoaW5wdXQpO1xufSk7XG5cbi8vIEhFTFBFUlNcblxuLy8gTE9DQUxFU1xuXG5mdW5jdGlvbiBsb2NhbGVXZWVrIChtb20pIHtcbiAgICByZXR1cm4gd2Vla09mWWVhcihtb20sIHRoaXMuX3dlZWsuZG93LCB0aGlzLl93ZWVrLmRveSkud2Vlaztcbn1cblxudmFyIGRlZmF1bHRMb2NhbGVXZWVrID0ge1xuICAgIGRvdyA6IDAsIC8vIFN1bmRheSBpcyB0aGUgZmlyc3QgZGF5IG9mIHRoZSB3ZWVrLlxuICAgIGRveSA6IDYgIC8vIFRoZSB3ZWVrIHRoYXQgY29udGFpbnMgSmFuIDFzdCBpcyB0aGUgZmlyc3Qgd2VlayBvZiB0aGUgeWVhci5cbn07XG5cbmZ1bmN0aW9uIGxvY2FsZUZpcnN0RGF5T2ZXZWVrICgpIHtcbiAgICByZXR1cm4gdGhpcy5fd2Vlay5kb3c7XG59XG5cbmZ1bmN0aW9uIGxvY2FsZUZpcnN0RGF5T2ZZZWFyICgpIHtcbiAgICByZXR1cm4gdGhpcy5fd2Vlay5kb3k7XG59XG5cbi8vIE1PTUVOVFNcblxuZnVuY3Rpb24gZ2V0U2V0V2VlayAoaW5wdXQpIHtcbiAgICB2YXIgd2VlayA9IHRoaXMubG9jYWxlRGF0YSgpLndlZWsodGhpcyk7XG4gICAgcmV0dXJuIGlucHV0ID09IG51bGwgPyB3ZWVrIDogdGhpcy5hZGQoKGlucHV0IC0gd2VlaykgKiA3LCAnZCcpO1xufVxuXG5mdW5jdGlvbiBnZXRTZXRJU09XZWVrIChpbnB1dCkge1xuICAgIHZhciB3ZWVrID0gd2Vla09mWWVhcih0aGlzLCAxLCA0KS53ZWVrO1xuICAgIHJldHVybiBpbnB1dCA9PSBudWxsID8gd2VlayA6IHRoaXMuYWRkKChpbnB1dCAtIHdlZWspICogNywgJ2QnKTtcbn1cblxuLy8gRk9STUFUVElOR1xuXG5hZGRGb3JtYXRUb2tlbignZCcsIDAsICdkbycsICdkYXknKTtcblxuYWRkRm9ybWF0VG9rZW4oJ2RkJywgMCwgMCwgZnVuY3Rpb24gKGZvcm1hdCkge1xuICAgIHJldHVybiB0aGlzLmxvY2FsZURhdGEoKS53ZWVrZGF5c01pbih0aGlzLCBmb3JtYXQpO1xufSk7XG5cbmFkZEZvcm1hdFRva2VuKCdkZGQnLCAwLCAwLCBmdW5jdGlvbiAoZm9ybWF0KSB7XG4gICAgcmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLndlZWtkYXlzU2hvcnQodGhpcywgZm9ybWF0KTtcbn0pO1xuXG5hZGRGb3JtYXRUb2tlbignZGRkZCcsIDAsIDAsIGZ1bmN0aW9uIChmb3JtYXQpIHtcbiAgICByZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkud2Vla2RheXModGhpcywgZm9ybWF0KTtcbn0pO1xuXG5hZGRGb3JtYXRUb2tlbignZScsIDAsIDAsICd3ZWVrZGF5Jyk7XG5hZGRGb3JtYXRUb2tlbignRScsIDAsIDAsICdpc29XZWVrZGF5Jyk7XG5cbi8vIEFMSUFTRVNcblxuYWRkVW5pdEFsaWFzKCdkYXknLCAnZCcpO1xuYWRkVW5pdEFsaWFzKCd3ZWVrZGF5JywgJ2UnKTtcbmFkZFVuaXRBbGlhcygnaXNvV2Vla2RheScsICdFJyk7XG5cbi8vIFBSSU9SSVRZXG5hZGRVbml0UHJpb3JpdHkoJ2RheScsIDExKTtcbmFkZFVuaXRQcmlvcml0eSgnd2Vla2RheScsIDExKTtcbmFkZFVuaXRQcmlvcml0eSgnaXNvV2Vla2RheScsIDExKTtcblxuLy8gUEFSU0lOR1xuXG5hZGRSZWdleFRva2VuKCdkJywgICAgbWF0Y2gxdG8yKTtcbmFkZFJlZ2V4VG9rZW4oJ2UnLCAgICBtYXRjaDF0bzIpO1xuYWRkUmVnZXhUb2tlbignRScsICAgIG1hdGNoMXRvMik7XG5hZGRSZWdleFRva2VuKCdkZCcsICAgZnVuY3Rpb24gKGlzU3RyaWN0LCBsb2NhbGUpIHtcbiAgICByZXR1cm4gbG9jYWxlLndlZWtkYXlzTWluUmVnZXgoaXNTdHJpY3QpO1xufSk7XG5hZGRSZWdleFRva2VuKCdkZGQnLCAgIGZ1bmN0aW9uIChpc1N0cmljdCwgbG9jYWxlKSB7XG4gICAgcmV0dXJuIGxvY2FsZS53ZWVrZGF5c1Nob3J0UmVnZXgoaXNTdHJpY3QpO1xufSk7XG5hZGRSZWdleFRva2VuKCdkZGRkJywgICBmdW5jdGlvbiAoaXNTdHJpY3QsIGxvY2FsZSkge1xuICAgIHJldHVybiBsb2NhbGUud2Vla2RheXNSZWdleChpc1N0cmljdCk7XG59KTtcblxuYWRkV2Vla1BhcnNlVG9rZW4oWydkZCcsICdkZGQnLCAnZGRkZCddLCBmdW5jdGlvbiAoaW5wdXQsIHdlZWssIGNvbmZpZywgdG9rZW4pIHtcbiAgICB2YXIgd2Vla2RheSA9IGNvbmZpZy5fbG9jYWxlLndlZWtkYXlzUGFyc2UoaW5wdXQsIHRva2VuLCBjb25maWcuX3N0cmljdCk7XG4gICAgLy8gaWYgd2UgZGlkbid0IGdldCBhIHdlZWtkYXkgbmFtZSwgbWFyayB0aGUgZGF0ZSBhcyBpbnZhbGlkXG4gICAgaWYgKHdlZWtkYXkgIT0gbnVsbCkge1xuICAgICAgICB3ZWVrLmQgPSB3ZWVrZGF5O1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGdldFBhcnNpbmdGbGFncyhjb25maWcpLmludmFsaWRXZWVrZGF5ID0gaW5wdXQ7XG4gICAgfVxufSk7XG5cbmFkZFdlZWtQYXJzZVRva2VuKFsnZCcsICdlJywgJ0UnXSwgZnVuY3Rpb24gKGlucHV0LCB3ZWVrLCBjb25maWcsIHRva2VuKSB7XG4gICAgd2Vla1t0b2tlbl0gPSB0b0ludChpbnB1dCk7XG59KTtcblxuLy8gSEVMUEVSU1xuXG5mdW5jdGlvbiBwYXJzZVdlZWtkYXkoaW5wdXQsIGxvY2FsZSkge1xuICAgIGlmICh0eXBlb2YgaW5wdXQgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiBpbnB1dDtcbiAgICB9XG5cbiAgICBpZiAoIWlzTmFOKGlucHV0KSkge1xuICAgICAgICByZXR1cm4gcGFyc2VJbnQoaW5wdXQsIDEwKTtcbiAgICB9XG5cbiAgICBpbnB1dCA9IGxvY2FsZS53ZWVrZGF5c1BhcnNlKGlucHV0KTtcbiAgICBpZiAodHlwZW9mIGlucHV0ID09PSAnbnVtYmVyJykge1xuICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG59XG5cbmZ1bmN0aW9uIHBhcnNlSXNvV2Vla2RheShpbnB1dCwgbG9jYWxlKSB7XG4gICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmV0dXJuIGxvY2FsZS53ZWVrZGF5c1BhcnNlKGlucHV0KSAlIDcgfHwgNztcbiAgICB9XG4gICAgcmV0dXJuIGlzTmFOKGlucHV0KSA/IG51bGwgOiBpbnB1dDtcbn1cblxuLy8gTE9DQUxFU1xuXG52YXIgZGVmYXVsdExvY2FsZVdlZWtkYXlzID0gJ1N1bmRheV9Nb25kYXlfVHVlc2RheV9XZWRuZXNkYXlfVGh1cnNkYXlfRnJpZGF5X1NhdHVyZGF5Jy5zcGxpdCgnXycpO1xuZnVuY3Rpb24gbG9jYWxlV2Vla2RheXMgKG0sIGZvcm1hdCkge1xuICAgIGlmICghbSkge1xuICAgICAgICByZXR1cm4gaXNBcnJheSh0aGlzLl93ZWVrZGF5cykgPyB0aGlzLl93ZWVrZGF5cyA6XG4gICAgICAgICAgICB0aGlzLl93ZWVrZGF5c1snc3RhbmRhbG9uZSddO1xuICAgIH1cbiAgICByZXR1cm4gaXNBcnJheSh0aGlzLl93ZWVrZGF5cykgPyB0aGlzLl93ZWVrZGF5c1ttLmRheSgpXSA6XG4gICAgICAgIHRoaXMuX3dlZWtkYXlzW3RoaXMuX3dlZWtkYXlzLmlzRm9ybWF0LnRlc3QoZm9ybWF0KSA/ICdmb3JtYXQnIDogJ3N0YW5kYWxvbmUnXVttLmRheSgpXTtcbn1cblxudmFyIGRlZmF1bHRMb2NhbGVXZWVrZGF5c1Nob3J0ID0gJ1N1bl9Nb25fVHVlX1dlZF9UaHVfRnJpX1NhdCcuc3BsaXQoJ18nKTtcbmZ1bmN0aW9uIGxvY2FsZVdlZWtkYXlzU2hvcnQgKG0pIHtcbiAgICByZXR1cm4gKG0pID8gdGhpcy5fd2Vla2RheXNTaG9ydFttLmRheSgpXSA6IHRoaXMuX3dlZWtkYXlzU2hvcnQ7XG59XG5cbnZhciBkZWZhdWx0TG9jYWxlV2Vla2RheXNNaW4gPSAnU3VfTW9fVHVfV2VfVGhfRnJfU2EnLnNwbGl0KCdfJyk7XG5mdW5jdGlvbiBsb2NhbGVXZWVrZGF5c01pbiAobSkge1xuICAgIHJldHVybiAobSkgPyB0aGlzLl93ZWVrZGF5c01pblttLmRheSgpXSA6IHRoaXMuX3dlZWtkYXlzTWluO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVTdHJpY3RQYXJzZSQxKHdlZWtkYXlOYW1lLCBmb3JtYXQsIHN0cmljdCkge1xuICAgIHZhciBpLCBpaSwgbW9tLCBsbGMgPSB3ZWVrZGF5TmFtZS50b0xvY2FsZUxvd2VyQ2FzZSgpO1xuICAgIGlmICghdGhpcy5fd2Vla2RheXNQYXJzZSkge1xuICAgICAgICB0aGlzLl93ZWVrZGF5c1BhcnNlID0gW107XG4gICAgICAgIHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZSA9IFtdO1xuICAgICAgICB0aGlzLl9taW5XZWVrZGF5c1BhcnNlID0gW107XG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IDc7ICsraSkge1xuICAgICAgICAgICAgbW9tID0gY3JlYXRlVVRDKFsyMDAwLCAxXSkuZGF5KGkpO1xuICAgICAgICAgICAgdGhpcy5fbWluV2Vla2RheXNQYXJzZVtpXSA9IHRoaXMud2Vla2RheXNNaW4obW9tLCAnJykudG9Mb2NhbGVMb3dlckNhc2UoKTtcbiAgICAgICAgICAgIHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZVtpXSA9IHRoaXMud2Vla2RheXNTaG9ydChtb20sICcnKS50b0xvY2FsZUxvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgdGhpcy5fd2Vla2RheXNQYXJzZVtpXSA9IHRoaXMud2Vla2RheXMobW9tLCAnJykudG9Mb2NhbGVMb3dlckNhc2UoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChzdHJpY3QpIHtcbiAgICAgICAgaWYgKGZvcm1hdCA9PT0gJ2RkZGQnKSB7XG4gICAgICAgICAgICBpaSA9IGluZGV4T2YkMS5jYWxsKHRoaXMuX3dlZWtkYXlzUGFyc2UsIGxsYyk7XG4gICAgICAgICAgICByZXR1cm4gaWkgIT09IC0xID8gaWkgOiBudWxsO1xuICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gJ2RkZCcpIHtcbiAgICAgICAgICAgIGlpID0gaW5kZXhPZiQxLmNhbGwodGhpcy5fc2hvcnRXZWVrZGF5c1BhcnNlLCBsbGMpO1xuICAgICAgICAgICAgcmV0dXJuIGlpICE9PSAtMSA/IGlpIDogbnVsbDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlpID0gaW5kZXhPZiQxLmNhbGwodGhpcy5fbWluV2Vla2RheXNQYXJzZSwgbGxjKTtcbiAgICAgICAgICAgIHJldHVybiBpaSAhPT0gLTEgPyBpaSA6IG51bGw7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoZm9ybWF0ID09PSAnZGRkZCcpIHtcbiAgICAgICAgICAgIGlpID0gaW5kZXhPZiQxLmNhbGwodGhpcy5fd2Vla2RheXNQYXJzZSwgbGxjKTtcbiAgICAgICAgICAgIGlmIChpaSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaWk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpaSA9IGluZGV4T2YkMS5jYWxsKHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZSwgbGxjKTtcbiAgICAgICAgICAgIGlmIChpaSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaWk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpaSA9IGluZGV4T2YkMS5jYWxsKHRoaXMuX21pbldlZWtkYXlzUGFyc2UsIGxsYyk7XG4gICAgICAgICAgICByZXR1cm4gaWkgIT09IC0xID8gaWkgOiBudWxsO1xuICAgICAgICB9IGVsc2UgaWYgKGZvcm1hdCA9PT0gJ2RkZCcpIHtcbiAgICAgICAgICAgIGlpID0gaW5kZXhPZiQxLmNhbGwodGhpcy5fc2hvcnRXZWVrZGF5c1BhcnNlLCBsbGMpO1xuICAgICAgICAgICAgaWYgKGlpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlpID0gaW5kZXhPZiQxLmNhbGwodGhpcy5fd2Vla2RheXNQYXJzZSwgbGxjKTtcbiAgICAgICAgICAgIGlmIChpaSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaWk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpaSA9IGluZGV4T2YkMS5jYWxsKHRoaXMuX21pbldlZWtkYXlzUGFyc2UsIGxsYyk7XG4gICAgICAgICAgICByZXR1cm4gaWkgIT09IC0xID8gaWkgOiBudWxsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWkgPSBpbmRleE9mJDEuY2FsbCh0aGlzLl9taW5XZWVrZGF5c1BhcnNlLCBsbGMpO1xuICAgICAgICAgICAgaWYgKGlpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlpID0gaW5kZXhPZiQxLmNhbGwodGhpcy5fd2Vla2RheXNQYXJzZSwgbGxjKTtcbiAgICAgICAgICAgIGlmIChpaSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaWk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpaSA9IGluZGV4T2YkMS5jYWxsKHRoaXMuX3Nob3J0V2Vla2RheXNQYXJzZSwgbGxjKTtcbiAgICAgICAgICAgIHJldHVybiBpaSAhPT0gLTEgPyBpaSA6IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGxvY2FsZVdlZWtkYXlzUGFyc2UgKHdlZWtkYXlOYW1lLCBmb3JtYXQsIHN0cmljdCkge1xuICAgIHZhciBpLCBtb20sIHJlZ2V4O1xuXG4gICAgaWYgKHRoaXMuX3dlZWtkYXlzUGFyc2VFeGFjdCkge1xuICAgICAgICByZXR1cm4gaGFuZGxlU3RyaWN0UGFyc2UkMS5jYWxsKHRoaXMsIHdlZWtkYXlOYW1lLCBmb3JtYXQsIHN0cmljdCk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLl93ZWVrZGF5c1BhcnNlKSB7XG4gICAgICAgIHRoaXMuX3dlZWtkYXlzUGFyc2UgPSBbXTtcbiAgICAgICAgdGhpcy5fbWluV2Vla2RheXNQYXJzZSA9IFtdO1xuICAgICAgICB0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2UgPSBbXTtcbiAgICAgICAgdGhpcy5fZnVsbFdlZWtkYXlzUGFyc2UgPSBbXTtcbiAgICB9XG5cbiAgICBmb3IgKGkgPSAwOyBpIDwgNzsgaSsrKSB7XG4gICAgICAgIC8vIG1ha2UgdGhlIHJlZ2V4IGlmIHdlIGRvbid0IGhhdmUgaXQgYWxyZWFkeVxuXG4gICAgICAgIG1vbSA9IGNyZWF0ZVVUQyhbMjAwMCwgMV0pLmRheShpKTtcbiAgICAgICAgaWYgKHN0cmljdCAmJiAhdGhpcy5fZnVsbFdlZWtkYXlzUGFyc2VbaV0pIHtcbiAgICAgICAgICAgIHRoaXMuX2Z1bGxXZWVrZGF5c1BhcnNlW2ldID0gbmV3IFJlZ0V4cCgnXicgKyB0aGlzLndlZWtkYXlzKG1vbSwgJycpLnJlcGxhY2UoJy4nLCAnXFwuPycpICsgJyQnLCAnaScpO1xuICAgICAgICAgICAgdGhpcy5fc2hvcnRXZWVrZGF5c1BhcnNlW2ldID0gbmV3IFJlZ0V4cCgnXicgKyB0aGlzLndlZWtkYXlzU2hvcnQobW9tLCAnJykucmVwbGFjZSgnLicsICdcXC4/JykgKyAnJCcsICdpJyk7XG4gICAgICAgICAgICB0aGlzLl9taW5XZWVrZGF5c1BhcnNlW2ldID0gbmV3IFJlZ0V4cCgnXicgKyB0aGlzLndlZWtkYXlzTWluKG1vbSwgJycpLnJlcGxhY2UoJy4nLCAnXFwuPycpICsgJyQnLCAnaScpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5fd2Vla2RheXNQYXJzZVtpXSkge1xuICAgICAgICAgICAgcmVnZXggPSAnXicgKyB0aGlzLndlZWtkYXlzKG1vbSwgJycpICsgJ3xeJyArIHRoaXMud2Vla2RheXNTaG9ydChtb20sICcnKSArICd8XicgKyB0aGlzLndlZWtkYXlzTWluKG1vbSwgJycpO1xuICAgICAgICAgICAgdGhpcy5fd2Vla2RheXNQYXJzZVtpXSA9IG5ldyBSZWdFeHAocmVnZXgucmVwbGFjZSgnLicsICcnKSwgJ2knKTtcbiAgICAgICAgfVxuICAgICAgICAvLyB0ZXN0IHRoZSByZWdleFxuICAgICAgICBpZiAoc3RyaWN0ICYmIGZvcm1hdCA9PT0gJ2RkZGQnICYmIHRoaXMuX2Z1bGxXZWVrZGF5c1BhcnNlW2ldLnRlc3Qod2Vla2RheU5hbWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgfSBlbHNlIGlmIChzdHJpY3QgJiYgZm9ybWF0ID09PSAnZGRkJyAmJiB0aGlzLl9zaG9ydFdlZWtkYXlzUGFyc2VbaV0udGVzdCh3ZWVrZGF5TmFtZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICB9IGVsc2UgaWYgKHN0cmljdCAmJiBmb3JtYXQgPT09ICdkZCcgJiYgdGhpcy5fbWluV2Vla2RheXNQYXJzZVtpXS50ZXN0KHdlZWtkYXlOYW1lKSkge1xuICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgIH0gZWxzZSBpZiAoIXN0cmljdCAmJiB0aGlzLl93ZWVrZGF5c1BhcnNlW2ldLnRlc3Qod2Vla2RheU5hbWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8gTU9NRU5UU1xuXG5mdW5jdGlvbiBnZXRTZXREYXlPZldlZWsgKGlucHV0KSB7XG4gICAgaWYgKCF0aGlzLmlzVmFsaWQoKSkge1xuICAgICAgICByZXR1cm4gaW5wdXQgIT0gbnVsbCA/IHRoaXMgOiBOYU47XG4gICAgfVxuICAgIHZhciBkYXkgPSB0aGlzLl9pc1VUQyA/IHRoaXMuX2QuZ2V0VVRDRGF5KCkgOiB0aGlzLl9kLmdldERheSgpO1xuICAgIGlmIChpbnB1dCAhPSBudWxsKSB7XG4gICAgICAgIGlucHV0ID0gcGFyc2VXZWVrZGF5KGlucHV0LCB0aGlzLmxvY2FsZURhdGEoKSk7XG4gICAgICAgIHJldHVybiB0aGlzLmFkZChpbnB1dCAtIGRheSwgJ2QnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZGF5O1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZ2V0U2V0TG9jYWxlRGF5T2ZXZWVrIChpbnB1dCkge1xuICAgIGlmICghdGhpcy5pc1ZhbGlkKCkpIHtcbiAgICAgICAgcmV0dXJuIGlucHV0ICE9IG51bGwgPyB0aGlzIDogTmFOO1xuICAgIH1cbiAgICB2YXIgd2Vla2RheSA9ICh0aGlzLmRheSgpICsgNyAtIHRoaXMubG9jYWxlRGF0YSgpLl93ZWVrLmRvdykgJSA3O1xuICAgIHJldHVybiBpbnB1dCA9PSBudWxsID8gd2Vla2RheSA6IHRoaXMuYWRkKGlucHV0IC0gd2Vla2RheSwgJ2QnKTtcbn1cblxuZnVuY3Rpb24gZ2V0U2V0SVNPRGF5T2ZXZWVrIChpbnB1dCkge1xuICAgIGlmICghdGhpcy5pc1ZhbGlkKCkpIHtcbiAgICAgICAgcmV0dXJuIGlucHV0ICE9IG51bGwgPyB0aGlzIDogTmFOO1xuICAgIH1cblxuICAgIC8vIGJlaGF2ZXMgdGhlIHNhbWUgYXMgbW9tZW50I2RheSBleGNlcHRcbiAgICAvLyBhcyBhIGdldHRlciwgcmV0dXJucyA3IGluc3RlYWQgb2YgMCAoMS03IHJhbmdlIGluc3RlYWQgb2YgMC02KVxuICAgIC8vIGFzIGEgc2V0dGVyLCBzdW5kYXkgc2hvdWxkIGJlbG9uZyB0byB0aGUgcHJldmlvdXMgd2Vlay5cblxuICAgIGlmIChpbnB1dCAhPSBudWxsKSB7XG4gICAgICAgIHZhciB3ZWVrZGF5ID0gcGFyc2VJc29XZWVrZGF5KGlucHV0LCB0aGlzLmxvY2FsZURhdGEoKSk7XG4gICAgICAgIHJldHVybiB0aGlzLmRheSh0aGlzLmRheSgpICUgNyA/IHdlZWtkYXkgOiB3ZWVrZGF5IC0gNyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF5KCkgfHwgNztcbiAgICB9XG59XG5cbnZhciBkZWZhdWx0V2Vla2RheXNSZWdleCA9IG1hdGNoV29yZDtcbmZ1bmN0aW9uIHdlZWtkYXlzUmVnZXggKGlzU3RyaWN0KSB7XG4gICAgaWYgKHRoaXMuX3dlZWtkYXlzUGFyc2VFeGFjdCkge1xuICAgICAgICBpZiAoIWhhc093blByb3AodGhpcywgJ193ZWVrZGF5c1JlZ2V4JykpIHtcbiAgICAgICAgICAgIGNvbXB1dGVXZWVrZGF5c1BhcnNlLmNhbGwodGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzU3RyaWN0KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fd2Vla2RheXNTdHJpY3RSZWdleDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl93ZWVrZGF5c1JlZ2V4O1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCFoYXNPd25Qcm9wKHRoaXMsICdfd2Vla2RheXNSZWdleCcpKSB7XG4gICAgICAgICAgICB0aGlzLl93ZWVrZGF5c1JlZ2V4ID0gZGVmYXVsdFdlZWtkYXlzUmVnZXg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3dlZWtkYXlzU3RyaWN0UmVnZXggJiYgaXNTdHJpY3QgP1xuICAgICAgICAgICAgdGhpcy5fd2Vla2RheXNTdHJpY3RSZWdleCA6IHRoaXMuX3dlZWtkYXlzUmVnZXg7XG4gICAgfVxufVxuXG52YXIgZGVmYXVsdFdlZWtkYXlzU2hvcnRSZWdleCA9IG1hdGNoV29yZDtcbmZ1bmN0aW9uIHdlZWtkYXlzU2hvcnRSZWdleCAoaXNTdHJpY3QpIHtcbiAgICBpZiAodGhpcy5fd2Vla2RheXNQYXJzZUV4YWN0KSB7XG4gICAgICAgIGlmICghaGFzT3duUHJvcCh0aGlzLCAnX3dlZWtkYXlzUmVnZXgnKSkge1xuICAgICAgICAgICAgY29tcHV0ZVdlZWtkYXlzUGFyc2UuY2FsbCh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNTdHJpY3QpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl93ZWVrZGF5c1Nob3J0U3RyaWN0UmVnZXg7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fd2Vla2RheXNTaG9ydFJlZ2V4O1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCFoYXNPd25Qcm9wKHRoaXMsICdfd2Vla2RheXNTaG9ydFJlZ2V4JykpIHtcbiAgICAgICAgICAgIHRoaXMuX3dlZWtkYXlzU2hvcnRSZWdleCA9IGRlZmF1bHRXZWVrZGF5c1Nob3J0UmVnZXg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3dlZWtkYXlzU2hvcnRTdHJpY3RSZWdleCAmJiBpc1N0cmljdCA/XG4gICAgICAgICAgICB0aGlzLl93ZWVrZGF5c1Nob3J0U3RyaWN0UmVnZXggOiB0aGlzLl93ZWVrZGF5c1Nob3J0UmVnZXg7XG4gICAgfVxufVxuXG52YXIgZGVmYXVsdFdlZWtkYXlzTWluUmVnZXggPSBtYXRjaFdvcmQ7XG5mdW5jdGlvbiB3ZWVrZGF5c01pblJlZ2V4IChpc1N0cmljdCkge1xuICAgIGlmICh0aGlzLl93ZWVrZGF5c1BhcnNlRXhhY3QpIHtcbiAgICAgICAgaWYgKCFoYXNPd25Qcm9wKHRoaXMsICdfd2Vla2RheXNSZWdleCcpKSB7XG4gICAgICAgICAgICBjb21wdXRlV2Vla2RheXNQYXJzZS5jYWxsKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc1N0cmljdCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dlZWtkYXlzTWluU3RyaWN0UmVnZXg7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fd2Vla2RheXNNaW5SZWdleDtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghaGFzT3duUHJvcCh0aGlzLCAnX3dlZWtkYXlzTWluUmVnZXgnKSkge1xuICAgICAgICAgICAgdGhpcy5fd2Vla2RheXNNaW5SZWdleCA9IGRlZmF1bHRXZWVrZGF5c01pblJlZ2V4O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl93ZWVrZGF5c01pblN0cmljdFJlZ2V4ICYmIGlzU3RyaWN0ID9cbiAgICAgICAgICAgIHRoaXMuX3dlZWtkYXlzTWluU3RyaWN0UmVnZXggOiB0aGlzLl93ZWVrZGF5c01pblJlZ2V4O1xuICAgIH1cbn1cblxuXG5mdW5jdGlvbiBjb21wdXRlV2Vla2RheXNQYXJzZSAoKSB7XG4gICAgZnVuY3Rpb24gY21wTGVuUmV2KGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGIubGVuZ3RoIC0gYS5sZW5ndGg7XG4gICAgfVxuXG4gICAgdmFyIG1pblBpZWNlcyA9IFtdLCBzaG9ydFBpZWNlcyA9IFtdLCBsb25nUGllY2VzID0gW10sIG1peGVkUGllY2VzID0gW10sXG4gICAgICAgIGksIG1vbSwgbWlucCwgc2hvcnRwLCBsb25ncDtcbiAgICBmb3IgKGkgPSAwOyBpIDwgNzsgaSsrKSB7XG4gICAgICAgIC8vIG1ha2UgdGhlIHJlZ2V4IGlmIHdlIGRvbid0IGhhdmUgaXQgYWxyZWFkeVxuICAgICAgICBtb20gPSBjcmVhdGVVVEMoWzIwMDAsIDFdKS5kYXkoaSk7XG4gICAgICAgIG1pbnAgPSB0aGlzLndlZWtkYXlzTWluKG1vbSwgJycpO1xuICAgICAgICBzaG9ydHAgPSB0aGlzLndlZWtkYXlzU2hvcnQobW9tLCAnJyk7XG4gICAgICAgIGxvbmdwID0gdGhpcy53ZWVrZGF5cyhtb20sICcnKTtcbiAgICAgICAgbWluUGllY2VzLnB1c2gobWlucCk7XG4gICAgICAgIHNob3J0UGllY2VzLnB1c2goc2hvcnRwKTtcbiAgICAgICAgbG9uZ1BpZWNlcy5wdXNoKGxvbmdwKTtcbiAgICAgICAgbWl4ZWRQaWVjZXMucHVzaChtaW5wKTtcbiAgICAgICAgbWl4ZWRQaWVjZXMucHVzaChzaG9ydHApO1xuICAgICAgICBtaXhlZFBpZWNlcy5wdXNoKGxvbmdwKTtcbiAgICB9XG4gICAgLy8gU29ydGluZyBtYWtlcyBzdXJlIGlmIG9uZSB3ZWVrZGF5IChvciBhYmJyKSBpcyBhIHByZWZpeCBvZiBhbm90aGVyIGl0XG4gICAgLy8gd2lsbCBtYXRjaCB0aGUgbG9uZ2VyIHBpZWNlLlxuICAgIG1pblBpZWNlcy5zb3J0KGNtcExlblJldik7XG4gICAgc2hvcnRQaWVjZXMuc29ydChjbXBMZW5SZXYpO1xuICAgIGxvbmdQaWVjZXMuc29ydChjbXBMZW5SZXYpO1xuICAgIG1peGVkUGllY2VzLnNvcnQoY21wTGVuUmV2KTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgNzsgaSsrKSB7XG4gICAgICAgIHNob3J0UGllY2VzW2ldID0gcmVnZXhFc2NhcGUoc2hvcnRQaWVjZXNbaV0pO1xuICAgICAgICBsb25nUGllY2VzW2ldID0gcmVnZXhFc2NhcGUobG9uZ1BpZWNlc1tpXSk7XG4gICAgICAgIG1peGVkUGllY2VzW2ldID0gcmVnZXhFc2NhcGUobWl4ZWRQaWVjZXNbaV0pO1xuICAgIH1cblxuICAgIHRoaXMuX3dlZWtkYXlzUmVnZXggPSBuZXcgUmVnRXhwKCdeKCcgKyBtaXhlZFBpZWNlcy5qb2luKCd8JykgKyAnKScsICdpJyk7XG4gICAgdGhpcy5fd2Vla2RheXNTaG9ydFJlZ2V4ID0gdGhpcy5fd2Vla2RheXNSZWdleDtcbiAgICB0aGlzLl93ZWVrZGF5c01pblJlZ2V4ID0gdGhpcy5fd2Vla2RheXNSZWdleDtcblxuICAgIHRoaXMuX3dlZWtkYXlzU3RyaWN0UmVnZXggPSBuZXcgUmVnRXhwKCdeKCcgKyBsb25nUGllY2VzLmpvaW4oJ3wnKSArICcpJywgJ2knKTtcbiAgICB0aGlzLl93ZWVrZGF5c1Nob3J0U3RyaWN0UmVnZXggPSBuZXcgUmVnRXhwKCdeKCcgKyBzaG9ydFBpZWNlcy5qb2luKCd8JykgKyAnKScsICdpJyk7XG4gICAgdGhpcy5fd2Vla2RheXNNaW5TdHJpY3RSZWdleCA9IG5ldyBSZWdFeHAoJ14oJyArIG1pblBpZWNlcy5qb2luKCd8JykgKyAnKScsICdpJyk7XG59XG5cbi8vIEZPUk1BVFRJTkdcblxuZnVuY3Rpb24gaEZvcm1hdCgpIHtcbiAgICByZXR1cm4gdGhpcy5ob3VycygpICUgMTIgfHwgMTI7XG59XG5cbmZ1bmN0aW9uIGtGb3JtYXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuaG91cnMoKSB8fCAyNDtcbn1cblxuYWRkRm9ybWF0VG9rZW4oJ0gnLCBbJ0hIJywgMl0sIDAsICdob3VyJyk7XG5hZGRGb3JtYXRUb2tlbignaCcsIFsnaGgnLCAyXSwgMCwgaEZvcm1hdCk7XG5hZGRGb3JtYXRUb2tlbignaycsIFsna2snLCAyXSwgMCwga0Zvcm1hdCk7XG5cbmFkZEZvcm1hdFRva2VuKCdobW0nLCAwLCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuICcnICsgaEZvcm1hdC5hcHBseSh0aGlzKSArIHplcm9GaWxsKHRoaXMubWludXRlcygpLCAyKTtcbn0pO1xuXG5hZGRGb3JtYXRUb2tlbignaG1tc3MnLCAwLCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuICcnICsgaEZvcm1hdC5hcHBseSh0aGlzKSArIHplcm9GaWxsKHRoaXMubWludXRlcygpLCAyKSArXG4gICAgICAgIHplcm9GaWxsKHRoaXMuc2Vjb25kcygpLCAyKTtcbn0pO1xuXG5hZGRGb3JtYXRUb2tlbignSG1tJywgMCwgMCwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiAnJyArIHRoaXMuaG91cnMoKSArIHplcm9GaWxsKHRoaXMubWludXRlcygpLCAyKTtcbn0pO1xuXG5hZGRGb3JtYXRUb2tlbignSG1tc3MnLCAwLCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuICcnICsgdGhpcy5ob3VycygpICsgemVyb0ZpbGwodGhpcy5taW51dGVzKCksIDIpICtcbiAgICAgICAgemVyb0ZpbGwodGhpcy5zZWNvbmRzKCksIDIpO1xufSk7XG5cbmZ1bmN0aW9uIG1lcmlkaWVtICh0b2tlbiwgbG93ZXJjYXNlKSB7XG4gICAgYWRkRm9ybWF0VG9rZW4odG9rZW4sIDAsIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLm1lcmlkaWVtKHRoaXMuaG91cnMoKSwgdGhpcy5taW51dGVzKCksIGxvd2VyY2FzZSk7XG4gICAgfSk7XG59XG5cbm1lcmlkaWVtKCdhJywgdHJ1ZSk7XG5tZXJpZGllbSgnQScsIGZhbHNlKTtcblxuLy8gQUxJQVNFU1xuXG5hZGRVbml0QWxpYXMoJ2hvdXInLCAnaCcpO1xuXG4vLyBQUklPUklUWVxuYWRkVW5pdFByaW9yaXR5KCdob3VyJywgMTMpO1xuXG4vLyBQQVJTSU5HXG5cbmZ1bmN0aW9uIG1hdGNoTWVyaWRpZW0gKGlzU3RyaWN0LCBsb2NhbGUpIHtcbiAgICByZXR1cm4gbG9jYWxlLl9tZXJpZGllbVBhcnNlO1xufVxuXG5hZGRSZWdleFRva2VuKCdhJywgIG1hdGNoTWVyaWRpZW0pO1xuYWRkUmVnZXhUb2tlbignQScsICBtYXRjaE1lcmlkaWVtKTtcbmFkZFJlZ2V4VG9rZW4oJ0gnLCAgbWF0Y2gxdG8yKTtcbmFkZFJlZ2V4VG9rZW4oJ2gnLCAgbWF0Y2gxdG8yKTtcbmFkZFJlZ2V4VG9rZW4oJ2snLCAgbWF0Y2gxdG8yKTtcbmFkZFJlZ2V4VG9rZW4oJ0hIJywgbWF0Y2gxdG8yLCBtYXRjaDIpO1xuYWRkUmVnZXhUb2tlbignaGgnLCBtYXRjaDF0bzIsIG1hdGNoMik7XG5hZGRSZWdleFRva2VuKCdraycsIG1hdGNoMXRvMiwgbWF0Y2gyKTtcblxuYWRkUmVnZXhUb2tlbignaG1tJywgbWF0Y2gzdG80KTtcbmFkZFJlZ2V4VG9rZW4oJ2htbXNzJywgbWF0Y2g1dG82KTtcbmFkZFJlZ2V4VG9rZW4oJ0htbScsIG1hdGNoM3RvNCk7XG5hZGRSZWdleFRva2VuKCdIbW1zcycsIG1hdGNoNXRvNik7XG5cbmFkZFBhcnNlVG9rZW4oWydIJywgJ0hIJ10sIEhPVVIpO1xuYWRkUGFyc2VUb2tlbihbJ2snLCAna2snXSwgZnVuY3Rpb24gKGlucHV0LCBhcnJheSwgY29uZmlnKSB7XG4gICAgdmFyIGtJbnB1dCA9IHRvSW50KGlucHV0KTtcbiAgICBhcnJheVtIT1VSXSA9IGtJbnB1dCA9PT0gMjQgPyAwIDoga0lucHV0O1xufSk7XG5hZGRQYXJzZVRva2VuKFsnYScsICdBJ10sIGZ1bmN0aW9uIChpbnB1dCwgYXJyYXksIGNvbmZpZykge1xuICAgIGNvbmZpZy5faXNQbSA9IGNvbmZpZy5fbG9jYWxlLmlzUE0oaW5wdXQpO1xuICAgIGNvbmZpZy5fbWVyaWRpZW0gPSBpbnB1dDtcbn0pO1xuYWRkUGFyc2VUb2tlbihbJ2gnLCAnaGgnXSwgZnVuY3Rpb24gKGlucHV0LCBhcnJheSwgY29uZmlnKSB7XG4gICAgYXJyYXlbSE9VUl0gPSB0b0ludChpbnB1dCk7XG4gICAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykuYmlnSG91ciA9IHRydWU7XG59KTtcbmFkZFBhcnNlVG9rZW4oJ2htbScsIGZ1bmN0aW9uIChpbnB1dCwgYXJyYXksIGNvbmZpZykge1xuICAgIHZhciBwb3MgPSBpbnB1dC5sZW5ndGggLSAyO1xuICAgIGFycmF5W0hPVVJdID0gdG9JbnQoaW5wdXQuc3Vic3RyKDAsIHBvcykpO1xuICAgIGFycmF5W01JTlVURV0gPSB0b0ludChpbnB1dC5zdWJzdHIocG9zKSk7XG4gICAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykuYmlnSG91ciA9IHRydWU7XG59KTtcbmFkZFBhcnNlVG9rZW4oJ2htbXNzJywgZnVuY3Rpb24gKGlucHV0LCBhcnJheSwgY29uZmlnKSB7XG4gICAgdmFyIHBvczEgPSBpbnB1dC5sZW5ndGggLSA0O1xuICAgIHZhciBwb3MyID0gaW5wdXQubGVuZ3RoIC0gMjtcbiAgICBhcnJheVtIT1VSXSA9IHRvSW50KGlucHV0LnN1YnN0cigwLCBwb3MxKSk7XG4gICAgYXJyYXlbTUlOVVRFXSA9IHRvSW50KGlucHV0LnN1YnN0cihwb3MxLCAyKSk7XG4gICAgYXJyYXlbU0VDT05EXSA9IHRvSW50KGlucHV0LnN1YnN0cihwb3MyKSk7XG4gICAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykuYmlnSG91ciA9IHRydWU7XG59KTtcbmFkZFBhcnNlVG9rZW4oJ0htbScsIGZ1bmN0aW9uIChpbnB1dCwgYXJyYXksIGNvbmZpZykge1xuICAgIHZhciBwb3MgPSBpbnB1dC5sZW5ndGggLSAyO1xuICAgIGFycmF5W0hPVVJdID0gdG9JbnQoaW5wdXQuc3Vic3RyKDAsIHBvcykpO1xuICAgIGFycmF5W01JTlVURV0gPSB0b0ludChpbnB1dC5zdWJzdHIocG9zKSk7XG59KTtcbmFkZFBhcnNlVG9rZW4oJ0htbXNzJywgZnVuY3Rpb24gKGlucHV0LCBhcnJheSwgY29uZmlnKSB7XG4gICAgdmFyIHBvczEgPSBpbnB1dC5sZW5ndGggLSA0O1xuICAgIHZhciBwb3MyID0gaW5wdXQubGVuZ3RoIC0gMjtcbiAgICBhcnJheVtIT1VSXSA9IHRvSW50KGlucHV0LnN1YnN0cigwLCBwb3MxKSk7XG4gICAgYXJyYXlbTUlOVVRFXSA9IHRvSW50KGlucHV0LnN1YnN0cihwb3MxLCAyKSk7XG4gICAgYXJyYXlbU0VDT05EXSA9IHRvSW50KGlucHV0LnN1YnN0cihwb3MyKSk7XG59KTtcblxuLy8gTE9DQUxFU1xuXG5mdW5jdGlvbiBsb2NhbGVJc1BNIChpbnB1dCkge1xuICAgIC8vIElFOCBRdWlya3MgTW9kZSAmIElFNyBTdGFuZGFyZHMgTW9kZSBkbyBub3QgYWxsb3cgYWNjZXNzaW5nIHN0cmluZ3MgbGlrZSBhcnJheXNcbiAgICAvLyBVc2luZyBjaGFyQXQgc2hvdWxkIGJlIG1vcmUgY29tcGF0aWJsZS5cbiAgICByZXR1cm4gKChpbnB1dCArICcnKS50b0xvd2VyQ2FzZSgpLmNoYXJBdCgwKSA9PT0gJ3AnKTtcbn1cblxudmFyIGRlZmF1bHRMb2NhbGVNZXJpZGllbVBhcnNlID0gL1thcF1cXC4/bT9cXC4/L2k7XG5mdW5jdGlvbiBsb2NhbGVNZXJpZGllbSAoaG91cnMsIG1pbnV0ZXMsIGlzTG93ZXIpIHtcbiAgICBpZiAoaG91cnMgPiAxMSkge1xuICAgICAgICByZXR1cm4gaXNMb3dlciA/ICdwbScgOiAnUE0nO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBpc0xvd2VyID8gJ2FtJyA6ICdBTSc7XG4gICAgfVxufVxuXG5cbi8vIE1PTUVOVFNcblxuLy8gU2V0dGluZyB0aGUgaG91ciBzaG91bGQga2VlcCB0aGUgdGltZSwgYmVjYXVzZSB0aGUgdXNlciBleHBsaWNpdGx5XG4vLyBzcGVjaWZpZWQgd2hpY2ggaG91ciBoZSB3YW50cy4gU28gdHJ5aW5nIHRvIG1haW50YWluIHRoZSBzYW1lIGhvdXIgKGluXG4vLyBhIG5ldyB0aW1lem9uZSkgbWFrZXMgc2Vuc2UuIEFkZGluZy9zdWJ0cmFjdGluZyBob3VycyBkb2VzIG5vdCBmb2xsb3dcbi8vIHRoaXMgcnVsZS5cbnZhciBnZXRTZXRIb3VyID0gbWFrZUdldFNldCgnSG91cnMnLCB0cnVlKTtcblxuLy8gbW9udGhzXG4vLyB3ZWVrXG4vLyB3ZWVrZGF5c1xuLy8gbWVyaWRpZW1cbnZhciBiYXNlQ29uZmlnID0ge1xuICAgIGNhbGVuZGFyOiBkZWZhdWx0Q2FsZW5kYXIsXG4gICAgbG9uZ0RhdGVGb3JtYXQ6IGRlZmF1bHRMb25nRGF0ZUZvcm1hdCxcbiAgICBpbnZhbGlkRGF0ZTogZGVmYXVsdEludmFsaWREYXRlLFxuICAgIG9yZGluYWw6IGRlZmF1bHRPcmRpbmFsLFxuICAgIGRheU9mTW9udGhPcmRpbmFsUGFyc2U6IGRlZmF1bHREYXlPZk1vbnRoT3JkaW5hbFBhcnNlLFxuICAgIHJlbGF0aXZlVGltZTogZGVmYXVsdFJlbGF0aXZlVGltZSxcblxuICAgIG1vbnRoczogZGVmYXVsdExvY2FsZU1vbnRocyxcbiAgICBtb250aHNTaG9ydDogZGVmYXVsdExvY2FsZU1vbnRoc1Nob3J0LFxuXG4gICAgd2VlazogZGVmYXVsdExvY2FsZVdlZWssXG5cbiAgICB3ZWVrZGF5czogZGVmYXVsdExvY2FsZVdlZWtkYXlzLFxuICAgIHdlZWtkYXlzTWluOiBkZWZhdWx0TG9jYWxlV2Vla2RheXNNaW4sXG4gICAgd2Vla2RheXNTaG9ydDogZGVmYXVsdExvY2FsZVdlZWtkYXlzU2hvcnQsXG5cbiAgICBtZXJpZGllbVBhcnNlOiBkZWZhdWx0TG9jYWxlTWVyaWRpZW1QYXJzZVxufTtcblxuLy8gaW50ZXJuYWwgc3RvcmFnZSBmb3IgbG9jYWxlIGNvbmZpZyBmaWxlc1xudmFyIGxvY2FsZXMgPSB7fTtcbnZhciBsb2NhbGVGYW1pbGllcyA9IHt9O1xudmFyIGdsb2JhbExvY2FsZTtcblxuZnVuY3Rpb24gbm9ybWFsaXplTG9jYWxlKGtleSkge1xuICAgIHJldHVybiBrZXkgPyBrZXkudG9Mb3dlckNhc2UoKS5yZXBsYWNlKCdfJywgJy0nKSA6IGtleTtcbn1cblxuLy8gcGljayB0aGUgbG9jYWxlIGZyb20gdGhlIGFycmF5XG4vLyB0cnkgWydlbi1hdScsICdlbi1nYiddIGFzICdlbi1hdScsICdlbi1nYicsICdlbicsIGFzIGluIG1vdmUgdGhyb3VnaCB0aGUgbGlzdCB0cnlpbmcgZWFjaFxuLy8gc3Vic3RyaW5nIGZyb20gbW9zdCBzcGVjaWZpYyB0byBsZWFzdCwgYnV0IG1vdmUgdG8gdGhlIG5leHQgYXJyYXkgaXRlbSBpZiBpdCdzIGEgbW9yZSBzcGVjaWZpYyB2YXJpYW50IHRoYW4gdGhlIGN1cnJlbnQgcm9vdFxuZnVuY3Rpb24gY2hvb3NlTG9jYWxlKG5hbWVzKSB7XG4gICAgdmFyIGkgPSAwLCBqLCBuZXh0LCBsb2NhbGUsIHNwbGl0O1xuXG4gICAgd2hpbGUgKGkgPCBuYW1lcy5sZW5ndGgpIHtcbiAgICAgICAgc3BsaXQgPSBub3JtYWxpemVMb2NhbGUobmFtZXNbaV0pLnNwbGl0KCctJyk7XG4gICAgICAgIGogPSBzcGxpdC5sZW5ndGg7XG4gICAgICAgIG5leHQgPSBub3JtYWxpemVMb2NhbGUobmFtZXNbaSArIDFdKTtcbiAgICAgICAgbmV4dCA9IG5leHQgPyBuZXh0LnNwbGl0KCctJykgOiBudWxsO1xuICAgICAgICB3aGlsZSAoaiA+IDApIHtcbiAgICAgICAgICAgIGxvY2FsZSA9IGxvYWRMb2NhbGUoc3BsaXQuc2xpY2UoMCwgaikuam9pbignLScpKTtcbiAgICAgICAgICAgIGlmIChsb2NhbGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9jYWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG5leHQgJiYgbmV4dC5sZW5ndGggPj0gaiAmJiBjb21wYXJlQXJyYXlzKHNwbGl0LCBuZXh0LCB0cnVlKSA+PSBqIC0gMSkge1xuICAgICAgICAgICAgICAgIC8vdGhlIG5leHQgYXJyYXkgaXRlbSBpcyBiZXR0ZXIgdGhhbiBhIHNoYWxsb3dlciBzdWJzdHJpbmcgb2YgdGhpcyBvbmVcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGotLTtcbiAgICAgICAgfVxuICAgICAgICBpKys7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuXG5mdW5jdGlvbiBsb2FkTG9jYWxlKG5hbWUpIHtcbiAgICB2YXIgb2xkTG9jYWxlID0gbnVsbDtcbiAgICAvLyBUT0RPOiBGaW5kIGEgYmV0dGVyIHdheSB0byByZWdpc3RlciBhbmQgbG9hZCBhbGwgdGhlIGxvY2FsZXMgaW4gTm9kZVxuICAgIGlmICghbG9jYWxlc1tuYW1lXSAmJiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpICYmXG4gICAgICAgICAgICBtb2R1bGUgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIG9sZExvY2FsZSA9IGdsb2JhbExvY2FsZS5fYWJicjtcbiAgICAgICAgICAgIF9kZXJlcV8oJy4vbG9jYWxlLycgKyBuYW1lKTtcbiAgICAgICAgICAgIC8vIGJlY2F1c2UgZGVmaW5lTG9jYWxlIGN1cnJlbnRseSBhbHNvIHNldHMgdGhlIGdsb2JhbCBsb2NhbGUsIHdlXG4gICAgICAgICAgICAvLyB3YW50IHRvIHVuZG8gdGhhdCBmb3IgbGF6eSBsb2FkZWQgbG9jYWxlc1xuICAgICAgICAgICAgZ2V0U2V0R2xvYmFsTG9jYWxlKG9sZExvY2FsZSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgfVxuICAgIH1cbiAgICByZXR1cm4gbG9jYWxlc1tuYW1lXTtcbn1cblxuLy8gVGhpcyBmdW5jdGlvbiB3aWxsIGxvYWQgbG9jYWxlIGFuZCB0aGVuIHNldCB0aGUgZ2xvYmFsIGxvY2FsZS4gIElmXG4vLyBubyBhcmd1bWVudHMgYXJlIHBhc3NlZCBpbiwgaXQgd2lsbCBzaW1wbHkgcmV0dXJuIHRoZSBjdXJyZW50IGdsb2JhbFxuLy8gbG9jYWxlIGtleS5cbmZ1bmN0aW9uIGdldFNldEdsb2JhbExvY2FsZSAoa2V5LCB2YWx1ZXMpIHtcbiAgICB2YXIgZGF0YTtcbiAgICBpZiAoa2V5KSB7XG4gICAgICAgIGlmIChpc1VuZGVmaW5lZCh2YWx1ZXMpKSB7XG4gICAgICAgICAgICBkYXRhID0gZ2V0TG9jYWxlKGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkYXRhID0gZGVmaW5lTG9jYWxlKGtleSwgdmFsdWVzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAvLyBtb21lbnQuZHVyYXRpb24uX2xvY2FsZSA9IG1vbWVudC5fbG9jYWxlID0gZGF0YTtcbiAgICAgICAgICAgIGdsb2JhbExvY2FsZSA9IGRhdGE7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZ2xvYmFsTG9jYWxlLl9hYmJyO1xufVxuXG5mdW5jdGlvbiBkZWZpbmVMb2NhbGUgKG5hbWUsIGNvbmZpZykge1xuICAgIGlmIChjb25maWcgIT09IG51bGwpIHtcbiAgICAgICAgdmFyIHBhcmVudENvbmZpZyA9IGJhc2VDb25maWc7XG4gICAgICAgIGNvbmZpZy5hYmJyID0gbmFtZTtcbiAgICAgICAgaWYgKGxvY2FsZXNbbmFtZV0gIT0gbnVsbCkge1xuICAgICAgICAgICAgZGVwcmVjYXRlU2ltcGxlKCdkZWZpbmVMb2NhbGVPdmVycmlkZScsXG4gICAgICAgICAgICAgICAgICAgICd1c2UgbW9tZW50LnVwZGF0ZUxvY2FsZShsb2NhbGVOYW1lLCBjb25maWcpIHRvIGNoYW5nZSAnICtcbiAgICAgICAgICAgICAgICAgICAgJ2FuIGV4aXN0aW5nIGxvY2FsZS4gbW9tZW50LmRlZmluZUxvY2FsZShsb2NhbGVOYW1lLCAnICtcbiAgICAgICAgICAgICAgICAgICAgJ2NvbmZpZykgc2hvdWxkIG9ubHkgYmUgdXNlZCBmb3IgY3JlYXRpbmcgYSBuZXcgbG9jYWxlICcgK1xuICAgICAgICAgICAgICAgICAgICAnU2VlIGh0dHA6Ly9tb21lbnRqcy5jb20vZ3VpZGVzLyMvd2FybmluZ3MvZGVmaW5lLWxvY2FsZS8gZm9yIG1vcmUgaW5mby4nKTtcbiAgICAgICAgICAgIHBhcmVudENvbmZpZyA9IGxvY2FsZXNbbmFtZV0uX2NvbmZpZztcbiAgICAgICAgfSBlbHNlIGlmIChjb25maWcucGFyZW50TG9jYWxlICE9IG51bGwpIHtcbiAgICAgICAgICAgIGlmIChsb2NhbGVzW2NvbmZpZy5wYXJlbnRMb2NhbGVdICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRDb25maWcgPSBsb2NhbGVzW2NvbmZpZy5wYXJlbnRMb2NhbGVdLl9jb25maWc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICghbG9jYWxlRmFtaWxpZXNbY29uZmlnLnBhcmVudExvY2FsZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxlRmFtaWxpZXNbY29uZmlnLnBhcmVudExvY2FsZV0gPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbG9jYWxlRmFtaWxpZXNbY29uZmlnLnBhcmVudExvY2FsZV0ucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZzogY29uZmlnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbG9jYWxlc1tuYW1lXSA9IG5ldyBMb2NhbGUobWVyZ2VDb25maWdzKHBhcmVudENvbmZpZywgY29uZmlnKSk7XG5cbiAgICAgICAgaWYgKGxvY2FsZUZhbWlsaWVzW25hbWVdKSB7XG4gICAgICAgICAgICBsb2NhbGVGYW1pbGllc1tuYW1lXS5mb3JFYWNoKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgZGVmaW5lTG9jYWxlKHgubmFtZSwgeC5jb25maWcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBiYWNrd2FyZHMgY29tcGF0IGZvciBub3c6IGFsc28gc2V0IHRoZSBsb2NhbGVcbiAgICAgICAgLy8gbWFrZSBzdXJlIHdlIHNldCB0aGUgbG9jYWxlIEFGVEVSIGFsbCBjaGlsZCBsb2NhbGVzIGhhdmUgYmVlblxuICAgICAgICAvLyBjcmVhdGVkLCBzbyB3ZSB3b24ndCBlbmQgdXAgd2l0aCB0aGUgY2hpbGQgbG9jYWxlIHNldC5cbiAgICAgICAgZ2V0U2V0R2xvYmFsTG9jYWxlKG5hbWUpO1xuXG5cbiAgICAgICAgcmV0dXJuIGxvY2FsZXNbbmFtZV07XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gdXNlZnVsIGZvciB0ZXN0aW5nXG4gICAgICAgIGRlbGV0ZSBsb2NhbGVzW25hbWVdO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUxvY2FsZShuYW1lLCBjb25maWcpIHtcbiAgICBpZiAoY29uZmlnICE9IG51bGwpIHtcbiAgICAgICAgdmFyIGxvY2FsZSwgcGFyZW50Q29uZmlnID0gYmFzZUNvbmZpZztcbiAgICAgICAgLy8gTUVSR0VcbiAgICAgICAgaWYgKGxvY2FsZXNbbmFtZV0gIT0gbnVsbCkge1xuICAgICAgICAgICAgcGFyZW50Q29uZmlnID0gbG9jYWxlc1tuYW1lXS5fY29uZmlnO1xuICAgICAgICB9XG4gICAgICAgIGNvbmZpZyA9IG1lcmdlQ29uZmlncyhwYXJlbnRDb25maWcsIGNvbmZpZyk7XG4gICAgICAgIGxvY2FsZSA9IG5ldyBMb2NhbGUoY29uZmlnKTtcbiAgICAgICAgbG9jYWxlLnBhcmVudExvY2FsZSA9IGxvY2FsZXNbbmFtZV07XG4gICAgICAgIGxvY2FsZXNbbmFtZV0gPSBsb2NhbGU7XG5cbiAgICAgICAgLy8gYmFja3dhcmRzIGNvbXBhdCBmb3Igbm93OiBhbHNvIHNldCB0aGUgbG9jYWxlXG4gICAgICAgIGdldFNldEdsb2JhbExvY2FsZShuYW1lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBwYXNzIG51bGwgZm9yIGNvbmZpZyB0byB1bnVwZGF0ZSwgdXNlZnVsIGZvciB0ZXN0c1xuICAgICAgICBpZiAobG9jYWxlc1tuYW1lXSAhPSBudWxsKSB7XG4gICAgICAgICAgICBpZiAobG9jYWxlc1tuYW1lXS5wYXJlbnRMb2NhbGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGxvY2FsZXNbbmFtZV0gPSBsb2NhbGVzW25hbWVdLnBhcmVudExvY2FsZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobG9jYWxlc1tuYW1lXSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGxvY2FsZXNbbmFtZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGxvY2FsZXNbbmFtZV07XG59XG5cbi8vIHJldHVybnMgbG9jYWxlIGRhdGFcbmZ1bmN0aW9uIGdldExvY2FsZSAoa2V5KSB7XG4gICAgdmFyIGxvY2FsZTtcblxuICAgIGlmIChrZXkgJiYga2V5Ll9sb2NhbGUgJiYga2V5Ll9sb2NhbGUuX2FiYnIpIHtcbiAgICAgICAga2V5ID0ga2V5Ll9sb2NhbGUuX2FiYnI7XG4gICAgfVxuXG4gICAgaWYgKCFrZXkpIHtcbiAgICAgICAgcmV0dXJuIGdsb2JhbExvY2FsZTtcbiAgICB9XG5cbiAgICBpZiAoIWlzQXJyYXkoa2V5KSkge1xuICAgICAgICAvL3Nob3J0LWNpcmN1aXQgZXZlcnl0aGluZyBlbHNlXG4gICAgICAgIGxvY2FsZSA9IGxvYWRMb2NhbGUoa2V5KTtcbiAgICAgICAgaWYgKGxvY2FsZSkge1xuICAgICAgICAgICAgcmV0dXJuIGxvY2FsZTtcbiAgICAgICAgfVxuICAgICAgICBrZXkgPSBba2V5XTtcbiAgICB9XG5cbiAgICByZXR1cm4gY2hvb3NlTG9jYWxlKGtleSk7XG59XG5cbmZ1bmN0aW9uIGxpc3RMb2NhbGVzKCkge1xuICAgIHJldHVybiBrZXlzJDEobG9jYWxlcyk7XG59XG5cbmZ1bmN0aW9uIGNoZWNrT3ZlcmZsb3cgKG0pIHtcbiAgICB2YXIgb3ZlcmZsb3c7XG4gICAgdmFyIGEgPSBtLl9hO1xuXG4gICAgaWYgKGEgJiYgZ2V0UGFyc2luZ0ZsYWdzKG0pLm92ZXJmbG93ID09PSAtMikge1xuICAgICAgICBvdmVyZmxvdyA9XG4gICAgICAgICAgICBhW01PTlRIXSAgICAgICA8IDAgfHwgYVtNT05USF0gICAgICAgPiAxMSAgPyBNT05USCA6XG4gICAgICAgICAgICBhW0RBVEVdICAgICAgICA8IDEgfHwgYVtEQVRFXSAgICAgICAgPiBkYXlzSW5Nb250aChhW1lFQVJdLCBhW01PTlRIXSkgPyBEQVRFIDpcbiAgICAgICAgICAgIGFbSE9VUl0gICAgICAgIDwgMCB8fCBhW0hPVVJdICAgICAgICA+IDI0IHx8IChhW0hPVVJdID09PSAyNCAmJiAoYVtNSU5VVEVdICE9PSAwIHx8IGFbU0VDT05EXSAhPT0gMCB8fCBhW01JTExJU0VDT05EXSAhPT0gMCkpID8gSE9VUiA6XG4gICAgICAgICAgICBhW01JTlVURV0gICAgICA8IDAgfHwgYVtNSU5VVEVdICAgICAgPiA1OSAgPyBNSU5VVEUgOlxuICAgICAgICAgICAgYVtTRUNPTkRdICAgICAgPCAwIHx8IGFbU0VDT05EXSAgICAgID4gNTkgID8gU0VDT05EIDpcbiAgICAgICAgICAgIGFbTUlMTElTRUNPTkRdIDwgMCB8fCBhW01JTExJU0VDT05EXSA+IDk5OSA/IE1JTExJU0VDT05EIDpcbiAgICAgICAgICAgIC0xO1xuXG4gICAgICAgIGlmIChnZXRQYXJzaW5nRmxhZ3MobSkuX292ZXJmbG93RGF5T2ZZZWFyICYmIChvdmVyZmxvdyA8IFlFQVIgfHwgb3ZlcmZsb3cgPiBEQVRFKSkge1xuICAgICAgICAgICAgb3ZlcmZsb3cgPSBEQVRFO1xuICAgICAgICB9XG4gICAgICAgIGlmIChnZXRQYXJzaW5nRmxhZ3MobSkuX292ZXJmbG93V2Vla3MgJiYgb3ZlcmZsb3cgPT09IC0xKSB7XG4gICAgICAgICAgICBvdmVyZmxvdyA9IFdFRUs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGdldFBhcnNpbmdGbGFncyhtKS5fb3ZlcmZsb3dXZWVrZGF5ICYmIG92ZXJmbG93ID09PSAtMSkge1xuICAgICAgICAgICAgb3ZlcmZsb3cgPSBXRUVLREFZO1xuICAgICAgICB9XG5cbiAgICAgICAgZ2V0UGFyc2luZ0ZsYWdzKG0pLm92ZXJmbG93ID0gb3ZlcmZsb3c7XG4gICAgfVxuXG4gICAgcmV0dXJuIG07XG59XG5cbi8vIGlzbyA4NjAxIHJlZ2V4XG4vLyAwMDAwLTAwLTAwIDAwMDAtVzAwIG9yIDAwMDAtVzAwLTAgKyBUICsgMDAgb3IgMDA6MDAgb3IgMDA6MDA6MDAgb3IgMDA6MDA6MDAuMDAwICsgKzAwOjAwIG9yICswMDAwIG9yICswMClcbnZhciBleHRlbmRlZElzb1JlZ2V4ID0gL15cXHMqKCg/OlsrLV1cXGR7Nn18XFxkezR9KS0oPzpcXGRcXGQtXFxkXFxkfFdcXGRcXGQtXFxkfFdcXGRcXGR8XFxkXFxkXFxkfFxcZFxcZCkpKD86KFR8ICkoXFxkXFxkKD86OlxcZFxcZCg/OjpcXGRcXGQoPzpbLixdXFxkKyk/KT8pPykoW1xcK1xcLV1cXGRcXGQoPzo6P1xcZFxcZCk/fFxccypaKT8pPyQvO1xudmFyIGJhc2ljSXNvUmVnZXggPSAvXlxccyooKD86WystXVxcZHs2fXxcXGR7NH0pKD86XFxkXFxkXFxkXFxkfFdcXGRcXGRcXGR8V1xcZFxcZHxcXGRcXGRcXGR8XFxkXFxkKSkoPzooVHwgKShcXGRcXGQoPzpcXGRcXGQoPzpcXGRcXGQoPzpbLixdXFxkKyk/KT8pPykoW1xcK1xcLV1cXGRcXGQoPzo6P1xcZFxcZCk/fFxccypaKT8pPyQvO1xuXG52YXIgdHpSZWdleCA9IC9afFsrLV1cXGRcXGQoPzo6P1xcZFxcZCk/LztcblxudmFyIGlzb0RhdGVzID0gW1xuICAgIFsnWVlZWVlZLU1NLUREJywgL1srLV1cXGR7Nn0tXFxkXFxkLVxcZFxcZC9dLFxuICAgIFsnWVlZWS1NTS1ERCcsIC9cXGR7NH0tXFxkXFxkLVxcZFxcZC9dLFxuICAgIFsnR0dHRy1bV11XVy1FJywgL1xcZHs0fS1XXFxkXFxkLVxcZC9dLFxuICAgIFsnR0dHRy1bV11XVycsIC9cXGR7NH0tV1xcZFxcZC8sIGZhbHNlXSxcbiAgICBbJ1lZWVktREREJywgL1xcZHs0fS1cXGR7M30vXSxcbiAgICBbJ1lZWVktTU0nLCAvXFxkezR9LVxcZFxcZC8sIGZhbHNlXSxcbiAgICBbJ1lZWVlZWU1NREQnLCAvWystXVxcZHsxMH0vXSxcbiAgICBbJ1lZWVlNTUREJywgL1xcZHs4fS9dLFxuICAgIC8vIFlZWVlNTSBpcyBOT1QgYWxsb3dlZCBieSB0aGUgc3RhbmRhcmRcbiAgICBbJ0dHR0dbV11XV0UnLCAvXFxkezR9V1xcZHszfS9dLFxuICAgIFsnR0dHR1tXXVdXJywgL1xcZHs0fVdcXGR7Mn0vLCBmYWxzZV0sXG4gICAgWydZWVlZREREJywgL1xcZHs3fS9dXG5dO1xuXG4vLyBpc28gdGltZSBmb3JtYXRzIGFuZCByZWdleGVzXG52YXIgaXNvVGltZXMgPSBbXG4gICAgWydISDptbTpzcy5TU1NTJywgL1xcZFxcZDpcXGRcXGQ6XFxkXFxkXFwuXFxkKy9dLFxuICAgIFsnSEg6bW06c3MsU1NTUycsIC9cXGRcXGQ6XFxkXFxkOlxcZFxcZCxcXGQrL10sXG4gICAgWydISDptbTpzcycsIC9cXGRcXGQ6XFxkXFxkOlxcZFxcZC9dLFxuICAgIFsnSEg6bW0nLCAvXFxkXFxkOlxcZFxcZC9dLFxuICAgIFsnSEhtbXNzLlNTU1MnLCAvXFxkXFxkXFxkXFxkXFxkXFxkXFwuXFxkKy9dLFxuICAgIFsnSEhtbXNzLFNTU1MnLCAvXFxkXFxkXFxkXFxkXFxkXFxkLFxcZCsvXSxcbiAgICBbJ0hIbW1zcycsIC9cXGRcXGRcXGRcXGRcXGRcXGQvXSxcbiAgICBbJ0hIbW0nLCAvXFxkXFxkXFxkXFxkL10sXG4gICAgWydISCcsIC9cXGRcXGQvXVxuXTtcblxudmFyIGFzcE5ldEpzb25SZWdleCA9IC9eXFwvP0RhdGVcXCgoXFwtP1xcZCspL2k7XG5cbi8vIGRhdGUgZnJvbSBpc28gZm9ybWF0XG5mdW5jdGlvbiBjb25maWdGcm9tSVNPKGNvbmZpZykge1xuICAgIHZhciBpLCBsLFxuICAgICAgICBzdHJpbmcgPSBjb25maWcuX2ksXG4gICAgICAgIG1hdGNoID0gZXh0ZW5kZWRJc29SZWdleC5leGVjKHN0cmluZykgfHwgYmFzaWNJc29SZWdleC5leGVjKHN0cmluZyksXG4gICAgICAgIGFsbG93VGltZSwgZGF0ZUZvcm1hdCwgdGltZUZvcm1hdCwgdHpGb3JtYXQ7XG5cbiAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykuaXNvID0gdHJ1ZTtcblxuICAgICAgICBmb3IgKGkgPSAwLCBsID0gaXNvRGF0ZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoaXNvRGF0ZXNbaV1bMV0uZXhlYyhtYXRjaFsxXSkpIHtcbiAgICAgICAgICAgICAgICBkYXRlRm9ybWF0ID0gaXNvRGF0ZXNbaV1bMF07XG4gICAgICAgICAgICAgICAgYWxsb3dUaW1lID0gaXNvRGF0ZXNbaV1bMl0gIT09IGZhbHNlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChkYXRlRm9ybWF0ID09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbmZpZy5faXNWYWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtYXRjaFszXSkge1xuICAgICAgICAgICAgZm9yIChpID0gMCwgbCA9IGlzb1RpbWVzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChpc29UaW1lc1tpXVsxXS5leGVjKG1hdGNoWzNdKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBtYXRjaFsyXSBzaG91bGQgYmUgJ1QnIG9yIHNwYWNlXG4gICAgICAgICAgICAgICAgICAgIHRpbWVGb3JtYXQgPSAobWF0Y2hbMl0gfHwgJyAnKSArIGlzb1RpbWVzW2ldWzBdO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGltZUZvcm1hdCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLl9pc1ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghYWxsb3dUaW1lICYmIHRpbWVGb3JtYXQgIT0gbnVsbCkge1xuICAgICAgICAgICAgY29uZmlnLl9pc1ZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1hdGNoWzRdKSB7XG4gICAgICAgICAgICBpZiAodHpSZWdleC5leGVjKG1hdGNoWzRdKSkge1xuICAgICAgICAgICAgICAgIHR6Rm9ybWF0ID0gJ1onO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25maWcuX2lzVmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uZmlnLl9mID0gZGF0ZUZvcm1hdCArICh0aW1lRm9ybWF0IHx8ICcnKSArICh0ekZvcm1hdCB8fCAnJyk7XG4gICAgICAgIGNvbmZpZ0Zyb21TdHJpbmdBbmRGb3JtYXQoY29uZmlnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25maWcuX2lzVmFsaWQgPSBmYWxzZTtcbiAgICB9XG59XG5cbi8vIFJGQyAyODIyIHJlZ2V4OiBGb3IgZGV0YWlscyBzZWUgaHR0cHM6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzI4MjIjc2VjdGlvbi0zLjNcbnZhciBiYXNpY1JmY1JlZ2V4ID0gL14oKD86TW9ufFR1ZXxXZWR8VGh1fEZyaXxTYXR8U3VuKSw/XFxzKT8oXFxkP1xcZFxccyg/OkphbnxGZWJ8TWFyfEFwcnxNYXl8SnVufEp1bHxBdWd8U2VwfE9jdHxOb3Z8RGVjKVxccyg/OlxcZFxcZCk/XFxkXFxkXFxzKShcXGRcXGQ6XFxkXFxkKShcXDpcXGRcXGQpPyhcXHMoPzpVVHxHTVR8W0VDTVBdW1NEXVR8W0EtSUstWmEtaWstel18WystXVxcZHs0fSkpJC87XG5cbi8vIGRhdGUgYW5kIHRpbWUgZnJvbSByZWYgMjgyMiBmb3JtYXRcbmZ1bmN0aW9uIGNvbmZpZ0Zyb21SRkMyODIyKGNvbmZpZykge1xuICAgIHZhciBzdHJpbmcsIG1hdGNoLCBkYXlGb3JtYXQsXG4gICAgICAgIGRhdGVGb3JtYXQsIHRpbWVGb3JtYXQsIHR6Rm9ybWF0O1xuICAgIHZhciB0aW1lem9uZXMgPSB7XG4gICAgICAgICcgR01UJzogJyArMDAwMCcsXG4gICAgICAgICcgRURUJzogJyAtMDQwMCcsXG4gICAgICAgICcgRVNUJzogJyAtMDUwMCcsXG4gICAgICAgICcgQ0RUJzogJyAtMDUwMCcsXG4gICAgICAgICcgQ1NUJzogJyAtMDYwMCcsXG4gICAgICAgICcgTURUJzogJyAtMDYwMCcsXG4gICAgICAgICcgTVNUJzogJyAtMDcwMCcsXG4gICAgICAgICcgUERUJzogJyAtMDcwMCcsXG4gICAgICAgICcgUFNUJzogJyAtMDgwMCdcbiAgICB9O1xuICAgIHZhciBtaWxpdGFyeSA9ICdZWFdWVVRTUlFQT05aQUJDREVGR0hJS0xNJztcbiAgICB2YXIgdGltZXpvbmUsIHRpbWV6b25lSW5kZXg7XG5cbiAgICBzdHJpbmcgPSBjb25maWcuX2lcbiAgICAgICAgLnJlcGxhY2UoL1xcKFteXFwpXSpcXCl8W1xcblxcdF0vZywgJyAnKSAvLyBSZW1vdmUgY29tbWVudHMgYW5kIGZvbGRpbmcgd2hpdGVzcGFjZVxuICAgICAgICAucmVwbGFjZSgvKFxcc1xccyspL2csICcgJykgLy8gUmVwbGFjZSBtdWx0aXBsZS1zcGFjZXMgd2l0aCBhIHNpbmdsZSBzcGFjZVxuICAgICAgICAucmVwbGFjZSgvXlxcc3xcXHMkL2csICcnKTsgLy8gUmVtb3ZlIGxlYWRpbmcgYW5kIHRyYWlsaW5nIHNwYWNlc1xuICAgIG1hdGNoID0gYmFzaWNSZmNSZWdleC5leGVjKHN0cmluZyk7XG5cbiAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgZGF5Rm9ybWF0ID0gbWF0Y2hbMV0gPyAnZGRkJyArICgobWF0Y2hbMV0ubGVuZ3RoID09PSA1KSA/ICcsICcgOiAnICcpIDogJyc7XG4gICAgICAgIGRhdGVGb3JtYXQgPSAnRCBNTU0gJyArICgobWF0Y2hbMl0ubGVuZ3RoID4gMTApID8gJ1lZWVkgJyA6ICdZWSAnKTtcbiAgICAgICAgdGltZUZvcm1hdCA9ICdISDptbScgKyAobWF0Y2hbNF0gPyAnOnNzJyA6ICcnKTtcblxuICAgICAgICAvLyBUT0RPOiBSZXBsYWNlIHRoZSB2YW5pbGxhIEpTIERhdGUgb2JqZWN0IHdpdGggYW4gaW5kZXBlbnRlbnQgZGF5LW9mLXdlZWsgY2hlY2suXG4gICAgICAgIGlmIChtYXRjaFsxXSkgeyAvLyBkYXkgb2Ygd2VlayBnaXZlblxuICAgICAgICAgICAgdmFyIG1vbWVudERhdGUgPSBuZXcgRGF0ZShtYXRjaFsyXSk7XG4gICAgICAgICAgICB2YXIgbW9tZW50RGF5ID0gWydTdW4nLCdNb24nLCdUdWUnLCdXZWQnLCdUaHUnLCdGcmknLCdTYXQnXVttb21lbnREYXRlLmdldERheSgpXTtcblxuICAgICAgICAgICAgaWYgKG1hdGNoWzFdLnN1YnN0cigwLDMpICE9PSBtb21lbnREYXkpIHtcbiAgICAgICAgICAgICAgICBnZXRQYXJzaW5nRmxhZ3MoY29uZmlnKS53ZWVrZGF5TWlzbWF0Y2ggPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNvbmZpZy5faXNWYWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHN3aXRjaCAobWF0Y2hbNV0ubGVuZ3RoKSB7XG4gICAgICAgICAgICBjYXNlIDI6IC8vIG1pbGl0YXJ5XG4gICAgICAgICAgICAgICAgaWYgKHRpbWV6b25lSW5kZXggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGltZXpvbmUgPSAnICswMDAwJztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aW1lem9uZUluZGV4ID0gbWlsaXRhcnkuaW5kZXhPZihtYXRjaFs1XVsxXS50b1VwcGVyQ2FzZSgpKSAtIDEyO1xuICAgICAgICAgICAgICAgICAgICB0aW1lem9uZSA9ICgodGltZXpvbmVJbmRleCA8IDApID8gJyAtJyA6ICcgKycpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICgoJycgKyB0aW1lem9uZUluZGV4KS5yZXBsYWNlKC9eLT8vLCAnMCcpKS5tYXRjaCgvLi4kLylbMF0gKyAnMDAnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgNDogLy8gWm9uZVxuICAgICAgICAgICAgICAgIHRpbWV6b25lID0gdGltZXpvbmVzW21hdGNoWzVdXTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6IC8vIFVUIG9yICsvLTk5OTlcbiAgICAgICAgICAgICAgICB0aW1lem9uZSA9IHRpbWV6b25lc1snIEdNVCddO1xuICAgICAgICB9XG4gICAgICAgIG1hdGNoWzVdID0gdGltZXpvbmU7XG4gICAgICAgIGNvbmZpZy5faSA9IG1hdGNoLnNwbGljZSgxKS5qb2luKCcnKTtcbiAgICAgICAgdHpGb3JtYXQgPSAnIFpaJztcbiAgICAgICAgY29uZmlnLl9mID0gZGF5Rm9ybWF0ICsgZGF0ZUZvcm1hdCArIHRpbWVGb3JtYXQgKyB0ekZvcm1hdDtcbiAgICAgICAgY29uZmlnRnJvbVN0cmluZ0FuZEZvcm1hdChjb25maWcpO1xuICAgICAgICBnZXRQYXJzaW5nRmxhZ3MoY29uZmlnKS5yZmMyODIyID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25maWcuX2lzVmFsaWQgPSBmYWxzZTtcbiAgICB9XG59XG5cbi8vIGRhdGUgZnJvbSBpc28gZm9ybWF0IG9yIGZhbGxiYWNrXG5mdW5jdGlvbiBjb25maWdGcm9tU3RyaW5nKGNvbmZpZykge1xuICAgIHZhciBtYXRjaGVkID0gYXNwTmV0SnNvblJlZ2V4LmV4ZWMoY29uZmlnLl9pKTtcblxuICAgIGlmIChtYXRjaGVkICE9PSBudWxsKSB7XG4gICAgICAgIGNvbmZpZy5fZCA9IG5ldyBEYXRlKCttYXRjaGVkWzFdKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbmZpZ0Zyb21JU08oY29uZmlnKTtcbiAgICBpZiAoY29uZmlnLl9pc1ZhbGlkID09PSBmYWxzZSkge1xuICAgICAgICBkZWxldGUgY29uZmlnLl9pc1ZhbGlkO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25maWdGcm9tUkZDMjgyMihjb25maWcpO1xuICAgIGlmIChjb25maWcuX2lzVmFsaWQgPT09IGZhbHNlKSB7XG4gICAgICAgIGRlbGV0ZSBjb25maWcuX2lzVmFsaWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEZpbmFsIGF0dGVtcHQsIHVzZSBJbnB1dCBGYWxsYmFja1xuICAgIGhvb2tzLmNyZWF0ZUZyb21JbnB1dEZhbGxiYWNrKGNvbmZpZyk7XG59XG5cbmhvb2tzLmNyZWF0ZUZyb21JbnB1dEZhbGxiYWNrID0gZGVwcmVjYXRlKFxuICAgICd2YWx1ZSBwcm92aWRlZCBpcyBub3QgaW4gYSByZWNvZ25pemVkIFJGQzI4MjIgb3IgSVNPIGZvcm1hdC4gbW9tZW50IGNvbnN0cnVjdGlvbiBmYWxscyBiYWNrIHRvIGpzIERhdGUoKSwgJyArXG4gICAgJ3doaWNoIGlzIG5vdCByZWxpYWJsZSBhY3Jvc3MgYWxsIGJyb3dzZXJzIGFuZCB2ZXJzaW9ucy4gTm9uIFJGQzI4MjIvSVNPIGRhdGUgZm9ybWF0cyBhcmUgJyArXG4gICAgJ2Rpc2NvdXJhZ2VkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gYW4gdXBjb21pbmcgbWFqb3IgcmVsZWFzZS4gUGxlYXNlIHJlZmVyIHRvICcgK1xuICAgICdodHRwOi8vbW9tZW50anMuY29tL2d1aWRlcy8jL3dhcm5pbmdzL2pzLWRhdGUvIGZvciBtb3JlIGluZm8uJyxcbiAgICBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgIGNvbmZpZy5fZCA9IG5ldyBEYXRlKGNvbmZpZy5faSArIChjb25maWcuX3VzZVVUQyA/ICcgVVRDJyA6ICcnKSk7XG4gICAgfVxuKTtcblxuLy8gUGljayB0aGUgZmlyc3QgZGVmaW5lZCBvZiB0d28gb3IgdGhyZWUgYXJndW1lbnRzLlxuZnVuY3Rpb24gZGVmYXVsdHMoYSwgYiwgYykge1xuICAgIGlmIChhICE9IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGE7XG4gICAgfVxuICAgIGlmIChiICE9IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGI7XG4gICAgfVxuICAgIHJldHVybiBjO1xufVxuXG5mdW5jdGlvbiBjdXJyZW50RGF0ZUFycmF5KGNvbmZpZykge1xuICAgIC8vIGhvb2tzIGlzIGFjdHVhbGx5IHRoZSBleHBvcnRlZCBtb21lbnQgb2JqZWN0XG4gICAgdmFyIG5vd1ZhbHVlID0gbmV3IERhdGUoaG9va3Mubm93KCkpO1xuICAgIGlmIChjb25maWcuX3VzZVVUQykge1xuICAgICAgICByZXR1cm4gW25vd1ZhbHVlLmdldFVUQ0Z1bGxZZWFyKCksIG5vd1ZhbHVlLmdldFVUQ01vbnRoKCksIG5vd1ZhbHVlLmdldFVUQ0RhdGUoKV07XG4gICAgfVxuICAgIHJldHVybiBbbm93VmFsdWUuZ2V0RnVsbFllYXIoKSwgbm93VmFsdWUuZ2V0TW9udGgoKSwgbm93VmFsdWUuZ2V0RGF0ZSgpXTtcbn1cblxuLy8gY29udmVydCBhbiBhcnJheSB0byBhIGRhdGUuXG4vLyB0aGUgYXJyYXkgc2hvdWxkIG1pcnJvciB0aGUgcGFyYW1ldGVycyBiZWxvd1xuLy8gbm90ZTogYWxsIHZhbHVlcyBwYXN0IHRoZSB5ZWFyIGFyZSBvcHRpb25hbCBhbmQgd2lsbCBkZWZhdWx0IHRvIHRoZSBsb3dlc3QgcG9zc2libGUgdmFsdWUuXG4vLyBbeWVhciwgbW9udGgsIGRheSAsIGhvdXIsIG1pbnV0ZSwgc2Vjb25kLCBtaWxsaXNlY29uZF1cbmZ1bmN0aW9uIGNvbmZpZ0Zyb21BcnJheSAoY29uZmlnKSB7XG4gICAgdmFyIGksIGRhdGUsIGlucHV0ID0gW10sIGN1cnJlbnREYXRlLCB5ZWFyVG9Vc2U7XG5cbiAgICBpZiAoY29uZmlnLl9kKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjdXJyZW50RGF0ZSA9IGN1cnJlbnREYXRlQXJyYXkoY29uZmlnKTtcblxuICAgIC8vY29tcHV0ZSBkYXkgb2YgdGhlIHllYXIgZnJvbSB3ZWVrcyBhbmQgd2Vla2RheXNcbiAgICBpZiAoY29uZmlnLl93ICYmIGNvbmZpZy5fYVtEQVRFXSA9PSBudWxsICYmIGNvbmZpZy5fYVtNT05USF0gPT0gbnVsbCkge1xuICAgICAgICBkYXlPZlllYXJGcm9tV2Vla0luZm8oY29uZmlnKTtcbiAgICB9XG5cbiAgICAvL2lmIHRoZSBkYXkgb2YgdGhlIHllYXIgaXMgc2V0LCBmaWd1cmUgb3V0IHdoYXQgaXQgaXNcbiAgICBpZiAoY29uZmlnLl9kYXlPZlllYXIgIT0gbnVsbCkge1xuICAgICAgICB5ZWFyVG9Vc2UgPSBkZWZhdWx0cyhjb25maWcuX2FbWUVBUl0sIGN1cnJlbnREYXRlW1lFQVJdKTtcblxuICAgICAgICBpZiAoY29uZmlnLl9kYXlPZlllYXIgPiBkYXlzSW5ZZWFyKHllYXJUb1VzZSkgfHwgY29uZmlnLl9kYXlPZlllYXIgPT09IDApIHtcbiAgICAgICAgICAgIGdldFBhcnNpbmdGbGFncyhjb25maWcpLl9vdmVyZmxvd0RheU9mWWVhciA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBkYXRlID0gY3JlYXRlVVRDRGF0ZSh5ZWFyVG9Vc2UsIDAsIGNvbmZpZy5fZGF5T2ZZZWFyKTtcbiAgICAgICAgY29uZmlnLl9hW01PTlRIXSA9IGRhdGUuZ2V0VVRDTW9udGgoKTtcbiAgICAgICAgY29uZmlnLl9hW0RBVEVdID0gZGF0ZS5nZXRVVENEYXRlKCk7XG4gICAgfVxuXG4gICAgLy8gRGVmYXVsdCB0byBjdXJyZW50IGRhdGUuXG4gICAgLy8gKiBpZiBubyB5ZWFyLCBtb250aCwgZGF5IG9mIG1vbnRoIGFyZSBnaXZlbiwgZGVmYXVsdCB0byB0b2RheVxuICAgIC8vICogaWYgZGF5IG9mIG1vbnRoIGlzIGdpdmVuLCBkZWZhdWx0IG1vbnRoIGFuZCB5ZWFyXG4gICAgLy8gKiBpZiBtb250aCBpcyBnaXZlbiwgZGVmYXVsdCBvbmx5IHllYXJcbiAgICAvLyAqIGlmIHllYXIgaXMgZ2l2ZW4sIGRvbid0IGRlZmF1bHQgYW55dGhpbmdcbiAgICBmb3IgKGkgPSAwOyBpIDwgMyAmJiBjb25maWcuX2FbaV0gPT0gbnVsbDsgKytpKSB7XG4gICAgICAgIGNvbmZpZy5fYVtpXSA9IGlucHV0W2ldID0gY3VycmVudERhdGVbaV07XG4gICAgfVxuXG4gICAgLy8gWmVybyBvdXQgd2hhdGV2ZXIgd2FzIG5vdCBkZWZhdWx0ZWQsIGluY2x1ZGluZyB0aW1lXG4gICAgZm9yICg7IGkgPCA3OyBpKyspIHtcbiAgICAgICAgY29uZmlnLl9hW2ldID0gaW5wdXRbaV0gPSAoY29uZmlnLl9hW2ldID09IG51bGwpID8gKGkgPT09IDIgPyAxIDogMCkgOiBjb25maWcuX2FbaV07XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIDI0OjAwOjAwLjAwMFxuICAgIGlmIChjb25maWcuX2FbSE9VUl0gPT09IDI0ICYmXG4gICAgICAgICAgICBjb25maWcuX2FbTUlOVVRFXSA9PT0gMCAmJlxuICAgICAgICAgICAgY29uZmlnLl9hW1NFQ09ORF0gPT09IDAgJiZcbiAgICAgICAgICAgIGNvbmZpZy5fYVtNSUxMSVNFQ09ORF0gPT09IDApIHtcbiAgICAgICAgY29uZmlnLl9uZXh0RGF5ID0gdHJ1ZTtcbiAgICAgICAgY29uZmlnLl9hW0hPVVJdID0gMDtcbiAgICB9XG5cbiAgICBjb25maWcuX2QgPSAoY29uZmlnLl91c2VVVEMgPyBjcmVhdGVVVENEYXRlIDogY3JlYXRlRGF0ZSkuYXBwbHkobnVsbCwgaW5wdXQpO1xuICAgIC8vIEFwcGx5IHRpbWV6b25lIG9mZnNldCBmcm9tIGlucHV0LiBUaGUgYWN0dWFsIHV0Y09mZnNldCBjYW4gYmUgY2hhbmdlZFxuICAgIC8vIHdpdGggcGFyc2Vab25lLlxuICAgIGlmIChjb25maWcuX3R6bSAhPSBudWxsKSB7XG4gICAgICAgIGNvbmZpZy5fZC5zZXRVVENNaW51dGVzKGNvbmZpZy5fZC5nZXRVVENNaW51dGVzKCkgLSBjb25maWcuX3R6bSk7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpZy5fbmV4dERheSkge1xuICAgICAgICBjb25maWcuX2FbSE9VUl0gPSAyNDtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRheU9mWWVhckZyb21XZWVrSW5mbyhjb25maWcpIHtcbiAgICB2YXIgdywgd2Vla1llYXIsIHdlZWssIHdlZWtkYXksIGRvdywgZG95LCB0ZW1wLCB3ZWVrZGF5T3ZlcmZsb3c7XG5cbiAgICB3ID0gY29uZmlnLl93O1xuICAgIGlmICh3LkdHICE9IG51bGwgfHwgdy5XICE9IG51bGwgfHwgdy5FICE9IG51bGwpIHtcbiAgICAgICAgZG93ID0gMTtcbiAgICAgICAgZG95ID0gNDtcblxuICAgICAgICAvLyBUT0RPOiBXZSBuZWVkIHRvIHRha2UgdGhlIGN1cnJlbnQgaXNvV2Vla1llYXIsIGJ1dCB0aGF0IGRlcGVuZHMgb25cbiAgICAgICAgLy8gaG93IHdlIGludGVycHJldCBub3cgKGxvY2FsLCB1dGMsIGZpeGVkIG9mZnNldCkuIFNvIGNyZWF0ZVxuICAgICAgICAvLyBhIG5vdyB2ZXJzaW9uIG9mIGN1cnJlbnQgY29uZmlnICh0YWtlIGxvY2FsL3V0Yy9vZmZzZXQgZmxhZ3MsIGFuZFxuICAgICAgICAvLyBjcmVhdGUgbm93KS5cbiAgICAgICAgd2Vla1llYXIgPSBkZWZhdWx0cyh3LkdHLCBjb25maWcuX2FbWUVBUl0sIHdlZWtPZlllYXIoY3JlYXRlTG9jYWwoKSwgMSwgNCkueWVhcik7XG4gICAgICAgIHdlZWsgPSBkZWZhdWx0cyh3LlcsIDEpO1xuICAgICAgICB3ZWVrZGF5ID0gZGVmYXVsdHMody5FLCAxKTtcbiAgICAgICAgaWYgKHdlZWtkYXkgPCAxIHx8IHdlZWtkYXkgPiA3KSB7XG4gICAgICAgICAgICB3ZWVrZGF5T3ZlcmZsb3cgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZG93ID0gY29uZmlnLl9sb2NhbGUuX3dlZWsuZG93O1xuICAgICAgICBkb3kgPSBjb25maWcuX2xvY2FsZS5fd2Vlay5kb3k7XG5cbiAgICAgICAgdmFyIGN1cldlZWsgPSB3ZWVrT2ZZZWFyKGNyZWF0ZUxvY2FsKCksIGRvdywgZG95KTtcblxuICAgICAgICB3ZWVrWWVhciA9IGRlZmF1bHRzKHcuZ2csIGNvbmZpZy5fYVtZRUFSXSwgY3VyV2Vlay55ZWFyKTtcblxuICAgICAgICAvLyBEZWZhdWx0IHRvIGN1cnJlbnQgd2Vlay5cbiAgICAgICAgd2VlayA9IGRlZmF1bHRzKHcudywgY3VyV2Vlay53ZWVrKTtcblxuICAgICAgICBpZiAody5kICE9IG51bGwpIHtcbiAgICAgICAgICAgIC8vIHdlZWtkYXkgLS0gbG93IGRheSBudW1iZXJzIGFyZSBjb25zaWRlcmVkIG5leHQgd2Vla1xuICAgICAgICAgICAgd2Vla2RheSA9IHcuZDtcbiAgICAgICAgICAgIGlmICh3ZWVrZGF5IDwgMCB8fCB3ZWVrZGF5ID4gNikge1xuICAgICAgICAgICAgICAgIHdlZWtkYXlPdmVyZmxvdyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAody5lICE9IG51bGwpIHtcbiAgICAgICAgICAgIC8vIGxvY2FsIHdlZWtkYXkgLS0gY291bnRpbmcgc3RhcnRzIGZyb20gYmVnaW5pbmcgb2Ygd2Vla1xuICAgICAgICAgICAgd2Vla2RheSA9IHcuZSArIGRvdztcbiAgICAgICAgICAgIGlmICh3LmUgPCAwIHx8IHcuZSA+IDYpIHtcbiAgICAgICAgICAgICAgICB3ZWVrZGF5T3ZlcmZsb3cgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gZGVmYXVsdCB0byBiZWdpbmluZyBvZiB3ZWVrXG4gICAgICAgICAgICB3ZWVrZGF5ID0gZG93O1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICh3ZWVrIDwgMSB8fCB3ZWVrID4gd2Vla3NJblllYXIod2Vla1llYXIsIGRvdywgZG95KSkge1xuICAgICAgICBnZXRQYXJzaW5nRmxhZ3MoY29uZmlnKS5fb3ZlcmZsb3dXZWVrcyA9IHRydWU7XG4gICAgfSBlbHNlIGlmICh3ZWVrZGF5T3ZlcmZsb3cgIT0gbnVsbCkge1xuICAgICAgICBnZXRQYXJzaW5nRmxhZ3MoY29uZmlnKS5fb3ZlcmZsb3dXZWVrZGF5ID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0ZW1wID0gZGF5T2ZZZWFyRnJvbVdlZWtzKHdlZWtZZWFyLCB3ZWVrLCB3ZWVrZGF5LCBkb3csIGRveSk7XG4gICAgICAgIGNvbmZpZy5fYVtZRUFSXSA9IHRlbXAueWVhcjtcbiAgICAgICAgY29uZmlnLl9kYXlPZlllYXIgPSB0ZW1wLmRheU9mWWVhcjtcbiAgICB9XG59XG5cbi8vIGNvbnN0YW50IHRoYXQgcmVmZXJzIHRvIHRoZSBJU08gc3RhbmRhcmRcbmhvb2tzLklTT184NjAxID0gZnVuY3Rpb24gKCkge307XG5cbi8vIGNvbnN0YW50IHRoYXQgcmVmZXJzIHRvIHRoZSBSRkMgMjgyMiBmb3JtXG5ob29rcy5SRkNfMjgyMiA9IGZ1bmN0aW9uICgpIHt9O1xuXG4vLyBkYXRlIGZyb20gc3RyaW5nIGFuZCBmb3JtYXQgc3RyaW5nXG5mdW5jdGlvbiBjb25maWdGcm9tU3RyaW5nQW5kRm9ybWF0KGNvbmZpZykge1xuICAgIC8vIFRPRE86IE1vdmUgdGhpcyB0byBhbm90aGVyIHBhcnQgb2YgdGhlIGNyZWF0aW9uIGZsb3cgdG8gcHJldmVudCBjaXJjdWxhciBkZXBzXG4gICAgaWYgKGNvbmZpZy5fZiA9PT0gaG9va3MuSVNPXzg2MDEpIHtcbiAgICAgICAgY29uZmlnRnJvbUlTTyhjb25maWcpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChjb25maWcuX2YgPT09IGhvb2tzLlJGQ18yODIyKSB7XG4gICAgICAgIGNvbmZpZ0Zyb21SRkMyODIyKGNvbmZpZyk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uZmlnLl9hID0gW107XG4gICAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykuZW1wdHkgPSB0cnVlO1xuXG4gICAgLy8gVGhpcyBhcnJheSBpcyB1c2VkIHRvIG1ha2UgYSBEYXRlLCBlaXRoZXIgd2l0aCBgbmV3IERhdGVgIG9yIGBEYXRlLlVUQ2BcbiAgICB2YXIgc3RyaW5nID0gJycgKyBjb25maWcuX2ksXG4gICAgICAgIGksIHBhcnNlZElucHV0LCB0b2tlbnMsIHRva2VuLCBza2lwcGVkLFxuICAgICAgICBzdHJpbmdMZW5ndGggPSBzdHJpbmcubGVuZ3RoLFxuICAgICAgICB0b3RhbFBhcnNlZElucHV0TGVuZ3RoID0gMDtcblxuICAgIHRva2VucyA9IGV4cGFuZEZvcm1hdChjb25maWcuX2YsIGNvbmZpZy5fbG9jYWxlKS5tYXRjaChmb3JtYXR0aW5nVG9rZW5zKSB8fCBbXTtcblxuICAgIGZvciAoaSA9IDA7IGkgPCB0b2tlbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdG9rZW4gPSB0b2tlbnNbaV07XG4gICAgICAgIHBhcnNlZElucHV0ID0gKHN0cmluZy5tYXRjaChnZXRQYXJzZVJlZ2V4Rm9yVG9rZW4odG9rZW4sIGNvbmZpZykpIHx8IFtdKVswXTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3Rva2VuJywgdG9rZW4sICdwYXJzZWRJbnB1dCcsIHBhcnNlZElucHV0LFxuICAgICAgICAvLyAgICAgICAgICdyZWdleCcsIGdldFBhcnNlUmVnZXhGb3JUb2tlbih0b2tlbiwgY29uZmlnKSk7XG4gICAgICAgIGlmIChwYXJzZWRJbnB1dCkge1xuICAgICAgICAgICAgc2tpcHBlZCA9IHN0cmluZy5zdWJzdHIoMCwgc3RyaW5nLmluZGV4T2YocGFyc2VkSW5wdXQpKTtcbiAgICAgICAgICAgIGlmIChza2lwcGVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBnZXRQYXJzaW5nRmxhZ3MoY29uZmlnKS51bnVzZWRJbnB1dC5wdXNoKHNraXBwZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3RyaW5nID0gc3RyaW5nLnNsaWNlKHN0cmluZy5pbmRleE9mKHBhcnNlZElucHV0KSArIHBhcnNlZElucHV0Lmxlbmd0aCk7XG4gICAgICAgICAgICB0b3RhbFBhcnNlZElucHV0TGVuZ3RoICs9IHBhcnNlZElucHV0Lmxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICAvLyBkb24ndCBwYXJzZSBpZiBpdCdzIG5vdCBhIGtub3duIHRva2VuXG4gICAgICAgIGlmIChmb3JtYXRUb2tlbkZ1bmN0aW9uc1t0b2tlbl0pIHtcbiAgICAgICAgICAgIGlmIChwYXJzZWRJbnB1dCkge1xuICAgICAgICAgICAgICAgIGdldFBhcnNpbmdGbGFncyhjb25maWcpLmVtcHR5ID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBnZXRQYXJzaW5nRmxhZ3MoY29uZmlnKS51bnVzZWRUb2tlbnMucHVzaCh0b2tlbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhZGRUaW1lVG9BcnJheUZyb21Ub2tlbih0b2tlbiwgcGFyc2VkSW5wdXQsIGNvbmZpZyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY29uZmlnLl9zdHJpY3QgJiYgIXBhcnNlZElucHV0KSB7XG4gICAgICAgICAgICBnZXRQYXJzaW5nRmxhZ3MoY29uZmlnKS51bnVzZWRUb2tlbnMucHVzaCh0b2tlbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBhZGQgcmVtYWluaW5nIHVucGFyc2VkIGlucHV0IGxlbmd0aCB0byB0aGUgc3RyaW5nXG4gICAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykuY2hhcnNMZWZ0T3ZlciA9IHN0cmluZ0xlbmd0aCAtIHRvdGFsUGFyc2VkSW5wdXRMZW5ndGg7XG4gICAgaWYgKHN0cmluZy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGdldFBhcnNpbmdGbGFncyhjb25maWcpLnVudXNlZElucHV0LnB1c2goc3RyaW5nKTtcbiAgICB9XG5cbiAgICAvLyBjbGVhciBfMTJoIGZsYWcgaWYgaG91ciBpcyA8PSAxMlxuICAgIGlmIChjb25maWcuX2FbSE9VUl0gPD0gMTIgJiZcbiAgICAgICAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykuYmlnSG91ciA9PT0gdHJ1ZSAmJlxuICAgICAgICBjb25maWcuX2FbSE9VUl0gPiAwKSB7XG4gICAgICAgIGdldFBhcnNpbmdGbGFncyhjb25maWcpLmJpZ0hvdXIgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykucGFyc2VkRGF0ZVBhcnRzID0gY29uZmlnLl9hLnNsaWNlKDApO1xuICAgIGdldFBhcnNpbmdGbGFncyhjb25maWcpLm1lcmlkaWVtID0gY29uZmlnLl9tZXJpZGllbTtcbiAgICAvLyBoYW5kbGUgbWVyaWRpZW1cbiAgICBjb25maWcuX2FbSE9VUl0gPSBtZXJpZGllbUZpeFdyYXAoY29uZmlnLl9sb2NhbGUsIGNvbmZpZy5fYVtIT1VSXSwgY29uZmlnLl9tZXJpZGllbSk7XG5cbiAgICBjb25maWdGcm9tQXJyYXkoY29uZmlnKTtcbiAgICBjaGVja092ZXJmbG93KGNvbmZpZyk7XG59XG5cblxuZnVuY3Rpb24gbWVyaWRpZW1GaXhXcmFwIChsb2NhbGUsIGhvdXIsIG1lcmlkaWVtKSB7XG4gICAgdmFyIGlzUG07XG5cbiAgICBpZiAobWVyaWRpZW0gPT0gbnVsbCkge1xuICAgICAgICAvLyBub3RoaW5nIHRvIGRvXG4gICAgICAgIHJldHVybiBob3VyO1xuICAgIH1cbiAgICBpZiAobG9jYWxlLm1lcmlkaWVtSG91ciAhPSBudWxsKSB7XG4gICAgICAgIHJldHVybiBsb2NhbGUubWVyaWRpZW1Ib3VyKGhvdXIsIG1lcmlkaWVtKTtcbiAgICB9IGVsc2UgaWYgKGxvY2FsZS5pc1BNICE9IG51bGwpIHtcbiAgICAgICAgLy8gRmFsbGJhY2tcbiAgICAgICAgaXNQbSA9IGxvY2FsZS5pc1BNKG1lcmlkaWVtKTtcbiAgICAgICAgaWYgKGlzUG0gJiYgaG91ciA8IDEyKSB7XG4gICAgICAgICAgICBob3VyICs9IDEyO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNQbSAmJiBob3VyID09PSAxMikge1xuICAgICAgICAgICAgaG91ciA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGhvdXI7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gdGhpcyBpcyBub3Qgc3VwcG9zZWQgdG8gaGFwcGVuXG4gICAgICAgIHJldHVybiBob3VyO1xuICAgIH1cbn1cblxuLy8gZGF0ZSBmcm9tIHN0cmluZyBhbmQgYXJyYXkgb2YgZm9ybWF0IHN0cmluZ3NcbmZ1bmN0aW9uIGNvbmZpZ0Zyb21TdHJpbmdBbmRBcnJheShjb25maWcpIHtcbiAgICB2YXIgdGVtcENvbmZpZyxcbiAgICAgICAgYmVzdE1vbWVudCxcblxuICAgICAgICBzY29yZVRvQmVhdCxcbiAgICAgICAgaSxcbiAgICAgICAgY3VycmVudFNjb3JlO1xuXG4gICAgaWYgKGNvbmZpZy5fZi5sZW5ndGggPT09IDApIHtcbiAgICAgICAgZ2V0UGFyc2luZ0ZsYWdzKGNvbmZpZykuaW52YWxpZEZvcm1hdCA9IHRydWU7XG4gICAgICAgIGNvbmZpZy5fZCA9IG5ldyBEYXRlKE5hTik7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmb3IgKGkgPSAwOyBpIDwgY29uZmlnLl9mLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGN1cnJlbnRTY29yZSA9IDA7XG4gICAgICAgIHRlbXBDb25maWcgPSBjb3B5Q29uZmlnKHt9LCBjb25maWcpO1xuICAgICAgICBpZiAoY29uZmlnLl91c2VVVEMgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGVtcENvbmZpZy5fdXNlVVRDID0gY29uZmlnLl91c2VVVEM7XG4gICAgICAgIH1cbiAgICAgICAgdGVtcENvbmZpZy5fZiA9IGNvbmZpZy5fZltpXTtcbiAgICAgICAgY29uZmlnRnJvbVN0cmluZ0FuZEZvcm1hdCh0ZW1wQ29uZmlnKTtcblxuICAgICAgICBpZiAoIWlzVmFsaWQodGVtcENvbmZpZykpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgdGhlcmUgaXMgYW55IGlucHV0IHRoYXQgd2FzIG5vdCBwYXJzZWQgYWRkIGEgcGVuYWx0eSBmb3IgdGhhdCBmb3JtYXRcbiAgICAgICAgY3VycmVudFNjb3JlICs9IGdldFBhcnNpbmdGbGFncyh0ZW1wQ29uZmlnKS5jaGFyc0xlZnRPdmVyO1xuXG4gICAgICAgIC8vb3IgdG9rZW5zXG4gICAgICAgIGN1cnJlbnRTY29yZSArPSBnZXRQYXJzaW5nRmxhZ3ModGVtcENvbmZpZykudW51c2VkVG9rZW5zLmxlbmd0aCAqIDEwO1xuXG4gICAgICAgIGdldFBhcnNpbmdGbGFncyh0ZW1wQ29uZmlnKS5zY29yZSA9IGN1cnJlbnRTY29yZTtcblxuICAgICAgICBpZiAoc2NvcmVUb0JlYXQgPT0gbnVsbCB8fCBjdXJyZW50U2NvcmUgPCBzY29yZVRvQmVhdCkge1xuICAgICAgICAgICAgc2NvcmVUb0JlYXQgPSBjdXJyZW50U2NvcmU7XG4gICAgICAgICAgICBiZXN0TW9tZW50ID0gdGVtcENvbmZpZztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGV4dGVuZChjb25maWcsIGJlc3RNb21lbnQgfHwgdGVtcENvbmZpZyk7XG59XG5cbmZ1bmN0aW9uIGNvbmZpZ0Zyb21PYmplY3QoY29uZmlnKSB7XG4gICAgaWYgKGNvbmZpZy5fZCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIGkgPSBub3JtYWxpemVPYmplY3RVbml0cyhjb25maWcuX2kpO1xuICAgIGNvbmZpZy5fYSA9IG1hcChbaS55ZWFyLCBpLm1vbnRoLCBpLmRheSB8fCBpLmRhdGUsIGkuaG91ciwgaS5taW51dGUsIGkuc2Vjb25kLCBpLm1pbGxpc2Vjb25kXSwgZnVuY3Rpb24gKG9iaikge1xuICAgICAgICByZXR1cm4gb2JqICYmIHBhcnNlSW50KG9iaiwgMTApO1xuICAgIH0pO1xuXG4gICAgY29uZmlnRnJvbUFycmF5KGNvbmZpZyk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUZyb21Db25maWcgKGNvbmZpZykge1xuICAgIHZhciByZXMgPSBuZXcgTW9tZW50KGNoZWNrT3ZlcmZsb3cocHJlcGFyZUNvbmZpZyhjb25maWcpKSk7XG4gICAgaWYgKHJlcy5fbmV4dERheSkge1xuICAgICAgICAvLyBBZGRpbmcgaXMgc21hcnQgZW5vdWdoIGFyb3VuZCBEU1RcbiAgICAgICAgcmVzLmFkZCgxLCAnZCcpO1xuICAgICAgICByZXMuX25leHREYXkgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlcztcbn1cblxuZnVuY3Rpb24gcHJlcGFyZUNvbmZpZyAoY29uZmlnKSB7XG4gICAgdmFyIGlucHV0ID0gY29uZmlnLl9pLFxuICAgICAgICBmb3JtYXQgPSBjb25maWcuX2Y7XG5cbiAgICBjb25maWcuX2xvY2FsZSA9IGNvbmZpZy5fbG9jYWxlIHx8IGdldExvY2FsZShjb25maWcuX2wpO1xuXG4gICAgaWYgKGlucHV0ID09PSBudWxsIHx8IChmb3JtYXQgPT09IHVuZGVmaW5lZCAmJiBpbnB1dCA9PT0gJycpKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVJbnZhbGlkKHtudWxsSW5wdXQ6IHRydWV9KTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIGlucHV0ID09PSAnc3RyaW5nJykge1xuICAgICAgICBjb25maWcuX2kgPSBpbnB1dCA9IGNvbmZpZy5fbG9jYWxlLnByZXBhcnNlKGlucHV0KTtcbiAgICB9XG5cbiAgICBpZiAoaXNNb21lbnQoaW5wdXQpKSB7XG4gICAgICAgIHJldHVybiBuZXcgTW9tZW50KGNoZWNrT3ZlcmZsb3coaW5wdXQpKTtcbiAgICB9IGVsc2UgaWYgKGlzRGF0ZShpbnB1dCkpIHtcbiAgICAgICAgY29uZmlnLl9kID0gaW5wdXQ7XG4gICAgfSBlbHNlIGlmIChpc0FycmF5KGZvcm1hdCkpIHtcbiAgICAgICAgY29uZmlnRnJvbVN0cmluZ0FuZEFycmF5KGNvbmZpZyk7XG4gICAgfSBlbHNlIGlmIChmb3JtYXQpIHtcbiAgICAgICAgY29uZmlnRnJvbVN0cmluZ0FuZEZvcm1hdChjb25maWcpO1xuICAgIH0gIGVsc2Uge1xuICAgICAgICBjb25maWdGcm9tSW5wdXQoY29uZmlnKTtcbiAgICB9XG5cbiAgICBpZiAoIWlzVmFsaWQoY29uZmlnKSkge1xuICAgICAgICBjb25maWcuX2QgPSBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiBjb25maWc7XG59XG5cbmZ1bmN0aW9uIGNvbmZpZ0Zyb21JbnB1dChjb25maWcpIHtcbiAgICB2YXIgaW5wdXQgPSBjb25maWcuX2k7XG4gICAgaWYgKGlzVW5kZWZpbmVkKGlucHV0KSkge1xuICAgICAgICBjb25maWcuX2QgPSBuZXcgRGF0ZShob29rcy5ub3coKSk7XG4gICAgfSBlbHNlIGlmIChpc0RhdGUoaW5wdXQpKSB7XG4gICAgICAgIGNvbmZpZy5fZCA9IG5ldyBEYXRlKGlucHV0LnZhbHVlT2YoKSk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgaW5wdXQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGNvbmZpZ0Zyb21TdHJpbmcoY29uZmlnKTtcbiAgICB9IGVsc2UgaWYgKGlzQXJyYXkoaW5wdXQpKSB7XG4gICAgICAgIGNvbmZpZy5fYSA9IG1hcChpbnB1dC5zbGljZSgwKSwgZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KG9iaiwgMTApO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uZmlnRnJvbUFycmF5KGNvbmZpZyk7XG4gICAgfSBlbHNlIGlmIChpc09iamVjdChpbnB1dCkpIHtcbiAgICAgICAgY29uZmlnRnJvbU9iamVjdChjb25maWcpO1xuICAgIH0gZWxzZSBpZiAoaXNOdW1iZXIoaW5wdXQpKSB7XG4gICAgICAgIC8vIGZyb20gbWlsbGlzZWNvbmRzXG4gICAgICAgIGNvbmZpZy5fZCA9IG5ldyBEYXRlKGlucHV0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBob29rcy5jcmVhdGVGcm9tSW5wdXRGYWxsYmFjayhjb25maWcpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlTG9jYWxPclVUQyAoaW5wdXQsIGZvcm1hdCwgbG9jYWxlLCBzdHJpY3QsIGlzVVRDKSB7XG4gICAgdmFyIGMgPSB7fTtcblxuICAgIGlmIChsb2NhbGUgPT09IHRydWUgfHwgbG9jYWxlID09PSBmYWxzZSkge1xuICAgICAgICBzdHJpY3QgPSBsb2NhbGU7XG4gICAgICAgIGxvY2FsZSA9IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBpZiAoKGlzT2JqZWN0KGlucHV0KSAmJiBpc09iamVjdEVtcHR5KGlucHV0KSkgfHxcbiAgICAgICAgICAgIChpc0FycmF5KGlucHV0KSAmJiBpbnB1dC5sZW5ndGggPT09IDApKSB7XG4gICAgICAgIGlucHV0ID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICAvLyBvYmplY3QgY29uc3RydWN0aW9uIG11c3QgYmUgZG9uZSB0aGlzIHdheS5cbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vbW9tZW50L21vbWVudC9pc3N1ZXMvMTQyM1xuICAgIGMuX2lzQU1vbWVudE9iamVjdCA9IHRydWU7XG4gICAgYy5fdXNlVVRDID0gYy5faXNVVEMgPSBpc1VUQztcbiAgICBjLl9sID0gbG9jYWxlO1xuICAgIGMuX2kgPSBpbnB1dDtcbiAgICBjLl9mID0gZm9ybWF0O1xuICAgIGMuX3N0cmljdCA9IHN0cmljdDtcblxuICAgIHJldHVybiBjcmVhdGVGcm9tQ29uZmlnKGMpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVMb2NhbCAoaW5wdXQsIGZvcm1hdCwgbG9jYWxlLCBzdHJpY3QpIHtcbiAgICByZXR1cm4gY3JlYXRlTG9jYWxPclVUQyhpbnB1dCwgZm9ybWF0LCBsb2NhbGUsIHN0cmljdCwgZmFsc2UpO1xufVxuXG52YXIgcHJvdG90eXBlTWluID0gZGVwcmVjYXRlKFxuICAgICdtb21lbnQoKS5taW4gaXMgZGVwcmVjYXRlZCwgdXNlIG1vbWVudC5tYXggaW5zdGVhZC4gaHR0cDovL21vbWVudGpzLmNvbS9ndWlkZXMvIy93YXJuaW5ncy9taW4tbWF4LycsXG4gICAgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgb3RoZXIgPSBjcmVhdGVMb2NhbC5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuICAgICAgICBpZiAodGhpcy5pc1ZhbGlkKCkgJiYgb3RoZXIuaXNWYWxpZCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gb3RoZXIgPCB0aGlzID8gdGhpcyA6IG90aGVyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZUludmFsaWQoKTtcbiAgICAgICAgfVxuICAgIH1cbik7XG5cbnZhciBwcm90b3R5cGVNYXggPSBkZXByZWNhdGUoXG4gICAgJ21vbWVudCgpLm1heCBpcyBkZXByZWNhdGVkLCB1c2UgbW9tZW50Lm1pbiBpbnN0ZWFkLiBodHRwOi8vbW9tZW50anMuY29tL2d1aWRlcy8jL3dhcm5pbmdzL21pbi1tYXgvJyxcbiAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBvdGhlciA9IGNyZWF0ZUxvY2FsLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gICAgICAgIGlmICh0aGlzLmlzVmFsaWQoKSAmJiBvdGhlci5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgIHJldHVybiBvdGhlciA+IHRoaXMgPyB0aGlzIDogb3RoZXI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlSW52YWxpZCgpO1xuICAgICAgICB9XG4gICAgfVxuKTtcblxuLy8gUGljayBhIG1vbWVudCBtIGZyb20gbW9tZW50cyBzbyB0aGF0IG1bZm5dKG90aGVyKSBpcyB0cnVlIGZvciBhbGxcbi8vIG90aGVyLiBUaGlzIHJlbGllcyBvbiB0aGUgZnVuY3Rpb24gZm4gdG8gYmUgdHJhbnNpdGl2ZS5cbi8vXG4vLyBtb21lbnRzIHNob3VsZCBlaXRoZXIgYmUgYW4gYXJyYXkgb2YgbW9tZW50IG9iamVjdHMgb3IgYW4gYXJyYXksIHdob3NlXG4vLyBmaXJzdCBlbGVtZW50IGlzIGFuIGFycmF5IG9mIG1vbWVudCBvYmplY3RzLlxuZnVuY3Rpb24gcGlja0J5KGZuLCBtb21lbnRzKSB7XG4gICAgdmFyIHJlcywgaTtcbiAgICBpZiAobW9tZW50cy5sZW5ndGggPT09IDEgJiYgaXNBcnJheShtb21lbnRzWzBdKSkge1xuICAgICAgICBtb21lbnRzID0gbW9tZW50c1swXTtcbiAgICB9XG4gICAgaWYgKCFtb21lbnRzLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gY3JlYXRlTG9jYWwoKTtcbiAgICB9XG4gICAgcmVzID0gbW9tZW50c1swXTtcbiAgICBmb3IgKGkgPSAxOyBpIDwgbW9tZW50cy5sZW5ndGg7ICsraSkge1xuICAgICAgICBpZiAoIW1vbWVudHNbaV0uaXNWYWxpZCgpIHx8IG1vbWVudHNbaV1bZm5dKHJlcykpIHtcbiAgICAgICAgICAgIHJlcyA9IG1vbWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlcztcbn1cblxuLy8gVE9ETzogVXNlIFtdLnNvcnQgaW5zdGVhZD9cbmZ1bmN0aW9uIG1pbiAoKSB7XG4gICAgdmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMCk7XG5cbiAgICByZXR1cm4gcGlja0J5KCdpc0JlZm9yZScsIGFyZ3MpO1xufVxuXG5mdW5jdGlvbiBtYXggKCkge1xuICAgIHZhciBhcmdzID0gW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDApO1xuXG4gICAgcmV0dXJuIHBpY2tCeSgnaXNBZnRlcicsIGFyZ3MpO1xufVxuXG52YXIgbm93ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBEYXRlLm5vdyA/IERhdGUubm93KCkgOiArKG5ldyBEYXRlKCkpO1xufTtcblxudmFyIG9yZGVyaW5nID0gWyd5ZWFyJywgJ3F1YXJ0ZXInLCAnbW9udGgnLCAnd2VlaycsICdkYXknLCAnaG91cicsICdtaW51dGUnLCAnc2Vjb25kJywgJ21pbGxpc2Vjb25kJ107XG5cbmZ1bmN0aW9uIGlzRHVyYXRpb25WYWxpZChtKSB7XG4gICAgZm9yICh2YXIga2V5IGluIG0pIHtcbiAgICAgICAgaWYgKCEob3JkZXJpbmcuaW5kZXhPZihrZXkpICE9PSAtMSAmJiAobVtrZXldID09IG51bGwgfHwgIWlzTmFOKG1ba2V5XSkpKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHVuaXRIYXNEZWNpbWFsID0gZmFsc2U7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvcmRlcmluZy5sZW5ndGg7ICsraSkge1xuICAgICAgICBpZiAobVtvcmRlcmluZ1tpXV0pIHtcbiAgICAgICAgICAgIGlmICh1bml0SGFzRGVjaW1hbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gb25seSBhbGxvdyBub24taW50ZWdlcnMgZm9yIHNtYWxsZXN0IHVuaXRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwYXJzZUZsb2F0KG1bb3JkZXJpbmdbaV1dKSAhPT0gdG9JbnQobVtvcmRlcmluZ1tpXV0pKSB7XG4gICAgICAgICAgICAgICAgdW5pdEhhc0RlY2ltYWwgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIGlzVmFsaWQkMSgpIHtcbiAgICByZXR1cm4gdGhpcy5faXNWYWxpZDtcbn1cblxuZnVuY3Rpb24gY3JlYXRlSW52YWxpZCQxKCkge1xuICAgIHJldHVybiBjcmVhdGVEdXJhdGlvbihOYU4pO1xufVxuXG5mdW5jdGlvbiBEdXJhdGlvbiAoZHVyYXRpb24pIHtcbiAgICB2YXIgbm9ybWFsaXplZElucHV0ID0gbm9ybWFsaXplT2JqZWN0VW5pdHMoZHVyYXRpb24pLFxuICAgICAgICB5ZWFycyA9IG5vcm1hbGl6ZWRJbnB1dC55ZWFyIHx8IDAsXG4gICAgICAgIHF1YXJ0ZXJzID0gbm9ybWFsaXplZElucHV0LnF1YXJ0ZXIgfHwgMCxcbiAgICAgICAgbW9udGhzID0gbm9ybWFsaXplZElucHV0Lm1vbnRoIHx8IDAsXG4gICAgICAgIHdlZWtzID0gbm9ybWFsaXplZElucHV0LndlZWsgfHwgMCxcbiAgICAgICAgZGF5cyA9IG5vcm1hbGl6ZWRJbnB1dC5kYXkgfHwgMCxcbiAgICAgICAgaG91cnMgPSBub3JtYWxpemVkSW5wdXQuaG91ciB8fCAwLFxuICAgICAgICBtaW51dGVzID0gbm9ybWFsaXplZElucHV0Lm1pbnV0ZSB8fCAwLFxuICAgICAgICBzZWNvbmRzID0gbm9ybWFsaXplZElucHV0LnNlY29uZCB8fCAwLFxuICAgICAgICBtaWxsaXNlY29uZHMgPSBub3JtYWxpemVkSW5wdXQubWlsbGlzZWNvbmQgfHwgMDtcblxuICAgIHRoaXMuX2lzVmFsaWQgPSBpc0R1cmF0aW9uVmFsaWQobm9ybWFsaXplZElucHV0KTtcblxuICAgIC8vIHJlcHJlc2VudGF0aW9uIGZvciBkYXRlQWRkUmVtb3ZlXG4gICAgdGhpcy5fbWlsbGlzZWNvbmRzID0gK21pbGxpc2Vjb25kcyArXG4gICAgICAgIHNlY29uZHMgKiAxZTMgKyAvLyAxMDAwXG4gICAgICAgIG1pbnV0ZXMgKiA2ZTQgKyAvLyAxMDAwICogNjBcbiAgICAgICAgaG91cnMgKiAxMDAwICogNjAgKiA2MDsgLy91c2luZyAxMDAwICogNjAgKiA2MCBpbnN0ZWFkIG9mIDM2ZTUgdG8gYXZvaWQgZmxvYXRpbmcgcG9pbnQgcm91bmRpbmcgZXJyb3JzIGh0dHBzOi8vZ2l0aHViLmNvbS9tb21lbnQvbW9tZW50L2lzc3Vlcy8yOTc4XG4gICAgLy8gQmVjYXVzZSBvZiBkYXRlQWRkUmVtb3ZlIHRyZWF0cyAyNCBob3VycyBhcyBkaWZmZXJlbnQgZnJvbSBhXG4gICAgLy8gZGF5IHdoZW4gd29ya2luZyBhcm91bmQgRFNULCB3ZSBuZWVkIHRvIHN0b3JlIHRoZW0gc2VwYXJhdGVseVxuICAgIHRoaXMuX2RheXMgPSArZGF5cyArXG4gICAgICAgIHdlZWtzICogNztcbiAgICAvLyBJdCBpcyBpbXBvc3NpYmxlIHRyYW5zbGF0ZSBtb250aHMgaW50byBkYXlzIHdpdGhvdXQga25vd2luZ1xuICAgIC8vIHdoaWNoIG1vbnRocyB5b3UgYXJlIGFyZSB0YWxraW5nIGFib3V0LCBzbyB3ZSBoYXZlIHRvIHN0b3JlXG4gICAgLy8gaXQgc2VwYXJhdGVseS5cbiAgICB0aGlzLl9tb250aHMgPSArbW9udGhzICtcbiAgICAgICAgcXVhcnRlcnMgKiAzICtcbiAgICAgICAgeWVhcnMgKiAxMjtcblxuICAgIHRoaXMuX2RhdGEgPSB7fTtcblxuICAgIHRoaXMuX2xvY2FsZSA9IGdldExvY2FsZSgpO1xuXG4gICAgdGhpcy5fYnViYmxlKCk7XG59XG5cbmZ1bmN0aW9uIGlzRHVyYXRpb24gKG9iaikge1xuICAgIHJldHVybiBvYmogaW5zdGFuY2VvZiBEdXJhdGlvbjtcbn1cblxuZnVuY3Rpb24gYWJzUm91bmQgKG51bWJlcikge1xuICAgIGlmIChudW1iZXIgPCAwKSB7XG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKC0xICogbnVtYmVyKSAqIC0xO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKG51bWJlcik7XG4gICAgfVxufVxuXG4vLyBGT1JNQVRUSU5HXG5cbmZ1bmN0aW9uIG9mZnNldCAodG9rZW4sIHNlcGFyYXRvcikge1xuICAgIGFkZEZvcm1hdFRva2VuKHRva2VuLCAwLCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBvZmZzZXQgPSB0aGlzLnV0Y09mZnNldCgpO1xuICAgICAgICB2YXIgc2lnbiA9ICcrJztcbiAgICAgICAgaWYgKG9mZnNldCA8IDApIHtcbiAgICAgICAgICAgIG9mZnNldCA9IC1vZmZzZXQ7XG4gICAgICAgICAgICBzaWduID0gJy0nO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzaWduICsgemVyb0ZpbGwofn4ob2Zmc2V0IC8gNjApLCAyKSArIHNlcGFyYXRvciArIHplcm9GaWxsKH5+KG9mZnNldCkgJSA2MCwgMik7XG4gICAgfSk7XG59XG5cbm9mZnNldCgnWicsICc6Jyk7XG5vZmZzZXQoJ1paJywgJycpO1xuXG4vLyBQQVJTSU5HXG5cbmFkZFJlZ2V4VG9rZW4oJ1onLCAgbWF0Y2hTaG9ydE9mZnNldCk7XG5hZGRSZWdleFRva2VuKCdaWicsIG1hdGNoU2hvcnRPZmZzZXQpO1xuYWRkUGFyc2VUb2tlbihbJ1onLCAnWlonXSwgZnVuY3Rpb24gKGlucHV0LCBhcnJheSwgY29uZmlnKSB7XG4gICAgY29uZmlnLl91c2VVVEMgPSB0cnVlO1xuICAgIGNvbmZpZy5fdHptID0gb2Zmc2V0RnJvbVN0cmluZyhtYXRjaFNob3J0T2Zmc2V0LCBpbnB1dCk7XG59KTtcblxuLy8gSEVMUEVSU1xuXG4vLyB0aW1lem9uZSBjaHVua2VyXG4vLyAnKzEwOjAwJyA+IFsnMTAnLCAgJzAwJ11cbi8vICctMTUzMCcgID4gWyctMTUnLCAnMzAnXVxudmFyIGNodW5rT2Zmc2V0ID0gLyhbXFwrXFwtXXxcXGRcXGQpL2dpO1xuXG5mdW5jdGlvbiBvZmZzZXRGcm9tU3RyaW5nKG1hdGNoZXIsIHN0cmluZykge1xuICAgIHZhciBtYXRjaGVzID0gKHN0cmluZyB8fCAnJykubWF0Y2gobWF0Y2hlcik7XG5cbiAgICBpZiAobWF0Y2hlcyA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICB2YXIgY2h1bmsgICA9IG1hdGNoZXNbbWF0Y2hlcy5sZW5ndGggLSAxXSB8fCBbXTtcbiAgICB2YXIgcGFydHMgICA9IChjaHVuayArICcnKS5tYXRjaChjaHVua09mZnNldCkgfHwgWyctJywgMCwgMF07XG4gICAgdmFyIG1pbnV0ZXMgPSArKHBhcnRzWzFdICogNjApICsgdG9JbnQocGFydHNbMl0pO1xuXG4gICAgcmV0dXJuIG1pbnV0ZXMgPT09IDAgP1xuICAgICAgMCA6XG4gICAgICBwYXJ0c1swXSA9PT0gJysnID8gbWludXRlcyA6IC1taW51dGVzO1xufVxuXG4vLyBSZXR1cm4gYSBtb21lbnQgZnJvbSBpbnB1dCwgdGhhdCBpcyBsb2NhbC91dGMvem9uZSBlcXVpdmFsZW50IHRvIG1vZGVsLlxuZnVuY3Rpb24gY2xvbmVXaXRoT2Zmc2V0KGlucHV0LCBtb2RlbCkge1xuICAgIHZhciByZXMsIGRpZmY7XG4gICAgaWYgKG1vZGVsLl9pc1VUQykge1xuICAgICAgICByZXMgPSBtb2RlbC5jbG9uZSgpO1xuICAgICAgICBkaWZmID0gKGlzTW9tZW50KGlucHV0KSB8fCBpc0RhdGUoaW5wdXQpID8gaW5wdXQudmFsdWVPZigpIDogY3JlYXRlTG9jYWwoaW5wdXQpLnZhbHVlT2YoKSkgLSByZXMudmFsdWVPZigpO1xuICAgICAgICAvLyBVc2UgbG93LWxldmVsIGFwaSwgYmVjYXVzZSB0aGlzIGZuIGlzIGxvdy1sZXZlbCBhcGkuXG4gICAgICAgIHJlcy5fZC5zZXRUaW1lKHJlcy5fZC52YWx1ZU9mKCkgKyBkaWZmKTtcbiAgICAgICAgaG9va3MudXBkYXRlT2Zmc2V0KHJlcywgZmFsc2UpO1xuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVMb2NhbChpbnB1dCkubG9jYWwoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldERhdGVPZmZzZXQgKG0pIHtcbiAgICAvLyBPbiBGaXJlZm94LjI0IERhdGUjZ2V0VGltZXpvbmVPZmZzZXQgcmV0dXJucyBhIGZsb2F0aW5nIHBvaW50LlxuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9tb21lbnQvbW9tZW50L3B1bGwvMTg3MVxuICAgIHJldHVybiAtTWF0aC5yb3VuZChtLl9kLmdldFRpbWV6b25lT2Zmc2V0KCkgLyAxNSkgKiAxNTtcbn1cblxuLy8gSE9PS1NcblxuLy8gVGhpcyBmdW5jdGlvbiB3aWxsIGJlIGNhbGxlZCB3aGVuZXZlciBhIG1vbWVudCBpcyBtdXRhdGVkLlxuLy8gSXQgaXMgaW50ZW5kZWQgdG8ga2VlcCB0aGUgb2Zmc2V0IGluIHN5bmMgd2l0aCB0aGUgdGltZXpvbmUuXG5ob29rcy51cGRhdGVPZmZzZXQgPSBmdW5jdGlvbiAoKSB7fTtcblxuLy8gTU9NRU5UU1xuXG4vLyBrZWVwTG9jYWxUaW1lID0gdHJ1ZSBtZWFucyBvbmx5IGNoYW5nZSB0aGUgdGltZXpvbmUsIHdpdGhvdXRcbi8vIGFmZmVjdGluZyB0aGUgbG9jYWwgaG91ci4gU28gNTozMToyNiArMDMwMCAtLVt1dGNPZmZzZXQoMiwgdHJ1ZSldLS0+XG4vLyA1OjMxOjI2ICswMjAwIEl0IGlzIHBvc3NpYmxlIHRoYXQgNTozMToyNiBkb2Vzbid0IGV4aXN0IHdpdGggb2Zmc2V0XG4vLyArMDIwMCwgc28gd2UgYWRqdXN0IHRoZSB0aW1lIGFzIG5lZWRlZCwgdG8gYmUgdmFsaWQuXG4vL1xuLy8gS2VlcGluZyB0aGUgdGltZSBhY3R1YWxseSBhZGRzL3N1YnRyYWN0cyAob25lIGhvdXIpXG4vLyBmcm9tIHRoZSBhY3R1YWwgcmVwcmVzZW50ZWQgdGltZS4gVGhhdCBpcyB3aHkgd2UgY2FsbCB1cGRhdGVPZmZzZXRcbi8vIGEgc2Vjb25kIHRpbWUuIEluIGNhc2UgaXQgd2FudHMgdXMgdG8gY2hhbmdlIHRoZSBvZmZzZXQgYWdhaW5cbi8vIF9jaGFuZ2VJblByb2dyZXNzID09IHRydWUgY2FzZSwgdGhlbiB3ZSBoYXZlIHRvIGFkanVzdCwgYmVjYXVzZVxuLy8gdGhlcmUgaXMgbm8gc3VjaCB0aW1lIGluIHRoZSBnaXZlbiB0aW1lem9uZS5cbmZ1bmN0aW9uIGdldFNldE9mZnNldCAoaW5wdXQsIGtlZXBMb2NhbFRpbWUsIGtlZXBNaW51dGVzKSB7XG4gICAgdmFyIG9mZnNldCA9IHRoaXMuX29mZnNldCB8fCAwLFxuICAgICAgICBsb2NhbEFkanVzdDtcbiAgICBpZiAoIXRoaXMuaXNWYWxpZCgpKSB7XG4gICAgICAgIHJldHVybiBpbnB1dCAhPSBudWxsID8gdGhpcyA6IE5hTjtcbiAgICB9XG4gICAgaWYgKGlucHV0ICE9IG51bGwpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBpbnB1dCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGlucHV0ID0gb2Zmc2V0RnJvbVN0cmluZyhtYXRjaFNob3J0T2Zmc2V0LCBpbnB1dCk7XG4gICAgICAgICAgICBpZiAoaW5wdXQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChNYXRoLmFicyhpbnB1dCkgPCAxNiAmJiAha2VlcE1pbnV0ZXMpIHtcbiAgICAgICAgICAgIGlucHV0ID0gaW5wdXQgKiA2MDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuX2lzVVRDICYmIGtlZXBMb2NhbFRpbWUpIHtcbiAgICAgICAgICAgIGxvY2FsQWRqdXN0ID0gZ2V0RGF0ZU9mZnNldCh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9vZmZzZXQgPSBpbnB1dDtcbiAgICAgICAgdGhpcy5faXNVVEMgPSB0cnVlO1xuICAgICAgICBpZiAobG9jYWxBZGp1c3QgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5hZGQobG9jYWxBZGp1c3QsICdtJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9mZnNldCAhPT0gaW5wdXQpIHtcbiAgICAgICAgICAgIGlmICgha2VlcExvY2FsVGltZSB8fCB0aGlzLl9jaGFuZ2VJblByb2dyZXNzKSB7XG4gICAgICAgICAgICAgICAgYWRkU3VidHJhY3QodGhpcywgY3JlYXRlRHVyYXRpb24oaW5wdXQgLSBvZmZzZXQsICdtJyksIDEsIGZhbHNlKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRoaXMuX2NoYW5nZUluUHJvZ3Jlc3MpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGFuZ2VJblByb2dyZXNzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBob29rcy51cGRhdGVPZmZzZXQodGhpcywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fY2hhbmdlSW5Qcm9ncmVzcyA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzVVRDID8gb2Zmc2V0IDogZ2V0RGF0ZU9mZnNldCh0aGlzKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldFNldFpvbmUgKGlucHV0LCBrZWVwTG9jYWxUaW1lKSB7XG4gICAgaWYgKGlucHV0ICE9IG51bGwpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBpbnB1dCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGlucHV0ID0gLWlucHV0O1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy51dGNPZmZzZXQoaW5wdXQsIGtlZXBMb2NhbFRpbWUpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAtdGhpcy51dGNPZmZzZXQoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHNldE9mZnNldFRvVVRDIChrZWVwTG9jYWxUaW1lKSB7XG4gICAgcmV0dXJuIHRoaXMudXRjT2Zmc2V0KDAsIGtlZXBMb2NhbFRpbWUpO1xufVxuXG5mdW5jdGlvbiBzZXRPZmZzZXRUb0xvY2FsIChrZWVwTG9jYWxUaW1lKSB7XG4gICAgaWYgKHRoaXMuX2lzVVRDKSB7XG4gICAgICAgIHRoaXMudXRjT2Zmc2V0KDAsIGtlZXBMb2NhbFRpbWUpO1xuICAgICAgICB0aGlzLl9pc1VUQyA9IGZhbHNlO1xuXG4gICAgICAgIGlmIChrZWVwTG9jYWxUaW1lKSB7XG4gICAgICAgICAgICB0aGlzLnN1YnRyYWN0KGdldERhdGVPZmZzZXQodGhpcyksICdtJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG59XG5cbmZ1bmN0aW9uIHNldE9mZnNldFRvUGFyc2VkT2Zmc2V0ICgpIHtcbiAgICBpZiAodGhpcy5fdHptICE9IG51bGwpIHtcbiAgICAgICAgdGhpcy51dGNPZmZzZXQodGhpcy5fdHptLCBmYWxzZSwgdHJ1ZSk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdGhpcy5faSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgdmFyIHRab25lID0gb2Zmc2V0RnJvbVN0cmluZyhtYXRjaE9mZnNldCwgdGhpcy5faSk7XG4gICAgICAgIGlmICh0Wm9uZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLnV0Y09mZnNldCh0Wm9uZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnV0Y09mZnNldCgwLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn1cblxuZnVuY3Rpb24gaGFzQWxpZ25lZEhvdXJPZmZzZXQgKGlucHV0KSB7XG4gICAgaWYgKCF0aGlzLmlzVmFsaWQoKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlucHV0ID0gaW5wdXQgPyBjcmVhdGVMb2NhbChpbnB1dCkudXRjT2Zmc2V0KCkgOiAwO1xuXG4gICAgcmV0dXJuICh0aGlzLnV0Y09mZnNldCgpIC0gaW5wdXQpICUgNjAgPT09IDA7XG59XG5cbmZ1bmN0aW9uIGlzRGF5bGlnaHRTYXZpbmdUaW1lICgpIHtcbiAgICByZXR1cm4gKFxuICAgICAgICB0aGlzLnV0Y09mZnNldCgpID4gdGhpcy5jbG9uZSgpLm1vbnRoKDApLnV0Y09mZnNldCgpIHx8XG4gICAgICAgIHRoaXMudXRjT2Zmc2V0KCkgPiB0aGlzLmNsb25lKCkubW9udGgoNSkudXRjT2Zmc2V0KClcbiAgICApO1xufVxuXG5mdW5jdGlvbiBpc0RheWxpZ2h0U2F2aW5nVGltZVNoaWZ0ZWQgKCkge1xuICAgIGlmICghaXNVbmRlZmluZWQodGhpcy5faXNEU1RTaGlmdGVkKSkge1xuICAgICAgICByZXR1cm4gdGhpcy5faXNEU1RTaGlmdGVkO1xuICAgIH1cblxuICAgIHZhciBjID0ge307XG5cbiAgICBjb3B5Q29uZmlnKGMsIHRoaXMpO1xuICAgIGMgPSBwcmVwYXJlQ29uZmlnKGMpO1xuXG4gICAgaWYgKGMuX2EpIHtcbiAgICAgICAgdmFyIG90aGVyID0gYy5faXNVVEMgPyBjcmVhdGVVVEMoYy5fYSkgOiBjcmVhdGVMb2NhbChjLl9hKTtcbiAgICAgICAgdGhpcy5faXNEU1RTaGlmdGVkID0gdGhpcy5pc1ZhbGlkKCkgJiZcbiAgICAgICAgICAgIGNvbXBhcmVBcnJheXMoYy5fYSwgb3RoZXIudG9BcnJheSgpKSA+IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5faXNEU1RTaGlmdGVkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuX2lzRFNUU2hpZnRlZDtcbn1cblxuZnVuY3Rpb24gaXNMb2NhbCAoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNWYWxpZCgpID8gIXRoaXMuX2lzVVRDIDogZmFsc2U7XG59XG5cbmZ1bmN0aW9uIGlzVXRjT2Zmc2V0ICgpIHtcbiAgICByZXR1cm4gdGhpcy5pc1ZhbGlkKCkgPyB0aGlzLl9pc1VUQyA6IGZhbHNlO1xufVxuXG5mdW5jdGlvbiBpc1V0YyAoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNWYWxpZCgpID8gdGhpcy5faXNVVEMgJiYgdGhpcy5fb2Zmc2V0ID09PSAwIDogZmFsc2U7XG59XG5cbi8vIEFTUC5ORVQganNvbiBkYXRlIGZvcm1hdCByZWdleFxudmFyIGFzcE5ldFJlZ2V4ID0gL14oXFwtKT8oPzooXFxkKilbLiBdKT8oXFxkKylcXDooXFxkKykoPzpcXDooXFxkKykoXFwuXFxkKik/KT8kLztcblxuLy8gZnJvbSBodHRwOi8vZG9jcy5jbG9zdXJlLWxpYnJhcnkuZ29vZ2xlY29kZS5jb20vZ2l0L2Nsb3N1cmVfZ29vZ19kYXRlX2RhdGUuanMuc291cmNlLmh0bWxcbi8vIHNvbWV3aGF0IG1vcmUgaW4gbGluZSB3aXRoIDQuNC4zLjIgMjAwNCBzcGVjLCBidXQgYWxsb3dzIGRlY2ltYWwgYW55d2hlcmVcbi8vIGFuZCBmdXJ0aGVyIG1vZGlmaWVkIHRvIGFsbG93IGZvciBzdHJpbmdzIGNvbnRhaW5pbmcgYm90aCB3ZWVrIGFuZCBkYXlcbnZhciBpc29SZWdleCA9IC9eKC0pP1AoPzooLT9bMC05LC5dKilZKT8oPzooLT9bMC05LC5dKilNKT8oPzooLT9bMC05LC5dKilXKT8oPzooLT9bMC05LC5dKilEKT8oPzpUKD86KC0/WzAtOSwuXSopSCk/KD86KC0/WzAtOSwuXSopTSk/KD86KC0/WzAtOSwuXSopUyk/KT8kLztcblxuZnVuY3Rpb24gY3JlYXRlRHVyYXRpb24gKGlucHV0LCBrZXkpIHtcbiAgICB2YXIgZHVyYXRpb24gPSBpbnB1dCxcbiAgICAgICAgLy8gbWF0Y2hpbmcgYWdhaW5zdCByZWdleHAgaXMgZXhwZW5zaXZlLCBkbyBpdCBvbiBkZW1hbmRcbiAgICAgICAgbWF0Y2ggPSBudWxsLFxuICAgICAgICBzaWduLFxuICAgICAgICByZXQsXG4gICAgICAgIGRpZmZSZXM7XG5cbiAgICBpZiAoaXNEdXJhdGlvbihpbnB1dCkpIHtcbiAgICAgICAgZHVyYXRpb24gPSB7XG4gICAgICAgICAgICBtcyA6IGlucHV0Ll9taWxsaXNlY29uZHMsXG4gICAgICAgICAgICBkICA6IGlucHV0Ll9kYXlzLFxuICAgICAgICAgICAgTSAgOiBpbnB1dC5fbW9udGhzXG4gICAgICAgIH07XG4gICAgfSBlbHNlIGlmIChpc051bWJlcihpbnB1dCkpIHtcbiAgICAgICAgZHVyYXRpb24gPSB7fTtcbiAgICAgICAgaWYgKGtleSkge1xuICAgICAgICAgICAgZHVyYXRpb25ba2V5XSA9IGlucHV0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZHVyYXRpb24ubWlsbGlzZWNvbmRzID0gaW5wdXQ7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKCEhKG1hdGNoID0gYXNwTmV0UmVnZXguZXhlYyhpbnB1dCkpKSB7XG4gICAgICAgIHNpZ24gPSAobWF0Y2hbMV0gPT09ICctJykgPyAtMSA6IDE7XG4gICAgICAgIGR1cmF0aW9uID0ge1xuICAgICAgICAgICAgeSAgOiAwLFxuICAgICAgICAgICAgZCAgOiB0b0ludChtYXRjaFtEQVRFXSkgICAgICAgICAgICAgICAgICAgICAgICAgKiBzaWduLFxuICAgICAgICAgICAgaCAgOiB0b0ludChtYXRjaFtIT1VSXSkgICAgICAgICAgICAgICAgICAgICAgICAgKiBzaWduLFxuICAgICAgICAgICAgbSAgOiB0b0ludChtYXRjaFtNSU5VVEVdKSAgICAgICAgICAgICAgICAgICAgICAgKiBzaWduLFxuICAgICAgICAgICAgcyAgOiB0b0ludChtYXRjaFtTRUNPTkRdKSAgICAgICAgICAgICAgICAgICAgICAgKiBzaWduLFxuICAgICAgICAgICAgbXMgOiB0b0ludChhYnNSb3VuZChtYXRjaFtNSUxMSVNFQ09ORF0gKiAxMDAwKSkgKiBzaWduIC8vIHRoZSBtaWxsaXNlY29uZCBkZWNpbWFsIHBvaW50IGlzIGluY2x1ZGVkIGluIHRoZSBtYXRjaFxuICAgICAgICB9O1xuICAgIH0gZWxzZSBpZiAoISEobWF0Y2ggPSBpc29SZWdleC5leGVjKGlucHV0KSkpIHtcbiAgICAgICAgc2lnbiA9IChtYXRjaFsxXSA9PT0gJy0nKSA/IC0xIDogMTtcbiAgICAgICAgZHVyYXRpb24gPSB7XG4gICAgICAgICAgICB5IDogcGFyc2VJc28obWF0Y2hbMl0sIHNpZ24pLFxuICAgICAgICAgICAgTSA6IHBhcnNlSXNvKG1hdGNoWzNdLCBzaWduKSxcbiAgICAgICAgICAgIHcgOiBwYXJzZUlzbyhtYXRjaFs0XSwgc2lnbiksXG4gICAgICAgICAgICBkIDogcGFyc2VJc28obWF0Y2hbNV0sIHNpZ24pLFxuICAgICAgICAgICAgaCA6IHBhcnNlSXNvKG1hdGNoWzZdLCBzaWduKSxcbiAgICAgICAgICAgIG0gOiBwYXJzZUlzbyhtYXRjaFs3XSwgc2lnbiksXG4gICAgICAgICAgICBzIDogcGFyc2VJc28obWF0Y2hbOF0sIHNpZ24pXG4gICAgICAgIH07XG4gICAgfSBlbHNlIGlmIChkdXJhdGlvbiA9PSBudWxsKSB7Ly8gY2hlY2tzIGZvciBudWxsIG9yIHVuZGVmaW5lZFxuICAgICAgICBkdXJhdGlvbiA9IHt9O1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGR1cmF0aW9uID09PSAnb2JqZWN0JyAmJiAoJ2Zyb20nIGluIGR1cmF0aW9uIHx8ICd0bycgaW4gZHVyYXRpb24pKSB7XG4gICAgICAgIGRpZmZSZXMgPSBtb21lbnRzRGlmZmVyZW5jZShjcmVhdGVMb2NhbChkdXJhdGlvbi5mcm9tKSwgY3JlYXRlTG9jYWwoZHVyYXRpb24udG8pKTtcblxuICAgICAgICBkdXJhdGlvbiA9IHt9O1xuICAgICAgICBkdXJhdGlvbi5tcyA9IGRpZmZSZXMubWlsbGlzZWNvbmRzO1xuICAgICAgICBkdXJhdGlvbi5NID0gZGlmZlJlcy5tb250aHM7XG4gICAgfVxuXG4gICAgcmV0ID0gbmV3IER1cmF0aW9uKGR1cmF0aW9uKTtcblxuICAgIGlmIChpc0R1cmF0aW9uKGlucHV0KSAmJiBoYXNPd25Qcm9wKGlucHV0LCAnX2xvY2FsZScpKSB7XG4gICAgICAgIHJldC5fbG9jYWxlID0gaW5wdXQuX2xvY2FsZTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmV0O1xufVxuXG5jcmVhdGVEdXJhdGlvbi5mbiA9IER1cmF0aW9uLnByb3RvdHlwZTtcbmNyZWF0ZUR1cmF0aW9uLmludmFsaWQgPSBjcmVhdGVJbnZhbGlkJDE7XG5cbmZ1bmN0aW9uIHBhcnNlSXNvIChpbnAsIHNpZ24pIHtcbiAgICAvLyBXZSdkIG5vcm1hbGx5IHVzZSB+fmlucCBmb3IgdGhpcywgYnV0IHVuZm9ydHVuYXRlbHkgaXQgYWxzb1xuICAgIC8vIGNvbnZlcnRzIGZsb2F0cyB0byBpbnRzLlxuICAgIC8vIGlucCBtYXkgYmUgdW5kZWZpbmVkLCBzbyBjYXJlZnVsIGNhbGxpbmcgcmVwbGFjZSBvbiBpdC5cbiAgICB2YXIgcmVzID0gaW5wICYmIHBhcnNlRmxvYXQoaW5wLnJlcGxhY2UoJywnLCAnLicpKTtcbiAgICAvLyBhcHBseSBzaWduIHdoaWxlIHdlJ3JlIGF0IGl0XG4gICAgcmV0dXJuIChpc05hTihyZXMpID8gMCA6IHJlcykgKiBzaWduO1xufVxuXG5mdW5jdGlvbiBwb3NpdGl2ZU1vbWVudHNEaWZmZXJlbmNlKGJhc2UsIG90aGVyKSB7XG4gICAgdmFyIHJlcyA9IHttaWxsaXNlY29uZHM6IDAsIG1vbnRoczogMH07XG5cbiAgICByZXMubW9udGhzID0gb3RoZXIubW9udGgoKSAtIGJhc2UubW9udGgoKSArXG4gICAgICAgIChvdGhlci55ZWFyKCkgLSBiYXNlLnllYXIoKSkgKiAxMjtcbiAgICBpZiAoYmFzZS5jbG9uZSgpLmFkZChyZXMubW9udGhzLCAnTScpLmlzQWZ0ZXIob3RoZXIpKSB7XG4gICAgICAgIC0tcmVzLm1vbnRocztcbiAgICB9XG5cbiAgICByZXMubWlsbGlzZWNvbmRzID0gK290aGVyIC0gKyhiYXNlLmNsb25lKCkuYWRkKHJlcy5tb250aHMsICdNJykpO1xuXG4gICAgcmV0dXJuIHJlcztcbn1cblxuZnVuY3Rpb24gbW9tZW50c0RpZmZlcmVuY2UoYmFzZSwgb3RoZXIpIHtcbiAgICB2YXIgcmVzO1xuICAgIGlmICghKGJhc2UuaXNWYWxpZCgpICYmIG90aGVyLmlzVmFsaWQoKSkpIHtcbiAgICAgICAgcmV0dXJuIHttaWxsaXNlY29uZHM6IDAsIG1vbnRoczogMH07XG4gICAgfVxuXG4gICAgb3RoZXIgPSBjbG9uZVdpdGhPZmZzZXQob3RoZXIsIGJhc2UpO1xuICAgIGlmIChiYXNlLmlzQmVmb3JlKG90aGVyKSkge1xuICAgICAgICByZXMgPSBwb3NpdGl2ZU1vbWVudHNEaWZmZXJlbmNlKGJhc2UsIG90aGVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXMgPSBwb3NpdGl2ZU1vbWVudHNEaWZmZXJlbmNlKG90aGVyLCBiYXNlKTtcbiAgICAgICAgcmVzLm1pbGxpc2Vjb25kcyA9IC1yZXMubWlsbGlzZWNvbmRzO1xuICAgICAgICByZXMubW9udGhzID0gLXJlcy5tb250aHM7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlcztcbn1cblxuLy8gVE9ETzogcmVtb3ZlICduYW1lJyBhcmcgYWZ0ZXIgZGVwcmVjYXRpb24gaXMgcmVtb3ZlZFxuZnVuY3Rpb24gY3JlYXRlQWRkZXIoZGlyZWN0aW9uLCBuYW1lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh2YWwsIHBlcmlvZCkge1xuICAgICAgICB2YXIgZHVyLCB0bXA7XG4gICAgICAgIC8vaW52ZXJ0IHRoZSBhcmd1bWVudHMsIGJ1dCBjb21wbGFpbiBhYm91dCBpdFxuICAgICAgICBpZiAocGVyaW9kICE9PSBudWxsICYmICFpc05hTigrcGVyaW9kKSkge1xuICAgICAgICAgICAgZGVwcmVjYXRlU2ltcGxlKG5hbWUsICdtb21lbnQoKS4nICsgbmFtZSAgKyAnKHBlcmlvZCwgbnVtYmVyKSBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIG1vbWVudCgpLicgKyBuYW1lICsgJyhudW1iZXIsIHBlcmlvZCkuICcgK1xuICAgICAgICAgICAgJ1NlZSBodHRwOi8vbW9tZW50anMuY29tL2d1aWRlcy8jL3dhcm5pbmdzL2FkZC1pbnZlcnRlZC1wYXJhbS8gZm9yIG1vcmUgaW5mby4nKTtcbiAgICAgICAgICAgIHRtcCA9IHZhbDsgdmFsID0gcGVyaW9kOyBwZXJpb2QgPSB0bXA7XG4gICAgICAgIH1cblxuICAgICAgICB2YWwgPSB0eXBlb2YgdmFsID09PSAnc3RyaW5nJyA/ICt2YWwgOiB2YWw7XG4gICAgICAgIGR1ciA9IGNyZWF0ZUR1cmF0aW9uKHZhbCwgcGVyaW9kKTtcbiAgICAgICAgYWRkU3VidHJhY3QodGhpcywgZHVyLCBkaXJlY3Rpb24pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBhZGRTdWJ0cmFjdCAobW9tLCBkdXJhdGlvbiwgaXNBZGRpbmcsIHVwZGF0ZU9mZnNldCkge1xuICAgIHZhciBtaWxsaXNlY29uZHMgPSBkdXJhdGlvbi5fbWlsbGlzZWNvbmRzLFxuICAgICAgICBkYXlzID0gYWJzUm91bmQoZHVyYXRpb24uX2RheXMpLFxuICAgICAgICBtb250aHMgPSBhYnNSb3VuZChkdXJhdGlvbi5fbW9udGhzKTtcblxuICAgIGlmICghbW9tLmlzVmFsaWQoKSkge1xuICAgICAgICAvLyBObyBvcFxuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdXBkYXRlT2Zmc2V0ID0gdXBkYXRlT2Zmc2V0ID09IG51bGwgPyB0cnVlIDogdXBkYXRlT2Zmc2V0O1xuXG4gICAgaWYgKG1pbGxpc2Vjb25kcykge1xuICAgICAgICBtb20uX2Quc2V0VGltZShtb20uX2QudmFsdWVPZigpICsgbWlsbGlzZWNvbmRzICogaXNBZGRpbmcpO1xuICAgIH1cbiAgICBpZiAoZGF5cykge1xuICAgICAgICBzZXQkMShtb20sICdEYXRlJywgZ2V0KG1vbSwgJ0RhdGUnKSArIGRheXMgKiBpc0FkZGluZyk7XG4gICAgfVxuICAgIGlmIChtb250aHMpIHtcbiAgICAgICAgc2V0TW9udGgobW9tLCBnZXQobW9tLCAnTW9udGgnKSArIG1vbnRocyAqIGlzQWRkaW5nKTtcbiAgICB9XG4gICAgaWYgKHVwZGF0ZU9mZnNldCkge1xuICAgICAgICBob29rcy51cGRhdGVPZmZzZXQobW9tLCBkYXlzIHx8IG1vbnRocyk7XG4gICAgfVxufVxuXG52YXIgYWRkICAgICAgPSBjcmVhdGVBZGRlcigxLCAnYWRkJyk7XG52YXIgc3VidHJhY3QgPSBjcmVhdGVBZGRlcigtMSwgJ3N1YnRyYWN0Jyk7XG5cbmZ1bmN0aW9uIGdldENhbGVuZGFyRm9ybWF0KG15TW9tZW50LCBub3cpIHtcbiAgICB2YXIgZGlmZiA9IG15TW9tZW50LmRpZmYobm93LCAnZGF5cycsIHRydWUpO1xuICAgIHJldHVybiBkaWZmIDwgLTYgPyAnc2FtZUVsc2UnIDpcbiAgICAgICAgICAgIGRpZmYgPCAtMSA/ICdsYXN0V2VlaycgOlxuICAgICAgICAgICAgZGlmZiA8IDAgPyAnbGFzdERheScgOlxuICAgICAgICAgICAgZGlmZiA8IDEgPyAnc2FtZURheScgOlxuICAgICAgICAgICAgZGlmZiA8IDIgPyAnbmV4dERheScgOlxuICAgICAgICAgICAgZGlmZiA8IDcgPyAnbmV4dFdlZWsnIDogJ3NhbWVFbHNlJztcbn1cblxuZnVuY3Rpb24gY2FsZW5kYXIkMSAodGltZSwgZm9ybWF0cykge1xuICAgIC8vIFdlIHdhbnQgdG8gY29tcGFyZSB0aGUgc3RhcnQgb2YgdG9kYXksIHZzIHRoaXMuXG4gICAgLy8gR2V0dGluZyBzdGFydC1vZi10b2RheSBkZXBlbmRzIG9uIHdoZXRoZXIgd2UncmUgbG9jYWwvdXRjL29mZnNldCBvciBub3QuXG4gICAgdmFyIG5vdyA9IHRpbWUgfHwgY3JlYXRlTG9jYWwoKSxcbiAgICAgICAgc29kID0gY2xvbmVXaXRoT2Zmc2V0KG5vdywgdGhpcykuc3RhcnRPZignZGF5JyksXG4gICAgICAgIGZvcm1hdCA9IGhvb2tzLmNhbGVuZGFyRm9ybWF0KHRoaXMsIHNvZCkgfHwgJ3NhbWVFbHNlJztcblxuICAgIHZhciBvdXRwdXQgPSBmb3JtYXRzICYmIChpc0Z1bmN0aW9uKGZvcm1hdHNbZm9ybWF0XSkgPyBmb3JtYXRzW2Zvcm1hdF0uY2FsbCh0aGlzLCBub3cpIDogZm9ybWF0c1tmb3JtYXRdKTtcblxuICAgIHJldHVybiB0aGlzLmZvcm1hdChvdXRwdXQgfHwgdGhpcy5sb2NhbGVEYXRhKCkuY2FsZW5kYXIoZm9ybWF0LCB0aGlzLCBjcmVhdGVMb2NhbChub3cpKSk7XG59XG5cbmZ1bmN0aW9uIGNsb25lICgpIHtcbiAgICByZXR1cm4gbmV3IE1vbWVudCh0aGlzKTtcbn1cblxuZnVuY3Rpb24gaXNBZnRlciAoaW5wdXQsIHVuaXRzKSB7XG4gICAgdmFyIGxvY2FsSW5wdXQgPSBpc01vbWVudChpbnB1dCkgPyBpbnB1dCA6IGNyZWF0ZUxvY2FsKGlucHV0KTtcbiAgICBpZiAoISh0aGlzLmlzVmFsaWQoKSAmJiBsb2NhbElucHV0LmlzVmFsaWQoKSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB1bml0cyA9IG5vcm1hbGl6ZVVuaXRzKCFpc1VuZGVmaW5lZCh1bml0cykgPyB1bml0cyA6ICdtaWxsaXNlY29uZCcpO1xuICAgIGlmICh1bml0cyA9PT0gJ21pbGxpc2Vjb25kJykge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZU9mKCkgPiBsb2NhbElucHV0LnZhbHVlT2YoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gbG9jYWxJbnB1dC52YWx1ZU9mKCkgPCB0aGlzLmNsb25lKCkuc3RhcnRPZih1bml0cykudmFsdWVPZigpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gaXNCZWZvcmUgKGlucHV0LCB1bml0cykge1xuICAgIHZhciBsb2NhbElucHV0ID0gaXNNb21lbnQoaW5wdXQpID8gaW5wdXQgOiBjcmVhdGVMb2NhbChpbnB1dCk7XG4gICAgaWYgKCEodGhpcy5pc1ZhbGlkKCkgJiYgbG9jYWxJbnB1dC5pc1ZhbGlkKCkpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdW5pdHMgPSBub3JtYWxpemVVbml0cyghaXNVbmRlZmluZWQodW5pdHMpID8gdW5pdHMgOiAnbWlsbGlzZWNvbmQnKTtcbiAgICBpZiAodW5pdHMgPT09ICdtaWxsaXNlY29uZCcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVPZigpIDwgbG9jYWxJbnB1dC52YWx1ZU9mKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2xvbmUoKS5lbmRPZih1bml0cykudmFsdWVPZigpIDwgbG9jYWxJbnB1dC52YWx1ZU9mKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBpc0JldHdlZW4gKGZyb20sIHRvLCB1bml0cywgaW5jbHVzaXZpdHkpIHtcbiAgICBpbmNsdXNpdml0eSA9IGluY2x1c2l2aXR5IHx8ICcoKSc7XG4gICAgcmV0dXJuIChpbmNsdXNpdml0eVswXSA9PT0gJygnID8gdGhpcy5pc0FmdGVyKGZyb20sIHVuaXRzKSA6ICF0aGlzLmlzQmVmb3JlKGZyb20sIHVuaXRzKSkgJiZcbiAgICAgICAgKGluY2x1c2l2aXR5WzFdID09PSAnKScgPyB0aGlzLmlzQmVmb3JlKHRvLCB1bml0cykgOiAhdGhpcy5pc0FmdGVyKHRvLCB1bml0cykpO1xufVxuXG5mdW5jdGlvbiBpc1NhbWUgKGlucHV0LCB1bml0cykge1xuICAgIHZhciBsb2NhbElucHV0ID0gaXNNb21lbnQoaW5wdXQpID8gaW5wdXQgOiBjcmVhdGVMb2NhbChpbnB1dCksXG4gICAgICAgIGlucHV0TXM7XG4gICAgaWYgKCEodGhpcy5pc1ZhbGlkKCkgJiYgbG9jYWxJbnB1dC5pc1ZhbGlkKCkpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdW5pdHMgPSBub3JtYWxpemVVbml0cyh1bml0cyB8fCAnbWlsbGlzZWNvbmQnKTtcbiAgICBpZiAodW5pdHMgPT09ICdtaWxsaXNlY29uZCcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVPZigpID09PSBsb2NhbElucHV0LnZhbHVlT2YoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBpbnB1dE1zID0gbG9jYWxJbnB1dC52YWx1ZU9mKCk7XG4gICAgICAgIHJldHVybiB0aGlzLmNsb25lKCkuc3RhcnRPZih1bml0cykudmFsdWVPZigpIDw9IGlucHV0TXMgJiYgaW5wdXRNcyA8PSB0aGlzLmNsb25lKCkuZW5kT2YodW5pdHMpLnZhbHVlT2YoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGlzU2FtZU9yQWZ0ZXIgKGlucHV0LCB1bml0cykge1xuICAgIHJldHVybiB0aGlzLmlzU2FtZShpbnB1dCwgdW5pdHMpIHx8IHRoaXMuaXNBZnRlcihpbnB1dCx1bml0cyk7XG59XG5cbmZ1bmN0aW9uIGlzU2FtZU9yQmVmb3JlIChpbnB1dCwgdW5pdHMpIHtcbiAgICByZXR1cm4gdGhpcy5pc1NhbWUoaW5wdXQsIHVuaXRzKSB8fCB0aGlzLmlzQmVmb3JlKGlucHV0LHVuaXRzKTtcbn1cblxuZnVuY3Rpb24gZGlmZiAoaW5wdXQsIHVuaXRzLCBhc0Zsb2F0KSB7XG4gICAgdmFyIHRoYXQsXG4gICAgICAgIHpvbmVEZWx0YSxcbiAgICAgICAgZGVsdGEsIG91dHB1dDtcblxuICAgIGlmICghdGhpcy5pc1ZhbGlkKCkpIHtcbiAgICAgICAgcmV0dXJuIE5hTjtcbiAgICB9XG5cbiAgICB0aGF0ID0gY2xvbmVXaXRoT2Zmc2V0KGlucHV0LCB0aGlzKTtcblxuICAgIGlmICghdGhhdC5pc1ZhbGlkKCkpIHtcbiAgICAgICAgcmV0dXJuIE5hTjtcbiAgICB9XG5cbiAgICB6b25lRGVsdGEgPSAodGhhdC51dGNPZmZzZXQoKSAtIHRoaXMudXRjT2Zmc2V0KCkpICogNmU0O1xuXG4gICAgdW5pdHMgPSBub3JtYWxpemVVbml0cyh1bml0cyk7XG5cbiAgICBpZiAodW5pdHMgPT09ICd5ZWFyJyB8fCB1bml0cyA9PT0gJ21vbnRoJyB8fCB1bml0cyA9PT0gJ3F1YXJ0ZXInKSB7XG4gICAgICAgIG91dHB1dCA9IG1vbnRoRGlmZih0aGlzLCB0aGF0KTtcbiAgICAgICAgaWYgKHVuaXRzID09PSAncXVhcnRlcicpIHtcbiAgICAgICAgICAgIG91dHB1dCA9IG91dHB1dCAvIDM7XG4gICAgICAgIH0gZWxzZSBpZiAodW5pdHMgPT09ICd5ZWFyJykge1xuICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0IC8gMTI7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBkZWx0YSA9IHRoaXMgLSB0aGF0O1xuICAgICAgICBvdXRwdXQgPSB1bml0cyA9PT0gJ3NlY29uZCcgPyBkZWx0YSAvIDFlMyA6IC8vIDEwMDBcbiAgICAgICAgICAgIHVuaXRzID09PSAnbWludXRlJyA/IGRlbHRhIC8gNmU0IDogLy8gMTAwMCAqIDYwXG4gICAgICAgICAgICB1bml0cyA9PT0gJ2hvdXInID8gZGVsdGEgLyAzNmU1IDogLy8gMTAwMCAqIDYwICogNjBcbiAgICAgICAgICAgIHVuaXRzID09PSAnZGF5JyA/IChkZWx0YSAtIHpvbmVEZWx0YSkgLyA4NjRlNSA6IC8vIDEwMDAgKiA2MCAqIDYwICogMjQsIG5lZ2F0ZSBkc3RcbiAgICAgICAgICAgIHVuaXRzID09PSAnd2VlaycgPyAoZGVsdGEgLSB6b25lRGVsdGEpIC8gNjA0OGU1IDogLy8gMTAwMCAqIDYwICogNjAgKiAyNCAqIDcsIG5lZ2F0ZSBkc3RcbiAgICAgICAgICAgIGRlbHRhO1xuICAgIH1cbiAgICByZXR1cm4gYXNGbG9hdCA/IG91dHB1dCA6IGFic0Zsb29yKG91dHB1dCk7XG59XG5cbmZ1bmN0aW9uIG1vbnRoRGlmZiAoYSwgYikge1xuICAgIC8vIGRpZmZlcmVuY2UgaW4gbW9udGhzXG4gICAgdmFyIHdob2xlTW9udGhEaWZmID0gKChiLnllYXIoKSAtIGEueWVhcigpKSAqIDEyKSArIChiLm1vbnRoKCkgLSBhLm1vbnRoKCkpLFxuICAgICAgICAvLyBiIGlzIGluIChhbmNob3IgLSAxIG1vbnRoLCBhbmNob3IgKyAxIG1vbnRoKVxuICAgICAgICBhbmNob3IgPSBhLmNsb25lKCkuYWRkKHdob2xlTW9udGhEaWZmLCAnbW9udGhzJyksXG4gICAgICAgIGFuY2hvcjIsIGFkanVzdDtcblxuICAgIGlmIChiIC0gYW5jaG9yIDwgMCkge1xuICAgICAgICBhbmNob3IyID0gYS5jbG9uZSgpLmFkZCh3aG9sZU1vbnRoRGlmZiAtIDEsICdtb250aHMnKTtcbiAgICAgICAgLy8gbGluZWFyIGFjcm9zcyB0aGUgbW9udGhcbiAgICAgICAgYWRqdXN0ID0gKGIgLSBhbmNob3IpIC8gKGFuY2hvciAtIGFuY2hvcjIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGFuY2hvcjIgPSBhLmNsb25lKCkuYWRkKHdob2xlTW9udGhEaWZmICsgMSwgJ21vbnRocycpO1xuICAgICAgICAvLyBsaW5lYXIgYWNyb3NzIHRoZSBtb250aFxuICAgICAgICBhZGp1c3QgPSAoYiAtIGFuY2hvcikgLyAoYW5jaG9yMiAtIGFuY2hvcik7XG4gICAgfVxuXG4gICAgLy9jaGVjayBmb3IgbmVnYXRpdmUgemVybywgcmV0dXJuIHplcm8gaWYgbmVnYXRpdmUgemVyb1xuICAgIHJldHVybiAtKHdob2xlTW9udGhEaWZmICsgYWRqdXN0KSB8fCAwO1xufVxuXG5ob29rcy5kZWZhdWx0Rm9ybWF0ID0gJ1lZWVktTU0tRERUSEg6bW06c3NaJztcbmhvb2tzLmRlZmF1bHRGb3JtYXRVdGMgPSAnWVlZWS1NTS1ERFRISDptbTpzc1taXSc7XG5cbmZ1bmN0aW9uIHRvU3RyaW5nICgpIHtcbiAgICByZXR1cm4gdGhpcy5jbG9uZSgpLmxvY2FsZSgnZW4nKS5mb3JtYXQoJ2RkZCBNTU0gREQgWVlZWSBISDptbTpzcyBbR01UXVpaJyk7XG59XG5cbmZ1bmN0aW9uIHRvSVNPU3RyaW5nKCkge1xuICAgIGlmICghdGhpcy5pc1ZhbGlkKCkpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBtID0gdGhpcy5jbG9uZSgpLnV0YygpO1xuICAgIGlmIChtLnllYXIoKSA8IDAgfHwgbS55ZWFyKCkgPiA5OTk5KSB7XG4gICAgICAgIHJldHVybiBmb3JtYXRNb21lbnQobSwgJ1lZWVlZWS1NTS1ERFtUXUhIOm1tOnNzLlNTU1taXScpO1xuICAgIH1cbiAgICBpZiAoaXNGdW5jdGlvbihEYXRlLnByb3RvdHlwZS50b0lTT1N0cmluZykpIHtcbiAgICAgICAgLy8gbmF0aXZlIGltcGxlbWVudGF0aW9uIGlzIH41MHggZmFzdGVyLCB1c2UgaXQgd2hlbiB3ZSBjYW5cbiAgICAgICAgcmV0dXJuIHRoaXMudG9EYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICB9XG4gICAgcmV0dXJuIGZvcm1hdE1vbWVudChtLCAnWVlZWS1NTS1ERFtUXUhIOm1tOnNzLlNTU1taXScpO1xufVxuXG4vKipcbiAqIFJldHVybiBhIGh1bWFuIHJlYWRhYmxlIHJlcHJlc2VudGF0aW9uIG9mIGEgbW9tZW50IHRoYXQgY2FuXG4gKiBhbHNvIGJlIGV2YWx1YXRlZCB0byBnZXQgYSBuZXcgbW9tZW50IHdoaWNoIGlzIHRoZSBzYW1lXG4gKlxuICogQGxpbmsgaHR0cHM6Ly9ub2RlanMub3JnL2Rpc3QvbGF0ZXN0L2RvY3MvYXBpL3V0aWwuaHRtbCN1dGlsX2N1c3RvbV9pbnNwZWN0X2Z1bmN0aW9uX29uX29iamVjdHNcbiAqL1xuZnVuY3Rpb24gaW5zcGVjdCAoKSB7XG4gICAgaWYgKCF0aGlzLmlzVmFsaWQoKSkge1xuICAgICAgICByZXR1cm4gJ21vbWVudC5pbnZhbGlkKC8qICcgKyB0aGlzLl9pICsgJyAqLyknO1xuICAgIH1cbiAgICB2YXIgZnVuYyA9ICdtb21lbnQnO1xuICAgIHZhciB6b25lID0gJyc7XG4gICAgaWYgKCF0aGlzLmlzTG9jYWwoKSkge1xuICAgICAgICBmdW5jID0gdGhpcy51dGNPZmZzZXQoKSA9PT0gMCA/ICdtb21lbnQudXRjJyA6ICdtb21lbnQucGFyc2Vab25lJztcbiAgICAgICAgem9uZSA9ICdaJztcbiAgICB9XG4gICAgdmFyIHByZWZpeCA9ICdbJyArIGZ1bmMgKyAnKFwiXSc7XG4gICAgdmFyIHllYXIgPSAoMCA8PSB0aGlzLnllYXIoKSAmJiB0aGlzLnllYXIoKSA8PSA5OTk5KSA/ICdZWVlZJyA6ICdZWVlZWVknO1xuICAgIHZhciBkYXRldGltZSA9ICctTU0tRERbVF1ISDptbTpzcy5TU1MnO1xuICAgIHZhciBzdWZmaXggPSB6b25lICsgJ1tcIildJztcblxuICAgIHJldHVybiB0aGlzLmZvcm1hdChwcmVmaXggKyB5ZWFyICsgZGF0ZXRpbWUgKyBzdWZmaXgpO1xufVxuXG5mdW5jdGlvbiBmb3JtYXQgKGlucHV0U3RyaW5nKSB7XG4gICAgaWYgKCFpbnB1dFN0cmluZykge1xuICAgICAgICBpbnB1dFN0cmluZyA9IHRoaXMuaXNVdGMoKSA/IGhvb2tzLmRlZmF1bHRGb3JtYXRVdGMgOiBob29rcy5kZWZhdWx0Rm9ybWF0O1xuICAgIH1cbiAgICB2YXIgb3V0cHV0ID0gZm9ybWF0TW9tZW50KHRoaXMsIGlucHV0U3RyaW5nKTtcbiAgICByZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkucG9zdGZvcm1hdChvdXRwdXQpO1xufVxuXG5mdW5jdGlvbiBmcm9tICh0aW1lLCB3aXRob3V0U3VmZml4KSB7XG4gICAgaWYgKHRoaXMuaXNWYWxpZCgpICYmXG4gICAgICAgICAgICAoKGlzTW9tZW50KHRpbWUpICYmIHRpbWUuaXNWYWxpZCgpKSB8fFxuICAgICAgICAgICAgIGNyZWF0ZUxvY2FsKHRpbWUpLmlzVmFsaWQoKSkpIHtcbiAgICAgICAgcmV0dXJuIGNyZWF0ZUR1cmF0aW9uKHt0bzogdGhpcywgZnJvbTogdGltZX0pLmxvY2FsZSh0aGlzLmxvY2FsZSgpKS5odW1hbml6ZSghd2l0aG91dFN1ZmZpeCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLmludmFsaWREYXRlKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBmcm9tTm93ICh3aXRob3V0U3VmZml4KSB7XG4gICAgcmV0dXJuIHRoaXMuZnJvbShjcmVhdGVMb2NhbCgpLCB3aXRob3V0U3VmZml4KTtcbn1cblxuZnVuY3Rpb24gdG8gKHRpbWUsIHdpdGhvdXRTdWZmaXgpIHtcbiAgICBpZiAodGhpcy5pc1ZhbGlkKCkgJiZcbiAgICAgICAgICAgICgoaXNNb21lbnQodGltZSkgJiYgdGltZS5pc1ZhbGlkKCkpIHx8XG4gICAgICAgICAgICAgY3JlYXRlTG9jYWwodGltZSkuaXNWYWxpZCgpKSkge1xuICAgICAgICByZXR1cm4gY3JlYXRlRHVyYXRpb24oe2Zyb206IHRoaXMsIHRvOiB0aW1lfSkubG9jYWxlKHRoaXMubG9jYWxlKCkpLmh1bWFuaXplKCF3aXRob3V0U3VmZml4KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCkuaW52YWxpZERhdGUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHRvTm93ICh3aXRob3V0U3VmZml4KSB7XG4gICAgcmV0dXJuIHRoaXMudG8oY3JlYXRlTG9jYWwoKSwgd2l0aG91dFN1ZmZpeCk7XG59XG5cbi8vIElmIHBhc3NlZCBhIGxvY2FsZSBrZXksIGl0IHdpbGwgc2V0IHRoZSBsb2NhbGUgZm9yIHRoaXNcbi8vIGluc3RhbmNlLiAgT3RoZXJ3aXNlLCBpdCB3aWxsIHJldHVybiB0aGUgbG9jYWxlIGNvbmZpZ3VyYXRpb25cbi8vIHZhcmlhYmxlcyBmb3IgdGhpcyBpbnN0YW5jZS5cbmZ1bmN0aW9uIGxvY2FsZSAoa2V5KSB7XG4gICAgdmFyIG5ld0xvY2FsZURhdGE7XG5cbiAgICBpZiAoa2V5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xvY2FsZS5fYWJicjtcbiAgICB9IGVsc2Uge1xuICAgICAgICBuZXdMb2NhbGVEYXRhID0gZ2V0TG9jYWxlKGtleSk7XG4gICAgICAgIGlmIChuZXdMb2NhbGVEYXRhICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuX2xvY2FsZSA9IG5ld0xvY2FsZURhdGE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxufVxuXG52YXIgbGFuZyA9IGRlcHJlY2F0ZShcbiAgICAnbW9tZW50KCkubGFuZygpIGlzIGRlcHJlY2F0ZWQuIEluc3RlYWQsIHVzZSBtb21lbnQoKS5sb2NhbGVEYXRhKCkgdG8gZ2V0IHRoZSBsYW5ndWFnZSBjb25maWd1cmF0aW9uLiBVc2UgbW9tZW50KCkubG9jYWxlKCkgdG8gY2hhbmdlIGxhbmd1YWdlcy4nLFxuICAgIGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgaWYgKGtleSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGVEYXRhKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGUoa2V5KTtcbiAgICAgICAgfVxuICAgIH1cbik7XG5cbmZ1bmN0aW9uIGxvY2FsZURhdGEgKCkge1xuICAgIHJldHVybiB0aGlzLl9sb2NhbGU7XG59XG5cbmZ1bmN0aW9uIHN0YXJ0T2YgKHVuaXRzKSB7XG4gICAgdW5pdHMgPSBub3JtYWxpemVVbml0cyh1bml0cyk7XG4gICAgLy8gdGhlIGZvbGxvd2luZyBzd2l0Y2ggaW50ZW50aW9uYWxseSBvbWl0cyBicmVhayBrZXl3b3Jkc1xuICAgIC8vIHRvIHV0aWxpemUgZmFsbGluZyB0aHJvdWdoIHRoZSBjYXNlcy5cbiAgICBzd2l0Y2ggKHVuaXRzKSB7XG4gICAgICAgIGNhc2UgJ3llYXInOlxuICAgICAgICAgICAgdGhpcy5tb250aCgwKTtcbiAgICAgICAgICAgIC8qIGZhbGxzIHRocm91Z2ggKi9cbiAgICAgICAgY2FzZSAncXVhcnRlcic6XG4gICAgICAgIGNhc2UgJ21vbnRoJzpcbiAgICAgICAgICAgIHRoaXMuZGF0ZSgxKTtcbiAgICAgICAgICAgIC8qIGZhbGxzIHRocm91Z2ggKi9cbiAgICAgICAgY2FzZSAnd2Vlayc6XG4gICAgICAgIGNhc2UgJ2lzb1dlZWsnOlxuICAgICAgICBjYXNlICdkYXknOlxuICAgICAgICBjYXNlICdkYXRlJzpcbiAgICAgICAgICAgIHRoaXMuaG91cnMoMCk7XG4gICAgICAgICAgICAvKiBmYWxscyB0aHJvdWdoICovXG4gICAgICAgIGNhc2UgJ2hvdXInOlxuICAgICAgICAgICAgdGhpcy5taW51dGVzKDApO1xuICAgICAgICAgICAgLyogZmFsbHMgdGhyb3VnaCAqL1xuICAgICAgICBjYXNlICdtaW51dGUnOlxuICAgICAgICAgICAgdGhpcy5zZWNvbmRzKDApO1xuICAgICAgICAgICAgLyogZmFsbHMgdGhyb3VnaCAqL1xuICAgICAgICBjYXNlICdzZWNvbmQnOlxuICAgICAgICAgICAgdGhpcy5taWxsaXNlY29uZHMoMCk7XG4gICAgfVxuXG4gICAgLy8gd2Vla3MgYXJlIGEgc3BlY2lhbCBjYXNlXG4gICAgaWYgKHVuaXRzID09PSAnd2VlaycpIHtcbiAgICAgICAgdGhpcy53ZWVrZGF5KDApO1xuICAgIH1cbiAgICBpZiAodW5pdHMgPT09ICdpc29XZWVrJykge1xuICAgICAgICB0aGlzLmlzb1dlZWtkYXkoMSk7XG4gICAgfVxuXG4gICAgLy8gcXVhcnRlcnMgYXJlIGFsc28gc3BlY2lhbFxuICAgIGlmICh1bml0cyA9PT0gJ3F1YXJ0ZXInKSB7XG4gICAgICAgIHRoaXMubW9udGgoTWF0aC5mbG9vcih0aGlzLm1vbnRoKCkgLyAzKSAqIDMpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xufVxuXG5mdW5jdGlvbiBlbmRPZiAodW5pdHMpIHtcbiAgICB1bml0cyA9IG5vcm1hbGl6ZVVuaXRzKHVuaXRzKTtcbiAgICBpZiAodW5pdHMgPT09IHVuZGVmaW5lZCB8fCB1bml0cyA9PT0gJ21pbGxpc2Vjb25kJykge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvLyAnZGF0ZScgaXMgYW4gYWxpYXMgZm9yICdkYXknLCBzbyBpdCBzaG91bGQgYmUgY29uc2lkZXJlZCBhcyBzdWNoLlxuICAgIGlmICh1bml0cyA9PT0gJ2RhdGUnKSB7XG4gICAgICAgIHVuaXRzID0gJ2RheSc7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuc3RhcnRPZih1bml0cykuYWRkKDEsICh1bml0cyA9PT0gJ2lzb1dlZWsnID8gJ3dlZWsnIDogdW5pdHMpKS5zdWJ0cmFjdCgxLCAnbXMnKTtcbn1cblxuZnVuY3Rpb24gdmFsdWVPZiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2QudmFsdWVPZigpIC0gKCh0aGlzLl9vZmZzZXQgfHwgMCkgKiA2MDAwMCk7XG59XG5cbmZ1bmN0aW9uIHVuaXggKCkge1xuICAgIHJldHVybiBNYXRoLmZsb29yKHRoaXMudmFsdWVPZigpIC8gMTAwMCk7XG59XG5cbmZ1bmN0aW9uIHRvRGF0ZSAoKSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKHRoaXMudmFsdWVPZigpKTtcbn1cblxuZnVuY3Rpb24gdG9BcnJheSAoKSB7XG4gICAgdmFyIG0gPSB0aGlzO1xuICAgIHJldHVybiBbbS55ZWFyKCksIG0ubW9udGgoKSwgbS5kYXRlKCksIG0uaG91cigpLCBtLm1pbnV0ZSgpLCBtLnNlY29uZCgpLCBtLm1pbGxpc2Vjb25kKCldO1xufVxuXG5mdW5jdGlvbiB0b09iamVjdCAoKSB7XG4gICAgdmFyIG0gPSB0aGlzO1xuICAgIHJldHVybiB7XG4gICAgICAgIHllYXJzOiBtLnllYXIoKSxcbiAgICAgICAgbW9udGhzOiBtLm1vbnRoKCksXG4gICAgICAgIGRhdGU6IG0uZGF0ZSgpLFxuICAgICAgICBob3VyczogbS5ob3VycygpLFxuICAgICAgICBtaW51dGVzOiBtLm1pbnV0ZXMoKSxcbiAgICAgICAgc2Vjb25kczogbS5zZWNvbmRzKCksXG4gICAgICAgIG1pbGxpc2Vjb25kczogbS5taWxsaXNlY29uZHMoKVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIHRvSlNPTiAoKSB7XG4gICAgLy8gbmV3IERhdGUoTmFOKS50b0pTT04oKSA9PT0gbnVsbFxuICAgIHJldHVybiB0aGlzLmlzVmFsaWQoKSA/IHRoaXMudG9JU09TdHJpbmcoKSA6IG51bGw7XG59XG5cbmZ1bmN0aW9uIGlzVmFsaWQkMiAoKSB7XG4gICAgcmV0dXJuIGlzVmFsaWQodGhpcyk7XG59XG5cbmZ1bmN0aW9uIHBhcnNpbmdGbGFncyAoKSB7XG4gICAgcmV0dXJuIGV4dGVuZCh7fSwgZ2V0UGFyc2luZ0ZsYWdzKHRoaXMpKTtcbn1cblxuZnVuY3Rpb24gaW52YWxpZEF0ICgpIHtcbiAgICByZXR1cm4gZ2V0UGFyc2luZ0ZsYWdzKHRoaXMpLm92ZXJmbG93O1xufVxuXG5mdW5jdGlvbiBjcmVhdGlvbkRhdGEoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaW5wdXQ6IHRoaXMuX2ksXG4gICAgICAgIGZvcm1hdDogdGhpcy5fZixcbiAgICAgICAgbG9jYWxlOiB0aGlzLl9sb2NhbGUsXG4gICAgICAgIGlzVVRDOiB0aGlzLl9pc1VUQyxcbiAgICAgICAgc3RyaWN0OiB0aGlzLl9zdHJpY3RcbiAgICB9O1xufVxuXG4vLyBGT1JNQVRUSU5HXG5cbmFkZEZvcm1hdFRva2VuKDAsIFsnZ2cnLCAyXSwgMCwgZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLndlZWtZZWFyKCkgJSAxMDA7XG59KTtcblxuYWRkRm9ybWF0VG9rZW4oMCwgWydHRycsIDJdLCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNvV2Vla1llYXIoKSAlIDEwMDtcbn0pO1xuXG5mdW5jdGlvbiBhZGRXZWVrWWVhckZvcm1hdFRva2VuICh0b2tlbiwgZ2V0dGVyKSB7XG4gICAgYWRkRm9ybWF0VG9rZW4oMCwgW3Rva2VuLCB0b2tlbi5sZW5ndGhdLCAwLCBnZXR0ZXIpO1xufVxuXG5hZGRXZWVrWWVhckZvcm1hdFRva2VuKCdnZ2dnJywgICAgICd3ZWVrWWVhcicpO1xuYWRkV2Vla1llYXJGb3JtYXRUb2tlbignZ2dnZ2cnLCAgICAnd2Vla1llYXInKTtcbmFkZFdlZWtZZWFyRm9ybWF0VG9rZW4oJ0dHR0cnLCAgJ2lzb1dlZWtZZWFyJyk7XG5hZGRXZWVrWWVhckZvcm1hdFRva2VuKCdHR0dHRycsICdpc29XZWVrWWVhcicpO1xuXG4vLyBBTElBU0VTXG5cbmFkZFVuaXRBbGlhcygnd2Vla1llYXInLCAnZ2cnKTtcbmFkZFVuaXRBbGlhcygnaXNvV2Vla1llYXInLCAnR0cnKTtcblxuLy8gUFJJT1JJVFlcblxuYWRkVW5pdFByaW9yaXR5KCd3ZWVrWWVhcicsIDEpO1xuYWRkVW5pdFByaW9yaXR5KCdpc29XZWVrWWVhcicsIDEpO1xuXG5cbi8vIFBBUlNJTkdcblxuYWRkUmVnZXhUb2tlbignRycsICAgICAgbWF0Y2hTaWduZWQpO1xuYWRkUmVnZXhUb2tlbignZycsICAgICAgbWF0Y2hTaWduZWQpO1xuYWRkUmVnZXhUb2tlbignR0cnLCAgICAgbWF0Y2gxdG8yLCBtYXRjaDIpO1xuYWRkUmVnZXhUb2tlbignZ2cnLCAgICAgbWF0Y2gxdG8yLCBtYXRjaDIpO1xuYWRkUmVnZXhUb2tlbignR0dHRycsICAgbWF0Y2gxdG80LCBtYXRjaDQpO1xuYWRkUmVnZXhUb2tlbignZ2dnZycsICAgbWF0Y2gxdG80LCBtYXRjaDQpO1xuYWRkUmVnZXhUb2tlbignR0dHR0cnLCAgbWF0Y2gxdG82LCBtYXRjaDYpO1xuYWRkUmVnZXhUb2tlbignZ2dnZ2cnLCAgbWF0Y2gxdG82LCBtYXRjaDYpO1xuXG5hZGRXZWVrUGFyc2VUb2tlbihbJ2dnZ2cnLCAnZ2dnZ2cnLCAnR0dHRycsICdHR0dHRyddLCBmdW5jdGlvbiAoaW5wdXQsIHdlZWssIGNvbmZpZywgdG9rZW4pIHtcbiAgICB3ZWVrW3Rva2VuLnN1YnN0cigwLCAyKV0gPSB0b0ludChpbnB1dCk7XG59KTtcblxuYWRkV2Vla1BhcnNlVG9rZW4oWydnZycsICdHRyddLCBmdW5jdGlvbiAoaW5wdXQsIHdlZWssIGNvbmZpZywgdG9rZW4pIHtcbiAgICB3ZWVrW3Rva2VuXSA9IGhvb2tzLnBhcnNlVHdvRGlnaXRZZWFyKGlucHV0KTtcbn0pO1xuXG4vLyBNT01FTlRTXG5cbmZ1bmN0aW9uIGdldFNldFdlZWtZZWFyIChpbnB1dCkge1xuICAgIHJldHVybiBnZXRTZXRXZWVrWWVhckhlbHBlci5jYWxsKHRoaXMsXG4gICAgICAgICAgICBpbnB1dCxcbiAgICAgICAgICAgIHRoaXMud2VlaygpLFxuICAgICAgICAgICAgdGhpcy53ZWVrZGF5KCksXG4gICAgICAgICAgICB0aGlzLmxvY2FsZURhdGEoKS5fd2Vlay5kb3csXG4gICAgICAgICAgICB0aGlzLmxvY2FsZURhdGEoKS5fd2Vlay5kb3kpO1xufVxuXG5mdW5jdGlvbiBnZXRTZXRJU09XZWVrWWVhciAoaW5wdXQpIHtcbiAgICByZXR1cm4gZ2V0U2V0V2Vla1llYXJIZWxwZXIuY2FsbCh0aGlzLFxuICAgICAgICAgICAgaW5wdXQsIHRoaXMuaXNvV2VlaygpLCB0aGlzLmlzb1dlZWtkYXkoKSwgMSwgNCk7XG59XG5cbmZ1bmN0aW9uIGdldElTT1dlZWtzSW5ZZWFyICgpIHtcbiAgICByZXR1cm4gd2Vla3NJblllYXIodGhpcy55ZWFyKCksIDEsIDQpO1xufVxuXG5mdW5jdGlvbiBnZXRXZWVrc0luWWVhciAoKSB7XG4gICAgdmFyIHdlZWtJbmZvID0gdGhpcy5sb2NhbGVEYXRhKCkuX3dlZWs7XG4gICAgcmV0dXJuIHdlZWtzSW5ZZWFyKHRoaXMueWVhcigpLCB3ZWVrSW5mby5kb3csIHdlZWtJbmZvLmRveSk7XG59XG5cbmZ1bmN0aW9uIGdldFNldFdlZWtZZWFySGVscGVyKGlucHV0LCB3ZWVrLCB3ZWVrZGF5LCBkb3csIGRveSkge1xuICAgIHZhciB3ZWVrc1RhcmdldDtcbiAgICBpZiAoaW5wdXQgPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gd2Vla09mWWVhcih0aGlzLCBkb3csIGRveSkueWVhcjtcbiAgICB9IGVsc2Uge1xuICAgICAgICB3ZWVrc1RhcmdldCA9IHdlZWtzSW5ZZWFyKGlucHV0LCBkb3csIGRveSk7XG4gICAgICAgIGlmICh3ZWVrID4gd2Vla3NUYXJnZXQpIHtcbiAgICAgICAgICAgIHdlZWsgPSB3ZWVrc1RhcmdldDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2V0V2Vla0FsbC5jYWxsKHRoaXMsIGlucHV0LCB3ZWVrLCB3ZWVrZGF5LCBkb3csIGRveSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBzZXRXZWVrQWxsKHdlZWtZZWFyLCB3ZWVrLCB3ZWVrZGF5LCBkb3csIGRveSkge1xuICAgIHZhciBkYXlPZlllYXJEYXRhID0gZGF5T2ZZZWFyRnJvbVdlZWtzKHdlZWtZZWFyLCB3ZWVrLCB3ZWVrZGF5LCBkb3csIGRveSksXG4gICAgICAgIGRhdGUgPSBjcmVhdGVVVENEYXRlKGRheU9mWWVhckRhdGEueWVhciwgMCwgZGF5T2ZZZWFyRGF0YS5kYXlPZlllYXIpO1xuXG4gICAgdGhpcy55ZWFyKGRhdGUuZ2V0VVRDRnVsbFllYXIoKSk7XG4gICAgdGhpcy5tb250aChkYXRlLmdldFVUQ01vbnRoKCkpO1xuICAgIHRoaXMuZGF0ZShkYXRlLmdldFVUQ0RhdGUoKSk7XG4gICAgcmV0dXJuIHRoaXM7XG59XG5cbi8vIEZPUk1BVFRJTkdcblxuYWRkRm9ybWF0VG9rZW4oJ1EnLCAwLCAnUW8nLCAncXVhcnRlcicpO1xuXG4vLyBBTElBU0VTXG5cbmFkZFVuaXRBbGlhcygncXVhcnRlcicsICdRJyk7XG5cbi8vIFBSSU9SSVRZXG5cbmFkZFVuaXRQcmlvcml0eSgncXVhcnRlcicsIDcpO1xuXG4vLyBQQVJTSU5HXG5cbmFkZFJlZ2V4VG9rZW4oJ1EnLCBtYXRjaDEpO1xuYWRkUGFyc2VUb2tlbignUScsIGZ1bmN0aW9uIChpbnB1dCwgYXJyYXkpIHtcbiAgICBhcnJheVtNT05USF0gPSAodG9JbnQoaW5wdXQpIC0gMSkgKiAzO1xufSk7XG5cbi8vIE1PTUVOVFNcblxuZnVuY3Rpb24gZ2V0U2V0UXVhcnRlciAoaW5wdXQpIHtcbiAgICByZXR1cm4gaW5wdXQgPT0gbnVsbCA/IE1hdGguY2VpbCgodGhpcy5tb250aCgpICsgMSkgLyAzKSA6IHRoaXMubW9udGgoKGlucHV0IC0gMSkgKiAzICsgdGhpcy5tb250aCgpICUgMyk7XG59XG5cbi8vIEZPUk1BVFRJTkdcblxuYWRkRm9ybWF0VG9rZW4oJ0QnLCBbJ0REJywgMl0sICdEbycsICdkYXRlJyk7XG5cbi8vIEFMSUFTRVNcblxuYWRkVW5pdEFsaWFzKCdkYXRlJywgJ0QnKTtcblxuLy8gUFJJT1JPSVRZXG5hZGRVbml0UHJpb3JpdHkoJ2RhdGUnLCA5KTtcblxuLy8gUEFSU0lOR1xuXG5hZGRSZWdleFRva2VuKCdEJywgIG1hdGNoMXRvMik7XG5hZGRSZWdleFRva2VuKCdERCcsIG1hdGNoMXRvMiwgbWF0Y2gyKTtcbmFkZFJlZ2V4VG9rZW4oJ0RvJywgZnVuY3Rpb24gKGlzU3RyaWN0LCBsb2NhbGUpIHtcbiAgICAvLyBUT0RPOiBSZW1vdmUgXCJvcmRpbmFsUGFyc2VcIiBmYWxsYmFjayBpbiBuZXh0IG1ham9yIHJlbGVhc2UuXG4gICAgcmV0dXJuIGlzU3RyaWN0ID9cbiAgICAgIChsb2NhbGUuX2RheU9mTW9udGhPcmRpbmFsUGFyc2UgfHwgbG9jYWxlLl9vcmRpbmFsUGFyc2UpIDpcbiAgICAgIGxvY2FsZS5fZGF5T2ZNb250aE9yZGluYWxQYXJzZUxlbmllbnQ7XG59KTtcblxuYWRkUGFyc2VUb2tlbihbJ0QnLCAnREQnXSwgREFURSk7XG5hZGRQYXJzZVRva2VuKCdEbycsIGZ1bmN0aW9uIChpbnB1dCwgYXJyYXkpIHtcbiAgICBhcnJheVtEQVRFXSA9IHRvSW50KGlucHV0Lm1hdGNoKG1hdGNoMXRvMilbMF0sIDEwKTtcbn0pO1xuXG4vLyBNT01FTlRTXG5cbnZhciBnZXRTZXREYXlPZk1vbnRoID0gbWFrZUdldFNldCgnRGF0ZScsIHRydWUpO1xuXG4vLyBGT1JNQVRUSU5HXG5cbmFkZEZvcm1hdFRva2VuKCdEREQnLCBbJ0REREQnLCAzXSwgJ0RERG8nLCAnZGF5T2ZZZWFyJyk7XG5cbi8vIEFMSUFTRVNcblxuYWRkVW5pdEFsaWFzKCdkYXlPZlllYXInLCAnREREJyk7XG5cbi8vIFBSSU9SSVRZXG5hZGRVbml0UHJpb3JpdHkoJ2RheU9mWWVhcicsIDQpO1xuXG4vLyBQQVJTSU5HXG5cbmFkZFJlZ2V4VG9rZW4oJ0RERCcsICBtYXRjaDF0bzMpO1xuYWRkUmVnZXhUb2tlbignRERERCcsIG1hdGNoMyk7XG5hZGRQYXJzZVRva2VuKFsnREREJywgJ0REREQnXSwgZnVuY3Rpb24gKGlucHV0LCBhcnJheSwgY29uZmlnKSB7XG4gICAgY29uZmlnLl9kYXlPZlllYXIgPSB0b0ludChpbnB1dCk7XG59KTtcblxuLy8gSEVMUEVSU1xuXG4vLyBNT01FTlRTXG5cbmZ1bmN0aW9uIGdldFNldERheU9mWWVhciAoaW5wdXQpIHtcbiAgICB2YXIgZGF5T2ZZZWFyID0gTWF0aC5yb3VuZCgodGhpcy5jbG9uZSgpLnN0YXJ0T2YoJ2RheScpIC0gdGhpcy5jbG9uZSgpLnN0YXJ0T2YoJ3llYXInKSkgLyA4NjRlNSkgKyAxO1xuICAgIHJldHVybiBpbnB1dCA9PSBudWxsID8gZGF5T2ZZZWFyIDogdGhpcy5hZGQoKGlucHV0IC0gZGF5T2ZZZWFyKSwgJ2QnKTtcbn1cblxuLy8gRk9STUFUVElOR1xuXG5hZGRGb3JtYXRUb2tlbignbScsIFsnbW0nLCAyXSwgMCwgJ21pbnV0ZScpO1xuXG4vLyBBTElBU0VTXG5cbmFkZFVuaXRBbGlhcygnbWludXRlJywgJ20nKTtcblxuLy8gUFJJT1JJVFlcblxuYWRkVW5pdFByaW9yaXR5KCdtaW51dGUnLCAxNCk7XG5cbi8vIFBBUlNJTkdcblxuYWRkUmVnZXhUb2tlbignbScsICBtYXRjaDF0bzIpO1xuYWRkUmVnZXhUb2tlbignbW0nLCBtYXRjaDF0bzIsIG1hdGNoMik7XG5hZGRQYXJzZVRva2VuKFsnbScsICdtbSddLCBNSU5VVEUpO1xuXG4vLyBNT01FTlRTXG5cbnZhciBnZXRTZXRNaW51dGUgPSBtYWtlR2V0U2V0KCdNaW51dGVzJywgZmFsc2UpO1xuXG4vLyBGT1JNQVRUSU5HXG5cbmFkZEZvcm1hdFRva2VuKCdzJywgWydzcycsIDJdLCAwLCAnc2Vjb25kJyk7XG5cbi8vIEFMSUFTRVNcblxuYWRkVW5pdEFsaWFzKCdzZWNvbmQnLCAncycpO1xuXG4vLyBQUklPUklUWVxuXG5hZGRVbml0UHJpb3JpdHkoJ3NlY29uZCcsIDE1KTtcblxuLy8gUEFSU0lOR1xuXG5hZGRSZWdleFRva2VuKCdzJywgIG1hdGNoMXRvMik7XG5hZGRSZWdleFRva2VuKCdzcycsIG1hdGNoMXRvMiwgbWF0Y2gyKTtcbmFkZFBhcnNlVG9rZW4oWydzJywgJ3NzJ10sIFNFQ09ORCk7XG5cbi8vIE1PTUVOVFNcblxudmFyIGdldFNldFNlY29uZCA9IG1ha2VHZXRTZXQoJ1NlY29uZHMnLCBmYWxzZSk7XG5cbi8vIEZPUk1BVFRJTkdcblxuYWRkRm9ybWF0VG9rZW4oJ1MnLCAwLCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIH5+KHRoaXMubWlsbGlzZWNvbmQoKSAvIDEwMCk7XG59KTtcblxuYWRkRm9ybWF0VG9rZW4oMCwgWydTUycsIDJdLCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIH5+KHRoaXMubWlsbGlzZWNvbmQoKSAvIDEwKTtcbn0pO1xuXG5hZGRGb3JtYXRUb2tlbigwLCBbJ1NTUycsIDNdLCAwLCAnbWlsbGlzZWNvbmQnKTtcbmFkZEZvcm1hdFRva2VuKDAsIFsnU1NTUycsIDRdLCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMubWlsbGlzZWNvbmQoKSAqIDEwO1xufSk7XG5hZGRGb3JtYXRUb2tlbigwLCBbJ1NTU1NTJywgNV0sIDAsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5taWxsaXNlY29uZCgpICogMTAwO1xufSk7XG5hZGRGb3JtYXRUb2tlbigwLCBbJ1NTU1NTUycsIDZdLCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMubWlsbGlzZWNvbmQoKSAqIDEwMDA7XG59KTtcbmFkZEZvcm1hdFRva2VuKDAsIFsnU1NTU1NTUycsIDddLCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMubWlsbGlzZWNvbmQoKSAqIDEwMDAwO1xufSk7XG5hZGRGb3JtYXRUb2tlbigwLCBbJ1NTU1NTU1NTJywgOF0sIDAsIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5taWxsaXNlY29uZCgpICogMTAwMDAwO1xufSk7XG5hZGRGb3JtYXRUb2tlbigwLCBbJ1NTU1NTU1NTUycsIDldLCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMubWlsbGlzZWNvbmQoKSAqIDEwMDAwMDA7XG59KTtcblxuXG4vLyBBTElBU0VTXG5cbmFkZFVuaXRBbGlhcygnbWlsbGlzZWNvbmQnLCAnbXMnKTtcblxuLy8gUFJJT1JJVFlcblxuYWRkVW5pdFByaW9yaXR5KCdtaWxsaXNlY29uZCcsIDE2KTtcblxuLy8gUEFSU0lOR1xuXG5hZGRSZWdleFRva2VuKCdTJywgICAgbWF0Y2gxdG8zLCBtYXRjaDEpO1xuYWRkUmVnZXhUb2tlbignU1MnLCAgIG1hdGNoMXRvMywgbWF0Y2gyKTtcbmFkZFJlZ2V4VG9rZW4oJ1NTUycsICBtYXRjaDF0bzMsIG1hdGNoMyk7XG5cbnZhciB0b2tlbjtcbmZvciAodG9rZW4gPSAnU1NTUyc7IHRva2VuLmxlbmd0aCA8PSA5OyB0b2tlbiArPSAnUycpIHtcbiAgICBhZGRSZWdleFRva2VuKHRva2VuLCBtYXRjaFVuc2lnbmVkKTtcbn1cblxuZnVuY3Rpb24gcGFyc2VNcyhpbnB1dCwgYXJyYXkpIHtcbiAgICBhcnJheVtNSUxMSVNFQ09ORF0gPSB0b0ludCgoJzAuJyArIGlucHV0KSAqIDEwMDApO1xufVxuXG5mb3IgKHRva2VuID0gJ1MnOyB0b2tlbi5sZW5ndGggPD0gOTsgdG9rZW4gKz0gJ1MnKSB7XG4gICAgYWRkUGFyc2VUb2tlbih0b2tlbiwgcGFyc2VNcyk7XG59XG4vLyBNT01FTlRTXG5cbnZhciBnZXRTZXRNaWxsaXNlY29uZCA9IG1ha2VHZXRTZXQoJ01pbGxpc2Vjb25kcycsIGZhbHNlKTtcblxuLy8gRk9STUFUVElOR1xuXG5hZGRGb3JtYXRUb2tlbigneicsICAwLCAwLCAnem9uZUFiYnInKTtcbmFkZEZvcm1hdFRva2VuKCd6eicsIDAsIDAsICd6b25lTmFtZScpO1xuXG4vLyBNT01FTlRTXG5cbmZ1bmN0aW9uIGdldFpvbmVBYmJyICgpIHtcbiAgICByZXR1cm4gdGhpcy5faXNVVEMgPyAnVVRDJyA6ICcnO1xufVxuXG5mdW5jdGlvbiBnZXRab25lTmFtZSAoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lzVVRDID8gJ0Nvb3JkaW5hdGVkIFVuaXZlcnNhbCBUaW1lJyA6ICcnO1xufVxuXG52YXIgcHJvdG8gPSBNb21lbnQucHJvdG90eXBlO1xuXG5wcm90by5hZGQgICAgICAgICAgICAgICA9IGFkZDtcbnByb3RvLmNhbGVuZGFyICAgICAgICAgID0gY2FsZW5kYXIkMTtcbnByb3RvLmNsb25lICAgICAgICAgICAgID0gY2xvbmU7XG5wcm90by5kaWZmICAgICAgICAgICAgICA9IGRpZmY7XG5wcm90by5lbmRPZiAgICAgICAgICAgICA9IGVuZE9mO1xucHJvdG8uZm9ybWF0ICAgICAgICAgICAgPSBmb3JtYXQ7XG5wcm90by5mcm9tICAgICAgICAgICAgICA9IGZyb207XG5wcm90by5mcm9tTm93ICAgICAgICAgICA9IGZyb21Ob3c7XG5wcm90by50byAgICAgICAgICAgICAgICA9IHRvO1xucHJvdG8udG9Ob3cgICAgICAgICAgICAgPSB0b05vdztcbnByb3RvLmdldCAgICAgICAgICAgICAgID0gc3RyaW5nR2V0O1xucHJvdG8uaW52YWxpZEF0ICAgICAgICAgPSBpbnZhbGlkQXQ7XG5wcm90by5pc0FmdGVyICAgICAgICAgICA9IGlzQWZ0ZXI7XG5wcm90by5pc0JlZm9yZSAgICAgICAgICA9IGlzQmVmb3JlO1xucHJvdG8uaXNCZXR3ZWVuICAgICAgICAgPSBpc0JldHdlZW47XG5wcm90by5pc1NhbWUgICAgICAgICAgICA9IGlzU2FtZTtcbnByb3RvLmlzU2FtZU9yQWZ0ZXIgICAgID0gaXNTYW1lT3JBZnRlcjtcbnByb3RvLmlzU2FtZU9yQmVmb3JlICAgID0gaXNTYW1lT3JCZWZvcmU7XG5wcm90by5pc1ZhbGlkICAgICAgICAgICA9IGlzVmFsaWQkMjtcbnByb3RvLmxhbmcgICAgICAgICAgICAgID0gbGFuZztcbnByb3RvLmxvY2FsZSAgICAgICAgICAgID0gbG9jYWxlO1xucHJvdG8ubG9jYWxlRGF0YSAgICAgICAgPSBsb2NhbGVEYXRhO1xucHJvdG8ubWF4ICAgICAgICAgICAgICAgPSBwcm90b3R5cGVNYXg7XG5wcm90by5taW4gICAgICAgICAgICAgICA9IHByb3RvdHlwZU1pbjtcbnByb3RvLnBhcnNpbmdGbGFncyAgICAgID0gcGFyc2luZ0ZsYWdzO1xucHJvdG8uc2V0ICAgICAgICAgICAgICAgPSBzdHJpbmdTZXQ7XG5wcm90by5zdGFydE9mICAgICAgICAgICA9IHN0YXJ0T2Y7XG5wcm90by5zdWJ0cmFjdCAgICAgICAgICA9IHN1YnRyYWN0O1xucHJvdG8udG9BcnJheSAgICAgICAgICAgPSB0b0FycmF5O1xucHJvdG8udG9PYmplY3QgICAgICAgICAgPSB0b09iamVjdDtcbnByb3RvLnRvRGF0ZSAgICAgICAgICAgID0gdG9EYXRlO1xucHJvdG8udG9JU09TdHJpbmcgICAgICAgPSB0b0lTT1N0cmluZztcbnByb3RvLmluc3BlY3QgICAgICAgICAgID0gaW5zcGVjdDtcbnByb3RvLnRvSlNPTiAgICAgICAgICAgID0gdG9KU09OO1xucHJvdG8udG9TdHJpbmcgICAgICAgICAgPSB0b1N0cmluZztcbnByb3RvLnVuaXggICAgICAgICAgICAgID0gdW5peDtcbnByb3RvLnZhbHVlT2YgICAgICAgICAgID0gdmFsdWVPZjtcbnByb3RvLmNyZWF0aW9uRGF0YSAgICAgID0gY3JlYXRpb25EYXRhO1xuXG4vLyBZZWFyXG5wcm90by55ZWFyICAgICAgID0gZ2V0U2V0WWVhcjtcbnByb3RvLmlzTGVhcFllYXIgPSBnZXRJc0xlYXBZZWFyO1xuXG4vLyBXZWVrIFllYXJcbnByb3RvLndlZWtZZWFyICAgID0gZ2V0U2V0V2Vla1llYXI7XG5wcm90by5pc29XZWVrWWVhciA9IGdldFNldElTT1dlZWtZZWFyO1xuXG4vLyBRdWFydGVyXG5wcm90by5xdWFydGVyID0gcHJvdG8ucXVhcnRlcnMgPSBnZXRTZXRRdWFydGVyO1xuXG4vLyBNb250aFxucHJvdG8ubW9udGggICAgICAgPSBnZXRTZXRNb250aDtcbnByb3RvLmRheXNJbk1vbnRoID0gZ2V0RGF5c0luTW9udGg7XG5cbi8vIFdlZWtcbnByb3RvLndlZWsgICAgICAgICAgID0gcHJvdG8ud2Vla3MgICAgICAgID0gZ2V0U2V0V2VlaztcbnByb3RvLmlzb1dlZWsgICAgICAgID0gcHJvdG8uaXNvV2Vla3MgICAgID0gZ2V0U2V0SVNPV2VlaztcbnByb3RvLndlZWtzSW5ZZWFyICAgID0gZ2V0V2Vla3NJblllYXI7XG5wcm90by5pc29XZWVrc0luWWVhciA9IGdldElTT1dlZWtzSW5ZZWFyO1xuXG4vLyBEYXlcbnByb3RvLmRhdGUgICAgICAgPSBnZXRTZXREYXlPZk1vbnRoO1xucHJvdG8uZGF5ICAgICAgICA9IHByb3RvLmRheXMgICAgICAgICAgICAgPSBnZXRTZXREYXlPZldlZWs7XG5wcm90by53ZWVrZGF5ICAgID0gZ2V0U2V0TG9jYWxlRGF5T2ZXZWVrO1xucHJvdG8uaXNvV2Vla2RheSA9IGdldFNldElTT0RheU9mV2VlaztcbnByb3RvLmRheU9mWWVhciAgPSBnZXRTZXREYXlPZlllYXI7XG5cbi8vIEhvdXJcbnByb3RvLmhvdXIgPSBwcm90by5ob3VycyA9IGdldFNldEhvdXI7XG5cbi8vIE1pbnV0ZVxucHJvdG8ubWludXRlID0gcHJvdG8ubWludXRlcyA9IGdldFNldE1pbnV0ZTtcblxuLy8gU2Vjb25kXG5wcm90by5zZWNvbmQgPSBwcm90by5zZWNvbmRzID0gZ2V0U2V0U2Vjb25kO1xuXG4vLyBNaWxsaXNlY29uZFxucHJvdG8ubWlsbGlzZWNvbmQgPSBwcm90by5taWxsaXNlY29uZHMgPSBnZXRTZXRNaWxsaXNlY29uZDtcblxuLy8gT2Zmc2V0XG5wcm90by51dGNPZmZzZXQgICAgICAgICAgICA9IGdldFNldE9mZnNldDtcbnByb3RvLnV0YyAgICAgICAgICAgICAgICAgID0gc2V0T2Zmc2V0VG9VVEM7XG5wcm90by5sb2NhbCAgICAgICAgICAgICAgICA9IHNldE9mZnNldFRvTG9jYWw7XG5wcm90by5wYXJzZVpvbmUgICAgICAgICAgICA9IHNldE9mZnNldFRvUGFyc2VkT2Zmc2V0O1xucHJvdG8uaGFzQWxpZ25lZEhvdXJPZmZzZXQgPSBoYXNBbGlnbmVkSG91ck9mZnNldDtcbnByb3RvLmlzRFNUICAgICAgICAgICAgICAgID0gaXNEYXlsaWdodFNhdmluZ1RpbWU7XG5wcm90by5pc0xvY2FsICAgICAgICAgICAgICA9IGlzTG9jYWw7XG5wcm90by5pc1V0Y09mZnNldCAgICAgICAgICA9IGlzVXRjT2Zmc2V0O1xucHJvdG8uaXNVdGMgICAgICAgICAgICAgICAgPSBpc1V0YztcbnByb3RvLmlzVVRDICAgICAgICAgICAgICAgID0gaXNVdGM7XG5cbi8vIFRpbWV6b25lXG5wcm90by56b25lQWJiciA9IGdldFpvbmVBYmJyO1xucHJvdG8uem9uZU5hbWUgPSBnZXRab25lTmFtZTtcblxuLy8gRGVwcmVjYXRpb25zXG5wcm90by5kYXRlcyAgPSBkZXByZWNhdGUoJ2RhdGVzIGFjY2Vzc29yIGlzIGRlcHJlY2F0ZWQuIFVzZSBkYXRlIGluc3RlYWQuJywgZ2V0U2V0RGF5T2ZNb250aCk7XG5wcm90by5tb250aHMgPSBkZXByZWNhdGUoJ21vbnRocyBhY2Nlc3NvciBpcyBkZXByZWNhdGVkLiBVc2UgbW9udGggaW5zdGVhZCcsIGdldFNldE1vbnRoKTtcbnByb3RvLnllYXJzICA9IGRlcHJlY2F0ZSgneWVhcnMgYWNjZXNzb3IgaXMgZGVwcmVjYXRlZC4gVXNlIHllYXIgaW5zdGVhZCcsIGdldFNldFllYXIpO1xucHJvdG8uem9uZSAgID0gZGVwcmVjYXRlKCdtb21lbnQoKS56b25lIGlzIGRlcHJlY2F0ZWQsIHVzZSBtb21lbnQoKS51dGNPZmZzZXQgaW5zdGVhZC4gaHR0cDovL21vbWVudGpzLmNvbS9ndWlkZXMvIy93YXJuaW5ncy96b25lLycsIGdldFNldFpvbmUpO1xucHJvdG8uaXNEU1RTaGlmdGVkID0gZGVwcmVjYXRlKCdpc0RTVFNoaWZ0ZWQgaXMgZGVwcmVjYXRlZC4gU2VlIGh0dHA6Ly9tb21lbnRqcy5jb20vZ3VpZGVzLyMvd2FybmluZ3MvZHN0LXNoaWZ0ZWQvIGZvciBtb3JlIGluZm9ybWF0aW9uJywgaXNEYXlsaWdodFNhdmluZ1RpbWVTaGlmdGVkKTtcblxuZnVuY3Rpb24gY3JlYXRlVW5peCAoaW5wdXQpIHtcbiAgICByZXR1cm4gY3JlYXRlTG9jYWwoaW5wdXQgKiAxMDAwKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlSW5ab25lICgpIHtcbiAgICByZXR1cm4gY3JlYXRlTG9jYWwuYXBwbHkobnVsbCwgYXJndW1lbnRzKS5wYXJzZVpvbmUoKTtcbn1cblxuZnVuY3Rpb24gcHJlUGFyc2VQb3N0Rm9ybWF0IChzdHJpbmcpIHtcbiAgICByZXR1cm4gc3RyaW5nO1xufVxuXG52YXIgcHJvdG8kMSA9IExvY2FsZS5wcm90b3R5cGU7XG5cbnByb3RvJDEuY2FsZW5kYXIgICAgICAgID0gY2FsZW5kYXI7XG5wcm90byQxLmxvbmdEYXRlRm9ybWF0ICA9IGxvbmdEYXRlRm9ybWF0O1xucHJvdG8kMS5pbnZhbGlkRGF0ZSAgICAgPSBpbnZhbGlkRGF0ZTtcbnByb3RvJDEub3JkaW5hbCAgICAgICAgID0gb3JkaW5hbDtcbnByb3RvJDEucHJlcGFyc2UgICAgICAgID0gcHJlUGFyc2VQb3N0Rm9ybWF0O1xucHJvdG8kMS5wb3N0Zm9ybWF0ICAgICAgPSBwcmVQYXJzZVBvc3RGb3JtYXQ7XG5wcm90byQxLnJlbGF0aXZlVGltZSAgICA9IHJlbGF0aXZlVGltZTtcbnByb3RvJDEucGFzdEZ1dHVyZSAgICAgID0gcGFzdEZ1dHVyZTtcbnByb3RvJDEuc2V0ICAgICAgICAgICAgID0gc2V0O1xuXG4vLyBNb250aFxucHJvdG8kMS5tb250aHMgICAgICAgICAgICA9ICAgICAgICBsb2NhbGVNb250aHM7XG5wcm90byQxLm1vbnRoc1Nob3J0ICAgICAgID0gICAgICAgIGxvY2FsZU1vbnRoc1Nob3J0O1xucHJvdG8kMS5tb250aHNQYXJzZSAgICAgICA9ICAgICAgICBsb2NhbGVNb250aHNQYXJzZTtcbnByb3RvJDEubW9udGhzUmVnZXggICAgICAgPSBtb250aHNSZWdleDtcbnByb3RvJDEubW9udGhzU2hvcnRSZWdleCAgPSBtb250aHNTaG9ydFJlZ2V4O1xuXG4vLyBXZWVrXG5wcm90byQxLndlZWsgPSBsb2NhbGVXZWVrO1xucHJvdG8kMS5maXJzdERheU9mWWVhciA9IGxvY2FsZUZpcnN0RGF5T2ZZZWFyO1xucHJvdG8kMS5maXJzdERheU9mV2VlayA9IGxvY2FsZUZpcnN0RGF5T2ZXZWVrO1xuXG4vLyBEYXkgb2YgV2Vla1xucHJvdG8kMS53ZWVrZGF5cyAgICAgICA9ICAgICAgICBsb2NhbGVXZWVrZGF5cztcbnByb3RvJDEud2Vla2RheXNNaW4gICAgPSAgICAgICAgbG9jYWxlV2Vla2RheXNNaW47XG5wcm90byQxLndlZWtkYXlzU2hvcnQgID0gICAgICAgIGxvY2FsZVdlZWtkYXlzU2hvcnQ7XG5wcm90byQxLndlZWtkYXlzUGFyc2UgID0gICAgICAgIGxvY2FsZVdlZWtkYXlzUGFyc2U7XG5cbnByb3RvJDEud2Vla2RheXNSZWdleCAgICAgICA9ICAgICAgICB3ZWVrZGF5c1JlZ2V4O1xucHJvdG8kMS53ZWVrZGF5c1Nob3J0UmVnZXggID0gICAgICAgIHdlZWtkYXlzU2hvcnRSZWdleDtcbnByb3RvJDEud2Vla2RheXNNaW5SZWdleCAgICA9ICAgICAgICB3ZWVrZGF5c01pblJlZ2V4O1xuXG4vLyBIb3Vyc1xucHJvdG8kMS5pc1BNID0gbG9jYWxlSXNQTTtcbnByb3RvJDEubWVyaWRpZW0gPSBsb2NhbGVNZXJpZGllbTtcblxuZnVuY3Rpb24gZ2V0JDEgKGZvcm1hdCwgaW5kZXgsIGZpZWxkLCBzZXR0ZXIpIHtcbiAgICB2YXIgbG9jYWxlID0gZ2V0TG9jYWxlKCk7XG4gICAgdmFyIHV0YyA9IGNyZWF0ZVVUQygpLnNldChzZXR0ZXIsIGluZGV4KTtcbiAgICByZXR1cm4gbG9jYWxlW2ZpZWxkXSh1dGMsIGZvcm1hdCk7XG59XG5cbmZ1bmN0aW9uIGxpc3RNb250aHNJbXBsIChmb3JtYXQsIGluZGV4LCBmaWVsZCkge1xuICAgIGlmIChpc051bWJlcihmb3JtYXQpKSB7XG4gICAgICAgIGluZGV4ID0gZm9ybWF0O1xuICAgICAgICBmb3JtYXQgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgZm9ybWF0ID0gZm9ybWF0IHx8ICcnO1xuXG4gICAgaWYgKGluZGV4ICE9IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGdldCQxKGZvcm1hdCwgaW5kZXgsIGZpZWxkLCAnbW9udGgnKTtcbiAgICB9XG5cbiAgICB2YXIgaTtcbiAgICB2YXIgb3V0ID0gW107XG4gICAgZm9yIChpID0gMDsgaSA8IDEyOyBpKyspIHtcbiAgICAgICAgb3V0W2ldID0gZ2V0JDEoZm9ybWF0LCBpLCBmaWVsZCwgJ21vbnRoJyk7XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59XG5cbi8vICgpXG4vLyAoNSlcbi8vIChmbXQsIDUpXG4vLyAoZm10KVxuLy8gKHRydWUpXG4vLyAodHJ1ZSwgNSlcbi8vICh0cnVlLCBmbXQsIDUpXG4vLyAodHJ1ZSwgZm10KVxuZnVuY3Rpb24gbGlzdFdlZWtkYXlzSW1wbCAobG9jYWxlU29ydGVkLCBmb3JtYXQsIGluZGV4LCBmaWVsZCkge1xuICAgIGlmICh0eXBlb2YgbG9jYWxlU29ydGVkID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgaWYgKGlzTnVtYmVyKGZvcm1hdCkpIHtcbiAgICAgICAgICAgIGluZGV4ID0gZm9ybWF0O1xuICAgICAgICAgICAgZm9ybWF0ID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9ybWF0ID0gZm9ybWF0IHx8ICcnO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvcm1hdCA9IGxvY2FsZVNvcnRlZDtcbiAgICAgICAgaW5kZXggPSBmb3JtYXQ7XG4gICAgICAgIGxvY2FsZVNvcnRlZCA9IGZhbHNlO1xuXG4gICAgICAgIGlmIChpc051bWJlcihmb3JtYXQpKSB7XG4gICAgICAgICAgICBpbmRleCA9IGZvcm1hdDtcbiAgICAgICAgICAgIGZvcm1hdCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvcm1hdCA9IGZvcm1hdCB8fCAnJztcbiAgICB9XG5cbiAgICB2YXIgbG9jYWxlID0gZ2V0TG9jYWxlKCksXG4gICAgICAgIHNoaWZ0ID0gbG9jYWxlU29ydGVkID8gbG9jYWxlLl93ZWVrLmRvdyA6IDA7XG5cbiAgICBpZiAoaW5kZXggIT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gZ2V0JDEoZm9ybWF0LCAoaW5kZXggKyBzaGlmdCkgJSA3LCBmaWVsZCwgJ2RheScpO1xuICAgIH1cblxuICAgIHZhciBpO1xuICAgIHZhciBvdXQgPSBbXTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgNzsgaSsrKSB7XG4gICAgICAgIG91dFtpXSA9IGdldCQxKGZvcm1hdCwgKGkgKyBzaGlmdCkgJSA3LCBmaWVsZCwgJ2RheScpO1xuICAgIH1cbiAgICByZXR1cm4gb3V0O1xufVxuXG5mdW5jdGlvbiBsaXN0TW9udGhzIChmb3JtYXQsIGluZGV4KSB7XG4gICAgcmV0dXJuIGxpc3RNb250aHNJbXBsKGZvcm1hdCwgaW5kZXgsICdtb250aHMnKTtcbn1cblxuZnVuY3Rpb24gbGlzdE1vbnRoc1Nob3J0IChmb3JtYXQsIGluZGV4KSB7XG4gICAgcmV0dXJuIGxpc3RNb250aHNJbXBsKGZvcm1hdCwgaW5kZXgsICdtb250aHNTaG9ydCcpO1xufVxuXG5mdW5jdGlvbiBsaXN0V2Vla2RheXMgKGxvY2FsZVNvcnRlZCwgZm9ybWF0LCBpbmRleCkge1xuICAgIHJldHVybiBsaXN0V2Vla2RheXNJbXBsKGxvY2FsZVNvcnRlZCwgZm9ybWF0LCBpbmRleCwgJ3dlZWtkYXlzJyk7XG59XG5cbmZ1bmN0aW9uIGxpc3RXZWVrZGF5c1Nob3J0IChsb2NhbGVTb3J0ZWQsIGZvcm1hdCwgaW5kZXgpIHtcbiAgICByZXR1cm4gbGlzdFdlZWtkYXlzSW1wbChsb2NhbGVTb3J0ZWQsIGZvcm1hdCwgaW5kZXgsICd3ZWVrZGF5c1Nob3J0Jyk7XG59XG5cbmZ1bmN0aW9uIGxpc3RXZWVrZGF5c01pbiAobG9jYWxlU29ydGVkLCBmb3JtYXQsIGluZGV4KSB7XG4gICAgcmV0dXJuIGxpc3RXZWVrZGF5c0ltcGwobG9jYWxlU29ydGVkLCBmb3JtYXQsIGluZGV4LCAnd2Vla2RheXNNaW4nKTtcbn1cblxuZ2V0U2V0R2xvYmFsTG9jYWxlKCdlbicsIHtcbiAgICBkYXlPZk1vbnRoT3JkaW5hbFBhcnNlOiAvXFxkezEsMn0odGh8c3R8bmR8cmQpLyxcbiAgICBvcmRpbmFsIDogZnVuY3Rpb24gKG51bWJlcikge1xuICAgICAgICB2YXIgYiA9IG51bWJlciAlIDEwLFxuICAgICAgICAgICAgb3V0cHV0ID0gKHRvSW50KG51bWJlciAlIDEwMCAvIDEwKSA9PT0gMSkgPyAndGgnIDpcbiAgICAgICAgICAgIChiID09PSAxKSA/ICdzdCcgOlxuICAgICAgICAgICAgKGIgPT09IDIpID8gJ25kJyA6XG4gICAgICAgICAgICAoYiA9PT0gMykgPyAncmQnIDogJ3RoJztcbiAgICAgICAgcmV0dXJuIG51bWJlciArIG91dHB1dDtcbiAgICB9XG59KTtcblxuLy8gU2lkZSBlZmZlY3QgaW1wb3J0c1xuaG9va3MubGFuZyA9IGRlcHJlY2F0ZSgnbW9tZW50LmxhbmcgaXMgZGVwcmVjYXRlZC4gVXNlIG1vbWVudC5sb2NhbGUgaW5zdGVhZC4nLCBnZXRTZXRHbG9iYWxMb2NhbGUpO1xuaG9va3MubGFuZ0RhdGEgPSBkZXByZWNhdGUoJ21vbWVudC5sYW5nRGF0YSBpcyBkZXByZWNhdGVkLiBVc2UgbW9tZW50LmxvY2FsZURhdGEgaW5zdGVhZC4nLCBnZXRMb2NhbGUpO1xuXG52YXIgbWF0aEFicyA9IE1hdGguYWJzO1xuXG5mdW5jdGlvbiBhYnMgKCkge1xuICAgIHZhciBkYXRhICAgICAgICAgICA9IHRoaXMuX2RhdGE7XG5cbiAgICB0aGlzLl9taWxsaXNlY29uZHMgPSBtYXRoQWJzKHRoaXMuX21pbGxpc2Vjb25kcyk7XG4gICAgdGhpcy5fZGF5cyAgICAgICAgID0gbWF0aEFicyh0aGlzLl9kYXlzKTtcbiAgICB0aGlzLl9tb250aHMgICAgICAgPSBtYXRoQWJzKHRoaXMuX21vbnRocyk7XG5cbiAgICBkYXRhLm1pbGxpc2Vjb25kcyAgPSBtYXRoQWJzKGRhdGEubWlsbGlzZWNvbmRzKTtcbiAgICBkYXRhLnNlY29uZHMgICAgICAgPSBtYXRoQWJzKGRhdGEuc2Vjb25kcyk7XG4gICAgZGF0YS5taW51dGVzICAgICAgID0gbWF0aEFicyhkYXRhLm1pbnV0ZXMpO1xuICAgIGRhdGEuaG91cnMgICAgICAgICA9IG1hdGhBYnMoZGF0YS5ob3Vycyk7XG4gICAgZGF0YS5tb250aHMgICAgICAgID0gbWF0aEFicyhkYXRhLm1vbnRocyk7XG4gICAgZGF0YS55ZWFycyAgICAgICAgID0gbWF0aEFicyhkYXRhLnllYXJzKTtcblxuICAgIHJldHVybiB0aGlzO1xufVxuXG5mdW5jdGlvbiBhZGRTdWJ0cmFjdCQxIChkdXJhdGlvbiwgaW5wdXQsIHZhbHVlLCBkaXJlY3Rpb24pIHtcbiAgICB2YXIgb3RoZXIgPSBjcmVhdGVEdXJhdGlvbihpbnB1dCwgdmFsdWUpO1xuXG4gICAgZHVyYXRpb24uX21pbGxpc2Vjb25kcyArPSBkaXJlY3Rpb24gKiBvdGhlci5fbWlsbGlzZWNvbmRzO1xuICAgIGR1cmF0aW9uLl9kYXlzICAgICAgICAgKz0gZGlyZWN0aW9uICogb3RoZXIuX2RheXM7XG4gICAgZHVyYXRpb24uX21vbnRocyAgICAgICArPSBkaXJlY3Rpb24gKiBvdGhlci5fbW9udGhzO1xuXG4gICAgcmV0dXJuIGR1cmF0aW9uLl9idWJibGUoKTtcbn1cblxuLy8gc3VwcG9ydHMgb25seSAyLjAtc3R5bGUgYWRkKDEsICdzJykgb3IgYWRkKGR1cmF0aW9uKVxuZnVuY3Rpb24gYWRkJDEgKGlucHV0LCB2YWx1ZSkge1xuICAgIHJldHVybiBhZGRTdWJ0cmFjdCQxKHRoaXMsIGlucHV0LCB2YWx1ZSwgMSk7XG59XG5cbi8vIHN1cHBvcnRzIG9ubHkgMi4wLXN0eWxlIHN1YnRyYWN0KDEsICdzJykgb3Igc3VidHJhY3QoZHVyYXRpb24pXG5mdW5jdGlvbiBzdWJ0cmFjdCQxIChpbnB1dCwgdmFsdWUpIHtcbiAgICByZXR1cm4gYWRkU3VidHJhY3QkMSh0aGlzLCBpbnB1dCwgdmFsdWUsIC0xKTtcbn1cblxuZnVuY3Rpb24gYWJzQ2VpbCAobnVtYmVyKSB7XG4gICAgaWYgKG51bWJlciA8IDApIHtcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IobnVtYmVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gTWF0aC5jZWlsKG51bWJlcik7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBidWJibGUgKCkge1xuICAgIHZhciBtaWxsaXNlY29uZHMgPSB0aGlzLl9taWxsaXNlY29uZHM7XG4gICAgdmFyIGRheXMgICAgICAgICA9IHRoaXMuX2RheXM7XG4gICAgdmFyIG1vbnRocyAgICAgICA9IHRoaXMuX21vbnRocztcbiAgICB2YXIgZGF0YSAgICAgICAgID0gdGhpcy5fZGF0YTtcbiAgICB2YXIgc2Vjb25kcywgbWludXRlcywgaG91cnMsIHllYXJzLCBtb250aHNGcm9tRGF5cztcblxuICAgIC8vIGlmIHdlIGhhdmUgYSBtaXggb2YgcG9zaXRpdmUgYW5kIG5lZ2F0aXZlIHZhbHVlcywgYnViYmxlIGRvd24gZmlyc3RcbiAgICAvLyBjaGVjazogaHR0cHM6Ly9naXRodWIuY29tL21vbWVudC9tb21lbnQvaXNzdWVzLzIxNjZcbiAgICBpZiAoISgobWlsbGlzZWNvbmRzID49IDAgJiYgZGF5cyA+PSAwICYmIG1vbnRocyA+PSAwKSB8fFxuICAgICAgICAgICAgKG1pbGxpc2Vjb25kcyA8PSAwICYmIGRheXMgPD0gMCAmJiBtb250aHMgPD0gMCkpKSB7XG4gICAgICAgIG1pbGxpc2Vjb25kcyArPSBhYnNDZWlsKG1vbnRoc1RvRGF5cyhtb250aHMpICsgZGF5cykgKiA4NjRlNTtcbiAgICAgICAgZGF5cyA9IDA7XG4gICAgICAgIG1vbnRocyA9IDA7XG4gICAgfVxuXG4gICAgLy8gVGhlIGZvbGxvd2luZyBjb2RlIGJ1YmJsZXMgdXAgdmFsdWVzLCBzZWUgdGhlIHRlc3RzIGZvclxuICAgIC8vIGV4YW1wbGVzIG9mIHdoYXQgdGhhdCBtZWFucy5cbiAgICBkYXRhLm1pbGxpc2Vjb25kcyA9IG1pbGxpc2Vjb25kcyAlIDEwMDA7XG5cbiAgICBzZWNvbmRzICAgICAgICAgICA9IGFic0Zsb29yKG1pbGxpc2Vjb25kcyAvIDEwMDApO1xuICAgIGRhdGEuc2Vjb25kcyAgICAgID0gc2Vjb25kcyAlIDYwO1xuXG4gICAgbWludXRlcyAgICAgICAgICAgPSBhYnNGbG9vcihzZWNvbmRzIC8gNjApO1xuICAgIGRhdGEubWludXRlcyAgICAgID0gbWludXRlcyAlIDYwO1xuXG4gICAgaG91cnMgICAgICAgICAgICAgPSBhYnNGbG9vcihtaW51dGVzIC8gNjApO1xuICAgIGRhdGEuaG91cnMgICAgICAgID0gaG91cnMgJSAyNDtcblxuICAgIGRheXMgKz0gYWJzRmxvb3IoaG91cnMgLyAyNCk7XG5cbiAgICAvLyBjb252ZXJ0IGRheXMgdG8gbW9udGhzXG4gICAgbW9udGhzRnJvbURheXMgPSBhYnNGbG9vcihkYXlzVG9Nb250aHMoZGF5cykpO1xuICAgIG1vbnRocyArPSBtb250aHNGcm9tRGF5cztcbiAgICBkYXlzIC09IGFic0NlaWwobW9udGhzVG9EYXlzKG1vbnRoc0Zyb21EYXlzKSk7XG5cbiAgICAvLyAxMiBtb250aHMgLT4gMSB5ZWFyXG4gICAgeWVhcnMgPSBhYnNGbG9vcihtb250aHMgLyAxMik7XG4gICAgbW9udGhzICU9IDEyO1xuXG4gICAgZGF0YS5kYXlzICAgPSBkYXlzO1xuICAgIGRhdGEubW9udGhzID0gbW9udGhzO1xuICAgIGRhdGEueWVhcnMgID0geWVhcnM7XG5cbiAgICByZXR1cm4gdGhpcztcbn1cblxuZnVuY3Rpb24gZGF5c1RvTW9udGhzIChkYXlzKSB7XG4gICAgLy8gNDAwIHllYXJzIGhhdmUgMTQ2MDk3IGRheXMgKHRha2luZyBpbnRvIGFjY291bnQgbGVhcCB5ZWFyIHJ1bGVzKVxuICAgIC8vIDQwMCB5ZWFycyBoYXZlIDEyIG1vbnRocyA9PT0gNDgwMFxuICAgIHJldHVybiBkYXlzICogNDgwMCAvIDE0NjA5Nztcbn1cblxuZnVuY3Rpb24gbW9udGhzVG9EYXlzIChtb250aHMpIHtcbiAgICAvLyB0aGUgcmV2ZXJzZSBvZiBkYXlzVG9Nb250aHNcbiAgICByZXR1cm4gbW9udGhzICogMTQ2MDk3IC8gNDgwMDtcbn1cblxuZnVuY3Rpb24gYXMgKHVuaXRzKSB7XG4gICAgaWYgKCF0aGlzLmlzVmFsaWQoKSkge1xuICAgICAgICByZXR1cm4gTmFOO1xuICAgIH1cbiAgICB2YXIgZGF5cztcbiAgICB2YXIgbW9udGhzO1xuICAgIHZhciBtaWxsaXNlY29uZHMgPSB0aGlzLl9taWxsaXNlY29uZHM7XG5cbiAgICB1bml0cyA9IG5vcm1hbGl6ZVVuaXRzKHVuaXRzKTtcblxuICAgIGlmICh1bml0cyA9PT0gJ21vbnRoJyB8fCB1bml0cyA9PT0gJ3llYXInKSB7XG4gICAgICAgIGRheXMgICA9IHRoaXMuX2RheXMgICArIG1pbGxpc2Vjb25kcyAvIDg2NGU1O1xuICAgICAgICBtb250aHMgPSB0aGlzLl9tb250aHMgKyBkYXlzVG9Nb250aHMoZGF5cyk7XG4gICAgICAgIHJldHVybiB1bml0cyA9PT0gJ21vbnRoJyA/IG1vbnRocyA6IG1vbnRocyAvIDEyO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGhhbmRsZSBtaWxsaXNlY29uZHMgc2VwYXJhdGVseSBiZWNhdXNlIG9mIGZsb2F0aW5nIHBvaW50IG1hdGggZXJyb3JzIChpc3N1ZSAjMTg2NylcbiAgICAgICAgZGF5cyA9IHRoaXMuX2RheXMgKyBNYXRoLnJvdW5kKG1vbnRoc1RvRGF5cyh0aGlzLl9tb250aHMpKTtcbiAgICAgICAgc3dpdGNoICh1bml0cykge1xuICAgICAgICAgICAgY2FzZSAnd2VlaycgICA6IHJldHVybiBkYXlzIC8gNyAgICAgKyBtaWxsaXNlY29uZHMgLyA2MDQ4ZTU7XG4gICAgICAgICAgICBjYXNlICdkYXknICAgIDogcmV0dXJuIGRheXMgICAgICAgICArIG1pbGxpc2Vjb25kcyAvIDg2NGU1O1xuICAgICAgICAgICAgY2FzZSAnaG91cicgICA6IHJldHVybiBkYXlzICogMjQgICAgKyBtaWxsaXNlY29uZHMgLyAzNmU1O1xuICAgICAgICAgICAgY2FzZSAnbWludXRlJyA6IHJldHVybiBkYXlzICogMTQ0MCAgKyBtaWxsaXNlY29uZHMgLyA2ZTQ7XG4gICAgICAgICAgICBjYXNlICdzZWNvbmQnIDogcmV0dXJuIGRheXMgKiA4NjQwMCArIG1pbGxpc2Vjb25kcyAvIDEwMDA7XG4gICAgICAgICAgICAvLyBNYXRoLmZsb29yIHByZXZlbnRzIGZsb2F0aW5nIHBvaW50IG1hdGggZXJyb3JzIGhlcmVcbiAgICAgICAgICAgIGNhc2UgJ21pbGxpc2Vjb25kJzogcmV0dXJuIE1hdGguZmxvb3IoZGF5cyAqIDg2NGU1KSArIG1pbGxpc2Vjb25kcztcbiAgICAgICAgICAgIGRlZmF1bHQ6IHRocm93IG5ldyBFcnJvcignVW5rbm93biB1bml0ICcgKyB1bml0cyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8vIFRPRE86IFVzZSB0aGlzLmFzKCdtcycpP1xuZnVuY3Rpb24gdmFsdWVPZiQxICgpIHtcbiAgICBpZiAoIXRoaXMuaXNWYWxpZCgpKSB7XG4gICAgICAgIHJldHVybiBOYU47XG4gICAgfVxuICAgIHJldHVybiAoXG4gICAgICAgIHRoaXMuX21pbGxpc2Vjb25kcyArXG4gICAgICAgIHRoaXMuX2RheXMgKiA4NjRlNSArXG4gICAgICAgICh0aGlzLl9tb250aHMgJSAxMikgKiAyNTkyZTYgK1xuICAgICAgICB0b0ludCh0aGlzLl9tb250aHMgLyAxMikgKiAzMTUzNmU2XG4gICAgKTtcbn1cblxuZnVuY3Rpb24gbWFrZUFzIChhbGlhcykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFzKGFsaWFzKTtcbiAgICB9O1xufVxuXG52YXIgYXNNaWxsaXNlY29uZHMgPSBtYWtlQXMoJ21zJyk7XG52YXIgYXNTZWNvbmRzICAgICAgPSBtYWtlQXMoJ3MnKTtcbnZhciBhc01pbnV0ZXMgICAgICA9IG1ha2VBcygnbScpO1xudmFyIGFzSG91cnMgICAgICAgID0gbWFrZUFzKCdoJyk7XG52YXIgYXNEYXlzICAgICAgICAgPSBtYWtlQXMoJ2QnKTtcbnZhciBhc1dlZWtzICAgICAgICA9IG1ha2VBcygndycpO1xudmFyIGFzTW9udGhzICAgICAgID0gbWFrZUFzKCdNJyk7XG52YXIgYXNZZWFycyAgICAgICAgPSBtYWtlQXMoJ3knKTtcblxuZnVuY3Rpb24gZ2V0JDIgKHVuaXRzKSB7XG4gICAgdW5pdHMgPSBub3JtYWxpemVVbml0cyh1bml0cyk7XG4gICAgcmV0dXJuIHRoaXMuaXNWYWxpZCgpID8gdGhpc1t1bml0cyArICdzJ10oKSA6IE5hTjtcbn1cblxuZnVuY3Rpb24gbWFrZUdldHRlcihuYW1lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNWYWxpZCgpID8gdGhpcy5fZGF0YVtuYW1lXSA6IE5hTjtcbiAgICB9O1xufVxuXG52YXIgbWlsbGlzZWNvbmRzID0gbWFrZUdldHRlcignbWlsbGlzZWNvbmRzJyk7XG52YXIgc2Vjb25kcyAgICAgID0gbWFrZUdldHRlcignc2Vjb25kcycpO1xudmFyIG1pbnV0ZXMgICAgICA9IG1ha2VHZXR0ZXIoJ21pbnV0ZXMnKTtcbnZhciBob3VycyAgICAgICAgPSBtYWtlR2V0dGVyKCdob3VycycpO1xudmFyIGRheXMgICAgICAgICA9IG1ha2VHZXR0ZXIoJ2RheXMnKTtcbnZhciBtb250aHMgICAgICAgPSBtYWtlR2V0dGVyKCdtb250aHMnKTtcbnZhciB5ZWFycyAgICAgICAgPSBtYWtlR2V0dGVyKCd5ZWFycycpO1xuXG5mdW5jdGlvbiB3ZWVrcyAoKSB7XG4gICAgcmV0dXJuIGFic0Zsb29yKHRoaXMuZGF5cygpIC8gNyk7XG59XG5cbnZhciByb3VuZCA9IE1hdGgucm91bmQ7XG52YXIgdGhyZXNob2xkcyA9IHtcbiAgICBzczogNDQsICAgICAgICAgLy8gYSBmZXcgc2Vjb25kcyB0byBzZWNvbmRzXG4gICAgcyA6IDQ1LCAgICAgICAgIC8vIHNlY29uZHMgdG8gbWludXRlXG4gICAgbSA6IDQ1LCAgICAgICAgIC8vIG1pbnV0ZXMgdG8gaG91clxuICAgIGggOiAyMiwgICAgICAgICAvLyBob3VycyB0byBkYXlcbiAgICBkIDogMjYsICAgICAgICAgLy8gZGF5cyB0byBtb250aFxuICAgIE0gOiAxMSAgICAgICAgICAvLyBtb250aHMgdG8geWVhclxufTtcblxuLy8gaGVscGVyIGZ1bmN0aW9uIGZvciBtb21lbnQuZm4uZnJvbSwgbW9tZW50LmZuLmZyb21Ob3csIGFuZCBtb21lbnQuZHVyYXRpb24uZm4uaHVtYW5pemVcbmZ1bmN0aW9uIHN1YnN0aXR1dGVUaW1lQWdvKHN0cmluZywgbnVtYmVyLCB3aXRob3V0U3VmZml4LCBpc0Z1dHVyZSwgbG9jYWxlKSB7XG4gICAgcmV0dXJuIGxvY2FsZS5yZWxhdGl2ZVRpbWUobnVtYmVyIHx8IDEsICEhd2l0aG91dFN1ZmZpeCwgc3RyaW5nLCBpc0Z1dHVyZSk7XG59XG5cbmZ1bmN0aW9uIHJlbGF0aXZlVGltZSQxIChwb3NOZWdEdXJhdGlvbiwgd2l0aG91dFN1ZmZpeCwgbG9jYWxlKSB7XG4gICAgdmFyIGR1cmF0aW9uID0gY3JlYXRlRHVyYXRpb24ocG9zTmVnRHVyYXRpb24pLmFicygpO1xuICAgIHZhciBzZWNvbmRzICA9IHJvdW5kKGR1cmF0aW9uLmFzKCdzJykpO1xuICAgIHZhciBtaW51dGVzICA9IHJvdW5kKGR1cmF0aW9uLmFzKCdtJykpO1xuICAgIHZhciBob3VycyAgICA9IHJvdW5kKGR1cmF0aW9uLmFzKCdoJykpO1xuICAgIHZhciBkYXlzICAgICA9IHJvdW5kKGR1cmF0aW9uLmFzKCdkJykpO1xuICAgIHZhciBtb250aHMgICA9IHJvdW5kKGR1cmF0aW9uLmFzKCdNJykpO1xuICAgIHZhciB5ZWFycyAgICA9IHJvdW5kKGR1cmF0aW9uLmFzKCd5JykpO1xuXG4gICAgdmFyIGEgPSBzZWNvbmRzIDw9IHRocmVzaG9sZHMuc3MgJiYgWydzJywgc2Vjb25kc10gIHx8XG4gICAgICAgICAgICBzZWNvbmRzIDwgdGhyZXNob2xkcy5zICAgJiYgWydzcycsIHNlY29uZHNdIHx8XG4gICAgICAgICAgICBtaW51dGVzIDw9IDEgICAgICAgICAgICAgJiYgWydtJ10gICAgICAgICAgIHx8XG4gICAgICAgICAgICBtaW51dGVzIDwgdGhyZXNob2xkcy5tICAgJiYgWydtbScsIG1pbnV0ZXNdIHx8XG4gICAgICAgICAgICBob3VycyAgIDw9IDEgICAgICAgICAgICAgJiYgWydoJ10gICAgICAgICAgIHx8XG4gICAgICAgICAgICBob3VycyAgIDwgdGhyZXNob2xkcy5oICAgJiYgWydoaCcsIGhvdXJzXSAgIHx8XG4gICAgICAgICAgICBkYXlzICAgIDw9IDEgICAgICAgICAgICAgJiYgWydkJ10gICAgICAgICAgIHx8XG4gICAgICAgICAgICBkYXlzICAgIDwgdGhyZXNob2xkcy5kICAgJiYgWydkZCcsIGRheXNdICAgIHx8XG4gICAgICAgICAgICBtb250aHMgIDw9IDEgICAgICAgICAgICAgJiYgWydNJ10gICAgICAgICAgIHx8XG4gICAgICAgICAgICBtb250aHMgIDwgdGhyZXNob2xkcy5NICAgJiYgWydNTScsIG1vbnRoc10gIHx8XG4gICAgICAgICAgICB5ZWFycyAgIDw9IDEgICAgICAgICAgICAgJiYgWyd5J10gICAgICAgICAgIHx8IFsneXknLCB5ZWFyc107XG5cbiAgICBhWzJdID0gd2l0aG91dFN1ZmZpeDtcbiAgICBhWzNdID0gK3Bvc05lZ0R1cmF0aW9uID4gMDtcbiAgICBhWzRdID0gbG9jYWxlO1xuICAgIHJldHVybiBzdWJzdGl0dXRlVGltZUFnby5hcHBseShudWxsLCBhKTtcbn1cblxuLy8gVGhpcyBmdW5jdGlvbiBhbGxvd3MgeW91IHRvIHNldCB0aGUgcm91bmRpbmcgZnVuY3Rpb24gZm9yIHJlbGF0aXZlIHRpbWUgc3RyaW5nc1xuZnVuY3Rpb24gZ2V0U2V0UmVsYXRpdmVUaW1lUm91bmRpbmcgKHJvdW5kaW5nRnVuY3Rpb24pIHtcbiAgICBpZiAocm91bmRpbmdGdW5jdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiByb3VuZDtcbiAgICB9XG4gICAgaWYgKHR5cGVvZihyb3VuZGluZ0Z1bmN0aW9uKSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByb3VuZCA9IHJvdW5kaW5nRnVuY3Rpb247XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbi8vIFRoaXMgZnVuY3Rpb24gYWxsb3dzIHlvdSB0byBzZXQgYSB0aHJlc2hvbGQgZm9yIHJlbGF0aXZlIHRpbWUgc3RyaW5nc1xuZnVuY3Rpb24gZ2V0U2V0UmVsYXRpdmVUaW1lVGhyZXNob2xkICh0aHJlc2hvbGQsIGxpbWl0KSB7XG4gICAgaWYgKHRocmVzaG9sZHNbdGhyZXNob2xkXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGxpbWl0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHRocmVzaG9sZHNbdGhyZXNob2xkXTtcbiAgICB9XG4gICAgdGhyZXNob2xkc1t0aHJlc2hvbGRdID0gbGltaXQ7XG4gICAgaWYgKHRocmVzaG9sZCA9PT0gJ3MnKSB7XG4gICAgICAgIHRocmVzaG9sZHMuc3MgPSBsaW1pdCAtIDE7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiBodW1hbml6ZSAod2l0aFN1ZmZpeCkge1xuICAgIGlmICghdGhpcy5pc1ZhbGlkKCkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxlRGF0YSgpLmludmFsaWREYXRlKCk7XG4gICAgfVxuXG4gICAgdmFyIGxvY2FsZSA9IHRoaXMubG9jYWxlRGF0YSgpO1xuICAgIHZhciBvdXRwdXQgPSByZWxhdGl2ZVRpbWUkMSh0aGlzLCAhd2l0aFN1ZmZpeCwgbG9jYWxlKTtcblxuICAgIGlmICh3aXRoU3VmZml4KSB7XG4gICAgICAgIG91dHB1dCA9IGxvY2FsZS5wYXN0RnV0dXJlKCt0aGlzLCBvdXRwdXQpO1xuICAgIH1cblxuICAgIHJldHVybiBsb2NhbGUucG9zdGZvcm1hdChvdXRwdXQpO1xufVxuXG52YXIgYWJzJDEgPSBNYXRoLmFicztcblxuZnVuY3Rpb24gdG9JU09TdHJpbmckMSgpIHtcbiAgICAvLyBmb3IgSVNPIHN0cmluZ3Mgd2UgZG8gbm90IHVzZSB0aGUgbm9ybWFsIGJ1YmJsaW5nIHJ1bGVzOlxuICAgIC8vICAqIG1pbGxpc2Vjb25kcyBidWJibGUgdXAgdW50aWwgdGhleSBiZWNvbWUgaG91cnNcbiAgICAvLyAgKiBkYXlzIGRvIG5vdCBidWJibGUgYXQgYWxsXG4gICAgLy8gICogbW9udGhzIGJ1YmJsZSB1cCB1bnRpbCB0aGV5IGJlY29tZSB5ZWFyc1xuICAgIC8vIFRoaXMgaXMgYmVjYXVzZSB0aGVyZSBpcyBubyBjb250ZXh0LWZyZWUgY29udmVyc2lvbiBiZXR3ZWVuIGhvdXJzIGFuZCBkYXlzXG4gICAgLy8gKHRoaW5rIG9mIGNsb2NrIGNoYW5nZXMpXG4gICAgLy8gYW5kIGFsc28gbm90IGJldHdlZW4gZGF5cyBhbmQgbW9udGhzICgyOC0zMSBkYXlzIHBlciBtb250aClcbiAgICBpZiAoIXRoaXMuaXNWYWxpZCgpKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsZURhdGEoKS5pbnZhbGlkRGF0ZSgpO1xuICAgIH1cblxuICAgIHZhciBzZWNvbmRzID0gYWJzJDEodGhpcy5fbWlsbGlzZWNvbmRzKSAvIDEwMDA7XG4gICAgdmFyIGRheXMgICAgICAgICA9IGFicyQxKHRoaXMuX2RheXMpO1xuICAgIHZhciBtb250aHMgICAgICAgPSBhYnMkMSh0aGlzLl9tb250aHMpO1xuICAgIHZhciBtaW51dGVzLCBob3VycywgeWVhcnM7XG5cbiAgICAvLyAzNjAwIHNlY29uZHMgLT4gNjAgbWludXRlcyAtPiAxIGhvdXJcbiAgICBtaW51dGVzICAgICAgICAgICA9IGFic0Zsb29yKHNlY29uZHMgLyA2MCk7XG4gICAgaG91cnMgICAgICAgICAgICAgPSBhYnNGbG9vcihtaW51dGVzIC8gNjApO1xuICAgIHNlY29uZHMgJT0gNjA7XG4gICAgbWludXRlcyAlPSA2MDtcblxuICAgIC8vIDEyIG1vbnRocyAtPiAxIHllYXJcbiAgICB5ZWFycyAgPSBhYnNGbG9vcihtb250aHMgLyAxMik7XG4gICAgbW9udGhzICU9IDEyO1xuXG5cbiAgICAvLyBpbnNwaXJlZCBieSBodHRwczovL2dpdGh1Yi5jb20vZG9yZGlsbGUvbW9tZW50LWlzb2R1cmF0aW9uL2Jsb2IvbWFzdGVyL21vbWVudC5pc29kdXJhdGlvbi5qc1xuICAgIHZhciBZID0geWVhcnM7XG4gICAgdmFyIE0gPSBtb250aHM7XG4gICAgdmFyIEQgPSBkYXlzO1xuICAgIHZhciBoID0gaG91cnM7XG4gICAgdmFyIG0gPSBtaW51dGVzO1xuICAgIHZhciBzID0gc2Vjb25kcztcbiAgICB2YXIgdG90YWwgPSB0aGlzLmFzU2Vjb25kcygpO1xuXG4gICAgaWYgKCF0b3RhbCkge1xuICAgICAgICAvLyB0aGlzIGlzIHRoZSBzYW1lIGFzIEMjJ3MgKE5vZGEpIGFuZCBweXRob24gKGlzb2RhdGUpLi4uXG4gICAgICAgIC8vIGJ1dCBub3Qgb3RoZXIgSlMgKGdvb2cuZGF0ZSlcbiAgICAgICAgcmV0dXJuICdQMEQnO1xuICAgIH1cblxuICAgIHJldHVybiAodG90YWwgPCAwID8gJy0nIDogJycpICtcbiAgICAgICAgJ1AnICtcbiAgICAgICAgKFkgPyBZICsgJ1knIDogJycpICtcbiAgICAgICAgKE0gPyBNICsgJ00nIDogJycpICtcbiAgICAgICAgKEQgPyBEICsgJ0QnIDogJycpICtcbiAgICAgICAgKChoIHx8IG0gfHwgcykgPyAnVCcgOiAnJykgK1xuICAgICAgICAoaCA/IGggKyAnSCcgOiAnJykgK1xuICAgICAgICAobSA/IG0gKyAnTScgOiAnJykgK1xuICAgICAgICAocyA/IHMgKyAnUycgOiAnJyk7XG59XG5cbnZhciBwcm90byQyID0gRHVyYXRpb24ucHJvdG90eXBlO1xuXG5wcm90byQyLmlzVmFsaWQgICAgICAgID0gaXNWYWxpZCQxO1xucHJvdG8kMi5hYnMgICAgICAgICAgICA9IGFicztcbnByb3RvJDIuYWRkICAgICAgICAgICAgPSBhZGQkMTtcbnByb3RvJDIuc3VidHJhY3QgICAgICAgPSBzdWJ0cmFjdCQxO1xucHJvdG8kMi5hcyAgICAgICAgICAgICA9IGFzO1xucHJvdG8kMi5hc01pbGxpc2Vjb25kcyA9IGFzTWlsbGlzZWNvbmRzO1xucHJvdG8kMi5hc1NlY29uZHMgICAgICA9IGFzU2Vjb25kcztcbnByb3RvJDIuYXNNaW51dGVzICAgICAgPSBhc01pbnV0ZXM7XG5wcm90byQyLmFzSG91cnMgICAgICAgID0gYXNIb3VycztcbnByb3RvJDIuYXNEYXlzICAgICAgICAgPSBhc0RheXM7XG5wcm90byQyLmFzV2Vla3MgICAgICAgID0gYXNXZWVrcztcbnByb3RvJDIuYXNNb250aHMgICAgICAgPSBhc01vbnRocztcbnByb3RvJDIuYXNZZWFycyAgICAgICAgPSBhc1llYXJzO1xucHJvdG8kMi52YWx1ZU9mICAgICAgICA9IHZhbHVlT2YkMTtcbnByb3RvJDIuX2J1YmJsZSAgICAgICAgPSBidWJibGU7XG5wcm90byQyLmdldCAgICAgICAgICAgID0gZ2V0JDI7XG5wcm90byQyLm1pbGxpc2Vjb25kcyAgID0gbWlsbGlzZWNvbmRzO1xucHJvdG8kMi5zZWNvbmRzICAgICAgICA9IHNlY29uZHM7XG5wcm90byQyLm1pbnV0ZXMgICAgICAgID0gbWludXRlcztcbnByb3RvJDIuaG91cnMgICAgICAgICAgPSBob3VycztcbnByb3RvJDIuZGF5cyAgICAgICAgICAgPSBkYXlzO1xucHJvdG8kMi53ZWVrcyAgICAgICAgICA9IHdlZWtzO1xucHJvdG8kMi5tb250aHMgICAgICAgICA9IG1vbnRocztcbnByb3RvJDIueWVhcnMgICAgICAgICAgPSB5ZWFycztcbnByb3RvJDIuaHVtYW5pemUgICAgICAgPSBodW1hbml6ZTtcbnByb3RvJDIudG9JU09TdHJpbmcgICAgPSB0b0lTT1N0cmluZyQxO1xucHJvdG8kMi50b1N0cmluZyAgICAgICA9IHRvSVNPU3RyaW5nJDE7XG5wcm90byQyLnRvSlNPTiAgICAgICAgID0gdG9JU09TdHJpbmckMTtcbnByb3RvJDIubG9jYWxlICAgICAgICAgPSBsb2NhbGU7XG5wcm90byQyLmxvY2FsZURhdGEgICAgID0gbG9jYWxlRGF0YTtcblxuLy8gRGVwcmVjYXRpb25zXG5wcm90byQyLnRvSXNvU3RyaW5nID0gZGVwcmVjYXRlKCd0b0lzb1N0cmluZygpIGlzIGRlcHJlY2F0ZWQuIFBsZWFzZSB1c2UgdG9JU09TdHJpbmcoKSBpbnN0ZWFkIChub3RpY2UgdGhlIGNhcGl0YWxzKScsIHRvSVNPU3RyaW5nJDEpO1xucHJvdG8kMi5sYW5nID0gbGFuZztcblxuLy8gU2lkZSBlZmZlY3QgaW1wb3J0c1xuXG4vLyBGT1JNQVRUSU5HXG5cbmFkZEZvcm1hdFRva2VuKCdYJywgMCwgMCwgJ3VuaXgnKTtcbmFkZEZvcm1hdFRva2VuKCd4JywgMCwgMCwgJ3ZhbHVlT2YnKTtcblxuLy8gUEFSU0lOR1xuXG5hZGRSZWdleFRva2VuKCd4JywgbWF0Y2hTaWduZWQpO1xuYWRkUmVnZXhUb2tlbignWCcsIG1hdGNoVGltZXN0YW1wKTtcbmFkZFBhcnNlVG9rZW4oJ1gnLCBmdW5jdGlvbiAoaW5wdXQsIGFycmF5LCBjb25maWcpIHtcbiAgICBjb25maWcuX2QgPSBuZXcgRGF0ZShwYXJzZUZsb2F0KGlucHV0LCAxMCkgKiAxMDAwKTtcbn0pO1xuYWRkUGFyc2VUb2tlbigneCcsIGZ1bmN0aW9uIChpbnB1dCwgYXJyYXksIGNvbmZpZykge1xuICAgIGNvbmZpZy5fZCA9IG5ldyBEYXRlKHRvSW50KGlucHV0KSk7XG59KTtcblxuLy8gU2lkZSBlZmZlY3QgaW1wb3J0c1xuXG5cbmhvb2tzLnZlcnNpb24gPSAnMi4xOC4xJztcblxuc2V0SG9va0NhbGxiYWNrKGNyZWF0ZUxvY2FsKTtcblxuaG9va3MuZm4gICAgICAgICAgICAgICAgICAgID0gcHJvdG87XG5ob29rcy5taW4gICAgICAgICAgICAgICAgICAgPSBtaW47XG5ob29rcy5tYXggICAgICAgICAgICAgICAgICAgPSBtYXg7XG5ob29rcy5ub3cgICAgICAgICAgICAgICAgICAgPSBub3c7XG5ob29rcy51dGMgICAgICAgICAgICAgICAgICAgPSBjcmVhdGVVVEM7XG5ob29rcy51bml4ICAgICAgICAgICAgICAgICAgPSBjcmVhdGVVbml4O1xuaG9va3MubW9udGhzICAgICAgICAgICAgICAgID0gbGlzdE1vbnRocztcbmhvb2tzLmlzRGF0ZSAgICAgICAgICAgICAgICA9IGlzRGF0ZTtcbmhvb2tzLmxvY2FsZSAgICAgICAgICAgICAgICA9IGdldFNldEdsb2JhbExvY2FsZTtcbmhvb2tzLmludmFsaWQgICAgICAgICAgICAgICA9IGNyZWF0ZUludmFsaWQ7XG5ob29rcy5kdXJhdGlvbiAgICAgICAgICAgICAgPSBjcmVhdGVEdXJhdGlvbjtcbmhvb2tzLmlzTW9tZW50ICAgICAgICAgICAgICA9IGlzTW9tZW50O1xuaG9va3Mud2Vla2RheXMgICAgICAgICAgICAgID0gbGlzdFdlZWtkYXlzO1xuaG9va3MucGFyc2Vab25lICAgICAgICAgICAgID0gY3JlYXRlSW5ab25lO1xuaG9va3MubG9jYWxlRGF0YSAgICAgICAgICAgID0gZ2V0TG9jYWxlO1xuaG9va3MuaXNEdXJhdGlvbiAgICAgICAgICAgID0gaXNEdXJhdGlvbjtcbmhvb2tzLm1vbnRoc1Nob3J0ICAgICAgICAgICA9IGxpc3RNb250aHNTaG9ydDtcbmhvb2tzLndlZWtkYXlzTWluICAgICAgICAgICA9IGxpc3RXZWVrZGF5c01pbjtcbmhvb2tzLmRlZmluZUxvY2FsZSAgICAgICAgICA9IGRlZmluZUxvY2FsZTtcbmhvb2tzLnVwZGF0ZUxvY2FsZSAgICAgICAgICA9IHVwZGF0ZUxvY2FsZTtcbmhvb2tzLmxvY2FsZXMgICAgICAgICAgICAgICA9IGxpc3RMb2NhbGVzO1xuaG9va3Mud2Vla2RheXNTaG9ydCAgICAgICAgID0gbGlzdFdlZWtkYXlzU2hvcnQ7XG5ob29rcy5ub3JtYWxpemVVbml0cyAgICAgICAgPSBub3JtYWxpemVVbml0cztcbmhvb2tzLnJlbGF0aXZlVGltZVJvdW5kaW5nID0gZ2V0U2V0UmVsYXRpdmVUaW1lUm91bmRpbmc7XG5ob29rcy5yZWxhdGl2ZVRpbWVUaHJlc2hvbGQgPSBnZXRTZXRSZWxhdGl2ZVRpbWVUaHJlc2hvbGQ7XG5ob29rcy5jYWxlbmRhckZvcm1hdCAgICAgICAgPSBnZXRDYWxlbmRhckZvcm1hdDtcbmhvb2tzLnByb3RvdHlwZSAgICAgICAgICAgICA9IHByb3RvO1xuXG5yZXR1cm4gaG9va3M7XG5cbn0pKSk7XG5cbn0se31dLFwibnVtYnJvXCI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuLyohXG4gKiBudW1icm8uanNcbiAqIHZlcnNpb24gOiAxLjEwLjFcbiAqIGF1dGhvciA6IEbDtnJldGFnc3BsYXRzZW4gQUJcbiAqIGxpY2Vuc2UgOiBNSVRcbiAqIGh0dHA6Ly93d3cuZm9yZXRhZ3NwbGF0c2VuLnNlXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgIENvbnN0YW50c1xuICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgIHZhciBudW1icm8sXG4gICAgICAgIFZFUlNJT04gPSAnMS4xMC4xJyxcbiAgICAgICAgYmluYXJ5U3VmZml4ZXMgPSBbJ0InLCAnS2lCJywgJ01pQicsICdHaUInLCAnVGlCJywgJ1BpQicsICdFaUInLCAnWmlCJywgJ1lpQiddLFxuICAgICAgICBkZWNpbWFsU3VmZml4ZXMgPSBbJ0InLCAnS0InLCAnTUInLCAnR0InLCAnVEInLCAnUEInLCAnRUInLCAnWkInLCAnWUInXSxcbiAgICAgICAgYnl0ZXMgPSB7XG4gICAgICAgICAgICBnZW5lcmFsOiB7IHNjYWxlOiAxMDI0LCBzdWZmaXhlczogZGVjaW1hbFN1ZmZpeGVzLCBtYXJrZXI6ICdiZCcgfSxcbiAgICAgICAgICAgIGJpbmFyeTogIHsgc2NhbGU6IDEwMjQsIHN1ZmZpeGVzOiBiaW5hcnlTdWZmaXhlcywgbWFya2VyOiAnYicgfSxcbiAgICAgICAgICAgIGRlY2ltYWw6IHsgc2NhbGU6IDEwMDAsIHN1ZmZpeGVzOiBkZWNpbWFsU3VmZml4ZXMsIG1hcmtlcjogJ2QnIH1cbiAgICAgICAgfSxcbiAgICAgICAgLy8gZ2VuZXJhbCBtdXN0IGJlIGJlZm9yZSB0aGUgb3RoZXJzIGJlY2F1c2UgaXQgcmV1c2VzIHRoZWlyIGNoYXJhY3RlcnMhXG4gICAgICAgIGJ5dGVGb3JtYXRPcmRlciA9IFsgYnl0ZXMuZ2VuZXJhbCwgYnl0ZXMuYmluYXJ5LCBieXRlcy5kZWNpbWFsIF0sXG4gICAgLy8gaW50ZXJuYWwgc3RvcmFnZSBmb3IgY3VsdHVyZSBjb25maWcgZmlsZXNcbiAgICAgICAgY3VsdHVyZXMgPSB7fSxcbiAgICAvLyBUb2RvOiBSZW1vdmUgaW4gMi4wLjBcbiAgICAgICAgbGFuZ3VhZ2VzID0gY3VsdHVyZXMsXG4gICAgICAgIGN1cnJlbnRDdWx0dXJlID0gJ2VuLVVTJyxcbiAgICAgICAgemVyb0Zvcm1hdCA9IG51bGwsXG4gICAgICAgIGRlZmF1bHRGb3JtYXQgPSAnMCwwJyxcbiAgICAgICAgZGVmYXVsdEN1cnJlbmN5Rm9ybWF0ID0gJzAkJyxcbiAgICAgICAgLy8gY2hlY2sgZm9yIG5vZGVKU1xuICAgICAgICBoYXNNb2R1bGUgPSAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpLFxuICAgIC8vIGRlZmF1bHQgY3VsdHVyZVxuICAgICAgICBlblVTID0ge1xuICAgICAgICAgICAgZGVsaW1pdGVyczoge1xuICAgICAgICAgICAgICAgIHRob3VzYW5kczogJywnLFxuICAgICAgICAgICAgICAgIGRlY2ltYWw6ICcuJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFiYnJldmlhdGlvbnM6IHtcbiAgICAgICAgICAgICAgICB0aG91c2FuZDogJ2snLFxuICAgICAgICAgICAgICAgIG1pbGxpb246ICdtJyxcbiAgICAgICAgICAgICAgICBiaWxsaW9uOiAnYicsXG4gICAgICAgICAgICAgICAgdHJpbGxpb246ICd0J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9yZGluYWw6IGZ1bmN0aW9uKG51bWJlcikge1xuICAgICAgICAgICAgICAgIHZhciBiID0gbnVtYmVyICUgMTA7XG4gICAgICAgICAgICAgICAgcmV0dXJuICh+fihudW1iZXIgJSAxMDAgLyAxMCkgPT09IDEpID8gJ3RoJyA6XG4gICAgICAgICAgICAgICAgICAgIChiID09PSAxKSA/ICdzdCcgOlxuICAgICAgICAgICAgICAgICAgICAgICAgKGIgPT09IDIpID8gJ25kJyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGIgPT09IDMpID8gJ3JkJyA6ICd0aCc7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY3VycmVuY3k6IHtcbiAgICAgICAgICAgICAgICBzeW1ib2w6ICckJyxcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ3ByZWZpeCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgICAgICAgIGN1cnJlbmN5Rm9ybWF0OiAnLDAwMDAgYSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmb3JtYXRzOiB7XG4gICAgICAgICAgICAgICAgZm91ckRpZ2l0czogJzAwMDAgYScsXG4gICAgICAgICAgICAgICAgZnVsbFdpdGhUd29EZWNpbWFsczogJyQgLDAuMDAnLFxuICAgICAgICAgICAgICAgIGZ1bGxXaXRoVHdvRGVjaW1hbHNOb0N1cnJlbmN5OiAnLDAuMDAnXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgIENvbnN0cnVjdG9yc1xuICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuXG4gICAgLy8gTnVtYnJvIHByb3RvdHlwZSBvYmplY3RcbiAgICBmdW5jdGlvbiBOdW1icm8obnVtYmVyKSB7XG4gICAgICAgIHRoaXMuX3ZhbHVlID0gbnVtYmVyO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG51bWJlckxlbmd0aChudW1iZXIpIHtcbiAgICAgICAgaWYgKG51bWJlciA9PT0gMCkgeyByZXR1cm4gMTsgfVxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLmxvZyhNYXRoLmFicyhudW1iZXIpKSAvIE1hdGguTE4xMCkgKyAxO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHplcm9lcyhjb3VudCkge1xuICAgICAgICB2YXIgaSwgcmV0ID0gJyc7XG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgIHJldCArPSAnMCc7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbXBsZW1lbnRhdGlvbiBvZiB0b0ZpeGVkKCkgZm9yIG51bWJlcnMgd2l0aCBleHBvbmVudHNcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIG1heSByZXR1cm4gbmVnYXRpdmUgcmVwcmVzZW50YXRpb25zIGZvciB6ZXJvIHZhbHVlcyBlLmcuIFwiLTAuMFwiXG4gICAgICovXG4gICAgZnVuY3Rpb24gdG9GaXhlZExhcmdlU21hbGwodmFsdWUsIHByZWNpc2lvbikge1xuICAgICAgICB2YXIgbWFudGlzc2EsXG4gICAgICAgICAgICBiZWZvcmVEZWMsXG4gICAgICAgICAgICBhZnRlckRlYyxcbiAgICAgICAgICAgIGV4cG9uZW50LFxuICAgICAgICAgICAgcHJlZml4LFxuICAgICAgICAgICAgZW5kU3RyLFxuICAgICAgICAgICAgemVyb3NTdHIsXG4gICAgICAgICAgICBzdHI7XG5cbiAgICAgICAgc3RyID0gdmFsdWUudG9TdHJpbmcoKTtcblxuICAgICAgICBtYW50aXNzYSA9IHN0ci5zcGxpdCgnZScpWzBdO1xuICAgICAgICBleHBvbmVudCA9IHN0ci5zcGxpdCgnZScpWzFdO1xuXG4gICAgICAgIGJlZm9yZURlYyA9IG1hbnRpc3NhLnNwbGl0KCcuJylbMF07XG4gICAgICAgIGFmdGVyRGVjID0gbWFudGlzc2Euc3BsaXQoJy4nKVsxXSB8fCAnJztcblxuICAgICAgICBpZiAoK2V4cG9uZW50ID4gMCkge1xuICAgICAgICAgICAgLy8gZXhwb25lbnQgaXMgcG9zaXRpdmUgLSBhZGQgemVyb3MgYWZ0ZXIgdGhlIG51bWJlcnNcbiAgICAgICAgICAgIHN0ciA9IGJlZm9yZURlYyArIGFmdGVyRGVjICsgemVyb2VzKGV4cG9uZW50IC0gYWZ0ZXJEZWMubGVuZ3RoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGV4cG9uZW50IGlzIG5lZ2F0aXZlXG5cbiAgICAgICAgICAgIGlmICgrYmVmb3JlRGVjIDwgMCkge1xuICAgICAgICAgICAgICAgIHByZWZpeCA9ICctMCc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHByZWZpeCA9ICcwJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gdGFjayBvbiB0aGUgZGVjaW1hbCBwb2ludCBpZiBuZWVkZWRcbiAgICAgICAgICAgIGlmIChwcmVjaXNpb24gPiAwKSB7XG4gICAgICAgICAgICAgICAgcHJlZml4ICs9ICcuJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgemVyb3NTdHIgPSB6ZXJvZXMoKC0xICogZXhwb25lbnQpIC0gMSk7XG4gICAgICAgICAgICAvLyBzdWJzdHJpbmcgb2ZmIHRoZSBlbmQgdG8gc2F0aXNmeSB0aGUgcHJlY2lzaW9uXG4gICAgICAgICAgICBlbmRTdHIgPSAoemVyb3NTdHIgKyBNYXRoLmFicyhiZWZvcmVEZWMpICsgYWZ0ZXJEZWMpLnN1YnN0cigwLCBwcmVjaXNpb24pO1xuICAgICAgICAgICAgc3RyID0gcHJlZml4ICsgZW5kU3RyO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gb25seSBhZGQgcGVyY2lzaW9uIDAncyBpZiB0aGUgZXhwb25lbnQgaXMgcG9zaXRpdmVcbiAgICAgICAgaWYgKCtleHBvbmVudCA+IDAgJiYgcHJlY2lzaW9uID4gMCkge1xuICAgICAgICAgICAgc3RyICs9ICcuJyArIHplcm9lcyhwcmVjaXNpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN0cjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbXBsZW1lbnRhdGlvbiBvZiB0b0ZpeGVkKCkgdGhhdCB0cmVhdHMgZmxvYXRzIG1vcmUgbGlrZSBkZWNpbWFsc1xuICAgICAqXG4gICAgICogRml4ZXMgYmluYXJ5IHJvdW5kaW5nIGlzc3VlcyAoZWcuICgwLjYxNSkudG9GaXhlZCgyKSA9PT0gJzAuNjEnKSB0aGF0IHByZXNlbnRcbiAgICAgKiBwcm9ibGVtcyBmb3IgYWNjb3VudGluZy0gYW5kIGZpbmFuY2UtcmVsYXRlZCBzb2Z0d2FyZS5cbiAgICAgKlxuICAgICAqIEFsc28gcmVtb3ZlcyBuZWdhdGl2ZSBzaWducyBmb3IgemVyby1mb3JtYXR0ZWQgbnVtYmVycy4gZS5nLiAtMC4wMSB3LyBwcmVjaXNpb24gMSAtPiAwLjBcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0b0ZpeGVkKHZhbHVlLCBwcmVjaXNpb24sIHJvdW5kaW5nRnVuY3Rpb24sIG9wdGlvbmFscykge1xuICAgICAgICB2YXIgcG93ZXIgPSBNYXRoLnBvdygxMCwgcHJlY2lzaW9uKSxcbiAgICAgICAgICAgIG9wdGlvbmFsc1JlZ0V4cCxcbiAgICAgICAgICAgIG91dHB1dDtcblxuICAgICAgICBpZiAodmFsdWUudG9TdHJpbmcoKS5pbmRleE9mKCdlJykgPiAtMSkge1xuICAgICAgICAgICAgLy8gdG9GaXhlZCByZXR1cm5zIHNjaWVudGlmaWMgbm90YXRpb24gZm9yIG51bWJlcnMgYWJvdmUgMWUyMSBhbmQgYmVsb3cgMWUtN1xuICAgICAgICAgICAgb3V0cHV0ID0gdG9GaXhlZExhcmdlU21hbGwodmFsdWUsIHByZWNpc2lvbik7XG4gICAgICAgICAgICAvLyByZW1vdmUgdGhlIGxlYWRpbmcgbmVnYXRpdmUgc2lnbiBpZiBpdCBleGlzdHMgYW5kIHNob3VsZCBub3QgYmUgcHJlc2VudCAoZS5nLiAtMC4wMClcbiAgICAgICAgICAgIGlmIChvdXRwdXQuY2hhckF0KDApID09PSAnLScgJiYgK291dHB1dCA+PSAwKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnN1YnN0cigxKTsgLy8gY2hvcCBvZmYgdGhlICctJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gTXVsdGlwbHkgdXAgYnkgcHJlY2lzaW9uLCByb3VuZCBhY2N1cmF0ZWx5LCB0aGVuIGRpdmlkZSBhbmQgdXNlIG5hdGl2ZSB0b0ZpeGVkKCk6XG4gICAgICAgICAgICBvdXRwdXQgPSAocm91bmRpbmdGdW5jdGlvbih2YWx1ZSArICdlKycgKyBwcmVjaXNpb24pIC8gcG93ZXIpLnRvRml4ZWQocHJlY2lzaW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChvcHRpb25hbHMpIHtcbiAgICAgICAgICAgIG9wdGlvbmFsc1JlZ0V4cCA9IG5ldyBSZWdFeHAoJzB7MSwnICsgb3B0aW9uYWxzICsgJ30kJyk7XG4gICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZShvcHRpb25hbHNSZWdFeHAsICcnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBGb3JtYXR0aW5nXG4gICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgLy8gZGV0ZXJtaW5lIHdoYXQgdHlwZSBvZiBmb3JtYXR0aW5nIHdlIG5lZWQgdG8gZG9cbiAgICBmdW5jdGlvbiBmb3JtYXROdW1icm8obiwgZm9ybWF0LCByb3VuZGluZ0Z1bmN0aW9uKSB7XG4gICAgICAgIHZhciBvdXRwdXQsXG4gICAgICAgICAgICBlc2NhcGVkRm9ybWF0ID0gZm9ybWF0LnJlcGxhY2UoL1xce1teXFx7XFx9XSpcXH0vZywgJycpO1xuXG4gICAgICAgIC8vIGZpZ3VyZSBvdXQgd2hhdCBraW5kIG9mIGZvcm1hdCB3ZSBhcmUgZGVhbGluZyB3aXRoXG4gICAgICAgIGlmIChlc2NhcGVkRm9ybWF0LmluZGV4T2YoJyQnKSA+IC0xKSB7IC8vIGN1cnJlbmN5ISEhISFcbiAgICAgICAgICAgIG91dHB1dCA9IGZvcm1hdEN1cnJlbmN5KG4sIGN1bHR1cmVzW2N1cnJlbnRDdWx0dXJlXS5jdXJyZW5jeS5zeW1ib2wsIGZvcm1hdCwgcm91bmRpbmdGdW5jdGlvbik7XG4gICAgICAgIH0gZWxzZSBpZiAoZXNjYXBlZEZvcm1hdC5pbmRleE9mKCclJykgPiAtMSkgeyAvLyBwZXJjZW50YWdlXG4gICAgICAgICAgICBvdXRwdXQgPSBmb3JtYXRQZXJjZW50YWdlKG4sIGZvcm1hdCwgcm91bmRpbmdGdW5jdGlvbik7XG4gICAgICAgIH0gZWxzZSBpZiAoZXNjYXBlZEZvcm1hdC5pbmRleE9mKCc6JykgPiAtMSkgeyAvLyB0aW1lXG4gICAgICAgICAgICBvdXRwdXQgPSBmb3JtYXRUaW1lKG4sIGZvcm1hdCk7XG4gICAgICAgIH0gZWxzZSB7IC8vIHBsYWluIG9sJyBudW1iZXJzIG9yIGJ5dGVzXG4gICAgICAgICAgICBvdXRwdXQgPSBmb3JtYXROdW1iZXIobi5fdmFsdWUsIGZvcm1hdCwgcm91bmRpbmdGdW5jdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyByZXR1cm4gc3RyaW5nXG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuXG4gICAgLy8gcmV2ZXJ0IHRvIG51bWJlclxuICAgIGZ1bmN0aW9uIHVuZm9ybWF0TnVtYnJvKG4sIHN0cmluZykge1xuICAgICAgICB2YXIgc3RyaW5nT3JpZ2luYWwgPSBzdHJpbmcsXG4gICAgICAgICAgICB0aG91c2FuZFJlZ0V4cCxcbiAgICAgICAgICAgIG1pbGxpb25SZWdFeHAsXG4gICAgICAgICAgICBiaWxsaW9uUmVnRXhwLFxuICAgICAgICAgICAgdHJpbGxpb25SZWdFeHAsXG4gICAgICAgICAgICBieXRlc011bHRpcGxpZXIgPSBmYWxzZSxcbiAgICAgICAgICAgIHBvd2VyO1xuXG4gICAgICAgIGlmIChzdHJpbmcuaW5kZXhPZignOicpID4gLTEpIHtcbiAgICAgICAgICAgIG4uX3ZhbHVlID0gdW5mb3JtYXRUaW1lKHN0cmluZyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoc3RyaW5nID09PSB6ZXJvRm9ybWF0KSB7XG4gICAgICAgICAgICAgICAgbi5fdmFsdWUgPSAwO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VsdHVyZXNbY3VycmVudEN1bHR1cmVdLmRlbGltaXRlcnMuZGVjaW1hbCAhPT0gJy4nKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0cmluZyA9IHN0cmluZy5yZXBsYWNlKC9cXC4vZywgJycpLnJlcGxhY2UoY3VsdHVyZXNbY3VycmVudEN1bHR1cmVdLmRlbGltaXRlcnMuZGVjaW1hbCwgJy4nKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBzZWUgaWYgYWJicmV2aWF0aW9ucyBhcmUgdGhlcmUgc28gdGhhdCB3ZSBjYW4gbXVsdGlwbHkgdG8gdGhlIGNvcnJlY3QgbnVtYmVyXG4gICAgICAgICAgICAgICAgdGhvdXNhbmRSZWdFeHAgPSBuZXcgUmVnRXhwKCdbXmEtekEtWl0nICsgY3VsdHVyZXNbY3VycmVudEN1bHR1cmVdLmFiYnJldmlhdGlvbnMudGhvdXNhbmQgK1xuICAgICAgICAgICAgICAgICAgICAnKD86XFxcXCl8KFxcXFwnICsgY3VsdHVyZXNbY3VycmVudEN1bHR1cmVdLmN1cnJlbmN5LnN5bWJvbCArICcpPyg/OlxcXFwpKT8pPyQnKTtcbiAgICAgICAgICAgICAgICBtaWxsaW9uUmVnRXhwID0gbmV3IFJlZ0V4cCgnW15hLXpBLVpdJyArIGN1bHR1cmVzW2N1cnJlbnRDdWx0dXJlXS5hYmJyZXZpYXRpb25zLm1pbGxpb24gK1xuICAgICAgICAgICAgICAgICAgICAnKD86XFxcXCl8KFxcXFwnICsgY3VsdHVyZXNbY3VycmVudEN1bHR1cmVdLmN1cnJlbmN5LnN5bWJvbCArICcpPyg/OlxcXFwpKT8pPyQnKTtcbiAgICAgICAgICAgICAgICBiaWxsaW9uUmVnRXhwID0gbmV3IFJlZ0V4cCgnW15hLXpBLVpdJyArIGN1bHR1cmVzW2N1cnJlbnRDdWx0dXJlXS5hYmJyZXZpYXRpb25zLmJpbGxpb24gK1xuICAgICAgICAgICAgICAgICAgICAnKD86XFxcXCl8KFxcXFwnICsgY3VsdHVyZXNbY3VycmVudEN1bHR1cmVdLmN1cnJlbmN5LnN5bWJvbCArICcpPyg/OlxcXFwpKT8pPyQnKTtcbiAgICAgICAgICAgICAgICB0cmlsbGlvblJlZ0V4cCA9IG5ldyBSZWdFeHAoJ1teYS16QS1aXScgKyBjdWx0dXJlc1tjdXJyZW50Q3VsdHVyZV0uYWJicmV2aWF0aW9ucy50cmlsbGlvbiArXG4gICAgICAgICAgICAgICAgICAgICcoPzpcXFxcKXwoXFxcXCcgKyBjdWx0dXJlc1tjdXJyZW50Q3VsdHVyZV0uY3VycmVuY3kuc3ltYm9sICsgJyk/KD86XFxcXCkpPyk/JCcpO1xuXG4gICAgICAgICAgICAgICAgLy8gc2VlIGlmIGJ5dGVzIGFyZSB0aGVyZSBzbyB0aGF0IHdlIGNhbiBtdWx0aXBseSB0byB0aGUgY29ycmVjdCBudW1iZXJcbiAgICAgICAgICAgICAgICBmb3IgKHBvd2VyID0gMTsgcG93ZXIgPCBiaW5hcnlTdWZmaXhlcy5sZW5ndGggJiYgIWJ5dGVzTXVsdGlwbGllcjsgKytwb3dlcikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RyaW5nLmluZGV4T2YoYmluYXJ5U3VmZml4ZXNbcG93ZXJdKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBieXRlc011bHRpcGxpZXIgPSBNYXRoLnBvdygxMDI0LCBwb3dlcik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RyaW5nLmluZGV4T2YoZGVjaW1hbFN1ZmZpeGVzW3Bvd2VyXSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnl0ZXNNdWx0aXBsaWVyID0gTWF0aC5wb3coMTAwMCwgcG93ZXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHN0ciA9IHN0cmluZy5yZXBsYWNlKC9bXjAtOVxcLl0rL2csICcnKTtcbiAgICAgICAgICAgICAgICBpZiAoc3RyID09PSAnJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBBbiBlbXB0eSBzdHJpbmcgaXMgbm90IGEgbnVtYmVyLlxuICAgICAgICAgICAgICAgICAgICBuLl92YWx1ZSA9IE5hTjtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGRvIHNvbWUgbWF0aCB0byBjcmVhdGUgb3VyIG51bWJlclxuICAgICAgICAgICAgICAgICAgICBuLl92YWx1ZSA9ICgoYnl0ZXNNdWx0aXBsaWVyKSA/IGJ5dGVzTXVsdGlwbGllciA6IDEpICpcbiAgICAgICAgICAgICAgICAgICAgICAgICgoc3RyaW5nT3JpZ2luYWwubWF0Y2godGhvdXNhbmRSZWdFeHApKSA/IE1hdGgucG93KDEwLCAzKSA6IDEpICpcbiAgICAgICAgICAgICAgICAgICAgICAgICgoc3RyaW5nT3JpZ2luYWwubWF0Y2gobWlsbGlvblJlZ0V4cCkpID8gTWF0aC5wb3coMTAsIDYpIDogMSkgKlxuICAgICAgICAgICAgICAgICAgICAgICAgKChzdHJpbmdPcmlnaW5hbC5tYXRjaChiaWxsaW9uUmVnRXhwKSkgPyBNYXRoLnBvdygxMCwgOSkgOiAxKSAqXG4gICAgICAgICAgICAgICAgICAgICAgICAoKHN0cmluZ09yaWdpbmFsLm1hdGNoKHRyaWxsaW9uUmVnRXhwKSkgPyBNYXRoLnBvdygxMCwgMTIpIDogMSkgKlxuICAgICAgICAgICAgICAgICAgICAgICAgKChzdHJpbmcuaW5kZXhPZignJScpID4gLTEpID8gMC4wMSA6IDEpICpcbiAgICAgICAgICAgICAgICAgICAgICAgICgoKHN0cmluZy5zcGxpdCgnLScpLmxlbmd0aCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oc3RyaW5nLnNwbGl0KCcoJykubGVuZ3RoIC0gMSwgc3RyaW5nLnNwbGl0KCcpJykubGVuZ3RoIC0gMSkpICUgMikgPyAxIDogLTEpICpcbiAgICAgICAgICAgICAgICAgICAgICAgIE51bWJlcihzdHIpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIHJvdW5kIGlmIHdlIGFyZSB0YWxraW5nIGFib3V0IGJ5dGVzXG4gICAgICAgICAgICAgICAgICAgIG4uX3ZhbHVlID0gKGJ5dGVzTXVsdGlwbGllcikgPyBNYXRoLmNlaWwobi5fdmFsdWUpIDogbi5fdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuLl92YWx1ZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmb3JtYXRDdXJyZW5jeShuLCBjdXJyZW5jeVN5bWJvbCwgb3JpZ2luYWxGb3JtYXQsIHJvdW5kaW5nRnVuY3Rpb24pIHtcbiAgICAgICAgdmFyIGZvcm1hdCA9IG9yaWdpbmFsRm9ybWF0LFxuICAgICAgICAgICAgc3ltYm9sSW5kZXggPSBmb3JtYXQuaW5kZXhPZignJCcpLFxuICAgICAgICAgICAgb3BlblBhcmVuSW5kZXggPSBmb3JtYXQuaW5kZXhPZignKCcpLFxuICAgICAgICAgICAgcGx1c1NpZ25JbmRleCA9IGZvcm1hdC5pbmRleE9mKCcrJyksXG4gICAgICAgICAgICBtaW51c1NpZ25JbmRleCA9IGZvcm1hdC5pbmRleE9mKCctJyksXG4gICAgICAgICAgICBzcGFjZSA9ICcnLFxuICAgICAgICAgICAgZGVjaW1hbFNlcGFyYXRvciA9ICcnLFxuICAgICAgICAgICAgc3BsaWNlSW5kZXgsXG4gICAgICAgICAgICBvdXRwdXQ7XG5cbiAgICAgICAgaWYoZm9ybWF0LmluZGV4T2YoJyQnKSA9PT0gLTEpe1xuICAgICAgICAgICAgLy8gVXNlIGRlZmF1bHRzIGluc3RlYWQgb2YgdGhlIGZvcm1hdCBwcm92aWRlZFxuICAgICAgICAgICAgaWYgKGN1bHR1cmVzW2N1cnJlbnRDdWx0dXJlXS5jdXJyZW5jeS5wb3NpdGlvbiA9PT0gJ2luZml4Jykge1xuICAgICAgICAgICAgICAgIGRlY2ltYWxTZXBhcmF0b3IgPSBjdXJyZW5jeVN5bWJvbDtcbiAgICAgICAgICAgICAgICBpZiAoY3VsdHVyZXNbY3VycmVudEN1bHR1cmVdLmN1cnJlbmN5LnNwYWNlU2VwYXJhdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlY2ltYWxTZXBhcmF0b3IgPSAnICcgKyBkZWNpbWFsU2VwYXJhdG9yICsgJyAnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY3VsdHVyZXNbY3VycmVudEN1bHR1cmVdLmN1cnJlbmN5LnNwYWNlU2VwYXJhdGVkKSB7XG4gICAgICAgICAgICAgICAgc3BhY2UgPSAnICc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBjaGVjayBmb3Igc3BhY2UgYmVmb3JlIG9yIGFmdGVyIGN1cnJlbmN5XG4gICAgICAgICAgICBpZiAoZm9ybWF0LmluZGV4T2YoJyAkJykgPiAtMSkge1xuICAgICAgICAgICAgICAgIHNwYWNlID0gJyAnO1xuICAgICAgICAgICAgICAgIGZvcm1hdCA9IGZvcm1hdC5yZXBsYWNlKCcgJCcsICcnKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZm9ybWF0LmluZGV4T2YoJyQgJykgPiAtMSkge1xuICAgICAgICAgICAgICAgIHNwYWNlID0gJyAnO1xuICAgICAgICAgICAgICAgIGZvcm1hdCA9IGZvcm1hdC5yZXBsYWNlKCckICcsICcnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9ybWF0ID0gZm9ybWF0LnJlcGxhY2UoJyQnLCAnJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGb3JtYXQgVGhlIE51bWJlclxuICAgICAgICBvdXRwdXQgPSBmb3JtYXROdW1iZXIobi5fdmFsdWUsIGZvcm1hdCwgcm91bmRpbmdGdW5jdGlvbiwgZGVjaW1hbFNlcGFyYXRvcik7XG5cbiAgICAgICAgaWYgKG9yaWdpbmFsRm9ybWF0LmluZGV4T2YoJyQnKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIC8vIFVzZSBkZWZhdWx0cyBpbnN0ZWFkIG9mIHRoZSBmb3JtYXQgcHJvdmlkZWRcbiAgICAgICAgICAgIHN3aXRjaCAoY3VsdHVyZXNbY3VycmVudEN1bHR1cmVdLmN1cnJlbmN5LnBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAncG9zdGZpeCc6XG4gICAgICAgICAgICAgICAgICAgIGlmIChvdXRwdXQuaW5kZXhPZignKScpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IG91dHB1dC5zcGxpdCgnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQuc3BsaWNlKC0xLCAwLCBzcGFjZSArIGN1cnJlbmN5U3ltYm9sKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IG91dHB1dC5qb2luKCcnKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IG91dHB1dCArIHNwYWNlICsgY3VycmVuY3lTeW1ib2w7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnaW5maXgnOlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdwcmVmaXgnOlxuICAgICAgICAgICAgICAgICAgICBpZiAob3V0cHV0LmluZGV4T2YoJygnKSA+IC0xIHx8IG91dHB1dC5pbmRleE9mKCctJykgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnNwbGl0KCcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwbGljZUluZGV4ID0gTWF0aC5tYXgob3BlblBhcmVuSW5kZXgsIG1pbnVzU2lnbkluZGV4KSArIDE7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dC5zcGxpY2Uoc3BsaWNlSW5kZXgsIDAsIGN1cnJlbmN5U3ltYm9sICsgc3BhY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LmpvaW4oJycpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gY3VycmVuY3lTeW1ib2wgKyBzcGFjZSArIG91dHB1dDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcignQ3VycmVuY3kgcG9zaXRpb24gc2hvdWxkIGJlIGFtb25nIFtcInByZWZpeFwiLCBcImluZml4XCIsIFwicG9zdGZpeFwiXScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gcG9zaXRpb24gdGhlIHN5bWJvbFxuICAgICAgICAgICAgaWYgKHN5bWJvbEluZGV4IDw9IDEpIHtcbiAgICAgICAgICAgICAgICBpZiAob3V0cHV0LmluZGV4T2YoJygnKSA+IC0xIHx8IG91dHB1dC5pbmRleE9mKCcrJykgPiAtMSB8fCBvdXRwdXQuaW5kZXhPZignLScpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnNwbGl0KCcnKTtcbiAgICAgICAgICAgICAgICAgICAgc3BsaWNlSW5kZXggPSAxO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3ltYm9sSW5kZXggPCBvcGVuUGFyZW5JbmRleCB8fCBzeW1ib2xJbmRleCA8IHBsdXNTaWduSW5kZXggfHwgc3ltYm9sSW5kZXggPCBtaW51c1NpZ25JbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHN5bWJvbCBhcHBlYXJzIGJlZm9yZSB0aGUgXCIoXCIsIFwiK1wiIG9yIFwiLVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBzcGxpY2VJbmRleCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0LnNwbGljZShzcGxpY2VJbmRleCwgMCwgY3VycmVuY3lTeW1ib2wgKyBzcGFjZSk7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IG91dHB1dC5qb2luKCcnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSBjdXJyZW5jeVN5bWJvbCArIHNwYWNlICsgb3V0cHV0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKG91dHB1dC5pbmRleE9mKCcpJykgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQuc3BsaXQoJycpO1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQuc3BsaWNlKC0xLCAwLCBzcGFjZSArIGN1cnJlbmN5U3ltYm9sKTtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LmpvaW4oJycpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IG91dHB1dCArIHNwYWNlICsgY3VycmVuY3lTeW1ib2w7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmb3JtYXRGb3JlaWduQ3VycmVuY3kobiwgZm9yZWlnbkN1cnJlbmN5U3ltYm9sLCBvcmlnaW5hbEZvcm1hdCwgcm91bmRpbmdGdW5jdGlvbikge1xuICAgICAgICByZXR1cm4gZm9ybWF0Q3VycmVuY3kobiwgZm9yZWlnbkN1cnJlbmN5U3ltYm9sLCBvcmlnaW5hbEZvcm1hdCwgcm91bmRpbmdGdW5jdGlvbik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZm9ybWF0UGVyY2VudGFnZShuLCBmb3JtYXQsIHJvdW5kaW5nRnVuY3Rpb24pIHtcbiAgICAgICAgdmFyIHNwYWNlID0gJycsXG4gICAgICAgICAgICBvdXRwdXQsXG4gICAgICAgICAgICB2YWx1ZSA9IG4uX3ZhbHVlICogMTAwO1xuXG4gICAgICAgIC8vIGNoZWNrIGZvciBzcGFjZSBiZWZvcmUgJVxuICAgICAgICBpZiAoZm9ybWF0LmluZGV4T2YoJyAlJykgPiAtMSkge1xuICAgICAgICAgICAgc3BhY2UgPSAnICc7XG4gICAgICAgICAgICBmb3JtYXQgPSBmb3JtYXQucmVwbGFjZSgnICUnLCAnJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmb3JtYXQgPSBmb3JtYXQucmVwbGFjZSgnJScsICcnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG91dHB1dCA9IGZvcm1hdE51bWJlcih2YWx1ZSwgZm9ybWF0LCByb3VuZGluZ0Z1bmN0aW9uKTtcblxuICAgICAgICBpZiAob3V0cHV0LmluZGV4T2YoJyknKSA+IC0xKSB7XG4gICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQuc3BsaXQoJycpO1xuICAgICAgICAgICAgb3V0cHV0LnNwbGljZSgtMSwgMCwgc3BhY2UgKyAnJScpO1xuICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LmpvaW4oJycpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0ICsgc3BhY2UgKyAnJSc7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZvcm1hdFRpbWUobikge1xuICAgICAgICB2YXIgaG91cnMgPSBNYXRoLmZsb29yKG4uX3ZhbHVlIC8gNjAgLyA2MCksXG4gICAgICAgICAgICBtaW51dGVzID0gTWF0aC5mbG9vcigobi5fdmFsdWUgLSAoaG91cnMgKiA2MCAqIDYwKSkgLyA2MCksXG4gICAgICAgICAgICBzZWNvbmRzID0gTWF0aC5yb3VuZChuLl92YWx1ZSAtIChob3VycyAqIDYwICogNjApIC0gKG1pbnV0ZXMgKiA2MCkpO1xuICAgICAgICByZXR1cm4gaG91cnMgKyAnOicgK1xuICAgICAgICAgICAgKChtaW51dGVzIDwgMTApID8gJzAnICsgbWludXRlcyA6IG1pbnV0ZXMpICsgJzonICtcbiAgICAgICAgICAgICgoc2Vjb25kcyA8IDEwKSA/ICcwJyArIHNlY29uZHMgOiBzZWNvbmRzKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1bmZvcm1hdFRpbWUoc3RyaW5nKSB7XG4gICAgICAgIHZhciB0aW1lQXJyYXkgPSBzdHJpbmcuc3BsaXQoJzonKSxcbiAgICAgICAgICAgIHNlY29uZHMgPSAwO1xuICAgICAgICAvLyB0dXJuIGhvdXJzIGFuZCBtaW51dGVzIGludG8gc2Vjb25kcyBhbmQgYWRkIHRoZW0gYWxsIHVwXG4gICAgICAgIGlmICh0aW1lQXJyYXkubGVuZ3RoID09PSAzKSB7XG4gICAgICAgICAgICAvLyBob3Vyc1xuICAgICAgICAgICAgc2Vjb25kcyA9IHNlY29uZHMgKyAoTnVtYmVyKHRpbWVBcnJheVswXSkgKiA2MCAqIDYwKTtcbiAgICAgICAgICAgIC8vIG1pbnV0ZXNcbiAgICAgICAgICAgIHNlY29uZHMgPSBzZWNvbmRzICsgKE51bWJlcih0aW1lQXJyYXlbMV0pICogNjApO1xuICAgICAgICAgICAgLy8gc2Vjb25kc1xuICAgICAgICAgICAgc2Vjb25kcyA9IHNlY29uZHMgKyBOdW1iZXIodGltZUFycmF5WzJdKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aW1lQXJyYXkubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAvLyBtaW51dGVzXG4gICAgICAgICAgICBzZWNvbmRzID0gc2Vjb25kcyArIChOdW1iZXIodGltZUFycmF5WzBdKSAqIDYwKTtcbiAgICAgICAgICAgIC8vIHNlY29uZHNcbiAgICAgICAgICAgIHNlY29uZHMgPSBzZWNvbmRzICsgTnVtYmVyKHRpbWVBcnJheVsxXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE51bWJlcihzZWNvbmRzKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmb3JtYXRCeXRlVW5pdHMgKHZhbHVlLCBzdWZmaXhlcywgc2NhbGUpIHtcbiAgICAgICAgdmFyIHN1ZmZpeCA9IHN1ZmZpeGVzWzBdLFxuICAgICAgICAgICAgcG93ZXIsXG4gICAgICAgICAgICBtaW4sXG4gICAgICAgICAgICBtYXgsXG4gICAgICAgICAgICBhYnMgPSBNYXRoLmFicyh2YWx1ZSk7XG5cbiAgICAgICAgaWYgKGFicyA+PSBzY2FsZSkge1xuICAgICAgICAgICAgZm9yIChwb3dlciA9IDE7IHBvd2VyIDwgc3VmZml4ZXMubGVuZ3RoOyArK3Bvd2VyKSB7XG4gICAgICAgICAgICAgICAgbWluID0gTWF0aC5wb3coc2NhbGUsIHBvd2VyKTtcbiAgICAgICAgICAgICAgICBtYXggPSBNYXRoLnBvdyhzY2FsZSwgcG93ZXIgKyAxKTtcblxuICAgICAgICAgICAgICAgIGlmIChhYnMgPj0gbWluICYmIGFicyA8IG1heCkge1xuICAgICAgICAgICAgICAgICAgICBzdWZmaXggPSBzdWZmaXhlc1twb3dlcl07XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgLyBtaW47XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gdmFsdWVzIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byBbc2NhbGVdIFlCIG5ldmVyIHNldCB0aGUgc3VmZml4XG4gICAgICAgICAgICBpZiAoc3VmZml4ID09PSBzdWZmaXhlc1swXSkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgLyBNYXRoLnBvdyhzY2FsZSwgc3VmZml4ZXMubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICAgICAgc3VmZml4ID0gc3VmZml4ZXNbc3VmZml4ZXMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyB2YWx1ZTogdmFsdWUsIHN1ZmZpeDogc3VmZml4IH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZm9ybWF0TnVtYmVyICh2YWx1ZSwgZm9ybWF0LCByb3VuZGluZ0Z1bmN0aW9uLCBzZXApIHtcbiAgICAgICAgdmFyIG5lZ1AgPSBmYWxzZSxcbiAgICAgICAgICAgIHNpZ25lZCA9IGZhbHNlLFxuICAgICAgICAgICAgb3B0RGVjID0gZmFsc2UsXG4gICAgICAgICAgICBhYmJyID0gJycsXG4gICAgICAgICAgICBhYmJySyA9IGZhbHNlLCAvLyBmb3JjZSBhYmJyZXZpYXRpb24gdG8gdGhvdXNhbmRzXG4gICAgICAgICAgICBhYmJyTSA9IGZhbHNlLCAvLyBmb3JjZSBhYmJyZXZpYXRpb24gdG8gbWlsbGlvbnNcbiAgICAgICAgICAgIGFiYnJCID0gZmFsc2UsIC8vIGZvcmNlIGFiYnJldmlhdGlvbiB0byBiaWxsaW9uc1xuICAgICAgICAgICAgYWJiclQgPSBmYWxzZSwgLy8gZm9yY2UgYWJicmV2aWF0aW9uIHRvIHRyaWxsaW9uc1xuICAgICAgICAgICAgYWJickZvcmNlID0gZmFsc2UsIC8vIGZvcmNlIGFiYnJldmlhdGlvblxuICAgICAgICAgICAgYnl0ZXMgPSAnJyxcbiAgICAgICAgICAgIGJ5dGVGb3JtYXQsXG4gICAgICAgICAgICB1bml0cyxcbiAgICAgICAgICAgIG9yZCA9ICcnLFxuICAgICAgICAgICAgYWJzID0gTWF0aC5hYnModmFsdWUpLFxuICAgICAgICAgICAgdG90YWxMZW5ndGgsXG4gICAgICAgICAgICBsZW5ndGgsXG4gICAgICAgICAgICBtaW5pbXVtUHJlY2lzaW9uLFxuICAgICAgICAgICAgcG93LFxuICAgICAgICAgICAgdyxcbiAgICAgICAgICAgIGludFByZWNpc2lvbixcbiAgICAgICAgICAgIHByZWNpc2lvbixcbiAgICAgICAgICAgIHByZWZpeCxcbiAgICAgICAgICAgIHBvc3RmaXgsXG4gICAgICAgICAgICB0aG91c2FuZHMsXG4gICAgICAgICAgICBkID0gJycsXG4gICAgICAgICAgICBmb3JjZWROZWcgPSBmYWxzZSxcbiAgICAgICAgICAgIG5lZyA9IGZhbHNlLFxuICAgICAgICAgICAgaW5kZXhPcGVuUCxcbiAgICAgICAgICAgIGluZGV4TWludXMsXG4gICAgICAgICAgICBwYXJlbiA9ICcnLFxuICAgICAgICAgICAgbWlubGVuLFxuICAgICAgICAgICAgaTtcblxuICAgICAgICAvLyBjaGVjayBpZiBudW1iZXIgaXMgemVybyBhbmQgYSBjdXN0b20gemVybyBmb3JtYXQgaGFzIGJlZW4gc2V0XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gMCAmJiB6ZXJvRm9ybWF0ICE9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gemVyb0Zvcm1hdDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaXNGaW5pdGUodmFsdWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gJycgKyB2YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChmb3JtYXQuaW5kZXhPZigneycpID09PSAwKSB7XG4gICAgICAgICAgICB2YXIgZW5kID0gZm9ybWF0LmluZGV4T2YoJ30nKTtcbiAgICAgICAgICAgIGlmIChlbmQgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ0Zvcm1hdCBzaG91bGQgYWxzbyBjb250YWluIGEgXCJ9XCInKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHByZWZpeCA9IGZvcm1hdC5zbGljZSgxLCBlbmQpO1xuICAgICAgICAgICAgZm9ybWF0ID0gZm9ybWF0LnNsaWNlKGVuZCArIDEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcHJlZml4ID0gJyc7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZm9ybWF0LmluZGV4T2YoJ30nKSA9PT0gZm9ybWF0Lmxlbmd0aCAtIDEgJiYgZm9ybWF0Lmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gZm9ybWF0LmluZGV4T2YoJ3snKTtcbiAgICAgICAgICAgIGlmIChzdGFydCA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBFcnJvcignRm9ybWF0IHNob3VsZCBhbHNvIGNvbnRhaW4gYSBcIntcIicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcG9zdGZpeCA9IGZvcm1hdC5zbGljZShzdGFydCArIDEsIC0xKTtcbiAgICAgICAgICAgIGZvcm1hdCA9IGZvcm1hdC5zbGljZSgwLCBzdGFydCArIDEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcG9zdGZpeCA9ICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY2hlY2sgZm9yIG1pbiBsZW5ndGhcbiAgICAgICAgdmFyIGluZm87XG4gICAgICAgIGlmIChmb3JtYXQuaW5kZXhPZignLicpID09PSAtMSkge1xuICAgICAgICAgICAgaW5mbyA9IGZvcm1hdC5tYXRjaCgvKFswLTldKykuKi8pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5mbyA9IGZvcm1hdC5tYXRjaCgvKFswLTldKylcXC4uKi8pO1xuICAgICAgICB9XG4gICAgICAgIG1pbmxlbiA9IGluZm8gPT09IG51bGwgPyAtMSA6IGluZm9bMV0ubGVuZ3RoO1xuXG4gICAgICAgIC8vIHNlZSBpZiB3ZSBzaG91bGQgdXNlIHBhcmVudGhlc2VzIGZvciBuZWdhdGl2ZSBudW1iZXIgb3IgaWYgd2Ugc2hvdWxkIHByZWZpeCB3aXRoIGEgc2lnblxuICAgICAgICAvLyBpZiBib3RoIGFyZSBwcmVzZW50IHdlIGRlZmF1bHQgdG8gcGFyZW50aGVzZXNcbiAgICAgICAgaWYgKGZvcm1hdC5pbmRleE9mKCctJykgIT09IC0xKSB7XG4gICAgICAgICAgICBmb3JjZWROZWcgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmb3JtYXQuaW5kZXhPZignKCcpID4gLTEpIHtcbiAgICAgICAgICAgIG5lZ1AgPSB0cnVlO1xuICAgICAgICAgICAgZm9ybWF0ID0gZm9ybWF0LnNsaWNlKDEsIC0xKTtcbiAgICAgICAgfSBlbHNlIGlmIChmb3JtYXQuaW5kZXhPZignKycpID4gLTEpIHtcbiAgICAgICAgICAgIHNpZ25lZCA9IHRydWU7XG4gICAgICAgICAgICBmb3JtYXQgPSBmb3JtYXQucmVwbGFjZSgvXFwrL2csICcnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHNlZSBpZiBhYmJyZXZpYXRpb24gaXMgd2FudGVkXG4gICAgICAgIGlmIChmb3JtYXQuaW5kZXhPZignYScpID4gLTEpIHtcbiAgICAgICAgICAgIGludFByZWNpc2lvbiA9IGZvcm1hdC5zcGxpdCgnLicpWzBdLm1hdGNoKC9bMC05XSsvZykgfHwgWycwJ107XG4gICAgICAgICAgICBpbnRQcmVjaXNpb24gPSBwYXJzZUludChpbnRQcmVjaXNpb25bMF0sIDEwKTtcblxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgYWJicmV2aWF0aW9uIGlzIHNwZWNpZmllZFxuICAgICAgICAgICAgYWJicksgPSBmb3JtYXQuaW5kZXhPZignYUsnKSA+PSAwO1xuICAgICAgICAgICAgYWJick0gPSBmb3JtYXQuaW5kZXhPZignYU0nKSA+PSAwO1xuICAgICAgICAgICAgYWJickIgPSBmb3JtYXQuaW5kZXhPZignYUInKSA+PSAwO1xuICAgICAgICAgICAgYWJiclQgPSBmb3JtYXQuaW5kZXhPZignYVQnKSA+PSAwO1xuICAgICAgICAgICAgYWJickZvcmNlID0gYWJicksgfHwgYWJick0gfHwgYWJickIgfHwgYWJiclQ7XG5cbiAgICAgICAgICAgIC8vIGNoZWNrIGZvciBzcGFjZSBiZWZvcmUgYWJicmV2aWF0aW9uXG4gICAgICAgICAgICBpZiAoZm9ybWF0LmluZGV4T2YoJyBhJykgPiAtMSkge1xuICAgICAgICAgICAgICAgIGFiYnIgPSAnICc7XG4gICAgICAgICAgICAgICAgZm9ybWF0ID0gZm9ybWF0LnJlcGxhY2UoJyBhJywgJycpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3JtYXQgPSBmb3JtYXQucmVwbGFjZSgnYScsICcnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdG90YWxMZW5ndGggPSBudW1iZXJMZW5ndGgodmFsdWUpO1xuICAgICAgICAgICAgbWluaW11bVByZWNpc2lvbiA9IHRvdGFsTGVuZ3RoICUgMztcbiAgICAgICAgICAgIG1pbmltdW1QcmVjaXNpb24gPSBtaW5pbXVtUHJlY2lzaW9uID09PSAwID8gMyA6IG1pbmltdW1QcmVjaXNpb247XG5cbiAgICAgICAgICAgIGlmIChpbnRQcmVjaXNpb24gJiYgYWJzICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgcG93ID0gMyAqIH5+KChNYXRoLm1pbihpbnRQcmVjaXNpb24sIHRvdGFsTGVuZ3RoKSAtIG1pbmltdW1QcmVjaXNpb24pIC8gMyk7XG4gICAgICAgICAgICAgICAgYWJzID0gYWJzIC8gTWF0aC5wb3coMTAsIHBvdyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0b3RhbExlbmd0aCAhPT0gaW50UHJlY2lzaW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFicyA+PSBNYXRoLnBvdygxMCwgMTIpICYmICFhYmJyRm9yY2UgfHwgYWJiclQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdHJpbGxpb25cbiAgICAgICAgICAgICAgICAgICAgYWJiciA9IGFiYnIgKyBjdWx0dXJlc1tjdXJyZW50Q3VsdHVyZV0uYWJicmV2aWF0aW9ucy50cmlsbGlvbjtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSAvIE1hdGgucG93KDEwLCAxMik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYnMgPCBNYXRoLnBvdygxMCwgMTIpICYmIGFicyA+PSBNYXRoLnBvdygxMCwgOSkgJiYgIWFiYnJGb3JjZSB8fCBhYmJyQikge1xuICAgICAgICAgICAgICAgICAgICAvLyBiaWxsaW9uXG4gICAgICAgICAgICAgICAgICAgIGFiYnIgPSBhYmJyICsgY3VsdHVyZXNbY3VycmVudEN1bHR1cmVdLmFiYnJldmlhdGlvbnMuYmlsbGlvbjtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSAvIE1hdGgucG93KDEwLCA5KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFicyA8IE1hdGgucG93KDEwLCA5KSAmJiBhYnMgPj0gTWF0aC5wb3coMTAsIDYpICYmICFhYmJyRm9yY2UgfHwgYWJick0pIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbWlsbGlvblxuICAgICAgICAgICAgICAgICAgICBhYmJyID0gYWJiciArIGN1bHR1cmVzW2N1cnJlbnRDdWx0dXJlXS5hYmJyZXZpYXRpb25zLm1pbGxpb247XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgLyBNYXRoLnBvdygxMCwgNik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYnMgPCBNYXRoLnBvdygxMCwgNikgJiYgYWJzID49IE1hdGgucG93KDEwLCAzKSAmJiAhYWJickZvcmNlIHx8IGFiYnJLKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRob3VzYW5kXG4gICAgICAgICAgICAgICAgICAgIGFiYnIgPSBhYmJyICsgY3VsdHVyZXNbY3VycmVudEN1bHR1cmVdLmFiYnJldmlhdGlvbnMudGhvdXNhbmQ7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgLyBNYXRoLnBvdygxMCwgMyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZW5ndGggPSBudW1iZXJMZW5ndGgodmFsdWUpO1xuICAgICAgICAgICAgaWYgKGludFByZWNpc2lvbiAmJiBsZW5ndGggPCBpbnRQcmVjaXNpb24gJiYgZm9ybWF0LmluZGV4T2YoJy4nKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICBmb3JtYXQgKz0gJ1suXSc7XG4gICAgICAgICAgICAgICAgZm9ybWF0ICs9IHplcm9lcyhpbnRQcmVjaXNpb24gLSBsZW5ndGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gc2VlIGlmIHdlIGFyZSBmb3JtYXR0aW5nXG4gICAgICAgIC8vICAgYmluYXJ5LWRlY2ltYWwgYnl0ZXMgKDEwMjQgTUIpLCBiaW5hcnkgYnl0ZXMgKDEwMjQgTWlCKSwgb3IgZGVjaW1hbCBieXRlcyAoMTAwMCBNQilcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGJ5dGVGb3JtYXRPcmRlci5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgYnl0ZUZvcm1hdCA9IGJ5dGVGb3JtYXRPcmRlcltpXTtcblxuICAgICAgICAgICAgaWYgKGZvcm1hdC5pbmRleE9mKGJ5dGVGb3JtYXQubWFya2VyKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgZm9yIHNwYWNlIGJlZm9yZVxuICAgICAgICAgICAgICAgIGlmIChmb3JtYXQuaW5kZXhPZignICcgKyBieXRlRm9ybWF0Lm1hcmtlcikgPi0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGJ5dGVzID0gJyAnO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSB0aGUgbWFya2VyICh3aXRoIHRoZSBzcGFjZSBpZiBpdCBoYWQgb25lKVxuICAgICAgICAgICAgICAgIGZvcm1hdCA9IGZvcm1hdC5yZXBsYWNlKGJ5dGVzICsgYnl0ZUZvcm1hdC5tYXJrZXIsICcnKTtcblxuICAgICAgICAgICAgICAgIHVuaXRzID0gZm9ybWF0Qnl0ZVVuaXRzKHZhbHVlLCBieXRlRm9ybWF0LnN1ZmZpeGVzLCBieXRlRm9ybWF0LnNjYWxlKTtcblxuICAgICAgICAgICAgICAgIHZhbHVlID0gdW5pdHMudmFsdWU7XG4gICAgICAgICAgICAgICAgYnl0ZXMgPSBieXRlcyArIHVuaXRzLnN1ZmZpeDtcblxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gc2VlIGlmIG9yZGluYWwgaXMgd2FudGVkXG4gICAgICAgIGlmIChmb3JtYXQuaW5kZXhPZignbycpID4gLTEpIHtcbiAgICAgICAgICAgIC8vIGNoZWNrIGZvciBzcGFjZSBiZWZvcmVcbiAgICAgICAgICAgIGlmIChmb3JtYXQuaW5kZXhPZignIG8nKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgb3JkID0gJyAnO1xuICAgICAgICAgICAgICAgIGZvcm1hdCA9IGZvcm1hdC5yZXBsYWNlKCcgbycsICcnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9ybWF0ID0gZm9ybWF0LnJlcGxhY2UoJ28nLCAnJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjdWx0dXJlc1tjdXJyZW50Q3VsdHVyZV0ub3JkaW5hbCkge1xuICAgICAgICAgICAgICAgIG9yZCA9IG9yZCArIGN1bHR1cmVzW2N1cnJlbnRDdWx0dXJlXS5vcmRpbmFsKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChmb3JtYXQuaW5kZXhPZignWy5dJykgPiAtMSkge1xuICAgICAgICAgICAgb3B0RGVjID0gdHJ1ZTtcbiAgICAgICAgICAgIGZvcm1hdCA9IGZvcm1hdC5yZXBsYWNlKCdbLl0nLCAnLicpO1xuICAgICAgICB9XG5cbiAgICAgICAgcHJlY2lzaW9uID0gZm9ybWF0LnNwbGl0KCcuJylbMV07XG4gICAgICAgIHRob3VzYW5kcyA9IGZvcm1hdC5pbmRleE9mKCcsJyk7XG5cbiAgICAgICAgaWYgKHByZWNpc2lvbikge1xuICAgICAgICAgICAgdmFyIGRTcGxpdCA9IFtdO1xuXG4gICAgICAgICAgICBpZiAocHJlY2lzaW9uLmluZGV4T2YoJyonKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBkID0gdmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICBkU3BsaXQgPSBkLnNwbGl0KCcuJyk7XG4gICAgICAgICAgICAgICAgaWYgKGRTcGxpdC5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGQgPSB0b0ZpeGVkKHZhbHVlLCBkU3BsaXRbMV0ubGVuZ3RoLCByb3VuZGluZ0Z1bmN0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChwcmVjaXNpb24uaW5kZXhPZignWycpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJlY2lzaW9uID0gcHJlY2lzaW9uLnJlcGxhY2UoJ10nLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgIHByZWNpc2lvbiA9IHByZWNpc2lvbi5zcGxpdCgnWycpO1xuICAgICAgICAgICAgICAgICAgICBkID0gdG9GaXhlZCh2YWx1ZSwgKHByZWNpc2lvblswXS5sZW5ndGggKyBwcmVjaXNpb25bMV0ubGVuZ3RoKSwgcm91bmRpbmdGdW5jdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWNpc2lvblsxXS5sZW5ndGgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGQgPSB0b0ZpeGVkKHZhbHVlLCBwcmVjaXNpb24ubGVuZ3RoLCByb3VuZGluZ0Z1bmN0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGRTcGxpdCA9IGQuc3BsaXQoJy4nKTtcbiAgICAgICAgICAgIHcgPSBkU3BsaXRbMF07XG5cbiAgICAgICAgICAgIGlmIChkU3BsaXQubGVuZ3RoID4gMSAmJiBkU3BsaXRbMV0ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHAgPSBzZXAgPyBhYmJyICsgc2VwIDogY3VsdHVyZXNbY3VycmVudEN1bHR1cmVdLmRlbGltaXRlcnMuZGVjaW1hbDtcbiAgICAgICAgICAgICAgICBkID0gcCArIGRTcGxpdFsxXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZCA9ICcnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAob3B0RGVjICYmIE51bWJlcihkLnNsaWNlKDEpKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGQgPSAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHcgPSB0b0ZpeGVkKHZhbHVlLCAwLCByb3VuZGluZ0Z1bmN0aW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGZvcm1hdCBudW1iZXJcbiAgICAgICAgaWYgKHcuaW5kZXhPZignLScpID4gLTEpIHtcbiAgICAgICAgICAgIHcgPSB3LnNsaWNlKDEpO1xuICAgICAgICAgICAgbmVnID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh3Lmxlbmd0aCA8IG1pbmxlbikge1xuICAgICAgICAgICAgdyA9IHplcm9lcyhtaW5sZW4gLSB3Lmxlbmd0aCkgKyB3O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRob3VzYW5kcyA+IC0xKSB7XG4gICAgICAgICAgICB3ID0gdy50b1N0cmluZygpLnJlcGxhY2UoLyhcXGQpKD89KFxcZHszfSkrKD8hXFxkKSkvZywgJyQxJyArXG4gICAgICAgICAgICAgICAgY3VsdHVyZXNbY3VycmVudEN1bHR1cmVdLmRlbGltaXRlcnMudGhvdXNhbmRzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChmb3JtYXQuaW5kZXhPZignLicpID09PSAwKSB7XG4gICAgICAgICAgICB3ID0gJyc7XG4gICAgICAgIH1cblxuICAgICAgICBpbmRleE9wZW5QID0gZm9ybWF0LmluZGV4T2YoJygnKTtcbiAgICAgICAgaW5kZXhNaW51cyA9IGZvcm1hdC5pbmRleE9mKCctJyk7XG5cbiAgICAgICAgaWYgKGluZGV4T3BlblAgPCBpbmRleE1pbnVzKSB7XG4gICAgICAgICAgICBwYXJlbiA9ICgobmVnUCAmJiBuZWcpID8gJygnIDogJycpICsgKCgoZm9yY2VkTmVnICYmIG5lZykgfHwgKCFuZWdQICYmIG5lZykpID8gJy0nIDogJycpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGFyZW4gPSAoKChmb3JjZWROZWcgJiYgbmVnKSB8fCAoIW5lZ1AgJiYgbmVnKSkgPyAnLScgOiAnJykgKyAoKG5lZ1AgJiYgbmVnKSA/ICcoJyA6ICcnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBwcmVmaXggK1xuICAgICAgICAgICAgcGFyZW4gKyAoKCFuZWcgJiYgc2lnbmVkICYmIHZhbHVlICE9PSAwKSA/ICcrJyA6ICcnKSArXG4gICAgICAgICAgICB3ICsgZCArXG4gICAgICAgICAgICAoKG9yZCkgPyBvcmQgOiAnJykgK1xuICAgICAgICAgICAgKChhYmJyICYmICFzZXApID8gYWJiciA6ICcnKSArXG4gICAgICAgICAgICAoKGJ5dGVzKSA/IGJ5dGVzIDogJycpICtcbiAgICAgICAgICAgICgobmVnUCAmJiBuZWcpID8gJyknIDogJycpICtcbiAgICAgICAgICAgIHBvc3RmaXg7XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBUb3AgTGV2ZWwgRnVuY3Rpb25zXG4gICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgbnVtYnJvID0gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgICAgaWYgKG51bWJyby5pc051bWJybyhpbnB1dCkpIHtcbiAgICAgICAgICAgIGlucHV0ID0gaW5wdXQudmFsdWUoKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgaW5wdXQgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBpbnB1dCA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIGlucHV0ID0gbnVtYnJvLmZuLnVuZm9ybWF0KGlucHV0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlucHV0ID0gTmFOO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5ldyBOdW1icm8oTnVtYmVyKGlucHV0KSk7XG4gICAgfTtcblxuICAgIC8vIHZlcnNpb24gbnVtYmVyXG4gICAgbnVtYnJvLnZlcnNpb24gPSBWRVJTSU9OO1xuXG4gICAgLy8gY29tcGFyZSBudW1icm8gb2JqZWN0XG4gICAgbnVtYnJvLmlzTnVtYnJvID0gZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgIHJldHVybiBvYmogaW5zdGFuY2VvZiBOdW1icm87XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgZnVuY3Rpb24gYWxsb3cgdGhlIHVzZXIgdG8gc2V0IGEgbmV3IGxhbmd1YWdlIHdpdGggYSBmYWxsYmFjayBpZlxuICAgICAqIHRoZSBsYW5ndWFnZSBkb2VzIG5vdCBleGlzdC4gSWYgbm8gZmFsbGJhY2sgbGFuZ3VhZ2UgaXMgcHJvdmlkZWQsXG4gICAgICogaXQgZmFsbGJhY2tzIHRvIGVuZ2xpc2guXG4gICAgICpcbiAgICAgKiBAZGVwcmVjYXRlZCBTaW5jZSBpbiB2ZXJzaW9uIDEuNi4wLiBJdCB3aWxsIGJlIGRlbGV0ZWQgaW4gdmVyc2lvbiAyLjBcbiAgICAgKiBgc2V0Q3VsdHVyZWAgc2hvdWxkIGJlIHVzZWQgaW5zdGVhZC5cbiAgICAgKi9cbiAgICBudW1icm8uc2V0TGFuZ3VhZ2UgPSBmdW5jdGlvbihuZXdMYW5ndWFnZSwgZmFsbGJhY2tMYW5ndWFnZSkge1xuICAgICAgICBjb25zb2xlLndhcm4oJ2BzZXRMYW5ndWFnZWAgaXMgZGVwcmVjYXRlZCBzaW5jZSB2ZXJzaW9uIDEuNi4wLiBVc2UgYHNldEN1bHR1cmVgIGluc3RlYWQnKTtcbiAgICAgICAgdmFyIGtleSA9IG5ld0xhbmd1YWdlLFxuICAgICAgICAgICAgcHJlZml4ID0gbmV3TGFuZ3VhZ2Uuc3BsaXQoJy0nKVswXSxcbiAgICAgICAgICAgIG1hdGNoaW5nTGFuZ3VhZ2UgPSBudWxsO1xuICAgICAgICBpZiAoIWxhbmd1YWdlc1trZXldKSB7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhsYW5ndWFnZXMpLmZvckVhY2goZnVuY3Rpb24obGFuZ3VhZ2UpIHtcbiAgICAgICAgICAgICAgICBpZiAoIW1hdGNoaW5nTGFuZ3VhZ2UgJiYgbGFuZ3VhZ2Uuc3BsaXQoJy0nKVswXSA9PT0gcHJlZml4KSB7XG4gICAgICAgICAgICAgICAgICAgIG1hdGNoaW5nTGFuZ3VhZ2UgPSBsYW5ndWFnZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGtleSA9IG1hdGNoaW5nTGFuZ3VhZ2UgfHwgZmFsbGJhY2tMYW5ndWFnZSB8fCAnZW4tVVMnO1xuICAgICAgICB9XG4gICAgICAgIGNob29zZUN1bHR1cmUoa2V5KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogVGhpcyBmdW5jdGlvbiBhbGxvdyB0aGUgdXNlciB0byBzZXQgYSBuZXcgY3VsdHVyZSB3aXRoIGEgZmFsbGJhY2sgaWZcbiAgICAgKiB0aGUgY3VsdHVyZSBkb2VzIG5vdCBleGlzdC4gSWYgbm8gZmFsbGJhY2sgY3VsdHVyZSBpcyBwcm92aWRlZCxcbiAgICAgKiBpdCBmYWxscyBiYWNrIHRvIFwiZW4tVVNcIi5cbiAgICAgKi9cbiAgICBudW1icm8uc2V0Q3VsdHVyZSA9IGZ1bmN0aW9uKG5ld0N1bHR1cmUsIGZhbGxiYWNrQ3VsdHVyZSkge1xuICAgICAgICB2YXIga2V5ID0gbmV3Q3VsdHVyZSxcbiAgICAgICAgICAgIHN1ZmZpeCA9IG5ld0N1bHR1cmUuc3BsaXQoJy0nKVsxXSxcbiAgICAgICAgICAgIG1hdGNoaW5nQ3VsdHVyZSA9IG51bGw7XG4gICAgICAgIGlmICghY3VsdHVyZXNba2V5XSkge1xuICAgICAgICAgICAgaWYgKHN1ZmZpeCkge1xuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGN1bHR1cmVzKS5mb3JFYWNoKGZ1bmN0aW9uKGxhbmd1YWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghbWF0Y2hpbmdDdWx0dXJlICYmIGxhbmd1YWdlLnNwbGl0KCctJylbMV0gPT09IHN1ZmZpeCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hpbmdDdWx0dXJlID0gbGFuZ3VhZ2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAga2V5ID0gbWF0Y2hpbmdDdWx0dXJlIHx8IGZhbGxiYWNrQ3VsdHVyZSB8fCAnZW4tVVMnO1xuICAgICAgICB9XG4gICAgICAgIGNob29zZUN1bHR1cmUoa2V5KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogVGhpcyBmdW5jdGlvbiB3aWxsIGxvYWQgbGFuZ3VhZ2VzIGFuZCB0aGVuIHNldCB0aGUgZ2xvYmFsIGxhbmd1YWdlLiAgSWZcbiAgICAgKiBubyBhcmd1bWVudHMgYXJlIHBhc3NlZCBpbiwgaXQgd2lsbCBzaW1wbHkgcmV0dXJuIHRoZSBjdXJyZW50IGdsb2JhbFxuICAgICAqIGxhbmd1YWdlIGtleS5cbiAgICAgKlxuICAgICAqIEBkZXByZWNhdGVkIFNpbmNlIGluIHZlcnNpb24gMS42LjAuIEl0IHdpbGwgYmUgZGVsZXRlZCBpbiB2ZXJzaW9uIDIuMFxuICAgICAqIGBjdWx0dXJlYCBzaG91bGQgYmUgdXNlZCBpbnN0ZWFkLlxuICAgICAqL1xuICAgIG51bWJyby5sYW5ndWFnZSA9IGZ1bmN0aW9uKGtleSwgdmFsdWVzKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignYGxhbmd1YWdlYCBpcyBkZXByZWNhdGVkIHNpbmNlIHZlcnNpb24gMS42LjAuIFVzZSBgY3VsdHVyZWAgaW5zdGVhZCcpO1xuXG4gICAgICAgIGlmICgha2V5KSB7XG4gICAgICAgICAgICByZXR1cm4gY3VycmVudEN1bHR1cmU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoa2V5ICYmICF2YWx1ZXMpIHtcbiAgICAgICAgICAgIGlmICghbGFuZ3VhZ2VzW2tleV0pIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gbGFuZ3VhZ2UgOiAnICsga2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNob29zZUN1bHR1cmUoa2V5KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh2YWx1ZXMgfHwgIWxhbmd1YWdlc1trZXldKSB7XG4gICAgICAgICAgICBzZXRDdWx0dXJlKGtleSwgdmFsdWVzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBudW1icm87XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgZnVuY3Rpb24gd2lsbCBsb2FkIGN1bHR1cmVzIGFuZCB0aGVuIHNldCB0aGUgZ2xvYmFsIGN1bHR1cmUuICBJZlxuICAgICAqIG5vIGFyZ3VtZW50cyBhcmUgcGFzc2VkIGluLCBpdCB3aWxsIHNpbXBseSByZXR1cm4gdGhlIGN1cnJlbnQgZ2xvYmFsXG4gICAgICogY3VsdHVyZSBjb2RlLlxuICAgICAqL1xuICAgIG51bWJyby5jdWx0dXJlID0gZnVuY3Rpb24oY29kZSwgdmFsdWVzKSB7XG4gICAgICAgIGlmICghY29kZSkge1xuICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnRDdWx0dXJlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvZGUgJiYgIXZhbHVlcykge1xuICAgICAgICAgICAgaWYgKCFjdWx0dXJlc1tjb2RlXSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5rbm93biBjdWx0dXJlIDogJyArIGNvZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2hvb3NlQ3VsdHVyZShjb2RlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh2YWx1ZXMgfHwgIWN1bHR1cmVzW2NvZGVdKSB7XG4gICAgICAgICAgICBzZXRDdWx0dXJlKGNvZGUsIHZhbHVlcyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbnVtYnJvO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIHByb3ZpZGVzIGFjY2VzcyB0byB0aGUgbG9hZGVkIGxhbmd1YWdlIGRhdGEuICBJZlxuICAgICAqIG5vIGFyZ3VtZW50cyBhcmUgcGFzc2VkIGluLCBpdCB3aWxsIHNpbXBseSByZXR1cm4gdGhlIGN1cnJlbnRcbiAgICAgKiBnbG9iYWwgbGFuZ3VhZ2Ugb2JqZWN0LlxuICAgICAqXG4gICAgICogQGRlcHJlY2F0ZWQgU2luY2UgaW4gdmVyc2lvbiAxLjYuMC4gSXQgd2lsbCBiZSBkZWxldGVkIGluIHZlcnNpb24gMi4wXG4gICAgICogYGN1bHR1cmVgIHNob3VsZCBiZSB1c2VkIGluc3RlYWQuXG4gICAgICovXG4gICAgbnVtYnJvLmxhbmd1YWdlRGF0YSA9IGZ1bmN0aW9uKGtleSkge1xuICAgICAgICBjb25zb2xlLndhcm4oJ2BsYW5ndWFnZURhdGFgIGlzIGRlcHJlY2F0ZWQgc2luY2UgdmVyc2lvbiAxLjYuMC4gVXNlIGBjdWx0dXJlRGF0YWAgaW5zdGVhZCcpO1xuXG4gICAgICAgIGlmICgha2V5KSB7XG4gICAgICAgICAgICByZXR1cm4gbGFuZ3VhZ2VzW2N1cnJlbnRDdWx0dXJlXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghbGFuZ3VhZ2VzW2tleV0pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5rbm93biBsYW5ndWFnZSA6ICcgKyBrZXkpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGxhbmd1YWdlc1trZXldO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIHByb3ZpZGVzIGFjY2VzcyB0byB0aGUgbG9hZGVkIGN1bHR1cmUgZGF0YS4gIElmXG4gICAgICogbm8gYXJndW1lbnRzIGFyZSBwYXNzZWQgaW4sIGl0IHdpbGwgc2ltcGx5IHJldHVybiB0aGUgY3VycmVudFxuICAgICAqIGdsb2JhbCBjdWx0dXJlIG9iamVjdC5cbiAgICAgKi9cbiAgICBudW1icm8uY3VsdHVyZURhdGEgPSBmdW5jdGlvbihjb2RlKSB7XG4gICAgICAgIGlmICghY29kZSkge1xuICAgICAgICAgICAgcmV0dXJuIGN1bHR1cmVzW2N1cnJlbnRDdWx0dXJlXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghY3VsdHVyZXNbY29kZV0pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5rbm93biBjdWx0dXJlIDogJyArIGNvZGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGN1bHR1cmVzW2NvZGVdO1xuICAgIH07XG5cbiAgICBudW1icm8uY3VsdHVyZSgnZW4tVVMnLCBlblVTKTtcblxuICAgIC8qKlxuICAgICAqIEBkZXByZWNhdGVkIFNpbmNlIGluIHZlcnNpb24gMS42LjAuIEl0IHdpbGwgYmUgZGVsZXRlZCBpbiB2ZXJzaW9uIDIuMFxuICAgICAqIGBjdWx0dXJlc2Agc2hvdWxkIGJlIHVzZWQgaW5zdGVhZC5cbiAgICAgKi9cbiAgICBudW1icm8ubGFuZ3VhZ2VzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignYGxhbmd1YWdlc2AgaXMgZGVwcmVjYXRlZCBzaW5jZSB2ZXJzaW9uIDEuNi4wLiBVc2UgYGN1bHR1cmVzYCBpbnN0ZWFkJyk7XG5cbiAgICAgICAgcmV0dXJuIGxhbmd1YWdlcztcbiAgICB9O1xuXG4gICAgbnVtYnJvLmN1bHR1cmVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBjdWx0dXJlcztcbiAgICB9O1xuXG4gICAgbnVtYnJvLnplcm9Gb3JtYXQgPSBmdW5jdGlvbihmb3JtYXQpIHtcbiAgICAgICAgemVyb0Zvcm1hdCA9IHR5cGVvZihmb3JtYXQpID09PSAnc3RyaW5nJyA/IGZvcm1hdCA6IG51bGw7XG4gICAgfTtcblxuICAgIG51bWJyby5kZWZhdWx0Rm9ybWF0ID0gZnVuY3Rpb24oZm9ybWF0KSB7XG4gICAgICAgIGRlZmF1bHRGb3JtYXQgPSB0eXBlb2YoZm9ybWF0KSA9PT0gJ3N0cmluZycgPyBmb3JtYXQgOiAnMC4wJztcbiAgICB9O1xuXG4gICAgbnVtYnJvLmRlZmF1bHRDdXJyZW5jeUZvcm1hdCA9IGZ1bmN0aW9uIChmb3JtYXQpIHtcbiAgICAgICAgZGVmYXVsdEN1cnJlbmN5Rm9ybWF0ID0gdHlwZW9mKGZvcm1hdCkgPT09ICdzdHJpbmcnID8gZm9ybWF0IDogJzAkJztcbiAgICB9O1xuXG4gICAgbnVtYnJvLnZhbGlkYXRlID0gZnVuY3Rpb24odmFsLCBjdWx0dXJlKSB7XG5cbiAgICAgICAgdmFyIF9kZWNpbWFsU2VwLFxuICAgICAgICAgICAgX3Rob3VzYW5kU2VwLFxuICAgICAgICAgICAgX2N1cnJTeW1ib2wsXG4gICAgICAgICAgICBfdmFsQXJyYXksXG4gICAgICAgICAgICBfYWJick9iaixcbiAgICAgICAgICAgIF90aG91c2FuZFJlZ0V4LFxuICAgICAgICAgICAgY3VsdHVyZURhdGEsXG4gICAgICAgICAgICB0ZW1wO1xuXG4gICAgICAgIC8vY29lcmNlIHZhbCB0byBzdHJpbmdcbiAgICAgICAgaWYgKHR5cGVvZiB2YWwgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB2YWwgKz0gJyc7XG4gICAgICAgICAgICBpZiAoY29uc29sZS53YXJuKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdOdW1icm8uanM6IFZhbHVlIGlzIG5vdCBzdHJpbmcuIEl0IGhhcyBiZWVuIGNvLWVyY2VkIHRvOiAnLCB2YWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy90cmltIHdoaXRlc3BhY2VzIGZyb20gZWl0aGVyIHNpZGVzXG4gICAgICAgIHZhbCA9IHZhbC50cmltKCk7XG5cbiAgICAgICAgLy9yZXBsYWNlIHRoZSBpbml0aWFsICcrJyBvciAnLScgc2lnbiBpZiBwcmVzZW50XG4gICAgICAgIHZhbCA9IHZhbC5yZXBsYWNlKC9eWystXT8vLCAnJyk7XG5cbiAgICAgICAgLy9pZiB2YWwgaXMganVzdCBkaWdpdHMgcmV0dXJuIHRydWVcbiAgICAgICAgaWYgKCAhISB2YWwubWF0Y2goL15cXGQrJC8pKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vaWYgdmFsIGlzIGVtcHR5IHJldHVybiBmYWxzZVxuICAgICAgICBpZiAodmFsID09PSAnJykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9nZXQgdGhlIGRlY2ltYWwgYW5kIHRob3VzYW5kcyBzZXBhcmF0b3IgZnJvbSBudW1icm8uY3VsdHVyZURhdGFcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vY2hlY2sgaWYgdGhlIGN1bHR1cmUgaXMgdW5kZXJzdG9vZCBieSBudW1icm8uIGlmIG5vdCwgZGVmYXVsdCBpdCB0byBjdXJyZW50IGN1bHR1cmVcbiAgICAgICAgICAgIGN1bHR1cmVEYXRhID0gbnVtYnJvLmN1bHR1cmVEYXRhKGN1bHR1cmUpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjdWx0dXJlRGF0YSA9IG51bWJyby5jdWx0dXJlRGF0YShudW1icm8uY3VsdHVyZSgpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vc2V0dXAgdGhlIGRlbGltaXRlcnMgYW5kIGN1cnJlbmN5IHN5bWJvbCBiYXNlZCBvbiBjdWx0dXJlXG4gICAgICAgIF9jdXJyU3ltYm9sID0gY3VsdHVyZURhdGEuY3VycmVuY3kuc3ltYm9sO1xuICAgICAgICBfYWJick9iaiA9IGN1bHR1cmVEYXRhLmFiYnJldmlhdGlvbnM7XG4gICAgICAgIF9kZWNpbWFsU2VwID0gY3VsdHVyZURhdGEuZGVsaW1pdGVycy5kZWNpbWFsO1xuICAgICAgICBpZiAoY3VsdHVyZURhdGEuZGVsaW1pdGVycy50aG91c2FuZHMgPT09ICcuJykge1xuICAgICAgICAgICAgX3Rob3VzYW5kU2VwID0gJ1xcXFwuJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIF90aG91c2FuZFNlcCA9IGN1bHR1cmVEYXRhLmRlbGltaXRlcnMudGhvdXNhbmRzO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gdmFsaWRhdGluZyBjdXJyZW5jeSBzeW1ib2xcbiAgICAgICAgdGVtcCA9IHZhbC5tYXRjaCgvXlteXFxkXFwuXFwsXSsvKTtcbiAgICAgICAgaWYgKHRlbXAgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHZhbCA9IHZhbC5zdWJzdHIoMSk7XG4gICAgICAgICAgICBpZiAodGVtcFswXSAhPT0gX2N1cnJTeW1ib2wpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvL3ZhbGlkYXRpbmcgYWJicmV2aWF0aW9uIHN5bWJvbFxuICAgICAgICB0ZW1wID0gdmFsLm1hdGNoKC9bXlxcZF0rJC8pO1xuICAgICAgICBpZiAodGVtcCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdmFsID0gdmFsLnNsaWNlKDAsIC0xKTtcbiAgICAgICAgICAgIGlmICh0ZW1wWzBdICE9PSBfYWJick9iai50aG91c2FuZCAmJiB0ZW1wWzBdICE9PSBfYWJick9iai5taWxsaW9uICYmXG4gICAgICAgICAgICAgICAgICAgIHRlbXBbMF0gIT09IF9hYmJyT2JqLmJpbGxpb24gJiYgdGVtcFswXSAhPT0gX2FiYnJPYmoudHJpbGxpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBfdGhvdXNhbmRSZWdFeCA9IG5ldyBSZWdFeHAoX3Rob3VzYW5kU2VwICsgJ3syfScpO1xuXG4gICAgICAgIGlmICghdmFsLm1hdGNoKC9bXlxcZC4sXS9nKSkge1xuICAgICAgICAgICAgX3ZhbEFycmF5ID0gdmFsLnNwbGl0KF9kZWNpbWFsU2VwKTtcbiAgICAgICAgICAgIGlmIChfdmFsQXJyYXkubGVuZ3RoID4gMikge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKF92YWxBcnJheS5sZW5ndGggPCAyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoICEhIF92YWxBcnJheVswXS5tYXRjaCgvXlxcZCsuKlxcZCQvKSAmJiAhX3ZhbEFycmF5WzBdLm1hdGNoKF90aG91c2FuZFJlZ0V4KSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF92YWxBcnJheVswXSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZvciB2YWx1ZXMgd2l0aG91dCBsZWFkaW5nIHplcm8gZWcuIC45ODRcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoIV92YWxBcnJheVswXS5tYXRjaChfdGhvdXNhbmRSZWdFeCkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhIV92YWxBcnJheVsxXS5tYXRjaCgvXlxcZCskLykpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoX3ZhbEFycmF5WzBdLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICggISEgX3ZhbEFycmF5WzBdLm1hdGNoKC9eXFxkKyQvKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICFfdmFsQXJyYXlbMF0ubWF0Y2goX3Rob3VzYW5kUmVnRXgpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgISEgX3ZhbEFycmF5WzFdLm1hdGNoKC9eXFxkKyQvKSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKCAhISBfdmFsQXJyYXlbMF0ubWF0Y2goL15cXGQrLipcXGQkLykgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhX3ZhbEFycmF5WzBdLm1hdGNoKF90aG91c2FuZFJlZ0V4KSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICEhIF92YWxBcnJheVsxXS5tYXRjaCgvXlxcZCskLykpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiAqIEBkZXByZWNhdGVkIFNpbmNlIGluIHZlcnNpb24gMS42LjAuIEl0IHdpbGwgYmUgZGVsZXRlZCBpbiB2ZXJzaW9uIDIuMFxuICAgICAqIGBsb2FkQ3VsdHVyZXNJbk5vZGVgIHNob3VsZCBiZSB1c2VkIGluc3RlYWQuXG4gICAgICovXG4gICAgbnVtYnJvLmxvYWRMYW5ndWFnZXNJbk5vZGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdgbG9hZExhbmd1YWdlc0luTm9kZWAgaXMgZGVwcmVjYXRlZCBzaW5jZSB2ZXJzaW9uIDEuNi4wLiBVc2UgYGxvYWRDdWx0dXJlc0luTm9kZWAgaW5zdGVhZCcpO1xuXG4gICAgICAgIG51bWJyby5sb2FkQ3VsdHVyZXNJbk5vZGUoKTtcbiAgICB9O1xuXG4gICAgbnVtYnJvLmxvYWRDdWx0dXJlc0luTm9kZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBUT0RPOiBSZW5hbWUgdGhlIGZvbGRlciBpbiAyLjAuMFxuICAgICAgICB2YXIgY3VsdHVyZXMgPSBfZGVyZXFfKCcuL2xhbmd1YWdlcycpO1xuXG4gICAgICAgIGZvcih2YXIgbGFuZ0xvY2FsZUNvZGUgaW4gY3VsdHVyZXMpIHtcbiAgICAgICAgICAgIGlmKGxhbmdMb2NhbGVDb2RlKSB7XG4gICAgICAgICAgICAgICAgbnVtYnJvLmN1bHR1cmUobGFuZ0xvY2FsZUNvZGUsIGN1bHR1cmVzW2xhbmdMb2NhbGVDb2RlXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBIZWxwZXJzXG4gICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgZnVuY3Rpb24gc2V0Q3VsdHVyZShjb2RlLCB2YWx1ZXMpIHtcbiAgICAgICAgY3VsdHVyZXNbY29kZV0gPSB2YWx1ZXM7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2hvb3NlQ3VsdHVyZShjb2RlKSB7XG4gICAgICAgIGN1cnJlbnRDdWx0dXJlID0gY29kZTtcbiAgICAgICAgdmFyIGRlZmF1bHRzID0gY3VsdHVyZXNbY29kZV0uZGVmYXVsdHM7XG4gICAgICAgIGlmIChkZWZhdWx0cyAmJiBkZWZhdWx0cy5mb3JtYXQpIHtcbiAgICAgICAgICAgIG51bWJyby5kZWZhdWx0Rm9ybWF0KGRlZmF1bHRzLmZvcm1hdCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlZmF1bHRzICYmIGRlZmF1bHRzLmN1cnJlbmN5Rm9ybWF0KSB7XG4gICAgICAgICAgICBudW1icm8uZGVmYXVsdEN1cnJlbmN5Rm9ybWF0KGRlZmF1bHRzLmN1cnJlbmN5Rm9ybWF0KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluTm9kZWpzUnVudGltZSgpIHtcbiAgICAgICAgcmV0dXJuICh0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcpICYmXG4gICAgICAgICAgICAocHJvY2Vzcy5icm93c2VyID09PSB1bmRlZmluZWQpICYmXG4gICAgICAgICAgICBwcm9jZXNzLnRpdGxlICYmXG4gICAgICAgICAgICAoXG4gICAgICAgICAgICAgICAgcHJvY2Vzcy50aXRsZS5pbmRleE9mKCdub2RlJykgIT09IC0xIHx8XG4gICAgICAgICAgICAgICAgcHJvY2Vzcy50aXRsZS5pbmRleE9mKCdtZXRlb3ItdG9vbCcpID4gMCB8fFxuICAgICAgICAgICAgICAgIHByb2Nlc3MudGl0bGUgPT09ICdncnVudCcgfHxcbiAgICAgICAgICAgICAgICBwcm9jZXNzLnRpdGxlID09PSAnZ3VscCdcbiAgICAgICAgICAgICkgJiZcbiAgICAgICAgICAgICh0eXBlb2YgX2RlcmVxXyAhPT0gJ3VuZGVmaW5lZCcpO1xuICAgIH1cblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgRmxvYXRpbmctcG9pbnQgaGVscGVyc1xuICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgIC8vIFRoZSBmbG9hdGluZy1wb2ludCBoZWxwZXIgZnVuY3Rpb25zIGFuZCBpbXBsZW1lbnRhdGlvblxuICAgIC8vIGJvcnJvd3MgaGVhdmlseSBmcm9tIHNpbmZ1bC5qczogaHR0cDovL2d1aXBuLmdpdGh1Yi5pby9zaW5mdWwuanMvXG5cbiAgICAvKipcbiAgICAgKiBBcnJheS5wcm90b3R5cGUucmVkdWNlIGZvciBicm93c2VycyB0aGF0IGRvbid0IHN1cHBvcnQgaXRcbiAgICAgKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9BcnJheS9SZWR1Y2UjQ29tcGF0aWJpbGl0eVxuICAgICAqL1xuICAgIGlmICgnZnVuY3Rpb24nICE9PSB0eXBlb2YgQXJyYXkucHJvdG90eXBlLnJlZHVjZSkge1xuICAgICAgICBBcnJheS5wcm90b3R5cGUucmVkdWNlID0gZnVuY3Rpb24oY2FsbGJhY2ssIG9wdEluaXRpYWxWYWx1ZSkge1xuXG4gICAgICAgICAgICBpZiAobnVsbCA9PT0gdGhpcyB8fCAndW5kZWZpbmVkJyA9PT0gdHlwZW9mIHRoaXMpIHtcbiAgICAgICAgICAgICAgICAvLyBBdCB0aGUgbW9tZW50IGFsbCBtb2Rlcm4gYnJvd3NlcnMsIHRoYXQgc3VwcG9ydCBzdHJpY3QgbW9kZSwgaGF2ZVxuICAgICAgICAgICAgICAgIC8vIG5hdGl2ZSBpbXBsZW1lbnRhdGlvbiBvZiBBcnJheS5wcm90b3R5cGUucmVkdWNlLiBGb3IgaW5zdGFuY2UsIElFOFxuICAgICAgICAgICAgICAgIC8vIGRvZXMgbm90IHN1cHBvcnQgc3RyaWN0IG1vZGUsIHNvIHRoaXMgY2hlY2sgaXMgYWN0dWFsbHkgdXNlbGVzcy5cbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcnJheS5wcm90b3R5cGUucmVkdWNlIGNhbGxlZCBvbiBudWxsIG9yIHVuZGVmaW5lZCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoJ2Z1bmN0aW9uJyAhPT0gdHlwZW9mIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihjYWxsYmFjayArICcgaXMgbm90IGEgZnVuY3Rpb24nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGluZGV4LFxuICAgICAgICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgICAgICAgIGxlbmd0aCA9IHRoaXMubGVuZ3RoID4+PiAwLFxuICAgICAgICAgICAgICAgIGlzVmFsdWVTZXQgPSBmYWxzZTtcblxuICAgICAgICAgICAgaWYgKDEgPCBhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBvcHRJbml0aWFsVmFsdWU7XG4gICAgICAgICAgICAgICAgaXNWYWx1ZVNldCA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAoaW5kZXggPSAwOyBsZW5ndGggPiBpbmRleDsgKytpbmRleCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc093blByb3BlcnR5KGluZGV4KSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNWYWx1ZVNldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBjYWxsYmFjayh2YWx1ZSwgdGhpc1tpbmRleF0sIGluZGV4LCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdGhpc1tpbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpc1ZhbHVlU2V0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFpc1ZhbHVlU2V0KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignUmVkdWNlIG9mIGVtcHR5IGFycmF5IHdpdGggbm8gaW5pdGlhbCB2YWx1ZScpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH07XG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBDb21wdXRlcyB0aGUgbXVsdGlwbGllciBuZWNlc3NhcnkgdG8gbWFrZSB4ID49IDEsXG4gICAgICogZWZmZWN0aXZlbHkgZWxpbWluYXRpbmcgbWlzY2FsY3VsYXRpb25zIGNhdXNlZCBieVxuICAgICAqIGZpbml0ZSBwcmVjaXNpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gbXVsdGlwbGllcih4KSB7XG4gICAgICAgIHZhciBwYXJ0cyA9IHgudG9TdHJpbmcoKS5zcGxpdCgnLicpO1xuICAgICAgICBpZiAocGFydHMubGVuZ3RoIDwgMikge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE1hdGgucG93KDEwLCBwYXJ0c1sxXS5sZW5ndGgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdpdmVuIGEgdmFyaWFibGUgbnVtYmVyIG9mIGFyZ3VtZW50cywgcmV0dXJucyB0aGUgbWF4aW11bVxuICAgICAqIG11bHRpcGxpZXIgdGhhdCBtdXN0IGJlIHVzZWQgdG8gbm9ybWFsaXplIGFuIG9wZXJhdGlvbiBpbnZvbHZpbmdcbiAgICAgKiBhbGwgb2YgdGhlbS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb3JyZWN0aW9uRmFjdG9yKCkge1xuICAgICAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG4gICAgICAgIHJldHVybiBhcmdzLnJlZHVjZShmdW5jdGlvbihwcmV2LCBuZXh0KSB7XG4gICAgICAgICAgICB2YXIgbXAgPSBtdWx0aXBsaWVyKHByZXYpLFxuICAgICAgICAgICAgICAgIG1uID0gbXVsdGlwbGllcihuZXh0KTtcbiAgICAgICAgICAgIHJldHVybiBtcCA+IG1uID8gbXAgOiBtbjtcbiAgICAgICAgfSwgLUluZmluaXR5KTtcbiAgICB9XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgIE51bWJybyBQcm90b3R5cGVcbiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cblxuICAgIG51bWJyby5mbiA9IE51bWJyby5wcm90b3R5cGUgPSB7XG5cbiAgICAgICAgY2xvbmU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bWJybyh0aGlzKTtcbiAgICAgICAgfSxcblxuICAgICAgICBmb3JtYXQ6IGZ1bmN0aW9uKGlucHV0U3RyaW5nLCByb3VuZGluZ0Z1bmN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gZm9ybWF0TnVtYnJvKHRoaXMsXG4gICAgICAgICAgICAgICAgaW5wdXRTdHJpbmcgPyBpbnB1dFN0cmluZyA6IGRlZmF1bHRGb3JtYXQsXG4gICAgICAgICAgICAgICAgKHJvdW5kaW5nRnVuY3Rpb24gIT09IHVuZGVmaW5lZCkgPyByb3VuZGluZ0Z1bmN0aW9uIDogTWF0aC5yb3VuZFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSxcblxuICAgICAgICBmb3JtYXRDdXJyZW5jeTogZnVuY3Rpb24oaW5wdXRTdHJpbmcsIHJvdW5kaW5nRnVuY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBmb3JtYXRDdXJyZW5jeSh0aGlzLFxuICAgICAgICAgICAgICAgIGN1bHR1cmVzW2N1cnJlbnRDdWx0dXJlXS5jdXJyZW5jeS5zeW1ib2wsXG4gICAgICAgICAgICAgICAgaW5wdXRTdHJpbmcgPyBpbnB1dFN0cmluZyA6IGRlZmF1bHRDdXJyZW5jeUZvcm1hdCxcbiAgICAgICAgICAgICAgICAocm91bmRpbmdGdW5jdGlvbiAhPT0gdW5kZWZpbmVkKSA/IHJvdW5kaW5nRnVuY3Rpb24gOiBNYXRoLnJvdW5kXG4gICAgICAgICAgICApO1xuICAgICAgICB9LFxuXG4gICAgICAgIGZvcm1hdEZvcmVpZ25DdXJyZW5jeTogZnVuY3Rpb24oY3VycmVuY3lTeW1ib2wsIGlucHV0U3RyaW5nLCByb3VuZGluZ0Z1bmN0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gZm9ybWF0Rm9yZWlnbkN1cnJlbmN5KHRoaXMsXG4gICAgICAgICAgICAgICAgY3VycmVuY3lTeW1ib2wsXG4gICAgICAgICAgICAgICAgaW5wdXRTdHJpbmcgPyBpbnB1dFN0cmluZyA6IGRlZmF1bHRDdXJyZW5jeUZvcm1hdCxcbiAgICAgICAgICAgICAgICAocm91bmRpbmdGdW5jdGlvbiAhPT0gdW5kZWZpbmVkKSA/IHJvdW5kaW5nRnVuY3Rpb24gOiBNYXRoLnJvdW5kXG4gICAgICAgICAgICApO1xuICAgICAgICB9LFxuXG4gICAgICAgIHVuZm9ybWF0OiBmdW5jdGlvbihpbnB1dFN0cmluZykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBpbnB1dFN0cmluZyA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5wdXRTdHJpbmc7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBpbnB1dFN0cmluZyA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gdW5mb3JtYXROdW1icm8odGhpcywgaW5wdXRTdHJpbmcpO1xuXG4gICAgICAgICAgICAgICAgLy8gQW55IHVucGFyc2VhYmxlIHN0cmluZyAocmVwcmVzZW50ZWQgYXMgTmFOIGluIHRoZSByZXN1bHQpIGlzXG4gICAgICAgICAgICAgICAgLy8gY29udmVydGVkIGludG8gdW5kZWZpbmVkLlxuICAgICAgICAgICAgICAgIHJldHVybiBpc05hTihyZXN1bHQpID8gdW5kZWZpbmVkIDogcmVzdWx0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGJpbmFyeUJ5dGVVbml0czogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gZm9ybWF0Qnl0ZVVuaXRzKHRoaXMuX3ZhbHVlLCBieXRlcy5iaW5hcnkuc3VmZml4ZXMsIGJ5dGVzLmJpbmFyeS5zY2FsZSkuc3VmZml4O1xuICAgICAgICB9LFxuXG4gICAgICAgIGJ5dGVVbml0czogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gZm9ybWF0Qnl0ZVVuaXRzKHRoaXMuX3ZhbHVlLCBieXRlcy5nZW5lcmFsLnN1ZmZpeGVzLCBieXRlcy5nZW5lcmFsLnNjYWxlKS5zdWZmaXg7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZGVjaW1hbEJ5dGVVbml0czogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gZm9ybWF0Qnl0ZVVuaXRzKHRoaXMuX3ZhbHVlLCBieXRlcy5kZWNpbWFsLnN1ZmZpeGVzLCBieXRlcy5kZWNpbWFsLnNjYWxlKS5zdWZmaXg7XG4gICAgICAgIH0sXG5cbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgICAgICB9LFxuXG4gICAgICAgIHZhbHVlT2Y6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX3ZhbHVlID0gTnVtYmVyKHZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuXG4gICAgICAgIGFkZDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBjb3JyRmFjdG9yID0gY29ycmVjdGlvbkZhY3Rvci5jYWxsKG51bGwsIHRoaXMuX3ZhbHVlLCB2YWx1ZSk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNiYWNrKGFjY3VtLCBjdXJyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFjY3VtICsgY29yckZhY3RvciAqIGN1cnI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl92YWx1ZSA9IFt0aGlzLl92YWx1ZSwgdmFsdWVdLnJlZHVjZShjYmFjaywgMCkgLyBjb3JyRmFjdG9yO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc3VidHJhY3Q6IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgY29yckZhY3RvciA9IGNvcnJlY3Rpb25GYWN0b3IuY2FsbChudWxsLCB0aGlzLl92YWx1ZSwgdmFsdWUpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBjYmFjayhhY2N1bSwgY3Vycikge1xuICAgICAgICAgICAgICAgIHJldHVybiBhY2N1bSAtIGNvcnJGYWN0b3IgKiBjdXJyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fdmFsdWUgPSBbdmFsdWVdLnJlZHVjZShjYmFjaywgdGhpcy5fdmFsdWUgKiBjb3JyRmFjdG9yKSAvIGNvcnJGYWN0b3I7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfSxcblxuICAgICAgICBtdWx0aXBseTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIGNiYWNrKGFjY3VtLCBjdXJyKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvcnJGYWN0b3IgPSBjb3JyZWN0aW9uRmFjdG9yKGFjY3VtLCBjdXJyKSxcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gYWNjdW0gKiBjb3JyRmFjdG9yO1xuICAgICAgICAgICAgICAgIHJlc3VsdCAqPSBjdXJyICogY29yckZhY3RvcjtcbiAgICAgICAgICAgICAgICByZXN1bHQgLz0gY29yckZhY3RvciAqIGNvcnJGYWN0b3I7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3ZhbHVlID0gW3RoaXMuX3ZhbHVlLCB2YWx1ZV0ucmVkdWNlKGNiYWNrLCAxKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuXG4gICAgICAgIGRpdmlkZTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIGNiYWNrKGFjY3VtLCBjdXJyKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvcnJGYWN0b3IgPSBjb3JyZWN0aW9uRmFjdG9yKGFjY3VtLCBjdXJyKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gKGFjY3VtICogY29yckZhY3RvcikgLyAoY3VyciAqIGNvcnJGYWN0b3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fdmFsdWUgPSBbdGhpcy5fdmFsdWUsIHZhbHVlXS5yZWR1Y2UoY2JhY2spO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZGlmZmVyZW5jZTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLmFicyhudW1icm8odGhpcy5fdmFsdWUpLnN1YnRyYWN0KHZhbHVlKS52YWx1ZSgpKTtcbiAgICAgICAgfVxuXG4gICAgfTtcblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgRXhwb3NpbmcgTnVtYnJvXG4gICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgaWYgKGluTm9kZWpzUnVudGltZSgpKSB7XG4gICAgICAgIC8vVG9kbzogUmVuYW1lIHRoZSBmb2xkZXIgaW4gMi4wLjBcbiAgICAgICAgbnVtYnJvLmxvYWRDdWx0dXJlc0luTm9kZSgpO1xuICAgIH1cblxuICAgIC8vIENvbW1vbkpTIG1vZHVsZSBpcyBkZWZpbmVkXG4gICAgaWYgKGhhc01vZHVsZSkge1xuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IG51bWJybztcbiAgICB9IGVsc2Uge1xuICAgICAgICAvKmdsb2JhbCBlbmRlcjpmYWxzZSAqL1xuICAgICAgICBpZiAodHlwZW9mIGVuZGVyID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgLy8gaGVyZSwgYHRoaXNgIG1lYW5zIGB3aW5kb3dgIGluIHRoZSBicm93c2VyLCBvciBgZ2xvYmFsYCBvbiB0aGUgc2VydmVyXG4gICAgICAgICAgICAvLyBhZGQgYG51bWJyb2AgYXMgYSBnbG9iYWwgb2JqZWN0IHZpYSBhIHN0cmluZyBpZGVudGlmaWVyLFxuICAgICAgICAgICAgLy8gZm9yIENsb3N1cmUgQ29tcGlsZXIgJ2FkdmFuY2VkJyBtb2RlXG4gICAgICAgICAgICB0aGlzLm51bWJybyA9IG51bWJybztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qZ2xvYmFsIGRlZmluZTpmYWxzZSAqL1xuICAgICAgICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgICAgICBkZWZpbmUoW10sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudW1icm87XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxufS5jYWxsKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnID8gdGhpcyA6IHdpbmRvdykpO1xuXG59LHtcImxhbmd1YWdlc1wiOjF9XSxcInBpa2FkYXlcIjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4vKiFcbiAqIFBpa2FkYXlcbiAqXG4gKiBDb3B5cmlnaHQgwqkgMjAxNCBEYXZpZCBCdXNoZWxsIHwgQlNEICYgTUlUIGxpY2Vuc2UgfCBodHRwczovL2dpdGh1Yi5jb20vZGJ1c2hlbGwvUGlrYWRheVxuICovXG5cbihmdW5jdGlvbiAocm9vdCwgZmFjdG9yeSlcbntcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgbW9tZW50O1xuICAgIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgLy8gQ29tbW9uSlMgbW9kdWxlXG4gICAgICAgIC8vIExvYWQgbW9tZW50LmpzIGFzIGFuIG9wdGlvbmFsIGRlcGVuZGVuY3lcbiAgICAgICAgdHJ5IHsgbW9tZW50ID0gX2RlcmVxXygnbW9tZW50Jyk7IH0gY2F0Y2ggKGUpIHt9XG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShtb21lbnQpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cbiAgICAgICAgZGVmaW5lKGZ1bmN0aW9uIChyZXEpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIExvYWQgbW9tZW50LmpzIGFzIGFuIG9wdGlvbmFsIGRlcGVuZGVuY3lcbiAgICAgICAgICAgIHZhciBpZCA9ICdtb21lbnQnO1xuICAgICAgICAgICAgdHJ5IHsgbW9tZW50ID0gcmVxKGlkKTsgfSBjYXRjaCAoZSkge31cbiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5KG1vbWVudCk7XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJvb3QuUGlrYWRheSA9IGZhY3Rvcnkocm9vdC5tb21lbnQpO1xuICAgIH1cbn0odGhpcywgZnVuY3Rpb24gKG1vbWVudClcbntcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICAvKipcbiAgICAgKiBmZWF0dXJlIGRldGVjdGlvbiBhbmQgaGVscGVyIGZ1bmN0aW9uc1xuICAgICAqL1xuICAgIHZhciBoYXNNb21lbnQgPSB0eXBlb2YgbW9tZW50ID09PSAnZnVuY3Rpb24nLFxuXG4gICAgaGFzRXZlbnRMaXN0ZW5lcnMgPSAhIXdpbmRvdy5hZGRFdmVudExpc3RlbmVyLFxuXG4gICAgZG9jdW1lbnQgPSB3aW5kb3cuZG9jdW1lbnQsXG5cbiAgICBzdG8gPSB3aW5kb3cuc2V0VGltZW91dCxcblxuICAgIGFkZEV2ZW50ID0gZnVuY3Rpb24oZWwsIGUsIGNhbGxiYWNrLCBjYXB0dXJlKVxuICAgIHtcbiAgICAgICAgaWYgKGhhc0V2ZW50TGlzdGVuZXJzKSB7XG4gICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKGUsIGNhbGxiYWNrLCAhIWNhcHR1cmUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZWwuYXR0YWNoRXZlbnQoJ29uJyArIGUsIGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICByZW1vdmVFdmVudCA9IGZ1bmN0aW9uKGVsLCBlLCBjYWxsYmFjaywgY2FwdHVyZSlcbiAgICB7XG4gICAgICAgIGlmIChoYXNFdmVudExpc3RlbmVycykge1xuICAgICAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihlLCBjYWxsYmFjaywgISFjYXB0dXJlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGVsLmRldGFjaEV2ZW50KCdvbicgKyBlLCBjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgZmlyZUV2ZW50ID0gZnVuY3Rpb24oZWwsIGV2ZW50TmFtZSwgZGF0YSlcbiAgICB7XG4gICAgICAgIHZhciBldjtcblxuICAgICAgICBpZiAoZG9jdW1lbnQuY3JlYXRlRXZlbnQpIHtcbiAgICAgICAgICAgIGV2ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0hUTUxFdmVudHMnKTtcbiAgICAgICAgICAgIGV2LmluaXRFdmVudChldmVudE5hbWUsIHRydWUsIGZhbHNlKTtcbiAgICAgICAgICAgIGV2ID0gZXh0ZW5kKGV2LCBkYXRhKTtcbiAgICAgICAgICAgIGVsLmRpc3BhdGNoRXZlbnQoZXYpO1xuICAgICAgICB9IGVsc2UgaWYgKGRvY3VtZW50LmNyZWF0ZUV2ZW50T2JqZWN0KSB7XG4gICAgICAgICAgICBldiA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50T2JqZWN0KCk7XG4gICAgICAgICAgICBldiA9IGV4dGVuZChldiwgZGF0YSk7XG4gICAgICAgICAgICBlbC5maXJlRXZlbnQoJ29uJyArIGV2ZW50TmFtZSwgZXYpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHRyaW0gPSBmdW5jdGlvbihzdHIpXG4gICAge1xuICAgICAgICByZXR1cm4gc3RyLnRyaW0gPyBzdHIudHJpbSgpIDogc3RyLnJlcGxhY2UoL15cXHMrfFxccyskL2csJycpO1xuICAgIH0sXG5cbiAgICBoYXNDbGFzcyA9IGZ1bmN0aW9uKGVsLCBjbilcbiAgICB7XG4gICAgICAgIHJldHVybiAoJyAnICsgZWwuY2xhc3NOYW1lICsgJyAnKS5pbmRleE9mKCcgJyArIGNuICsgJyAnKSAhPT0gLTE7XG4gICAgfSxcblxuICAgIGFkZENsYXNzID0gZnVuY3Rpb24oZWwsIGNuKVxuICAgIHtcbiAgICAgICAgaWYgKCFoYXNDbGFzcyhlbCwgY24pKSB7XG4gICAgICAgICAgICBlbC5jbGFzc05hbWUgPSAoZWwuY2xhc3NOYW1lID09PSAnJykgPyBjbiA6IGVsLmNsYXNzTmFtZSArICcgJyArIGNuO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHJlbW92ZUNsYXNzID0gZnVuY3Rpb24oZWwsIGNuKVxuICAgIHtcbiAgICAgICAgZWwuY2xhc3NOYW1lID0gdHJpbSgoJyAnICsgZWwuY2xhc3NOYW1lICsgJyAnKS5yZXBsYWNlKCcgJyArIGNuICsgJyAnLCAnICcpKTtcbiAgICB9LFxuXG4gICAgaXNBcnJheSA9IGZ1bmN0aW9uKG9iailcbiAgICB7XG4gICAgICAgIHJldHVybiAoL0FycmF5LykudGVzdChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSk7XG4gICAgfSxcblxuICAgIGlzRGF0ZSA9IGZ1bmN0aW9uKG9iailcbiAgICB7XG4gICAgICAgIHJldHVybiAoL0RhdGUvKS50ZXN0KE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvYmopKSAmJiAhaXNOYU4ob2JqLmdldFRpbWUoKSk7XG4gICAgfSxcblxuICAgIGlzV2Vla2VuZCA9IGZ1bmN0aW9uKGRhdGUpXG4gICAge1xuICAgICAgICB2YXIgZGF5ID0gZGF0ZS5nZXREYXkoKTtcbiAgICAgICAgcmV0dXJuIGRheSA9PT0gMCB8fCBkYXkgPT09IDY7XG4gICAgfSxcblxuICAgIGlzTGVhcFllYXIgPSBmdW5jdGlvbih5ZWFyKVxuICAgIHtcbiAgICAgICAgLy8gc29sdXRpb24gYnkgTWF0dGkgVmlya2t1bmVuOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS80ODgxOTUxXG4gICAgICAgIHJldHVybiB5ZWFyICUgNCA9PT0gMCAmJiB5ZWFyICUgMTAwICE9PSAwIHx8IHllYXIgJSA0MDAgPT09IDA7XG4gICAgfSxcblxuICAgIGdldERheXNJbk1vbnRoID0gZnVuY3Rpb24oeWVhciwgbW9udGgpXG4gICAge1xuICAgICAgICByZXR1cm4gWzMxLCBpc0xlYXBZZWFyKHllYXIpID8gMjkgOiAyOCwgMzEsIDMwLCAzMSwgMzAsIDMxLCAzMSwgMzAsIDMxLCAzMCwgMzFdW21vbnRoXTtcbiAgICB9LFxuXG4gICAgc2V0VG9TdGFydE9mRGF5ID0gZnVuY3Rpb24oZGF0ZSlcbiAgICB7XG4gICAgICAgIGlmIChpc0RhdGUoZGF0ZSkpIGRhdGUuc2V0SG91cnMoMCwwLDAsMCk7XG4gICAgfSxcblxuICAgIGNvbXBhcmVEYXRlcyA9IGZ1bmN0aW9uKGEsYilcbiAgICB7XG4gICAgICAgIC8vIHdlYWsgZGF0ZSBjb21wYXJpc29uICh1c2Ugc2V0VG9TdGFydE9mRGF5KGRhdGUpIHRvIGVuc3VyZSBjb3JyZWN0IHJlc3VsdClcbiAgICAgICAgcmV0dXJuIGEuZ2V0VGltZSgpID09PSBiLmdldFRpbWUoKTtcbiAgICB9LFxuXG4gICAgZXh0ZW5kID0gZnVuY3Rpb24odG8sIGZyb20sIG92ZXJ3cml0ZSlcbiAgICB7XG4gICAgICAgIHZhciBwcm9wLCBoYXNQcm9wO1xuICAgICAgICBmb3IgKHByb3AgaW4gZnJvbSkge1xuICAgICAgICAgICAgaGFzUHJvcCA9IHRvW3Byb3BdICE9PSB1bmRlZmluZWQ7XG4gICAgICAgICAgICBpZiAoaGFzUHJvcCAmJiB0eXBlb2YgZnJvbVtwcm9wXSA9PT0gJ29iamVjdCcgJiYgZnJvbVtwcm9wXSAhPT0gbnVsbCAmJiBmcm9tW3Byb3BdLm5vZGVOYW1lID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNEYXRlKGZyb21bcHJvcF0pKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvdmVyd3JpdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvW3Byb3BdID0gbmV3IERhdGUoZnJvbVtwcm9wXS5nZXRUaW1lKCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGlzQXJyYXkoZnJvbVtwcm9wXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG92ZXJ3cml0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9bcHJvcF0gPSBmcm9tW3Byb3BdLnNsaWNlKDApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdG9bcHJvcF0gPSBleHRlbmQoe30sIGZyb21bcHJvcF0sIG92ZXJ3cml0ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChvdmVyd3JpdGUgfHwgIWhhc1Byb3ApIHtcbiAgICAgICAgICAgICAgICB0b1twcm9wXSA9IGZyb21bcHJvcF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvO1xuICAgIH0sXG5cbiAgICBhZGp1c3RDYWxlbmRhciA9IGZ1bmN0aW9uKGNhbGVuZGFyKSB7XG4gICAgICAgIGlmIChjYWxlbmRhci5tb250aCA8IDApIHtcbiAgICAgICAgICAgIGNhbGVuZGFyLnllYXIgLT0gTWF0aC5jZWlsKE1hdGguYWJzKGNhbGVuZGFyLm1vbnRoKS8xMik7XG4gICAgICAgICAgICBjYWxlbmRhci5tb250aCArPSAxMjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2FsZW5kYXIubW9udGggPiAxMSkge1xuICAgICAgICAgICAgY2FsZW5kYXIueWVhciArPSBNYXRoLmZsb29yKE1hdGguYWJzKGNhbGVuZGFyLm1vbnRoKS8xMik7XG4gICAgICAgICAgICBjYWxlbmRhci5tb250aCAtPSAxMjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2FsZW5kYXI7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIGRlZmF1bHRzIGFuZCBsb2NhbGlzYXRpb25cbiAgICAgKi9cbiAgICBkZWZhdWx0cyA9IHtcblxuICAgICAgICAvLyBiaW5kIHRoZSBwaWNrZXIgdG8gYSBmb3JtIGZpZWxkXG4gICAgICAgIGZpZWxkOiBudWxsLFxuXG4gICAgICAgIC8vIGF1dG9tYXRpY2FsbHkgc2hvdy9oaWRlIHRoZSBwaWNrZXIgb24gYGZpZWxkYCBmb2N1cyAoZGVmYXVsdCBgdHJ1ZWAgaWYgYGZpZWxkYCBpcyBzZXQpXG4gICAgICAgIGJvdW5kOiB1bmRlZmluZWQsXG5cbiAgICAgICAgLy8gcG9zaXRpb24gb2YgdGhlIGRhdGVwaWNrZXIsIHJlbGF0aXZlIHRvIHRoZSBmaWVsZCAoZGVmYXVsdCB0byBib3R0b20gJiBsZWZ0KVxuICAgICAgICAvLyAoJ2JvdHRvbScgJiAnbGVmdCcga2V5d29yZHMgYXJlIG5vdCB1c2VkLCAndG9wJyAmICdyaWdodCcgYXJlIG1vZGlmaWVyIG9uIHRoZSBib3R0b20vbGVmdCBwb3NpdGlvbilcbiAgICAgICAgcG9zaXRpb246ICdib3R0b20gbGVmdCcsXG5cbiAgICAgICAgLy8gYXV0b21hdGljYWxseSBmaXQgaW4gdGhlIHZpZXdwb3J0IGV2ZW4gaWYgaXQgbWVhbnMgcmVwb3NpdGlvbmluZyBmcm9tIHRoZSBwb3NpdGlvbiBvcHRpb25cbiAgICAgICAgcmVwb3NpdGlvbjogdHJ1ZSxcblxuICAgICAgICAvLyB0aGUgZGVmYXVsdCBvdXRwdXQgZm9ybWF0IGZvciBgLnRvU3RyaW5nKClgIGFuZCBgZmllbGRgIHZhbHVlXG4gICAgICAgIGZvcm1hdDogJ1lZWVktTU0tREQnLFxuXG4gICAgICAgIC8vIHRoZSBpbml0aWFsIGRhdGUgdG8gdmlldyB3aGVuIGZpcnN0IG9wZW5lZFxuICAgICAgICBkZWZhdWx0RGF0ZTogbnVsbCxcblxuICAgICAgICAvLyBtYWtlIHRoZSBgZGVmYXVsdERhdGVgIHRoZSBpbml0aWFsIHNlbGVjdGVkIHZhbHVlXG4gICAgICAgIHNldERlZmF1bHREYXRlOiBmYWxzZSxcblxuICAgICAgICAvLyBmaXJzdCBkYXkgb2Ygd2VlayAoMDogU3VuZGF5LCAxOiBNb25kYXkgZXRjKVxuICAgICAgICBmaXJzdERheTogMCxcblxuICAgICAgICAvLyB0aGUgZGVmYXVsdCBmbGFnIGZvciBtb21lbnQncyBzdHJpY3QgZGF0ZSBwYXJzaW5nXG4gICAgICAgIGZvcm1hdFN0cmljdDogZmFsc2UsXG5cbiAgICAgICAgLy8gdGhlIG1pbmltdW0vZWFybGllc3QgZGF0ZSB0aGF0IGNhbiBiZSBzZWxlY3RlZFxuICAgICAgICBtaW5EYXRlOiBudWxsLFxuICAgICAgICAvLyB0aGUgbWF4aW11bS9sYXRlc3QgZGF0ZSB0aGF0IGNhbiBiZSBzZWxlY3RlZFxuICAgICAgICBtYXhEYXRlOiBudWxsLFxuXG4gICAgICAgIC8vIG51bWJlciBvZiB5ZWFycyBlaXRoZXIgc2lkZSwgb3IgYXJyYXkgb2YgdXBwZXIvbG93ZXIgcmFuZ2VcbiAgICAgICAgeWVhclJhbmdlOiAxMCxcblxuICAgICAgICAvLyBzaG93IHdlZWsgbnVtYmVycyBhdCBoZWFkIG9mIHJvd1xuICAgICAgICBzaG93V2Vla051bWJlcjogZmFsc2UsXG5cbiAgICAgICAgLy8gdXNlZCBpbnRlcm5hbGx5IChkb24ndCBjb25maWcgb3V0c2lkZSlcbiAgICAgICAgbWluWWVhcjogMCxcbiAgICAgICAgbWF4WWVhcjogOTk5OSxcbiAgICAgICAgbWluTW9udGg6IHVuZGVmaW5lZCxcbiAgICAgICAgbWF4TW9udGg6IHVuZGVmaW5lZCxcblxuICAgICAgICBzdGFydFJhbmdlOiBudWxsLFxuICAgICAgICBlbmRSYW5nZTogbnVsbCxcblxuICAgICAgICBpc1JUTDogZmFsc2UsXG5cbiAgICAgICAgLy8gQWRkaXRpb25hbCB0ZXh0IHRvIGFwcGVuZCB0byB0aGUgeWVhciBpbiB0aGUgY2FsZW5kYXIgdGl0bGVcbiAgICAgICAgeWVhclN1ZmZpeDogJycsXG5cbiAgICAgICAgLy8gUmVuZGVyIHRoZSBtb250aCBhZnRlciB5ZWFyIGluIHRoZSBjYWxlbmRhciB0aXRsZVxuICAgICAgICBzaG93TW9udGhBZnRlclllYXI6IGZhbHNlLFxuXG4gICAgICAgIC8vIFJlbmRlciBkYXlzIG9mIHRoZSBjYWxlbmRhciBncmlkIHRoYXQgZmFsbCBpbiB0aGUgbmV4dCBvciBwcmV2aW91cyBtb250aFxuICAgICAgICBzaG93RGF5c0luTmV4dEFuZFByZXZpb3VzTW9udGhzOiBmYWxzZSxcblxuICAgICAgICAvLyBob3cgbWFueSBtb250aHMgYXJlIHZpc2libGVcbiAgICAgICAgbnVtYmVyT2ZNb250aHM6IDEsXG5cbiAgICAgICAgLy8gd2hlbiBudW1iZXJPZk1vbnRocyBpcyB1c2VkLCB0aGlzIHdpbGwgaGVscCB5b3UgdG8gY2hvb3NlIHdoZXJlIHRoZSBtYWluIGNhbGVuZGFyIHdpbGwgYmUgKGRlZmF1bHQgYGxlZnRgLCBjYW4gYmUgc2V0IHRvIGByaWdodGApXG4gICAgICAgIC8vIG9ubHkgdXNlZCBmb3IgdGhlIGZpcnN0IGRpc3BsYXkgb3Igd2hlbiBhIHNlbGVjdGVkIGRhdGUgaXMgbm90IHZpc2libGVcbiAgICAgICAgbWFpbkNhbGVuZGFyOiAnbGVmdCcsXG5cbiAgICAgICAgLy8gU3BlY2lmeSBhIERPTSBlbGVtZW50IHRvIHJlbmRlciB0aGUgY2FsZW5kYXIgaW5cbiAgICAgICAgY29udGFpbmVyOiB1bmRlZmluZWQsXG5cbiAgICAgICAgLy8gaW50ZXJuYXRpb25hbGl6YXRpb25cbiAgICAgICAgaTE4bjoge1xuICAgICAgICAgICAgcHJldmlvdXNNb250aCA6ICdQcmV2aW91cyBNb250aCcsXG4gICAgICAgICAgICBuZXh0TW9udGggICAgIDogJ05leHQgTW9udGgnLFxuICAgICAgICAgICAgbW9udGhzICAgICAgICA6IFsnSmFudWFyeScsJ0ZlYnJ1YXJ5JywnTWFyY2gnLCdBcHJpbCcsJ01heScsJ0p1bmUnLCdKdWx5JywnQXVndXN0JywnU2VwdGVtYmVyJywnT2N0b2JlcicsJ05vdmVtYmVyJywnRGVjZW1iZXInXSxcbiAgICAgICAgICAgIHdlZWtkYXlzICAgICAgOiBbJ1N1bmRheScsJ01vbmRheScsJ1R1ZXNkYXknLCdXZWRuZXNkYXknLCdUaHVyc2RheScsJ0ZyaWRheScsJ1NhdHVyZGF5J10sXG4gICAgICAgICAgICB3ZWVrZGF5c1Nob3J0IDogWydTdW4nLCdNb24nLCdUdWUnLCdXZWQnLCdUaHUnLCdGcmknLCdTYXQnXVxuICAgICAgICB9LFxuXG4gICAgICAgIC8vIFRoZW1lIENsYXNzbmFtZVxuICAgICAgICB0aGVtZTogbnVsbCxcblxuICAgICAgICAvLyBjYWxsYmFjayBmdW5jdGlvblxuICAgICAgICBvblNlbGVjdDogbnVsbCxcbiAgICAgICAgb25PcGVuOiBudWxsLFxuICAgICAgICBvbkNsb3NlOiBudWxsLFxuICAgICAgICBvbkRyYXc6IG51bGxcbiAgICB9LFxuXG5cbiAgICAvKipcbiAgICAgKiB0ZW1wbGF0aW5nIGZ1bmN0aW9ucyB0byBhYnN0cmFjdCBIVE1MIHJlbmRlcmluZ1xuICAgICAqL1xuICAgIHJlbmRlckRheU5hbWUgPSBmdW5jdGlvbihvcHRzLCBkYXksIGFiYnIpXG4gICAge1xuICAgICAgICBkYXkgKz0gb3B0cy5maXJzdERheTtcbiAgICAgICAgd2hpbGUgKGRheSA+PSA3KSB7XG4gICAgICAgICAgICBkYXkgLT0gNztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWJiciA/IG9wdHMuaTE4bi53ZWVrZGF5c1Nob3J0W2RheV0gOiBvcHRzLmkxOG4ud2Vla2RheXNbZGF5XTtcbiAgICB9LFxuXG4gICAgcmVuZGVyRGF5ID0gZnVuY3Rpb24ob3B0cylcbiAgICB7XG4gICAgICAgIHZhciBhcnIgPSBbXTtcbiAgICAgICAgdmFyIGFyaWFTZWxlY3RlZCA9ICdmYWxzZSc7XG4gICAgICAgIGlmIChvcHRzLmlzRW1wdHkpIHtcbiAgICAgICAgICAgIGlmIChvcHRzLnNob3dEYXlzSW5OZXh0QW5kUHJldmlvdXNNb250aHMpIHtcbiAgICAgICAgICAgICAgICBhcnIucHVzaCgnaXMtb3V0c2lkZS1jdXJyZW50LW1vbnRoJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAnPHRkIGNsYXNzPVwiaXMtZW1wdHlcIj48L3RkPic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdHMuaXNEaXNhYmxlZCkge1xuICAgICAgICAgICAgYXJyLnB1c2goJ2lzLWRpc2FibGVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdHMuaXNUb2RheSkge1xuICAgICAgICAgICAgYXJyLnB1c2goJ2lzLXRvZGF5Jyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdHMuaXNTZWxlY3RlZCkge1xuICAgICAgICAgICAgYXJyLnB1c2goJ2lzLXNlbGVjdGVkJyk7XG4gICAgICAgICAgICBhcmlhU2VsZWN0ZWQgPSAndHJ1ZSc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdHMuaXNJblJhbmdlKSB7XG4gICAgICAgICAgICBhcnIucHVzaCgnaXMtaW5yYW5nZScpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRzLmlzU3RhcnRSYW5nZSkge1xuICAgICAgICAgICAgYXJyLnB1c2goJ2lzLXN0YXJ0cmFuZ2UnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0cy5pc0VuZFJhbmdlKSB7XG4gICAgICAgICAgICBhcnIucHVzaCgnaXMtZW5kcmFuZ2UnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJzx0ZCBkYXRhLWRheT1cIicgKyBvcHRzLmRheSArICdcIiBjbGFzcz1cIicgKyBhcnIuam9pbignICcpICsgJ1wiIGFyaWEtc2VsZWN0ZWQ9XCInICsgYXJpYVNlbGVjdGVkICsgJ1wiPicgK1xuICAgICAgICAgICAgICAgICAnPGJ1dHRvbiBjbGFzcz1cInBpa2EtYnV0dG9uIHBpa2EtZGF5XCIgdHlwZT1cImJ1dHRvblwiICcgK1xuICAgICAgICAgICAgICAgICAgICAnZGF0YS1waWthLXllYXI9XCInICsgb3B0cy55ZWFyICsgJ1wiIGRhdGEtcGlrYS1tb250aD1cIicgKyBvcHRzLm1vbnRoICsgJ1wiIGRhdGEtcGlrYS1kYXk9XCInICsgb3B0cy5kYXkgKyAnXCI+JyArXG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRzLmRheSArXG4gICAgICAgICAgICAgICAgICc8L2J1dHRvbj4nICtcbiAgICAgICAgICAgICAgICc8L3RkPic7XG4gICAgfSxcblxuICAgIHJlbmRlcldlZWsgPSBmdW5jdGlvbiAoZCwgbSwgeSkge1xuICAgICAgICAvLyBMaWZ0ZWQgZnJvbSBodHRwOi8vamF2YXNjcmlwdC5hYm91dC5jb20vbGlicmFyeS9ibHdlZWt5ZWFyLmh0bSwgbGlnaHRseSBtb2RpZmllZC5cbiAgICAgICAgdmFyIG9uZWphbiA9IG5ldyBEYXRlKHksIDAsIDEpLFxuICAgICAgICAgICAgd2Vla051bSA9IE1hdGguY2VpbCgoKChuZXcgRGF0ZSh5LCBtLCBkKSAtIG9uZWphbikgLyA4NjQwMDAwMCkgKyBvbmVqYW4uZ2V0RGF5KCkrMSkvNyk7XG4gICAgICAgIHJldHVybiAnPHRkIGNsYXNzPVwicGlrYS13ZWVrXCI+JyArIHdlZWtOdW0gKyAnPC90ZD4nO1xuICAgIH0sXG5cbiAgICByZW5kZXJSb3cgPSBmdW5jdGlvbihkYXlzLCBpc1JUTClcbiAgICB7XG4gICAgICAgIHJldHVybiAnPHRyPicgKyAoaXNSVEwgPyBkYXlzLnJldmVyc2UoKSA6IGRheXMpLmpvaW4oJycpICsgJzwvdHI+JztcbiAgICB9LFxuXG4gICAgcmVuZGVyQm9keSA9IGZ1bmN0aW9uKHJvd3MpXG4gICAge1xuICAgICAgICByZXR1cm4gJzx0Ym9keT4nICsgcm93cy5qb2luKCcnKSArICc8L3Rib2R5Pic7XG4gICAgfSxcblxuICAgIHJlbmRlckhlYWQgPSBmdW5jdGlvbihvcHRzKVxuICAgIHtcbiAgICAgICAgdmFyIGksIGFyciA9IFtdO1xuICAgICAgICBpZiAob3B0cy5zaG93V2Vla051bWJlcikge1xuICAgICAgICAgICAgYXJyLnB1c2goJzx0aD48L3RoPicpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCA3OyBpKyspIHtcbiAgICAgICAgICAgIGFyci5wdXNoKCc8dGggc2NvcGU9XCJjb2xcIj48YWJiciB0aXRsZT1cIicgKyByZW5kZXJEYXlOYW1lKG9wdHMsIGkpICsgJ1wiPicgKyByZW5kZXJEYXlOYW1lKG9wdHMsIGksIHRydWUpICsgJzwvYWJicj48L3RoPicpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAnPHRoZWFkPjx0cj4nICsgKG9wdHMuaXNSVEwgPyBhcnIucmV2ZXJzZSgpIDogYXJyKS5qb2luKCcnKSArICc8L3RyPjwvdGhlYWQ+JztcbiAgICB9LFxuXG4gICAgcmVuZGVyVGl0bGUgPSBmdW5jdGlvbihpbnN0YW5jZSwgYywgeWVhciwgbW9udGgsIHJlZlllYXIsIHJhbmRJZClcbiAgICB7XG4gICAgICAgIHZhciBpLCBqLCBhcnIsXG4gICAgICAgICAgICBvcHRzID0gaW5zdGFuY2UuX28sXG4gICAgICAgICAgICBpc01pblllYXIgPSB5ZWFyID09PSBvcHRzLm1pblllYXIsXG4gICAgICAgICAgICBpc01heFllYXIgPSB5ZWFyID09PSBvcHRzLm1heFllYXIsXG4gICAgICAgICAgICBodG1sID0gJzxkaXYgaWQ9XCInICsgcmFuZElkICsgJ1wiIGNsYXNzPVwicGlrYS10aXRsZVwiIHJvbGU9XCJoZWFkaW5nXCIgYXJpYS1saXZlPVwiYXNzZXJ0aXZlXCI+JyxcbiAgICAgICAgICAgIG1vbnRoSHRtbCxcbiAgICAgICAgICAgIHllYXJIdG1sLFxuICAgICAgICAgICAgcHJldiA9IHRydWUsXG4gICAgICAgICAgICBuZXh0ID0gdHJ1ZTtcblxuICAgICAgICBmb3IgKGFyciA9IFtdLCBpID0gMDsgaSA8IDEyOyBpKyspIHtcbiAgICAgICAgICAgIGFyci5wdXNoKCc8b3B0aW9uIHZhbHVlPVwiJyArICh5ZWFyID09PSByZWZZZWFyID8gaSAtIGMgOiAxMiArIGkgLSBjKSArICdcIicgK1xuICAgICAgICAgICAgICAgIChpID09PSBtb250aCA/ICcgc2VsZWN0ZWQ9XCJzZWxlY3RlZFwiJzogJycpICtcbiAgICAgICAgICAgICAgICAoKGlzTWluWWVhciAmJiBpIDwgb3B0cy5taW5Nb250aCkgfHwgKGlzTWF4WWVhciAmJiBpID4gb3B0cy5tYXhNb250aCkgPyAnZGlzYWJsZWQ9XCJkaXNhYmxlZFwiJyA6ICcnKSArICc+JyArXG4gICAgICAgICAgICAgICAgb3B0cy5pMThuLm1vbnRoc1tpXSArICc8L29wdGlvbj4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG1vbnRoSHRtbCA9ICc8ZGl2IGNsYXNzPVwicGlrYS1sYWJlbFwiPicgKyBvcHRzLmkxOG4ubW9udGhzW21vbnRoXSArICc8c2VsZWN0IGNsYXNzPVwicGlrYS1zZWxlY3QgcGlrYS1zZWxlY3QtbW9udGhcIiB0YWJpbmRleD1cIi0xXCI+JyArIGFyci5qb2luKCcnKSArICc8L3NlbGVjdD48L2Rpdj4nO1xuXG4gICAgICAgIGlmIChpc0FycmF5KG9wdHMueWVhclJhbmdlKSkge1xuICAgICAgICAgICAgaSA9IG9wdHMueWVhclJhbmdlWzBdO1xuICAgICAgICAgICAgaiA9IG9wdHMueWVhclJhbmdlWzFdICsgMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGkgPSB5ZWFyIC0gb3B0cy55ZWFyUmFuZ2U7XG4gICAgICAgICAgICBqID0gMSArIHllYXIgKyBvcHRzLnllYXJSYW5nZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoYXJyID0gW107IGkgPCBqICYmIGkgPD0gb3B0cy5tYXhZZWFyOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChpID49IG9wdHMubWluWWVhcikge1xuICAgICAgICAgICAgICAgIGFyci5wdXNoKCc8b3B0aW9uIHZhbHVlPVwiJyArIGkgKyAnXCInICsgKGkgPT09IHllYXIgPyAnIHNlbGVjdGVkPVwic2VsZWN0ZWRcIic6ICcnKSArICc+JyArIChpKSArICc8L29wdGlvbj4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB5ZWFySHRtbCA9ICc8ZGl2IGNsYXNzPVwicGlrYS1sYWJlbFwiPicgKyB5ZWFyICsgb3B0cy55ZWFyU3VmZml4ICsgJzxzZWxlY3QgY2xhc3M9XCJwaWthLXNlbGVjdCBwaWthLXNlbGVjdC15ZWFyXCIgdGFiaW5kZXg9XCItMVwiPicgKyBhcnIuam9pbignJykgKyAnPC9zZWxlY3Q+PC9kaXY+JztcblxuICAgICAgICBpZiAob3B0cy5zaG93TW9udGhBZnRlclllYXIpIHtcbiAgICAgICAgICAgIGh0bWwgKz0geWVhckh0bWwgKyBtb250aEh0bWw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBodG1sICs9IG1vbnRoSHRtbCArIHllYXJIdG1sO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlzTWluWWVhciAmJiAobW9udGggPT09IDAgfHwgb3B0cy5taW5Nb250aCA+PSBtb250aCkpIHtcbiAgICAgICAgICAgIHByZXYgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpc01heFllYXIgJiYgKG1vbnRoID09PSAxMSB8fCBvcHRzLm1heE1vbnRoIDw9IG1vbnRoKSkge1xuICAgICAgICAgICAgbmV4dCA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGMgPT09IDApIHtcbiAgICAgICAgICAgIGh0bWwgKz0gJzxidXR0b24gY2xhc3M9XCJwaWthLXByZXYnICsgKHByZXYgPyAnJyA6ICcgaXMtZGlzYWJsZWQnKSArICdcIiB0eXBlPVwiYnV0dG9uXCI+JyArIG9wdHMuaTE4bi5wcmV2aW91c01vbnRoICsgJzwvYnV0dG9uPic7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGMgPT09IChpbnN0YW5jZS5fby5udW1iZXJPZk1vbnRocyAtIDEpICkge1xuICAgICAgICAgICAgaHRtbCArPSAnPGJ1dHRvbiBjbGFzcz1cInBpa2EtbmV4dCcgKyAobmV4dCA/ICcnIDogJyBpcy1kaXNhYmxlZCcpICsgJ1wiIHR5cGU9XCJidXR0b25cIj4nICsgb3B0cy5pMThuLm5leHRNb250aCArICc8L2J1dHRvbj4nO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGh0bWwgKz0gJzwvZGl2Pic7XG4gICAgfSxcblxuICAgIHJlbmRlclRhYmxlID0gZnVuY3Rpb24ob3B0cywgZGF0YSwgcmFuZElkKVxuICAgIHtcbiAgICAgICAgcmV0dXJuICc8dGFibGUgY2VsbHBhZGRpbmc9XCIwXCIgY2VsbHNwYWNpbmc9XCIwXCIgY2xhc3M9XCJwaWthLXRhYmxlXCIgcm9sZT1cImdyaWRcIiBhcmlhLWxhYmVsbGVkYnk9XCInICsgcmFuZElkICsgJ1wiPicgKyByZW5kZXJIZWFkKG9wdHMpICsgcmVuZGVyQm9keShkYXRhKSArICc8L3RhYmxlPic7XG4gICAgfSxcblxuXG4gICAgLyoqXG4gICAgICogUGlrYWRheSBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIFBpa2FkYXkgPSBmdW5jdGlvbihvcHRpb25zKVxuICAgIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzLFxuICAgICAgICAgICAgb3B0cyA9IHNlbGYuY29uZmlnKG9wdGlvbnMpO1xuXG4gICAgICAgIHNlbGYuX29uTW91c2VEb3duID0gZnVuY3Rpb24oZSlcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCFzZWxmLl92KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZSA9IGUgfHwgd2luZG93LmV2ZW50O1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDtcbiAgICAgICAgICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIWhhc0NsYXNzKHRhcmdldCwgJ2lzLWRpc2FibGVkJykpIHtcbiAgICAgICAgICAgICAgICBpZiAoaGFzQ2xhc3ModGFyZ2V0LCAncGlrYS1idXR0b24nKSAmJiAhaGFzQ2xhc3ModGFyZ2V0LCAnaXMtZW1wdHknKSAmJiAhaGFzQ2xhc3ModGFyZ2V0LnBhcmVudE5vZGUsICdpcy1kaXNhYmxlZCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2V0RGF0ZShuZXcgRGF0ZSh0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLXBpa2EteWVhcicpLCB0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLXBpa2EtbW9udGgnKSwgdGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1waWthLWRheScpKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRzLmJvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdG8oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdHMuZmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0cy5maWVsZC5ibHVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChoYXNDbGFzcyh0YXJnZXQsICdwaWthLXByZXYnKSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnByZXZNb250aCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChoYXNDbGFzcyh0YXJnZXQsICdwaWthLW5leHQnKSkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLm5leHRNb250aCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaGFzQ2xhc3ModGFyZ2V0LCAncGlrYS1zZWxlY3QnKSkge1xuICAgICAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgdG91Y2ggZXZlbnQgcHJldmVudCBtb3VzZSBldmVudHMgZW11bGF0aW9uXG4gICAgICAgICAgICAgICAgaWYgKGUucHJldmVudERlZmF1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGUucmV0dXJuVmFsdWUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5fYyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZi5fb25DaGFuZ2UgPSBmdW5jdGlvbihlKVxuICAgICAgICB7XG4gICAgICAgICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50O1xuICAgICAgICAgICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaGFzQ2xhc3ModGFyZ2V0LCAncGlrYS1zZWxlY3QtbW9udGgnKSkge1xuICAgICAgICAgICAgICAgIHNlbGYuZ290b01vbnRoKHRhcmdldC52YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChoYXNDbGFzcyh0YXJnZXQsICdwaWthLXNlbGVjdC15ZWFyJykpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmdvdG9ZZWFyKHRhcmdldC52YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZi5fb25LZXlDaGFuZ2UgPSBmdW5jdGlvbihlKVxuICAgICAgICB7XG4gICAgICAgICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7XG5cbiAgICAgICAgICAgIGlmIChzZWxmLmlzVmlzaWJsZSgpKSB7XG5cbiAgICAgICAgICAgICAgICBzd2l0Y2goZS5rZXlDb2RlKXtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMzpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdHMuZmllbGQuYmx1cigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzc6XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFkanVzdERhdGUoJ3N1YnRyYWN0JywgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzODpcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuYWRqdXN0RGF0ZSgnc3VidHJhY3QnLCA3KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM5OlxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hZGp1c3REYXRlKCdhZGQnLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQwOlxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hZGp1c3REYXRlKCdhZGQnLCA3KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBzZWxmLl9vbklucHV0Q2hhbmdlID0gZnVuY3Rpb24oZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGRhdGU7XG5cbiAgICAgICAgICAgIGlmIChlLmZpcmVkQnkgPT09IHNlbGYpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaGFzTW9tZW50KSB7XG4gICAgICAgICAgICAgICAgZGF0ZSA9IG1vbWVudChvcHRzLmZpZWxkLnZhbHVlLCBvcHRzLmZvcm1hdCwgb3B0cy5mb3JtYXRTdHJpY3QpO1xuICAgICAgICAgICAgICAgIGRhdGUgPSAoZGF0ZSAmJiBkYXRlLmlzVmFsaWQoKSkgPyBkYXRlLnRvRGF0ZSgpIDogbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGRhdGUgPSBuZXcgRGF0ZShEYXRlLnBhcnNlKG9wdHMuZmllbGQudmFsdWUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc0RhdGUoZGF0ZSkpIHtcbiAgICAgICAgICAgICAgc2VsZi5zZXREYXRlKGRhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFzZWxmLl92KSB7XG4gICAgICAgICAgICAgICAgc2VsZi5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZi5fb25JbnB1dEZvY3VzID0gZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICBzZWxmLnNob3coKTtcbiAgICAgICAgfTtcblxuICAgICAgICBzZWxmLl9vbklucHV0Q2xpY2sgPSBmdW5jdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHNlbGYuc2hvdygpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHNlbGYuX29uSW5wdXRCbHVyID0gZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBJRSBhbGxvd3MgcGlrYSBkaXYgdG8gZ2FpbiBmb2N1czsgY2F0Y2ggYmx1ciB0aGUgaW5wdXQgZmllbGRcbiAgICAgICAgICAgIHZhciBwRWwgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGlmIChoYXNDbGFzcyhwRWwsICdwaWthLXNpbmdsZScpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB3aGlsZSAoKHBFbCA9IHBFbC5wYXJlbnROb2RlKSk7XG5cbiAgICAgICAgICAgIGlmICghc2VsZi5fYykge1xuICAgICAgICAgICAgICAgIHNlbGYuX2IgPSBzdG8oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaGlkZSgpO1xuICAgICAgICAgICAgICAgIH0sIDUwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGYuX2MgPSBmYWxzZTtcbiAgICAgICAgfTtcblxuICAgICAgICBzZWxmLl9vbkNsaWNrID0gZnVuY3Rpb24oZSlcbiAgICAgICAge1xuICAgICAgICAgICAgZSA9IGUgfHwgd2luZG93LmV2ZW50O1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudCxcbiAgICAgICAgICAgICAgICBwRWwgPSB0YXJnZXQ7XG4gICAgICAgICAgICBpZiAoIXRhcmdldCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaGFzRXZlbnRMaXN0ZW5lcnMgJiYgaGFzQ2xhc3ModGFyZ2V0LCAncGlrYS1zZWxlY3QnKSkge1xuICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0Lm9uY2hhbmdlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5zZXRBdHRyaWJ1dGUoJ29uY2hhbmdlJywgJ3JldHVybjsnKTtcbiAgICAgICAgICAgICAgICAgICAgYWRkRXZlbnQodGFyZ2V0LCAnY2hhbmdlJywgc2VsZi5fb25DaGFuZ2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICBpZiAoaGFzQ2xhc3MocEVsLCAncGlrYS1zaW5nbGUnKSB8fCBwRWwgPT09IG9wdHMudHJpZ2dlcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2hpbGUgKChwRWwgPSBwRWwucGFyZW50Tm9kZSkpO1xuICAgICAgICAgICAgaWYgKHNlbGYuX3YgJiYgdGFyZ2V0ICE9PSBvcHRzLnRyaWdnZXIgJiYgcEVsICE9PSBvcHRzLnRyaWdnZXIpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmhpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBzZWxmLmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHNlbGYuZWwuY2xhc3NOYW1lID0gJ3Bpa2Etc2luZ2xlJyArIChvcHRzLmlzUlRMID8gJyBpcy1ydGwnIDogJycpICsgKG9wdHMudGhlbWUgPyAnICcgKyBvcHRzLnRoZW1lIDogJycpO1xuXG4gICAgICAgIGFkZEV2ZW50KHNlbGYuZWwsICdtb3VzZWRvd24nLCBzZWxmLl9vbk1vdXNlRG93biwgdHJ1ZSk7XG4gICAgICAgIGFkZEV2ZW50KHNlbGYuZWwsICd0b3VjaGVuZCcsIHNlbGYuX29uTW91c2VEb3duLCB0cnVlKTtcbiAgICAgICAgYWRkRXZlbnQoc2VsZi5lbCwgJ2NoYW5nZScsIHNlbGYuX29uQ2hhbmdlKTtcbiAgICAgICAgYWRkRXZlbnQoZG9jdW1lbnQsICdrZXlkb3duJywgc2VsZi5fb25LZXlDaGFuZ2UpO1xuXG4gICAgICAgIGlmIChvcHRzLmZpZWxkKSB7XG4gICAgICAgICAgICBpZiAob3B0cy5jb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICBvcHRzLmNvbnRhaW5lci5hcHBlbmRDaGlsZChzZWxmLmVsKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAob3B0cy5ib3VuZCkge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoc2VsZi5lbCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG9wdHMuZmllbGQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoc2VsZi5lbCwgb3B0cy5maWVsZC5uZXh0U2libGluZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhZGRFdmVudChvcHRzLmZpZWxkLCAnY2hhbmdlJywgc2VsZi5fb25JbnB1dENoYW5nZSk7XG5cbiAgICAgICAgICAgIGlmICghb3B0cy5kZWZhdWx0RGF0ZSkge1xuICAgICAgICAgICAgICAgIGlmIChoYXNNb21lbnQgJiYgb3B0cy5maWVsZC52YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBvcHRzLmRlZmF1bHREYXRlID0gbW9tZW50KG9wdHMuZmllbGQudmFsdWUsIG9wdHMuZm9ybWF0KS50b0RhdGUoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBvcHRzLmRlZmF1bHREYXRlID0gbmV3IERhdGUoRGF0ZS5wYXJzZShvcHRzLmZpZWxkLnZhbHVlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9wdHMuc2V0RGVmYXVsdERhdGUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGRlZkRhdGUgPSBvcHRzLmRlZmF1bHREYXRlO1xuXG4gICAgICAgIGlmIChpc0RhdGUoZGVmRGF0ZSkpIHtcbiAgICAgICAgICAgIGlmIChvcHRzLnNldERlZmF1bHREYXRlKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5zZXREYXRlKGRlZkRhdGUsIHRydWUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZWxmLmdvdG9EYXRlKGRlZkRhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2VsZi5nb3RvRGF0ZShuZXcgRGF0ZSgpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChvcHRzLmJvdW5kKSB7XG4gICAgICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgICAgICAgIHNlbGYuZWwuY2xhc3NOYW1lICs9ICcgaXMtYm91bmQnO1xuICAgICAgICAgICAgYWRkRXZlbnQob3B0cy50cmlnZ2VyLCAnY2xpY2snLCBzZWxmLl9vbklucHV0Q2xpY2spO1xuICAgICAgICAgICAgYWRkRXZlbnQob3B0cy50cmlnZ2VyLCAnZm9jdXMnLCBzZWxmLl9vbklucHV0Rm9jdXMpO1xuICAgICAgICAgICAgYWRkRXZlbnQob3B0cy50cmlnZ2VyLCAnYmx1cicsIHNlbGYuX29uSW5wdXRCbHVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2hvdygpO1xuICAgICAgICB9XG4gICAgfTtcblxuXG4gICAgLyoqXG4gICAgICogcHVibGljIFBpa2FkYXkgQVBJXG4gICAgICovXG4gICAgUGlrYWRheS5wcm90b3R5cGUgPSB7XG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogY29uZmlndXJlIGZ1bmN0aW9uYWxpdHlcbiAgICAgICAgICovXG4gICAgICAgIGNvbmZpZzogZnVuY3Rpb24ob3B0aW9ucylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9vKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbyA9IGV4dGVuZCh7fSwgZGVmYXVsdHMsIHRydWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgb3B0cyA9IGV4dGVuZCh0aGlzLl9vLCBvcHRpb25zLCB0cnVlKTtcblxuICAgICAgICAgICAgb3B0cy5pc1JUTCA9ICEhb3B0cy5pc1JUTDtcblxuICAgICAgICAgICAgb3B0cy5maWVsZCA9IChvcHRzLmZpZWxkICYmIG9wdHMuZmllbGQubm9kZU5hbWUpID8gb3B0cy5maWVsZCA6IG51bGw7XG5cbiAgICAgICAgICAgIG9wdHMudGhlbWUgPSAodHlwZW9mIG9wdHMudGhlbWUpID09PSAnc3RyaW5nJyAmJiBvcHRzLnRoZW1lID8gb3B0cy50aGVtZSA6IG51bGw7XG5cbiAgICAgICAgICAgIG9wdHMuYm91bmQgPSAhIShvcHRzLmJvdW5kICE9PSB1bmRlZmluZWQgPyBvcHRzLmZpZWxkICYmIG9wdHMuYm91bmQgOiBvcHRzLmZpZWxkKTtcblxuICAgICAgICAgICAgb3B0cy50cmlnZ2VyID0gKG9wdHMudHJpZ2dlciAmJiBvcHRzLnRyaWdnZXIubm9kZU5hbWUpID8gb3B0cy50cmlnZ2VyIDogb3B0cy5maWVsZDtcblxuICAgICAgICAgICAgb3B0cy5kaXNhYmxlV2Vla2VuZHMgPSAhIW9wdHMuZGlzYWJsZVdlZWtlbmRzO1xuXG4gICAgICAgICAgICBvcHRzLmRpc2FibGVEYXlGbiA9ICh0eXBlb2Ygb3B0cy5kaXNhYmxlRGF5Rm4pID09PSAnZnVuY3Rpb24nID8gb3B0cy5kaXNhYmxlRGF5Rm4gOiBudWxsO1xuXG4gICAgICAgICAgICB2YXIgbm9tID0gcGFyc2VJbnQob3B0cy5udW1iZXJPZk1vbnRocywgMTApIHx8IDE7XG4gICAgICAgICAgICBvcHRzLm51bWJlck9mTW9udGhzID0gbm9tID4gNCA/IDQgOiBub207XG5cbiAgICAgICAgICAgIGlmICghaXNEYXRlKG9wdHMubWluRGF0ZSkpIHtcbiAgICAgICAgICAgICAgICBvcHRzLm1pbkRhdGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaXNEYXRlKG9wdHMubWF4RGF0ZSkpIHtcbiAgICAgICAgICAgICAgICBvcHRzLm1heERhdGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgob3B0cy5taW5EYXRlICYmIG9wdHMubWF4RGF0ZSkgJiYgb3B0cy5tYXhEYXRlIDwgb3B0cy5taW5EYXRlKSB7XG4gICAgICAgICAgICAgICAgb3B0cy5tYXhEYXRlID0gb3B0cy5taW5EYXRlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3B0cy5taW5EYXRlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRNaW5EYXRlKG9wdHMubWluRGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3B0cy5tYXhEYXRlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRNYXhEYXRlKG9wdHMubWF4RGF0ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChpc0FycmF5KG9wdHMueWVhclJhbmdlKSkge1xuICAgICAgICAgICAgICAgIHZhciBmYWxsYmFjayA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKSAtIDEwO1xuICAgICAgICAgICAgICAgIG9wdHMueWVhclJhbmdlWzBdID0gcGFyc2VJbnQob3B0cy55ZWFyUmFuZ2VbMF0sIDEwKSB8fCBmYWxsYmFjaztcbiAgICAgICAgICAgICAgICBvcHRzLnllYXJSYW5nZVsxXSA9IHBhcnNlSW50KG9wdHMueWVhclJhbmdlWzFdLCAxMCkgfHwgZmFsbGJhY2s7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG9wdHMueWVhclJhbmdlID0gTWF0aC5hYnMocGFyc2VJbnQob3B0cy55ZWFyUmFuZ2UsIDEwKSkgfHwgZGVmYXVsdHMueWVhclJhbmdlO1xuICAgICAgICAgICAgICAgIGlmIChvcHRzLnllYXJSYW5nZSA+IDEwMCkge1xuICAgICAgICAgICAgICAgICAgICBvcHRzLnllYXJSYW5nZSA9IDEwMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBvcHRzO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZXR1cm4gYSBmb3JtYXR0ZWQgc3RyaW5nIG9mIHRoZSBjdXJyZW50IHNlbGVjdGlvbiAodXNpbmcgTW9tZW50LmpzIGlmIGF2YWlsYWJsZSlcbiAgICAgICAgICovXG4gICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbihmb3JtYXQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiAhaXNEYXRlKHRoaXMuX2QpID8gJycgOiBoYXNNb21lbnQgPyBtb21lbnQodGhpcy5fZCkuZm9ybWF0KGZvcm1hdCB8fCB0aGlzLl9vLmZvcm1hdCkgOiB0aGlzLl9kLnRvRGF0ZVN0cmluZygpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZXR1cm4gYSBNb21lbnQuanMgb2JqZWN0IG9mIHRoZSBjdXJyZW50IHNlbGVjdGlvbiAoaWYgYXZhaWxhYmxlKVxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0TW9tZW50OiBmdW5jdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiBoYXNNb21lbnQgPyBtb21lbnQodGhpcy5fZCkgOiBudWxsO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBzZXQgdGhlIGN1cnJlbnQgc2VsZWN0aW9uIGZyb20gYSBNb21lbnQuanMgb2JqZWN0IChpZiBhdmFpbGFibGUpXG4gICAgICAgICAqL1xuICAgICAgICBzZXRNb21lbnQ6IGZ1bmN0aW9uKGRhdGUsIHByZXZlbnRPblNlbGVjdClcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKGhhc01vbWVudCAmJiBtb21lbnQuaXNNb21lbnQoZGF0ZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldERhdGUoZGF0ZS50b0RhdGUoKSwgcHJldmVudE9uU2VsZWN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogcmV0dXJuIGEgRGF0ZSBvYmplY3Qgb2YgdGhlIGN1cnJlbnQgc2VsZWN0aW9uIHdpdGggZmFsbGJhY2sgZm9yIHRoZSBjdXJyZW50IGRhdGVcbiAgICAgICAgICovXG4gICAgICAgIGdldERhdGU6IGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgcmV0dXJuIGlzRGF0ZSh0aGlzLl9kKSA/IG5ldyBEYXRlKHRoaXMuX2QuZ2V0VGltZSgpKSA6IG5ldyBEYXRlKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIHNldCB0aGUgY3VycmVudCBzZWxlY3Rpb25cbiAgICAgICAgICovXG4gICAgICAgIHNldERhdGU6IGZ1bmN0aW9uKGRhdGUsIHByZXZlbnRPblNlbGVjdClcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCFkYXRlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZCA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fby5maWVsZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vLmZpZWxkLnZhbHVlID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGZpcmVFdmVudCh0aGlzLl9vLmZpZWxkLCAnY2hhbmdlJywgeyBmaXJlZEJ5OiB0aGlzIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRyYXcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBkYXRlID0gbmV3IERhdGUoRGF0ZS5wYXJzZShkYXRlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWlzRGF0ZShkYXRlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIG1pbiA9IHRoaXMuX28ubWluRGF0ZSxcbiAgICAgICAgICAgICAgICBtYXggPSB0aGlzLl9vLm1heERhdGU7XG5cbiAgICAgICAgICAgIGlmIChpc0RhdGUobWluKSAmJiBkYXRlIDwgbWluKSB7XG4gICAgICAgICAgICAgICAgZGF0ZSA9IG1pbjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNEYXRlKG1heCkgJiYgZGF0ZSA+IG1heCkge1xuICAgICAgICAgICAgICAgIGRhdGUgPSBtYXg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX2QgPSBuZXcgRGF0ZShkYXRlLmdldFRpbWUoKSk7XG4gICAgICAgICAgICBzZXRUb1N0YXJ0T2ZEYXkodGhpcy5fZCk7XG4gICAgICAgICAgICB0aGlzLmdvdG9EYXRlKHRoaXMuX2QpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fby5maWVsZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX28uZmllbGQudmFsdWUgPSB0aGlzLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgZmlyZUV2ZW50KHRoaXMuX28uZmllbGQsICdjaGFuZ2UnLCB7IGZpcmVkQnk6IHRoaXMgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXByZXZlbnRPblNlbGVjdCAmJiB0eXBlb2YgdGhpcy5fby5vblNlbGVjdCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHRoaXMuX28ub25TZWxlY3QuY2FsbCh0aGlzLCB0aGlzLmdldERhdGUoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIGNoYW5nZSB2aWV3IHRvIGEgc3BlY2lmaWMgZGF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgZ290b0RhdGU6IGZ1bmN0aW9uKGRhdGUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBuZXdDYWxlbmRhciA9IHRydWU7XG5cbiAgICAgICAgICAgIGlmICghaXNEYXRlKGRhdGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5jYWxlbmRhcnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmlyc3RWaXNpYmxlRGF0ZSA9IG5ldyBEYXRlKHRoaXMuY2FsZW5kYXJzWzBdLnllYXIsIHRoaXMuY2FsZW5kYXJzWzBdLm1vbnRoLCAxKSxcbiAgICAgICAgICAgICAgICAgICAgbGFzdFZpc2libGVEYXRlID0gbmV3IERhdGUodGhpcy5jYWxlbmRhcnNbdGhpcy5jYWxlbmRhcnMubGVuZ3RoLTFdLnllYXIsIHRoaXMuY2FsZW5kYXJzW3RoaXMuY2FsZW5kYXJzLmxlbmd0aC0xXS5tb250aCwgMSksXG4gICAgICAgICAgICAgICAgICAgIHZpc2libGVEYXRlID0gZGF0ZS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgLy8gZ2V0IHRoZSBlbmQgb2YgdGhlIG1vbnRoXG4gICAgICAgICAgICAgICAgbGFzdFZpc2libGVEYXRlLnNldE1vbnRoKGxhc3RWaXNpYmxlRGF0ZS5nZXRNb250aCgpKzEpO1xuICAgICAgICAgICAgICAgIGxhc3RWaXNpYmxlRGF0ZS5zZXREYXRlKGxhc3RWaXNpYmxlRGF0ZS5nZXREYXRlKCktMSk7XG4gICAgICAgICAgICAgICAgbmV3Q2FsZW5kYXIgPSAodmlzaWJsZURhdGUgPCBmaXJzdFZpc2libGVEYXRlLmdldFRpbWUoKSB8fCBsYXN0VmlzaWJsZURhdGUuZ2V0VGltZSgpIDwgdmlzaWJsZURhdGUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobmV3Q2FsZW5kYXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbGVuZGFycyA9IFt7XG4gICAgICAgICAgICAgICAgICAgIG1vbnRoOiBkYXRlLmdldE1vbnRoKCksXG4gICAgICAgICAgICAgICAgICAgIHllYXI6IGRhdGUuZ2V0RnVsbFllYXIoKVxuICAgICAgICAgICAgICAgIH1dO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vLm1haW5DYWxlbmRhciA9PT0gJ3JpZ2h0Jykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbGVuZGFyc1swXS5tb250aCArPSAxIC0gdGhpcy5fby5udW1iZXJPZk1vbnRocztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuYWRqdXN0Q2FsZW5kYXJzKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYWRqdXN0RGF0ZTogZnVuY3Rpb24oc2lnbiwgZGF5cykge1xuXG4gICAgICAgICAgICB2YXIgZGF5ID0gdGhpcy5nZXREYXRlKCk7XG4gICAgICAgICAgICB2YXIgZGlmZmVyZW5jZSA9IHBhcnNlSW50KGRheXMpKjI0KjYwKjYwKjEwMDA7XG5cbiAgICAgICAgICAgIHZhciBuZXdEYXk7XG5cbiAgICAgICAgICAgIGlmIChzaWduID09PSAnYWRkJykge1xuICAgICAgICAgICAgICAgIG5ld0RheSA9IG5ldyBEYXRlKGRheS52YWx1ZU9mKCkgKyBkaWZmZXJlbmNlKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2lnbiA9PT0gJ3N1YnRyYWN0Jykge1xuICAgICAgICAgICAgICAgIG5ld0RheSA9IG5ldyBEYXRlKGRheS52YWx1ZU9mKCkgLSBkaWZmZXJlbmNlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGhhc01vbWVudCkge1xuICAgICAgICAgICAgICAgIGlmIChzaWduID09PSAnYWRkJykge1xuICAgICAgICAgICAgICAgICAgICBuZXdEYXkgPSBtb21lbnQoZGF5KS5hZGQoZGF5cywgXCJkYXlzXCIpLnRvRGF0ZSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2lnbiA9PT0gJ3N1YnRyYWN0Jykge1xuICAgICAgICAgICAgICAgICAgICBuZXdEYXkgPSBtb21lbnQoZGF5KS5zdWJ0cmFjdChkYXlzLCBcImRheXNcIikudG9EYXRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnNldERhdGUobmV3RGF5KTtcbiAgICAgICAgfSxcblxuICAgICAgICBhZGp1c3RDYWxlbmRhcnM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5jYWxlbmRhcnNbMF0gPSBhZGp1c3RDYWxlbmRhcih0aGlzLmNhbGVuZGFyc1swXSk7XG4gICAgICAgICAgICBmb3IgKHZhciBjID0gMTsgYyA8IHRoaXMuX28ubnVtYmVyT2ZNb250aHM7IGMrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FsZW5kYXJzW2NdID0gYWRqdXN0Q2FsZW5kYXIoe1xuICAgICAgICAgICAgICAgICAgICBtb250aDogdGhpcy5jYWxlbmRhcnNbMF0ubW9udGggKyBjLFxuICAgICAgICAgICAgICAgICAgICB5ZWFyOiB0aGlzLmNhbGVuZGFyc1swXS55ZWFyXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmRyYXcoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnb3RvVG9kYXk6IGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5nb3RvRGF0ZShuZXcgRGF0ZSgpKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogY2hhbmdlIHZpZXcgdG8gYSBzcGVjaWZpYyBtb250aCAoemVyby1pbmRleCwgZS5nLiAwOiBKYW51YXJ5KVxuICAgICAgICAgKi9cbiAgICAgICAgZ290b01vbnRoOiBmdW5jdGlvbihtb250aClcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCFpc05hTihtb250aCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbGVuZGFyc1swXS5tb250aCA9IHBhcnNlSW50KG1vbnRoLCAxMCk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGp1c3RDYWxlbmRhcnMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBuZXh0TW9udGg6IGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5jYWxlbmRhcnNbMF0ubW9udGgrKztcbiAgICAgICAgICAgIHRoaXMuYWRqdXN0Q2FsZW5kYXJzKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcHJldk1vbnRoOiBmdW5jdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuY2FsZW5kYXJzWzBdLm1vbnRoLS07XG4gICAgICAgICAgICB0aGlzLmFkanVzdENhbGVuZGFycygpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjaGFuZ2UgdmlldyB0byBhIHNwZWNpZmljIGZ1bGwgeWVhciAoZS5nLiBcIjIwMTJcIilcbiAgICAgICAgICovXG4gICAgICAgIGdvdG9ZZWFyOiBmdW5jdGlvbih5ZWFyKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoIWlzTmFOKHllYXIpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYWxlbmRhcnNbMF0ueWVhciA9IHBhcnNlSW50KHllYXIsIDEwKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkanVzdENhbGVuZGFycygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBjaGFuZ2UgdGhlIG1pbkRhdGVcbiAgICAgICAgICovXG4gICAgICAgIHNldE1pbkRhdGU6IGZ1bmN0aW9uKHZhbHVlKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZih2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgICAgICAgICBzZXRUb1N0YXJ0T2ZEYXkodmFsdWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuX28ubWluRGF0ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX28ubWluWWVhciAgPSB2YWx1ZS5nZXRGdWxsWWVhcigpO1xuICAgICAgICAgICAgICAgIHRoaXMuX28ubWluTW9udGggPSB2YWx1ZS5nZXRNb250aCgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vLm1pbkRhdGUgPSBkZWZhdWx0cy5taW5EYXRlO1xuICAgICAgICAgICAgICAgIHRoaXMuX28ubWluWWVhciAgPSBkZWZhdWx0cy5taW5ZZWFyO1xuICAgICAgICAgICAgICAgIHRoaXMuX28ubWluTW9udGggPSBkZWZhdWx0cy5taW5Nb250aDtcbiAgICAgICAgICAgICAgICB0aGlzLl9vLnN0YXJ0UmFuZ2UgPSBkZWZhdWx0cy5zdGFydFJhbmdlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmRyYXcoKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogY2hhbmdlIHRoZSBtYXhEYXRlXG4gICAgICAgICAqL1xuICAgICAgICBzZXRNYXhEYXRlOiBmdW5jdGlvbih2YWx1ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgaWYodmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgICAgICAgICAgc2V0VG9TdGFydE9mRGF5KHZhbHVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9vLm1heERhdGUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9vLm1heFllYXIgPSB2YWx1ZS5nZXRGdWxsWWVhcigpO1xuICAgICAgICAgICAgICAgIHRoaXMuX28ubWF4TW9udGggPSB2YWx1ZS5nZXRNb250aCgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vLm1heERhdGUgPSBkZWZhdWx0cy5tYXhEYXRlO1xuICAgICAgICAgICAgICAgIHRoaXMuX28ubWF4WWVhciA9IGRlZmF1bHRzLm1heFllYXI7XG4gICAgICAgICAgICAgICAgdGhpcy5fby5tYXhNb250aCA9IGRlZmF1bHRzLm1heE1vbnRoO1xuICAgICAgICAgICAgICAgIHRoaXMuX28uZW5kUmFuZ2UgPSBkZWZhdWx0cy5lbmRSYW5nZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5kcmF3KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0U3RhcnRSYW5nZTogZnVuY3Rpb24odmFsdWUpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuX28uc3RhcnRSYW5nZSA9IHZhbHVlO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldEVuZFJhbmdlOiBmdW5jdGlvbih2YWx1ZSlcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5fby5lbmRSYW5nZSA9IHZhbHVlO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZWZyZXNoIHRoZSBIVE1MXG4gICAgICAgICAqL1xuICAgICAgICBkcmF3OiBmdW5jdGlvbihmb3JjZSlcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl92ICYmICFmb3JjZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvcHRzID0gdGhpcy5fbyxcbiAgICAgICAgICAgICAgICBtaW5ZZWFyID0gb3B0cy5taW5ZZWFyLFxuICAgICAgICAgICAgICAgIG1heFllYXIgPSBvcHRzLm1heFllYXIsXG4gICAgICAgICAgICAgICAgbWluTW9udGggPSBvcHRzLm1pbk1vbnRoLFxuICAgICAgICAgICAgICAgIG1heE1vbnRoID0gb3B0cy5tYXhNb250aCxcbiAgICAgICAgICAgICAgICBodG1sID0gJycsXG4gICAgICAgICAgICAgICAgcmFuZElkO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5feSA8PSBtaW5ZZWFyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5feSA9IG1pblllYXI7XG4gICAgICAgICAgICAgICAgaWYgKCFpc05hTihtaW5Nb250aCkgJiYgdGhpcy5fbSA8IG1pbk1vbnRoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX20gPSBtaW5Nb250aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5feSA+PSBtYXhZZWFyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5feSA9IG1heFllYXI7XG4gICAgICAgICAgICAgICAgaWYgKCFpc05hTihtYXhNb250aCkgJiYgdGhpcy5fbSA+IG1heE1vbnRoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX20gPSBtYXhNb250aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJhbmRJZCA9ICdwaWthLXRpdGxlLScgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5yZXBsYWNlKC9bXmEtel0rL2csICcnKS5zdWJzdHIoMCwgMik7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGMgPSAwOyBjIDwgb3B0cy5udW1iZXJPZk1vbnRoczsgYysrKSB7XG4gICAgICAgICAgICAgICAgaHRtbCArPSAnPGRpdiBjbGFzcz1cInBpa2EtbGVuZGFyXCI+JyArIHJlbmRlclRpdGxlKHRoaXMsIGMsIHRoaXMuY2FsZW5kYXJzW2NdLnllYXIsIHRoaXMuY2FsZW5kYXJzW2NdLm1vbnRoLCB0aGlzLmNhbGVuZGFyc1swXS55ZWFyLCByYW5kSWQpICsgdGhpcy5yZW5kZXIodGhpcy5jYWxlbmRhcnNbY10ueWVhciwgdGhpcy5jYWxlbmRhcnNbY10ubW9udGgsIHJhbmRJZCkgKyAnPC9kaXY+JztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5lbC5pbm5lckhUTUwgPSBodG1sO1xuXG4gICAgICAgICAgICBpZiAob3B0cy5ib3VuZCkge1xuICAgICAgICAgICAgICAgIGlmKG9wdHMuZmllbGQudHlwZSAhPT0gJ2hpZGRlbicpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RvKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0cy50cmlnZ2VyLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLl9vLm9uRHJhdyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHRoaXMuX28ub25EcmF3KHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAob3B0cy5ib3VuZCkge1xuICAgICAgICAgICAgICAgIC8vIGxldCB0aGUgc2NyZWVuIHJlYWRlciB1c2VyIGtub3cgdG8gdXNlIGFycm93IGtleXNcbiAgICAgICAgICAgICAgICBvcHRzLmZpZWxkLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdVc2UgdGhlIGFycm93IGtleXMgdG8gcGljayBhIGRhdGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBhZGp1c3RQb3NpdGlvbjogZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgZmllbGQsIHBFbCwgd2lkdGgsIGhlaWdodCwgdmlld3BvcnRXaWR0aCwgdmlld3BvcnRIZWlnaHQsIHNjcm9sbFRvcCwgbGVmdCwgdG9wLCBjbGllbnRSZWN0O1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fby5jb250YWluZXIpIHJldHVybjtcblxuICAgICAgICAgICAgdGhpcy5lbC5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG5cbiAgICAgICAgICAgIGZpZWxkID0gdGhpcy5fby50cmlnZ2VyO1xuICAgICAgICAgICAgcEVsID0gZmllbGQ7XG4gICAgICAgICAgICB3aWR0aCA9IHRoaXMuZWwub2Zmc2V0V2lkdGg7XG4gICAgICAgICAgICBoZWlnaHQgPSB0aGlzLmVsLm9mZnNldEhlaWdodDtcbiAgICAgICAgICAgIHZpZXdwb3J0V2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGg7XG4gICAgICAgICAgICB2aWV3cG9ydEhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuICAgICAgICAgICAgc2Nyb2xsVG9wID0gd2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgZmllbGQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgY2xpZW50UmVjdCA9IGZpZWxkLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgICAgICAgIGxlZnQgPSBjbGllbnRSZWN0LmxlZnQgKyB3aW5kb3cucGFnZVhPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdG9wID0gY2xpZW50UmVjdC5ib3R0b20gKyB3aW5kb3cucGFnZVlPZmZzZXQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGxlZnQgPSBwRWwub2Zmc2V0TGVmdDtcbiAgICAgICAgICAgICAgICB0b3AgID0gcEVsLm9mZnNldFRvcCArIHBFbC5vZmZzZXRIZWlnaHQ7XG4gICAgICAgICAgICAgICAgd2hpbGUoKHBFbCA9IHBFbC5vZmZzZXRQYXJlbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxlZnQgKz0gcEVsLm9mZnNldExlZnQ7XG4gICAgICAgICAgICAgICAgICAgIHRvcCAgKz0gcEVsLm9mZnNldFRvcDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGRlZmF1bHQgcG9zaXRpb24gaXMgYm90dG9tICYgbGVmdFxuICAgICAgICAgICAgaWYgKCh0aGlzLl9vLnJlcG9zaXRpb24gJiYgbGVmdCArIHdpZHRoID4gdmlld3BvcnRXaWR0aCkgfHxcbiAgICAgICAgICAgICAgICAoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX28ucG9zaXRpb24uaW5kZXhPZigncmlnaHQnKSA+IC0xICYmXG4gICAgICAgICAgICAgICAgICAgIGxlZnQgLSB3aWR0aCArIGZpZWxkLm9mZnNldFdpZHRoID4gMFxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIGxlZnQgPSBsZWZ0IC0gd2lkdGggKyBmaWVsZC5vZmZzZXRXaWR0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgodGhpcy5fby5yZXBvc2l0aW9uICYmIHRvcCArIGhlaWdodCA+IHZpZXdwb3J0SGVpZ2h0ICsgc2Nyb2xsVG9wKSB8fFxuICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fby5wb3NpdGlvbi5pbmRleE9mKCd0b3AnKSA+IC0xICYmXG4gICAgICAgICAgICAgICAgICAgIHRvcCAtIGhlaWdodCAtIGZpZWxkLm9mZnNldEhlaWdodCA+IDBcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICB0b3AgPSB0b3AgLSBoZWlnaHQgLSBmaWVsZC5vZmZzZXRIZWlnaHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuZWwuc3R5bGUubGVmdCA9IGxlZnQgKyAncHgnO1xuICAgICAgICAgICAgdGhpcy5lbC5zdHlsZS50b3AgPSB0b3AgKyAncHgnO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiByZW5kZXIgSFRNTCBmb3IgYSBwYXJ0aWN1bGFyIG1vbnRoXG4gICAgICAgICAqL1xuICAgICAgICByZW5kZXI6IGZ1bmN0aW9uKHllYXIsIG1vbnRoLCByYW5kSWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBvcHRzICAgPSB0aGlzLl9vLFxuICAgICAgICAgICAgICAgIG5vdyAgICA9IG5ldyBEYXRlKCksXG4gICAgICAgICAgICAgICAgZGF5cyAgID0gZ2V0RGF5c0luTW9udGgoeWVhciwgbW9udGgpLFxuICAgICAgICAgICAgICAgIGJlZm9yZSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoLCAxKS5nZXREYXkoKSxcbiAgICAgICAgICAgICAgICBkYXRhICAgPSBbXSxcbiAgICAgICAgICAgICAgICByb3cgICAgPSBbXTtcbiAgICAgICAgICAgIHNldFRvU3RhcnRPZkRheShub3cpO1xuICAgICAgICAgICAgaWYgKG9wdHMuZmlyc3REYXkgPiAwKSB7XG4gICAgICAgICAgICAgICAgYmVmb3JlIC09IG9wdHMuZmlyc3REYXk7XG4gICAgICAgICAgICAgICAgaWYgKGJlZm9yZSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgYmVmb3JlICs9IDc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHByZXZpb3VzTW9udGggPSBtb250aCA9PT0gMCA/IDExIDogbW9udGggLSAxLFxuICAgICAgICAgICAgICAgIG5leHRNb250aCA9IG1vbnRoID09PSAxMSA/IDAgOiBtb250aCArIDEsXG4gICAgICAgICAgICAgICAgeWVhck9mUHJldmlvdXNNb250aCA9IG1vbnRoID09PSAwID8geWVhciAtIDEgOiB5ZWFyLFxuICAgICAgICAgICAgICAgIHllYXJPZk5leHRNb250aCA9IG1vbnRoID09PSAxMSA/IHllYXIgKyAxIDogeWVhcixcbiAgICAgICAgICAgICAgICBkYXlzSW5QcmV2aW91c01vbnRoID0gZ2V0RGF5c0luTW9udGgoeWVhck9mUHJldmlvdXNNb250aCwgcHJldmlvdXNNb250aCk7XG4gICAgICAgICAgICB2YXIgY2VsbHMgPSBkYXlzICsgYmVmb3JlLFxuICAgICAgICAgICAgICAgIGFmdGVyID0gY2VsbHM7XG4gICAgICAgICAgICB3aGlsZShhZnRlciA+IDcpIHtcbiAgICAgICAgICAgICAgICBhZnRlciAtPSA3O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2VsbHMgKz0gNyAtIGFmdGVyO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIHIgPSAwOyBpIDwgY2VsbHM7IGkrKylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF5ID0gbmV3IERhdGUoeWVhciwgbW9udGgsIDEgKyAoaSAtIGJlZm9yZSkpLFxuICAgICAgICAgICAgICAgICAgICBpc1NlbGVjdGVkID0gaXNEYXRlKHRoaXMuX2QpID8gY29tcGFyZURhdGVzKGRheSwgdGhpcy5fZCkgOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgaXNUb2RheSA9IGNvbXBhcmVEYXRlcyhkYXksIG5vdyksXG4gICAgICAgICAgICAgICAgICAgIGlzRW1wdHkgPSBpIDwgYmVmb3JlIHx8IGkgPj0gKGRheXMgKyBiZWZvcmUpLFxuICAgICAgICAgICAgICAgICAgICBkYXlOdW1iZXIgPSAxICsgKGkgLSBiZWZvcmUpLFxuICAgICAgICAgICAgICAgICAgICBtb250aE51bWJlciA9IG1vbnRoLFxuICAgICAgICAgICAgICAgICAgICB5ZWFyTnVtYmVyID0geWVhcixcbiAgICAgICAgICAgICAgICAgICAgaXNTdGFydFJhbmdlID0gb3B0cy5zdGFydFJhbmdlICYmIGNvbXBhcmVEYXRlcyhvcHRzLnN0YXJ0UmFuZ2UsIGRheSksXG4gICAgICAgICAgICAgICAgICAgIGlzRW5kUmFuZ2UgPSBvcHRzLmVuZFJhbmdlICYmIGNvbXBhcmVEYXRlcyhvcHRzLmVuZFJhbmdlLCBkYXkpLFxuICAgICAgICAgICAgICAgICAgICBpc0luUmFuZ2UgPSBvcHRzLnN0YXJ0UmFuZ2UgJiYgb3B0cy5lbmRSYW5nZSAmJiBvcHRzLnN0YXJ0UmFuZ2UgPCBkYXkgJiYgZGF5IDwgb3B0cy5lbmRSYW5nZSxcbiAgICAgICAgICAgICAgICAgICAgaXNEaXNhYmxlZCA9IChvcHRzLm1pbkRhdGUgJiYgZGF5IDwgb3B0cy5taW5EYXRlKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKG9wdHMubWF4RGF0ZSAmJiBkYXkgPiBvcHRzLm1heERhdGUpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAob3B0cy5kaXNhYmxlV2Vla2VuZHMgJiYgaXNXZWVrZW5kKGRheSkpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAob3B0cy5kaXNhYmxlRGF5Rm4gJiYgb3B0cy5kaXNhYmxlRGF5Rm4oZGF5KSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNFbXB0eSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IGJlZm9yZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF5TnVtYmVyID0gZGF5c0luUHJldmlvdXNNb250aCArIGRheU51bWJlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vbnRoTnVtYmVyID0gcHJldmlvdXNNb250aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHllYXJOdW1iZXIgPSB5ZWFyT2ZQcmV2aW91c01vbnRoO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF5TnVtYmVyID0gZGF5TnVtYmVyIC0gZGF5cztcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vbnRoTnVtYmVyID0gbmV4dE1vbnRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgeWVhck51bWJlciA9IHllYXJPZk5leHRNb250aDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBkYXlDb25maWcgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXk6IGRheU51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vbnRoOiBtb250aE51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHllYXI6IHllYXJOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc1NlbGVjdGVkOiBpc1NlbGVjdGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNUb2RheTogaXNUb2RheSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzRGlzYWJsZWQ6IGlzRGlzYWJsZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0VtcHR5OiBpc0VtcHR5LFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNTdGFydFJhbmdlOiBpc1N0YXJ0UmFuZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0VuZFJhbmdlOiBpc0VuZFJhbmdlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNJblJhbmdlOiBpc0luUmFuZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaG93RGF5c0luTmV4dEFuZFByZXZpb3VzTW9udGhzOiBvcHRzLnNob3dEYXlzSW5OZXh0QW5kUHJldmlvdXNNb250aHNcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHJvdy5wdXNoKHJlbmRlckRheShkYXlDb25maWcpKTtcblxuICAgICAgICAgICAgICAgIGlmICgrK3IgPT09IDcpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wdHMuc2hvd1dlZWtOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdy51bnNoaWZ0KHJlbmRlcldlZWsoaSAtIGJlZm9yZSwgbW9udGgsIHllYXIpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkYXRhLnB1c2gocmVuZGVyUm93KHJvdywgb3B0cy5pc1JUTCkpO1xuICAgICAgICAgICAgICAgICAgICByb3cgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgciA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlbmRlclRhYmxlKG9wdHMsIGRhdGEsIHJhbmRJZCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaXNWaXNpYmxlOiBmdW5jdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl92O1xuICAgICAgICB9LFxuXG4gICAgICAgIHNob3c6IGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmlzVmlzaWJsZSgpKSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3ModGhpcy5lbCwgJ2lzLWhpZGRlbicpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3YgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuZHJhdygpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vLmJvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIGFkZEV2ZW50KGRvY3VtZW50LCAnY2xpY2snLCB0aGlzLl9vbkNsaWNrKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGp1c3RQb3NpdGlvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuX28ub25PcGVuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX28ub25PcGVuLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGhpZGU6IGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIHYgPSB0aGlzLl92O1xuICAgICAgICAgICAgaWYgKHYgIT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX28uYm91bmQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlRXZlbnQoZG9jdW1lbnQsICdjbGljaycsIHRoaXMuX29uQ2xpY2spO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmVsLnN0eWxlLnBvc2l0aW9uID0gJ3N0YXRpYyc7IC8vIHJlc2V0XG4gICAgICAgICAgICAgICAgdGhpcy5lbC5zdHlsZS5sZWZ0ID0gJ2F1dG8nO1xuICAgICAgICAgICAgICAgIHRoaXMuZWwuc3R5bGUudG9wID0gJ2F1dG8nO1xuICAgICAgICAgICAgICAgIGFkZENsYXNzKHRoaXMuZWwsICdpcy1oaWRkZW4nKTtcbiAgICAgICAgICAgICAgICB0aGlzLl92ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKHYgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgdGhpcy5fby5vbkNsb3NlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX28ub25DbG9zZS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogR0FNRSBPVkVSXG4gICAgICAgICAqL1xuICAgICAgICBkZXN0cm95OiBmdW5jdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICAgICAgcmVtb3ZlRXZlbnQodGhpcy5lbCwgJ21vdXNlZG93bicsIHRoaXMuX29uTW91c2VEb3duLCB0cnVlKTtcbiAgICAgICAgICAgIHJlbW92ZUV2ZW50KHRoaXMuZWwsICd0b3VjaGVuZCcsIHRoaXMuX29uTW91c2VEb3duLCB0cnVlKTtcbiAgICAgICAgICAgIHJlbW92ZUV2ZW50KHRoaXMuZWwsICdjaGFuZ2UnLCB0aGlzLl9vbkNoYW5nZSk7XG4gICAgICAgICAgICBpZiAodGhpcy5fby5maWVsZCkge1xuICAgICAgICAgICAgICAgIHJlbW92ZUV2ZW50KHRoaXMuX28uZmllbGQsICdjaGFuZ2UnLCB0aGlzLl9vbklucHV0Q2hhbmdlKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fby5ib3VuZCkge1xuICAgICAgICAgICAgICAgICAgICByZW1vdmVFdmVudCh0aGlzLl9vLnRyaWdnZXIsICdjbGljaycsIHRoaXMuX29uSW5wdXRDbGljayk7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUV2ZW50KHRoaXMuX28udHJpZ2dlciwgJ2ZvY3VzJywgdGhpcy5fb25JbnB1dEZvY3VzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlRXZlbnQodGhpcy5fby50cmlnZ2VyLCAnYmx1cicsIHRoaXMuX29uSW5wdXRCbHVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5lbC5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9O1xuXG4gICAgcmV0dXJuIFBpa2FkYXk7XG5cbn0pKTtcblxufSx7XCJtb21lbnRcIjpcIm1vbWVudFwifV0sXCJ6ZXJvY2xpcGJvYXJkXCI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuLyohXG4gKiBaZXJvQ2xpcGJvYXJkXG4gKiBUaGUgWmVyb0NsaXBib2FyZCBsaWJyYXJ5IHByb3ZpZGVzIGFuIGVhc3kgd2F5IHRvIGNvcHkgdGV4dCB0byB0aGUgY2xpcGJvYXJkIHVzaW5nIGFuIGludmlzaWJsZSBBZG9iZSBGbGFzaCBtb3ZpZSBhbmQgYSBKYXZhU2NyaXB0IGludGVyZmFjZVxuICogQ29weXJpZ2h0IChjKSAyMDA5LTIwMTYgSm9uIFJvaGFuLCBKYW1lcyBNLiBHcmVlbmVcbiAqIExpY2Vuc2VkIE1JVFxuICogaHR0cDovL3plcm9jbGlwYm9hcmQub3JnL1xuICogdjIuMy4wXG4gKi9cbihmdW5jdGlvbih3aW5kb3csIHVuZGVmaW5lZCkge1xuICBcInVzZSBzdHJpY3RcIjtcbiAgLyoqXG4gKiBTdG9yZSByZWZlcmVuY2VzIHRvIGNyaXRpY2FsbHkgaW1wb3J0YW50IGdsb2JhbCBmdW5jdGlvbnMgdGhhdCBtYXkgYmVcbiAqIG92ZXJyaWRkZW4gb24gY2VydGFpbiB3ZWIgcGFnZXMuXG4gKi9cbiAgdmFyIF93aW5kb3cgPSB3aW5kb3csIF9kb2N1bWVudCA9IF93aW5kb3cuZG9jdW1lbnQsIF9uYXZpZ2F0b3IgPSBfd2luZG93Lm5hdmlnYXRvciwgX3NldFRpbWVvdXQgPSBfd2luZG93LnNldFRpbWVvdXQsIF9jbGVhclRpbWVvdXQgPSBfd2luZG93LmNsZWFyVGltZW91dCwgX3NldEludGVydmFsID0gX3dpbmRvdy5zZXRJbnRlcnZhbCwgX2NsZWFySW50ZXJ2YWwgPSBfd2luZG93LmNsZWFySW50ZXJ2YWwsIF9nZXRDb21wdXRlZFN0eWxlID0gX3dpbmRvdy5nZXRDb21wdXRlZFN0eWxlLCBfZW5jb2RlVVJJQ29tcG9uZW50ID0gX3dpbmRvdy5lbmNvZGVVUklDb21wb25lbnQsIF9BY3RpdmVYT2JqZWN0ID0gX3dpbmRvdy5BY3RpdmVYT2JqZWN0LCBfRXJyb3IgPSBfd2luZG93LkVycm9yLCBfcGFyc2VJbnQgPSBfd2luZG93Lk51bWJlci5wYXJzZUludCB8fCBfd2luZG93LnBhcnNlSW50LCBfcGFyc2VGbG9hdCA9IF93aW5kb3cuTnVtYmVyLnBhcnNlRmxvYXQgfHwgX3dpbmRvdy5wYXJzZUZsb2F0LCBfaXNOYU4gPSBfd2luZG93Lk51bWJlci5pc05hTiB8fCBfd2luZG93LmlzTmFOLCBfbm93ID0gX3dpbmRvdy5EYXRlLm5vdywgX2tleXMgPSBfd2luZG93Lk9iamVjdC5rZXlzLCBfaGFzT3duID0gX3dpbmRvdy5PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LCBfc2xpY2UgPSBfd2luZG93LkFycmF5LnByb3RvdHlwZS5zbGljZSwgX3Vud3JhcCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB1bndyYXBwZXIgPSBmdW5jdGlvbihlbCkge1xuICAgICAgcmV0dXJuIGVsO1xuICAgIH07XG4gICAgaWYgKHR5cGVvZiBfd2luZG93LndyYXAgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgX3dpbmRvdy51bndyYXAgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdmFyIGRpdiA9IF9kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB2YXIgdW53cmFwcGVkRGl2ID0gX3dpbmRvdy51bndyYXAoZGl2KTtcbiAgICAgICAgaWYgKGRpdi5ub2RlVHlwZSA9PT0gMSAmJiB1bndyYXBwZWREaXYgJiYgdW53cmFwcGVkRGl2Lm5vZGVUeXBlID09PSAxKSB7XG4gICAgICAgICAgdW53cmFwcGVyID0gX3dpbmRvdy51bndyYXA7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgfVxuICAgIHJldHVybiB1bndyYXBwZXI7XG4gIH0oKTtcbiAgLyoqXG4gKiBDb252ZXJ0IGFuIGBhcmd1bWVudHNgIG9iamVjdCBpbnRvIGFuIEFycmF5LlxuICpcbiAqIEByZXR1cm5zIFRoZSBhcmd1bWVudHMgYXMgYW4gQXJyYXlcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9hcmdzID0gZnVuY3Rpb24oYXJndW1lbnRzT2JqKSB7XG4gICAgcmV0dXJuIF9zbGljZS5jYWxsKGFyZ3VtZW50c09iaiwgMCk7XG4gIH07XG4gIC8qKlxuICogU2hhbGxvdy1jb3B5IHRoZSBvd25lZCwgZW51bWVyYWJsZSBwcm9wZXJ0aWVzIG9mIG9uZSBvYmplY3Qgb3ZlciB0byBhbm90aGVyLCBzaW1pbGFyIHRvIGpRdWVyeSdzIGAkLmV4dGVuZGAuXG4gKlxuICogQHJldHVybnMgVGhlIHRhcmdldCBvYmplY3QsIGF1Z21lbnRlZFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2V4dGVuZCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBpLCBsZW4sIGFyZywgcHJvcCwgc3JjLCBjb3B5LCBhcmdzID0gX2FyZ3MoYXJndW1lbnRzKSwgdGFyZ2V0ID0gYXJnc1swXSB8fCB7fTtcbiAgICBmb3IgKGkgPSAxLCBsZW4gPSBhcmdzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBpZiAoKGFyZyA9IGFyZ3NbaV0pICE9IG51bGwpIHtcbiAgICAgICAgZm9yIChwcm9wIGluIGFyZykge1xuICAgICAgICAgIGlmIChfaGFzT3duLmNhbGwoYXJnLCBwcm9wKSkge1xuICAgICAgICAgICAgc3JjID0gdGFyZ2V0W3Byb3BdO1xuICAgICAgICAgICAgY29weSA9IGFyZ1twcm9wXTtcbiAgICAgICAgICAgIGlmICh0YXJnZXQgIT09IGNvcHkgJiYgY29weSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgIHRhcmdldFtwcm9wXSA9IGNvcHk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXQ7XG4gIH07XG4gIC8qKlxuICogUmV0dXJuIGEgZGVlcCBjb3B5IG9mIHRoZSBzb3VyY2Ugb2JqZWN0IG9yIGFycmF5LlxuICpcbiAqIEByZXR1cm5zIE9iamVjdCBvciBBcnJheVxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2RlZXBDb3B5ID0gZnVuY3Rpb24oc291cmNlKSB7XG4gICAgdmFyIGNvcHksIGksIGxlbiwgcHJvcDtcbiAgICBpZiAodHlwZW9mIHNvdXJjZSAhPT0gXCJvYmplY3RcIiB8fCBzb3VyY2UgPT0gbnVsbCB8fCB0eXBlb2Ygc291cmNlLm5vZGVUeXBlID09PSBcIm51bWJlclwiKSB7XG4gICAgICBjb3B5ID0gc291cmNlO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHNvdXJjZS5sZW5ndGggPT09IFwibnVtYmVyXCIpIHtcbiAgICAgIGNvcHkgPSBbXTtcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IHNvdXJjZS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKHNvdXJjZSwgaSkpIHtcbiAgICAgICAgICBjb3B5W2ldID0gX2RlZXBDb3B5KHNvdXJjZVtpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29weSA9IHt9O1xuICAgICAgZm9yIChwcm9wIGluIHNvdXJjZSkge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKHNvdXJjZSwgcHJvcCkpIHtcbiAgICAgICAgICBjb3B5W3Byb3BdID0gX2RlZXBDb3B5KHNvdXJjZVtwcm9wXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNvcHk7XG4gIH07XG4gIC8qKlxuICogTWFrZXMgYSBzaGFsbG93IGNvcHkgb2YgYG9iamAgKGxpa2UgYF9leHRlbmRgKSBidXQgZmlsdGVycyBpdHMgcHJvcGVydGllcyBiYXNlZCBvbiBhIGxpc3Qgb2YgYGtleXNgIHRvIGtlZXAuXG4gKiBUaGUgaW52ZXJzZSBvZiBgX29taXRgLCBtb3N0bHkuIFRoZSBiaWcgZGlmZmVyZW5jZSBpcyB0aGF0IHRoZXNlIHByb3BlcnRpZXMgZG8gTk9UIG5lZWQgdG8gYmUgZW51bWVyYWJsZSB0b1xuICogYmUga2VwdC5cbiAqXG4gKiBAcmV0dXJucyBBIG5ldyBmaWx0ZXJlZCBvYmplY3QuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfcGljayA9IGZ1bmN0aW9uKG9iaiwga2V5cykge1xuICAgIHZhciBuZXdPYmogPSB7fTtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0ga2V5cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgaWYgKGtleXNbaV0gaW4gb2JqKSB7XG4gICAgICAgIG5ld09ialtrZXlzW2ldXSA9IG9ialtrZXlzW2ldXTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ld09iajtcbiAgfTtcbiAgLyoqXG4gKiBNYWtlcyBhIHNoYWxsb3cgY29weSBvZiBgb2JqYCAobGlrZSBgX2V4dGVuZGApIGJ1dCBmaWx0ZXJzIGl0cyBwcm9wZXJ0aWVzIGJhc2VkIG9uIGEgbGlzdCBvZiBga2V5c2AgdG8gb21pdC5cbiAqIFRoZSBpbnZlcnNlIG9mIGBfcGlja2AuXG4gKlxuICogQHJldHVybnMgQSBuZXcgZmlsdGVyZWQgb2JqZWN0LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX29taXQgPSBmdW5jdGlvbihvYmosIGtleXMpIHtcbiAgICB2YXIgbmV3T2JqID0ge307XG4gICAgZm9yICh2YXIgcHJvcCBpbiBvYmopIHtcbiAgICAgIGlmIChrZXlzLmluZGV4T2YocHJvcCkgPT09IC0xKSB7XG4gICAgICAgIG5ld09ialtwcm9wXSA9IG9ialtwcm9wXTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ld09iajtcbiAgfTtcbiAgLyoqXG4gKiBSZW1vdmUgYWxsIG93bmVkLCBlbnVtZXJhYmxlIHByb3BlcnRpZXMgZnJvbSBhbiBvYmplY3QuXG4gKlxuICogQHJldHVybnMgVGhlIG9yaWdpbmFsIG9iamVjdCB3aXRob3V0IGl0cyBvd25lZCwgZW51bWVyYWJsZSBwcm9wZXJ0aWVzLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2RlbGV0ZU93blByb3BlcnRpZXMgPSBmdW5jdGlvbihvYmopIHtcbiAgICBpZiAob2JqKSB7XG4gICAgICBmb3IgKHZhciBwcm9wIGluIG9iaikge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKG9iaiwgcHJvcCkpIHtcbiAgICAgICAgICBkZWxldGUgb2JqW3Byb3BdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmo7XG4gIH07XG4gIC8qKlxuICogRGV0ZXJtaW5lIGlmIGFuIGVsZW1lbnQgaXMgY29udGFpbmVkIHdpdGhpbiBhbm90aGVyIGVsZW1lbnQuXG4gKlxuICogQHJldHVybnMgQm9vbGVhblxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NvbnRhaW5lZEJ5ID0gZnVuY3Rpb24oZWwsIGFuY2VzdG9yRWwpIHtcbiAgICBpZiAoZWwgJiYgZWwubm9kZVR5cGUgPT09IDEgJiYgZWwub3duZXJEb2N1bWVudCAmJiBhbmNlc3RvckVsICYmIChhbmNlc3RvckVsLm5vZGVUeXBlID09PSAxICYmIGFuY2VzdG9yRWwub3duZXJEb2N1bWVudCAmJiBhbmNlc3RvckVsLm93bmVyRG9jdW1lbnQgPT09IGVsLm93bmVyRG9jdW1lbnQgfHwgYW5jZXN0b3JFbC5ub2RlVHlwZSA9PT0gOSAmJiAhYW5jZXN0b3JFbC5vd25lckRvY3VtZW50ICYmIGFuY2VzdG9yRWwgPT09IGVsLm93bmVyRG9jdW1lbnQpKSB7XG4gICAgICBkbyB7XG4gICAgICAgIGlmIChlbCA9PT0gYW5jZXN0b3JFbCkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsID0gZWwucGFyZW50Tm9kZTtcbiAgICAgIH0gd2hpbGUgKGVsKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuICAvKipcbiAqIEdldCB0aGUgVVJMIHBhdGgncyBwYXJlbnQgZGlyZWN0b3J5LlxuICpcbiAqIEByZXR1cm5zIFN0cmluZyBvciBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldERpclBhdGhPZlVybCA9IGZ1bmN0aW9uKHVybCkge1xuICAgIHZhciBkaXI7XG4gICAgaWYgKHR5cGVvZiB1cmwgPT09IFwic3RyaW5nXCIgJiYgdXJsKSB7XG4gICAgICBkaXIgPSB1cmwuc3BsaXQoXCIjXCIpWzBdLnNwbGl0KFwiP1wiKVswXTtcbiAgICAgIGRpciA9IHVybC5zbGljZSgwLCB1cmwubGFzdEluZGV4T2YoXCIvXCIpICsgMSk7XG4gICAgfVxuICAgIHJldHVybiBkaXI7XG4gIH07XG4gIC8qKlxuICogR2V0IHRoZSBjdXJyZW50IHNjcmlwdCdzIFVSTCBieSB0aHJvd2luZyBhbiBgRXJyb3JgIGFuZCBhbmFseXppbmcgaXQuXG4gKlxuICogQHJldHVybnMgU3RyaW5nIG9yIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0Q3VycmVudFNjcmlwdFVybEZyb21FcnJvclN0YWNrID0gZnVuY3Rpb24oc3RhY2spIHtcbiAgICB2YXIgdXJsLCBtYXRjaGVzO1xuICAgIGlmICh0eXBlb2Ygc3RhY2sgPT09IFwic3RyaW5nXCIgJiYgc3RhY2spIHtcbiAgICAgIG1hdGNoZXMgPSBzdGFjay5tYXRjaCgvXig/OnxbXjpAXSpAfC4rXFwpQCg/PWh0dHBbc10/fGZpbGUpfC4rP1xccysoPzogYXQgfEApKD86W146XFwoXSsgKSpbXFwoXT8pKCg/Omh0dHBbc10/fGZpbGUpOlxcL1xcL1tcXC9dPy4rP1xcL1teOlxcKV0qPykoPzo6XFxkKykoPzo6XFxkKyk/Lyk7XG4gICAgICBpZiAobWF0Y2hlcyAmJiBtYXRjaGVzWzFdKSB7XG4gICAgICAgIHVybCA9IG1hdGNoZXNbMV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtYXRjaGVzID0gc3RhY2subWF0Y2goL1xcKUAoKD86aHR0cFtzXT98ZmlsZSk6XFwvXFwvW1xcL10/Lis/XFwvW146XFwpXSo/KSg/OjpcXGQrKSg/OjpcXGQrKT8vKTtcbiAgICAgICAgaWYgKG1hdGNoZXMgJiYgbWF0Y2hlc1sxXSkge1xuICAgICAgICAgIHVybCA9IG1hdGNoZXNbMV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHVybDtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgdGhlIGN1cnJlbnQgc2NyaXB0J3MgVVJMIGJ5IHRocm93aW5nIGFuIGBFcnJvcmAgYW5kIGFuYWx5emluZyBpdC5cbiAqXG4gKiBAcmV0dXJucyBTdHJpbmcgb3IgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXRDdXJyZW50U2NyaXB0VXJsRnJvbUVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHVybCwgZXJyO1xuICAgIHRyeSB7XG4gICAgICB0aHJvdyBuZXcgX0Vycm9yKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgZXJyID0gZTtcbiAgICB9XG4gICAgaWYgKGVycikge1xuICAgICAgdXJsID0gZXJyLnNvdXJjZVVSTCB8fCBlcnIuZmlsZU5hbWUgfHwgX2dldEN1cnJlbnRTY3JpcHRVcmxGcm9tRXJyb3JTdGFjayhlcnIuc3RhY2spO1xuICAgIH1cbiAgICByZXR1cm4gdXJsO1xuICB9O1xuICAvKipcbiAqIEdldCB0aGUgY3VycmVudCBzY3JpcHQncyBVUkwuXG4gKlxuICogQHJldHVybnMgU3RyaW5nIG9yIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0Q3VycmVudFNjcmlwdFVybCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBqc1BhdGgsIHNjcmlwdHMsIGk7XG4gICAgaWYgKF9kb2N1bWVudC5jdXJyZW50U2NyaXB0ICYmIChqc1BhdGggPSBfZG9jdW1lbnQuY3VycmVudFNjcmlwdC5zcmMpKSB7XG4gICAgICByZXR1cm4ganNQYXRoO1xuICAgIH1cbiAgICBzY3JpcHRzID0gX2RvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO1xuICAgIGlmIChzY3JpcHRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgcmV0dXJuIHNjcmlwdHNbMF0uc3JjIHx8IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgaWYgKFwicmVhZHlTdGF0ZVwiIGluIChzY3JpcHRzWzBdIHx8IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIikpKSB7XG4gICAgICBmb3IgKGkgPSBzY3JpcHRzLmxlbmd0aDsgaS0tOyApIHtcbiAgICAgICAgaWYgKHNjcmlwdHNbaV0ucmVhZHlTdGF0ZSA9PT0gXCJpbnRlcmFjdGl2ZVwiICYmIChqc1BhdGggPSBzY3JpcHRzW2ldLnNyYykpIHtcbiAgICAgICAgICByZXR1cm4ganNQYXRoO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChfZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gXCJsb2FkaW5nXCIgJiYgKGpzUGF0aCA9IHNjcmlwdHNbc2NyaXB0cy5sZW5ndGggLSAxXS5zcmMpKSB7XG4gICAgICByZXR1cm4ganNQYXRoO1xuICAgIH1cbiAgICBpZiAoanNQYXRoID0gX2dldEN1cnJlbnRTY3JpcHRVcmxGcm9tRXJyb3IoKSkge1xuICAgICAgcmV0dXJuIGpzUGF0aDtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgdGhlIHVuYW5pbW91cyBwYXJlbnQgZGlyZWN0b3J5IG9mIEFMTCBzY3JpcHQgdGFncy5cbiAqIElmIGFueSBzY3JpcHQgdGFncyBhcmUgZWl0aGVyIChhKSBpbmxpbmUgb3IgKGIpIGZyb20gZGlmZmVyaW5nIHBhcmVudFxuICogZGlyZWN0b3JpZXMsIHRoaXMgbWV0aG9kIG11c3QgcmV0dXJuIGB1bmRlZmluZWRgLlxuICpcbiAqIEByZXR1cm5zIFN0cmluZyBvciBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldFVuYW5pbW91c1NjcmlwdFBhcmVudERpciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBpLCBqc0RpciwganNQYXRoLCBzY3JpcHRzID0gX2RvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO1xuICAgIGZvciAoaSA9IHNjcmlwdHMubGVuZ3RoOyBpLS07ICkge1xuICAgICAgaWYgKCEoanNQYXRoID0gc2NyaXB0c1tpXS5zcmMpKSB7XG4gICAgICAgIGpzRGlyID0gbnVsbDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBqc1BhdGggPSBfZ2V0RGlyUGF0aE9mVXJsKGpzUGF0aCk7XG4gICAgICBpZiAoanNEaXIgPT0gbnVsbCkge1xuICAgICAgICBqc0RpciA9IGpzUGF0aDtcbiAgICAgIH0gZWxzZSBpZiAoanNEaXIgIT09IGpzUGF0aCkge1xuICAgICAgICBqc0RpciA9IG51bGw7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ganNEaXIgfHwgdW5kZWZpbmVkO1xuICB9O1xuICAvKipcbiAqIEdldCB0aGUgcHJlc3VtZWQgbG9jYXRpb24gb2YgdGhlIFwiWmVyb0NsaXBib2FyZC5zd2ZcIiBmaWxlLCBiYXNlZCBvbiB0aGUgbG9jYXRpb25cbiAqIG9mIHRoZSBleGVjdXRpbmcgSmF2YVNjcmlwdCBmaWxlIChlLmcuIFwiWmVyb0NsaXBib2FyZC5qc1wiLCBldGMuKS5cbiAqXG4gKiBAcmV0dXJucyBTdHJpbmdcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXREZWZhdWx0U3dmUGF0aCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBqc0RpciA9IF9nZXREaXJQYXRoT2ZVcmwoX2dldEN1cnJlbnRTY3JpcHRVcmwoKSkgfHwgX2dldFVuYW5pbW91c1NjcmlwdFBhcmVudERpcigpIHx8IFwiXCI7XG4gICAgcmV0dXJuIGpzRGlyICsgXCJaZXJvQ2xpcGJvYXJkLnN3ZlwiO1xuICB9O1xuICAvKipcbiAqIElzIHRoZSBjbGllbnQncyBvcGVyYXRpbmcgc3lzdGVtIHNvbWUgdmVyc2lvbiBvZiBXaW5kb3dzP1xuICpcbiAqIEByZXR1cm5zIEJvb2xlYW5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9pc1dpbmRvd3MgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaXNXaW5kb3dzUmVnZXggPSAvd2luKGRvd3N8W1xcc10/KG50fG1lfGNlfHhwfHZpc3RhfFtcXGRdKykpL2k7XG4gICAgcmV0dXJuICEhX25hdmlnYXRvciAmJiAoaXNXaW5kb3dzUmVnZXgudGVzdChfbmF2aWdhdG9yLmFwcFZlcnNpb24gfHwgXCJcIikgfHwgaXNXaW5kb3dzUmVnZXgudGVzdChfbmF2aWdhdG9yLnBsYXRmb3JtIHx8IFwiXCIpIHx8IChfbmF2aWdhdG9yLnVzZXJBZ2VudCB8fCBcIlwiKS5pbmRleE9mKFwiV2luZG93c1wiKSAhPT0gLTEpO1xuICB9O1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgaWYgdGhlIHBhZ2UgaXMgZnJhbWVkIChpbiBhbiBgaWZyYW1lYCkuIFRoaXMgY2FuIG5ldmVyIGNoYW5nZS5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9wYWdlSXNGcmFtZWQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX3dpbmRvdy5vcGVuZXIgPT0gbnVsbCAmJiAoISFfd2luZG93LnRvcCAmJiBfd2luZG93ICE9IF93aW5kb3cudG9wIHx8ICEhX3dpbmRvdy5wYXJlbnQgJiYgX3dpbmRvdyAhPSBfd2luZG93LnBhcmVudCk7XG4gIH0oKTtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIGlmIHRoZSBwYWdlIGlzIFhIVE1MICh2cy4gSFRNTCksIHdoaWNoIHJlcXVpcmVzIHRoYXQgZXZlcnl0aGluZ1xuICogYmUgcmVuZGVyaW5nIGluIFhNTCBtb2RlLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3BhZ2VJc1hodG1sID0gX2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5ub2RlTmFtZSA9PT0gXCJodG1sXCI7XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgc3RhdGUgb2YgdGhlIEZsYXNoIG9iamVjdC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9mbGFzaFN0YXRlID0ge1xuICAgIGJyaWRnZTogbnVsbCxcbiAgICB2ZXJzaW9uOiBcIjAuMC4wXCIsXG4gICAgcGx1Z2luVHlwZTogXCJ1bmtub3duXCIsXG4gICAgc2FuZGJveGVkOiBudWxsLFxuICAgIGRpc2FibGVkOiBudWxsLFxuICAgIG91dGRhdGVkOiBudWxsLFxuICAgIGluc2VjdXJlOiBudWxsLFxuICAgIHVuYXZhaWxhYmxlOiBudWxsLFxuICAgIGRlZ3JhZGVkOiBudWxsLFxuICAgIGRlYWN0aXZhdGVkOiBudWxsLFxuICAgIG92ZXJkdWU6IG51bGwsXG4gICAgcmVhZHk6IG51bGxcbiAgfTtcbiAgLyoqXG4gKiBUaGUgbWluaW11bSBGbGFzaCBQbGF5ZXIgdmVyc2lvbiByZXF1aXJlZCB0byB1c2UgWmVyb0NsaXBib2FyZCBjb21wbGV0ZWx5LlxuICogQHJlYWRvbmx5XG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfbWluaW11bUZsYXNoVmVyc2lvbiA9IFwiMTEuMC4wXCI7XG4gIC8qKlxuICogVGhlIFplcm9DbGlwYm9hcmQgbGlicmFyeSB2ZXJzaW9uIG51bWJlciwgYXMgcmVwb3J0ZWQgYnkgRmxhc2gsIGF0IHRoZSB0aW1lIHRoZSBTV0Ygd2FzIGNvbXBpbGVkLlxuICovXG4gIHZhciBfemNTd2ZWZXJzaW9uO1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgYWxsIGV2ZW50IGxpc3RlbmVyIHJlZ2lzdHJhdGlvbnMuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfaGFuZGxlcnMgPSB7fTtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIHRoZSBjdXJyZW50bHkgYWN0aXZhdGVkIGVsZW1lbnQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY3VycmVudEVsZW1lbnQ7XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgZWxlbWVudCB0aGF0IHdhcyBhY3RpdmF0ZWQgd2hlbiBhIGBjb3B5YCBwcm9jZXNzIHN0YXJ0ZWQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY29weVRhcmdldDtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIGRhdGEgZm9yIHRoZSBwZW5kaW5nIGNsaXBib2FyZCB0cmFuc2FjdGlvbi5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGlwRGF0YSA9IHt9O1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgZGF0YSBmb3JtYXRzIGZvciB0aGUgcGVuZGluZyBjbGlwYm9hcmQgdHJhbnNhY3Rpb24uXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpcERhdGFGb3JtYXRNYXAgPSBudWxsO1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgdGhlIEZsYXNoIGF2YWlsYWJpbGl0eSBjaGVjayB0aW1lb3V0LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2ZsYXNoQ2hlY2tUaW1lb3V0ID0gMDtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIFNXRiBuZXR3b3JrIGVycm9ycyBpbnRlcnZhbCBwb2xsaW5nLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3N3ZkZhbGxiYWNrQ2hlY2tJbnRlcnZhbCA9IDA7XG4gIC8qKlxuICogVGhlIGBtZXNzYWdlYCBzdG9yZSBmb3IgZXZlbnRzXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZXZlbnRNZXNzYWdlcyA9IHtcbiAgICByZWFkeTogXCJGbGFzaCBjb21tdW5pY2F0aW9uIGlzIGVzdGFibGlzaGVkXCIsXG4gICAgZXJyb3I6IHtcbiAgICAgIFwiZmxhc2gtc2FuZGJveGVkXCI6IFwiQXR0ZW1wdGluZyB0byBydW4gRmxhc2ggaW4gYSBzYW5kYm94ZWQgaWZyYW1lLCB3aGljaCBpcyBpbXBvc3NpYmxlXCIsXG4gICAgICBcImZsYXNoLWRpc2FibGVkXCI6IFwiRmxhc2ggaXMgZGlzYWJsZWQgb3Igbm90IGluc3RhbGxlZC4gTWF5IGFsc28gYmUgYXR0ZW1wdGluZyB0byBydW4gRmxhc2ggaW4gYSBzYW5kYm94ZWQgaWZyYW1lLCB3aGljaCBpcyBpbXBvc3NpYmxlLlwiLFxuICAgICAgXCJmbGFzaC1vdXRkYXRlZFwiOiBcIkZsYXNoIGlzIHRvbyBvdXRkYXRlZCB0byBzdXBwb3J0IFplcm9DbGlwYm9hcmRcIixcbiAgICAgIFwiZmxhc2gtaW5zZWN1cmVcIjogXCJGbGFzaCB3aWxsIGJlIHVuYWJsZSB0byBjb21tdW5pY2F0ZSBkdWUgdG8gYSBwcm90b2NvbCBtaXNtYXRjaCBiZXR3ZWVuIHlvdXIgYHN3ZlBhdGhgIGNvbmZpZ3VyYXRpb24gYW5kIHRoZSBwYWdlXCIsXG4gICAgICBcImZsYXNoLXVuYXZhaWxhYmxlXCI6IFwiRmxhc2ggaXMgdW5hYmxlIHRvIGNvbW11bmljYXRlIGJpZGlyZWN0aW9uYWxseSB3aXRoIEphdmFTY3JpcHRcIixcbiAgICAgIFwiZmxhc2gtZGVncmFkZWRcIjogXCJGbGFzaCBpcyB1bmFibGUgdG8gcHJlc2VydmUgZGF0YSBmaWRlbGl0eSB3aGVuIGNvbW11bmljYXRpbmcgd2l0aCBKYXZhU2NyaXB0XCIsXG4gICAgICBcImZsYXNoLWRlYWN0aXZhdGVkXCI6IFwiRmxhc2ggaXMgdG9vIG91dGRhdGVkIGZvciB5b3VyIGJyb3dzZXIgYW5kL29yIGlzIGNvbmZpZ3VyZWQgYXMgY2xpY2stdG8tYWN0aXZhdGUuXFxuVGhpcyBtYXkgYWxzbyBtZWFuIHRoYXQgdGhlIFplcm9DbGlwYm9hcmQgU1dGIG9iamVjdCBjb3VsZCBub3QgYmUgbG9hZGVkLCBzbyBwbGVhc2UgY2hlY2sgeW91ciBgc3dmUGF0aGAgY29uZmlndXJhdGlvbiBhbmQvb3IgbmV0d29yayBjb25uZWN0aXZpdHkuXFxuTWF5IGFsc28gYmUgYXR0ZW1wdGluZyB0byBydW4gRmxhc2ggaW4gYSBzYW5kYm94ZWQgaWZyYW1lLCB3aGljaCBpcyBpbXBvc3NpYmxlLlwiLFxuICAgICAgXCJmbGFzaC1vdmVyZHVlXCI6IFwiRmxhc2ggY29tbXVuaWNhdGlvbiB3YXMgZXN0YWJsaXNoZWQgYnV0IE5PVCB3aXRoaW4gdGhlIGFjY2VwdGFibGUgdGltZSBsaW1pdFwiLFxuICAgICAgXCJ2ZXJzaW9uLW1pc21hdGNoXCI6IFwiWmVyb0NsaXBib2FyZCBKUyB2ZXJzaW9uIG51bWJlciBkb2VzIG5vdCBtYXRjaCBaZXJvQ2xpcGJvYXJkIFNXRiB2ZXJzaW9uIG51bWJlclwiLFxuICAgICAgXCJjbGlwYm9hcmQtZXJyb3JcIjogXCJBdCBsZWFzdCBvbmUgZXJyb3Igd2FzIHRocm93biB3aGlsZSBaZXJvQ2xpcGJvYXJkIHdhcyBhdHRlbXB0aW5nIHRvIGluamVjdCB5b3VyIGRhdGEgaW50byB0aGUgY2xpcGJvYXJkXCIsXG4gICAgICBcImNvbmZpZy1taXNtYXRjaFwiOiBcIlplcm9DbGlwYm9hcmQgY29uZmlndXJhdGlvbiBkb2VzIG5vdCBtYXRjaCBGbGFzaCdzIHJlYWxpdHlcIixcbiAgICAgIFwic3dmLW5vdC1mb3VuZFwiOiBcIlRoZSBaZXJvQ2xpcGJvYXJkIFNXRiBvYmplY3QgY291bGQgbm90IGJlIGxvYWRlZCwgc28gcGxlYXNlIGNoZWNrIHlvdXIgYHN3ZlBhdGhgIGNvbmZpZ3VyYXRpb24gYW5kL29yIG5ldHdvcmsgY29ubmVjdGl2aXR5XCIsXG4gICAgICBcImJyb3dzZXItdW5zdXBwb3J0ZWRcIjogXCJUaGUgYnJvd3NlciBkb2VzIG5vdCBzdXBwb3J0IHRoZSByZXF1aXJlZCBIVE1MIERPTSBhbmQgSmF2YVNjcmlwdCBmZWF0dXJlc1wiXG4gICAgfVxuICB9O1xuICAvKipcbiAqIFRoZSBgbmFtZWBzIG9mIGBlcnJvcmAgZXZlbnRzIHRoYXQgY2FuIG9ubHkgb2NjdXIgaXMgRmxhc2ggaGFzIGF0IGxlYXN0XG4gKiBiZWVuIGFibGUgdG8gbG9hZCB0aGUgU1dGIHN1Y2Nlc3NmdWxseS5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9lcnJvcnNUaGF0T25seU9jY3VyQWZ0ZXJGbGFzaExvYWRzID0gWyBcImZsYXNoLXVuYXZhaWxhYmxlXCIsIFwiZmxhc2gtZGVncmFkZWRcIiwgXCJmbGFzaC1vdmVyZHVlXCIsIFwidmVyc2lvbi1taXNtYXRjaFwiLCBcImNvbmZpZy1taXNtYXRjaFwiLCBcImNsaXBib2FyZC1lcnJvclwiIF07XG4gIC8qKlxuICogVGhlIGBuYW1lYHMgb2YgYGVycm9yYCBldmVudHMgdGhhdCBzaG91bGQgbGlrZWx5IHJlc3VsdCBpbiB0aGUgYF9mbGFzaFN0YXRlYFxuICogdmFyaWFibGUncyBwcm9wZXJ0eSB2YWx1ZXMgYmVpbmcgdXBkYXRlZC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9mbGFzaFN0YXRlRXJyb3JOYW1lcyA9IFsgXCJmbGFzaC1zYW5kYm94ZWRcIiwgXCJmbGFzaC1kaXNhYmxlZFwiLCBcImZsYXNoLW91dGRhdGVkXCIsIFwiZmxhc2gtaW5zZWN1cmVcIiwgXCJmbGFzaC11bmF2YWlsYWJsZVwiLCBcImZsYXNoLWRlZ3JhZGVkXCIsIFwiZmxhc2gtZGVhY3RpdmF0ZWRcIiwgXCJmbGFzaC1vdmVyZHVlXCIgXTtcbiAgLyoqXG4gKiBBIFJlZ0V4cCB0byBtYXRjaCB0aGUgYG5hbWVgIHByb3BlcnR5IG9mIGBlcnJvcmAgZXZlbnRzIHJlbGF0ZWQgdG8gRmxhc2guXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZmxhc2hTdGF0ZUVycm9yTmFtZU1hdGNoaW5nUmVnZXggPSBuZXcgUmVnRXhwKFwiXmZsYXNoLShcIiArIF9mbGFzaFN0YXRlRXJyb3JOYW1lcy5tYXAoZnVuY3Rpb24oZXJyb3JOYW1lKSB7XG4gICAgcmV0dXJuIGVycm9yTmFtZS5yZXBsYWNlKC9eZmxhc2gtLywgXCJcIik7XG4gIH0pLmpvaW4oXCJ8XCIpICsgXCIpJFwiKTtcbiAgLyoqXG4gKiBBIFJlZ0V4cCB0byBtYXRjaCB0aGUgYG5hbWVgIHByb3BlcnR5IG9mIGBlcnJvcmAgZXZlbnRzIHJlbGF0ZWQgdG8gRmxhc2gsXG4gKiB3aGljaCBpcyBlbmFibGVkLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2ZsYXNoU3RhdGVFbmFibGVkRXJyb3JOYW1lTWF0Y2hpbmdSZWdleCA9IG5ldyBSZWdFeHAoXCJeZmxhc2gtKFwiICsgX2ZsYXNoU3RhdGVFcnJvck5hbWVzLmZpbHRlcihmdW5jdGlvbihlcnJvck5hbWUpIHtcbiAgICByZXR1cm4gZXJyb3JOYW1lICE9PSBcImZsYXNoLWRpc2FibGVkXCI7XG4gIH0pLm1hcChmdW5jdGlvbihlcnJvck5hbWUpIHtcbiAgICByZXR1cm4gZXJyb3JOYW1lLnJlcGxhY2UoL15mbGFzaC0vLCBcIlwiKTtcbiAgfSkuam9pbihcInxcIikgKyBcIikkXCIpO1xuICAvKipcbiAqIFplcm9DbGlwYm9hcmQgY29uZmlndXJhdGlvbiBkZWZhdWx0cyBmb3IgdGhlIENvcmUgbW9kdWxlLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dsb2JhbENvbmZpZyA9IHtcbiAgICBzd2ZQYXRoOiBfZ2V0RGVmYXVsdFN3ZlBhdGgoKSxcbiAgICB0cnVzdGVkRG9tYWluczogX3dpbmRvdy5sb2NhdGlvbi5ob3N0ID8gWyBfd2luZG93LmxvY2F0aW9uLmhvc3QgXSA6IFtdLFxuICAgIGNhY2hlQnVzdDogdHJ1ZSxcbiAgICBmb3JjZUVuaGFuY2VkQ2xpcGJvYXJkOiBmYWxzZSxcbiAgICBmbGFzaExvYWRUaW1lb3V0OiAzZTQsXG4gICAgYXV0b0FjdGl2YXRlOiB0cnVlLFxuICAgIGJ1YmJsZUV2ZW50czogdHJ1ZSxcbiAgICBmaXhMaW5lRW5kaW5nczogdHJ1ZSxcbiAgICBjb250YWluZXJJZDogXCJnbG9iYWwtemVyb2NsaXBib2FyZC1odG1sLWJyaWRnZVwiLFxuICAgIGNvbnRhaW5lckNsYXNzOiBcImdsb2JhbC16ZXJvY2xpcGJvYXJkLWNvbnRhaW5lclwiLFxuICAgIHN3Zk9iamVjdElkOiBcImdsb2JhbC16ZXJvY2xpcGJvYXJkLWZsYXNoLWJyaWRnZVwiLFxuICAgIGhvdmVyQ2xhc3M6IFwiemVyb2NsaXBib2FyZC1pcy1ob3ZlclwiLFxuICAgIGFjdGl2ZUNsYXNzOiBcInplcm9jbGlwYm9hcmQtaXMtYWN0aXZlXCIsXG4gICAgZm9yY2VIYW5kQ3Vyc29yOiBmYWxzZSxcbiAgICB0aXRsZTogbnVsbCxcbiAgICB6SW5kZXg6IDk5OTk5OTk5OVxuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmNvbmZpZ2AuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY29uZmlnID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gXCJvYmplY3RcIiAmJiBvcHRpb25zICYmICEoXCJsZW5ndGhcIiBpbiBvcHRpb25zKSkge1xuICAgICAgX2tleXMob3B0aW9ucykuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG4gICAgICAgIGlmICgvXig/OmZvcmNlSGFuZEN1cnNvcnx0aXRsZXx6SW5kZXh8YnViYmxlRXZlbnRzfGZpeExpbmVFbmRpbmdzKSQvLnRlc3QocHJvcCkpIHtcbiAgICAgICAgICBfZ2xvYmFsQ29uZmlnW3Byb3BdID0gb3B0aW9uc1twcm9wXTtcbiAgICAgICAgfSBlbHNlIGlmIChfZmxhc2hTdGF0ZS5icmlkZ2UgPT0gbnVsbCkge1xuICAgICAgICAgIGlmIChwcm9wID09PSBcImNvbnRhaW5lcklkXCIgfHwgcHJvcCA9PT0gXCJzd2ZPYmplY3RJZFwiKSB7XG4gICAgICAgICAgICBpZiAoX2lzVmFsaWRIdG1sNElkKG9wdGlvbnNbcHJvcF0pKSB7XG4gICAgICAgICAgICAgIF9nbG9iYWxDb25maWdbcHJvcF0gPSBvcHRpb25zW3Byb3BdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIHNwZWNpZmllZCBgXCIgKyBwcm9wICsgXCJgIHZhbHVlIGlzIG5vdCB2YWxpZCBhcyBhbiBIVE1MNCBFbGVtZW50IElEXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBfZ2xvYmFsQ29uZmlnW3Byb3BdID0gb3B0aW9uc1twcm9wXTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09IFwic3RyaW5nXCIgJiYgb3B0aW9ucykge1xuICAgICAgaWYgKF9oYXNPd24uY2FsbChfZ2xvYmFsQ29uZmlnLCBvcHRpb25zKSkge1xuICAgICAgICByZXR1cm4gX2dsb2JhbENvbmZpZ1tvcHRpb25zXTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmV0dXJuIF9kZWVwQ29weShfZ2xvYmFsQ29uZmlnKTtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5zdGF0ZWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfc3RhdGUgPSBmdW5jdGlvbigpIHtcbiAgICBfZGV0ZWN0U2FuZGJveCgpO1xuICAgIHJldHVybiB7XG4gICAgICBicm93c2VyOiBfZXh0ZW5kKF9waWNrKF9uYXZpZ2F0b3IsIFsgXCJ1c2VyQWdlbnRcIiwgXCJwbGF0Zm9ybVwiLCBcImFwcE5hbWVcIiwgXCJhcHBWZXJzaW9uXCIgXSksIHtcbiAgICAgICAgaXNTdXBwb3J0ZWQ6IF9pc0Jyb3dzZXJTdXBwb3J0ZWQoKVxuICAgICAgfSksXG4gICAgICBmbGFzaDogX29taXQoX2ZsYXNoU3RhdGUsIFsgXCJicmlkZ2VcIiBdKSxcbiAgICAgIHplcm9jbGlwYm9hcmQ6IHtcbiAgICAgICAgdmVyc2lvbjogWmVyb0NsaXBib2FyZC52ZXJzaW9uLFxuICAgICAgICBjb25maWc6IFplcm9DbGlwYm9hcmQuY29uZmlnKClcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuICAvKipcbiAqIERvZXMgdGhpcyBicm93c2VyIHN1cHBvcnQgYWxsIG9mIHRoZSBuZWNlc3NhcnkgRE9NIGFuZCBKUyBmZWF0dXJlcyBuZWNlc3Nhcnk/XG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfaXNCcm93c2VyU3VwcG9ydGVkID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuICEhKF9kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyICYmIF93aW5kb3cuT2JqZWN0LmtleXMgJiYgX3dpbmRvdy5BcnJheS5wcm90b3R5cGUubWFwKTtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5pc0ZsYXNoVW51c2FibGVgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2lzRmxhc2hVbnVzYWJsZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAhIShfZmxhc2hTdGF0ZS5zYW5kYm94ZWQgfHwgX2ZsYXNoU3RhdGUuZGlzYWJsZWQgfHwgX2ZsYXNoU3RhdGUub3V0ZGF0ZWQgfHwgX2ZsYXNoU3RhdGUudW5hdmFpbGFibGUgfHwgX2ZsYXNoU3RhdGUuZGVncmFkZWQgfHwgX2ZsYXNoU3RhdGUuZGVhY3RpdmF0ZWQpO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLm9uYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9vbiA9IGZ1bmN0aW9uKGV2ZW50VHlwZSwgbGlzdGVuZXIpIHtcbiAgICB2YXIgaSwgbGVuLCBldmVudHMsIGFkZGVkID0ge307XG4gICAgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnRUeXBlKSB7XG4gICAgICBldmVudHMgPSBldmVudFR5cGUudG9Mb3dlckNhc2UoKS5zcGxpdCgvXFxzKy8pO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJvYmplY3RcIiAmJiBldmVudFR5cGUgJiYgIShcImxlbmd0aFwiIGluIGV2ZW50VHlwZSkgJiYgdHlwZW9mIGxpc3RlbmVyID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBfa2V5cyhldmVudFR5cGUpLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgIHZhciBsaXN0ZW5lciA9IGV2ZW50VHlwZVtrZXldO1xuICAgICAgICBpZiAodHlwZW9mIGxpc3RlbmVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBaZXJvQ2xpcGJvYXJkLm9uKGtleSwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGV2ZW50cyAmJiBldmVudHMubGVuZ3RoICYmIGxpc3RlbmVyKSB7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBldmVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZXZlbnRUeXBlID0gZXZlbnRzW2ldLnJlcGxhY2UoL15vbi8sIFwiXCIpO1xuICAgICAgICBhZGRlZFtldmVudFR5cGVdID0gdHJ1ZTtcbiAgICAgICAgaWYgKCFfaGFuZGxlcnNbZXZlbnRUeXBlXSkge1xuICAgICAgICAgIF9oYW5kbGVyc1tldmVudFR5cGVdID0gW107XG4gICAgICAgIH1cbiAgICAgICAgX2hhbmRsZXJzW2V2ZW50VHlwZV0ucHVzaChsaXN0ZW5lcik7XG4gICAgICB9XG4gICAgICBpZiAoYWRkZWQucmVhZHkgJiYgX2ZsYXNoU3RhdGUucmVhZHkpIHtcbiAgICAgICAgWmVyb0NsaXBib2FyZC5lbWl0KHtcbiAgICAgICAgICB0eXBlOiBcInJlYWR5XCJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoYWRkZWQuZXJyb3IpIHtcbiAgICAgICAgaWYgKCFfaXNCcm93c2VyU3VwcG9ydGVkKCkpIHtcbiAgICAgICAgICBaZXJvQ2xpcGJvYXJkLmVtaXQoe1xuICAgICAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICAgICAgbmFtZTogXCJicm93c2VyLXVuc3VwcG9ydGVkXCJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGkgPSAwLCBsZW4gPSBfZmxhc2hTdGF0ZUVycm9yTmFtZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICBpZiAoX2ZsYXNoU3RhdGVbX2ZsYXNoU3RhdGVFcnJvck5hbWVzW2ldLnJlcGxhY2UoL15mbGFzaC0vLCBcIlwiKV0gPT09IHRydWUpIHtcbiAgICAgICAgICAgIFplcm9DbGlwYm9hcmQuZW1pdCh7XG4gICAgICAgICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgICAgICAgbmFtZTogX2ZsYXNoU3RhdGVFcnJvck5hbWVzW2ldXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoX3pjU3dmVmVyc2lvbiAhPT0gdW5kZWZpbmVkICYmIFplcm9DbGlwYm9hcmQudmVyc2lvbiAhPT0gX3pjU3dmVmVyc2lvbikge1xuICAgICAgICAgIFplcm9DbGlwYm9hcmQuZW1pdCh7XG4gICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICBuYW1lOiBcInZlcnNpb24tbWlzbWF0Y2hcIixcbiAgICAgICAgICAgIGpzVmVyc2lvbjogWmVyb0NsaXBib2FyZC52ZXJzaW9uLFxuICAgICAgICAgICAgc3dmVmVyc2lvbjogX3pjU3dmVmVyc2lvblxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBaZXJvQ2xpcGJvYXJkO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLm9mZmAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfb2ZmID0gZnVuY3Rpb24oZXZlbnRUeXBlLCBsaXN0ZW5lcikge1xuICAgIHZhciBpLCBsZW4sIGZvdW5kSW5kZXgsIGV2ZW50cywgcGVyRXZlbnRIYW5kbGVycztcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgZXZlbnRzID0gX2tleXMoX2hhbmRsZXJzKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnRUeXBlKSB7XG4gICAgICBldmVudHMgPSBldmVudFR5cGUudG9Mb3dlckNhc2UoKS5zcGxpdCgvXFxzKy8pO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJvYmplY3RcIiAmJiBldmVudFR5cGUgJiYgIShcImxlbmd0aFwiIGluIGV2ZW50VHlwZSkgJiYgdHlwZW9mIGxpc3RlbmVyID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBfa2V5cyhldmVudFR5cGUpLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgIHZhciBsaXN0ZW5lciA9IGV2ZW50VHlwZVtrZXldO1xuICAgICAgICBpZiAodHlwZW9mIGxpc3RlbmVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBaZXJvQ2xpcGJvYXJkLm9mZihrZXksIGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChldmVudHMgJiYgZXZlbnRzLmxlbmd0aCkge1xuICAgICAgZm9yIChpID0gMCwgbGVuID0gZXZlbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGV2ZW50VHlwZSA9IGV2ZW50c1tpXS5yZXBsYWNlKC9eb24vLCBcIlwiKTtcbiAgICAgICAgcGVyRXZlbnRIYW5kbGVycyA9IF9oYW5kbGVyc1tldmVudFR5cGVdO1xuICAgICAgICBpZiAocGVyRXZlbnRIYW5kbGVycyAmJiBwZXJFdmVudEhhbmRsZXJzLmxlbmd0aCkge1xuICAgICAgICAgIGlmIChsaXN0ZW5lcikge1xuICAgICAgICAgICAgZm91bmRJbmRleCA9IHBlckV2ZW50SGFuZGxlcnMuaW5kZXhPZihsaXN0ZW5lcik7XG4gICAgICAgICAgICB3aGlsZSAoZm91bmRJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgcGVyRXZlbnRIYW5kbGVycy5zcGxpY2UoZm91bmRJbmRleCwgMSk7XG4gICAgICAgICAgICAgIGZvdW5kSW5kZXggPSBwZXJFdmVudEhhbmRsZXJzLmluZGV4T2YobGlzdGVuZXIsIGZvdW5kSW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwZXJFdmVudEhhbmRsZXJzLmxlbmd0aCA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBaZXJvQ2xpcGJvYXJkO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmhhbmRsZXJzYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9saXN0ZW5lcnMgPSBmdW5jdGlvbihldmVudFR5cGUpIHtcbiAgICB2YXIgY29weTtcbiAgICBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudFR5cGUpIHtcbiAgICAgIGNvcHkgPSBfZGVlcENvcHkoX2hhbmRsZXJzW2V2ZW50VHlwZV0pIHx8IG51bGw7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvcHkgPSBfZGVlcENvcHkoX2hhbmRsZXJzKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvcHk7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuZW1pdGAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZW1pdCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIGV2ZW50Q29weSwgcmV0dXJuVmFsLCB0bXA7XG4gICAgZXZlbnQgPSBfY3JlYXRlRXZlbnQoZXZlbnQpO1xuICAgIGlmICghZXZlbnQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKF9wcmVwcm9jZXNzRXZlbnQoZXZlbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChldmVudC50eXBlID09PSBcInJlYWR5XCIgJiYgX2ZsYXNoU3RhdGUub3ZlcmR1ZSA9PT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIFplcm9DbGlwYm9hcmQuZW1pdCh7XG4gICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgbmFtZTogXCJmbGFzaC1vdmVyZHVlXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBldmVudENvcHkgPSBfZXh0ZW5kKHt9LCBldmVudCk7XG4gICAgX2Rpc3BhdGNoQ2FsbGJhY2tzLmNhbGwodGhpcywgZXZlbnRDb3B5KTtcbiAgICBpZiAoZXZlbnQudHlwZSA9PT0gXCJjb3B5XCIpIHtcbiAgICAgIHRtcCA9IF9tYXBDbGlwRGF0YVRvRmxhc2goX2NsaXBEYXRhKTtcbiAgICAgIHJldHVyblZhbCA9IHRtcC5kYXRhO1xuICAgICAgX2NsaXBEYXRhRm9ybWF0TWFwID0gdG1wLmZvcm1hdE1hcDtcbiAgICB9XG4gICAgcmV0dXJuIHJldHVyblZhbDtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgdGhlIHByb3RvY29sIG9mIHRoZSBjb25maWd1cmVkIFNXRiBwYXRoLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldFN3ZlBhdGhQcm90b2NvbCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzd2ZQYXRoID0gX2dsb2JhbENvbmZpZy5zd2ZQYXRoIHx8IFwiXCIsIHN3ZlBhdGhGaXJzdFR3b0NoYXJzID0gc3dmUGF0aC5zbGljZSgwLCAyKSwgc3dmUHJvdG9jb2wgPSBzd2ZQYXRoLnNsaWNlKDAsIHN3ZlBhdGguaW5kZXhPZihcIjovL1wiKSArIDEpO1xuICAgIHJldHVybiBzd2ZQYXRoRmlyc3RUd29DaGFycyA9PT0gXCJcXFxcXFxcXFwiID8gXCJmaWxlOlwiIDogc3dmUGF0aEZpcnN0VHdvQ2hhcnMgPT09IFwiLy9cIiB8fCBzd2ZQcm90b2NvbCA9PT0gXCJcIiA/IF93aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgOiBzd2ZQcm90b2NvbDtcbiAgfTtcbiAgLyoqXG4gKiBUaGUgdW5kZXJseWluZyBpbXBsZW1lbnRhdGlvbiBvZiBgWmVyb0NsaXBib2FyZC5jcmVhdGVgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NyZWF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBtYXhXYWl0LCBzd2ZQcm90b2NvbCwgcHJldmlvdXNTdGF0ZSA9IF9mbGFzaFN0YXRlLnNhbmRib3hlZDtcbiAgICBpZiAoIV9pc0Jyb3dzZXJTdXBwb3J0ZWQoKSkge1xuICAgICAgX2ZsYXNoU3RhdGUucmVhZHkgPSBmYWxzZTtcbiAgICAgIFplcm9DbGlwYm9hcmQuZW1pdCh7XG4gICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgbmFtZTogXCJicm93c2VyLXVuc3VwcG9ydGVkXCJcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBfZGV0ZWN0U2FuZGJveCgpO1xuICAgIGlmICh0eXBlb2YgX2ZsYXNoU3RhdGUucmVhZHkgIT09IFwiYm9vbGVhblwiKSB7XG4gICAgICBfZmxhc2hTdGF0ZS5yZWFkeSA9IGZhbHNlO1xuICAgIH1cbiAgICBpZiAoX2ZsYXNoU3RhdGUuc2FuZGJveGVkICE9PSBwcmV2aW91c1N0YXRlICYmIF9mbGFzaFN0YXRlLnNhbmRib3hlZCA9PT0gdHJ1ZSkge1xuICAgICAgX2ZsYXNoU3RhdGUucmVhZHkgPSBmYWxzZTtcbiAgICAgIFplcm9DbGlwYm9hcmQuZW1pdCh7XG4gICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgbmFtZTogXCJmbGFzaC1zYW5kYm94ZWRcIlxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmICghWmVyb0NsaXBib2FyZC5pc0ZsYXNoVW51c2FibGUoKSAmJiBfZmxhc2hTdGF0ZS5icmlkZ2UgPT09IG51bGwpIHtcbiAgICAgIHN3ZlByb3RvY29sID0gX2dldFN3ZlBhdGhQcm90b2NvbCgpO1xuICAgICAgaWYgKHN3ZlByb3RvY29sICYmIHN3ZlByb3RvY29sICE9PSBfd2luZG93LmxvY2F0aW9uLnByb3RvY29sKSB7XG4gICAgICAgIFplcm9DbGlwYm9hcmQuZW1pdCh7XG4gICAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICAgIG5hbWU6IFwiZmxhc2gtaW5zZWN1cmVcIlxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1heFdhaXQgPSBfZ2xvYmFsQ29uZmlnLmZsYXNoTG9hZFRpbWVvdXQ7XG4gICAgICAgIGlmICh0eXBlb2YgbWF4V2FpdCA9PT0gXCJudW1iZXJcIiAmJiBtYXhXYWl0ID49IDApIHtcbiAgICAgICAgICBfZmxhc2hDaGVja1RpbWVvdXQgPSBfc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgX2ZsYXNoU3RhdGUuZGVhY3RpdmF0ZWQgIT09IFwiYm9vbGVhblwiKSB7XG4gICAgICAgICAgICAgIF9mbGFzaFN0YXRlLmRlYWN0aXZhdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChfZmxhc2hTdGF0ZS5kZWFjdGl2YXRlZCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICBaZXJvQ2xpcGJvYXJkLmVtaXQoe1xuICAgICAgICAgICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgICAgICAgICBuYW1lOiBcImZsYXNoLWRlYWN0aXZhdGVkXCJcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwgbWF4V2FpdCk7XG4gICAgICAgIH1cbiAgICAgICAgX2ZsYXNoU3RhdGUub3ZlcmR1ZSA9IGZhbHNlO1xuICAgICAgICBfZW1iZWRTd2YoKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuZGVzdHJveWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuICAgIFplcm9DbGlwYm9hcmQuY2xlYXJEYXRhKCk7XG4gICAgWmVyb0NsaXBib2FyZC5ibHVyKCk7XG4gICAgWmVyb0NsaXBib2FyZC5lbWl0KFwiZGVzdHJveVwiKTtcbiAgICBfdW5lbWJlZFN3ZigpO1xuICAgIFplcm9DbGlwYm9hcmQub2ZmKCk7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuc2V0RGF0YWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfc2V0RGF0YSA9IGZ1bmN0aW9uKGZvcm1hdCwgZGF0YSkge1xuICAgIHZhciBkYXRhT2JqO1xuICAgIGlmICh0eXBlb2YgZm9ybWF0ID09PSBcIm9iamVjdFwiICYmIGZvcm1hdCAmJiB0eXBlb2YgZGF0YSA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgZGF0YU9iaiA9IGZvcm1hdDtcbiAgICAgIFplcm9DbGlwYm9hcmQuY2xlYXJEYXRhKCk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZm9ybWF0ID09PSBcInN0cmluZ1wiICYmIGZvcm1hdCkge1xuICAgICAgZGF0YU9iaiA9IHt9O1xuICAgICAgZGF0YU9ialtmb3JtYXRdID0gZGF0YTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmb3IgKHZhciBkYXRhRm9ybWF0IGluIGRhdGFPYmopIHtcbiAgICAgIGlmICh0eXBlb2YgZGF0YUZvcm1hdCA9PT0gXCJzdHJpbmdcIiAmJiBkYXRhRm9ybWF0ICYmIF9oYXNPd24uY2FsbChkYXRhT2JqLCBkYXRhRm9ybWF0KSAmJiB0eXBlb2YgZGF0YU9ialtkYXRhRm9ybWF0XSA9PT0gXCJzdHJpbmdcIiAmJiBkYXRhT2JqW2RhdGFGb3JtYXRdKSB7XG4gICAgICAgIF9jbGlwRGF0YVtkYXRhRm9ybWF0XSA9IF9maXhMaW5lRW5kaW5ncyhkYXRhT2JqW2RhdGFGb3JtYXRdKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuY2xlYXJEYXRhYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGVhckRhdGEgPSBmdW5jdGlvbihmb3JtYXQpIHtcbiAgICBpZiAodHlwZW9mIGZvcm1hdCA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgX2RlbGV0ZU93blByb3BlcnRpZXMoX2NsaXBEYXRhKTtcbiAgICAgIF9jbGlwRGF0YUZvcm1hdE1hcCA9IG51bGw7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZm9ybWF0ID09PSBcInN0cmluZ1wiICYmIF9oYXNPd24uY2FsbChfY2xpcERhdGEsIGZvcm1hdCkpIHtcbiAgICAgIGRlbGV0ZSBfY2xpcERhdGFbZm9ybWF0XTtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuZ2V0RGF0YWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0RGF0YSA9IGZ1bmN0aW9uKGZvcm1hdCkge1xuICAgIGlmICh0eXBlb2YgZm9ybWF0ID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICByZXR1cm4gX2RlZXBDb3B5KF9jbGlwRGF0YSk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZm9ybWF0ID09PSBcInN0cmluZ1wiICYmIF9oYXNPd24uY2FsbChfY2xpcERhdGEsIGZvcm1hdCkpIHtcbiAgICAgIHJldHVybiBfY2xpcERhdGFbZm9ybWF0XTtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuZm9jdXNgL2BaZXJvQ2xpcGJvYXJkLmFjdGl2YXRlYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9mb2N1cyA9IGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICBpZiAoIShlbGVtZW50ICYmIGVsZW1lbnQubm9kZVR5cGUgPT09IDEpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChfY3VycmVudEVsZW1lbnQpIHtcbiAgICAgIF9yZW1vdmVDbGFzcyhfY3VycmVudEVsZW1lbnQsIF9nbG9iYWxDb25maWcuYWN0aXZlQ2xhc3MpO1xuICAgICAgaWYgKF9jdXJyZW50RWxlbWVudCAhPT0gZWxlbWVudCkge1xuICAgICAgICBfcmVtb3ZlQ2xhc3MoX2N1cnJlbnRFbGVtZW50LCBfZ2xvYmFsQ29uZmlnLmhvdmVyQ2xhc3MpO1xuICAgICAgfVxuICAgIH1cbiAgICBfY3VycmVudEVsZW1lbnQgPSBlbGVtZW50O1xuICAgIF9hZGRDbGFzcyhlbGVtZW50LCBfZ2xvYmFsQ29uZmlnLmhvdmVyQ2xhc3MpO1xuICAgIHZhciBuZXdUaXRsZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwidGl0bGVcIikgfHwgX2dsb2JhbENvbmZpZy50aXRsZTtcbiAgICBpZiAodHlwZW9mIG5ld1RpdGxlID09PSBcInN0cmluZ1wiICYmIG5ld1RpdGxlKSB7XG4gICAgICB2YXIgaHRtbEJyaWRnZSA9IF9nZXRIdG1sQnJpZGdlKF9mbGFzaFN0YXRlLmJyaWRnZSk7XG4gICAgICBpZiAoaHRtbEJyaWRnZSkge1xuICAgICAgICBodG1sQnJpZGdlLnNldEF0dHJpYnV0ZShcInRpdGxlXCIsIG5ld1RpdGxlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgdmFyIHVzZUhhbmRDdXJzb3IgPSBfZ2xvYmFsQ29uZmlnLmZvcmNlSGFuZEN1cnNvciA9PT0gdHJ1ZSB8fCBfZ2V0U3R5bGUoZWxlbWVudCwgXCJjdXJzb3JcIikgPT09IFwicG9pbnRlclwiO1xuICAgIF9zZXRIYW5kQ3Vyc29yKHVzZUhhbmRDdXJzb3IpO1xuICAgIF9yZXBvc2l0aW9uKCk7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuYmx1cmAvYFplcm9DbGlwYm9hcmQuZGVhY3RpdmF0ZWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfYmx1ciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBodG1sQnJpZGdlID0gX2dldEh0bWxCcmlkZ2UoX2ZsYXNoU3RhdGUuYnJpZGdlKTtcbiAgICBpZiAoaHRtbEJyaWRnZSkge1xuICAgICAgaHRtbEJyaWRnZS5yZW1vdmVBdHRyaWJ1dGUoXCJ0aXRsZVwiKTtcbiAgICAgIGh0bWxCcmlkZ2Uuc3R5bGUubGVmdCA9IFwiMHB4XCI7XG4gICAgICBodG1sQnJpZGdlLnN0eWxlLnRvcCA9IFwiLTk5OTlweFwiO1xuICAgICAgaHRtbEJyaWRnZS5zdHlsZS53aWR0aCA9IFwiMXB4XCI7XG4gICAgICBodG1sQnJpZGdlLnN0eWxlLmhlaWdodCA9IFwiMXB4XCI7XG4gICAgfVxuICAgIGlmIChfY3VycmVudEVsZW1lbnQpIHtcbiAgICAgIF9yZW1vdmVDbGFzcyhfY3VycmVudEVsZW1lbnQsIF9nbG9iYWxDb25maWcuaG92ZXJDbGFzcyk7XG4gICAgICBfcmVtb3ZlQ2xhc3MoX2N1cnJlbnRFbGVtZW50LCBfZ2xvYmFsQ29uZmlnLmFjdGl2ZUNsYXNzKTtcbiAgICAgIF9jdXJyZW50RWxlbWVudCA9IG51bGw7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLmFjdGl2ZUVsZW1lbnRgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2FjdGl2ZUVsZW1lbnQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2N1cnJlbnRFbGVtZW50IHx8IG51bGw7XG4gIH07XG4gIC8qKlxuICogQ2hlY2sgaWYgYSB2YWx1ZSBpcyBhIHZhbGlkIEhUTUw0IGBJRGAgb3IgYE5hbWVgIHRva2VuLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2lzVmFsaWRIdG1sNElkID0gZnVuY3Rpb24oaWQpIHtcbiAgICByZXR1cm4gdHlwZW9mIGlkID09PSBcInN0cmluZ1wiICYmIGlkICYmIC9eW0EtWmEtel1bQS1aYS16MC05XzpcXC1cXC5dKiQvLnRlc3QoaWQpO1xuICB9O1xuICAvKipcbiAqIENyZWF0ZSBvciB1cGRhdGUgYW4gYGV2ZW50YCBvYmplY3QsIGJhc2VkIG9uIHRoZSBgZXZlbnRUeXBlYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jcmVhdGVFdmVudCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIGV2ZW50VHlwZTtcbiAgICBpZiAodHlwZW9mIGV2ZW50ID09PSBcInN0cmluZ1wiICYmIGV2ZW50KSB7XG4gICAgICBldmVudFR5cGUgPSBldmVudDtcbiAgICAgIGV2ZW50ID0ge307XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZXZlbnQgPT09IFwib2JqZWN0XCIgJiYgZXZlbnQgJiYgdHlwZW9mIGV2ZW50LnR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnQudHlwZSkge1xuICAgICAgZXZlbnRUeXBlID0gZXZlbnQudHlwZTtcbiAgICB9XG4gICAgaWYgKCFldmVudFR5cGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZXZlbnRUeXBlID0gZXZlbnRUeXBlLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKCFldmVudC50YXJnZXQgJiYgKC9eKGNvcHl8YWZ0ZXJjb3B5fF9jbGljaykkLy50ZXN0KGV2ZW50VHlwZSkgfHwgZXZlbnRUeXBlID09PSBcImVycm9yXCIgJiYgZXZlbnQubmFtZSA9PT0gXCJjbGlwYm9hcmQtZXJyb3JcIikpIHtcbiAgICAgIGV2ZW50LnRhcmdldCA9IF9jb3B5VGFyZ2V0O1xuICAgIH1cbiAgICBfZXh0ZW5kKGV2ZW50LCB7XG4gICAgICB0eXBlOiBldmVudFR5cGUsXG4gICAgICB0YXJnZXQ6IGV2ZW50LnRhcmdldCB8fCBfY3VycmVudEVsZW1lbnQgfHwgbnVsbCxcbiAgICAgIHJlbGF0ZWRUYXJnZXQ6IGV2ZW50LnJlbGF0ZWRUYXJnZXQgfHwgbnVsbCxcbiAgICAgIGN1cnJlbnRUYXJnZXQ6IF9mbGFzaFN0YXRlICYmIF9mbGFzaFN0YXRlLmJyaWRnZSB8fCBudWxsLFxuICAgICAgdGltZVN0YW1wOiBldmVudC50aW1lU3RhbXAgfHwgX25vdygpIHx8IG51bGxcbiAgICB9KTtcbiAgICB2YXIgbXNnID0gX2V2ZW50TWVzc2FnZXNbZXZlbnQudHlwZV07XG4gICAgaWYgKGV2ZW50LnR5cGUgPT09IFwiZXJyb3JcIiAmJiBldmVudC5uYW1lICYmIG1zZykge1xuICAgICAgbXNnID0gbXNnW2V2ZW50Lm5hbWVdO1xuICAgIH1cbiAgICBpZiAobXNnKSB7XG4gICAgICBldmVudC5tZXNzYWdlID0gbXNnO1xuICAgIH1cbiAgICBpZiAoZXZlbnQudHlwZSA9PT0gXCJyZWFkeVwiKSB7XG4gICAgICBfZXh0ZW5kKGV2ZW50LCB7XG4gICAgICAgIHRhcmdldDogbnVsbCxcbiAgICAgICAgdmVyc2lvbjogX2ZsYXNoU3RhdGUudmVyc2lvblxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChldmVudC50eXBlID09PSBcImVycm9yXCIpIHtcbiAgICAgIGlmIChfZmxhc2hTdGF0ZUVycm9yTmFtZU1hdGNoaW5nUmVnZXgudGVzdChldmVudC5uYW1lKSkge1xuICAgICAgICBfZXh0ZW5kKGV2ZW50LCB7XG4gICAgICAgICAgdGFyZ2V0OiBudWxsLFxuICAgICAgICAgIG1pbmltdW1WZXJzaW9uOiBfbWluaW11bUZsYXNoVmVyc2lvblxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChfZmxhc2hTdGF0ZUVuYWJsZWRFcnJvck5hbWVNYXRjaGluZ1JlZ2V4LnRlc3QoZXZlbnQubmFtZSkpIHtcbiAgICAgICAgX2V4dGVuZChldmVudCwge1xuICAgICAgICAgIHZlcnNpb246IF9mbGFzaFN0YXRlLnZlcnNpb25cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoZXZlbnQubmFtZSA9PT0gXCJmbGFzaC1pbnNlY3VyZVwiKSB7XG4gICAgICAgIF9leHRlbmQoZXZlbnQsIHtcbiAgICAgICAgICBwYWdlUHJvdG9jb2w6IF93aW5kb3cubG9jYXRpb24ucHJvdG9jb2wsXG4gICAgICAgICAgc3dmUHJvdG9jb2w6IF9nZXRTd2ZQYXRoUHJvdG9jb2woKVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGV2ZW50LnR5cGUgPT09IFwiY29weVwiKSB7XG4gICAgICBldmVudC5jbGlwYm9hcmREYXRhID0ge1xuICAgICAgICBzZXREYXRhOiBaZXJvQ2xpcGJvYXJkLnNldERhdGEsXG4gICAgICAgIGNsZWFyRGF0YTogWmVyb0NsaXBib2FyZC5jbGVhckRhdGFcbiAgICAgIH07XG4gICAgfVxuICAgIGlmIChldmVudC50eXBlID09PSBcImFmdGVyY29weVwiKSB7XG4gICAgICBldmVudCA9IF9tYXBDbGlwUmVzdWx0c0Zyb21GbGFzaChldmVudCwgX2NsaXBEYXRhRm9ybWF0TWFwKTtcbiAgICB9XG4gICAgaWYgKGV2ZW50LnRhcmdldCAmJiAhZXZlbnQucmVsYXRlZFRhcmdldCkge1xuICAgICAgZXZlbnQucmVsYXRlZFRhcmdldCA9IF9nZXRSZWxhdGVkVGFyZ2V0KGV2ZW50LnRhcmdldCk7XG4gICAgfVxuICAgIHJldHVybiBfYWRkTW91c2VEYXRhKGV2ZW50KTtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgYSByZWxhdGVkVGFyZ2V0IGZyb20gdGhlIHRhcmdldCdzIGBkYXRhLWNsaXBib2FyZC10YXJnZXRgIGF0dHJpYnV0ZVxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldFJlbGF0ZWRUYXJnZXQgPSBmdW5jdGlvbih0YXJnZXRFbCkge1xuICAgIHZhciByZWxhdGVkVGFyZ2V0SWQgPSB0YXJnZXRFbCAmJiB0YXJnZXRFbC5nZXRBdHRyaWJ1dGUgJiYgdGFyZ2V0RWwuZ2V0QXR0cmlidXRlKFwiZGF0YS1jbGlwYm9hcmQtdGFyZ2V0XCIpO1xuICAgIHJldHVybiByZWxhdGVkVGFyZ2V0SWQgPyBfZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocmVsYXRlZFRhcmdldElkKSA6IG51bGw7XG4gIH07XG4gIC8qKlxuICogQWRkIGVsZW1lbnQgYW5kIHBvc2l0aW9uIGRhdGEgdG8gYE1vdXNlRXZlbnRgIGluc3RhbmNlc1xuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2FkZE1vdXNlRGF0YSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50ICYmIC9eXyg/OmNsaWNrfG1vdXNlKD86b3ZlcnxvdXR8ZG93bnx1cHxtb3ZlKSkkLy50ZXN0KGV2ZW50LnR5cGUpKSB7XG4gICAgICB2YXIgc3JjRWxlbWVudCA9IGV2ZW50LnRhcmdldDtcbiAgICAgIHZhciBmcm9tRWxlbWVudCA9IGV2ZW50LnR5cGUgPT09IFwiX21vdXNlb3ZlclwiICYmIGV2ZW50LnJlbGF0ZWRUYXJnZXQgPyBldmVudC5yZWxhdGVkVGFyZ2V0IDogdW5kZWZpbmVkO1xuICAgICAgdmFyIHRvRWxlbWVudCA9IGV2ZW50LnR5cGUgPT09IFwiX21vdXNlb3V0XCIgJiYgZXZlbnQucmVsYXRlZFRhcmdldCA/IGV2ZW50LnJlbGF0ZWRUYXJnZXQgOiB1bmRlZmluZWQ7XG4gICAgICB2YXIgcG9zID0gX2dldEVsZW1lbnRQb3NpdGlvbihzcmNFbGVtZW50KTtcbiAgICAgIHZhciBzY3JlZW5MZWZ0ID0gX3dpbmRvdy5zY3JlZW5MZWZ0IHx8IF93aW5kb3cuc2NyZWVuWCB8fCAwO1xuICAgICAgdmFyIHNjcmVlblRvcCA9IF93aW5kb3cuc2NyZWVuVG9wIHx8IF93aW5kb3cuc2NyZWVuWSB8fCAwO1xuICAgICAgdmFyIHNjcm9sbExlZnQgPSBfZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0ICsgX2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0O1xuICAgICAgdmFyIHNjcm9sbFRvcCA9IF9kb2N1bWVudC5ib2R5LnNjcm9sbFRvcCArIF9kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgICAgdmFyIHBhZ2VYID0gcG9zLmxlZnQgKyAodHlwZW9mIGV2ZW50Ll9zdGFnZVggPT09IFwibnVtYmVyXCIgPyBldmVudC5fc3RhZ2VYIDogMCk7XG4gICAgICB2YXIgcGFnZVkgPSBwb3MudG9wICsgKHR5cGVvZiBldmVudC5fc3RhZ2VZID09PSBcIm51bWJlclwiID8gZXZlbnQuX3N0YWdlWSA6IDApO1xuICAgICAgdmFyIGNsaWVudFggPSBwYWdlWCAtIHNjcm9sbExlZnQ7XG4gICAgICB2YXIgY2xpZW50WSA9IHBhZ2VZIC0gc2Nyb2xsVG9wO1xuICAgICAgdmFyIHNjcmVlblggPSBzY3JlZW5MZWZ0ICsgY2xpZW50WDtcbiAgICAgIHZhciBzY3JlZW5ZID0gc2NyZWVuVG9wICsgY2xpZW50WTtcbiAgICAgIHZhciBtb3ZlWCA9IHR5cGVvZiBldmVudC5tb3ZlbWVudFggPT09IFwibnVtYmVyXCIgPyBldmVudC5tb3ZlbWVudFggOiAwO1xuICAgICAgdmFyIG1vdmVZID0gdHlwZW9mIGV2ZW50Lm1vdmVtZW50WSA9PT0gXCJudW1iZXJcIiA/IGV2ZW50Lm1vdmVtZW50WSA6IDA7XG4gICAgICBkZWxldGUgZXZlbnQuX3N0YWdlWDtcbiAgICAgIGRlbGV0ZSBldmVudC5fc3RhZ2VZO1xuICAgICAgX2V4dGVuZChldmVudCwge1xuICAgICAgICBzcmNFbGVtZW50OiBzcmNFbGVtZW50LFxuICAgICAgICBmcm9tRWxlbWVudDogZnJvbUVsZW1lbnQsXG4gICAgICAgIHRvRWxlbWVudDogdG9FbGVtZW50LFxuICAgICAgICBzY3JlZW5YOiBzY3JlZW5YLFxuICAgICAgICBzY3JlZW5ZOiBzY3JlZW5ZLFxuICAgICAgICBwYWdlWDogcGFnZVgsXG4gICAgICAgIHBhZ2VZOiBwYWdlWSxcbiAgICAgICAgY2xpZW50WDogY2xpZW50WCxcbiAgICAgICAgY2xpZW50WTogY2xpZW50WSxcbiAgICAgICAgeDogY2xpZW50WCxcbiAgICAgICAgeTogY2xpZW50WSxcbiAgICAgICAgbW92ZW1lbnRYOiBtb3ZlWCxcbiAgICAgICAgbW92ZW1lbnRZOiBtb3ZlWSxcbiAgICAgICAgb2Zmc2V0WDogMCxcbiAgICAgICAgb2Zmc2V0WTogMCxcbiAgICAgICAgbGF5ZXJYOiAwLFxuICAgICAgICBsYXllclk6IDBcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gZXZlbnQ7XG4gIH07XG4gIC8qKlxuICogRGV0ZXJtaW5lIGlmIGFuIGV2ZW50J3MgcmVnaXN0ZXJlZCBoYW5kbGVycyBzaG91bGQgYmUgZXhlY3V0ZSBzeW5jaHJvbm91c2x5IG9yIGFzeW5jaHJvbm91c2x5LlxuICpcbiAqIEByZXR1cm5zIHtib29sZWFufVxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3Nob3VsZFBlcmZvcm1Bc3luYyA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIGV2ZW50VHlwZSA9IGV2ZW50ICYmIHR5cGVvZiBldmVudC50eXBlID09PSBcInN0cmluZ1wiICYmIGV2ZW50LnR5cGUgfHwgXCJcIjtcbiAgICByZXR1cm4gIS9eKD86KD86YmVmb3JlKT9jb3B5fGRlc3Ryb3kpJC8udGVzdChldmVudFR5cGUpO1xuICB9O1xuICAvKipcbiAqIENvbnRyb2wgaWYgYSBjYWxsYmFjayBzaG91bGQgYmUgZXhlY3V0ZWQgYXN5bmNocm9ub3VzbHkgb3Igbm90LlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZGlzcGF0Y2hDYWxsYmFjayA9IGZ1bmN0aW9uKGZ1bmMsIGNvbnRleHQsIGFyZ3MsIGFzeW5jKSB7XG4gICAgaWYgKGFzeW5jKSB7XG4gICAgICBfc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgIH0sIDApO1xuICAgIH0gZWxzZSB7XG4gICAgICBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBIYW5kbGUgdGhlIGFjdHVhbCBkaXNwYXRjaGluZyBvZiBldmVudHMgdG8gY2xpZW50IGluc3RhbmNlcy5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2Rpc3BhdGNoQ2FsbGJhY2tzID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICBpZiAoISh0eXBlb2YgZXZlbnQgPT09IFwib2JqZWN0XCIgJiYgZXZlbnQgJiYgZXZlbnQudHlwZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGFzeW5jID0gX3Nob3VsZFBlcmZvcm1Bc3luYyhldmVudCk7XG4gICAgdmFyIHdpbGRjYXJkVHlwZUhhbmRsZXJzID0gX2hhbmRsZXJzW1wiKlwiXSB8fCBbXTtcbiAgICB2YXIgc3BlY2lmaWNUeXBlSGFuZGxlcnMgPSBfaGFuZGxlcnNbZXZlbnQudHlwZV0gfHwgW107XG4gICAgdmFyIGhhbmRsZXJzID0gd2lsZGNhcmRUeXBlSGFuZGxlcnMuY29uY2F0KHNwZWNpZmljVHlwZUhhbmRsZXJzKTtcbiAgICBpZiAoaGFuZGxlcnMgJiYgaGFuZGxlcnMubGVuZ3RoKSB7XG4gICAgICB2YXIgaSwgbGVuLCBmdW5jLCBjb250ZXh0LCBldmVudENvcHksIG9yaWdpbmFsQ29udGV4dCA9IHRoaXM7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBoYW5kbGVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBmdW5jID0gaGFuZGxlcnNbaV07XG4gICAgICAgIGNvbnRleHQgPSBvcmlnaW5hbENvbnRleHQ7XG4gICAgICAgIGlmICh0eXBlb2YgZnVuYyA9PT0gXCJzdHJpbmdcIiAmJiB0eXBlb2YgX3dpbmRvd1tmdW5jXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgZnVuYyA9IF93aW5kb3dbZnVuY107XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBmdW5jID09PSBcIm9iamVjdFwiICYmIGZ1bmMgJiYgdHlwZW9mIGZ1bmMuaGFuZGxlRXZlbnQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIGNvbnRleHQgPSBmdW5jO1xuICAgICAgICAgIGZ1bmMgPSBmdW5jLmhhbmRsZUV2ZW50O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZnVuYyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgZXZlbnRDb3B5ID0gX2V4dGVuZCh7fSwgZXZlbnQpO1xuICAgICAgICAgIF9kaXNwYXRjaENhbGxiYWNrKGZ1bmMsIGNvbnRleHQsIFsgZXZlbnRDb3B5IF0sIGFzeW5jKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBDaGVjayBhbiBgZXJyb3JgIGV2ZW50J3MgYG5hbWVgIHByb3BlcnR5IHRvIHNlZSBpZiBGbGFzaCBoYXNcbiAqIGFscmVhZHkgbG9hZGVkLCB3aGljaCBydWxlcyBvdXQgcG9zc2libGUgYGlmcmFtZWAgc2FuZGJveGluZy5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXRTYW5kYm94U3RhdHVzRnJvbUVycm9yRXZlbnQgPSBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciBpc1NhbmRib3hlZCA9IG51bGw7XG4gICAgaWYgKF9wYWdlSXNGcmFtZWQgPT09IGZhbHNlIHx8IGV2ZW50ICYmIGV2ZW50LnR5cGUgPT09IFwiZXJyb3JcIiAmJiBldmVudC5uYW1lICYmIF9lcnJvcnNUaGF0T25seU9jY3VyQWZ0ZXJGbGFzaExvYWRzLmluZGV4T2YoZXZlbnQubmFtZSkgIT09IC0xKSB7XG4gICAgICBpc1NhbmRib3hlZCA9IGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gaXNTYW5kYm94ZWQ7XG4gIH07XG4gIC8qKlxuICogUHJlcHJvY2VzcyBhbnkgc3BlY2lhbCBiZWhhdmlvcnMsIHJlYWN0aW9ucywgb3Igc3RhdGUgY2hhbmdlcyBhZnRlciByZWNlaXZpbmcgdGhpcyBldmVudC5cbiAqIEV4ZWN1dGVzIG9ubHkgb25jZSBwZXIgZXZlbnQgZW1pdHRlZCwgTk9UIG9uY2UgcGVyIGNsaWVudC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9wcmVwcm9jZXNzRXZlbnQgPSBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciBlbGVtZW50ID0gZXZlbnQudGFyZ2V0IHx8IF9jdXJyZW50RWxlbWVudCB8fCBudWxsO1xuICAgIHZhciBzb3VyY2VJc1N3ZiA9IGV2ZW50Ll9zb3VyY2UgPT09IFwic3dmXCI7XG4gICAgZGVsZXRlIGV2ZW50Ll9zb3VyY2U7XG4gICAgc3dpdGNoIChldmVudC50eXBlKSB7XG4gICAgIGNhc2UgXCJlcnJvclwiOlxuICAgICAgdmFyIGlzU2FuZGJveGVkID0gZXZlbnQubmFtZSA9PT0gXCJmbGFzaC1zYW5kYm94ZWRcIiB8fCBfZ2V0U2FuZGJveFN0YXR1c0Zyb21FcnJvckV2ZW50KGV2ZW50KTtcbiAgICAgIGlmICh0eXBlb2YgaXNTYW5kYm94ZWQgPT09IFwiYm9vbGVhblwiKSB7XG4gICAgICAgIF9mbGFzaFN0YXRlLnNhbmRib3hlZCA9IGlzU2FuZGJveGVkO1xuICAgICAgfVxuICAgICAgaWYgKGV2ZW50Lm5hbWUgPT09IFwiYnJvd3Nlci11bnN1cHBvcnRlZFwiKSB7XG4gICAgICAgIF9leHRlbmQoX2ZsYXNoU3RhdGUsIHtcbiAgICAgICAgICBkaXNhYmxlZDogZmFsc2UsXG4gICAgICAgICAgb3V0ZGF0ZWQ6IGZhbHNlLFxuICAgICAgICAgIHVuYXZhaWxhYmxlOiBmYWxzZSxcbiAgICAgICAgICBkZWdyYWRlZDogZmFsc2UsXG4gICAgICAgICAgZGVhY3RpdmF0ZWQ6IGZhbHNlLFxuICAgICAgICAgIG92ZXJkdWU6IGZhbHNlLFxuICAgICAgICAgIHJlYWR5OiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAoX2ZsYXNoU3RhdGVFcnJvck5hbWVzLmluZGV4T2YoZXZlbnQubmFtZSkgIT09IC0xKSB7XG4gICAgICAgIF9leHRlbmQoX2ZsYXNoU3RhdGUsIHtcbiAgICAgICAgICBkaXNhYmxlZDogZXZlbnQubmFtZSA9PT0gXCJmbGFzaC1kaXNhYmxlZFwiLFxuICAgICAgICAgIG91dGRhdGVkOiBldmVudC5uYW1lID09PSBcImZsYXNoLW91dGRhdGVkXCIsXG4gICAgICAgICAgaW5zZWN1cmU6IGV2ZW50Lm5hbWUgPT09IFwiZmxhc2gtaW5zZWN1cmVcIixcbiAgICAgICAgICB1bmF2YWlsYWJsZTogZXZlbnQubmFtZSA9PT0gXCJmbGFzaC11bmF2YWlsYWJsZVwiLFxuICAgICAgICAgIGRlZ3JhZGVkOiBldmVudC5uYW1lID09PSBcImZsYXNoLWRlZ3JhZGVkXCIsXG4gICAgICAgICAgZGVhY3RpdmF0ZWQ6IGV2ZW50Lm5hbWUgPT09IFwiZmxhc2gtZGVhY3RpdmF0ZWRcIixcbiAgICAgICAgICBvdmVyZHVlOiBldmVudC5uYW1lID09PSBcImZsYXNoLW92ZXJkdWVcIixcbiAgICAgICAgICByZWFkeTogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKGV2ZW50Lm5hbWUgPT09IFwidmVyc2lvbi1taXNtYXRjaFwiKSB7XG4gICAgICAgIF96Y1N3ZlZlcnNpb24gPSBldmVudC5zd2ZWZXJzaW9uO1xuICAgICAgICBfZXh0ZW5kKF9mbGFzaFN0YXRlLCB7XG4gICAgICAgICAgZGlzYWJsZWQ6IGZhbHNlLFxuICAgICAgICAgIG91dGRhdGVkOiBmYWxzZSxcbiAgICAgICAgICBpbnNlY3VyZTogZmFsc2UsXG4gICAgICAgICAgdW5hdmFpbGFibGU6IGZhbHNlLFxuICAgICAgICAgIGRlZ3JhZGVkOiBmYWxzZSxcbiAgICAgICAgICBkZWFjdGl2YXRlZDogZmFsc2UsXG4gICAgICAgICAgb3ZlcmR1ZTogZmFsc2UsXG4gICAgICAgICAgcmVhZHk6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgX2NsZWFyVGltZW91dHNBbmRQb2xsaW5nKCk7XG4gICAgICBicmVhaztcblxuICAgICBjYXNlIFwicmVhZHlcIjpcbiAgICAgIF96Y1N3ZlZlcnNpb24gPSBldmVudC5zd2ZWZXJzaW9uO1xuICAgICAgdmFyIHdhc0RlYWN0aXZhdGVkID0gX2ZsYXNoU3RhdGUuZGVhY3RpdmF0ZWQgPT09IHRydWU7XG4gICAgICBfZXh0ZW5kKF9mbGFzaFN0YXRlLCB7XG4gICAgICAgIHNhbmRib3hlZDogZmFsc2UsXG4gICAgICAgIGRpc2FibGVkOiBmYWxzZSxcbiAgICAgICAgb3V0ZGF0ZWQ6IGZhbHNlLFxuICAgICAgICBpbnNlY3VyZTogZmFsc2UsXG4gICAgICAgIHVuYXZhaWxhYmxlOiBmYWxzZSxcbiAgICAgICAgZGVncmFkZWQ6IGZhbHNlLFxuICAgICAgICBkZWFjdGl2YXRlZDogZmFsc2UsXG4gICAgICAgIG92ZXJkdWU6IHdhc0RlYWN0aXZhdGVkLFxuICAgICAgICByZWFkeTogIXdhc0RlYWN0aXZhdGVkXG4gICAgICB9KTtcbiAgICAgIF9jbGVhclRpbWVvdXRzQW5kUG9sbGluZygpO1xuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcImJlZm9yZWNvcHlcIjpcbiAgICAgIF9jb3B5VGFyZ2V0ID0gZWxlbWVudDtcbiAgICAgIGJyZWFrO1xuXG4gICAgIGNhc2UgXCJjb3B5XCI6XG4gICAgICB2YXIgdGV4dENvbnRlbnQsIGh0bWxDb250ZW50LCB0YXJnZXRFbCA9IGV2ZW50LnJlbGF0ZWRUYXJnZXQ7XG4gICAgICBpZiAoIShfY2xpcERhdGFbXCJ0ZXh0L2h0bWxcIl0gfHwgX2NsaXBEYXRhW1widGV4dC9wbGFpblwiXSkgJiYgdGFyZ2V0RWwgJiYgKGh0bWxDb250ZW50ID0gdGFyZ2V0RWwudmFsdWUgfHwgdGFyZ2V0RWwub3V0ZXJIVE1MIHx8IHRhcmdldEVsLmlubmVySFRNTCkgJiYgKHRleHRDb250ZW50ID0gdGFyZ2V0RWwudmFsdWUgfHwgdGFyZ2V0RWwudGV4dENvbnRlbnQgfHwgdGFyZ2V0RWwuaW5uZXJUZXh0KSkge1xuICAgICAgICBldmVudC5jbGlwYm9hcmREYXRhLmNsZWFyRGF0YSgpO1xuICAgICAgICBldmVudC5jbGlwYm9hcmREYXRhLnNldERhdGEoXCJ0ZXh0L3BsYWluXCIsIHRleHRDb250ZW50KTtcbiAgICAgICAgaWYgKGh0bWxDb250ZW50ICE9PSB0ZXh0Q29udGVudCkge1xuICAgICAgICAgIGV2ZW50LmNsaXBib2FyZERhdGEuc2V0RGF0YShcInRleHQvaHRtbFwiLCBodG1sQ29udGVudCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoIV9jbGlwRGF0YVtcInRleHQvcGxhaW5cIl0gJiYgZXZlbnQudGFyZ2V0ICYmICh0ZXh0Q29udGVudCA9IGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWNsaXBib2FyZC10ZXh0XCIpKSkge1xuICAgICAgICBldmVudC5jbGlwYm9hcmREYXRhLmNsZWFyRGF0YSgpO1xuICAgICAgICBldmVudC5jbGlwYm9hcmREYXRhLnNldERhdGEoXCJ0ZXh0L3BsYWluXCIsIHRleHRDb250ZW50KTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgIGNhc2UgXCJhZnRlcmNvcHlcIjpcbiAgICAgIF9xdWV1ZUVtaXRDbGlwYm9hcmRFcnJvcnMoZXZlbnQpO1xuICAgICAgWmVyb0NsaXBib2FyZC5jbGVhckRhdGEoKTtcbiAgICAgIGlmIChlbGVtZW50ICYmIGVsZW1lbnQgIT09IF9zYWZlQWN0aXZlRWxlbWVudCgpICYmIGVsZW1lbnQuZm9jdXMpIHtcbiAgICAgICAgZWxlbWVudC5mb2N1cygpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcIl9tb3VzZW92ZXJcIjpcbiAgICAgIFplcm9DbGlwYm9hcmQuZm9jdXMoZWxlbWVudCk7XG4gICAgICBpZiAoX2dsb2JhbENvbmZpZy5idWJibGVFdmVudHMgPT09IHRydWUgJiYgc291cmNlSXNTd2YpIHtcbiAgICAgICAgaWYgKGVsZW1lbnQgJiYgZWxlbWVudCAhPT0gZXZlbnQucmVsYXRlZFRhcmdldCAmJiAhX2NvbnRhaW5lZEJ5KGV2ZW50LnJlbGF0ZWRUYXJnZXQsIGVsZW1lbnQpKSB7XG4gICAgICAgICAgX2ZpcmVNb3VzZUV2ZW50KF9leHRlbmQoe30sIGV2ZW50LCB7XG4gICAgICAgICAgICB0eXBlOiBcIm1vdXNlZW50ZXJcIixcbiAgICAgICAgICAgIGJ1YmJsZXM6IGZhbHNlLFxuICAgICAgICAgICAgY2FuY2VsYWJsZTogZmFsc2VcbiAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgX2ZpcmVNb3VzZUV2ZW50KF9leHRlbmQoe30sIGV2ZW50LCB7XG4gICAgICAgICAgdHlwZTogXCJtb3VzZW92ZXJcIlxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgICBicmVhaztcblxuICAgICBjYXNlIFwiX21vdXNlb3V0XCI6XG4gICAgICBaZXJvQ2xpcGJvYXJkLmJsdXIoKTtcbiAgICAgIGlmIChfZ2xvYmFsQ29uZmlnLmJ1YmJsZUV2ZW50cyA9PT0gdHJ1ZSAmJiBzb3VyY2VJc1N3Zikge1xuICAgICAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50ICE9PSBldmVudC5yZWxhdGVkVGFyZ2V0ICYmICFfY29udGFpbmVkQnkoZXZlbnQucmVsYXRlZFRhcmdldCwgZWxlbWVudCkpIHtcbiAgICAgICAgICBfZmlyZU1vdXNlRXZlbnQoX2V4dGVuZCh7fSwgZXZlbnQsIHtcbiAgICAgICAgICAgIHR5cGU6IFwibW91c2VsZWF2ZVwiLFxuICAgICAgICAgICAgYnViYmxlczogZmFsc2UsXG4gICAgICAgICAgICBjYW5jZWxhYmxlOiBmYWxzZVxuICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBfZmlyZU1vdXNlRXZlbnQoX2V4dGVuZCh7fSwgZXZlbnQsIHtcbiAgICAgICAgICB0eXBlOiBcIm1vdXNlb3V0XCJcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcIl9tb3VzZWRvd25cIjpcbiAgICAgIF9hZGRDbGFzcyhlbGVtZW50LCBfZ2xvYmFsQ29uZmlnLmFjdGl2ZUNsYXNzKTtcbiAgICAgIGlmIChfZ2xvYmFsQ29uZmlnLmJ1YmJsZUV2ZW50cyA9PT0gdHJ1ZSAmJiBzb3VyY2VJc1N3Zikge1xuICAgICAgICBfZmlyZU1vdXNlRXZlbnQoX2V4dGVuZCh7fSwgZXZlbnQsIHtcbiAgICAgICAgICB0eXBlOiBldmVudC50eXBlLnNsaWNlKDEpXG4gICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgIGNhc2UgXCJfbW91c2V1cFwiOlxuICAgICAgX3JlbW92ZUNsYXNzKGVsZW1lbnQsIF9nbG9iYWxDb25maWcuYWN0aXZlQ2xhc3MpO1xuICAgICAgaWYgKF9nbG9iYWxDb25maWcuYnViYmxlRXZlbnRzID09PSB0cnVlICYmIHNvdXJjZUlzU3dmKSB7XG4gICAgICAgIF9maXJlTW91c2VFdmVudChfZXh0ZW5kKHt9LCBldmVudCwge1xuICAgICAgICAgIHR5cGU6IGV2ZW50LnR5cGUuc2xpY2UoMSlcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcIl9jbGlja1wiOlxuICAgICAgX2NvcHlUYXJnZXQgPSBudWxsO1xuICAgICAgaWYgKF9nbG9iYWxDb25maWcuYnViYmxlRXZlbnRzID09PSB0cnVlICYmIHNvdXJjZUlzU3dmKSB7XG4gICAgICAgIF9maXJlTW91c2VFdmVudChfZXh0ZW5kKHt9LCBldmVudCwge1xuICAgICAgICAgIHR5cGU6IGV2ZW50LnR5cGUuc2xpY2UoMSlcbiAgICAgICAgfSkpO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICAgY2FzZSBcIl9tb3VzZW1vdmVcIjpcbiAgICAgIGlmIChfZ2xvYmFsQ29uZmlnLmJ1YmJsZUV2ZW50cyA9PT0gdHJ1ZSAmJiBzb3VyY2VJc1N3Zikge1xuICAgICAgICBfZmlyZU1vdXNlRXZlbnQoX2V4dGVuZCh7fSwgZXZlbnQsIHtcbiAgICAgICAgICB0eXBlOiBldmVudC50eXBlLnNsaWNlKDEpXG4gICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBpZiAoL15fKD86Y2xpY2t8bW91c2UoPzpvdmVyfG91dHxkb3dufHVwfG1vdmUpKSQvLnRlc3QoZXZlbnQudHlwZSkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBDaGVjayBhbiBcImFmdGVyY29weVwiIGV2ZW50IGZvciBjbGlwYm9hcmQgZXJyb3JzIGFuZCBlbWl0IGEgY29ycmVzcG9uZGluZyBcImVycm9yXCIgZXZlbnQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfcXVldWVFbWl0Q2xpcGJvYXJkRXJyb3JzID0gZnVuY3Rpb24oYWZ0ZXJjb3B5RXZlbnQpIHtcbiAgICBpZiAoYWZ0ZXJjb3B5RXZlbnQuZXJyb3JzICYmIGFmdGVyY29weUV2ZW50LmVycm9ycy5sZW5ndGggPiAwKSB7XG4gICAgICB2YXIgZXJyb3JFdmVudCA9IF9kZWVwQ29weShhZnRlcmNvcHlFdmVudCk7XG4gICAgICBfZXh0ZW5kKGVycm9yRXZlbnQsIHtcbiAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICBuYW1lOiBcImNsaXBib2FyZC1lcnJvclwiXG4gICAgICB9KTtcbiAgICAgIGRlbGV0ZSBlcnJvckV2ZW50LnN1Y2Nlc3M7XG4gICAgICBfc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgWmVyb0NsaXBib2FyZC5lbWl0KGVycm9yRXZlbnQpO1xuICAgICAgfSwgMCk7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIERpc3BhdGNoIGEgc3ludGhldGljIE1vdXNlRXZlbnQuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9maXJlTW91c2VFdmVudCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKCEoZXZlbnQgJiYgdHlwZW9mIGV2ZW50LnR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBlLCB0YXJnZXQgPSBldmVudC50YXJnZXQgfHwgbnVsbCwgZG9jID0gdGFyZ2V0ICYmIHRhcmdldC5vd25lckRvY3VtZW50IHx8IF9kb2N1bWVudCwgZGVmYXVsdHMgPSB7XG4gICAgICB2aWV3OiBkb2MuZGVmYXVsdFZpZXcgfHwgX3dpbmRvdyxcbiAgICAgIGNhbkJ1YmJsZTogdHJ1ZSxcbiAgICAgIGNhbmNlbGFibGU6IHRydWUsXG4gICAgICBkZXRhaWw6IGV2ZW50LnR5cGUgPT09IFwiY2xpY2tcIiA/IDEgOiAwLFxuICAgICAgYnV0dG9uOiB0eXBlb2YgZXZlbnQud2hpY2ggPT09IFwibnVtYmVyXCIgPyBldmVudC53aGljaCAtIDEgOiB0eXBlb2YgZXZlbnQuYnV0dG9uID09PSBcIm51bWJlclwiID8gZXZlbnQuYnV0dG9uIDogZG9jLmNyZWF0ZUV2ZW50ID8gMCA6IDFcbiAgICB9LCBhcmdzID0gX2V4dGVuZChkZWZhdWx0cywgZXZlbnQpO1xuICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChkb2MuY3JlYXRlRXZlbnQgJiYgdGFyZ2V0LmRpc3BhdGNoRXZlbnQpIHtcbiAgICAgIGFyZ3MgPSBbIGFyZ3MudHlwZSwgYXJncy5jYW5CdWJibGUsIGFyZ3MuY2FuY2VsYWJsZSwgYXJncy52aWV3LCBhcmdzLmRldGFpbCwgYXJncy5zY3JlZW5YLCBhcmdzLnNjcmVlblksIGFyZ3MuY2xpZW50WCwgYXJncy5jbGllbnRZLCBhcmdzLmN0cmxLZXksIGFyZ3MuYWx0S2V5LCBhcmdzLnNoaWZ0S2V5LCBhcmdzLm1ldGFLZXksIGFyZ3MuYnV0dG9uLCBhcmdzLnJlbGF0ZWRUYXJnZXQgXTtcbiAgICAgIGUgPSBkb2MuY3JlYXRlRXZlbnQoXCJNb3VzZUV2ZW50c1wiKTtcbiAgICAgIGlmIChlLmluaXRNb3VzZUV2ZW50KSB7XG4gICAgICAgIGUuaW5pdE1vdXNlRXZlbnQuYXBwbHkoZSwgYXJncyk7XG4gICAgICAgIGUuX3NvdXJjZSA9IFwianNcIjtcbiAgICAgICAgdGFyZ2V0LmRpc3BhdGNoRXZlbnQoZSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuICAvKipcbiAqIENvbnRpbnVvdXNseSBwb2xsIHRoZSBET00gdW50aWwgZWl0aGVyOlxuICogIChhKSB0aGUgZmFsbGJhY2sgY29udGVudCBiZWNvbWVzIHZpc2libGUsIG9yXG4gKiAgKGIpIHdlIHJlY2VpdmUgYW4gZXZlbnQgZnJvbSBTV0YgKGhhbmRsZWQgZWxzZXdoZXJlKVxuICpcbiAqIElNUE9SVEFOVDpcbiAqIFRoaXMgaXMgTk9UIGEgbmVjZXNzYXJ5IGNoZWNrIGJ1dCBpdCBjYW4gcmVzdWx0IGluIHNpZ25pZmljYW50bHkgZmFzdGVyXG4gKiBkZXRlY3Rpb24gb2YgYmFkIGBzd2ZQYXRoYCBjb25maWd1cmF0aW9uIGFuZC9vciBuZXR3b3JrL3NlcnZlciBpc3N1ZXMgW2luXG4gKiBzdXBwb3J0ZWQgYnJvd3NlcnNdIHRoYW4gd2FpdGluZyBmb3IgdGhlIGVudGlyZSBgZmxhc2hMb2FkVGltZW91dGAgZHVyYXRpb25cbiAqIHRvIGVsYXBzZSBiZWZvcmUgZGV0ZWN0aW5nIHRoYXQgdGhlIFNXRiBjYW5ub3QgYmUgbG9hZGVkLiBUaGUgZGV0ZWN0aW9uXG4gKiBkdXJhdGlvbiBjYW4gYmUgYW55d2hlcmUgZnJvbSAxMC0zMCB0aW1lcyBmYXN0ZXIgW2luIHN1cHBvcnRlZCBicm93c2Vyc10gYnlcbiAqIHVzaW5nIHRoaXMgYXBwcm9hY2guXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF93YXRjaEZvclN3ZkZhbGxiYWNrQ29udGVudCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBtYXhXYWl0ID0gX2dsb2JhbENvbmZpZy5mbGFzaExvYWRUaW1lb3V0O1xuICAgIGlmICh0eXBlb2YgbWF4V2FpdCA9PT0gXCJudW1iZXJcIiAmJiBtYXhXYWl0ID49IDApIHtcbiAgICAgIHZhciBwb2xsV2FpdCA9IE1hdGgubWluKDFlMywgbWF4V2FpdCAvIDEwKTtcbiAgICAgIHZhciBmYWxsYmFja0NvbnRlbnRJZCA9IF9nbG9iYWxDb25maWcuc3dmT2JqZWN0SWQgKyBcIl9mYWxsYmFja0NvbnRlbnRcIjtcbiAgICAgIF9zd2ZGYWxsYmFja0NoZWNrSW50ZXJ2YWwgPSBfc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBlbCA9IF9kb2N1bWVudC5nZXRFbGVtZW50QnlJZChmYWxsYmFja0NvbnRlbnRJZCk7XG4gICAgICAgIGlmIChfaXNFbGVtZW50VmlzaWJsZShlbCkpIHtcbiAgICAgICAgICBfY2xlYXJUaW1lb3V0c0FuZFBvbGxpbmcoKTtcbiAgICAgICAgICBfZmxhc2hTdGF0ZS5kZWFjdGl2YXRlZCA9IG51bGw7XG4gICAgICAgICAgWmVyb0NsaXBib2FyZC5lbWl0KHtcbiAgICAgICAgICAgIHR5cGU6IFwiZXJyb3JcIixcbiAgICAgICAgICAgIG5hbWU6IFwic3dmLW5vdC1mb3VuZFwiXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0sIHBvbGxXYWl0KTtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogQ3JlYXRlIHRoZSBIVE1MIGJyaWRnZSBlbGVtZW50IHRvIGVtYmVkIHRoZSBGbGFzaCBvYmplY3QgaW50by5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jcmVhdGVIdG1sQnJpZGdlID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNvbnRhaW5lciA9IF9kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIGNvbnRhaW5lci5pZCA9IF9nbG9iYWxDb25maWcuY29udGFpbmVySWQ7XG4gICAgY29udGFpbmVyLmNsYXNzTmFtZSA9IF9nbG9iYWxDb25maWcuY29udGFpbmVyQ2xhc3M7XG4gICAgY29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuICAgIGNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gXCIwcHhcIjtcbiAgICBjb250YWluZXIuc3R5bGUudG9wID0gXCItOTk5OXB4XCI7XG4gICAgY29udGFpbmVyLnN0eWxlLndpZHRoID0gXCIxcHhcIjtcbiAgICBjb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gXCIxcHhcIjtcbiAgICBjb250YWluZXIuc3R5bGUuekluZGV4ID0gXCJcIiArIF9nZXRTYWZlWkluZGV4KF9nbG9iYWxDb25maWcuekluZGV4KTtcbiAgICByZXR1cm4gY29udGFpbmVyO1xuICB9O1xuICAvKipcbiAqIEdldCB0aGUgSFRNTCBlbGVtZW50IGNvbnRhaW5lciB0aGF0IHdyYXBzIHRoZSBGbGFzaCBicmlkZ2Ugb2JqZWN0L2VsZW1lbnQuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0SHRtbEJyaWRnZSA9IGZ1bmN0aW9uKGZsYXNoQnJpZGdlKSB7XG4gICAgdmFyIGh0bWxCcmlkZ2UgPSBmbGFzaEJyaWRnZSAmJiBmbGFzaEJyaWRnZS5wYXJlbnROb2RlO1xuICAgIHdoaWxlIChodG1sQnJpZGdlICYmIGh0bWxCcmlkZ2Uubm9kZU5hbWUgPT09IFwiT0JKRUNUXCIgJiYgaHRtbEJyaWRnZS5wYXJlbnROb2RlKSB7XG4gICAgICBodG1sQnJpZGdlID0gaHRtbEJyaWRnZS5wYXJlbnROb2RlO1xuICAgIH1cbiAgICByZXR1cm4gaHRtbEJyaWRnZSB8fCBudWxsO1xuICB9O1xuICAvKipcbiAqXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZXNjYXBlWG1sVmFsdWUgPSBmdW5jdGlvbih2YWwpIHtcbiAgICBpZiAodHlwZW9mIHZhbCAhPT0gXCJzdHJpbmdcIiB8fCAhdmFsKSB7XG4gICAgICByZXR1cm4gdmFsO1xuICAgIH1cbiAgICByZXR1cm4gdmFsLnJlcGxhY2UoL1tcIiYnPD5dL2csIGZ1bmN0aW9uKGNocikge1xuICAgICAgc3dpdGNoIChjaHIpIHtcbiAgICAgICBjYXNlICdcIic6XG4gICAgICAgIHJldHVybiBcIiZxdW90O1wiO1xuXG4gICAgICAgY2FzZSBcIiZcIjpcbiAgICAgICAgcmV0dXJuIFwiJmFtcDtcIjtcblxuICAgICAgIGNhc2UgXCInXCI6XG4gICAgICAgIHJldHVybiBcIiZhcG9zO1wiO1xuXG4gICAgICAgY2FzZSBcIjxcIjpcbiAgICAgICAgcmV0dXJuIFwiJmx0O1wiO1xuXG4gICAgICAgY2FzZSBcIj5cIjpcbiAgICAgICAgcmV0dXJuIFwiJmd0O1wiO1xuXG4gICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIGNocjtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbiAgLyoqXG4gKiBDcmVhdGUgdGhlIFNXRiBvYmplY3QuXG4gKlxuICogQHJldHVybnMgVGhlIFNXRiBvYmplY3QgcmVmZXJlbmNlLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2VtYmVkU3dmID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGxlbiwgZmxhc2hCcmlkZ2UgPSBfZmxhc2hTdGF0ZS5icmlkZ2UsIGNvbnRhaW5lciA9IF9nZXRIdG1sQnJpZGdlKGZsYXNoQnJpZGdlKTtcbiAgICBpZiAoIWZsYXNoQnJpZGdlKSB7XG4gICAgICB2YXIgYWxsb3dTY3JpcHRBY2Nlc3MgPSBfZGV0ZXJtaW5lU2NyaXB0QWNjZXNzKF93aW5kb3cubG9jYXRpb24uaG9zdCwgX2dsb2JhbENvbmZpZyk7XG4gICAgICB2YXIgYWxsb3dOZXR3b3JraW5nID0gYWxsb3dTY3JpcHRBY2Nlc3MgPT09IFwibmV2ZXJcIiA/IFwibm9uZVwiIDogXCJhbGxcIjtcbiAgICAgIHZhciBmbGFzaHZhcnMgPSBfdmFycyhfZXh0ZW5kKHtcbiAgICAgICAganNWZXJzaW9uOiBaZXJvQ2xpcGJvYXJkLnZlcnNpb25cbiAgICAgIH0sIF9nbG9iYWxDb25maWcpKTtcbiAgICAgIHZhciBzd2ZVcmwgPSBfZ2xvYmFsQ29uZmlnLnN3ZlBhdGggKyBfY2FjaGVCdXN0KF9nbG9iYWxDb25maWcuc3dmUGF0aCwgX2dsb2JhbENvbmZpZyk7XG4gICAgICBpZiAoX3BhZ2VJc1hodG1sKSB7XG4gICAgICAgIHN3ZlVybCA9IF9lc2NhcGVYbWxWYWx1ZShzd2ZVcmwpO1xuICAgICAgfVxuICAgICAgY29udGFpbmVyID0gX2NyZWF0ZUh0bWxCcmlkZ2UoKTtcbiAgICAgIHZhciBkaXZUb0JlUmVwbGFjZWQgPSBfZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChkaXZUb0JlUmVwbGFjZWQpO1xuICAgICAgX2RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgICAgIHZhciB0bXBEaXYgPSBfZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIHZhciB1c2luZ0FjdGl2ZVggPSBfZmxhc2hTdGF0ZS5wbHVnaW5UeXBlID09PSBcImFjdGl2ZXhcIjtcbiAgICAgIHRtcERpdi5pbm5lckhUTUwgPSAnPG9iamVjdCBpZD1cIicgKyBfZ2xvYmFsQ29uZmlnLnN3Zk9iamVjdElkICsgJ1wiIG5hbWU9XCInICsgX2dsb2JhbENvbmZpZy5zd2ZPYmplY3RJZCArICdcIiAnICsgJ3dpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjEwMCVcIiAnICsgKHVzaW5nQWN0aXZlWCA/ICdjbGFzc2lkPVwiY2xzaWQ6ZDI3Y2RiNmUtYWU2ZC0xMWNmLTk2YjgtNDQ0NTUzNTQwMDAwXCInIDogJ3R5cGU9XCJhcHBsaWNhdGlvbi94LXNob2Nrd2F2ZS1mbGFzaFwiIGRhdGE9XCInICsgc3dmVXJsICsgJ1wiJykgKyBcIj5cIiArICh1c2luZ0FjdGl2ZVggPyAnPHBhcmFtIG5hbWU9XCJtb3ZpZVwiIHZhbHVlPVwiJyArIHN3ZlVybCArICdcIi8+JyA6IFwiXCIpICsgJzxwYXJhbSBuYW1lPVwiYWxsb3dTY3JpcHRBY2Nlc3NcIiB2YWx1ZT1cIicgKyBhbGxvd1NjcmlwdEFjY2VzcyArICdcIi8+JyArICc8cGFyYW0gbmFtZT1cImFsbG93TmV0d29ya2luZ1wiIHZhbHVlPVwiJyArIGFsbG93TmV0d29ya2luZyArICdcIi8+JyArICc8cGFyYW0gbmFtZT1cIm1lbnVcIiB2YWx1ZT1cImZhbHNlXCIvPicgKyAnPHBhcmFtIG5hbWU9XCJ3bW9kZVwiIHZhbHVlPVwidHJhbnNwYXJlbnRcIi8+JyArICc8cGFyYW0gbmFtZT1cImZsYXNodmFyc1wiIHZhbHVlPVwiJyArIGZsYXNodmFycyArICdcIi8+JyArICc8ZGl2IGlkPVwiJyArIF9nbG9iYWxDb25maWcuc3dmT2JqZWN0SWQgKyAnX2ZhbGxiYWNrQ29udGVudFwiPiZuYnNwOzwvZGl2PicgKyBcIjwvb2JqZWN0PlwiO1xuICAgICAgZmxhc2hCcmlkZ2UgPSB0bXBEaXYuZmlyc3RDaGlsZDtcbiAgICAgIHRtcERpdiA9IG51bGw7XG4gICAgICBfdW53cmFwKGZsYXNoQnJpZGdlKS5aZXJvQ2xpcGJvYXJkID0gWmVyb0NsaXBib2FyZDtcbiAgICAgIGNvbnRhaW5lci5yZXBsYWNlQ2hpbGQoZmxhc2hCcmlkZ2UsIGRpdlRvQmVSZXBsYWNlZCk7XG4gICAgICBfd2F0Y2hGb3JTd2ZGYWxsYmFja0NvbnRlbnQoKTtcbiAgICB9XG4gICAgaWYgKCFmbGFzaEJyaWRnZSkge1xuICAgICAgZmxhc2hCcmlkZ2UgPSBfZG9jdW1lbnRbX2dsb2JhbENvbmZpZy5zd2ZPYmplY3RJZF07XG4gICAgICBpZiAoZmxhc2hCcmlkZ2UgJiYgKGxlbiA9IGZsYXNoQnJpZGdlLmxlbmd0aCkpIHtcbiAgICAgICAgZmxhc2hCcmlkZ2UgPSBmbGFzaEJyaWRnZVtsZW4gLSAxXTtcbiAgICAgIH1cbiAgICAgIGlmICghZmxhc2hCcmlkZ2UgJiYgY29udGFpbmVyKSB7XG4gICAgICAgIGZsYXNoQnJpZGdlID0gY29udGFpbmVyLmZpcnN0Q2hpbGQ7XG4gICAgICB9XG4gICAgfVxuICAgIF9mbGFzaFN0YXRlLmJyaWRnZSA9IGZsYXNoQnJpZGdlIHx8IG51bGw7XG4gICAgcmV0dXJuIGZsYXNoQnJpZGdlO1xuICB9O1xuICAvKipcbiAqIERlc3Ryb3kgdGhlIFNXRiBvYmplY3QuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfdW5lbWJlZFN3ZiA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBmbGFzaEJyaWRnZSA9IF9mbGFzaFN0YXRlLmJyaWRnZTtcbiAgICBpZiAoZmxhc2hCcmlkZ2UpIHtcbiAgICAgIHZhciBodG1sQnJpZGdlID0gX2dldEh0bWxCcmlkZ2UoZmxhc2hCcmlkZ2UpO1xuICAgICAgaWYgKGh0bWxCcmlkZ2UpIHtcbiAgICAgICAgaWYgKF9mbGFzaFN0YXRlLnBsdWdpblR5cGUgPT09IFwiYWN0aXZleFwiICYmIFwicmVhZHlTdGF0ZVwiIGluIGZsYXNoQnJpZGdlKSB7XG4gICAgICAgICAgZmxhc2hCcmlkZ2Uuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICAgIChmdW5jdGlvbiByZW1vdmVTd2ZGcm9tSUUoKSB7XG4gICAgICAgICAgICBpZiAoZmxhc2hCcmlkZ2UucmVhZHlTdGF0ZSA9PT0gNCkge1xuICAgICAgICAgICAgICBmb3IgKHZhciBwcm9wIGluIGZsYXNoQnJpZGdlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmbGFzaEJyaWRnZVtwcm9wXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICBmbGFzaEJyaWRnZVtwcm9wXSA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGlmIChmbGFzaEJyaWRnZS5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgZmxhc2hCcmlkZ2UucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChmbGFzaEJyaWRnZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKGh0bWxCcmlkZ2UucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgICAgIGh0bWxCcmlkZ2UucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChodG1sQnJpZGdlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgX3NldFRpbWVvdXQocmVtb3ZlU3dmRnJvbUlFLCAxMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSkoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoZmxhc2hCcmlkZ2UucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgZmxhc2hCcmlkZ2UucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChmbGFzaEJyaWRnZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChodG1sQnJpZGdlLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgIGh0bWxCcmlkZ2UucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChodG1sQnJpZGdlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIF9jbGVhclRpbWVvdXRzQW5kUG9sbGluZygpO1xuICAgICAgX2ZsYXNoU3RhdGUucmVhZHkgPSBudWxsO1xuICAgICAgX2ZsYXNoU3RhdGUuYnJpZGdlID0gbnVsbDtcbiAgICAgIF9mbGFzaFN0YXRlLmRlYWN0aXZhdGVkID0gbnVsbDtcbiAgICAgIF9mbGFzaFN0YXRlLmluc2VjdXJlID0gbnVsbDtcbiAgICAgIF96Y1N3ZlZlcnNpb24gPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIE1hcCB0aGUgZGF0YSBmb3JtYXQgbmFtZXMgb2YgdGhlIFwiY2xpcERhdGFcIiB0byBGbGFzaC1mcmllbmRseSBuYW1lcy5cbiAqXG4gKiBAcmV0dXJucyBBIG5ldyB0cmFuc2Zvcm1lZCBvYmplY3QuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfbWFwQ2xpcERhdGFUb0ZsYXNoID0gZnVuY3Rpb24oY2xpcERhdGEpIHtcbiAgICB2YXIgbmV3Q2xpcERhdGEgPSB7fSwgZm9ybWF0TWFwID0ge307XG4gICAgaWYgKCEodHlwZW9mIGNsaXBEYXRhID09PSBcIm9iamVjdFwiICYmIGNsaXBEYXRhKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmb3IgKHZhciBkYXRhRm9ybWF0IGluIGNsaXBEYXRhKSB7XG4gICAgICBpZiAoZGF0YUZvcm1hdCAmJiBfaGFzT3duLmNhbGwoY2xpcERhdGEsIGRhdGFGb3JtYXQpICYmIHR5cGVvZiBjbGlwRGF0YVtkYXRhRm9ybWF0XSA9PT0gXCJzdHJpbmdcIiAmJiBjbGlwRGF0YVtkYXRhRm9ybWF0XSkge1xuICAgICAgICBzd2l0Y2ggKGRhdGFGb3JtYXQudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgY2FzZSBcInRleHQvcGxhaW5cIjpcbiAgICAgICAgIGNhc2UgXCJ0ZXh0XCI6XG4gICAgICAgICBjYXNlIFwiYWlyOnRleHRcIjpcbiAgICAgICAgIGNhc2UgXCJmbGFzaDp0ZXh0XCI6XG4gICAgICAgICAgbmV3Q2xpcERhdGEudGV4dCA9IGNsaXBEYXRhW2RhdGFGb3JtYXRdO1xuICAgICAgICAgIGZvcm1hdE1hcC50ZXh0ID0gZGF0YUZvcm1hdDtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICAgY2FzZSBcInRleHQvaHRtbFwiOlxuICAgICAgICAgY2FzZSBcImh0bWxcIjpcbiAgICAgICAgIGNhc2UgXCJhaXI6aHRtbFwiOlxuICAgICAgICAgY2FzZSBcImZsYXNoOmh0bWxcIjpcbiAgICAgICAgICBuZXdDbGlwRGF0YS5odG1sID0gY2xpcERhdGFbZGF0YUZvcm1hdF07XG4gICAgICAgICAgZm9ybWF0TWFwLmh0bWwgPSBkYXRhRm9ybWF0O1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICBjYXNlIFwiYXBwbGljYXRpb24vcnRmXCI6XG4gICAgICAgICBjYXNlIFwidGV4dC9ydGZcIjpcbiAgICAgICAgIGNhc2UgXCJydGZcIjpcbiAgICAgICAgIGNhc2UgXCJyaWNodGV4dFwiOlxuICAgICAgICAgY2FzZSBcImFpcjpydGZcIjpcbiAgICAgICAgIGNhc2UgXCJmbGFzaDpydGZcIjpcbiAgICAgICAgICBuZXdDbGlwRGF0YS5ydGYgPSBjbGlwRGF0YVtkYXRhRm9ybWF0XTtcbiAgICAgICAgICBmb3JtYXRNYXAucnRmID0gZGF0YUZvcm1hdDtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgZGF0YTogbmV3Q2xpcERhdGEsXG4gICAgICBmb3JtYXRNYXA6IGZvcm1hdE1hcFxuICAgIH07XG4gIH07XG4gIC8qKlxuICogTWFwIHRoZSBkYXRhIGZvcm1hdCBuYW1lcyBmcm9tIEZsYXNoLWZyaWVuZGx5IG5hbWVzIGJhY2sgdG8gdGhlaXIgb3JpZ2luYWwgXCJjbGlwRGF0YVwiIG5hbWVzICh2aWEgYSBmb3JtYXQgbWFwcGluZykuXG4gKlxuICogQHJldHVybnMgQSBuZXcgdHJhbnNmb3JtZWQgb2JqZWN0LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX21hcENsaXBSZXN1bHRzRnJvbUZsYXNoID0gZnVuY3Rpb24oY2xpcFJlc3VsdHMsIGZvcm1hdE1hcCkge1xuICAgIGlmICghKHR5cGVvZiBjbGlwUmVzdWx0cyA9PT0gXCJvYmplY3RcIiAmJiBjbGlwUmVzdWx0cyAmJiB0eXBlb2YgZm9ybWF0TWFwID09PSBcIm9iamVjdFwiICYmIGZvcm1hdE1hcCkpIHtcbiAgICAgIHJldHVybiBjbGlwUmVzdWx0cztcbiAgICB9XG4gICAgdmFyIG5ld1Jlc3VsdHMgPSB7fTtcbiAgICBmb3IgKHZhciBwcm9wIGluIGNsaXBSZXN1bHRzKSB7XG4gICAgICBpZiAoX2hhc093bi5jYWxsKGNsaXBSZXN1bHRzLCBwcm9wKSkge1xuICAgICAgICBpZiAocHJvcCA9PT0gXCJlcnJvcnNcIikge1xuICAgICAgICAgIG5ld1Jlc3VsdHNbcHJvcF0gPSBjbGlwUmVzdWx0c1twcm9wXSA/IGNsaXBSZXN1bHRzW3Byb3BdLnNsaWNlKCkgOiBbXTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gbmV3UmVzdWx0c1twcm9wXS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgbmV3UmVzdWx0c1twcm9wXVtpXS5mb3JtYXQgPSBmb3JtYXRNYXBbbmV3UmVzdWx0c1twcm9wXVtpXS5mb3JtYXRdO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChwcm9wICE9PSBcInN1Y2Nlc3NcIiAmJiBwcm9wICE9PSBcImRhdGFcIikge1xuICAgICAgICAgIG5ld1Jlc3VsdHNbcHJvcF0gPSBjbGlwUmVzdWx0c1twcm9wXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdSZXN1bHRzW3Byb3BdID0ge307XG4gICAgICAgICAgdmFyIHRtcEhhc2ggPSBjbGlwUmVzdWx0c1twcm9wXTtcbiAgICAgICAgICBmb3IgKHZhciBkYXRhRm9ybWF0IGluIHRtcEhhc2gpIHtcbiAgICAgICAgICAgIGlmIChkYXRhRm9ybWF0ICYmIF9oYXNPd24uY2FsbCh0bXBIYXNoLCBkYXRhRm9ybWF0KSAmJiBfaGFzT3duLmNhbGwoZm9ybWF0TWFwLCBkYXRhRm9ybWF0KSkge1xuICAgICAgICAgICAgICBuZXdSZXN1bHRzW3Byb3BdW2Zvcm1hdE1hcFtkYXRhRm9ybWF0XV0gPSB0bXBIYXNoW2RhdGFGb3JtYXRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3UmVzdWx0cztcbiAgfTtcbiAgLyoqXG4gKiBXaWxsIGxvb2sgYXQgYSBwYXRoLCBhbmQgd2lsbCBjcmVhdGUgYSBcIj9ub0NhY2hlPXt0aW1lfVwiIG9yIFwiJm5vQ2FjaGU9e3RpbWV9XCJcbiAqIHF1ZXJ5IHBhcmFtIHN0cmluZyB0byByZXR1cm4uIERvZXMgTk9UIGFwcGVuZCB0aGF0IHN0cmluZyB0byB0aGUgb3JpZ2luYWwgcGF0aC5cbiAqIFRoaXMgaXMgdXNlZnVsIGJlY2F1c2UgRXh0ZXJuYWxJbnRlcmZhY2Ugb2Z0ZW4gYnJlYWtzIHdoZW4gYSBGbGFzaCBTV0YgaXMgY2FjaGVkLlxuICpcbiAqIEByZXR1cm5zIFRoZSBgbm9DYWNoZWAgcXVlcnkgcGFyYW0gd2l0aCBuZWNlc3NhcnkgXCI/XCIvXCImXCIgcHJlZml4LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NhY2hlQnVzdCA9IGZ1bmN0aW9uKHBhdGgsIG9wdGlvbnMpIHtcbiAgICB2YXIgY2FjaGVCdXN0ID0gb3B0aW9ucyA9PSBudWxsIHx8IG9wdGlvbnMgJiYgb3B0aW9ucy5jYWNoZUJ1c3QgPT09IHRydWU7XG4gICAgaWYgKGNhY2hlQnVzdCkge1xuICAgICAgcmV0dXJuIChwYXRoLmluZGV4T2YoXCI/XCIpID09PSAtMSA/IFwiP1wiIDogXCImXCIpICsgXCJub0NhY2hlPVwiICsgX25vdygpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gXCJcIjtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogQ3JlYXRlcyBhIHF1ZXJ5IHN0cmluZyBmb3IgdGhlIEZsYXNoVmFycyBwYXJhbS5cbiAqIERvZXMgTk9UIGluY2x1ZGUgdGhlIGNhY2hlLWJ1c3RpbmcgcXVlcnkgcGFyYW0uXG4gKlxuICogQHJldHVybnMgRmxhc2hWYXJzIHF1ZXJ5IHN0cmluZ1xuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3ZhcnMgPSBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgdmFyIGksIGxlbiwgZG9tYWluLCBkb21haW5zLCBzdHIgPSBcIlwiLCB0cnVzdGVkT3JpZ2luc0V4cGFuZGVkID0gW107XG4gICAgaWYgKG9wdGlvbnMudHJ1c3RlZERvbWFpbnMpIHtcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucy50cnVzdGVkRG9tYWlucyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBkb21haW5zID0gWyBvcHRpb25zLnRydXN0ZWREb21haW5zIF07XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvcHRpb25zLnRydXN0ZWREb21haW5zID09PSBcIm9iamVjdFwiICYmIFwibGVuZ3RoXCIgaW4gb3B0aW9ucy50cnVzdGVkRG9tYWlucykge1xuICAgICAgICBkb21haW5zID0gb3B0aW9ucy50cnVzdGVkRG9tYWlucztcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGRvbWFpbnMgJiYgZG9tYWlucy5sZW5ndGgpIHtcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGRvbWFpbnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgaWYgKF9oYXNPd24uY2FsbChkb21haW5zLCBpKSAmJiBkb21haW5zW2ldICYmIHR5cGVvZiBkb21haW5zW2ldID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgZG9tYWluID0gX2V4dHJhY3REb21haW4oZG9tYWluc1tpXSk7XG4gICAgICAgICAgaWYgKCFkb21haW4pIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZG9tYWluID09PSBcIipcIikge1xuICAgICAgICAgICAgdHJ1c3RlZE9yaWdpbnNFeHBhbmRlZC5sZW5ndGggPSAwO1xuICAgICAgICAgICAgdHJ1c3RlZE9yaWdpbnNFeHBhbmRlZC5wdXNoKGRvbWFpbik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgdHJ1c3RlZE9yaWdpbnNFeHBhbmRlZC5wdXNoLmFwcGx5KHRydXN0ZWRPcmlnaW5zRXhwYW5kZWQsIFsgZG9tYWluLCBcIi8vXCIgKyBkb21haW4sIF93aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgKyBcIi8vXCIgKyBkb21haW4gXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHRydXN0ZWRPcmlnaW5zRXhwYW5kZWQubGVuZ3RoKSB7XG4gICAgICBzdHIgKz0gXCJ0cnVzdGVkT3JpZ2lucz1cIiArIF9lbmNvZGVVUklDb21wb25lbnQodHJ1c3RlZE9yaWdpbnNFeHBhbmRlZC5qb2luKFwiLFwiKSk7XG4gICAgfVxuICAgIGlmIChvcHRpb25zLmZvcmNlRW5oYW5jZWRDbGlwYm9hcmQgPT09IHRydWUpIHtcbiAgICAgIHN0ciArPSAoc3RyID8gXCImXCIgOiBcIlwiKSArIFwiZm9yY2VFbmhhbmNlZENsaXBib2FyZD10cnVlXCI7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5zd2ZPYmplY3RJZCA9PT0gXCJzdHJpbmdcIiAmJiBvcHRpb25zLnN3Zk9iamVjdElkKSB7XG4gICAgICBzdHIgKz0gKHN0ciA/IFwiJlwiIDogXCJcIikgKyBcInN3Zk9iamVjdElkPVwiICsgX2VuY29kZVVSSUNvbXBvbmVudChvcHRpb25zLnN3Zk9iamVjdElkKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLmpzVmVyc2lvbiA9PT0gXCJzdHJpbmdcIiAmJiBvcHRpb25zLmpzVmVyc2lvbikge1xuICAgICAgc3RyICs9IChzdHIgPyBcIiZcIiA6IFwiXCIpICsgXCJqc1ZlcnNpb249XCIgKyBfZW5jb2RlVVJJQ29tcG9uZW50KG9wdGlvbnMuanNWZXJzaW9uKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0cjtcbiAgfTtcbiAgLyoqXG4gKiBFeHRyYWN0IHRoZSBkb21haW4gKGUuZy4gXCJnaXRodWIuY29tXCIpIGZyb20gYW4gb3JpZ2luIChlLmcuIFwiaHR0cHM6Ly9naXRodWIuY29tXCIpIG9yXG4gKiBVUkwgKGUuZy4gXCJodHRwczovL2dpdGh1Yi5jb20vemVyb2NsaXBib2FyZC96ZXJvY2xpcGJvYXJkL1wiKS5cbiAqXG4gKiBAcmV0dXJucyB0aGUgZG9tYWluXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZXh0cmFjdERvbWFpbiA9IGZ1bmN0aW9uKG9yaWdpbk9yVXJsKSB7XG4gICAgaWYgKG9yaWdpbk9yVXJsID09IG51bGwgfHwgb3JpZ2luT3JVcmwgPT09IFwiXCIpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBvcmlnaW5PclVybCA9IG9yaWdpbk9yVXJsLnJlcGxhY2UoL15cXHMrfFxccyskL2csIFwiXCIpO1xuICAgIGlmIChvcmlnaW5PclVybCA9PT0gXCJcIikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBwcm90b2NvbEluZGV4ID0gb3JpZ2luT3JVcmwuaW5kZXhPZihcIi8vXCIpO1xuICAgIG9yaWdpbk9yVXJsID0gcHJvdG9jb2xJbmRleCA9PT0gLTEgPyBvcmlnaW5PclVybCA6IG9yaWdpbk9yVXJsLnNsaWNlKHByb3RvY29sSW5kZXggKyAyKTtcbiAgICB2YXIgcGF0aEluZGV4ID0gb3JpZ2luT3JVcmwuaW5kZXhPZihcIi9cIik7XG4gICAgb3JpZ2luT3JVcmwgPSBwYXRoSW5kZXggPT09IC0xID8gb3JpZ2luT3JVcmwgOiBwcm90b2NvbEluZGV4ID09PSAtMSB8fCBwYXRoSW5kZXggPT09IDAgPyBudWxsIDogb3JpZ2luT3JVcmwuc2xpY2UoMCwgcGF0aEluZGV4KTtcbiAgICBpZiAob3JpZ2luT3JVcmwgJiYgb3JpZ2luT3JVcmwuc2xpY2UoLTQpLnRvTG93ZXJDYXNlKCkgPT09IFwiLnN3ZlwiKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIG9yaWdpbk9yVXJsIHx8IG51bGw7XG4gIH07XG4gIC8qKlxuICogU2V0IGBhbGxvd1NjcmlwdEFjY2Vzc2AgYmFzZWQgb24gYHRydXN0ZWREb21haW5zYCBhbmQgYHdpbmRvdy5sb2NhdGlvbi5ob3N0YCB2cy4gYHN3ZlBhdGhgLlxuICpcbiAqIEByZXR1cm5zIFRoZSBhcHByb3ByaWF0ZSBzY3JpcHQgYWNjZXNzIGxldmVsLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2RldGVybWluZVNjcmlwdEFjY2VzcyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBfZXh0cmFjdEFsbERvbWFpbnMgPSBmdW5jdGlvbihvcmlnaW5zKSB7XG4gICAgICB2YXIgaSwgbGVuLCB0bXAsIHJlc3VsdHNBcnJheSA9IFtdO1xuICAgICAgaWYgKHR5cGVvZiBvcmlnaW5zID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIG9yaWdpbnMgPSBbIG9yaWdpbnMgXTtcbiAgICAgIH1cbiAgICAgIGlmICghKHR5cGVvZiBvcmlnaW5zID09PSBcIm9iamVjdFwiICYmIG9yaWdpbnMgJiYgdHlwZW9mIG9yaWdpbnMubGVuZ3RoID09PSBcIm51bWJlclwiKSkge1xuICAgICAgICByZXR1cm4gcmVzdWx0c0FycmF5O1xuICAgICAgfVxuICAgICAgZm9yIChpID0gMCwgbGVuID0gb3JpZ2lucy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAoX2hhc093bi5jYWxsKG9yaWdpbnMsIGkpICYmICh0bXAgPSBfZXh0cmFjdERvbWFpbihvcmlnaW5zW2ldKSkpIHtcbiAgICAgICAgICBpZiAodG1wID09PSBcIipcIikge1xuICAgICAgICAgICAgcmVzdWx0c0FycmF5Lmxlbmd0aCA9IDA7XG4gICAgICAgICAgICByZXN1bHRzQXJyYXkucHVzaChcIipcIik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHJlc3VsdHNBcnJheS5pbmRleE9mKHRtcCkgPT09IC0xKSB7XG4gICAgICAgICAgICByZXN1bHRzQXJyYXkucHVzaCh0bXApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdHNBcnJheTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbihjdXJyZW50RG9tYWluLCBjb25maWdPcHRpb25zKSB7XG4gICAgICB2YXIgc3dmRG9tYWluID0gX2V4dHJhY3REb21haW4oY29uZmlnT3B0aW9ucy5zd2ZQYXRoKTtcbiAgICAgIGlmIChzd2ZEb21haW4gPT09IG51bGwpIHtcbiAgICAgICAgc3dmRG9tYWluID0gY3VycmVudERvbWFpbjtcbiAgICAgIH1cbiAgICAgIHZhciB0cnVzdGVkRG9tYWlucyA9IF9leHRyYWN0QWxsRG9tYWlucyhjb25maWdPcHRpb25zLnRydXN0ZWREb21haW5zKTtcbiAgICAgIHZhciBsZW4gPSB0cnVzdGVkRG9tYWlucy5sZW5ndGg7XG4gICAgICBpZiAobGVuID4gMCkge1xuICAgICAgICBpZiAobGVuID09PSAxICYmIHRydXN0ZWREb21haW5zWzBdID09PSBcIipcIikge1xuICAgICAgICAgIHJldHVybiBcImFsd2F5c1wiO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0cnVzdGVkRG9tYWlucy5pbmRleE9mKGN1cnJlbnREb21haW4pICE9PSAtMSkge1xuICAgICAgICAgIGlmIChsZW4gPT09IDEgJiYgY3VycmVudERvbWFpbiA9PT0gc3dmRG9tYWluKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJzYW1lRG9tYWluXCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBcImFsd2F5c1wiO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gXCJuZXZlclwiO1xuICAgIH07XG4gIH0oKTtcbiAgLyoqXG4gKiBHZXQgdGhlIGN1cnJlbnRseSBhY3RpdmUvZm9jdXNlZCBET00gZWxlbWVudC5cbiAqXG4gKiBAcmV0dXJucyB0aGUgY3VycmVudGx5IGFjdGl2ZS9mb2N1c2VkIGVsZW1lbnQsIG9yIGBudWxsYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3NhZmVBY3RpdmVFbGVtZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBfZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBBZGQgYSBjbGFzcyB0byBhbiBlbGVtZW50LCBpZiBpdCBkb2Vzbid0IGFscmVhZHkgaGF2ZSBpdC5cbiAqXG4gKiBAcmV0dXJucyBUaGUgZWxlbWVudCwgd2l0aCBpdHMgbmV3IGNsYXNzIGFkZGVkLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2FkZENsYXNzID0gZnVuY3Rpb24oZWxlbWVudCwgdmFsdWUpIHtcbiAgICB2YXIgYywgY2wsIGNsYXNzTmFtZSwgY2xhc3NOYW1lcyA9IFtdO1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdmFsdWUpIHtcbiAgICAgIGNsYXNzTmFtZXMgPSB2YWx1ZS5zcGxpdCgvXFxzKy8pO1xuICAgIH1cbiAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50Lm5vZGVUeXBlID09PSAxICYmIGNsYXNzTmFtZXMubGVuZ3RoID4gMCkge1xuICAgICAgY2xhc3NOYW1lID0gKFwiIFwiICsgKGVsZW1lbnQuY2xhc3NOYW1lIHx8IFwiXCIpICsgXCIgXCIpLnJlcGxhY2UoL1tcXHRcXHJcXG5cXGZdL2csIFwiIFwiKTtcbiAgICAgIGZvciAoYyA9IDAsIGNsID0gY2xhc3NOYW1lcy5sZW5ndGg7IGMgPCBjbDsgYysrKSB7XG4gICAgICAgIGlmIChjbGFzc05hbWUuaW5kZXhPZihcIiBcIiArIGNsYXNzTmFtZXNbY10gKyBcIiBcIikgPT09IC0xKSB7XG4gICAgICAgICAgY2xhc3NOYW1lICs9IGNsYXNzTmFtZXNbY10gKyBcIiBcIjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lLnJlcGxhY2UoL15cXHMrfFxccyskL2csIFwiXCIpO1xuICAgICAgaWYgKGNsYXNzTmFtZSAhPT0gZWxlbWVudC5jbGFzc05hbWUpIHtcbiAgICAgICAgZWxlbWVudC5jbGFzc05hbWUgPSBjbGFzc05hbWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBlbGVtZW50O1xuICB9O1xuICAvKipcbiAqIFJlbW92ZSBhIGNsYXNzIGZyb20gYW4gZWxlbWVudCwgaWYgaXQgaGFzIGl0LlxuICpcbiAqIEByZXR1cm5zIFRoZSBlbGVtZW50LCB3aXRoIGl0cyBjbGFzcyByZW1vdmVkLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3JlbW92ZUNsYXNzID0gZnVuY3Rpb24oZWxlbWVudCwgdmFsdWUpIHtcbiAgICB2YXIgYywgY2wsIGNsYXNzTmFtZSwgY2xhc3NOYW1lcyA9IFtdO1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdmFsdWUpIHtcbiAgICAgIGNsYXNzTmFtZXMgPSB2YWx1ZS5zcGxpdCgvXFxzKy8pO1xuICAgIH1cbiAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50Lm5vZGVUeXBlID09PSAxICYmIGNsYXNzTmFtZXMubGVuZ3RoID4gMCkge1xuICAgICAgaWYgKGVsZW1lbnQuY2xhc3NOYW1lKSB7XG4gICAgICAgIGNsYXNzTmFtZSA9IChcIiBcIiArIGVsZW1lbnQuY2xhc3NOYW1lICsgXCIgXCIpLnJlcGxhY2UoL1tcXHRcXHJcXG5cXGZdL2csIFwiIFwiKTtcbiAgICAgICAgZm9yIChjID0gMCwgY2wgPSBjbGFzc05hbWVzLmxlbmd0aDsgYyA8IGNsOyBjKyspIHtcbiAgICAgICAgICBjbGFzc05hbWUgPSBjbGFzc05hbWUucmVwbGFjZShcIiBcIiArIGNsYXNzTmFtZXNbY10gKyBcIiBcIiwgXCIgXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNsYXNzTmFtZSA9IGNsYXNzTmFtZS5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCBcIlwiKTtcbiAgICAgICAgaWYgKGNsYXNzTmFtZSAhPT0gZWxlbWVudC5jbGFzc05hbWUpIHtcbiAgICAgICAgICBlbGVtZW50LmNsYXNzTmFtZSA9IGNsYXNzTmFtZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZWxlbWVudDtcbiAgfTtcbiAgLyoqXG4gKiBBdHRlbXB0IHRvIGludGVycHJldCB0aGUgZWxlbWVudCdzIENTUyBzdHlsaW5nLiBJZiBgcHJvcGAgaXMgYFwiY3Vyc29yXCJgLFxuICogdGhlbiB3ZSBhc3N1bWUgdGhhdCBpdCBzaG91bGQgYmUgYSBoYW5kIChcInBvaW50ZXJcIikgY3Vyc29yIGlmIHRoZSBlbGVtZW50XG4gKiBpcyBhbiBhbmNob3IgZWxlbWVudCAoXCJhXCIgdGFnKS5cbiAqXG4gKiBAcmV0dXJucyBUaGUgY29tcHV0ZWQgc3R5bGUgcHJvcGVydHkuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfZ2V0U3R5bGUgPSBmdW5jdGlvbihlbCwgcHJvcCkge1xuICAgIHZhciB2YWx1ZSA9IF9nZXRDb21wdXRlZFN0eWxlKGVsLCBudWxsKS5nZXRQcm9wZXJ0eVZhbHVlKHByb3ApO1xuICAgIGlmIChwcm9wID09PSBcImN1cnNvclwiKSB7XG4gICAgICBpZiAoIXZhbHVlIHx8IHZhbHVlID09PSBcImF1dG9cIikge1xuICAgICAgICBpZiAoZWwubm9kZU5hbWUgPT09IFwiQVwiKSB7XG4gICAgICAgICAgcmV0dXJuIFwicG9pbnRlclwiO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfTtcbiAgLyoqXG4gKiBHZXQgdGhlIGFic29sdXRlbHkgcG9zaXRpb25lZCBjb29yZGluYXRlcyBvZiBhIERPTSBlbGVtZW50LlxuICpcbiAqIEByZXR1cm5zIE9iamVjdCBjb250YWluaW5nIHRoZSBlbGVtZW50J3MgcG9zaXRpb24sIHdpZHRoLCBhbmQgaGVpZ2h0LlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2dldEVsZW1lbnRQb3NpdGlvbiA9IGZ1bmN0aW9uKGVsKSB7XG4gICAgdmFyIHBvcyA9IHtcbiAgICAgIGxlZnQ6IDAsXG4gICAgICB0b3A6IDAsXG4gICAgICB3aWR0aDogMCxcbiAgICAgIGhlaWdodDogMFxuICAgIH07XG4gICAgaWYgKGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCkge1xuICAgICAgdmFyIGVsUmVjdCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgdmFyIHBhZ2VYT2Zmc2V0ID0gX3dpbmRvdy5wYWdlWE9mZnNldDtcbiAgICAgIHZhciBwYWdlWU9mZnNldCA9IF93aW5kb3cucGFnZVlPZmZzZXQ7XG4gICAgICB2YXIgbGVmdEJvcmRlcldpZHRoID0gX2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRMZWZ0IHx8IDA7XG4gICAgICB2YXIgdG9wQm9yZGVyV2lkdGggPSBfZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFRvcCB8fCAwO1xuICAgICAgdmFyIGxlZnRCb2R5T2Zmc2V0ID0gMDtcbiAgICAgIHZhciB0b3BCb2R5T2Zmc2V0ID0gMDtcbiAgICAgIGlmIChfZ2V0U3R5bGUoX2RvY3VtZW50LmJvZHksIFwicG9zaXRpb25cIikgPT09IFwicmVsYXRpdmVcIikge1xuICAgICAgICB2YXIgYm9keVJlY3QgPSBfZG9jdW1lbnQuYm9keS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgdmFyIGh0bWxSZWN0ID0gX2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgbGVmdEJvZHlPZmZzZXQgPSBib2R5UmVjdC5sZWZ0IC0gaHRtbFJlY3QubGVmdCB8fCAwO1xuICAgICAgICB0b3BCb2R5T2Zmc2V0ID0gYm9keVJlY3QudG9wIC0gaHRtbFJlY3QudG9wIHx8IDA7XG4gICAgICB9XG4gICAgICBwb3MubGVmdCA9IGVsUmVjdC5sZWZ0ICsgcGFnZVhPZmZzZXQgLSBsZWZ0Qm9yZGVyV2lkdGggLSBsZWZ0Qm9keU9mZnNldDtcbiAgICAgIHBvcy50b3AgPSBlbFJlY3QudG9wICsgcGFnZVlPZmZzZXQgLSB0b3BCb3JkZXJXaWR0aCAtIHRvcEJvZHlPZmZzZXQ7XG4gICAgICBwb3Mud2lkdGggPSBcIndpZHRoXCIgaW4gZWxSZWN0ID8gZWxSZWN0LndpZHRoIDogZWxSZWN0LnJpZ2h0IC0gZWxSZWN0LmxlZnQ7XG4gICAgICBwb3MuaGVpZ2h0ID0gXCJoZWlnaHRcIiBpbiBlbFJlY3QgPyBlbFJlY3QuaGVpZ2h0IDogZWxSZWN0LmJvdHRvbSAtIGVsUmVjdC50b3A7XG4gICAgfVxuICAgIHJldHVybiBwb3M7XG4gIH07XG4gIC8qKlxuICogRGV0ZXJtaW5lIGlzIGFuIGVsZW1lbnQgaXMgdmlzaWJsZSBzb21ld2hlcmUgd2l0aGluIHRoZSBkb2N1bWVudCAocGFnZSkuXG4gKlxuICogQHJldHVybnMgQm9vbGVhblxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2lzRWxlbWVudFZpc2libGUgPSBmdW5jdGlvbihlbCkge1xuICAgIGlmICghZWwpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIHN0eWxlcyA9IF9nZXRDb21wdXRlZFN0eWxlKGVsLCBudWxsKTtcbiAgICBpZiAoIXN0eWxlcykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgaGFzQ3NzSGVpZ2h0ID0gX3BhcnNlRmxvYXQoc3R5bGVzLmhlaWdodCkgPiAwO1xuICAgIHZhciBoYXNDc3NXaWR0aCA9IF9wYXJzZUZsb2F0KHN0eWxlcy53aWR0aCkgPiAwO1xuICAgIHZhciBoYXNDc3NUb3AgPSBfcGFyc2VGbG9hdChzdHlsZXMudG9wKSA+PSAwO1xuICAgIHZhciBoYXNDc3NMZWZ0ID0gX3BhcnNlRmxvYXQoc3R5bGVzLmxlZnQpID49IDA7XG4gICAgdmFyIGNzc0tub3dzID0gaGFzQ3NzSGVpZ2h0ICYmIGhhc0Nzc1dpZHRoICYmIGhhc0Nzc1RvcCAmJiBoYXNDc3NMZWZ0O1xuICAgIHZhciByZWN0ID0gY3NzS25vd3MgPyBudWxsIDogX2dldEVsZW1lbnRQb3NpdGlvbihlbCk7XG4gICAgdmFyIGlzVmlzaWJsZSA9IHN0eWxlcy5kaXNwbGF5ICE9PSBcIm5vbmVcIiAmJiBzdHlsZXMudmlzaWJpbGl0eSAhPT0gXCJjb2xsYXBzZVwiICYmIChjc3NLbm93cyB8fCAhIXJlY3QgJiYgKGhhc0Nzc0hlaWdodCB8fCByZWN0LmhlaWdodCA+IDApICYmIChoYXNDc3NXaWR0aCB8fCByZWN0LndpZHRoID4gMCkgJiYgKGhhc0Nzc1RvcCB8fCByZWN0LnRvcCA+PSAwKSAmJiAoaGFzQ3NzTGVmdCB8fCByZWN0LmxlZnQgPj0gMCkpO1xuICAgIHJldHVybiBpc1Zpc2libGU7XG4gIH07XG4gIC8qKlxuICogQ2xlYXIgYWxsIGV4aXN0aW5nIHRpbWVvdXRzIGFuZCBpbnRlcnZhbCBwb2xsaW5nIGRlbGVnYXRlcy5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsZWFyVGltZW91dHNBbmRQb2xsaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgX2NsZWFyVGltZW91dChfZmxhc2hDaGVja1RpbWVvdXQpO1xuICAgIF9mbGFzaENoZWNrVGltZW91dCA9IDA7XG4gICAgX2NsZWFySW50ZXJ2YWwoX3N3ZkZhbGxiYWNrQ2hlY2tJbnRlcnZhbCk7XG4gICAgX3N3ZkZhbGxiYWNrQ2hlY2tJbnRlcnZhbCA9IDA7XG4gIH07XG4gIC8qKlxuICogUmVwb3NpdGlvbiB0aGUgRmxhc2ggb2JqZWN0IHRvIGNvdmVyIHRoZSBjdXJyZW50bHkgYWN0aXZhdGVkIGVsZW1lbnQuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9yZXBvc2l0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGh0bWxCcmlkZ2U7XG4gICAgaWYgKF9jdXJyZW50RWxlbWVudCAmJiAoaHRtbEJyaWRnZSA9IF9nZXRIdG1sQnJpZGdlKF9mbGFzaFN0YXRlLmJyaWRnZSkpKSB7XG4gICAgICB2YXIgcG9zID0gX2dldEVsZW1lbnRQb3NpdGlvbihfY3VycmVudEVsZW1lbnQpO1xuICAgICAgX2V4dGVuZChodG1sQnJpZGdlLnN0eWxlLCB7XG4gICAgICAgIHdpZHRoOiBwb3Mud2lkdGggKyBcInB4XCIsXG4gICAgICAgIGhlaWdodDogcG9zLmhlaWdodCArIFwicHhcIixcbiAgICAgICAgdG9wOiBwb3MudG9wICsgXCJweFwiLFxuICAgICAgICBsZWZ0OiBwb3MubGVmdCArIFwicHhcIixcbiAgICAgICAgekluZGV4OiBcIlwiICsgX2dldFNhZmVaSW5kZXgoX2dsb2JhbENvbmZpZy56SW5kZXgpXG4gICAgICB9KTtcbiAgICB9XG4gIH07XG4gIC8qKlxuICogU2VuZHMgYSBzaWduYWwgdG8gdGhlIEZsYXNoIG9iamVjdCB0byBkaXNwbGF5IHRoZSBoYW5kIGN1cnNvciBpZiBgdHJ1ZWAuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9zZXRIYW5kQ3Vyc29yID0gZnVuY3Rpb24oZW5hYmxlZCkge1xuICAgIGlmIChfZmxhc2hTdGF0ZS5yZWFkeSA9PT0gdHJ1ZSkge1xuICAgICAgaWYgKF9mbGFzaFN0YXRlLmJyaWRnZSAmJiB0eXBlb2YgX2ZsYXNoU3RhdGUuYnJpZGdlLnNldEhhbmRDdXJzb3IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBfZmxhc2hTdGF0ZS5icmlkZ2Uuc2V0SGFuZEN1cnNvcihlbmFibGVkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9mbGFzaFN0YXRlLnJlYWR5ID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9O1xuICAvKipcbiAqIEdldCBhIHNhZmUgdmFsdWUgZm9yIGB6SW5kZXhgXG4gKlxuICogQHJldHVybnMgYW4gaW50ZWdlciwgb3IgXCJhdXRvXCJcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9nZXRTYWZlWkluZGV4ID0gZnVuY3Rpb24odmFsKSB7XG4gICAgaWYgKC9eKD86YXV0b3xpbmhlcml0KSQvLnRlc3QodmFsKSkge1xuICAgICAgcmV0dXJuIHZhbDtcbiAgICB9XG4gICAgdmFyIHpJbmRleDtcbiAgICBpZiAodHlwZW9mIHZhbCA9PT0gXCJudW1iZXJcIiAmJiAhX2lzTmFOKHZhbCkpIHtcbiAgICAgIHpJbmRleCA9IHZhbDtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWwgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIHpJbmRleCA9IF9nZXRTYWZlWkluZGV4KF9wYXJzZUludCh2YWwsIDEwKSk7XG4gICAgfVxuICAgIHJldHVybiB0eXBlb2YgekluZGV4ID09PSBcIm51bWJlclwiID8gekluZGV4IDogXCJhdXRvXCI7XG4gIH07XG4gIC8qKlxuICogRW5zdXJlIE9TLWNvbXBsaWFudCBsaW5lIGVuZGluZ3MsIGkuZS4gXCJcXHJcXG5cIiBvbiBXaW5kb3dzLCBcIlxcblwiIGVsc2V3aGVyZVxuICpcbiAqIEByZXR1cm5zIHN0cmluZ1xuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2ZpeExpbmVFbmRpbmdzID0gZnVuY3Rpb24oY29udGVudCkge1xuICAgIHZhciByZXBsYWNlUmVnZXggPSAvKFxcclxcbnxcXHJ8XFxuKS9nO1xuICAgIGlmICh0eXBlb2YgY29udGVudCA9PT0gXCJzdHJpbmdcIiAmJiBfZ2xvYmFsQ29uZmlnLmZpeExpbmVFbmRpbmdzID09PSB0cnVlKSB7XG4gICAgICBpZiAoX2lzV2luZG93cygpKSB7XG4gICAgICAgIGlmICgvKChefFteXFxyXSlcXG58XFxyKFteXFxuXXwkKSkvLnRlc3QoY29udGVudCkpIHtcbiAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKHJlcGxhY2VSZWdleCwgXCJcXHJcXG5cIik7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoL1xcci8udGVzdChjb250ZW50KSkge1xuICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKHJlcGxhY2VSZWdleCwgXCJcXG5cIik7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjb250ZW50O1xuICB9O1xuICAvKipcbiAqIEF0dGVtcHQgdG8gZGV0ZWN0IGlmIFplcm9DbGlwYm9hcmQgaXMgZXhlY3V0aW5nIGluc2lkZSBvZiBhIHNhbmRib3hlZCBpZnJhbWUuXG4gKiBJZiBpdCBpcywgRmxhc2ggUGxheWVyIGNhbm5vdCBiZSB1c2VkLCBzbyBaZXJvQ2xpcGJvYXJkIGlzIGRlYWQgaW4gdGhlIHdhdGVyLlxuICpcbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly9saXN0cy53My5vcmcvQXJjaGl2ZXMvUHVibGljL3B1YmxpYy13aGF0d2ctYXJjaGl2ZS8yMDE0RGVjLzAwMDIuaHRtbH1cbiAqIEBzZWUge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS96ZXJvY2xpcGJvYXJkL3plcm9jbGlwYm9hcmQvaXNzdWVzLzUxMX1cbiAqIEBzZWUge0BsaW5rIGh0dHA6Ly96ZXJvY2xpcGJvYXJkLm9yZy90ZXN0LWlmcmFtZXMuaHRtbH1cbiAqXG4gKiBAcmV0dXJucyBgdHJ1ZWAgKGlzIHNhbmRib3hlZCksIGBmYWxzZWAgKGlzIG5vdCBzYW5kYm94ZWQpLCBvciBgbnVsbGAgKHVuY2VydGFpbilcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9kZXRlY3RTYW5kYm94ID0gZnVuY3Rpb24oZG9Ob3RSZWFzc2Vzc0ZsYXNoU3VwcG9ydCkge1xuICAgIHZhciBlZmZlY3RpdmVTY3JpcHRPcmlnaW4sIGZyYW1lLCBmcmFtZUVycm9yLCBwcmV2aW91c1N0YXRlID0gX2ZsYXNoU3RhdGUuc2FuZGJveGVkLCBpc1NhbmRib3hlZCA9IG51bGw7XG4gICAgZG9Ob3RSZWFzc2Vzc0ZsYXNoU3VwcG9ydCA9IGRvTm90UmVhc3Nlc3NGbGFzaFN1cHBvcnQgPT09IHRydWU7XG4gICAgaWYgKF9wYWdlSXNGcmFtZWQgPT09IGZhbHNlKSB7XG4gICAgICBpc1NhbmRib3hlZCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0cnkge1xuICAgICAgICBmcmFtZSA9IHdpbmRvdy5mcmFtZUVsZW1lbnQgfHwgbnVsbDtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgZnJhbWVFcnJvciA9IHtcbiAgICAgICAgICBuYW1lOiBlLm5hbWUsXG4gICAgICAgICAgbWVzc2FnZTogZS5tZXNzYWdlXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBpZiAoZnJhbWUgJiYgZnJhbWUubm9kZVR5cGUgPT09IDEgJiYgZnJhbWUubm9kZU5hbWUgPT09IFwiSUZSQU1FXCIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBpc1NhbmRib3hlZCA9IGZyYW1lLmhhc0F0dHJpYnV0ZShcInNhbmRib3hcIik7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBpc1NhbmRib3hlZCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgZWZmZWN0aXZlU2NyaXB0T3JpZ2luID0gZG9jdW1lbnQuZG9tYWluIHx8IG51bGw7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBlZmZlY3RpdmVTY3JpcHRPcmlnaW4gPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlZmZlY3RpdmVTY3JpcHRPcmlnaW4gPT09IG51bGwgfHwgZnJhbWVFcnJvciAmJiBmcmFtZUVycm9yLm5hbWUgPT09IFwiU2VjdXJpdHlFcnJvclwiICYmIC8oXnxbXFxzXFwoXFxbQF0pc2FuZGJveChlc3xlZHxpbmd8W1xcc1xcLiwhXFwpXFxdQF18JCkvLnRlc3QoZnJhbWVFcnJvci5tZXNzYWdlLnRvTG93ZXJDYXNlKCkpKSB7XG4gICAgICAgICAgaXNTYW5kYm94ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIF9mbGFzaFN0YXRlLnNhbmRib3hlZCA9IGlzU2FuZGJveGVkO1xuICAgIGlmIChwcmV2aW91c1N0YXRlICE9PSBpc1NhbmRib3hlZCAmJiAhZG9Ob3RSZWFzc2Vzc0ZsYXNoU3VwcG9ydCkge1xuICAgICAgX2RldGVjdEZsYXNoU3VwcG9ydChfQWN0aXZlWE9iamVjdCk7XG4gICAgfVxuICAgIHJldHVybiBpc1NhbmRib3hlZDtcbiAgfTtcbiAgLyoqXG4gKiBEZXRlY3QgdGhlIEZsYXNoIFBsYXllciBzdGF0dXMsIHZlcnNpb24sIGFuZCBwbHVnaW4gdHlwZS5cbiAqXG4gKiBAc2VlIHtAbGluayBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2RvY3R5cGUtbWlycm9yL3dpa2kvQXJ0aWNsZURldGVjdEZsYXNoI1RoZV9jb2RlfVxuICogQHNlZSB7QGxpbmsgaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMjg2NjA2MC9kZXRlY3RpbmctcGVwcGVyLXBwYXBpLWZsYXNoLXdpdGgtamF2YXNjcmlwdH1cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2RldGVjdEZsYXNoU3VwcG9ydCA9IGZ1bmN0aW9uKEFjdGl2ZVhPYmplY3QpIHtcbiAgICB2YXIgcGx1Z2luLCBheCwgbWltZVR5cGUsIGhhc0ZsYXNoID0gZmFsc2UsIGlzQWN0aXZlWCA9IGZhbHNlLCBpc1BQQVBJID0gZmFsc2UsIGZsYXNoVmVyc2lvbiA9IFwiXCI7XG4gICAgLyoqXG4gICAqIERlcml2ZWQgZnJvbSBBcHBsZSdzIHN1Z2dlc3RlZCBzbmlmZmVyLlxuICAgKiBAcGFyYW0ge1N0cmluZ30gZGVzYyBlLmcuIFwiU2hvY2t3YXZlIEZsYXNoIDcuMCByNjFcIlxuICAgKiBAcmV0dXJucyB7U3RyaW5nfSBcIjcuMC42MVwiXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICAgIGZ1bmN0aW9uIHBhcnNlRmxhc2hWZXJzaW9uKGRlc2MpIHtcbiAgICAgIHZhciBtYXRjaGVzID0gZGVzYy5tYXRjaCgvW1xcZF0rL2cpO1xuICAgICAgbWF0Y2hlcy5sZW5ndGggPSAzO1xuICAgICAgcmV0dXJuIG1hdGNoZXMuam9pbihcIi5cIik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGlzUGVwcGVyRmxhc2goZmxhc2hQbGF5ZXJGaWxlTmFtZSkge1xuICAgICAgcmV0dXJuICEhZmxhc2hQbGF5ZXJGaWxlTmFtZSAmJiAoZmxhc2hQbGF5ZXJGaWxlTmFtZSA9IGZsYXNoUGxheWVyRmlsZU5hbWUudG9Mb3dlckNhc2UoKSkgJiYgKC9eKHBlcGZsYXNocGxheWVyXFwuZGxsfGxpYnBlcGZsYXNocGxheWVyXFwuc298cGVwcGVyZmxhc2hwbGF5ZXJcXC5wbHVnaW4pJC8udGVzdChmbGFzaFBsYXllckZpbGVOYW1lKSB8fCBmbGFzaFBsYXllckZpbGVOYW1lLnNsaWNlKC0xMykgPT09IFwiY2hyb21lLnBsdWdpblwiKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaW5zcGVjdFBsdWdpbihwbHVnaW4pIHtcbiAgICAgIGlmIChwbHVnaW4pIHtcbiAgICAgICAgaGFzRmxhc2ggPSB0cnVlO1xuICAgICAgICBpZiAocGx1Z2luLnZlcnNpb24pIHtcbiAgICAgICAgICBmbGFzaFZlcnNpb24gPSBwYXJzZUZsYXNoVmVyc2lvbihwbHVnaW4udmVyc2lvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFmbGFzaFZlcnNpb24gJiYgcGx1Z2luLmRlc2NyaXB0aW9uKSB7XG4gICAgICAgICAgZmxhc2hWZXJzaW9uID0gcGFyc2VGbGFzaFZlcnNpb24ocGx1Z2luLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGx1Z2luLmZpbGVuYW1lKSB7XG4gICAgICAgICAgaXNQUEFQSSA9IGlzUGVwcGVyRmxhc2gocGx1Z2luLmZpbGVuYW1lKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoX25hdmlnYXRvci5wbHVnaW5zICYmIF9uYXZpZ2F0b3IucGx1Z2lucy5sZW5ndGgpIHtcbiAgICAgIHBsdWdpbiA9IF9uYXZpZ2F0b3IucGx1Z2luc1tcIlNob2Nrd2F2ZSBGbGFzaFwiXTtcbiAgICAgIGluc3BlY3RQbHVnaW4ocGx1Z2luKTtcbiAgICAgIGlmIChfbmF2aWdhdG9yLnBsdWdpbnNbXCJTaG9ja3dhdmUgRmxhc2ggMi4wXCJdKSB7XG4gICAgICAgIGhhc0ZsYXNoID0gdHJ1ZTtcbiAgICAgICAgZmxhc2hWZXJzaW9uID0gXCIyLjAuMC4xMVwiO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoX25hdmlnYXRvci5taW1lVHlwZXMgJiYgX25hdmlnYXRvci5taW1lVHlwZXMubGVuZ3RoKSB7XG4gICAgICBtaW1lVHlwZSA9IF9uYXZpZ2F0b3IubWltZVR5cGVzW1wiYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2hcIl07XG4gICAgICBwbHVnaW4gPSBtaW1lVHlwZSAmJiBtaW1lVHlwZS5lbmFibGVkUGx1Z2luO1xuICAgICAgaW5zcGVjdFBsdWdpbihwbHVnaW4pO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIEFjdGl2ZVhPYmplY3QgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGlzQWN0aXZlWCA9IHRydWU7XG4gICAgICB0cnkge1xuICAgICAgICBheCA9IG5ldyBBY3RpdmVYT2JqZWN0KFwiU2hvY2t3YXZlRmxhc2guU2hvY2t3YXZlRmxhc2guN1wiKTtcbiAgICAgICAgaGFzRmxhc2ggPSB0cnVlO1xuICAgICAgICBmbGFzaFZlcnNpb24gPSBwYXJzZUZsYXNoVmVyc2lvbihheC5HZXRWYXJpYWJsZShcIiR2ZXJzaW9uXCIpKTtcbiAgICAgIH0gY2F0Y2ggKGUxKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXggPSBuZXcgQWN0aXZlWE9iamVjdChcIlNob2Nrd2F2ZUZsYXNoLlNob2Nrd2F2ZUZsYXNoLjZcIik7XG4gICAgICAgICAgaGFzRmxhc2ggPSB0cnVlO1xuICAgICAgICAgIGZsYXNoVmVyc2lvbiA9IFwiNi4wLjIxXCI7XG4gICAgICAgIH0gY2F0Y2ggKGUyKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF4ID0gbmV3IEFjdGl2ZVhPYmplY3QoXCJTaG9ja3dhdmVGbGFzaC5TaG9ja3dhdmVGbGFzaFwiKTtcbiAgICAgICAgICAgIGhhc0ZsYXNoID0gdHJ1ZTtcbiAgICAgICAgICAgIGZsYXNoVmVyc2lvbiA9IHBhcnNlRmxhc2hWZXJzaW9uKGF4LkdldFZhcmlhYmxlKFwiJHZlcnNpb25cIikpO1xuICAgICAgICAgIH0gY2F0Y2ggKGUzKSB7XG4gICAgICAgICAgICBpc0FjdGl2ZVggPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgX2ZsYXNoU3RhdGUuZGlzYWJsZWQgPSBoYXNGbGFzaCAhPT0gdHJ1ZTtcbiAgICBfZmxhc2hTdGF0ZS5vdXRkYXRlZCA9IGZsYXNoVmVyc2lvbiAmJiBfcGFyc2VGbG9hdChmbGFzaFZlcnNpb24pIDwgX3BhcnNlRmxvYXQoX21pbmltdW1GbGFzaFZlcnNpb24pO1xuICAgIF9mbGFzaFN0YXRlLnZlcnNpb24gPSBmbGFzaFZlcnNpb24gfHwgXCIwLjAuMFwiO1xuICAgIF9mbGFzaFN0YXRlLnBsdWdpblR5cGUgPSBpc1BQQVBJID8gXCJwZXBwZXJcIiA6IGlzQWN0aXZlWCA/IFwiYWN0aXZleFwiIDogaGFzRmxhc2ggPyBcIm5ldHNjYXBlXCIgOiBcInVua25vd25cIjtcbiAgfTtcbiAgLyoqXG4gKiBJbnZva2UgdGhlIEZsYXNoIGRldGVjdGlvbiBhbGdvcml0aG1zIGltbWVkaWF0ZWx5IHVwb24gaW5jbHVzaW9uIHNvIHdlJ3JlIG5vdCB3YWl0aW5nIGxhdGVyLlxuICovXG4gIF9kZXRlY3RGbGFzaFN1cHBvcnQoX0FjdGl2ZVhPYmplY3QpO1xuICAvKipcbiAqIEFsd2F5cyBhc3Nlc3MgdGhlIGBzYW5kYm94ZWRgIHN0YXRlIG9mIHRoZSBwYWdlIGF0IGltcG9ydGFudCBGbGFzaC1yZWxhdGVkIG1vbWVudHMuXG4gKi9cbiAgX2RldGVjdFNhbmRib3godHJ1ZSk7XG4gIC8qKlxuICogQSBzaGVsbCBjb25zdHJ1Y3RvciBmb3IgYFplcm9DbGlwYm9hcmRgIGNsaWVudCBpbnN0YW5jZXMuXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbiAgdmFyIFplcm9DbGlwYm9hcmQgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgWmVyb0NsaXBib2FyZCkpIHtcbiAgICAgIHJldHVybiBuZXcgWmVyb0NsaXBib2FyZCgpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIFplcm9DbGlwYm9hcmQuX2NyZWF0ZUNsaWVudCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBaZXJvQ2xpcGJvYXJkLl9jcmVhdGVDbGllbnQuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gICAgfVxuICB9O1xuICAvKipcbiAqIFRoZSBaZXJvQ2xpcGJvYXJkIGxpYnJhcnkncyB2ZXJzaW9uIG51bWJlci5cbiAqXG4gKiBAc3RhdGljXG4gKiBAcmVhZG9ubHlcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfVxuICovXG4gIFplcm9DbGlwYm9hcmQudmVyc2lvbiA9IFwiMi4zLjBcIjtcbiAgLyoqXG4gKiBVcGRhdGUgb3IgZ2V0IGEgY29weSBvZiB0aGUgWmVyb0NsaXBib2FyZCBnbG9iYWwgY29uZmlndXJhdGlvbi5cbiAqIFJldHVybnMgYSBjb3B5IG9mIHRoZSBjdXJyZW50L3VwZGF0ZWQgY29uZmlndXJhdGlvbi5cbiAqXG4gKiBAcmV0dXJucyBPYmplY3RcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmNvbmZpZyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY29uZmlnLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIERpYWdub3N0aWMgbWV0aG9kIHRoYXQgZGVzY3JpYmVzIHRoZSBzdGF0ZSBvZiB0aGUgYnJvd3NlciwgRmxhc2ggUGxheWVyLCBhbmQgWmVyb0NsaXBib2FyZC5cbiAqXG4gKiBAcmV0dXJucyBPYmplY3RcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnN0YXRlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9zdGF0ZS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBDaGVjayBpZiBGbGFzaCBpcyB1bnVzYWJsZSBmb3IgYW55IHJlYXNvbjogZGlzYWJsZWQsIG91dGRhdGVkLCBkZWFjdGl2YXRlZCwgZXRjLlxuICpcbiAqIEByZXR1cm5zIEJvb2xlYW5cbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmlzRmxhc2hVbnVzYWJsZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfaXNGbGFzaFVudXNhYmxlLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFJlZ2lzdGVyIGFuIGV2ZW50IGxpc3RlbmVyLlxuICpcbiAqIEByZXR1cm5zIGBaZXJvQ2xpcGJvYXJkYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQub24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX29uLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFVucmVnaXN0ZXIgYW4gZXZlbnQgbGlzdGVuZXIuXG4gKiBJZiBubyBgbGlzdGVuZXJgIGZ1bmN0aW9uL29iamVjdCBpcyBwcm92aWRlZCwgaXQgd2lsbCB1bnJlZ2lzdGVyIGFsbCBsaXN0ZW5lcnMgZm9yIHRoZSBwcm92aWRlZCBgZXZlbnRUeXBlYC5cbiAqIElmIG5vIGBldmVudFR5cGVgIGlzIHByb3ZpZGVkLCBpdCB3aWxsIHVucmVnaXN0ZXIgYWxsIGxpc3RlbmVycyBmb3IgZXZlcnkgZXZlbnQgdHlwZS5cbiAqXG4gKiBAcmV0dXJucyBgWmVyb0NsaXBib2FyZGBcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLm9mZiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfb2ZmLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFJldHJpZXZlIGV2ZW50IGxpc3RlbmVycyBmb3IgYW4gYGV2ZW50VHlwZWAuXG4gKiBJZiBubyBgZXZlbnRUeXBlYCBpcyBwcm92aWRlZCwgaXQgd2lsbCByZXRyaWV2ZSBhbGwgbGlzdGVuZXJzIGZvciBldmVyeSBldmVudCB0eXBlLlxuICpcbiAqIEByZXR1cm5zIGFycmF5IG9mIGxpc3RlbmVycyBmb3IgdGhlIGBldmVudFR5cGVgOyBpZiBubyBgZXZlbnRUeXBlYCwgdGhlbiBhIG1hcC9oYXNoIG9iamVjdCBvZiBsaXN0ZW5lcnMgZm9yIGFsbCBldmVudCB0eXBlczsgb3IgYG51bGxgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5oYW5kbGVycyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfbGlzdGVuZXJzLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIEV2ZW50IGVtaXNzaW9uIHJlY2VpdmVyIGZyb20gdGhlIEZsYXNoIG9iamVjdCwgZm9yd2FyZGluZyB0byBhbnkgcmVnaXN0ZXJlZCBKYXZhU2NyaXB0IGV2ZW50IGxpc3RlbmVycy5cbiAqXG4gKiBAcmV0dXJucyBGb3IgdGhlIFwiY29weVwiIGV2ZW50LCByZXR1cm5zIHRoZSBGbGFzaC1mcmllbmRseSBcImNsaXBEYXRhXCIgb2JqZWN0OyBvdGhlcndpc2UgYHVuZGVmaW5lZGAuXG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5lbWl0ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9lbWl0LmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIENyZWF0ZSBhbmQgZW1iZWQgdGhlIEZsYXNoIG9iamVjdC5cbiAqXG4gKiBAcmV0dXJucyBUaGUgRmxhc2ggb2JqZWN0XG4gKiBAc3RhdGljXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5jcmVhdGUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NyZWF0ZS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBTZWxmLWRlc3RydWN0IGFuZCBjbGVhbiB1cCBldmVyeXRoaW5nLCBpbmNsdWRpbmcgdGhlIGVtYmVkZGVkIEZsYXNoIG9iamVjdC5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfZGVzdHJveS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBTZXQgdGhlIHBlbmRpbmcgZGF0YSBmb3IgY2xpcGJvYXJkIGluamVjdGlvbi5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuc2V0RGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfc2V0RGF0YS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBDbGVhciB0aGUgcGVuZGluZyBkYXRhIGZvciBjbGlwYm9hcmQgaW5qZWN0aW9uLlxuICogSWYgbm8gYGZvcm1hdGAgaXMgcHJvdmlkZWQsIGFsbCBwZW5kaW5nIGRhdGEgZm9ybWF0cyB3aWxsIGJlIGNsZWFyZWQuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmNsZWFyRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY2xlYXJEYXRhLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIEdldCBhIGNvcHkgb2YgdGhlIHBlbmRpbmcgZGF0YSBmb3IgY2xpcGJvYXJkIGluamVjdGlvbi5cbiAqIElmIG5vIGBmb3JtYXRgIGlzIHByb3ZpZGVkLCBhIGNvcHkgb2YgQUxMIHBlbmRpbmcgZGF0YSBmb3JtYXRzIHdpbGwgYmUgcmV0dXJuZWQuXG4gKlxuICogQHJldHVybnMgYFN0cmluZ2Agb3IgYE9iamVjdGBcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmdldERhdGEgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2dldERhdGEuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogU2V0cyB0aGUgY3VycmVudCBIVE1MIG9iamVjdCB0aGF0IHRoZSBGbGFzaCBvYmplY3Qgc2hvdWxkIG92ZXJsYXkuIFRoaXMgd2lsbCBwdXQgdGhlIGdsb2JhbFxuICogRmxhc2ggb2JqZWN0IG9uIHRvcCBvZiB0aGUgY3VycmVudCBlbGVtZW50OyBkZXBlbmRpbmcgb24gdGhlIHNldHVwLCB0aGlzIG1heSBhbHNvIHNldCB0aGVcbiAqIHBlbmRpbmcgY2xpcGJvYXJkIHRleHQgZGF0YSBhcyB3ZWxsIGFzIHRoZSBGbGFzaCBvYmplY3QncyB3cmFwcGluZyBlbGVtZW50J3MgdGl0bGUgYXR0cmlidXRlXG4gKiBiYXNlZCBvbiB0aGUgdW5kZXJseWluZyBIVE1MIGVsZW1lbnQgYW5kIFplcm9DbGlwYm9hcmQgY29uZmlndXJhdGlvbi5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuZm9jdXMgPSBaZXJvQ2xpcGJvYXJkLmFjdGl2YXRlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9mb2N1cy5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBVbi1vdmVybGF5cyB0aGUgRmxhc2ggb2JqZWN0LiBUaGlzIHdpbGwgcHV0IHRoZSBnbG9iYWwgRmxhc2ggb2JqZWN0IG9mZi1zY3JlZW47IGRlcGVuZGluZyBvblxuICogdGhlIHNldHVwLCB0aGlzIG1heSBhbHNvIHVuc2V0IHRoZSBGbGFzaCBvYmplY3QncyB3cmFwcGluZyBlbGVtZW50J3MgdGl0bGUgYXR0cmlidXRlIGJhc2VkIG9uXG4gKiB0aGUgdW5kZXJseWluZyBIVE1MIGVsZW1lbnQgYW5kIFplcm9DbGlwYm9hcmQgY29uZmlndXJhdGlvbi5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHN0YXRpY1xuICovXG4gIFplcm9DbGlwYm9hcmQuYmx1ciA9IFplcm9DbGlwYm9hcmQuZGVhY3RpdmF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfYmx1ci5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBSZXR1cm5zIHRoZSBjdXJyZW50bHkgZm9jdXNlZC9cImFjdGl2YXRlZFwiIEhUTUwgZWxlbWVudCB0aGF0IHRoZSBGbGFzaCBvYmplY3QgaXMgd3JhcHBpbmcuXG4gKlxuICogQHJldHVybnMgYEhUTUxFbGVtZW50YCBvciBgbnVsbGBcbiAqIEBzdGF0aWNcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLmFjdGl2ZUVsZW1lbnQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2FjdGl2ZUVsZW1lbnQuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgWmVyb0NsaXBib2FyZCBjbGllbnQgaW5zdGFuY2UgY291bnRlci5cbiAqL1xuICB2YXIgX2NsaWVudElkQ291bnRlciA9IDA7XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgc3RhdGUgb2YgdGhlIGNsaWVudCBpbnN0YW5jZXMuXG4gKlxuICogRW50cnkgc3RydWN0dXJlOlxuICogICBfY2xpZW50TWV0YVtjbGllbnQuaWRdID0ge1xuICogICAgIGluc3RhbmNlOiBjbGllbnQsXG4gKiAgICAgZWxlbWVudHM6IFtdLFxuICogICAgIGhhbmRsZXJzOiB7fSxcbiAqICAgICBjb3JlV2lsZGNhcmRIYW5kbGVyOiBmdW5jdGlvbihldmVudCkgeyByZXR1cm4gY2xpZW50LmVtaXQoZXZlbnQpOyB9XG4gKiAgIH07XG4gKi9cbiAgdmFyIF9jbGllbnRNZXRhID0ge307XG4gIC8qKlxuICogS2VlcCB0cmFjayBvZiB0aGUgWmVyb0NsaXBib2FyZCBjbGlwcGVkIGVsZW1lbnRzIGNvdW50ZXIuXG4gKi9cbiAgdmFyIF9lbGVtZW50SWRDb3VudGVyID0gMDtcbiAgLyoqXG4gKiBLZWVwIHRyYWNrIG9mIHRoZSBzdGF0ZSBvZiB0aGUgY2xpcHBlZCBlbGVtZW50IHJlbGF0aW9uc2hpcHMgdG8gY2xpZW50cy5cbiAqXG4gKiBFbnRyeSBzdHJ1Y3R1cmU6XG4gKiAgIF9lbGVtZW50TWV0YVtlbGVtZW50LnpjQ2xpcHBpbmdJZF0gPSBbY2xpZW50MS5pZCwgY2xpZW50Mi5pZF07XG4gKi9cbiAgdmFyIF9lbGVtZW50TWV0YSA9IHt9O1xuICAvKipcbiAqIEtlZXAgdHJhY2sgb2YgdGhlIHN0YXRlIG9mIHRoZSBtb3VzZSBldmVudCBoYW5kbGVycyBmb3IgY2xpcHBlZCBlbGVtZW50cy5cbiAqXG4gKiBFbnRyeSBzdHJ1Y3R1cmU6XG4gKiAgIF9tb3VzZUhhbmRsZXJzW2VsZW1lbnQuemNDbGlwcGluZ0lkXSA9IHtcbiAqICAgICBtb3VzZW92ZXI6ICBmdW5jdGlvbihldmVudCkge30sXG4gKiAgICAgbW91c2VvdXQ6ICAgZnVuY3Rpb24oZXZlbnQpIHt9LFxuICogICAgIG1vdXNlZW50ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7fSxcbiAqICAgICBtb3VzZWxlYXZlOiBmdW5jdGlvbihldmVudCkge30sXG4gKiAgICAgbW91c2Vtb3ZlOiAgZnVuY3Rpb24oZXZlbnQpIHt9XG4gKiAgIH07XG4gKi9cbiAgdmFyIF9tb3VzZUhhbmRsZXJzID0ge307XG4gIC8qKlxuICogRXh0ZW5kaW5nIHRoZSBaZXJvQ2xpcGJvYXJkIGNvbmZpZ3VyYXRpb24gZGVmYXVsdHMgZm9yIHRoZSBDbGllbnQgbW9kdWxlLlxuICovXG4gIF9leHRlbmQoX2dsb2JhbENvbmZpZywge1xuICAgIGF1dG9BY3RpdmF0ZTogdHJ1ZVxuICB9KTtcbiAgLyoqXG4gKiBUaGUgcmVhbCBjb25zdHJ1Y3RvciBmb3IgYFplcm9DbGlwYm9hcmRgIGNsaWVudCBpbnN0YW5jZXMuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50Q29uc3RydWN0b3IgPSBmdW5jdGlvbihlbGVtZW50cykge1xuICAgIHZhciBtZXRhLCBjbGllbnQgPSB0aGlzO1xuICAgIGNsaWVudC5pZCA9IFwiXCIgKyBfY2xpZW50SWRDb3VudGVyKys7XG4gICAgbWV0YSA9IHtcbiAgICAgIGluc3RhbmNlOiBjbGllbnQsXG4gICAgICBlbGVtZW50czogW10sXG4gICAgICBoYW5kbGVyczoge30sXG4gICAgICBjb3JlV2lsZGNhcmRIYW5kbGVyOiBmdW5jdGlvbihldmVudCkge1xuICAgICAgICByZXR1cm4gY2xpZW50LmVtaXQoZXZlbnQpO1xuICAgICAgfVxuICAgIH07XG4gICAgX2NsaWVudE1ldGFbY2xpZW50LmlkXSA9IG1ldGE7XG4gICAgaWYgKGVsZW1lbnRzKSB7XG4gICAgICBjbGllbnQuY2xpcChlbGVtZW50cyk7XG4gICAgfVxuICAgIFplcm9DbGlwYm9hcmQub24oXCIqXCIsIG1ldGEuY29yZVdpbGRjYXJkSGFuZGxlcik7XG4gICAgWmVyb0NsaXBib2FyZC5vbihcImRlc3Ryb3lcIiwgZnVuY3Rpb24oKSB7XG4gICAgICBjbGllbnQuZGVzdHJveSgpO1xuICAgIH0pO1xuICAgIFplcm9DbGlwYm9hcmQuY3JlYXRlKCk7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuQ2xpZW50LnByb3RvdHlwZS5vbmAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50T24gPSBmdW5jdGlvbihldmVudFR5cGUsIGxpc3RlbmVyKSB7XG4gICAgdmFyIGksIGxlbiwgZXZlbnRzLCBhZGRlZCA9IHt9LCBjbGllbnQgPSB0aGlzLCBtZXRhID0gX2NsaWVudE1ldGFbY2xpZW50LmlkXSwgaGFuZGxlcnMgPSBtZXRhICYmIG1ldGEuaGFuZGxlcnM7XG4gICAgaWYgKCFtZXRhKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gYWRkIG5ldyBsaXN0ZW5lcihzKSB0byBhIGRlc3Ryb3llZCBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZVwiKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnRUeXBlKSB7XG4gICAgICBldmVudHMgPSBldmVudFR5cGUudG9Mb3dlckNhc2UoKS5zcGxpdCgvXFxzKy8pO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJvYmplY3RcIiAmJiBldmVudFR5cGUgJiYgIShcImxlbmd0aFwiIGluIGV2ZW50VHlwZSkgJiYgdHlwZW9mIGxpc3RlbmVyID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBfa2V5cyhldmVudFR5cGUpLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgIHZhciBsaXN0ZW5lciA9IGV2ZW50VHlwZVtrZXldO1xuICAgICAgICBpZiAodHlwZW9mIGxpc3RlbmVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBjbGllbnQub24oa2V5LCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoZXZlbnRzICYmIGV2ZW50cy5sZW5ndGggJiYgbGlzdGVuZXIpIHtcbiAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGV2ZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBldmVudFR5cGUgPSBldmVudHNbaV0ucmVwbGFjZSgvXm9uLywgXCJcIik7XG4gICAgICAgIGFkZGVkW2V2ZW50VHlwZV0gPSB0cnVlO1xuICAgICAgICBpZiAoIWhhbmRsZXJzW2V2ZW50VHlwZV0pIHtcbiAgICAgICAgICBoYW5kbGVyc1tldmVudFR5cGVdID0gW107XG4gICAgICAgIH1cbiAgICAgICAgaGFuZGxlcnNbZXZlbnRUeXBlXS5wdXNoKGxpc3RlbmVyKTtcbiAgICAgIH1cbiAgICAgIGlmIChhZGRlZC5yZWFkeSAmJiBfZmxhc2hTdGF0ZS5yZWFkeSkge1xuICAgICAgICB0aGlzLmVtaXQoe1xuICAgICAgICAgIHR5cGU6IFwicmVhZHlcIixcbiAgICAgICAgICBjbGllbnQ6IHRoaXNcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoYWRkZWQuZXJyb3IpIHtcbiAgICAgICAgZm9yIChpID0gMCwgbGVuID0gX2ZsYXNoU3RhdGVFcnJvck5hbWVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgaWYgKF9mbGFzaFN0YXRlW19mbGFzaFN0YXRlRXJyb3JOYW1lc1tpXS5yZXBsYWNlKC9eZmxhc2gtLywgXCJcIildKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXQoe1xuICAgICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICAgIG5hbWU6IF9mbGFzaFN0YXRlRXJyb3JOYW1lc1tpXSxcbiAgICAgICAgICAgICAgY2xpZW50OiB0aGlzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoX3pjU3dmVmVyc2lvbiAhPT0gdW5kZWZpbmVkICYmIFplcm9DbGlwYm9hcmQudmVyc2lvbiAhPT0gX3pjU3dmVmVyc2lvbikge1xuICAgICAgICAgIHRoaXMuZW1pdCh7XG4gICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICBuYW1lOiBcInZlcnNpb24tbWlzbWF0Y2hcIixcbiAgICAgICAgICAgIGpzVmVyc2lvbjogWmVyb0NsaXBib2FyZC52ZXJzaW9uLFxuICAgICAgICAgICAgc3dmVmVyc2lvbjogX3pjU3dmVmVyc2lvblxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjbGllbnQ7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuQ2xpZW50LnByb3RvdHlwZS5vZmZgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudE9mZiA9IGZ1bmN0aW9uKGV2ZW50VHlwZSwgbGlzdGVuZXIpIHtcbiAgICB2YXIgaSwgbGVuLCBmb3VuZEluZGV4LCBldmVudHMsIHBlckV2ZW50SGFuZGxlcnMsIGNsaWVudCA9IHRoaXMsIG1ldGEgPSBfY2xpZW50TWV0YVtjbGllbnQuaWRdLCBoYW5kbGVycyA9IG1ldGEgJiYgbWV0YS5oYW5kbGVycztcbiAgICBpZiAoIWhhbmRsZXJzKSB7XG4gICAgICByZXR1cm4gY2xpZW50O1xuICAgIH1cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgZXZlbnRzID0gX2tleXMoaGFuZGxlcnMpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudFR5cGUpIHtcbiAgICAgIGV2ZW50cyA9IGV2ZW50VHlwZS5zcGxpdCgvXFxzKy8pO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGV2ZW50VHlwZSA9PT0gXCJvYmplY3RcIiAmJiBldmVudFR5cGUgJiYgIShcImxlbmd0aFwiIGluIGV2ZW50VHlwZSkgJiYgdHlwZW9mIGxpc3RlbmVyID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBfa2V5cyhldmVudFR5cGUpLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgIHZhciBsaXN0ZW5lciA9IGV2ZW50VHlwZVtrZXldO1xuICAgICAgICBpZiAodHlwZW9mIGxpc3RlbmVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICBjbGllbnQub2ZmKGtleSwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGV2ZW50cyAmJiBldmVudHMubGVuZ3RoKSB7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBldmVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZXZlbnRUeXBlID0gZXZlbnRzW2ldLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXm9uLywgXCJcIik7XG4gICAgICAgIHBlckV2ZW50SGFuZGxlcnMgPSBoYW5kbGVyc1tldmVudFR5cGVdO1xuICAgICAgICBpZiAocGVyRXZlbnRIYW5kbGVycyAmJiBwZXJFdmVudEhhbmRsZXJzLmxlbmd0aCkge1xuICAgICAgICAgIGlmIChsaXN0ZW5lcikge1xuICAgICAgICAgICAgZm91bmRJbmRleCA9IHBlckV2ZW50SGFuZGxlcnMuaW5kZXhPZihsaXN0ZW5lcik7XG4gICAgICAgICAgICB3aGlsZSAoZm91bmRJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgcGVyRXZlbnRIYW5kbGVycy5zcGxpY2UoZm91bmRJbmRleCwgMSk7XG4gICAgICAgICAgICAgIGZvdW5kSW5kZXggPSBwZXJFdmVudEhhbmRsZXJzLmluZGV4T2YobGlzdGVuZXIsIGZvdW5kSW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwZXJFdmVudEhhbmRsZXJzLmxlbmd0aCA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjbGllbnQ7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuQ2xpZW50LnByb3RvdHlwZS5oYW5kbGVyc2AuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50TGlzdGVuZXJzID0gZnVuY3Rpb24oZXZlbnRUeXBlKSB7XG4gICAgdmFyIGNvcHkgPSBudWxsLCBoYW5kbGVycyA9IF9jbGllbnRNZXRhW3RoaXMuaWRdICYmIF9jbGllbnRNZXRhW3RoaXMuaWRdLmhhbmRsZXJzO1xuICAgIGlmIChoYW5kbGVycykge1xuICAgICAgaWYgKHR5cGVvZiBldmVudFR5cGUgPT09IFwic3RyaW5nXCIgJiYgZXZlbnRUeXBlKSB7XG4gICAgICAgIGNvcHkgPSBoYW5kbGVyc1tldmVudFR5cGVdID8gaGFuZGxlcnNbZXZlbnRUeXBlXS5zbGljZSgwKSA6IFtdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29weSA9IF9kZWVwQ29weShoYW5kbGVycyk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjb3B5O1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLkNsaWVudC5wcm90b3R5cGUuZW1pdGAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50RW1pdCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgdmFyIGV2ZW50Q29weSwgY2xpZW50ID0gdGhpcztcbiAgICBpZiAoX2NsaWVudFNob3VsZEVtaXQuY2FsbChjbGllbnQsIGV2ZW50KSkge1xuICAgICAgaWYgKHR5cGVvZiBldmVudCA9PT0gXCJvYmplY3RcIiAmJiBldmVudCAmJiB0eXBlb2YgZXZlbnQudHlwZSA9PT0gXCJzdHJpbmdcIiAmJiBldmVudC50eXBlKSB7XG4gICAgICAgIGV2ZW50ID0gX2V4dGVuZCh7fSwgZXZlbnQpO1xuICAgICAgfVxuICAgICAgZXZlbnRDb3B5ID0gX2V4dGVuZCh7fSwgX2NyZWF0ZUV2ZW50KGV2ZW50KSwge1xuICAgICAgICBjbGllbnQ6IGNsaWVudFxuICAgICAgfSk7XG4gICAgICBfY2xpZW50RGlzcGF0Y2hDYWxsYmFja3MuY2FsbChjbGllbnQsIGV2ZW50Q29weSk7XG4gICAgfVxuICAgIHJldHVybiBjbGllbnQ7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuQ2xpZW50LnByb3RvdHlwZS5jbGlwYC5cbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9jbGllbnRDbGlwID0gZnVuY3Rpb24oZWxlbWVudHMpIHtcbiAgICBpZiAoIV9jbGllbnRNZXRhW3RoaXMuaWRdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gY2xpcCBlbGVtZW50KHMpIHRvIGEgZGVzdHJveWVkIFplcm9DbGlwYm9hcmQgY2xpZW50IGluc3RhbmNlXCIpO1xuICAgIH1cbiAgICBlbGVtZW50cyA9IF9wcmVwQ2xpcChlbGVtZW50cyk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKF9oYXNPd24uY2FsbChlbGVtZW50cywgaSkgJiYgZWxlbWVudHNbaV0gJiYgZWxlbWVudHNbaV0ubm9kZVR5cGUgPT09IDEpIHtcbiAgICAgICAgaWYgKCFlbGVtZW50c1tpXS56Y0NsaXBwaW5nSWQpIHtcbiAgICAgICAgICBlbGVtZW50c1tpXS56Y0NsaXBwaW5nSWQgPSBcInpjQ2xpcHBpbmdJZF9cIiArIF9lbGVtZW50SWRDb3VudGVyKys7XG4gICAgICAgICAgX2VsZW1lbnRNZXRhW2VsZW1lbnRzW2ldLnpjQ2xpcHBpbmdJZF0gPSBbIHRoaXMuaWQgXTtcbiAgICAgICAgICBpZiAoX2dsb2JhbENvbmZpZy5hdXRvQWN0aXZhdGUgPT09IHRydWUpIHtcbiAgICAgICAgICAgIF9hZGRNb3VzZUhhbmRsZXJzKGVsZW1lbnRzW2ldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoX2VsZW1lbnRNZXRhW2VsZW1lbnRzW2ldLnpjQ2xpcHBpbmdJZF0uaW5kZXhPZih0aGlzLmlkKSA9PT0gLTEpIHtcbiAgICAgICAgICBfZWxlbWVudE1ldGFbZWxlbWVudHNbaV0uemNDbGlwcGluZ0lkXS5wdXNoKHRoaXMuaWQpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjbGlwcGVkRWxlbWVudHMgPSBfY2xpZW50TWV0YVt0aGlzLmlkXSAmJiBfY2xpZW50TWV0YVt0aGlzLmlkXS5lbGVtZW50cztcbiAgICAgICAgaWYgKGNsaXBwZWRFbGVtZW50cy5pbmRleE9mKGVsZW1lbnRzW2ldKSA9PT0gLTEpIHtcbiAgICAgICAgICBjbGlwcGVkRWxlbWVudHMucHVzaChlbGVtZW50c1tpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIC8qKlxuICogVGhlIHVuZGVybHlpbmcgaW1wbGVtZW50YXRpb24gb2YgYFplcm9DbGlwYm9hcmQuQ2xpZW50LnByb3RvdHlwZS51bmNsaXBgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudFVuY2xpcCA9IGZ1bmN0aW9uKGVsZW1lbnRzKSB7XG4gICAgdmFyIG1ldGEgPSBfY2xpZW50TWV0YVt0aGlzLmlkXTtcbiAgICBpZiAoIW1ldGEpIHtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB2YXIgY2xpcHBlZEVsZW1lbnRzID0gbWV0YS5lbGVtZW50cztcbiAgICB2YXIgYXJyYXlJbmRleDtcbiAgICBpZiAodHlwZW9mIGVsZW1lbnRzID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBlbGVtZW50cyA9IGNsaXBwZWRFbGVtZW50cy5zbGljZSgwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZWxlbWVudHMgPSBfcHJlcENsaXAoZWxlbWVudHMpO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gZWxlbWVudHMubGVuZ3RoOyBpLS07ICkge1xuICAgICAgaWYgKF9oYXNPd24uY2FsbChlbGVtZW50cywgaSkgJiYgZWxlbWVudHNbaV0gJiYgZWxlbWVudHNbaV0ubm9kZVR5cGUgPT09IDEpIHtcbiAgICAgICAgYXJyYXlJbmRleCA9IDA7XG4gICAgICAgIHdoaWxlICgoYXJyYXlJbmRleCA9IGNsaXBwZWRFbGVtZW50cy5pbmRleE9mKGVsZW1lbnRzW2ldLCBhcnJheUluZGV4KSkgIT09IC0xKSB7XG4gICAgICAgICAgY2xpcHBlZEVsZW1lbnRzLnNwbGljZShhcnJheUluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2xpZW50SWRzID0gX2VsZW1lbnRNZXRhW2VsZW1lbnRzW2ldLnpjQ2xpcHBpbmdJZF07XG4gICAgICAgIGlmIChjbGllbnRJZHMpIHtcbiAgICAgICAgICBhcnJheUluZGV4ID0gMDtcbiAgICAgICAgICB3aGlsZSAoKGFycmF5SW5kZXggPSBjbGllbnRJZHMuaW5kZXhPZih0aGlzLmlkLCBhcnJheUluZGV4KSkgIT09IC0xKSB7XG4gICAgICAgICAgICBjbGllbnRJZHMuc3BsaWNlKGFycmF5SW5kZXgsIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoY2xpZW50SWRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgaWYgKF9nbG9iYWxDb25maWcuYXV0b0FjdGl2YXRlID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgIF9yZW1vdmVNb3VzZUhhbmRsZXJzKGVsZW1lbnRzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlbGV0ZSBlbGVtZW50c1tpXS56Y0NsaXBwaW5nSWQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLkNsaWVudC5wcm90b3R5cGUuZWxlbWVudHNgLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudEVsZW1lbnRzID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIG1ldGEgPSBfY2xpZW50TWV0YVt0aGlzLmlkXTtcbiAgICByZXR1cm4gbWV0YSAmJiBtZXRhLmVsZW1lbnRzID8gbWV0YS5lbGVtZW50cy5zbGljZSgwKSA6IFtdO1xuICB9O1xuICAvKipcbiAqIFRoZSB1bmRlcmx5aW5nIGltcGxlbWVudGF0aW9uIG9mIGBaZXJvQ2xpcGJvYXJkLkNsaWVudC5wcm90b3R5cGUuZGVzdHJveWAuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50RGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBtZXRhID0gX2NsaWVudE1ldGFbdGhpcy5pZF07XG4gICAgaWYgKCFtZXRhKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMudW5jbGlwKCk7XG4gICAgdGhpcy5vZmYoKTtcbiAgICBaZXJvQ2xpcGJvYXJkLm9mZihcIipcIiwgbWV0YS5jb3JlV2lsZGNhcmRIYW5kbGVyKTtcbiAgICBkZWxldGUgX2NsaWVudE1ldGFbdGhpcy5pZF07XG4gIH07XG4gIC8qKlxuICogSW5zcGVjdCBhbiBFdmVudCB0byBzZWUgaWYgdGhlIENsaWVudCAoYHRoaXNgKSBzaG91bGQgaG9ub3IgaXQgZm9yIGVtaXNzaW9uLlxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX2NsaWVudFNob3VsZEVtaXQgPSBmdW5jdGlvbihldmVudCkge1xuICAgIGlmICghKGV2ZW50ICYmIGV2ZW50LnR5cGUpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChldmVudC5jbGllbnQgJiYgZXZlbnQuY2xpZW50ICE9PSB0aGlzKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBtZXRhID0gX2NsaWVudE1ldGFbdGhpcy5pZF07XG4gICAgdmFyIGNsaXBwZWRFbHMgPSBtZXRhICYmIG1ldGEuZWxlbWVudHM7XG4gICAgdmFyIGhhc0NsaXBwZWRFbHMgPSAhIWNsaXBwZWRFbHMgJiYgY2xpcHBlZEVscy5sZW5ndGggPiAwO1xuICAgIHZhciBnb29kVGFyZ2V0ID0gIWV2ZW50LnRhcmdldCB8fCBoYXNDbGlwcGVkRWxzICYmIGNsaXBwZWRFbHMuaW5kZXhPZihldmVudC50YXJnZXQpICE9PSAtMTtcbiAgICB2YXIgZ29vZFJlbFRhcmdldCA9IGV2ZW50LnJlbGF0ZWRUYXJnZXQgJiYgaGFzQ2xpcHBlZEVscyAmJiBjbGlwcGVkRWxzLmluZGV4T2YoZXZlbnQucmVsYXRlZFRhcmdldCkgIT09IC0xO1xuICAgIHZhciBnb29kQ2xpZW50ID0gZXZlbnQuY2xpZW50ICYmIGV2ZW50LmNsaWVudCA9PT0gdGhpcztcbiAgICBpZiAoIW1ldGEgfHwgIShnb29kVGFyZ2V0IHx8IGdvb2RSZWxUYXJnZXQgfHwgZ29vZENsaWVudCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG4gIC8qKlxuICogSGFuZGxlIHRoZSBhY3R1YWwgZGlzcGF0Y2hpbmcgb2YgZXZlbnRzIHRvIGEgY2xpZW50IGluc3RhbmNlLlxuICpcbiAqIEByZXR1cm5zIGB1bmRlZmluZWRgXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfY2xpZW50RGlzcGF0Y2hDYWxsYmFja3MgPSBmdW5jdGlvbihldmVudCkge1xuICAgIHZhciBtZXRhID0gX2NsaWVudE1ldGFbdGhpcy5pZF07XG4gICAgaWYgKCEodHlwZW9mIGV2ZW50ID09PSBcIm9iamVjdFwiICYmIGV2ZW50ICYmIGV2ZW50LnR5cGUgJiYgbWV0YSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGFzeW5jID0gX3Nob3VsZFBlcmZvcm1Bc3luYyhldmVudCk7XG4gICAgdmFyIHdpbGRjYXJkVHlwZUhhbmRsZXJzID0gbWV0YSAmJiBtZXRhLmhhbmRsZXJzW1wiKlwiXSB8fCBbXTtcbiAgICB2YXIgc3BlY2lmaWNUeXBlSGFuZGxlcnMgPSBtZXRhICYmIG1ldGEuaGFuZGxlcnNbZXZlbnQudHlwZV0gfHwgW107XG4gICAgdmFyIGhhbmRsZXJzID0gd2lsZGNhcmRUeXBlSGFuZGxlcnMuY29uY2F0KHNwZWNpZmljVHlwZUhhbmRsZXJzKTtcbiAgICBpZiAoaGFuZGxlcnMgJiYgaGFuZGxlcnMubGVuZ3RoKSB7XG4gICAgICB2YXIgaSwgbGVuLCBmdW5jLCBjb250ZXh0LCBldmVudENvcHksIG9yaWdpbmFsQ29udGV4dCA9IHRoaXM7XG4gICAgICBmb3IgKGkgPSAwLCBsZW4gPSBoYW5kbGVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBmdW5jID0gaGFuZGxlcnNbaV07XG4gICAgICAgIGNvbnRleHQgPSBvcmlnaW5hbENvbnRleHQ7XG4gICAgICAgIGlmICh0eXBlb2YgZnVuYyA9PT0gXCJzdHJpbmdcIiAmJiB0eXBlb2YgX3dpbmRvd1tmdW5jXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgZnVuYyA9IF93aW5kb3dbZnVuY107XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBmdW5jID09PSBcIm9iamVjdFwiICYmIGZ1bmMgJiYgdHlwZW9mIGZ1bmMuaGFuZGxlRXZlbnQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIGNvbnRleHQgPSBmdW5jO1xuICAgICAgICAgIGZ1bmMgPSBmdW5jLmhhbmRsZUV2ZW50O1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgZnVuYyA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgZXZlbnRDb3B5ID0gX2V4dGVuZCh7fSwgZXZlbnQpO1xuICAgICAgICAgIF9kaXNwYXRjaENhbGxiYWNrKGZ1bmMsIGNvbnRleHQsIFsgZXZlbnRDb3B5IF0sIGFzeW5jKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgLyoqXG4gKiBQcmVwYXJlcyB0aGUgZWxlbWVudHMgZm9yIGNsaXBwaW5nL3VuY2xpcHBpbmcuXG4gKlxuICogQHJldHVybnMgQW4gQXJyYXkgb2YgZWxlbWVudHMuXG4gKiBAcHJpdmF0ZVxuICovXG4gIHZhciBfcHJlcENsaXAgPSBmdW5jdGlvbihlbGVtZW50cykge1xuICAgIGlmICh0eXBlb2YgZWxlbWVudHMgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIGVsZW1lbnRzID0gW107XG4gICAgfVxuICAgIHJldHVybiB0eXBlb2YgZWxlbWVudHMubGVuZ3RoICE9PSBcIm51bWJlclwiID8gWyBlbGVtZW50cyBdIDogZWxlbWVudHM7XG4gIH07XG4gIC8qKlxuICogQWRkIGEgYG1vdXNlb3ZlcmAgaGFuZGxlciBmdW5jdGlvbiBmb3IgYSBjbGlwcGVkIGVsZW1lbnQuXG4gKlxuICogQHJldHVybnMgYHVuZGVmaW5lZGBcbiAqIEBwcml2YXRlXG4gKi9cbiAgdmFyIF9hZGRNb3VzZUhhbmRsZXJzID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIGlmICghKGVsZW1lbnQgJiYgZWxlbWVudC5ub2RlVHlwZSA9PT0gMSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIF9zdXBwcmVzc01vdXNlRXZlbnRzID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGlmICghKGV2ZW50IHx8IChldmVudCA9IF93aW5kb3cuZXZlbnQpKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoZXZlbnQuX3NvdXJjZSAhPT0gXCJqc1wiKSB7XG4gICAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfVxuICAgICAgZGVsZXRlIGV2ZW50Ll9zb3VyY2U7XG4gICAgfTtcbiAgICB2YXIgX2VsZW1lbnRNb3VzZU92ZXIgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgaWYgKCEoZXZlbnQgfHwgKGV2ZW50ID0gX3dpbmRvdy5ldmVudCkpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIF9zdXBwcmVzc01vdXNlRXZlbnRzKGV2ZW50KTtcbiAgICAgIFplcm9DbGlwYm9hcmQuZm9jdXMoZWxlbWVudCk7XG4gICAgfTtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgX2VsZW1lbnRNb3VzZU92ZXIsIGZhbHNlKTtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW91dFwiLCBfc3VwcHJlc3NNb3VzZUV2ZW50cywgZmFsc2UpO1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgX3N1cHByZXNzTW91c2VFdmVudHMsIGZhbHNlKTtcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIF9zdXBwcmVzc01vdXNlRXZlbnRzLCBmYWxzZSk7XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIF9zdXBwcmVzc01vdXNlRXZlbnRzLCBmYWxzZSk7XG4gICAgX21vdXNlSGFuZGxlcnNbZWxlbWVudC56Y0NsaXBwaW5nSWRdID0ge1xuICAgICAgbW91c2VvdmVyOiBfZWxlbWVudE1vdXNlT3ZlcixcbiAgICAgIG1vdXNlb3V0OiBfc3VwcHJlc3NNb3VzZUV2ZW50cyxcbiAgICAgIG1vdXNlZW50ZXI6IF9zdXBwcmVzc01vdXNlRXZlbnRzLFxuICAgICAgbW91c2VsZWF2ZTogX3N1cHByZXNzTW91c2VFdmVudHMsXG4gICAgICBtb3VzZW1vdmU6IF9zdXBwcmVzc01vdXNlRXZlbnRzXG4gICAgfTtcbiAgfTtcbiAgLyoqXG4gKiBSZW1vdmUgYSBgbW91c2VvdmVyYCBoYW5kbGVyIGZ1bmN0aW9uIGZvciBhIGNsaXBwZWQgZWxlbWVudC5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICogQHByaXZhdGVcbiAqL1xuICB2YXIgX3JlbW92ZU1vdXNlSGFuZGxlcnMgPSBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgaWYgKCEoZWxlbWVudCAmJiBlbGVtZW50Lm5vZGVUeXBlID09PSAxKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgbW91c2VIYW5kbGVycyA9IF9tb3VzZUhhbmRsZXJzW2VsZW1lbnQuemNDbGlwcGluZ0lkXTtcbiAgICBpZiAoISh0eXBlb2YgbW91c2VIYW5kbGVycyA9PT0gXCJvYmplY3RcIiAmJiBtb3VzZUhhbmRsZXJzKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIga2V5LCB2YWwsIG1vdXNlRXZlbnRzID0gWyBcIm1vdmVcIiwgXCJsZWF2ZVwiLCBcImVudGVyXCIsIFwib3V0XCIsIFwib3ZlclwiIF07XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IG1vdXNlRXZlbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBrZXkgPSBcIm1vdXNlXCIgKyBtb3VzZUV2ZW50c1tpXTtcbiAgICAgIHZhbCA9IG1vdXNlSGFuZGxlcnNba2V5XTtcbiAgICAgIGlmICh0eXBlb2YgdmFsID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGtleSwgdmFsLCBmYWxzZSk7XG4gICAgICB9XG4gICAgfVxuICAgIGRlbGV0ZSBfbW91c2VIYW5kbGVyc1tlbGVtZW50LnpjQ2xpcHBpbmdJZF07XG4gIH07XG4gIC8qKlxuICogQ3JlYXRlcyBhIG5ldyBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZS5cbiAqIE9wdGlvbmFsbHksIGF1dG8tYGNsaXBgIGFuIGVsZW1lbnQgb3IgY29sbGVjdGlvbiBvZiBlbGVtZW50cy5cbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLl9jcmVhdGVDbGllbnQgPSBmdW5jdGlvbigpIHtcbiAgICBfY2xpZW50Q29uc3RydWN0b3IuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogUmVnaXN0ZXIgYW4gZXZlbnQgbGlzdGVuZXIgdG8gdGhlIGNsaWVudC5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY2xpZW50T24uYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogVW5yZWdpc3RlciBhbiBldmVudCBoYW5kbGVyIGZyb20gdGhlIGNsaWVudC5cbiAqIElmIG5vIGBsaXN0ZW5lcmAgZnVuY3Rpb24vb2JqZWN0IGlzIHByb3ZpZGVkLCBpdCB3aWxsIHVucmVnaXN0ZXIgYWxsIGhhbmRsZXJzIGZvciB0aGUgcHJvdmlkZWQgYGV2ZW50VHlwZWAuXG4gKiBJZiBubyBgZXZlbnRUeXBlYCBpcyBwcm92aWRlZCwgaXQgd2lsbCB1bnJlZ2lzdGVyIGFsbCBoYW5kbGVycyBmb3IgZXZlcnkgZXZlbnQgdHlwZS5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NsaWVudE9mZi5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBSZXRyaWV2ZSBldmVudCBsaXN0ZW5lcnMgZm9yIGFuIGBldmVudFR5cGVgIGZyb20gdGhlIGNsaWVudC5cbiAqIElmIG5vIGBldmVudFR5cGVgIGlzIHByb3ZpZGVkLCBpdCB3aWxsIHJldHJpZXZlIGFsbCBsaXN0ZW5lcnMgZm9yIGV2ZXJ5IGV2ZW50IHR5cGUuXG4gKlxuICogQHJldHVybnMgYXJyYXkgb2YgbGlzdGVuZXJzIGZvciB0aGUgYGV2ZW50VHlwZWA7IGlmIG5vIGBldmVudFR5cGVgLCB0aGVuIGEgbWFwL2hhc2ggb2JqZWN0IG9mIGxpc3RlbmVycyBmb3IgYWxsIGV2ZW50IHR5cGVzOyBvciBgbnVsbGBcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5oYW5kbGVycyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY2xpZW50TGlzdGVuZXJzLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIEV2ZW50IGVtaXNzaW9uIHJlY2VpdmVyIGZyb20gdGhlIEZsYXNoIG9iamVjdCBmb3IgdGhpcyBjbGllbnQncyByZWdpc3RlcmVkIEphdmFTY3JpcHQgZXZlbnQgbGlzdGVuZXJzLlxuICpcbiAqIEByZXR1cm5zIEZvciB0aGUgXCJjb3B5XCIgZXZlbnQsIHJldHVybnMgdGhlIEZsYXNoLWZyaWVuZGx5IFwiY2xpcERhdGFcIiBvYmplY3Q7IG90aGVyd2lzZSBgdW5kZWZpbmVkYC5cbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9jbGllbnRFbWl0LmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIFJlZ2lzdGVyIGNsaXBib2FyZCBhY3Rpb25zIGZvciBuZXcgZWxlbWVudChzKSB0byB0aGUgY2xpZW50LlxuICpcbiAqIEByZXR1cm5zIGB0aGlzYFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLmNsaXAgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NsaWVudENsaXAuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogVW5yZWdpc3RlciB0aGUgY2xpcGJvYXJkIGFjdGlvbnMgb2YgcHJldmlvdXNseSByZWdpc3RlcmVkIGVsZW1lbnQocykgb24gdGhlIHBhZ2UuXG4gKiBJZiBubyBlbGVtZW50cyBhcmUgcHJvdmlkZWQsIEFMTCByZWdpc3RlcmVkIGVsZW1lbnRzIHdpbGwgYmUgdW5yZWdpc3RlcmVkLlxuICpcbiAqIEByZXR1cm5zIGB0aGlzYFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLnVuY2xpcCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBfY2xpZW50VW5jbGlwLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICAvKipcbiAqIEdldCBhbGwgb2YgdGhlIGVsZW1lbnRzIHRvIHdoaWNoIHRoaXMgY2xpZW50IGlzIGNsaXBwZWQuXG4gKlxuICogQHJldHVybnMgYXJyYXkgb2YgY2xpcHBlZCBlbGVtZW50c1xuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLmVsZW1lbnRzID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIF9jbGllbnRFbGVtZW50cy5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgfTtcbiAgLyoqXG4gKiBTZWxmLWRlc3RydWN0IGFuZCBjbGVhbiB1cCBldmVyeXRoaW5nIGZvciBhIHNpbmdsZSBjbGllbnQuXG4gKiBUaGlzIHdpbGwgTk9UIGRlc3Ryb3kgdGhlIGVtYmVkZGVkIEZsYXNoIG9iamVjdC5cbiAqXG4gKiBAcmV0dXJucyBgdW5kZWZpbmVkYFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gX2NsaWVudERlc3Ryb3kuYXBwbHkodGhpcywgX2FyZ3MoYXJndW1lbnRzKSk7XG4gIH07XG4gIC8qKlxuICogU3RvcmVzIHRoZSBwZW5kaW5nIHBsYWluIHRleHQgdG8gaW5qZWN0IGludG8gdGhlIGNsaXBib2FyZC5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5zZXRUZXh0ID0gZnVuY3Rpb24odGV4dCkge1xuICAgIGlmICghX2NsaWVudE1ldGFbdGhpcy5pZF0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBzZXQgcGVuZGluZyBjbGlwYm9hcmQgZGF0YSBmcm9tIGEgZGVzdHJveWVkIFplcm9DbGlwYm9hcmQgY2xpZW50IGluc3RhbmNlXCIpO1xuICAgIH1cbiAgICBaZXJvQ2xpcGJvYXJkLnNldERhdGEoXCJ0ZXh0L3BsYWluXCIsIHRleHQpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICAvKipcbiAqIFN0b3JlcyB0aGUgcGVuZGluZyBIVE1MIHRleHQgdG8gaW5qZWN0IGludG8gdGhlIGNsaXBib2FyZC5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5zZXRIdG1sID0gZnVuY3Rpb24oaHRtbCkge1xuICAgIGlmICghX2NsaWVudE1ldGFbdGhpcy5pZF0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBzZXQgcGVuZGluZyBjbGlwYm9hcmQgZGF0YSBmcm9tIGEgZGVzdHJveWVkIFplcm9DbGlwYm9hcmQgY2xpZW50IGluc3RhbmNlXCIpO1xuICAgIH1cbiAgICBaZXJvQ2xpcGJvYXJkLnNldERhdGEoXCJ0ZXh0L2h0bWxcIiwgaHRtbCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIC8qKlxuICogU3RvcmVzIHRoZSBwZW5kaW5nIHJpY2ggdGV4dCAoUlRGKSB0byBpbmplY3QgaW50byB0aGUgY2xpcGJvYXJkLlxuICpcbiAqIEByZXR1cm5zIGB0aGlzYFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLnNldFJpY2hUZXh0ID0gZnVuY3Rpb24ocmljaFRleHQpIHtcbiAgICBpZiAoIV9jbGllbnRNZXRhW3RoaXMuaWRdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gc2V0IHBlbmRpbmcgY2xpcGJvYXJkIGRhdGEgZnJvbSBhIGRlc3Ryb3llZCBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZVwiKTtcbiAgICB9XG4gICAgWmVyb0NsaXBib2FyZC5zZXREYXRhKFwiYXBwbGljYXRpb24vcnRmXCIsIHJpY2hUZXh0KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBTdG9yZXMgdGhlIHBlbmRpbmcgZGF0YSB0byBpbmplY3QgaW50byB0aGUgY2xpcGJvYXJkLlxuICpcbiAqIEByZXR1cm5zIGB0aGlzYFxuICovXG4gIFplcm9DbGlwYm9hcmQucHJvdG90eXBlLnNldERhdGEgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoIV9jbGllbnRNZXRhW3RoaXMuaWRdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gc2V0IHBlbmRpbmcgY2xpcGJvYXJkIGRhdGEgZnJvbSBhIGRlc3Ryb3llZCBaZXJvQ2xpcGJvYXJkIGNsaWVudCBpbnN0YW5jZVwiKTtcbiAgICB9XG4gICAgWmVyb0NsaXBib2FyZC5zZXREYXRhLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuICAvKipcbiAqIENsZWFycyB0aGUgcGVuZGluZyBkYXRhIHRvIGluamVjdCBpbnRvIHRoZSBjbGlwYm9hcmQuXG4gKiBJZiBubyBgZm9ybWF0YCBpcyBwcm92aWRlZCwgYWxsIHBlbmRpbmcgZGF0YSBmb3JtYXRzIHdpbGwgYmUgY2xlYXJlZC5cbiAqXG4gKiBAcmV0dXJucyBgdGhpc2BcbiAqL1xuICBaZXJvQ2xpcGJvYXJkLnByb3RvdHlwZS5jbGVhckRhdGEgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoIV9jbGllbnRNZXRhW3RoaXMuaWRdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gY2xlYXIgcGVuZGluZyBjbGlwYm9hcmQgZGF0YSBmcm9tIGEgZGVzdHJveWVkIFplcm9DbGlwYm9hcmQgY2xpZW50IGluc3RhbmNlXCIpO1xuICAgIH1cbiAgICBaZXJvQ2xpcGJvYXJkLmNsZWFyRGF0YS5hcHBseSh0aGlzLCBfYXJncyhhcmd1bWVudHMpKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgLyoqXG4gKiBHZXRzIGEgY29weSBvZiB0aGUgcGVuZGluZyBkYXRhIHRvIGluamVjdCBpbnRvIHRoZSBjbGlwYm9hcmQuXG4gKiBJZiBubyBgZm9ybWF0YCBpcyBwcm92aWRlZCwgYSBjb3B5IG9mIEFMTCBwZW5kaW5nIGRhdGEgZm9ybWF0cyB3aWxsIGJlIHJldHVybmVkLlxuICpcbiAqIEByZXR1cm5zIGBTdHJpbmdgIG9yIGBPYmplY3RgXG4gKi9cbiAgWmVyb0NsaXBib2FyZC5wcm90b3R5cGUuZ2V0RGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICghX2NsaWVudE1ldGFbdGhpcy5pZF0pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkF0dGVtcHRlZCB0byBnZXQgcGVuZGluZyBjbGlwYm9hcmQgZGF0YSBmcm9tIGEgZGVzdHJveWVkIFplcm9DbGlwYm9hcmQgY2xpZW50IGluc3RhbmNlXCIpO1xuICAgIH1cbiAgICByZXR1cm4gWmVyb0NsaXBib2FyZC5nZXREYXRhLmFwcGx5KHRoaXMsIF9hcmdzKGFyZ3VtZW50cykpO1xuICB9O1xuICBpZiAodHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gWmVyb0NsaXBib2FyZDtcbiAgICB9KTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlID09PSBcIm9iamVjdFwiICYmIG1vZHVsZSAmJiB0eXBlb2YgbW9kdWxlLmV4cG9ydHMgPT09IFwib2JqZWN0XCIgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IFplcm9DbGlwYm9hcmQ7XG4gIH0gZWxzZSB7XG4gICAgd2luZG93Llplcm9DbGlwYm9hcmQgPSBaZXJvQ2xpcGJvYXJkO1xuICB9XG59KShmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMgfHwgd2luZG93O1xufSgpKTtcbn0se31dfSx7fSxbMjQsNjMsNjUsNjYsNjQsNjcsMTEwLDExMSwxMTIsNjgsNjksNzAsNzEsNzIsNzMsNzQsNzUsNzYsNzcsNzgsNzksODAsODEsODIsODMsODQsODUsODYsODcsODgsODksOTAsOTEsOTIsOTMsOTQsOTUsOTYsOTcsOTksMTAwLDEwMSwxMDIsMTAzLDEwNSwxMDYsMTA3LDEwOCwxMDksMTEzLDExNCwxMTUsMTE2LDEzMywxMzQsMTM1LDEzNiwxMTksMTIwLDEyMSwxMjIsMTIzLDEyNCwzMiwzNiwzMywzNCw0MSwzNSwzNywzOCwzOSw0MF0pKDI0KVxufSk7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2hhbmRzb250YWJsZS9kaXN0L2hhbmRzb250YWJsZS5mdWxsLmpzXG4vLyBtb2R1bGUgaWQgPSA2NzJcbi8vIG1vZHVsZSBjaHVua3MgPSAyMCIsIlxuLyogc3R5bGVzICovXG5yZXF1aXJlKFwiISF2dWUtc3R5bGUtbG9hZGVyIWNzcy1sb2FkZXI/c291cmNlTWFwIS4uLy4uL3Z1ZS1sb2FkZXIvbGliL3N0eWxlLWNvbXBpbGVyL2luZGV4P3tcXFwiaWRcXFwiOlxcXCJkYXRhLXYtMzllMmUwOTJcXFwiLFxcXCJzY29wZWRcXFwiOmZhbHNlLFxcXCJoYXNJbmxpbmVDb25maWdcXFwiOnRydWV9IS4uLy4uL3Z1ZS1sb2FkZXIvbGliL3NlbGVjdG9yP3R5cGU9c3R5bGVzJmluZGV4PTAhLi9IYW5kc29udGFibGUudnVlXCIpXG5cbnZhciBDb21wb25lbnQgPSByZXF1aXJlKFwiIS4uLy4uL3Z1ZS1sb2FkZXIvbGliL2NvbXBvbmVudC1ub3JtYWxpemVyXCIpKFxuICAvKiBzY3JpcHQgKi9cbiAgcmVxdWlyZShcIiEhYmFiZWwtbG9hZGVyP2NhY2hlRGlyZWN0b3J5IS4uLy4uL3Z1ZS1sb2FkZXIvbGliL3NlbGVjdG9yP3R5cGU9c2NyaXB0JmluZGV4PTAhLi9IYW5kc29udGFibGUudnVlXCIpLFxuICAvKiB0ZW1wbGF0ZSAqL1xuICByZXF1aXJlKFwiISEuLi8uLi92dWUtbG9hZGVyL2xpYi90ZW1wbGF0ZS1jb21waWxlci9pbmRleD97XFxcImlkXFxcIjpcXFwiZGF0YS12LTM5ZTJlMDkyXFxcIn0hLi4vLi4vdnVlLWxvYWRlci9saWIvc2VsZWN0b3I/dHlwZT10ZW1wbGF0ZSZpbmRleD0wIS4vSGFuZHNvbnRhYmxlLnZ1ZVwiKSxcbiAgLyogc2NvcGVJZCAqL1xuICBudWxsLFxuICAvKiBjc3NNb2R1bGVzICovXG4gIG51bGxcbilcbkNvbXBvbmVudC5vcHRpb25zLl9fZmlsZSA9IFwiL2hvbWUva2ltbmgvQ29kZXMvV2ViU2hvcC9hZG1pbi10ZW1wbGF0ZS9sYXJhdmVsLXZ1ZS1hZG1pbi9ub2RlX21vZHVsZXMvdnVlLWhhbmRzb250YWJsZS9zcmMvSGFuZHNvbnRhYmxlLnZ1ZVwiXG5pZiAoQ29tcG9uZW50LmVzTW9kdWxlICYmIE9iamVjdC5rZXlzKENvbXBvbmVudC5lc01vZHVsZSkuc29tZShmdW5jdGlvbiAoa2V5KSB7cmV0dXJuIGtleSAhPT0gXCJkZWZhdWx0XCIgJiYga2V5ICE9PSBcIl9fZXNNb2R1bGVcIn0pKSB7Y29uc29sZS5lcnJvcihcIm5hbWVkIGV4cG9ydHMgYXJlIG5vdCBzdXBwb3J0ZWQgaW4gKi52dWUgZmlsZXMuXCIpfVxuaWYgKENvbXBvbmVudC5vcHRpb25zLmZ1bmN0aW9uYWwpIHtjb25zb2xlLmVycm9yKFwiW3Z1ZS1sb2FkZXJdIEhhbmRzb250YWJsZS52dWU6IGZ1bmN0aW9uYWwgY29tcG9uZW50cyBhcmUgbm90IHN1cHBvcnRlZCB3aXRoIHRlbXBsYXRlcywgdGhleSBzaG91bGQgdXNlIHJlbmRlciBmdW5jdGlvbnMuXCIpfVxuXG4vKiBob3QgcmVsb2FkICovXG5pZiAobW9kdWxlLmhvdCkgeyhmdW5jdGlvbiAoKSB7XG4gIHZhciBob3RBUEkgPSByZXF1aXJlKFwidnVlLWhvdC1yZWxvYWQtYXBpXCIpXG4gIGhvdEFQSS5pbnN0YWxsKHJlcXVpcmUoXCJ2dWVcIiksIGZhbHNlKVxuICBpZiAoIWhvdEFQSS5jb21wYXRpYmxlKSByZXR1cm5cbiAgbW9kdWxlLmhvdC5hY2NlcHQoKVxuICBpZiAoIW1vZHVsZS5ob3QuZGF0YSkge1xuICAgIGhvdEFQSS5jcmVhdGVSZWNvcmQoXCJkYXRhLXYtMzllMmUwOTJcIiwgQ29tcG9uZW50Lm9wdGlvbnMpXG4gIH0gZWxzZSB7XG4gICAgaG90QVBJLnJlbG9hZChcImRhdGEtdi0zOWUyZTA5MlwiLCBDb21wb25lbnQub3B0aW9ucylcbiAgfVxufSkoKX1cblxubW9kdWxlLmV4cG9ydHMgPSBDb21wb25lbnQuZXhwb3J0c1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L3Z1ZS1oYW5kc29udGFibGUvc3JjL0hhbmRzb250YWJsZS52dWVcbi8vIG1vZHVsZSBpZCA9IDcwM1xuLy8gbW9kdWxlIGNodW5rcyA9IDIwIiwibW9kdWxlLmV4cG9ydHM9e3JlbmRlcjpmdW5jdGlvbiAoKXt2YXIgX3ZtPXRoaXM7dmFyIF9oPV92bS4kY3JlYXRlRWxlbWVudDt2YXIgX2M9X3ZtLl9zZWxmLl9jfHxfaDtcbiAgcmV0dXJuIF9jKCdkaXYnLCBbX2MoJ2RpdicsIHtcbiAgICBzdGF0aWNDbGFzczogXCJ0aWxlIGlzLWFuY2VzdG9yXCJcbiAgfSwgW19jKCdkaXYnLCB7XG4gICAgc3RhdGljQ2xhc3M6IFwidGlsZSBpcy1wYXJlbnRcIlxuICB9LCBbX2MoJ2FydGljbGUnLCB7XG4gICAgc3RhdGljQ2xhc3M6IFwidGlsZSBpcy1jaGlsZCBib3hcIlxuICB9LCBbX2MoJ2gxJywgW192bS5fdihcIkRhdGEgZ3JpZFwiKV0pLCBfdm0uX3YoXCIgXCIpLCBfYygnaGFuZHNvbnRhYmxlJywge1xuICAgIGF0dHJzOiB7XG4gICAgICBcImRhdGFcIjogX3ZtLnJhd0RhdGEsXG4gICAgICBcInNldHRpbmdzXCI6IHt9XG4gICAgfVxuICB9KV0sIDEpXSldKV0pXG59LHN0YXRpY1JlbmRlckZuczogW119XG5tb2R1bGUuZXhwb3J0cy5yZW5kZXIuX3dpdGhTdHJpcHBlZCA9IHRydWVcbmlmIChtb2R1bGUuaG90KSB7XG4gIG1vZHVsZS5ob3QuYWNjZXB0KClcbiAgaWYgKG1vZHVsZS5ob3QuZGF0YSkge1xuICAgICByZXF1aXJlKFwidnVlLWhvdC1yZWxvYWQtYXBpXCIpLnJlcmVuZGVyKFwiZGF0YS12LTBmNzAxYmY1XCIsIG1vZHVsZS5leHBvcnRzKVxuICB9XG59XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L3Z1ZS1sb2FkZXIvbGliL3RlbXBsYXRlLWNvbXBpbGVyP3tcImlkXCI6XCJkYXRhLXYtMGY3MDFiZjVcIn0hLi9+L3Z1ZS1sb2FkZXIvbGliL3NlbGVjdG9yLmpzP3R5cGU9dGVtcGxhdGUmaW5kZXg9MCEuL3Jlc291cmNlcy9idWlsZHMvanMvdmlld3MvdGFibGVzL0hhbmRzb250YWJsZS52dWVcbi8vIG1vZHVsZSBpZCA9IDcxNFxuLy8gbW9kdWxlIGNodW5rcyA9IDIwIiwibW9kdWxlLmV4cG9ydHM9e3JlbmRlcjpmdW5jdGlvbiAoKXt2YXIgX3ZtPXRoaXM7dmFyIF9oPV92bS4kY3JlYXRlRWxlbWVudDt2YXIgX2M9X3ZtLl9zZWxmLl9jfHxfaDtcbiAgcmV0dXJuIF9jKCdkaXYnLCB7XG4gICAgc3RhdGljQ2xhc3M6IFwiaGFuZHNvbnRhYmxlXCJcbiAgfSlcbn0sc3RhdGljUmVuZGVyRm5zOiBbXX1cbm1vZHVsZS5leHBvcnRzLnJlbmRlci5fd2l0aFN0cmlwcGVkID0gdHJ1ZVxuaWYgKG1vZHVsZS5ob3QpIHtcbiAgbW9kdWxlLmhvdC5hY2NlcHQoKVxuICBpZiAobW9kdWxlLmhvdC5kYXRhKSB7XG4gICAgIHJlcXVpcmUoXCJ2dWUtaG90LXJlbG9hZC1hcGlcIikucmVyZW5kZXIoXCJkYXRhLXYtMzllMmUwOTJcIiwgbW9kdWxlLmV4cG9ydHMpXG4gIH1cbn1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vdnVlLWxvYWRlci9saWIvdGVtcGxhdGUtY29tcGlsZXI/e1wiaWRcIjpcImRhdGEtdi0zOWUyZTA5MlwifSEuL34vdnVlLWxvYWRlci9saWIvc2VsZWN0b3IuanM/dHlwZT10ZW1wbGF0ZSZpbmRleD0wIS4vfi92dWUtaGFuZHNvbnRhYmxlL3NyYy9IYW5kc29udGFibGUudnVlXG4vLyBtb2R1bGUgaWQgPSA3MzJcbi8vIG1vZHVsZSBjaHVua3MgPSAyMCIsIi8vIHN0eWxlLWxvYWRlcjogQWRkcyBzb21lIGNzcyB0byB0aGUgRE9NIGJ5IGFkZGluZyBhIDxzdHlsZT4gdGFnXG5cbi8vIGxvYWQgdGhlIHN0eWxlc1xudmFyIGNvbnRlbnQgPSByZXF1aXJlKFwiISEuLi8uLi9jc3MtbG9hZGVyL2luZGV4LmpzP3NvdXJjZU1hcCEuLi8uLi92dWUtbG9hZGVyL2xpYi9zdHlsZS1jb21waWxlci9pbmRleC5qcz97XFxcImlkXFxcIjpcXFwiZGF0YS12LTM5ZTJlMDkyXFxcIixcXFwic2NvcGVkXFxcIjpmYWxzZSxcXFwiaGFzSW5saW5lQ29uZmlnXFxcIjp0cnVlfSEuLi8uLi92dWUtbG9hZGVyL2xpYi9zZWxlY3Rvci5qcz90eXBlPXN0eWxlcyZpbmRleD0wIS4vSGFuZHNvbnRhYmxlLnZ1ZVwiKTtcbmlmKHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJykgY29udGVudCA9IFtbbW9kdWxlLmlkLCBjb250ZW50LCAnJ11dO1xuaWYoY29udGVudC5sb2NhbHMpIG1vZHVsZS5leHBvcnRzID0gY29udGVudC5sb2NhbHM7XG4vLyBhZGQgdGhlIHN0eWxlcyB0byB0aGUgRE9NXG52YXIgdXBkYXRlID0gcmVxdWlyZShcIiEuLi8uLi92dWUtc3R5bGUtbG9hZGVyL2xpYi9hZGRTdHlsZXNDbGllbnQuanNcIikoXCI0NTcwZTU5NVwiLCBjb250ZW50LCBmYWxzZSk7XG4vLyBIb3QgTW9kdWxlIFJlcGxhY2VtZW50XG5pZihtb2R1bGUuaG90KSB7XG4gLy8gV2hlbiB0aGUgc3R5bGVzIGNoYW5nZSwgdXBkYXRlIHRoZSA8c3R5bGU+IHRhZ3NcbiBpZighY29udGVudC5sb2NhbHMpIHtcbiAgIG1vZHVsZS5ob3QuYWNjZXB0KFwiISEuLi8uLi9jc3MtbG9hZGVyL2luZGV4LmpzP3NvdXJjZU1hcCEuLi8uLi92dWUtbG9hZGVyL2xpYi9zdHlsZS1jb21waWxlci9pbmRleC5qcz97XFxcImlkXFxcIjpcXFwiZGF0YS12LTM5ZTJlMDkyXFxcIixcXFwic2NvcGVkXFxcIjpmYWxzZSxcXFwiaGFzSW5saW5lQ29uZmlnXFxcIjp0cnVlfSEuLi8uLi92dWUtbG9hZGVyL2xpYi9zZWxlY3Rvci5qcz90eXBlPXN0eWxlcyZpbmRleD0wIS4vSGFuZHNvbnRhYmxlLnZ1ZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgdmFyIG5ld0NvbnRlbnQgPSByZXF1aXJlKFwiISEuLi8uLi9jc3MtbG9hZGVyL2luZGV4LmpzP3NvdXJjZU1hcCEuLi8uLi92dWUtbG9hZGVyL2xpYi9zdHlsZS1jb21waWxlci9pbmRleC5qcz97XFxcImlkXFxcIjpcXFwiZGF0YS12LTM5ZTJlMDkyXFxcIixcXFwic2NvcGVkXFxcIjpmYWxzZSxcXFwiaGFzSW5saW5lQ29uZmlnXFxcIjp0cnVlfSEuLi8uLi92dWUtbG9hZGVyL2xpYi9zZWxlY3Rvci5qcz90eXBlPXN0eWxlcyZpbmRleD0wIS4vSGFuZHNvbnRhYmxlLnZ1ZVwiKTtcbiAgICAgaWYodHlwZW9mIG5ld0NvbnRlbnQgPT09ICdzdHJpbmcnKSBuZXdDb250ZW50ID0gW1ttb2R1bGUuaWQsIG5ld0NvbnRlbnQsICcnXV07XG4gICAgIHVwZGF0ZShuZXdDb250ZW50KTtcbiAgIH0pO1xuIH1cbiAvLyBXaGVuIHRoZSBtb2R1bGUgaXMgZGlzcG9zZWQsIHJlbW92ZSB0aGUgPHN0eWxlPiB0YWdzXG4gbW9kdWxlLmhvdC5kaXNwb3NlKGZ1bmN0aW9uKCkgeyB1cGRhdGUoKTsgfSk7XG59XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L3Z1ZS1zdHlsZS1sb2FkZXIhLi9+L2Nzcy1sb2FkZXI/c291cmNlTWFwIS4vfi92dWUtbG9hZGVyL2xpYi9zdHlsZS1jb21waWxlcj97XCJpZFwiOlwiZGF0YS12LTM5ZTJlMDkyXCIsXCJzY29wZWRcIjpmYWxzZSxcImhhc0lubGluZUNvbmZpZ1wiOnRydWV9IS4vfi92dWUtbG9hZGVyL2xpYi9zZWxlY3Rvci5qcz90eXBlPXN0eWxlcyZpbmRleD0wIS4vfi92dWUtaGFuZHNvbnRhYmxlL3NyYy9IYW5kc29udGFibGUudnVlXG4vLyBtb2R1bGUgaWQgPSA4MDdcbi8vIG1vZHVsZSBjaHVua3MgPSAyMCJdLCJzb3VyY2VSb290IjoiIn0=